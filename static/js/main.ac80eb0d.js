/*! For license information please see main.ac80eb0d.js.LICENSE.txt */
(()=>{"use strict";var e={4:(e,t,n)=>{var r=n(853),i=n(43),a=n(950);function s(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function l(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function c(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function u(e){if(l(e)!==e)throw Error(s(188))}function h(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=h(e)))return t;e=e.sibling}return null}var f=Object.assign,d=Symbol.for("react.element"),p=Symbol.for("react.transitional.element"),m=Symbol.for("react.portal"),g=Symbol.for("react.fragment"),v=Symbol.for("react.strict_mode"),y=Symbol.for("react.profiler"),b=Symbol.for("react.provider"),w=Symbol.for("react.consumer"),T=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),S=Symbol.for("react.suspense"),x=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),_=Symbol.for("react.lazy");Symbol.for("react.scope");var C=Symbol.for("react.activity");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var A=Symbol.for("react.memo_cache_sentinel");Symbol.for("react.view_transition");var I=Symbol.iterator;function N(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=I&&e[I]||e["@@iterator"])?e:null}var D=Symbol.for("react.client.reference");function O(e){if(null==e)return null;if("function"===typeof e)return e.$$typeof===D?null:e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case g:return"Fragment";case y:return"Profiler";case v:return"StrictMode";case S:return"Suspense";case x:return"SuspenseList";case C:return"Activity"}if("object"===typeof e)switch(e.$$typeof){case m:return"Portal";case T:return(e.displayName||"Context")+".Provider";case w:return(e._context.displayName||"Context")+".Consumer";case E:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case k:return null!==(t=e.displayName||null)?t:O(e.type)||"Memo";case _:t=e._payload,e=e._init;try{return O(e(t))}catch(Xt){}}return null}var R=Array.isArray,P=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,L=a.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,M={pending:!1,data:null,method:null,action:null},F=[],z=-1;function U(e){return{current:e}}function j(e){0>z||(e.current=F[z],F[z]=null,z--)}function B(e,t){z++,F[z]=e.current,e.current=t}var V=U(null),$=U(null),H=U(null),W=U(null);function G(e,t){switch(B(H,t),B($,e),B(V,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?ah(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=sh(t=ah(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}j(V),B(V,e)}function K(){j(V),j($),j(H)}function q(e){null!==e.memoizedState&&B(W,e);var t=V.current,n=sh(t,e.type);t!==n&&(B($,e),B(V,n))}function Y(e){$.current===e&&(j(V),j($)),W.current===e&&(j(W),Yh._currentValue=M)}var X=Object.prototype.hasOwnProperty,Q=r.unstable_scheduleCallback,J=r.unstable_cancelCallback,Z=r.unstable_shouldYield,ee=r.unstable_requestPaint,te=r.unstable_now,ne=r.unstable_getCurrentPriorityLevel,re=r.unstable_ImmediatePriority,ie=r.unstable_UserBlockingPriority,ae=r.unstable_NormalPriority,se=r.unstable_LowPriority,oe=r.unstable_IdlePriority,le=r.log,ce=r.unstable_setDisableYieldValue,ue=null,he=null;function fe(e){if("function"===typeof le&&ce(e),he&&"function"===typeof he.setStrictMode)try{he.setStrictMode(ue,e)}catch(t){}}var de=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(pe(e)/me|0)|0},pe=Math.log,me=Math.LN2;var ge=256,ve=4194304;function ye(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194048&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function be(e,t,n){var r=e.pendingLanes;if(0===r)return 0;var i=0,a=e.suspendedLanes,s=e.pingedLanes;e=e.warmLanes;var o=134217727&r;return 0!==o?0!==(r=o&~a)?i=ye(r):0!==(s&=o)?i=ye(s):n||0!==(n=o&~e)&&(i=ye(n)):0!==(o=r&~a)?i=ye(o):0!==s?i=ye(s):n||0!==(n=r&~e)&&(i=ye(n)),0===i?0:0!==t&&t!==i&&0===(t&a)&&((a=i&-i)>=(n=t&-t)||32===a&&0!==(4194048&n))?t:i}function we(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function Te(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function Ee(){var e=ge;return 0===(4194048&(ge<<=1))&&(ge=256),e}function Se(){var e=ve;return 0===(62914560&(ve<<=1))&&(ve=4194304),e}function xe(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function ke(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function _e(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var r=31-de(t);e.entangledLanes|=t,e.entanglements[r]=1073741824|e.entanglements[r]|4194090&n}function Ce(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-de(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}function Ae(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Ie(e){return 2<(e&=-e)?8<e?0!==(134217727&e)?32:268435456:8:2}function Ne(){var e=L.p;return 0!==e?e:void 0===(e=window.event)?32:hf(e.type)}var De=Math.random().toString(36).slice(2),Oe="__reactFiber$"+De,Re="__reactProps$"+De,Pe="__reactContainer$"+De,Le="__reactEvents$"+De,Me="__reactListeners$"+De,Fe="__reactHandles$"+De,ze="__reactResources$"+De,Ue="__reactMarker$"+De;function je(e){delete e[Oe],delete e[Re],delete e[Le],delete e[Me],delete e[Fe]}function Be(e){var t=e[Oe];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Pe]||n[Oe]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=wh(e);null!==e;){if(n=e[Oe])return n;e=wh(e)}return t}n=(e=n).parentNode}return null}function Ve(e){if(e=e[Oe]||e[Pe]){var t=e.tag;if(5===t||6===t||13===t||26===t||27===t||3===t)return e}return null}function $e(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(s(33))}function He(e){var t=e[ze];return t||(t=e[ze]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function We(e){e[Ue]=!0}var Ge=new Set,Ke={};function qe(e,t){Ye(e,t),Ye(e+"Capture",t)}function Ye(e,t){for(Ke[e]=t,e=0;e<t.length;e++)Ge.add(t[e])}var Xe,Qe,Je=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ze={},et={};function tt(e,t,n){if(i=t,X.call(et,i)||!X.call(Ze,i)&&(Je.test(i)?et[i]=!0:(Ze[i]=!0,0)))if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var r=t.toLowerCase().slice(0,5);if("data-"!==r&&"aria-"!==r)return void e.removeAttribute(t)}e.setAttribute(t,""+n)}var i}function nt(e,t,n){if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+n)}}function rt(e,t,n,r){if(null===r)e.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(n)}e.setAttributeNS(t,n,""+r)}}function it(e){if(void 0===Xe)try{throw Error()}catch(Xt){var t=Xt.stack.trim().match(/\n( *(at )?)/);Xe=t&&t[1]||"",Qe=-1<Xt.stack.indexOf("\n    at")?" (<anonymous>)":-1<Xt.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+Xe+e+Qe}var at=!1;function st(e,t){if(!e||at)return"";at=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(Xt){var r=Xt}Reflect.construct(e,[],n)}else{try{n.call()}catch(i){r=i}e.call(n.prototype)}}else{try{throw Error()}catch(a){r=a}(n=e())&&"function"===typeof n.catch&&n.catch((function(){}))}}catch(s){if(s&&r&&"string"===typeof s.stack)return[s.stack,r.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var i=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,"name");i&&i.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var a=r.DetermineComponentFrameRoot(),s=a[0],o=a[1];if(s&&o){var l=s.split("\n"),c=o.split("\n");for(i=r=0;r<l.length&&!l[r].includes("DetermineComponentFrameRoot");)r++;for(;i<c.length&&!c[i].includes("DetermineComponentFrameRoot");)i++;if(r===l.length||i===c.length)for(r=l.length-1,i=c.length-1;1<=r&&0<=i&&l[r]!==c[i];)i--;for(;1<=r&&0<=i;r--,i--)if(l[r]!==c[i]){if(1!==r||1!==i)do{if(r--,0>--i||l[r]!==c[i]){var u="\n"+l[r].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=r&&0<=i);break}}}finally{at=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?it(n):""}function ot(e){switch(e.tag){case 26:case 27:case 5:return it(e.type);case 16:return it("Lazy");case 13:return it("Suspense");case 19:return it("SuspenseList");case 0:case 15:return st(e.type,!1);case 11:return st(e.type.render,!1);case 1:return st(e.type,!0);case 31:return it("Activity");default:return""}}function lt(e){try{var t="";do{t+=ot(e),e=e.return}while(e);return t}catch(Xt){return"\nError generating stack: "+Xt.message+"\n"+Xt.stack}}function ct(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function ut(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function ht(e){e._valueTracker||(e._valueTracker=function(e){var t=ut(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function ft(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=ut(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function dt(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var pt=/[\n"\\]/g;function mt(e){return e.replace(pt,(function(e){return"\\"+e.charCodeAt(0).toString(16)+" "}))}function gt(e,t,n,r,i,a,s,o){e.name="",null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s?e.type=s:e.removeAttribute("type"),null!=t?"number"===s?(0===t&&""===e.value||e.value!=t)&&(e.value=""+ct(t)):e.value!==""+ct(t)&&(e.value=""+ct(t)):"submit"!==s&&"reset"!==s||e.removeAttribute("value"),null!=t?yt(e,s,ct(t)):null!=n?yt(e,s,ct(n)):null!=r&&e.removeAttribute("value"),null==i&&null!=a&&(e.defaultChecked=!!a),null!=i&&(e.checked=i&&"function"!==typeof i&&"symbol"!==typeof i),null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o?e.name=""+ct(o):e.removeAttribute("name")}function vt(e,t,n,r,i,a,s,o){if(null!=a&&"function"!==typeof a&&"symbol"!==typeof a&&"boolean"!==typeof a&&(e.type=a),null!=t||null!=n){if(!("submit"!==a&&"reset"!==a||void 0!==t&&null!==t))return;n=null!=n?""+ct(n):"",t=null!=t?""+ct(t):n,o||t===e.value||(e.value=t),e.defaultValue=t}r="function"!==typeof(r=null!=r?r:i)&&"symbol"!==typeof r&&!!r,e.checked=o?e.checked:!!r,e.defaultChecked=!!r,null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s&&(e.name=s)}function yt(e,t,n){"number"===t&&dt(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function bt(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+ct(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function wt(e,t,n){null==t||((t=""+ct(t))!==e.value&&(e.value=t),null!=n)?e.defaultValue=null!=n?""+ct(n):"":e.defaultValue!==t&&(e.defaultValue=t)}function Tt(e,t,n,r){if(null==t){if(null!=r){if(null!=n)throw Error(s(92));if(R(r)){if(1<r.length)throw Error(s(93));r=r[0]}n=r}null==n&&(n=""),t=n}n=ct(t),e.defaultValue=n,(r=e.textContent)===n&&""!==r&&null!==r&&(e.value=r)}function Et(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var St=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function xt(e,t,n){var r=0===t.indexOf("--");null==n||"boolean"===typeof n||""===n?r?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":r?e.setProperty(t,n):"number"!==typeof n||0===n||St.has(t)?"float"===t?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function kt(e,t,n){if(null!=t&&"object"!==typeof t)throw Error(s(62));if(e=e.style,null!=n){for(var r in n)!n.hasOwnProperty(r)||null!=t&&t.hasOwnProperty(r)||(0===r.indexOf("--")?e.setProperty(r,""):"float"===r?e.cssFloat="":e[r]="");for(var i in t)r=t[i],t.hasOwnProperty(i)&&n[i]!==r&&xt(e,i,r)}else for(var a in t)t.hasOwnProperty(a)&&xt(e,a,t[a])}function _t(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ct=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),At=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function It(e){return At.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var Nt=null;function Dt(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ot=null,Rt=null;function Pt(e){var t=Ve(e);if(t&&(e=t.stateNode)){var n=e[Re]||null;e:switch(e=t.stateNode,t.type){case"input":if(gt(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+mt(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=r[Re]||null;if(!i)throw Error(s(90));gt(r,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name)}}for(t=0;t<n.length;t++)(r=n[t]).form===e.form&&ft(r)}break e;case"textarea":wt(e,n.value,n.defaultValue);break e;case"select":null!=(t=n.value)&&bt(e,!!n.multiple,t,!1)}}}var Lt=!1;function Mt(e,t,n){if(Lt)return e(t,n);Lt=!0;try{return e(t)}finally{if(Lt=!1,(null!==Ot||null!==Rt)&&(Vc(),Ot&&(t=Ot,e=Rt,Rt=Ot=null,Pt(t),e)))for(t=0;t<e.length;t++)Pt(e[t])}}function Ft(e,t){var n=e.stateNode;if(null===n)return null;var r=n[Re]||null;if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var zt=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),Ut=!1;if(zt)try{var jt={};Object.defineProperty(jt,"passive",{get:function(){Ut=!0}}),window.addEventListener("test",jt,jt),window.removeEventListener("test",jt,jt)}catch(Lf){Ut=!1}var Bt=null,Vt=null,$t=null;function Ht(){if($t)return $t;var e,t,n=Vt,r=n.length,i="value"in Bt?Bt.value:Bt.textContent,a=i.length;for(e=0;e<r&&n[e]===i[e];e++);var s=r-e;for(t=1;t<=s&&n[r-t]===i[a-t];t++);return $t=i.slice(e,1<t?1-t:void 0)}function Wt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Gt(){return!0}function Kt(){return!1}function qt(e){function t(t,n,r,i,a){for(var s in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(i):i[s]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?Gt:Kt,this.isPropagationStopped=Kt,this}return f(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Gt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Gt)},persist:function(){},isPersistent:Gt}),t}var Yt,Qt,Jt,Zt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},en=qt(Zt),tn=f({},Zt,{view:0,detail:0}),nn=qt(tn),rn=f({},tn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:mn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Jt&&(Jt&&"mousemove"===e.type?(Yt=e.screenX-Jt.screenX,Qt=e.screenY-Jt.screenY):Qt=Yt=0,Jt=e),Yt)},movementY:function(e){return"movementY"in e?e.movementY:Qt}}),an=qt(rn),sn=qt(f({},rn,{dataTransfer:0})),on=qt(f({},tn,{relatedTarget:0})),ln=qt(f({},Zt,{animationName:0,elapsedTime:0,pseudoElement:0})),cn=qt(f({},Zt,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),un=qt(f({},Zt,{data:0})),hn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},dn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=dn[e])&&!!t[e]}function mn(){return pn}var gn=qt(f({},tn,{key:function(e){if(e.key){var t=hn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Wt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?fn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:mn,charCode:function(e){return"keypress"===e.type?Wt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Wt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),vn=qt(f({},rn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),yn=qt(f({},tn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:mn})),bn=qt(f({},Zt,{propertyName:0,elapsedTime:0,pseudoElement:0})),wn=qt(f({},rn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),Tn=qt(f({},Zt,{newState:0,oldState:0})),En=[9,13,27,32],Sn=zt&&"CompositionEvent"in window,xn=null;zt&&"documentMode"in document&&(xn=document.documentMode);var kn=zt&&"TextEvent"in window&&!xn,_n=zt&&(!Sn||xn&&8<xn&&11>=xn),Cn=String.fromCharCode(32),An=!1;function In(e,t){switch(e){case"keyup":return-1!==En.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Nn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Dn=!1;var On={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Rn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!On[e.type]:"textarea"===t}function Pn(e,t,n,r){Ot?Rt?Rt.push(r):Rt=[r]:Ot=r,0<(t=Wu(t,"onChange")).length&&(n=new en("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Ln=null,Mn=null;function Fn(e){Fu(e,0)}function zn(e){if(ft($e(e)))return e}function Un(e,t){if("change"===e)return t}var jn=!1;if(zt){var Bn;if(zt){var Vn="oninput"in document;if(!Vn){var $n=document.createElement("div");$n.setAttribute("oninput","return;"),Vn="function"===typeof $n.oninput}Bn=Vn}else Bn=!1;jn=Bn&&(!document.documentMode||9<document.documentMode)}function Hn(){Ln&&(Ln.detachEvent("onpropertychange",Wn),Mn=Ln=null)}function Wn(e){if("value"===e.propertyName&&zn(Mn)){var t=[];Pn(t,Mn,e,Dt(e)),Mt(Fn,t)}}function Gn(e,t,n){"focusin"===e?(Hn(),Mn=n,(Ln=t).attachEvent("onpropertychange",Wn)):"focusout"===e&&Hn()}function Kn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return zn(Mn)}function qn(e,t){if("click"===e)return zn(t)}function Yn(e,t){if("input"===e||"change"===e)return zn(t)}var Xn="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function Qn(e,t){if(Xn(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!X.call(t,i)||!Xn(e[i],t[i]))return!1}return!0}function Jn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Zn(e,t){var n,r=Jn(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Jn(r)}}function er(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?er(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function tr(e){for(var t=dt((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=dt((e=t.contentWindow).document)}return t}function nr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var rr=zt&&"documentMode"in document&&11>=document.documentMode,ir=null,ar=null,sr=null,or=!1;function lr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;or||null==ir||ir!==dt(r)||("selectionStart"in(r=ir)&&nr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},sr&&Qn(sr,r)||(sr=r,0<(r=Wu(ar,"onSelect")).length&&(t=new en("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=ir)))}function cr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var ur={animationend:cr("Animation","AnimationEnd"),animationiteration:cr("Animation","AnimationIteration"),animationstart:cr("Animation","AnimationStart"),transitionrun:cr("Transition","TransitionRun"),transitionstart:cr("Transition","TransitionStart"),transitioncancel:cr("Transition","TransitionCancel"),transitionend:cr("Transition","TransitionEnd")},hr={},fr={};function dr(e){if(hr[e])return hr[e];if(!ur[e])return e;var t,n=ur[e];for(t in n)if(n.hasOwnProperty(t)&&t in fr)return hr[e]=n[t];return e}zt&&(fr=document.createElement("div").style,"AnimationEvent"in window||(delete ur.animationend.animation,delete ur.animationiteration.animation,delete ur.animationstart.animation),"TransitionEvent"in window||delete ur.transitionend.transition);var pr=dr("animationend"),mr=dr("animationiteration"),gr=dr("animationstart"),vr=dr("transitionrun"),yr=dr("transitionstart"),br=dr("transitioncancel"),wr=dr("transitionend"),Tr=new Map,Er="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Sr(e,t){Tr.set(e,t),qe(t,[e])}Er.push("scrollEnd");var xr=new WeakMap;function kr(e,t){if("object"===typeof e&&null!==e){var n=xr.get(e);return void 0!==n?n:(t={value:e,source:t,stack:lt(t)},xr.set(e,t),t)}return{value:e,source:t,stack:lt(t)}}var _r=[],Cr=0,Ar=0;function Ir(){for(var e=Cr,t=Ar=Cr=0;t<e;){var n=_r[t];_r[t++]=null;var r=_r[t];_r[t++]=null;var i=_r[t];_r[t++]=null;var a=_r[t];if(_r[t++]=null,null!==r&&null!==i){var s=r.pending;null===s?i.next=i:(i.next=s.next,s.next=i),r.pending=i}0!==a&&Rr(n,i,a)}}function Nr(e,t,n,r){_r[Cr++]=e,_r[Cr++]=t,_r[Cr++]=n,_r[Cr++]=r,Ar|=r,e.lanes|=r,null!==(e=e.alternate)&&(e.lanes|=r)}function Dr(e,t,n,r){return Nr(e,t,n,r),Pr(e)}function Or(e,t){return Nr(e,null,null,t),Pr(e)}function Rr(e,t,n){e.lanes|=n;var r=e.alternate;null!==r&&(r.lanes|=n);for(var i=!1,a=e.return;null!==a;)a.childLanes|=n,null!==(r=a.alternate)&&(r.childLanes|=n),22===a.tag&&(null===(e=a.stateNode)||1&e._visibility||(i=!0)),e=a,a=a.return;return 3===e.tag?(a=e.stateNode,i&&null!==t&&(i=31-de(n),null===(r=(e=a.hiddenUpdates)[i])?e[i]=[t]:r.push(t),t.lane=536870912|n),a):null}function Pr(e){if(50<Rc)throw Rc=0,Pc=null,Error(s(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Lr={};function Mr(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fr(e,t,n,r){return new Mr(e,t,n,r)}function zr(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Ur(e,t){var n=e.alternate;return null===n?((n=Fr(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=65011712&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function jr(e,t){e.flags&=65011714;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Br(e,t,n,r,i,a){var o=0;if(r=e,"function"===typeof e)zr(e)&&(o=1);else if("string"===typeof e)o=function(e,t,n){if(1===n||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!==typeof t.precedence||"string"!==typeof t.href||""===t.href)break;return!0;case"link":if("string"!==typeof t.rel||"string"!==typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"===typeof t.precedence&&null==e);case"script":if(t.async&&"function"!==typeof t.async&&"symbol"!==typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"===typeof t.src)return!0}return!1}(e,n,V.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case C:return(e=Fr(31,n,t,i)).elementType=C,e.lanes=a,e;case g:return Vr(n.children,i,a,t);case v:o=8,i|=24;break;case y:return(e=Fr(12,n,t,2|i)).elementType=y,e.lanes=a,e;case S:return(e=Fr(13,n,t,i)).elementType=S,e.lanes=a,e;case x:return(e=Fr(19,n,t,i)).elementType=x,e.lanes=a,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case b:case T:o=10;break e;case w:o=9;break e;case E:o=11;break e;case k:o=14;break e;case _:o=16,r=null;break e}o=29,n=Error(s(130,null===e?"null":typeof e,"")),r=null}return(t=Fr(o,n,t,i)).elementType=e,t.type=r,t.lanes=a,t}function Vr(e,t,n,r){return(e=Fr(7,e,r,t)).lanes=n,e}function $r(e,t,n){return(e=Fr(6,e,null,t)).lanes=n,e}function Hr(e,t,n){return(t=Fr(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Wr=[],Gr=0,Kr=null,qr=0,Yr=[],Xr=0,Qr=null,Jr=1,Zr="";function ei(e,t){Wr[Gr++]=qr,Wr[Gr++]=Kr,Kr=e,qr=t}function ti(e,t,n){Yr[Xr++]=Jr,Yr[Xr++]=Zr,Yr[Xr++]=Qr,Qr=e;var r=Jr;e=Zr;var i=32-de(r)-1;r&=~(1<<i),n+=1;var a=32-de(t)+i;if(30<a){var s=i-i%5;a=(r&(1<<s)-1).toString(32),r>>=s,i-=s,Jr=1<<32-de(t)+i|n<<i|r,Zr=a+e}else Jr=1<<a|n<<i|r,Zr=e}function ni(e){null!==e.return&&(ei(e,1),ti(e,1,0))}function ri(e){for(;e===Kr;)Kr=Wr[--Gr],Wr[Gr]=null,qr=Wr[--Gr],Wr[Gr]=null;for(;e===Qr;)Qr=Yr[--Xr],Yr[Xr]=null,Zr=Yr[--Xr],Yr[Xr]=null,Jr=Yr[--Xr],Yr[Xr]=null}var ii=null,ai=null,si=!1,oi=null,li=!1,ci=Error(s(519));function ui(e){throw gi(kr(Error(s(418,"")),e)),ci}function hi(e){var t=e.stateNode,n=e.type,r=e.memoizedProps;switch(t[Oe]=e,t[Re]=r,n){case"dialog":zu("cancel",t),zu("close",t);break;case"iframe":case"object":case"embed":zu("load",t);break;case"video":case"audio":for(n=0;n<Lu.length;n++)zu(Lu[n],t);break;case"source":zu("error",t);break;case"img":case"image":case"link":zu("error",t),zu("load",t);break;case"details":zu("toggle",t);break;case"input":zu("invalid",t),vt(t,r.value,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name,!0),ht(t);break;case"select":zu("invalid",t);break;case"textarea":zu("invalid",t),Tt(t,r.value,r.defaultValue,r.children),ht(t)}"string"!==typeof(n=r.children)&&"number"!==typeof n&&"bigint"!==typeof n||t.textContent===""+n||!0===r.suppressHydrationWarning||Qu(t.textContent,n)?(null!=r.popover&&(zu("beforetoggle",t),zu("toggle",t)),null!=r.onScroll&&zu("scroll",t),null!=r.onScrollEnd&&zu("scrollend",t),null!=r.onClick&&(t.onclick=Ju),t=!0):t=!1,t||ui(e)}function fi(e){for(ii=e.return;ii;)switch(ii.tag){case 5:case 13:return void(li=!1);case 27:case 3:return void(li=!0);default:ii=ii.return}}function di(e){if(e!==ii)return!1;if(!si)return fi(e),si=!0,!1;var t,n=e.tag;if((t=3!==n&&27!==n)&&((t=5===n)&&(t=!("form"!==(t=e.type)&&"button"!==t)||oh(e.type,e.memoizedProps)),t=!t),t&&ai&&ui(e),fi(e),13===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,n=0;e;){if(8===e.nodeType)if("/$"===(t=e.data)){if(0===n){ai=yh(e.nextSibling);break e}n--}else"$"!==t&&"$!"!==t&&"$?"!==t||n++;e=e.nextSibling}ai=null}}else 27===n?(n=ai,ph(e.type)?(e=bh,bh=null,ai=e):ai=n):ai=ii?yh(e.stateNode.nextSibling):null;return!0}function pi(){ai=ii=null,si=!1}function mi(){var e=oi;return null!==e&&(null===wc?wc=e:wc.push.apply(wc,e),oi=null),e}function gi(e){null===oi?oi=[e]:oi.push(e)}var vi=U(null),yi=null,bi=null;function wi(e,t,n){B(vi,t._currentValue),t._currentValue=n}function Ti(e){e._currentValue=vi.current,j(vi)}function Ei(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Si(e,t,n,r){var i=e.child;for(null!==i&&(i.return=e);null!==i;){var a=i.dependencies;if(null!==a){var o=i.child;a=a.firstContext;e:for(;null!==a;){var l=a;a=i;for(var c=0;c<t.length;c++)if(l.context===t[c]){a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),Ei(a.return,n,e),r||(o=null);break e}a=l.next}}else if(18===i.tag){if(null===(o=i.return))throw Error(s(341));o.lanes|=n,null!==(a=o.alternate)&&(a.lanes|=n),Ei(o,n,e),o=null}else o=i.child;if(null!==o)o.return=i;else for(o=i;null!==o;){if(o===e){o=null;break}if(null!==(i=o.sibling)){i.return=o.return,o=i;break}o=o.return}i=o}}function xi(e,t,n,r){e=null;for(var i=t,a=!1;null!==i;){if(!a)if(0!==(524288&i.flags))a=!0;else if(0!==(262144&i.flags))break;if(10===i.tag){var o=i.alternate;if(null===o)throw Error(s(387));if(null!==(o=o.memoizedProps)){var l=i.type;Xn(i.pendingProps.value,o.value)||(null!==e?e.push(l):e=[l])}}else if(i===W.current){if(null===(o=i.alternate))throw Error(s(387));o.memoizedState.memoizedState!==i.memoizedState.memoizedState&&(null!==e?e.push(Yh):e=[Yh])}i=i.return}null!==e&&Si(t,e,n,r),t.flags|=262144}function ki(e){for(e=e.firstContext;null!==e;){if(!Xn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function _i(e){yi=e,bi=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function Ci(e){return Ii(yi,e)}function Ai(e,t){return null===yi&&_i(e),Ii(e,t)}function Ii(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},null===bi){if(null===e)throw Error(s(308));bi=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else bi=bi.next=t;return n}var Ni="undefined"!==typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach((function(e){return e()}))}},Di=r.unstable_scheduleCallback,Oi=r.unstable_NormalPriority,Ri={$$typeof:T,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Pi(){return{controller:new Ni,data:new Map,refCount:0}}function Li(e){e.refCount--,0===e.refCount&&Di(Oi,(function(){e.controller.abort()}))}var Mi=null,Fi=0,zi=0,Ui=null;function ji(){if(0===--Fi&&null!==Mi){null!==Ui&&(Ui.status="fulfilled");var e=Mi;Mi=null,zi=0,Ui=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var Bi=P.S;P.S=function(e,t){"object"===typeof t&&null!==t&&"function"===typeof t.then&&function(e,t){if(null===Mi){var n=Mi=[];Fi=0,zi=Nu(),Ui={status:"pending",value:void 0,then:function(e){n.push(e)}}}Fi++,t.then(ji,ji)}(0,t),null!==Bi&&Bi(e,t)};var Vi=U(null);function $i(){var e=Vi.current;return null!==e?e:ic.pooledCache}function Hi(e,t){B(Vi,null===t?Vi.current:t.pool)}function Wi(){var e=$i();return null===e?null:{parent:Ri._currentValue,pool:e}}var Gi=Error(s(460)),Ki=Error(s(474)),qi=Error(s(542)),Yi={then:function(){}};function Xi(e){return"fulfilled"===(e=e.status)||"rejected"===e}function Qi(){}function Ji(e,t,n){switch(void 0===(n=e[n])?e.push(t):n!==t&&(t.then(Qi,Qi),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw ta(e=t.reason),e;default:if("string"===typeof t.status)t.then(Qi,Qi);else{if(null!==(e=ic)&&100<e.shellSuspendCounter)throw Error(s(482));(e=t).status="pending",e.then((function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e}}),(function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e}}))}switch(t.status){case"fulfilled":return t.value;case"rejected":throw ta(e=t.reason),e}throw Zi=t,Gi}}var Zi=null;function ea(){if(null===Zi)throw Error(s(459));var e=Zi;return Zi=null,e}function ta(e){if(e===Gi||e===qi)throw Error(s(483))}var na=!1;function ra(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ia(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function aa(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function sa(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&rc)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,t=Pr(e),Rr(e,null,n),t}return Nr(e,r,t,n),Pr(e)}function oa(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194048&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Ce(e,n)}}function la(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var s={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===a?i=a=s:a=a.next=s,n=n.next}while(null!==n);null===a?i=a=t:a=a.next=t}else i=a=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,callbacks:r.callbacks},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var ca=!1;function ua(){if(ca){if(null!==Ui)throw Ui}}function ha(e,t,n,r){ca=!1;var i=e.updateQueue;na=!1;var a=i.firstBaseUpdate,s=i.lastBaseUpdate,o=i.shared.pending;if(null!==o){i.shared.pending=null;var l=o,c=l.next;l.next=null,null===s?a=c:s.next=c,s=l;var u=e.alternate;null!==u&&((o=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===o?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(null!==a){var h=i.baseState;for(s=0,u=c=l=null,o=a;;){var d=-536870913&o.lane,p=d!==o.lane;if(p?(sc&d)===d:(r&d)===d){0!==d&&d===zi&&(ca=!0),null!==u&&(u=u.next={lane:0,tag:o.tag,payload:o.payload,callback:null,next:null});e:{var m=e,g=o;d=t;var v=n;switch(g.tag){case 1:if("function"===typeof(m=g.payload)){h=m.call(v,h,d);break e}h=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null===(d="function"===typeof(m=g.payload)?m.call(v,h,d):m)||void 0===d)break e;h=f({},h,d);break e;case 2:na=!0}}null!==(d=o.callback)&&(e.flags|=64,p&&(e.flags|=8192),null===(p=i.callbacks)?i.callbacks=[d]:p.push(d))}else p={lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===u?(c=u=p,l=h):u=u.next=p,s|=d;if(null===(o=o.next)){if(null===(o=i.shared.pending))break;o=(p=o).next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}null===u&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null===a&&(i.shared.lanes=0),pc|=s,e.lanes=s,e.memoizedState=h}}function fa(e,t){if("function"!==typeof e)throw Error(s(191,e));e.call(t)}function da(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)fa(n[e],t)}var pa=U(null),ma=U(0);function ga(e,t){B(ma,e=fc),B(pa,t),fc=e|t.baseLanes}function va(){B(ma,fc),B(pa,pa.current)}function ya(){fc=ma.current,j(pa),j(ma)}var ba=0,wa=null,Ta=null,Ea=null,Sa=!1,xa=!1,ka=!1,_a=0,Ca=0,Aa=null,Ia=0;function Na(){throw Error(s(321))}function Da(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Xn(e[n],t[n]))return!1;return!0}function Oa(e,t,n,r,i,a){return ba=a,wa=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,P.H=null===e||null===e.memoizedState?Gs:Ks,ka=!1,a=n(r,i),ka=!1,xa&&(a=Pa(t,n,r,i)),Ra(e),a}function Ra(e){P.H=Ws;var t=null!==Ta&&null!==Ta.next;if(ba=0,Ea=Ta=wa=null,Sa=!1,Ca=0,Aa=null,t)throw Error(s(300));null===e||Ao||null!==(e=e.dependencies)&&ki(e)&&(Ao=!0)}function Pa(e,t,n,r){wa=e;var i=0;do{if(xa&&(Aa=null),Ca=0,xa=!1,25<=i)throw Error(s(301));if(i+=1,Ea=Ta=null,null!=e.updateQueue){var a=e.updateQueue;a.lastEffect=null,a.events=null,a.stores=null,null!=a.memoCache&&(a.memoCache.index=0)}P.H=qs,a=t(n,r)}while(xa);return a}function La(){var e=P.H,t=e.useState()[0];return t="function"===typeof t.then?Ba(t):t,e=e.useState()[0],(null!==Ta?Ta.memoizedState:null)!==e&&(wa.flags|=1024),t}function Ma(){var e=0!==_a;return _a=0,e}function Fa(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function za(e){if(Sa){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}Sa=!1}ba=0,Ea=Ta=wa=null,xa=!1,Ca=_a=0,Aa=null}function Ua(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Ea?wa.memoizedState=Ea=e:Ea=Ea.next=e,Ea}function ja(){if(null===Ta){var e=wa.alternate;e=null!==e?e.memoizedState:null}else e=Ta.next;var t=null===Ea?wa.memoizedState:Ea.next;if(null!==t)Ea=t,Ta=e;else{if(null===e){if(null===wa.alternate)throw Error(s(467));throw Error(s(310))}e={memoizedState:(Ta=e).memoizedState,baseState:Ta.baseState,baseQueue:Ta.baseQueue,queue:Ta.queue,next:null},null===Ea?wa.memoizedState=Ea=e:Ea=Ea.next=e}return Ea}function Ba(e){var t=Ca;return Ca+=1,null===Aa&&(Aa=[]),e=Ji(Aa,e,t),t=wa,null===(null===Ea?t.memoizedState:Ea.next)&&(t=t.alternate,P.H=null===t||null===t.memoizedState?Gs:Ks),e}function Va(e){if(null!==e&&"object"===typeof e){if("function"===typeof e.then)return Ba(e);if(e.$$typeof===T)return Ci(e)}throw Error(s(438,String(e)))}function $a(e){var t=null,n=wa.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var r=wa.alternate;null!==r&&(null!==(r=r.updateQueue)&&(null!=(r=r.memoCache)&&(t={data:r.data.map((function(e){return e.slice()})),index:0})))}if(null==t&&(t={data:[],index:0}),null===n&&(n={lastEffect:null,events:null,stores:null,memoCache:null},wa.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index]))for(n=t.data[t.index]=Array(e),r=0;r<e;r++)n[r]=A;return t.index++,n}function Ha(e,t){return"function"===typeof t?t(e):t}function Wa(e){return Ga(ja(),Ta,e)}function Ga(e,t,n){var r=e.queue;if(null===r)throw Error(s(311));r.lastRenderedReducer=n;var i=e.baseQueue,a=r.pending;if(null!==a){if(null!==i){var o=i.next;i.next=a.next,a.next=o}t.baseQueue=i=a,r.pending=null}if(a=e.baseState,null===i)e.memoizedState=a;else{var l=o=null,c=null,u=t=i.next,h=!1;do{var f=-536870913&u.lane;if(f!==u.lane?(sc&f)===f:(ba&f)===f){var d=u.revertLane;if(0===d)null!==c&&(c=c.next={lane:0,revertLane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),f===zi&&(h=!0);else{if((ba&d)===d){u=u.next,d===zi&&(h=!0);continue}f={lane:0,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=f,o=a):c=c.next=f,wa.lanes|=d,pc|=d}f=u.action,ka&&n(a,f),a=u.hasEagerState?u.eagerState:n(a,f)}else d={lane:f,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=d,o=a):c=c.next=d,wa.lanes|=f,pc|=f;u=u.next}while(null!==u&&u!==t);if(null===c?o=a:c.next=l,!Xn(a,e.memoizedState)&&(Ao=!0,h&&null!==(n=Ui)))throw n;e.memoizedState=a,e.baseState=o,e.baseQueue=c,r.lastRenderedState=a}return null===i&&(r.lanes=0),[e.memoizedState,r.dispatch]}function Ka(e){var t=ja(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,a=t.memoizedState;if(null!==i){n.pending=null;var o=i=i.next;do{a=e(a,o.action),o=o.next}while(o!==i);Xn(a,t.memoizedState)||(Ao=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function qa(e,t,n){var r=wa,i=ja(),a=si;if(a){if(void 0===n)throw Error(s(407));n=n()}else n=t();var o=!Xn((Ta||i).memoizedState,n);if(o&&(i.memoizedState=n,Ao=!0),i=i.queue,vs(2048,8,Qa.bind(null,r,i,e),[e]),i.getSnapshot!==t||o||null!==Ea&&1&Ea.memoizedState.tag){if(r.flags|=2048,ps(9,{destroy:void 0,resource:void 0},Xa.bind(null,r,i,n,t),null),null===ic)throw Error(s(349));a||0!==(124&ba)||Ya(r,t,n)}return n}function Ya(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=wa.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},wa.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Xa(e,t,n,r){t.value=n,t.getSnapshot=r,Ja(t)&&Za(e)}function Qa(e,t,n){return n((function(){Ja(t)&&Za(e)}))}function Ja(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Xn(e,n)}catch(r){return!0}}function Za(e){var t=Or(e,2);null!==t&&Fc(t,e,2)}function es(e){var t=Ua();if("function"===typeof e){var n=e;if(e=n(),ka){fe(!0);try{n()}finally{fe(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ha,lastRenderedState:e},t}function ts(e,t,n,r){return e.baseState=n,Ga(e,Ta,"function"===typeof r?r:Ha)}function ns(e,t,n,r,i){if(Vs(e))throw Error(s(485));if(null!==(e=t.action)){var a={payload:i,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){a.listeners.push(e)}};null!==P.T?n(!0):a.isTransition=!1,r(a),null===(n=t.pending)?(a.next=t.pending=a,rs(t,a)):(a.next=n.next,t.pending=n.next=a)}}function rs(e,t){var n=t.action,r=t.payload,i=e.state;if(t.isTransition){var a=P.T,s={};P.T=s;try{var o=n(i,r),l=P.S;null!==l&&l(s,o),is(e,t,o)}catch(c){ss(e,t,c)}finally{P.T=a}}else try{is(e,t,a=n(i,r))}catch(u){ss(e,t,u)}}function is(e,t,n){null!==n&&"object"===typeof n&&"function"===typeof n.then?n.then((function(n){as(e,t,n)}),(function(n){return ss(e,t,n)})):as(e,t,n)}function as(e,t,n){t.status="fulfilled",t.value=n,os(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,rs(e,n)))}function ss(e,t,n){var r=e.pending;if(e.pending=null,null!==r){r=r.next;do{t.status="rejected",t.reason=n,os(t),t=t.next}while(t!==r)}e.action=null}function os(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function ls(e,t){return t}function cs(e,t){if(si){var n=ic.formState;if(null!==n){e:{var r=wa;if(si){if(ai){t:{for(var i=ai,a=li;8!==i.nodeType;){if(!a){i=null;break t}if(null===(i=yh(i.nextSibling))){i=null;break t}}i="F!"===(a=i.data)||"F"===a?i:null}if(i){ai=yh(i.nextSibling),r="F!"===i.data;break e}}ui(r)}r=!1}r&&(t=n[0])}}return(n=Ua()).memoizedState=n.baseState=t,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ls,lastRenderedState:t},n.queue=r,n=Us.bind(null,wa,r),r.dispatch=n,r=es(!1),a=Bs.bind(null,wa,!1,r.queue),i={state:t,dispatch:null,action:e,pending:null},(r=Ua()).queue=i,n=ns.bind(null,wa,i,a,n),i.dispatch=n,r.memoizedState=e,[t,n,!1]}function us(e){return hs(ja(),Ta,e)}function hs(e,t,n){if(t=Ga(e,t,ls)[0],e=Wa(Ha)[0],"object"===typeof t&&null!==t&&"function"===typeof t.then)try{var r=Ba(t)}catch(Xt){if(Xt===Gi)throw qi;throw Xt}else r=t;var i=(t=ja()).queue,a=i.dispatch;return n!==t.memoizedState&&(wa.flags|=2048,ps(9,{destroy:void 0,resource:void 0},fs.bind(null,i,n),null)),[r,a,e]}function fs(e,t){e.action=t}function ds(e){var t=ja(),n=Ta;if(null!==n)return hs(t,n,e);ja(),t=t.memoizedState;var r=(n=ja()).queue.dispatch;return n.memoizedState=e,[t,r,!1]}function ps(e,t,n,r){return e={tag:e,create:n,deps:r,inst:t,next:null},null===(t=wa.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},wa.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function ms(){return ja().memoizedState}function gs(e,t,n,r){var i=Ua();r=void 0===r?null:r,wa.flags|=e,i.memoizedState=ps(1|t,{destroy:void 0,resource:void 0},n,r)}function vs(e,t,n,r){var i=ja();r=void 0===r?null:r;var a=i.memoizedState.inst;null!==Ta&&null!==r&&Da(r,Ta.memoizedState.deps)?i.memoizedState=ps(t,a,n,r):(wa.flags|=e,i.memoizedState=ps(1|t,a,n,r))}function ys(e,t){gs(8390656,8,e,t)}function bs(e,t){vs(2048,8,e,t)}function ws(e,t){return vs(4,2,e,t)}function Ts(e,t){return vs(4,4,e,t)}function Es(e,t){if("function"===typeof t){e=e();var n=t(e);return function(){"function"===typeof n?n():t(null)}}if(null!==t&&void 0!==t)return e=e(),t.current=e,function(){t.current=null}}function Ss(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,vs(4,4,Es.bind(null,t,e),n)}function xs(){}function ks(e,t){var n=ja();t=void 0===t?null:t;var r=n.memoizedState;return null!==t&&Da(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function _s(e,t){var n=ja();t=void 0===t?null:t;var r=n.memoizedState;if(null!==t&&Da(t,r[1]))return r[0];if(r=e(),ka){fe(!0);try{e()}finally{fe(!1)}}return n.memoizedState=[r,t],r}function Cs(e,t,n){return void 0===n||0!==(1073741824&ba)?e.memoizedState=t:(e.memoizedState=n,e=Mc(),wa.lanes|=e,pc|=e,n)}function As(e,t,n,r){return Xn(n,t)?n:null!==pa.current?(e=Cs(e,n,r),Xn(e,t)||(Ao=!0),e):0===(42&ba)?(Ao=!0,e.memoizedState=n):(e=Mc(),wa.lanes|=e,pc|=e,t)}function Is(e,t,n,r,i){var a=L.p;L.p=0!==a&&8>a?a:8;var s=P.T,o={};P.T=o,Bs(e,!1,t,n);try{var l=i(),c=P.S;if(null!==c&&c(o,l),null!==l&&"object"===typeof l&&"function"===typeof l.then)js(e,t,function(e,t){var n=[],r={status:"pending",value:null,reason:null,then:function(e){n.push(e)}};return e.then((function(){r.status="fulfilled",r.value=t;for(var e=0;e<n.length;e++)(0,n[e])(t)}),(function(e){for(r.status="rejected",r.reason=e,e=0;e<n.length;e++)(0,n[e])(void 0)})),r}(l,r),Lc());else js(e,t,r,Lc())}catch(u){js(e,t,{then:function(){},status:"rejected",reason:u},Lc())}finally{L.p=a,P.T=s}}function Ns(){}function Ds(e,t,n,r){if(5!==e.tag)throw Error(s(476));var i=Os(e).queue;Is(e,i,t,M,null===n?Ns:function(){return Rs(e),n(r)})}function Os(e){var t=e.memoizedState;if(null!==t)return t;var n={};return(t={memoizedState:M,baseState:M,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ha,lastRenderedState:M},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ha,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function Rs(e){js(e,Os(e).next.queue,{},Lc())}function Ps(){return Ci(Yh)}function Ls(){return ja().memoizedState}function Ms(){return ja().memoizedState}function Fs(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var n=Lc(),r=sa(t,e=aa(n),n);return null!==r&&(Fc(r,t,n),oa(r,t,n)),t={cache:Pi()},void(e.payload=t)}t=t.return}}function zs(e,t,n){var r=Lc();n={lane:r,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null},Vs(e)?$s(t,n):null!==(n=Dr(e,t,n,r))&&(Fc(n,e,r),Hs(n,t,r))}function Us(e,t,n){js(e,t,n,Lc())}function js(e,t,n,r){var i={lane:r,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null};if(Vs(e))$s(t,i);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var s=t.lastRenderedState,o=a(s,n);if(i.hasEagerState=!0,i.eagerState=o,Xn(o,s))return Nr(e,t,i,0),null===ic&&Ir(),!1}catch(l){}if(null!==(n=Dr(e,t,i,r)))return Fc(n,e,r),Hs(n,t,r),!0}return!1}function Bs(e,t,n,r){if(r={lane:2,revertLane:Nu(),action:r,hasEagerState:!1,eagerState:null,next:null},Vs(e)){if(t)throw Error(s(479))}else null!==(t=Dr(e,n,r,2))&&Fc(t,e,2)}function Vs(e){var t=e.alternate;return e===wa||null!==t&&t===wa}function $s(e,t){xa=Sa=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Hs(e,t,n){if(0!==(4194048&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Ce(e,n)}}var Ws={readContext:Ci,use:Va,useCallback:Na,useContext:Na,useEffect:Na,useImperativeHandle:Na,useLayoutEffect:Na,useInsertionEffect:Na,useMemo:Na,useReducer:Na,useRef:Na,useState:Na,useDebugValue:Na,useDeferredValue:Na,useTransition:Na,useSyncExternalStore:Na,useId:Na,useHostTransitionStatus:Na,useFormState:Na,useActionState:Na,useOptimistic:Na,useMemoCache:Na,useCacheRefresh:Na},Gs={readContext:Ci,use:Va,useCallback:function(e,t){return Ua().memoizedState=[e,void 0===t?null:t],e},useContext:Ci,useEffect:ys,useImperativeHandle:function(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,gs(4194308,4,Es.bind(null,t,e),n)},useLayoutEffect:function(e,t){return gs(4194308,4,e,t)},useInsertionEffect:function(e,t){gs(4,2,e,t)},useMemo:function(e,t){var n=Ua();t=void 0===t?null:t;var r=e();if(ka){fe(!0);try{e()}finally{fe(!1)}}return n.memoizedState=[r,t],r},useReducer:function(e,t,n){var r=Ua();if(void 0!==n){var i=n(t);if(ka){fe(!0);try{n(t)}finally{fe(!1)}}}else i=t;return r.memoizedState=r.baseState=i,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:i},r.queue=e,e=e.dispatch=zs.bind(null,wa,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},Ua().memoizedState=e},useState:function(e){var t=(e=es(e)).queue,n=Us.bind(null,wa,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:xs,useDeferredValue:function(e,t){return Cs(Ua(),e,t)},useTransition:function(){var e=es(!1);return e=Is.bind(null,wa,e.queue,!0,!1),Ua().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var r=wa,i=Ua();if(si){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===ic)throw Error(s(349));0!==(124&sc)||Ya(r,t,n)}i.memoizedState=n;var a={value:n,getSnapshot:t};return i.queue=a,ys(Qa.bind(null,r,a,e),[e]),r.flags|=2048,ps(9,{destroy:void 0,resource:void 0},Xa.bind(null,r,a,n,t),null),n},useId:function(){var e=Ua(),t=ic.identifierPrefix;if(si){var n=Zr;t="\xab"+t+"R"+(n=(Jr&~(1<<32-de(Jr)-1)).toString(32)+n),0<(n=_a++)&&(t+="H"+n.toString(32)),t+="\xbb"}else t="\xab"+t+"r"+(n=Ia++).toString(32)+"\xbb";return e.memoizedState=t},useHostTransitionStatus:Ps,useFormState:cs,useActionState:cs,useOptimistic:function(e){var t=Ua();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=Bs.bind(null,wa,!0,n),n.dispatch=t,[e,t]},useMemoCache:$a,useCacheRefresh:function(){return Ua().memoizedState=Fs.bind(null,wa)}},Ks={readContext:Ci,use:Va,useCallback:ks,useContext:Ci,useEffect:bs,useImperativeHandle:Ss,useInsertionEffect:ws,useLayoutEffect:Ts,useMemo:_s,useReducer:Wa,useRef:ms,useState:function(){return Wa(Ha)},useDebugValue:xs,useDeferredValue:function(e,t){return As(ja(),Ta.memoizedState,e,t)},useTransition:function(){var e=Wa(Ha)[0],t=ja().memoizedState;return["boolean"===typeof e?e:Ba(e),t]},useSyncExternalStore:qa,useId:Ls,useHostTransitionStatus:Ps,useFormState:us,useActionState:us,useOptimistic:function(e,t){return ts(ja(),0,e,t)},useMemoCache:$a,useCacheRefresh:Ms},qs={readContext:Ci,use:Va,useCallback:ks,useContext:Ci,useEffect:bs,useImperativeHandle:Ss,useInsertionEffect:ws,useLayoutEffect:Ts,useMemo:_s,useReducer:Ka,useRef:ms,useState:function(){return Ka(Ha)},useDebugValue:xs,useDeferredValue:function(e,t){var n=ja();return null===Ta?Cs(n,e,t):As(n,Ta.memoizedState,e,t)},useTransition:function(){var e=Ka(Ha)[0],t=ja().memoizedState;return["boolean"===typeof e?e:Ba(e),t]},useSyncExternalStore:qa,useId:Ls,useHostTransitionStatus:Ps,useFormState:ds,useActionState:ds,useOptimistic:function(e,t){var n=ja();return null!==Ta?ts(n,0,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:$a,useCacheRefresh:Ms},Ys=null,Xs=0;function Qs(e){var t=Xs;return Xs+=1,null===Ys&&(Ys=[]),Ji(Ys,e,t)}function Js(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function Zs(e,t){if(t.$$typeof===d)throw Error(s(525));throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function eo(e){return(0,e._init)(e._payload)}function to(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function i(e,t){return(e=Ur(e,t)).index=0,e.sibling=null,e}function a(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=67108866,n):r:(t.flags|=67108866,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=$r(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){var a=n.type;return a===g?h(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===a||"object"===typeof a&&null!==a&&a.$$typeof===_&&eo(a)===t.type)?(Js(t=i(t,n.props),n),t.return=e,t):(Js(t=Br(n.type,n.key,n.props,null,e.mode,r),n),t.return=e,t)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Hr(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function h(e,t,n,r,a){return null===t||7!==t.tag?((t=Vr(n,e.mode,r,a)).return=e,t):((t=i(t,n)).return=e,t)}function f(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t||"bigint"===typeof t)return(t=$r(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case p:return Js(n=Br(t.type,t.key,t.props,null,e.mode,n),t),n.return=e,n;case m:return(t=Hr(t,e.mode,n)).return=e,t;case _:return f(e,t=(0,t._init)(t._payload),n)}if(R(t)||N(t))return(t=Vr(t,e.mode,n,null)).return=e,t;if("function"===typeof t.then)return f(e,Qs(t),n);if(t.$$typeof===T)return f(e,Ai(e,t),n);Zs(e,t)}return null}function d(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n||"bigint"===typeof n)return null!==i?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case p:return n.key===i?c(e,t,n,r):null;case m:return n.key===i?u(e,t,n,r):null;case _:return d(e,t,n=(i=n._init)(n._payload),r)}if(R(n)||N(n))return null!==i?null:h(e,t,n,r,null);if("function"===typeof n.then)return d(e,t,Qs(n),r);if(n.$$typeof===T)return d(e,t,Ai(e,n),r);Zs(e,n)}return null}function v(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r||"bigint"===typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case p:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case m:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case _:return v(e,t,n,r=(0,r._init)(r._payload),i)}if(R(r)||N(r))return h(t,e=e.get(n)||null,r,i,null);if("function"===typeof r.then)return v(e,t,n,Qs(r),i);if(r.$$typeof===T)return v(e,t,n,Ai(t,r),i);Zs(t,r)}return null}function y(l,c,u,h){if("object"===typeof u&&null!==u&&u.type===g&&null===u.key&&(u=u.props.children),"object"===typeof u&&null!==u){switch(u.$$typeof){case p:e:{for(var b=u.key;null!==c;){if(c.key===b){if((b=u.type)===g){if(7===c.tag){n(l,c.sibling),(h=i(c,u.props.children)).return=l,l=h;break e}}else if(c.elementType===b||"object"===typeof b&&null!==b&&b.$$typeof===_&&eo(b)===c.type){n(l,c.sibling),Js(h=i(c,u.props),u),h.return=l,l=h;break e}n(l,c);break}t(l,c),c=c.sibling}u.type===g?((h=Vr(u.props.children,l.mode,h,u.key)).return=l,l=h):(Js(h=Br(u.type,u.key,u.props,null,l.mode,h),u),h.return=l,l=h)}return o(l);case m:e:{for(b=u.key;null!==c;){if(c.key===b){if(4===c.tag&&c.stateNode.containerInfo===u.containerInfo&&c.stateNode.implementation===u.implementation){n(l,c.sibling),(h=i(c,u.children||[])).return=l,l=h;break e}n(l,c);break}t(l,c),c=c.sibling}(h=Hr(u,l.mode,h)).return=l,l=h}return o(l);case _:return y(l,c,u=(b=u._init)(u._payload),h)}if(R(u))return function(i,s,o,l){for(var c=null,u=null,h=s,p=s=0,m=null;null!==h&&p<o.length;p++){h.index>p?(m=h,h=null):m=h.sibling;var g=d(i,h,o[p],l);if(null===g){null===h&&(h=m);break}e&&h&&null===g.alternate&&t(i,h),s=a(g,s,p),null===u?c=g:u.sibling=g,u=g,h=m}if(p===o.length)return n(i,h),si&&ei(i,p),c;if(null===h){for(;p<o.length;p++)null!==(h=f(i,o[p],l))&&(s=a(h,s,p),null===u?c=h:u.sibling=h,u=h);return si&&ei(i,p),c}for(h=r(h);p<o.length;p++)null!==(m=v(h,i,p,o[p],l))&&(e&&null!==m.alternate&&h.delete(null===m.key?p:m.key),s=a(m,s,p),null===u?c=m:u.sibling=m,u=m);return e&&h.forEach((function(e){return t(i,e)})),si&&ei(i,p),c}(l,c,u,h);if(N(u)){if("function"!==typeof(b=N(u)))throw Error(s(150));return function(i,o,l,c){if(null==l)throw Error(s(151));for(var u=null,h=null,p=o,m=o=0,g=null,y=l.next();null!==p&&!y.done;m++,y=l.next()){p.index>m?(g=p,p=null):g=p.sibling;var b=d(i,p,y.value,c);if(null===b){null===p&&(p=g);break}e&&p&&null===b.alternate&&t(i,p),o=a(b,o,m),null===h?u=b:h.sibling=b,h=b,p=g}if(y.done)return n(i,p),si&&ei(i,m),u;if(null===p){for(;!y.done;m++,y=l.next())null!==(y=f(i,y.value,c))&&(o=a(y,o,m),null===h?u=y:h.sibling=y,h=y);return si&&ei(i,m),u}for(p=r(p);!y.done;m++,y=l.next())null!==(y=v(p,i,m,y.value,c))&&(e&&null!==y.alternate&&p.delete(null===y.key?m:y.key),o=a(y,o,m),null===h?u=y:h.sibling=y,h=y);return e&&p.forEach((function(e){return t(i,e)})),si&&ei(i,m),u}(l,c,u=b.call(u),h)}if("function"===typeof u.then)return y(l,c,Qs(u),h);if(u.$$typeof===T)return y(l,c,Ai(l,u),h);Zs(l,u)}return"string"===typeof u&&""!==u||"number"===typeof u||"bigint"===typeof u?(u=""+u,null!==c&&6===c.tag?(n(l,c.sibling),(h=i(c,u)).return=l,l=h):(n(l,c),(h=$r(u,l.mode,h)).return=l,l=h),o(l)):n(l,c)}return function(e,t,n,r){try{Xs=0;var i=y(e,t,n,r);return Ys=null,i}catch(Xt){if(Xt===Gi||Xt===qi)throw Xt;var a=Fr(29,Xt,null,e.mode);return a.lanes=r,a.return=e,a}}}var no=to(!0),ro=to(!1),io=U(null),ao=null;function so(e){var t=e.alternate;B(uo,1&uo.current),B(io,e),null===ao&&(null===t||null!==pa.current||null!==t.memoizedState)&&(ao=e)}function oo(e){if(22===e.tag){if(B(uo,uo.current),B(io,e),null===ao){var t=e.alternate;null!==t&&null!==t.memoizedState&&(ao=e)}}else lo()}function lo(){B(uo,uo.current),B(io,io.current)}function co(e){j(io),ao===e&&(ao=null),j(uo)}var uo=U(0);function ho(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||vh(n)))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function fo(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:f({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var po={enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Lc(),i=aa(r);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=sa(e,i,r))&&(Fc(t,e,r),oa(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Lc(),i=aa(r);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=sa(e,i,r))&&(Fc(t,e,r),oa(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Lc(),r=aa(n);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=sa(e,r,n))&&(Fc(t,e,n),oa(t,e,n))}};function mo(e,t,n,r,i,a,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,a,s):!t.prototype||!t.prototype.isPureReactComponent||(!Qn(n,r)||!Qn(i,a))}function go(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&po.enqueueReplaceState(t,t.state,null)}function vo(e,t){var n=t;if("ref"in t)for(var r in n={},t)"ref"!==r&&(n[r]=t[r]);if(e=e.defaultProps)for(var i in n===t&&(n=f({},n)),e)void 0===n[i]&&(n[i]=e[i]);return n}var yo="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function bo(e){yo(e)}function wo(e){console.error(e)}function To(e){yo(e)}function Eo(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(n){setTimeout((function(){throw n}))}}function So(e,t,n){try{(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(r){setTimeout((function(){throw r}))}}function xo(e,t,n){return(n=aa(n)).tag=3,n.payload={element:null},n.callback=function(){Eo(e,t)},n}function ko(e){return(e=aa(e)).tag=3,e}function _o(e,t,n,r){var i=n.type.getDerivedStateFromError;if("function"===typeof i){var a=r.value;e.payload=function(){return i(a)},e.callback=function(){So(t,n,r)}}var s=n.stateNode;null!==s&&"function"===typeof s.componentDidCatch&&(e.callback=function(){So(t,n,r),"function"!==typeof i&&(null===kc?kc=new Set([this]):kc.add(this));var e=r.stack;this.componentDidCatch(r.value,{componentStack:null!==e?e:""})})}var Co=Error(s(461)),Ao=!1;function Io(e,t,n,r){t.child=null===e?ro(t,null,n,r):no(t,e.child,n,r)}function No(e,t,n,r,i){n=n.render;var a=t.ref;if("ref"in r){var s={};for(var o in r)"ref"!==o&&(s[o]=r[o])}else s=r;return _i(t),r=Oa(e,t,n,s,a,i),o=Ma(),null===e||Ao?(si&&o&&ni(t),t.flags|=1,Io(e,t,r,i),t.child):(Fa(e,t,i),Xo(e,t,i))}function Do(e,t,n,r,i){if(null===e){var a=n.type;return"function"!==typeof a||zr(a)||void 0!==a.defaultProps||null!==n.compare?((e=Br(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,Oo(e,t,a,r,i))}if(a=e.child,!Qo(e,i)){var s=a.memoizedProps;if((n=null!==(n=n.compare)?n:Qn)(s,r)&&e.ref===t.ref)return Xo(e,t,i)}return t.flags|=1,(e=Ur(a,r)).ref=t.ref,e.return=t,t.child=e}function Oo(e,t,n,r,i){if(null!==e){var a=e.memoizedProps;if(Qn(a,r)&&e.ref===t.ref){if(Ao=!1,t.pendingProps=r=a,!Qo(e,i))return t.lanes=e.lanes,Xo(e,t,i);0!==(131072&e.flags)&&(Ao=!0)}}return Mo(e,t,n,r,i)}function Ro(e,t,n){var r=t.pendingProps,i=r.children,a=null!==e?e.memoizedState:null;if("hidden"===r.mode){if(0!==(128&t.flags)){if(r=null!==a?a.baseLanes|n:n,null!==e){for(i=t.child=e.child,a=0;null!==i;)a=a|i.lanes|i.childLanes,i=i.sibling;t.childLanes=a&~r}else t.childLanes=0,t.child=null;return Po(e,t,r,n)}if(0===(536870912&n))return t.lanes=t.childLanes=536870912,Po(e,t,null!==a?a.baseLanes|n:n,n);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Hi(0,null!==a?a.cachePool:null),null!==a?ga(t,a):va(),oo(t)}else null!==a?(Hi(0,a.cachePool),ga(t,a),lo(),t.memoizedState=null):(null!==e&&Hi(0,null),va(),lo());return Io(e,t,i,n),t.child}function Po(e,t,n,r){var i=$i();return i=null===i?null:{parent:Ri._currentValue,pool:i},t.memoizedState={baseLanes:n,cachePool:i},null!==e&&Hi(0,null),va(),oo(t),null!==e&&xi(e,t,r,!0),null}function Lo(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!==typeof n&&"object"!==typeof n)throw Error(s(284));null!==e&&e.ref===n||(t.flags|=4194816)}}function Mo(e,t,n,r,i){return _i(t),n=Oa(e,t,n,r,void 0,i),r=Ma(),null===e||Ao?(si&&r&&ni(t),t.flags|=1,Io(e,t,n,i),t.child):(Fa(e,t,i),Xo(e,t,i))}function Fo(e,t,n,r,i,a){return _i(t),t.updateQueue=null,n=Pa(t,r,n,i),Ra(e),r=Ma(),null===e||Ao?(si&&r&&ni(t),t.flags|=1,Io(e,t,n,a),t.child):(Fa(e,t,a),Xo(e,t,a))}function zo(e,t,n,r,i){if(_i(t),null===t.stateNode){var a=Lr,s=n.contextType;"object"===typeof s&&null!==s&&(a=Ci(s)),a=new n(r,a),t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,a.updater=po,t.stateNode=a,a._reactInternals=t,(a=t.stateNode).props=r,a.state=t.memoizedState,a.refs={},ra(t),s=n.contextType,a.context="object"===typeof s&&null!==s?Ci(s):Lr,a.state=t.memoizedState,"function"===typeof(s=n.getDerivedStateFromProps)&&(fo(t,n,s,r),a.state=t.memoizedState),"function"===typeof n.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(s=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),s!==a.state&&po.enqueueReplaceState(a,a.state,null),ha(t,r,a,i),ua(),a.state=t.memoizedState),"function"===typeof a.componentDidMount&&(t.flags|=4194308),r=!0}else if(null===e){a=t.stateNode;var o=t.memoizedProps,l=vo(n,o);a.props=l;var c=a.context,u=n.contextType;s=Lr,"object"===typeof u&&null!==u&&(s=Ci(u));var h=n.getDerivedStateFromProps;u="function"===typeof h||"function"===typeof a.getSnapshotBeforeUpdate,o=t.pendingProps!==o,u||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o||c!==s)&&go(t,a,r,s),na=!1;var f=t.memoizedState;a.state=f,ha(t,r,a,i),ua(),c=t.memoizedState,o||f!==c||na?("function"===typeof h&&(fo(t,n,h,r),c=t.memoizedState),(l=na||mo(t,n,l,r,f,c,s))?(u||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.flags|=4194308)):("function"===typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),a.props=r,a.state=c,a.context=s,r=l):("function"===typeof a.componentDidMount&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,ia(e,t),u=vo(n,s=t.memoizedProps),a.props=u,h=t.pendingProps,f=a.context,c=n.contextType,l=Lr,"object"===typeof c&&null!==c&&(l=Ci(c)),(c="function"===typeof(o=n.getDerivedStateFromProps)||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==h||f!==l)&&go(t,a,r,l),na=!1,f=t.memoizedState,a.state=f,ha(t,r,a,i),ua();var d=t.memoizedState;s!==h||f!==d||na||null!==e&&null!==e.dependencies&&ki(e.dependencies)?("function"===typeof o&&(fo(t,n,o,r),d=t.memoizedState),(u=na||mo(t,n,u,r,f,d,l)||null!==e&&null!==e.dependencies&&ki(e.dependencies))?(c||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(r,d,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,d,l)),"function"===typeof a.componentDidUpdate&&(t.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=d),a.props=r,a.state=d,a.context=l,r=u):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),r=!1)}return a=r,Lo(e,t),r=0!==(128&t.flags),a||r?(a=t.stateNode,n=r&&"function"!==typeof n.getDerivedStateFromError?null:a.render(),t.flags|=1,null!==e&&r?(t.child=no(t,e.child,null,i),t.child=no(t,null,n,i)):Io(e,t,n,i),t.memoizedState=a.state,e=t.child):e=Xo(e,t,i),e}function Uo(e,t,n,r){return pi(),t.flags|=256,Io(e,t,n,r),t.child}var jo={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Bo(e){return{baseLanes:e,cachePool:Wi()}}function Vo(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=vc),e}function $o(e,t,n){var r,i=t.pendingProps,a=!1,o=0!==(128&t.flags);if((r=o)||(r=(null===e||null!==e.memoizedState)&&0!==(2&uo.current)),r&&(a=!0,t.flags&=-129),r=0!==(32&t.flags),t.flags&=-33,null===e){if(si){if(a?so(t):lo(),si){var l,c=ai;if(l=c){e:{for(l=c,c=li;8!==l.nodeType;){if(!c){c=null;break e}if(null===(l=yh(l.nextSibling))){c=null;break e}}c=l}null!==c?(t.memoizedState={dehydrated:c,treeContext:null!==Qr?{id:Jr,overflow:Zr}:null,retryLane:536870912,hydrationErrors:null},(l=Fr(18,null,null,0)).stateNode=c,l.return=t,t.child=l,ii=t,ai=null,l=!0):l=!1}l||ui(t)}if(null!==(c=t.memoizedState)&&null!==(c=c.dehydrated))return vh(c)?t.lanes=32:t.lanes=536870912,null;co(t)}return c=i.children,i=i.fallback,a?(lo(),c=Wo({mode:"hidden",children:c},a=t.mode),i=Vr(i,a,n,null),c.return=t,i.return=t,c.sibling=i,t.child=c,(a=t.child).memoizedState=Bo(n),a.childLanes=Vo(e,r,n),t.memoizedState=jo,i):(so(t),Ho(t,c))}if(null!==(l=e.memoizedState)&&null!==(c=l.dehydrated)){if(o)256&t.flags?(so(t),t.flags&=-257,t=Go(e,t,n)):null!==t.memoizedState?(lo(),t.child=e.child,t.flags|=128,t=null):(lo(),a=i.fallback,c=t.mode,i=Wo({mode:"visible",children:i.children},c),(a=Vr(a,c,n,null)).flags|=2,i.return=t,a.return=t,i.sibling=a,t.child=i,no(t,e.child,null,n),(i=t.child).memoizedState=Bo(n),i.childLanes=Vo(e,r,n),t.memoizedState=jo,t=a);else if(so(t),vh(c)){if(r=c.nextSibling&&c.nextSibling.dataset)var u=r.dgst;r=u,(i=Error(s(419))).stack="",i.digest=r,gi({value:i,source:null,stack:null}),t=Go(e,t,n)}else if(Ao||xi(e,t,n,!1),r=0!==(n&e.childLanes),Ao||r){if(null!==(r=ic)&&(0!==(i=0!==((i=0!==(42&(i=n&-n))?1:Ae(i))&(r.suspendedLanes|n))?0:i)&&i!==l.retryLane))throw l.retryLane=i,Or(e,i),Fc(r,e,i),Co;"$?"===c.data||qc(),t=Go(e,t,n)}else"$?"===c.data?(t.flags|=192,t.child=e.child,t=null):(e=l.treeContext,ai=yh(c.nextSibling),ii=t,si=!0,oi=null,li=!1,null!==e&&(Yr[Xr++]=Jr,Yr[Xr++]=Zr,Yr[Xr++]=Qr,Jr=e.id,Zr=e.overflow,Qr=t),(t=Ho(t,i.children)).flags|=4096);return t}return a?(lo(),a=i.fallback,c=t.mode,u=(l=e.child).sibling,(i=Ur(l,{mode:"hidden",children:i.children})).subtreeFlags=65011712&l.subtreeFlags,null!==u?a=Ur(u,a):(a=Vr(a,c,n,null)).flags|=2,a.return=t,i.return=t,i.sibling=a,t.child=i,i=a,a=t.child,null===(c=e.child.memoizedState)?c=Bo(n):(null!==(l=c.cachePool)?(u=Ri._currentValue,l=l.parent!==u?{parent:u,pool:u}:l):l=Wi(),c={baseLanes:c.baseLanes|n,cachePool:l}),a.memoizedState=c,a.childLanes=Vo(e,r,n),t.memoizedState=jo,i):(so(t),e=(n=e.child).sibling,(n=Ur(n,{mode:"visible",children:i.children})).return=t,n.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n)}function Ho(e,t){return(t=Wo({mode:"visible",children:t},e.mode)).return=e,e.child=t}function Wo(e,t){return(e=Fr(22,e,null,t)).lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function Go(e,t,n){return no(t,e.child,null,n),(e=Ho(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Ko(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ei(e.return,t,n)}function qo(e,t,n,r,i){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i)}function Yo(e,t,n){var r=t.pendingProps,i=r.revealOrder,a=r.tail;if(Io(e,t,r.children,n),0!==(2&(r=uo.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Ko(e,n,t);else if(19===e.tag)Ko(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}switch(B(uo,r),i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===ho(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),qo(t,!1,i,n,a);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===ho(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}qo(t,!0,n,null,a);break;case"together":qo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Xo(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),pc|=t.lanes,0===(n&t.childLanes)){if(null===e)return null;if(xi(e,t,n,!1),0===(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Ur(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Ur(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Qo(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!ki(e))}function Jo(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps)Ao=!0;else{if(!Qo(e,n)&&0===(128&t.flags))return Ao=!1,function(e,t,n){switch(t.tag){case 3:G(t,t.stateNode.containerInfo),wi(0,Ri,e.memoizedState.cache),pi();break;case 27:case 5:q(t);break;case 4:G(t,t.stateNode.containerInfo);break;case 10:wi(0,t.type,t.memoizedProps.value);break;case 13:var r=t.memoizedState;if(null!==r)return null!==r.dehydrated?(so(t),t.flags|=128,null):0!==(n&t.child.childLanes)?$o(e,t,n):(so(t),null!==(e=Xo(e,t,n))?e.sibling:null);so(t);break;case 19:var i=0!==(128&e.flags);if((r=0!==(n&t.childLanes))||(xi(e,t,n,!1),r=0!==(n&t.childLanes)),i){if(r)return Yo(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),B(uo,uo.current),r)break;return null;case 22:case 23:return t.lanes=0,Ro(e,t,n);case 24:wi(0,Ri,e.memoizedState.cache)}return Xo(e,t,n)}(e,t,n);Ao=0!==(131072&e.flags)}else Ao=!1,si&&0!==(1048576&t.flags)&&ti(t,qr,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var r=t.elementType,i=r._init;if(r=i(r._payload),t.type=r,"function"!==typeof r){if(void 0!==r&&null!==r){if((i=r.$$typeof)===E){t.tag=11,t=No(null,t,r,e,n);break e}if(i===k){t.tag=14,t=Do(null,t,r,e,n);break e}}throw t=O(r)||r,Error(s(306,t,""))}zr(r)?(e=vo(r,e),t.tag=1,t=zo(null,t,r,e,n)):(t.tag=0,t=Mo(null,t,r,e,n))}return t;case 0:return Mo(e,t,t.type,t.pendingProps,n);case 1:return zo(e,t,r=t.type,i=vo(r,t.pendingProps),n);case 3:e:{if(G(t,t.stateNode.containerInfo),null===e)throw Error(s(387));r=t.pendingProps;var a=t.memoizedState;i=a.element,ia(e,t),ha(t,r,null,n);var o=t.memoizedState;if(r=o.cache,wi(0,Ri,r),r!==a.cache&&Si(t,[Ri],n,!0),ua(),r=o.element,a.isDehydrated){if(a={element:r,isDehydrated:!1,cache:o.cache},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=Uo(e,t,r,n);break e}if(r!==i){gi(i=kr(Error(s(424)),t)),t=Uo(e,t,r,n);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(ai=yh(e.firstChild),ii=t,si=!0,oi=null,li=!0,n=ro(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(pi(),r===i){t=Xo(e,t,n);break e}Io(e,t,r,n)}t=t.child}return t;case 26:return Lo(e,t),null===e?(n=Ih(t.type,null,t.pendingProps,null))?t.memoizedState=n:si||(n=t.type,e=t.pendingProps,(r=ih(H.current).createElement(n))[Oe]=t,r[Re]=e,th(r,n,e),We(r),t.stateNode=r):t.memoizedState=Ih(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return q(t),null===e&&si&&(r=t.stateNode=Th(t.type,t.pendingProps,H.current),ii=t,li=!0,i=ai,ph(t.type)?(bh=i,ai=yh(r.firstChild)):ai=i),Io(e,t,t.pendingProps.children,n),Lo(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&si&&((i=r=ai)&&(null!==(r=function(e,t,n,r){for(;1===e.nodeType;){var i=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!r&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(r){if(!e[Ue])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(a=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(a!==i.rel||e.getAttribute("href")!==(null==i.href||""===i.href?null:i.href)||e.getAttribute("crossorigin")!==(null==i.crossOrigin?null:i.crossOrigin)||e.getAttribute("title")!==(null==i.title?null:i.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((a=e.getAttribute("src"))!==(null==i.src?null:i.src)||e.getAttribute("type")!==(null==i.type?null:i.type)||e.getAttribute("crossorigin")!==(null==i.crossOrigin?null:i.crossOrigin))&&a&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var a=null==i.name?null:""+i.name;if("hidden"===i.type&&e.getAttribute("name")===a)return e}if(null===(e=yh(e.nextSibling)))break}return null}(r,t.type,t.pendingProps,li))?(t.stateNode=r,ii=t,ai=yh(r.firstChild),li=!1,i=!0):i=!1),i||ui(t)),q(t),i=t.type,a=t.pendingProps,o=null!==e?e.memoizedProps:null,r=a.children,oh(i,a)?r=null:null!==o&&oh(i,o)&&(t.flags|=32),null!==t.memoizedState&&(i=Oa(e,t,La,null,null,n),Yh._currentValue=i),Lo(e,t),Io(e,t,r,n),t.child;case 6:return null===e&&si&&((e=n=ai)&&(null!==(n=function(e,t,n){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!n)return null;if(null===(e=yh(e.nextSibling)))return null}return e}(n,t.pendingProps,li))?(t.stateNode=n,ii=t,ai=null,e=!0):e=!1),e||ui(t)),null;case 13:return $o(e,t,n);case 4:return G(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=no(t,null,r,n):Io(e,t,r,n),t.child;case 11:return No(e,t,t.type,t.pendingProps,n);case 7:return Io(e,t,t.pendingProps,n),t.child;case 8:case 12:return Io(e,t,t.pendingProps.children,n),t.child;case 10:return r=t.pendingProps,wi(0,t.type,r.value),Io(e,t,r.children,n),t.child;case 9:return i=t.type._context,r=t.pendingProps.children,_i(t),r=r(i=Ci(i)),t.flags|=1,Io(e,t,r,n),t.child;case 14:return Do(e,t,t.type,t.pendingProps,n);case 15:return Oo(e,t,t.type,t.pendingProps,n);case 19:return Yo(e,t,n);case 31:return r=t.pendingProps,n=t.mode,r={mode:r.mode,children:r.children},null===e?((n=Wo(r,n)).ref=t.ref,t.child=n,n.return=t,t=n):((n=Ur(e.child,r)).ref=t.ref,t.child=n,n.return=t,t=n),t;case 22:return Ro(e,t,n);case 24:return _i(t),r=Ci(Ri),null===e?(null===(i=$i())&&(i=ic,a=Pi(),i.pooledCache=a,a.refCount++,null!==a&&(i.pooledCacheLanes|=n),i=a),t.memoizedState={parent:r,cache:i},ra(t),wi(0,Ri,i)):(0!==(e.lanes&n)&&(ia(e,t),ha(t,null,null,n),ua()),i=e.memoizedState,a=t.memoizedState,i.parent!==r?(i={parent:r,cache:r},t.memoizedState=i,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=i),wi(0,Ri,r)):(r=a.cache,wi(0,Ri,r),r!==i.cache&&Si(t,[Ri],n,!0))),Io(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(s(156,t.tag))}function Zo(e){e.flags|=4}function el(e,t){if("stylesheet"!==t.type||0!==(4&t.state.loading))e.flags&=-16777217;else if(e.flags|=16777216,!Vh(t)){if(null!==(t=io.current)&&((4194048&sc)===sc?null!==ao:(62914560&sc)!==sc&&0===(536870912&sc)||t!==ao))throw Zi=Yi,Ki;e.flags|=8192}}function tl(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?Se():536870912,e.lanes|=t,yc|=t)}function nl(e,t){if(!si)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function rl(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=65011712&i.subtreeFlags,r|=65011712&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function il(e,t,n){var r=t.pendingProps;switch(ri(t),t.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return rl(t),null;case 3:return n=t.stateNode,r=null,null!==e&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),Ti(Ri),K(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(di(t)?Zo(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,mi())),rl(t),null;case 26:return n=t.memoizedState,null===e?(Zo(t),null!==n?(rl(t),el(t,n)):(rl(t),t.flags&=-16777217)):n?n!==e.memoizedState?(Zo(t),rl(t),el(t,n)):(rl(t),t.flags&=-16777217):(e.memoizedProps!==r&&Zo(t),rl(t),t.flags&=-16777217),null;case 27:Y(t),n=H.current;var i=t.type;if(null!==e&&null!=t.stateNode)e.memoizedProps!==r&&Zo(t);else{if(!r){if(null===t.stateNode)throw Error(s(166));return rl(t),null}e=V.current,di(t)?hi(t):(e=Th(i,r,n),t.stateNode=e,Zo(t))}return rl(t),null;case 5:if(Y(t),n=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==r&&Zo(t);else{if(!r){if(null===t.stateNode)throw Error(s(166));return rl(t),null}if(e=V.current,di(t))hi(t);else{switch(i=ih(H.current),e){case 1:e=i.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:e=i.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":e=i.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":e=i.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":(e=i.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e="string"===typeof r.is?i.createElement("select",{is:r.is}):i.createElement("select"),r.multiple?e.multiple=!0:r.size&&(e.size=r.size);break;default:e="string"===typeof r.is?i.createElement(n,{is:r.is}):i.createElement(n)}}e[Oe]=t,e[Re]=r;e:for(i=t.child;null!==i;){if(5===i.tag||6===i.tag)e.appendChild(i.stateNode);else if(4!==i.tag&&27!==i.tag&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break e;for(;null===i.sibling;){if(null===i.return||i.return===t)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}t.stateNode=e;e:switch(th(e,n,r),n){case"button":case"input":case"select":case"textarea":e=!!r.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&Zo(t)}}return rl(t),t.flags&=-16777217,null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==r&&Zo(t);else{if("string"!==typeof r&&null===t.stateNode)throw Error(s(166));if(e=H.current,di(t)){if(e=t.stateNode,n=t.memoizedProps,r=null,null!==(i=ii))switch(i.tag){case 27:case 5:r=i.memoizedProps}e[Oe]=t,(e=!!(e.nodeValue===n||null!==r&&!0===r.suppressHydrationWarning||Qu(e.nodeValue,n)))||ui(t)}else(e=ih(e).createTextNode(r))[Oe]=t,t.stateNode=e}return rl(t),null;case 13:if(r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(i=di(t),null!==r&&null!==r.dehydrated){if(null===e){if(!i)throw Error(s(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(s(317));i[Oe]=t}else pi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;rl(t),i=!1}else i=mi(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=i),i=!0;if(!i)return 256&t.flags?(co(t),t):(co(t),null)}if(co(t),0!==(128&t.flags))return t.lanes=n,t;if(n=null!==r,e=null!==e&&null!==e.memoizedState,n){i=null,null!==(r=t.child).alternate&&null!==r.alternate.memoizedState&&null!==r.alternate.memoizedState.cachePool&&(i=r.alternate.memoizedState.cachePool.pool);var a=null;null!==r.memoizedState&&null!==r.memoizedState.cachePool&&(a=r.memoizedState.cachePool.pool),a!==i&&(r.flags|=2048)}return n!==e&&n&&(t.child.flags|=8192),tl(t,t.updateQueue),rl(t),null;case 4:return K(),null===e&&Bu(t.stateNode.containerInfo),rl(t),null;case 10:return Ti(t.type),rl(t),null;case 19:if(j(uo),null===(i=t.memoizedState))return rl(t),null;if(r=0!==(128&t.flags),null===(a=i.rendering))if(r)nl(i,!1);else{if(0!==dc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(a=ho(e))){for(t.flags|=128,nl(i,!1),e=a.updateQueue,t.updateQueue=e,tl(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)jr(n,e),n=n.sibling;return B(uo,1&uo.current|2),t.child}e=e.sibling}null!==i.tail&&te()>Sc&&(t.flags|=128,r=!0,nl(i,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ho(a))){if(t.flags|=128,r=!0,e=e.updateQueue,t.updateQueue=e,tl(t,e),nl(i,!0),null===i.tail&&"hidden"===i.tailMode&&!a.alternate&&!si)return rl(t),null}else 2*te()-i.renderingStartTime>Sc&&536870912!==n&&(t.flags|=128,r=!0,nl(i,!1),t.lanes=4194304);i.isBackwards?(a.sibling=t.child,t.child=a):(null!==(e=i.last)?e.sibling=a:t.child=a,i.last=a)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=te(),t.sibling=null,e=uo.current,B(uo,r?1&e|2:1&e),t):(rl(t),null);case 22:case 23:return co(t),ya(),r=null!==t.memoizedState,null!==e?null!==e.memoizedState!==r&&(t.flags|=8192):r&&(t.flags|=8192),r?0!==(536870912&n)&&0===(128&t.flags)&&(rl(t),6&t.subtreeFlags&&(t.flags|=8192)):rl(t),null!==(n=t.updateQueue)&&tl(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),r=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(r=t.memoizedState.cachePool.pool),r!==n&&(t.flags|=2048),null!==e&&j(Vi),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Ti(Ri),rl(t),null;case 25:case 30:return null}throw Error(s(156,t.tag))}function al(e,t){switch(ri(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ti(Ri),K(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return Y(t),null;case 13:if(co(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));pi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return j(uo),null;case 4:return K(),null;case 10:return Ti(t.type),null;case 22:case 23:return co(t),ya(),null!==e&&j(Vi),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return Ti(Ri),null;default:return null}}function sl(e,t){switch(ri(t),t.tag){case 3:Ti(Ri),K();break;case 26:case 27:case 5:Y(t);break;case 4:K();break;case 13:co(t);break;case 19:j(uo);break;case 10:Ti(t.type);break;case 22:case 23:co(t),ya(),null!==e&&j(Vi);break;case 24:Ti(Ri)}}function ol(e,t){try{var n=t.updateQueue,r=null!==n?n.lastEffect:null;if(null!==r){var i=r.next;n=i;do{if((n.tag&e)===e){r=void 0;var a=n.create,s=n.inst;r=a(),s.destroy=r}n=n.next}while(n!==i)}}catch(o){hu(t,t.return,o)}}function ll(e,t,n){try{var r=t.updateQueue,i=null!==r?r.lastEffect:null;if(null!==i){var a=i.next;r=a;do{if((r.tag&e)===e){var s=r.inst,o=s.destroy;if(void 0!==o){s.destroy=void 0,i=t;var l=n,c=o;try{c()}catch(u){hu(i,l,u)}}}r=r.next}while(r!==a)}}catch(u){hu(t,t.return,u)}}function cl(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;try{da(t,n)}catch(r){hu(e,e.return,r)}}}function ul(e,t,n){n.props=vo(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(r){hu(e,t,r)}}function hl(e,t){try{var n=e.ref;if(null!==n){switch(e.tag){case 26:case 27:case 5:var r=e.stateNode;break;default:r=e.stateNode}"function"===typeof n?e.refCleanup=n(r):n.current=r}}catch(i){hu(e,t,i)}}function fl(e,t){var n=e.ref,r=e.refCleanup;if(null!==n)if("function"===typeof r)try{r()}catch(i){hu(e,t,i)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"===typeof n)try{n(null)}catch(a){hu(e,t,a)}else n.current=null}function dl(e){var t=e.type,n=e.memoizedProps,r=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&r.focus();break e;case"img":n.src?r.src=n.src:n.srcSet&&(r.srcset=n.srcSet)}}catch(i){hu(e,e.return,i)}}function pl(e,t,n){try{var r=e.stateNode;!function(e,t,n,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var i=null,a=null,o=null,l=null,c=null,u=null,h=null;for(p in n){var f=n[p];if(n.hasOwnProperty(p)&&null!=f)switch(p){case"checked":case"value":break;case"defaultValue":c=f;default:r.hasOwnProperty(p)||Zu(e,t,p,null,r,f)}}for(var d in r){var p=r[d];if(f=n[d],r.hasOwnProperty(d)&&(null!=p||null!=f))switch(d){case"type":a=p;break;case"name":i=p;break;case"checked":u=p;break;case"defaultChecked":h=p;break;case"value":o=p;break;case"defaultValue":l=p;break;case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(s(137,t));break;default:p!==f&&Zu(e,t,d,p,r,f)}}return void gt(e,o,l,c,u,h,a,i);case"select":for(a in p=o=l=d=null,n)if(c=n[a],n.hasOwnProperty(a)&&null!=c)switch(a){case"value":break;case"multiple":p=c;default:r.hasOwnProperty(a)||Zu(e,t,a,null,r,c)}for(i in r)if(a=r[i],c=n[i],r.hasOwnProperty(i)&&(null!=a||null!=c))switch(i){case"value":d=a;break;case"defaultValue":l=a;break;case"multiple":o=a;default:a!==c&&Zu(e,t,i,a,r,c)}return t=l,n=o,r=p,void(null!=d?bt(e,!!n,d,!1):!!r!==!!n&&(null!=t?bt(e,!!n,t,!0):bt(e,!!n,n?[]:"",!1)));case"textarea":for(l in p=d=null,n)if(i=n[l],n.hasOwnProperty(l)&&null!=i&&!r.hasOwnProperty(l))switch(l){case"value":case"children":break;default:Zu(e,t,l,null,r,i)}for(o in r)if(i=r[o],a=n[o],r.hasOwnProperty(o)&&(null!=i||null!=a))switch(o){case"value":d=i;break;case"defaultValue":p=i;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=i)throw Error(s(91));break;default:i!==a&&Zu(e,t,o,i,r,a)}return void wt(e,d,p);case"option":for(var m in n)if(d=n[m],n.hasOwnProperty(m)&&null!=d&&!r.hasOwnProperty(m))if("selected"===m)e.selected=!1;else Zu(e,t,m,null,r,d);for(c in r)if(d=r[c],p=n[c],r.hasOwnProperty(c)&&d!==p&&(null!=d||null!=p))if("selected"===c)e.selected=d&&"function"!==typeof d&&"symbol"!==typeof d;else Zu(e,t,c,d,r,p);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var g in n)d=n[g],n.hasOwnProperty(g)&&null!=d&&!r.hasOwnProperty(g)&&Zu(e,t,g,null,r,d);for(u in r)if(d=r[u],p=n[u],r.hasOwnProperty(u)&&d!==p&&(null!=d||null!=p))switch(u){case"children":case"dangerouslySetInnerHTML":if(null!=d)throw Error(s(137,t));break;default:Zu(e,t,u,d,r,p)}return;default:if(_t(t)){for(var v in n)d=n[v],n.hasOwnProperty(v)&&void 0!==d&&!r.hasOwnProperty(v)&&eh(e,t,v,void 0,r,d);for(h in r)d=r[h],p=n[h],!r.hasOwnProperty(h)||d===p||void 0===d&&void 0===p||eh(e,t,h,d,r,p);return}}for(var y in n)d=n[y],n.hasOwnProperty(y)&&null!=d&&!r.hasOwnProperty(y)&&Zu(e,t,y,null,r,d);for(f in r)d=r[f],p=n[f],!r.hasOwnProperty(f)||d===p||null==d&&null==p||Zu(e,t,f,d,r,p)}(r,e.type,n,t),r[Re]=t}catch(i){hu(e,e.return,i)}}function ml(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&ph(e.type)||4===e.tag}function gl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ml(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&ph(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function vl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?(9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).insertBefore(e,t):((t=9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Ju));else if(4!==r&&(27===r&&ph(e.type)&&(n=e.stateNode,t=null),null!==(e=e.child)))for(vl(e,t,n),e=e.sibling;null!==e;)vl(e,t,n),e=e.sibling}function yl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&(27===r&&ph(e.type)&&(n=e.stateNode),null!==(e=e.child)))for(yl(e,t,n),e=e.sibling;null!==e;)yl(e,t,n),e=e.sibling}function bl(e){var t=e.stateNode,n=e.memoizedProps;try{for(var r=e.type,i=t.attributes;i.length;)t.removeAttributeNode(i[0]);th(t,r,n),t[Oe]=e,t[Re]=n}catch(a){hu(e,e.return,a)}}var wl=!1,Tl=!1,El=!1,Sl="function"===typeof WeakSet?WeakSet:Set,xl=null;function kl(e,t,n){var r=n.flags;switch(n.tag){case 0:case 11:case 15:zl(e,n),4&r&&ol(5,n);break;case 1:if(zl(e,n),4&r)if(e=n.stateNode,null===t)try{e.componentDidMount()}catch(s){hu(n,n.return,s)}else{var i=vo(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(i,t,e.__reactInternalSnapshotBeforeUpdate)}catch(o){hu(n,n.return,o)}}64&r&&cl(n),512&r&&hl(n,n.return);break;case 3:if(zl(e,n),64&r&&null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 27:case 5:case 1:t=n.child.stateNode}try{da(e,t)}catch(s){hu(n,n.return,s)}}break;case 27:null===t&&4&r&&bl(n);case 26:case 5:zl(e,n),null===t&&4&r&&dl(n),512&r&&hl(n,n.return);break;case 12:zl(e,n);break;case 13:zl(e,n),4&r&&Dl(e,n),64&r&&(null!==(e=n.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var n=e.ownerDocument;if("$?"!==e.data||"complete"===n.readyState)t();else{var r=function(){t(),n.removeEventListener("DOMContentLoaded",r)};n.addEventListener("DOMContentLoaded",r),e._reactRetry=r}}(e,n=mu.bind(null,n))));break;case 22:if(!(r=null!==n.memoizedState||wl)){t=null!==t&&null!==t.memoizedState||Tl,i=wl;var a=Tl;wl=r,(Tl=t)&&!a?jl(e,n,0!==(8772&n.subtreeFlags)):zl(e,n),wl=i,Tl=a}break;case 30:break;default:zl(e,n)}}function _l(e){var t=e.alternate;null!==t&&(e.alternate=null,_l(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&je(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Cl=null,Al=!1;function Il(e,t,n){for(n=n.child;null!==n;)Nl(e,t,n),n=n.sibling}function Nl(e,t,n){if(he&&"function"===typeof he.onCommitFiberUnmount)try{he.onCommitFiberUnmount(ue,n)}catch(a){}switch(n.tag){case 26:Tl||fl(n,t),Il(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode).parentNode.removeChild(n);break;case 27:Tl||fl(n,t);var r=Cl,i=Al;ph(n.type)&&(Cl=n.stateNode,Al=!1),Il(e,t,n),Eh(n.stateNode),Cl=r,Al=i;break;case 5:Tl||fl(n,t);case 6:if(r=Cl,i=Al,Cl=null,Il(e,t,n),Al=i,null!==(Cl=r))if(Al)try{(9===Cl.nodeType?Cl.body:"HTML"===Cl.nodeName?Cl.ownerDocument.body:Cl).removeChild(n.stateNode)}catch(s){hu(n,t,s)}else try{Cl.removeChild(n.stateNode)}catch(s){hu(n,t,s)}break;case 18:null!==Cl&&(Al?(mh(9===(e=Cl).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,n.stateNode),If(e)):mh(Cl,n.stateNode));break;case 4:r=Cl,i=Al,Cl=n.stateNode.containerInfo,Al=!0,Il(e,t,n),Cl=r,Al=i;break;case 0:case 11:case 14:case 15:Tl||ll(2,n,t),Tl||ll(4,n,t),Il(e,t,n);break;case 1:Tl||(fl(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount&&ul(n,t,r)),Il(e,t,n);break;case 21:Il(e,t,n);break;case 22:Tl=(r=Tl)||null!==n.memoizedState,Il(e,t,n),Tl=r;break;default:Il(e,t,n)}}function Dl(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{If(e)}catch(n){hu(t,t.return,n)}}function Ol(e,t){var n=function(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new Sl),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new Sl),t;default:throw Error(s(435,e.tag))}}(e);t.forEach((function(t){var r=gu.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}function Rl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r],a=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 27:if(ph(l.type)){Cl=l.stateNode,Al=!1;break e}break;case 5:Cl=l.stateNode,Al=!1;break e;case 3:case 4:Cl=l.stateNode.containerInfo,Al=!0;break e}l=l.return}if(null===Cl)throw Error(s(160));Nl(a,o,i),Cl=null,Al=!1,null!==(a=i.alternate)&&(a.return=null),i.return=null}if(13878&t.subtreeFlags)for(t=t.child;null!==t;)Ll(t,e),t=t.sibling}var Pl=null;function Ll(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Rl(t,e),Ml(e),4&r&&(ll(3,e,e.return),ol(3,e),ll(5,e,e.return));break;case 1:Rl(t,e),Ml(e),512&r&&(Tl||null===n||fl(n,n.return)),64&r&&wl&&(null!==(e=e.updateQueue)&&(null!==(r=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?r:n.concat(r))));break;case 26:var i=Pl;if(Rl(t,e),Ml(e),512&r&&(Tl||null===n||fl(n,n.return)),4&r){var a=null!==n?n.memoizedState:null;if(r=e.memoizedState,null===n)if(null===r)if(null===e.stateNode){e:{r=e.type,n=e.memoizedProps,i=i.ownerDocument||i;t:switch(r){case"title":(!(a=i.getElementsByTagName("title")[0])||a[Ue]||a[Oe]||"http://www.w3.org/2000/svg"===a.namespaceURI||a.hasAttribute("itemprop"))&&(a=i.createElement(r),i.head.insertBefore(a,i.querySelector("head > title"))),th(a,r,n),a[Oe]=e,We(a),r=a;break e;case"link":var o=jh("link","href",i).get(r+(n.href||""));if(o)for(var l=0;l<o.length;l++)if((a=o[l]).getAttribute("href")===(null==n.href||""===n.href?null:n.href)&&a.getAttribute("rel")===(null==n.rel?null:n.rel)&&a.getAttribute("title")===(null==n.title?null:n.title)&&a.getAttribute("crossorigin")===(null==n.crossOrigin?null:n.crossOrigin)){o.splice(l,1);break t}th(a=i.createElement(r),r,n),i.head.appendChild(a);break;case"meta":if(o=jh("meta","content",i).get(r+(n.content||"")))for(l=0;l<o.length;l++)if((a=o[l]).getAttribute("content")===(null==n.content?null:""+n.content)&&a.getAttribute("name")===(null==n.name?null:n.name)&&a.getAttribute("property")===(null==n.property?null:n.property)&&a.getAttribute("http-equiv")===(null==n.httpEquiv?null:n.httpEquiv)&&a.getAttribute("charset")===(null==n.charSet?null:n.charSet)){o.splice(l,1);break t}th(a=i.createElement(r),r,n),i.head.appendChild(a);break;default:throw Error(s(468,r))}a[Oe]=e,We(a),r=a}e.stateNode=r}else Bh(i,e.type,e.stateNode);else e.stateNode=Lh(i,r,e.memoizedProps);else a!==r?(null===a?null!==n.stateNode&&(n=n.stateNode).parentNode.removeChild(n):a.count--,null===r?Bh(i,e.type,e.stateNode):Lh(i,r,e.memoizedProps)):null===r&&null!==e.stateNode&&pl(e,e.memoizedProps,n.memoizedProps)}break;case 27:Rl(t,e),Ml(e),512&r&&(Tl||null===n||fl(n,n.return)),null!==n&&4&r&&pl(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Rl(t,e),Ml(e),512&r&&(Tl||null===n||fl(n,n.return)),32&e.flags){i=e.stateNode;try{Et(i,"")}catch(p){hu(e,e.return,p)}}4&r&&null!=e.stateNode&&pl(e,i=e.memoizedProps,null!==n?n.memoizedProps:i),1024&r&&(El=!0);break;case 6:if(Rl(t,e),Ml(e),4&r){if(null===e.stateNode)throw Error(s(162));r=e.memoizedProps,n=e.stateNode;try{n.nodeValue=r}catch(p){hu(e,e.return,p)}}break;case 3:if(Uh=null,i=Pl,Pl=kh(t.containerInfo),Rl(t,e),Pl=i,Ml(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{If(t.containerInfo)}catch(p){hu(e,e.return,p)}El&&(El=!1,Fl(e));break;case 4:r=Pl,Pl=kh(e.stateNode.containerInfo),Rl(t,e),Ml(e),Pl=r;break;case 12:default:Rl(t,e),Ml(e);break;case 13:Rl(t,e),Ml(e),8192&e.child.flags&&null!==e.memoizedState!==(null!==n&&null!==n.memoizedState)&&(Ec=te()),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,Ol(e,r)));break;case 22:i=null!==e.memoizedState;var c=null!==n&&null!==n.memoizedState,u=wl,h=Tl;if(wl=u||i,Tl=h||c,Rl(t,e),Tl=h,wl=u,Ml(e),8192&r)e:for(t=e.stateNode,t._visibility=i?-2&t._visibility:1|t._visibility,i&&(null===n||c||wl||Tl||Ul(e)),n=null,t=e;;){if(5===t.tag||26===t.tag){if(null===n){c=n=t;try{if(a=c.stateNode,i)"function"===typeof(o=a.style).setProperty?o.setProperty("display","none","important"):o.display="none";else{l=c.stateNode;var f=c.memoizedProps.style,d=void 0!==f&&null!==f&&f.hasOwnProperty("display")?f.display:null;l.style.display=null==d||"boolean"===typeof d?"":(""+d).trim()}}catch(p){hu(c,c.return,p)}}}else if(6===t.tag){if(null===n){c=t;try{c.stateNode.nodeValue=i?"":c.memoizedProps}catch(p){hu(c,c.return,p)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}4&r&&(null!==(r=e.updateQueue)&&(null!==(n=r.retryQueue)&&(r.retryQueue=null,Ol(e,n))));break;case 19:Rl(t,e),Ml(e),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,Ol(e,r)));case 30:case 21:}}function Ml(e){var t=e.flags;if(2&t){try{for(var n,r=e.return;null!==r;){if(ml(r)){n=r;break}r=r.return}if(null==n)throw Error(s(160));switch(n.tag){case 27:var i=n.stateNode;yl(e,gl(e),i);break;case 5:var a=n.stateNode;32&n.flags&&(Et(a,""),n.flags&=-33),yl(e,gl(e),a);break;case 3:case 4:var o=n.stateNode.containerInfo;vl(e,gl(e),o);break;default:throw Error(s(161))}}catch(l){hu(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Fl(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Fl(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function zl(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)kl(e,t.alternate,t),t=t.sibling}function Ul(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:ll(4,t,t.return),Ul(t);break;case 1:fl(t,t.return);var n=t.stateNode;"function"===typeof n.componentWillUnmount&&ul(t,t.return,n),Ul(t);break;case 27:Eh(t.stateNode);case 26:case 5:fl(t,t.return),Ul(t);break;case 22:null===t.memoizedState&&Ul(t);break;default:Ul(t)}e=e.sibling}}function jl(e,t,n){for(n=n&&0!==(8772&t.subtreeFlags),t=t.child;null!==t;){var r=t.alternate,i=e,a=t,s=a.flags;switch(a.tag){case 0:case 11:case 15:jl(i,a,n),ol(4,a);break;case 1:if(jl(i,a,n),"function"===typeof(i=(r=a).stateNode).componentDidMount)try{i.componentDidMount()}catch(c){hu(r,r.return,c)}if(null!==(i=(r=a).updateQueue)){var o=r.stateNode;try{var l=i.shared.hiddenCallbacks;if(null!==l)for(i.shared.hiddenCallbacks=null,i=0;i<l.length;i++)fa(l[i],o)}catch(c){hu(r,r.return,c)}}n&&64&s&&cl(a),hl(a,a.return);break;case 27:bl(a);case 26:case 5:jl(i,a,n),n&&null===r&&4&s&&dl(a),hl(a,a.return);break;case 12:jl(i,a,n);break;case 13:jl(i,a,n),n&&4&s&&Dl(i,a);break;case 22:null===a.memoizedState&&jl(i,a,n),hl(a,a.return);break;case 30:break;default:jl(i,a,n)}t=t.sibling}}function Bl(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&e.refCount++,null!=n&&Li(n))}function Vl(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Li(e))}function $l(e,t,n,r){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)Hl(e,t,n,r),t=t.sibling}function Hl(e,t,n,r){var i=t.flags;switch(t.tag){case 0:case 11:case 15:$l(e,t,n,r),2048&i&&ol(9,t);break;case 1:case 13:default:$l(e,t,n,r);break;case 3:$l(e,t,n,r),2048&i&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Li(e)));break;case 12:if(2048&i){$l(e,t,n,r),e=t.stateNode;try{var a=t.memoizedProps,s=a.id,o=a.onPostCommit;"function"===typeof o&&o(s,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(l){hu(t,t.return,l)}}else $l(e,t,n,r);break;case 23:break;case 22:a=t.stateNode,s=t.alternate,null!==t.memoizedState?2&a._visibility?$l(e,t,n,r):Gl(e,t):2&a._visibility?$l(e,t,n,r):(a._visibility|=2,Wl(e,t,n,r,0!==(10256&t.subtreeFlags))),2048&i&&Bl(s,t);break;case 24:$l(e,t,n,r),2048&i&&Vl(t.alternate,t)}}function Wl(e,t,n,r,i){for(i=i&&0!==(10256&t.subtreeFlags),t=t.child;null!==t;){var a=e,s=t,o=n,l=r,c=s.flags;switch(s.tag){case 0:case 11:case 15:Wl(a,s,o,l,i),ol(8,s);break;case 23:break;case 22:var u=s.stateNode;null!==s.memoizedState?2&u._visibility?Wl(a,s,o,l,i):Gl(a,s):(u._visibility|=2,Wl(a,s,o,l,i)),i&&2048&c&&Bl(s.alternate,s);break;case 24:Wl(a,s,o,l,i),i&&2048&c&&Vl(s.alternate,s);break;default:Wl(a,s,o,l,i)}t=t.sibling}}function Gl(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,r=t,i=r.flags;switch(r.tag){case 22:Gl(n,r),2048&i&&Bl(r.alternate,r);break;case 24:Gl(n,r),2048&i&&Vl(r.alternate,r);break;default:Gl(n,r)}t=t.sibling}}var Kl=8192;function ql(e){if(e.subtreeFlags&Kl)for(e=e.child;null!==e;)Yl(e),e=e.sibling}function Yl(e){switch(e.tag){case 26:ql(e),e.flags&Kl&&null!==e.memoizedState&&function(e,t,n){if(null===$h)throw Error(s(475));var r=$h;if("stylesheet"===t.type&&("string"!==typeof n.media||!1!==matchMedia(n.media).matches)&&0===(4&t.state.loading)){if(null===t.instance){var i=Nh(n.href),a=e.querySelector(Dh(i));if(a)return null!==(e=a._p)&&"object"===typeof e&&"function"===typeof e.then&&(r.count++,r=Wh.bind(r),e.then(r,r)),t.state.loading|=4,t.instance=a,void We(a);a=e.ownerDocument||e,n=Oh(n),(i=Sh.get(i))&&Fh(n,i),We(a=a.createElement("link"));var o=a;o._p=new Promise((function(e,t){o.onload=e,o.onerror=t})),th(a,"link",n),t.instance=a}null===r.stylesheets&&(r.stylesheets=new Map),r.stylesheets.set(t,e),(e=t.state.preload)&&0===(3&t.state.loading)&&(r.count++,t=Wh.bind(r),e.addEventListener("load",t),e.addEventListener("error",t))}}(Pl,e.memoizedState,e.memoizedProps);break;case 5:default:ql(e);break;case 3:case 4:var t=Pl;Pl=kh(e.stateNode.containerInfo),ql(e),Pl=t;break;case 22:null===e.memoizedState&&(null!==(t=e.alternate)&&null!==t.memoizedState?(t=Kl,Kl=16777216,ql(e),Kl=t):ql(e))}}function Xl(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function Ql(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];xl=r,ec(r,e)}Xl(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)Jl(e),e=e.sibling}function Jl(e){switch(e.tag){case 0:case 11:case 15:Ql(e),2048&e.flags&&ll(9,e,e.return);break;case 3:case 12:default:Ql(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,Zl(e)):Ql(e)}}function Zl(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];xl=r,ec(r,e)}Xl(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:ll(8,t,t.return),Zl(t);break;case 22:2&(n=t.stateNode)._visibility&&(n._visibility&=-3,Zl(t));break;default:Zl(t)}e=e.sibling}}function ec(e,t){for(;null!==xl;){var n=xl;switch(n.tag){case 0:case 11:case 15:ll(8,n,t);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var r=n.memoizedState.cachePool.pool;null!=r&&r.refCount++}break;case 24:Li(n.memoizedState.cache)}if(null!==(r=n.child))r.return=n,xl=r;else e:for(n=e;null!==xl;){var i=(r=xl).sibling,a=r.return;if(_l(r),r===n){xl=null;break e}if(null!==i){i.return=a,xl=i;break e}xl=a}}}var tc={getCacheForType:function(e){var t=Ci(Ri),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n}},nc="function"===typeof WeakMap?WeakMap:Map,rc=0,ic=null,ac=null,sc=0,oc=0,lc=null,cc=!1,uc=!1,hc=!1,fc=0,dc=0,pc=0,mc=0,gc=0,vc=0,yc=0,bc=null,wc=null,Tc=!1,Ec=0,Sc=1/0,xc=null,kc=null,_c=0,Cc=null,Ac=null,Ic=0,Nc=0,Dc=null,Oc=null,Rc=0,Pc=null;function Lc(){if(0!==(2&rc)&&0!==sc)return sc&-sc;if(null!==P.T){return 0!==zi?zi:Nu()}return Ne()}function Mc(){0===vc&&(vc=0===(536870912&sc)||si?Ee():536870912);var e=io.current;return null!==e&&(e.flags|=32),vc}function Fc(e,t,n){(e!==ic||2!==oc&&9!==oc)&&null===e.cancelPendingCommit||(Hc(e,0),Bc(e,sc,vc,!1)),ke(e,n),0!==(2&rc)&&e===ic||(e===ic&&(0===(2&rc)&&(mc|=n),4===dc&&Bc(e,sc,vc,!1)),Su(e))}function zc(e,t,n){if(0!==(6&rc))throw Error(s(327));for(var r=!n&&0===(124&t)&&0===(t&e.expiredLanes)||we(e,t),i=r?function(e,t){var n=rc;rc|=2;var r=Gc(),i=Kc();ic!==e||sc!==t?(xc=null,Sc=te()+500,Hc(e,t)):uc=we(e,t);e:for(;;)try{if(0!==oc&&null!==ac){t=ac;var a=lc;t:switch(oc){case 1:oc=0,lc=null,eu(e,t,a,1);break;case 2:case 9:if(Xi(a)){oc=0,lc=null,Zc(t);break}t=function(){2!==oc&&9!==oc||ic!==e||(oc=7),Su(e)},a.then(t,t);break e;case 3:oc=7;break e;case 4:oc=5;break e;case 7:Xi(a)?(oc=0,lc=null,Zc(t)):(oc=0,lc=null,eu(e,t,a,7));break;case 5:var o=null;switch(ac.tag){case 26:o=ac.memoizedState;case 5:case 27:var l=ac;if(!o||Vh(o)){oc=0,lc=null;var c=l.sibling;if(null!==c)ac=c;else{var u=l.return;null!==u?(ac=u,tu(u)):ac=null}break t}}oc=0,lc=null,eu(e,t,a,5);break;case 6:oc=0,lc=null,eu(e,t,a,6);break;case 8:$c(),dc=6;break e;default:throw Error(s(462))}}Qc();break}catch(h){Wc(e,h)}return bi=yi=null,P.H=r,P.A=i,rc=n,null!==ac?0:(ic=null,sc=0,Ir(),dc)}(e,t):Yc(e,t,!0),a=r;;){if(0===i){uc&&!r&&Bc(e,t,0,!1);break}if(n=e.current.alternate,!a||jc(n)){if(2===i){if(a=t,e.errorRecoveryDisabledLanes&a)var o=0;else o=0!==(o=-536870913&e.pendingLanes)?o:536870912&o?536870912:0;if(0!==o){t=o;e:{var l=e;i=bc;var c=l.current.memoizedState.isDehydrated;if(c&&(Hc(l,o).flags|=256),2!==(o=Yc(l,o,!1))){if(hc&&!c){l.errorRecoveryDisabledLanes|=a,mc|=a,i=4;break e}a=wc,wc=i,null!==a&&(null===wc?wc=a:wc.push.apply(wc,a))}i=o}if(a=!1,2!==i)continue}}if(1===i){Hc(e,0),Bc(e,t,0,!0);break}e:{switch(r=e,a=i){case 0:case 1:throw Error(s(345));case 4:if((4194048&t)!==t)break;case 6:Bc(r,t,vc,!cc);break e;case 2:wc=null;break;case 3:case 5:break;default:throw Error(s(329))}if((62914560&t)===t&&10<(i=Ec+300-te())){if(Bc(r,t,vc,!cc),0!==be(r,0,!0))break e;r.timeoutHandle=ch(Uc.bind(null,r,n,wc,xc,Tc,t,vc,mc,yc,cc,a,2,-0,0),i)}else Uc(r,n,wc,xc,Tc,t,vc,mc,yc,cc,a,0,-0,0)}break}i=Yc(e,t,!1),a=!1}Su(e)}function Uc(e,t,n,r,i,a,o,l,c,u,h,f,d,p){if(e.timeoutHandle=-1,(8192&(f=t.subtreeFlags)||16785408===(16785408&f))&&($h={stylesheets:null,count:0,unsuspend:Hh},Yl(t),null!==(f=function(){if(null===$h)throw Error(s(475));var e=$h;return e.stylesheets&&0===e.count&&Kh(e,e.stylesheets),0<e.count?function(t){var n=setTimeout((function(){if(e.stylesheets&&Kh(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}}),6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(n)}}:null}())))return e.cancelPendingCommit=f(ru.bind(null,e,t,a,n,r,i,o,l,c,h,1,d,p)),void Bc(e,a,o,!u);ru(e,t,a,n,r,i,o,l,c)}function jc(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&(null!==(n=t.updateQueue)&&null!==(n=n.stores)))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!Xn(a(),i))return!1}catch(s){return!1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Bc(e,t,n,r){t&=~gc,t&=~mc,e.suspendedLanes|=t,e.pingedLanes&=~t,r&&(e.warmLanes|=t),r=e.expirationTimes;for(var i=t;0<i;){var a=31-de(i),s=1<<a;r[a]=-1,i&=~s}0!==n&&_e(e,n,t)}function Vc(){return 0!==(6&rc)||(xu(0,!1),!1)}function $c(){if(null!==ac){if(0===oc)var e=ac.return;else bi=yi=null,za(e=ac),Ys=null,Xs=0,e=ac;for(;null!==e;)sl(e.alternate,e),e=e.return;ac=null}}function Hc(e,t){var n=e.timeoutHandle;-1!==n&&(e.timeoutHandle=-1,uh(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),$c(),ic=e,ac=n=Ur(e.current,null),sc=t,oc=0,lc=null,cc=!1,uc=we(e,t),hc=!1,yc=vc=gc=mc=pc=dc=0,wc=bc=null,Tc=!1,0!==(8&t)&&(t|=32&t);var r=e.entangledLanes;if(0!==r)for(e=e.entanglements,r&=t;0<r;){var i=31-de(r),a=1<<i;t|=e[i],r&=~a}return fc=t,Ir(),n}function Wc(e,t){wa=null,P.H=Ws,t===Gi||t===qi?(t=ea(),oc=3):t===Ki?(t=ea(),oc=4):oc=t===Co?8:null!==t&&"object"===typeof t&&"function"===typeof t.then?6:1,lc=t,null===ac&&(dc=1,Eo(e,kr(t,e.current)))}function Gc(){var e=P.H;return P.H=Ws,null===e?Ws:e}function Kc(){var e=P.A;return P.A=tc,e}function qc(){dc=4,cc||(4194048&sc)!==sc&&null!==io.current||(uc=!0),0===(134217727&pc)&&0===(134217727&mc)||null===ic||Bc(ic,sc,vc,!1)}function Yc(e,t,n){var r=rc;rc|=2;var i=Gc(),a=Kc();ic===e&&sc===t||(xc=null,Hc(e,t)),t=!1;var s=dc;e:for(;;)try{if(0!==oc&&null!==ac){var o=ac,l=lc;switch(oc){case 8:$c(),s=6;break e;case 3:case 2:case 9:case 6:null===io.current&&(t=!0);var c=oc;if(oc=0,lc=null,eu(e,o,l,c),n&&uc){s=0;break e}break;default:c=oc,oc=0,lc=null,eu(e,o,l,c)}}Xc(),s=dc;break}catch(u){Wc(e,u)}return t&&e.shellSuspendCounter++,bi=yi=null,rc=r,P.H=i,P.A=a,null===ac&&(ic=null,sc=0,Ir()),s}function Xc(){for(;null!==ac;)Jc(ac)}function Qc(){for(;null!==ac&&!Z();)Jc(ac)}function Jc(e){var t=Jo(e.alternate,e,fc);e.memoizedProps=e.pendingProps,null===t?tu(e):ac=t}function Zc(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Fo(n,t,t.pendingProps,t.type,void 0,sc);break;case 11:t=Fo(n,t,t.pendingProps,t.type.render,t.ref,sc);break;case 5:za(t);default:sl(n,t),t=Jo(n,t=ac=jr(t,fc),fc)}e.memoizedProps=e.pendingProps,null===t?tu(e):ac=t}function eu(e,t,n,r){bi=yi=null,za(t),Ys=null,Xs=0;var i=t.return;try{if(function(e,t,n,r,i){if(n.flags|=32768,null!==r&&"object"===typeof r&&"function"===typeof r.then){if(null!==(t=n.alternate)&&xi(t,n,i,!0),null!==(n=io.current)){switch(n.tag){case 13:return null===ao?qc():null===n.alternate&&0===dc&&(dc=3),n.flags&=-257,n.flags|=65536,n.lanes=i,r===Yi?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([r]):t.add(r),fu(e,r,i)),!1;case 22:return n.flags|=65536,r===Yi?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([r])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([r]):n.add(r),fu(e,r,i)),!1}throw Error(s(435,n.tag))}return fu(e,r,i),qc(),!1}if(si)return null!==(t=io.current)?(0===(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=i,r!==ci&&gi(kr(e=Error(s(422),{cause:r}),n))):(r!==ci&&gi(kr(t=Error(s(423),{cause:r}),n)),(e=e.current.alternate).flags|=65536,i&=-i,e.lanes|=i,r=kr(r,n),la(e,i=xo(e.stateNode,r,i)),4!==dc&&(dc=2)),!1;var a=Error(s(520),{cause:r});if(a=kr(a,n),null===bc?bc=[a]:bc.push(a),4!==dc&&(dc=2),null===t)return!0;r=kr(r,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=i&-i,n.lanes|=e,la(n,e=xo(n.stateNode,r,e)),!1;case 1:if(t=n.type,a=n.stateNode,0===(128&n.flags)&&("function"===typeof t.getDerivedStateFromError||null!==a&&"function"===typeof a.componentDidCatch&&(null===kc||!kc.has(a))))return n.flags|=65536,i&=-i,n.lanes|=i,_o(i=ko(i),e,n,r),la(n,i),!1}n=n.return}while(null!==n);return!1}(e,i,t,n,sc))return dc=1,Eo(e,kr(n,e.current)),void(ac=null)}catch(a){if(null!==i)throw ac=i,a;return dc=1,Eo(e,kr(n,e.current)),void(ac=null)}32768&t.flags?(si||1===r?e=!0:uc||0!==(536870912&sc)?e=!1:(cc=e=!0,(2===r||9===r||3===r||6===r)&&(null!==(r=io.current)&&13===r.tag&&(r.flags|=16384))),nu(t,e)):tu(t)}function tu(e){var t=e;do{if(0!==(32768&t.flags))return void nu(t,cc);e=t.return;var n=il(t.alternate,t,fc);if(null!==n)return void(ac=n);if(null!==(t=t.sibling))return void(ac=t);ac=t=e}while(null!==t);0===dc&&(dc=5)}function nu(e,t){do{var n=al(e.alternate,e);if(null!==n)return n.flags&=32767,void(ac=n);if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling))return void(ac=e);ac=e=n}while(null!==e);dc=6,ac=null}function ru(e,t,n,r,i,a,o,l,c){e.cancelPendingCommit=null;do{lu()}while(0!==_c);if(0!==(6&rc))throw Error(s(327));if(null!==t){if(t===e.current)throw Error(s(177));if(a=t.lanes|t.childLanes,function(e,t,n,r,i,a){var s=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var o=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(n=s&~n;0<n;){var u=31-de(n),h=1<<u;o[u]=0,l[u]=-1;var f=c[u];if(null!==f)for(c[u]=null,u=0;u<f.length;u++){var d=f[u];null!==d&&(d.lane&=-536870913)}n&=~h}0!==r&&_e(e,r,0),0!==a&&0===i&&0!==e.tag&&(e.suspendedLanes|=a&~(s&~t))}(e,n,a|=Ar,o,l,c),e===ic&&(ac=ic=null,sc=0),Ac=t,Cc=e,Ic=n,Nc=a,Dc=i,Oc=r,0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?(e.callbackNode=null,e.callbackPriority=0,Q(ae,(function(){return cu(),null}))):(e.callbackNode=null,e.callbackPriority=0),r=0!==(13878&t.flags),0!==(13878&t.subtreeFlags)||r){r=P.T,P.T=null,i=L.p,L.p=2,o=rc,rc|=4;try{!function(e,t){if(e=e.containerInfo,nh=rf,nr(e=tr(e))){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch(g){n=null;break e}var o=0,l=-1,c=-1,u=0,h=0,f=e,d=null;t:for(;;){for(var p;f!==n||0!==i&&3!==f.nodeType||(l=o+i),f!==a||0!==r&&3!==f.nodeType||(c=o+r),3===f.nodeType&&(o+=f.nodeValue.length),null!==(p=f.firstChild);)d=f,f=p;for(;;){if(f===e)break t;if(d===n&&++u===i&&(l=o),d===a&&++h===r&&(c=o),null!==(p=f.nextSibling))break;d=(f=d).parentNode}f=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(rh={focusedElem:e,selectionRange:n},rf=!1,xl=t;null!==xl;)if(e=(t=xl).child,0!==(1024&t.subtreeFlags)&&null!==e)e.return=t,xl=e;else for(;null!==xl;){switch(a=(t=xl).alternate,e=t.flags,t.tag){case 0:case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!==(1024&e)&&null!==a){e=void 0,n=t,i=a.memoizedProps,a=a.memoizedState,r=n.stateNode;try{var m=vo(n.type,i,(n.elementType,n.type));e=r.getSnapshotBeforeUpdate(m,a),r.__reactInternalSnapshotBeforeUpdate=e}catch(v){hu(n,n.return,v)}}break;case 3:if(0!==(1024&e))if(9===(n=(e=t.stateNode.containerInfo).nodeType))gh(e);else if(1===n)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":gh(e);break;default:e.textContent=""}break;default:if(0!==(1024&e))throw Error(s(163))}if(null!==(e=t.sibling)){e.return=t.return,xl=e;break}xl=t.return}}(e,t)}finally{rc=o,L.p=i,P.T=r}}_c=1,iu(),au(),su()}}function iu(){if(1===_c){_c=0;var e=Cc,t=Ac,n=0!==(13878&t.flags);if(0!==(13878&t.subtreeFlags)||n){n=P.T,P.T=null;var r=L.p;L.p=2;var i=rc;rc|=4;try{Ll(t,e);var a=rh,s=tr(e.containerInfo),o=a.focusedElem,l=a.selectionRange;if(s!==o&&o&&o.ownerDocument&&er(o.ownerDocument.documentElement,o)){if(null!==l&&nr(o)){var c=l.start,u=l.end;if(void 0===u&&(u=c),"selectionStart"in o)o.selectionStart=c,o.selectionEnd=Math.min(u,o.value.length);else{var h=o.ownerDocument||document,f=h&&h.defaultView||window;if(f.getSelection){var d=f.getSelection(),p=o.textContent.length,m=Math.min(l.start,p),g=void 0===l.end?m:Math.min(l.end,p);!d.extend&&m>g&&(s=g,g=m,m=s);var v=Zn(o,m),y=Zn(o,g);if(v&&y&&(1!==d.rangeCount||d.anchorNode!==v.node||d.anchorOffset!==v.offset||d.focusNode!==y.node||d.focusOffset!==y.offset)){var b=h.createRange();b.setStart(v.node,v.offset),d.removeAllRanges(),m>g?(d.addRange(b),d.extend(y.node,y.offset)):(b.setEnd(y.node,y.offset),d.addRange(b))}}}}for(h=[],d=o;d=d.parentNode;)1===d.nodeType&&h.push({element:d,left:d.scrollLeft,top:d.scrollTop});for("function"===typeof o.focus&&o.focus(),o=0;o<h.length;o++){var w=h[o];w.element.scrollLeft=w.left,w.element.scrollTop=w.top}}rf=!!nh,rh=nh=null}finally{rc=i,L.p=r,P.T=n}}e.current=t,_c=2}}function au(){if(2===_c){_c=0;var e=Cc,t=Ac,n=0!==(8772&t.flags);if(0!==(8772&t.subtreeFlags)||n){n=P.T,P.T=null;var r=L.p;L.p=2;var i=rc;rc|=4;try{kl(e,t.alternate,t)}finally{rc=i,L.p=r,P.T=n}}_c=3}}function su(){if(4===_c||3===_c){_c=0,ee();var e=Cc,t=Ac,n=Ic,r=Oc;0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?_c=5:(_c=0,Ac=Cc=null,ou(e,e.pendingLanes));var i=e.pendingLanes;if(0===i&&(kc=null),Ie(n),t=t.stateNode,he&&"function"===typeof he.onCommitFiberRoot)try{he.onCommitFiberRoot(ue,t,void 0,128===(128&t.current.flags))}catch(l){}if(null!==r){t=P.T,i=L.p,L.p=2,P.T=null;try{for(var a=e.onRecoverableError,s=0;s<r.length;s++){var o=r[s];a(o.value,{componentStack:o.stack})}}finally{P.T=t,L.p=i}}0!==(3&Ic)&&lu(),Su(e),i=e.pendingLanes,0!==(4194090&n)&&0!==(42&i)?e===Pc?Rc++:(Rc=0,Pc=e):Rc=0,xu(0,!1)}}function ou(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Li(t)))}function lu(e){return iu(),au(),su(),cu()}function cu(){if(5!==_c)return!1;var e=Cc,t=Nc;Nc=0;var n=Ie(Ic),r=P.T,i=L.p;try{L.p=32>n?32:n,P.T=null,n=Dc,Dc=null;var a=Cc,o=Ic;if(_c=0,Ac=Cc=null,Ic=0,0!==(6&rc))throw Error(s(331));var l=rc;if(rc|=4,Jl(a.current),Hl(a,a.current,o,n),rc=l,xu(0,!1),he&&"function"===typeof he.onPostCommitFiberRoot)try{he.onPostCommitFiberRoot(ue,a)}catch(c){}return!0}finally{L.p=i,P.T=r,ou(e,t)}}function uu(e,t,n){t=kr(n,t),null!==(e=sa(e,t=xo(e.stateNode,t,2),2))&&(ke(e,2),Su(e))}function hu(e,t,n){if(3===e.tag)uu(e,e,n);else for(;null!==t;){if(3===t.tag){uu(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===kc||!kc.has(r))){e=kr(n,e),null!==(r=sa(t,n=ko(2),2))&&(_o(n,r,t,e),ke(r,2),Su(r));break}}t=t.return}}function fu(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new nc;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(hc=!0,i.add(n),e=du.bind(null,e,t,n),t.then(e,e))}function du(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,ic===e&&(sc&n)===n&&(4===dc||3===dc&&(62914560&sc)===sc&&300>te()-Ec?0===(2&rc)&&Hc(e,0):gc|=n,yc===sc&&(yc=0)),Su(e)}function pu(e,t){0===t&&(t=Se()),null!==(e=Or(e,t))&&(ke(e,t),Su(e))}function mu(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),pu(e,n)}function gu(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;case 22:r=e.stateNode._retryCache;break;default:throw Error(s(314))}null!==r&&r.delete(t),pu(e,n)}var vu=null,yu=null,bu=!1,wu=!1,Tu=!1,Eu=0;function Su(e){e!==yu&&null===e.next&&(null===yu?vu=yu=e:yu=yu.next=e),wu=!0,bu||(bu=!0,fh((function(){0!==(6&rc)?Q(re,ku):_u()})))}function xu(e,t){if(!Tu&&wu){Tu=!0;do{for(var n=!1,r=vu;null!==r;){if(!t)if(0!==e){var i=r.pendingLanes;if(0===i)var a=0;else{var s=r.suspendedLanes,o=r.pingedLanes;a=(1<<31-de(42|e)+1)-1,a=201326741&(a&=i&~(s&~o))?201326741&a|1:a?2|a:0}0!==a&&(n=!0,Iu(r,a))}else a=sc,0===(3&(a=be(r,r===ic?a:0,null!==r.cancelPendingCommit||-1!==r.timeoutHandle)))||we(r,a)||(n=!0,Iu(r,a));r=r.next}}while(n);Tu=!1}}function ku(){_u()}function _u(){wu=bu=!1;var e=0;0!==Eu&&(function(){var e=window.event;if(e&&"popstate"===e.type)return e!==lh&&(lh=e,!0);return lh=null,!1}()&&(e=Eu),Eu=0);for(var t=te(),n=null,r=vu;null!==r;){var i=r.next,a=Cu(r,t);0===a?(r.next=null,null===n?vu=i:n.next=i,null===i&&(yu=n)):(n=r,(0!==e||0!==(3&a))&&(wu=!0)),r=i}xu(e,!1)}function Cu(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,a=-62914561&e.pendingLanes;0<a;){var s=31-de(a),o=1<<s,l=i[s];-1===l?0!==(o&n)&&0===(o&r)||(i[s]=Te(o,t)):l<=t&&(e.expiredLanes|=o),a&=~o}if(n=sc,n=be(e,e===(t=ic)?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),r=e.callbackNode,0===n||e===t&&(2===oc||9===oc)||null!==e.cancelPendingCommit)return null!==r&&null!==r&&J(r),e.callbackNode=null,e.callbackPriority=0;if(0===(3&n)||we(e,n)){if((t=n&-n)===e.callbackPriority)return t;switch(null!==r&&J(r),Ie(n)){case 2:case 8:n=ie;break;case 32:default:n=ae;break;case 268435456:n=oe}return r=Au.bind(null,e),n=Q(n,r),e.callbackPriority=t,e.callbackNode=n,t}return null!==r&&null!==r&&J(r),e.callbackPriority=2,e.callbackNode=null,2}function Au(e,t){if(0!==_c&&5!==_c)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(lu()&&e.callbackNode!==n)return null;var r=sc;return 0===(r=be(e,e===ic?r:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(zc(e,r,t),Cu(e,te()),null!=e.callbackNode&&e.callbackNode===n?Au.bind(null,e):null)}function Iu(e,t){if(lu())return null;zc(e,t,!0)}function Nu(){return 0===Eu&&(Eu=Ee()),Eu}function Du(e){return null==e||"symbol"===typeof e||"boolean"===typeof e?null:"function"===typeof e?e:It(""+e)}function Ou(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}for(var Ru=0;Ru<Er.length;Ru++){var Pu=Er[Ru];Sr(Pu.toLowerCase(),"on"+(Pu[0].toUpperCase()+Pu.slice(1)))}Sr(pr,"onAnimationEnd"),Sr(mr,"onAnimationIteration"),Sr(gr,"onAnimationStart"),Sr("dblclick","onDoubleClick"),Sr("focusin","onFocus"),Sr("focusout","onBlur"),Sr(vr,"onTransitionRun"),Sr(yr,"onTransitionStart"),Sr(br,"onTransitionCancel"),Sr(wr,"onTransitionEnd"),Ye("onMouseEnter",["mouseout","mouseover"]),Ye("onMouseLeave",["mouseout","mouseover"]),Ye("onPointerEnter",["pointerout","pointerover"]),Ye("onPointerLeave",["pointerout","pointerover"]),qe("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),qe("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),qe("onBeforeInput",["compositionend","keypress","textInput","paste"]),qe("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),qe("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),qe("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Mu=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Lu));function Fu(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var s=r.length-1;0<=s;s--){var o=r[s],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==a&&i.isPropagationStopped())break e;a=o,i.currentTarget=c;try{a(i)}catch(u){yo(u)}i.currentTarget=null,a=l}else for(s=0;s<r.length;s++){if(l=(o=r[s]).instance,c=o.currentTarget,o=o.listener,l!==a&&i.isPropagationStopped())break e;a=o,i.currentTarget=c;try{a(i)}catch(u){yo(u)}i.currentTarget=null,a=l}}}}function zu(e,t){var n=t[Le];void 0===n&&(n=t[Le]=new Set);var r=e+"__bubble";n.has(r)||(Vu(t,e,2,!1),n.add(r))}function Uu(e,t,n){var r=0;t&&(r|=4),Vu(n,e,r,t)}var ju="_reactListening"+Math.random().toString(36).slice(2);function Bu(e){if(!e[ju]){e[ju]=!0,Ge.forEach((function(t){"selectionchange"!==t&&(Mu.has(t)||Uu(t,!1,e),Uu(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[ju]||(t[ju]=!0,Uu("selectionchange",!1,t))}}function Vu(e,t,n,r){switch(hf(t)){case 2:var i=af;break;case 8:i=sf;break;default:i=of}n=i.bind(null,t,n,e),i=void 0,!Ut||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function $u(e,t,n,r,i){var a=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var s=r.tag;if(3===s||4===s){var o=r.stateNode.containerInfo;if(o===i)break;if(4===s)for(s=r.return;null!==s;){var c=s.tag;if((3===c||4===c)&&s.stateNode.containerInfo===i)return;s=s.return}for(;null!==o;){if(null===(s=Be(o)))return;if(5===(c=s.tag)||6===c||26===c||27===c){r=a=s;continue e}o=o.parentNode}}r=r.return}Mt((function(){var r=a,i=Dt(n),s=[];e:{var o=Tr.get(e);if(void 0!==o){var c=en,u=e;switch(e){case"keypress":if(0===Wt(n))break e;case"keydown":case"keyup":c=gn;break;case"focusin":u="focus",c=on;break;case"focusout":u="blur",c=on;break;case"beforeblur":case"afterblur":c=on;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=an;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=sn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=yn;break;case pr:case mr:case gr:c=ln;break;case wr:c=bn;break;case"scroll":case"scrollend":c=nn;break;case"wheel":c=wn;break;case"copy":case"cut":case"paste":c=cn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=vn;break;case"toggle":case"beforetoggle":c=Tn}var h=0!==(4&t),f=!h&&("scroll"===e||"scrollend"===e),d=h?null!==o?o+"Capture":null:o;h=[];for(var p,m=r;null!==m;){var g=m;if(p=g.stateNode,5!==(g=g.tag)&&26!==g&&27!==g||null===p||null===d||null!=(g=Ft(m,d))&&h.push(Hu(m,g,p)),f)break;m=m.return}0<h.length&&(o=new c(o,u,null,n,i),s.push({event:o,listeners:h}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===Nt||!(u=n.relatedTarget||n.fromElement)||!Be(u)&&!u[Pe])&&(c||o)&&(o=i.window===i?i:(o=i.ownerDocument)?o.defaultView||o.parentWindow:window,c?(c=r,null!==(u=(u=n.relatedTarget||n.toElement)?Be(u):null)&&(f=l(u),h=u.tag,u!==f||5!==h&&27!==h&&6!==h)&&(u=null)):(c=null,u=r),c!==u)){if(h=an,g="onMouseLeave",d="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(h=vn,g="onPointerLeave",d="onPointerEnter",m="pointer"),f=null==c?o:$e(c),p=null==u?o:$e(u),(o=new h(g,m+"leave",c,n,i)).target=f,o.relatedTarget=p,g=null,Be(i)===r&&((h=new h(d,m+"enter",u,n,i)).target=p,h.relatedTarget=f,g=h),f=g,c&&u)e:{for(d=u,m=0,p=h=c;p;p=Gu(p))m++;for(p=0,g=d;g;g=Gu(g))p++;for(;0<m-p;)h=Gu(h),m--;for(;0<p-m;)d=Gu(d),p--;for(;m--;){if(h===d||null!==d&&h===d.alternate)break e;h=Gu(h),d=Gu(d)}h=null}else h=null;null!==c&&Ku(s,o,c,h,!1),null!==u&&null!==f&&Ku(s,f,u,h,!0)}if("select"===(c=(o=r?$e(r):window).nodeName&&o.nodeName.toLowerCase())||"input"===c&&"file"===o.type)var v=Un;else if(Rn(o))if(jn)v=Yn;else{v=Kn;var y=Gn}else!(c=o.nodeName)||"input"!==c.toLowerCase()||"checkbox"!==o.type&&"radio"!==o.type?r&&_t(r.elementType)&&(v=Un):v=qn;switch(v&&(v=v(e,r))?Pn(s,v,n,i):(y&&y(e,o,r),"focusout"===e&&r&&"number"===o.type&&null!=r.memoizedProps.value&&yt(o,"number",o.value)),y=r?$e(r):window,e){case"focusin":(Rn(y)||"true"===y.contentEditable)&&(ir=y,ar=r,sr=null);break;case"focusout":sr=ar=ir=null;break;case"mousedown":or=!0;break;case"contextmenu":case"mouseup":case"dragend":or=!1,lr(s,n,i);break;case"selectionchange":if(rr)break;case"keydown":case"keyup":lr(s,n,i)}var b;if(Sn)e:{switch(e){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else Dn?In(e,n)&&(w="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(w="onCompositionStart");w&&(_n&&"ko"!==n.locale&&(Dn||"onCompositionStart"!==w?"onCompositionEnd"===w&&Dn&&(b=Ht()):(Vt="value"in(Bt=i)?Bt.value:Bt.textContent,Dn=!0)),0<(y=Wu(r,w)).length&&(w=new un(w,e,null,n,i),s.push({event:w,listeners:y}),b?w.data=b:null!==(b=Nn(n))&&(w.data=b))),(b=kn?function(e,t){switch(e){case"compositionend":return Nn(t);case"keypress":return 32!==t.which?null:(An=!0,Cn);case"textInput":return(e=t.data)===Cn&&An?null:e;default:return null}}(e,n):function(e,t){if(Dn)return"compositionend"===e||!Sn&&In(e,t)?(e=Ht(),$t=Vt=Bt=null,Dn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return _n&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(w=Wu(r,"onBeforeInput")).length&&(y=new un("onBeforeInput","beforeinput",null,n,i),s.push({event:y,listeners:w}),y.data=b)),function(e,t,n,r,i){if("submit"===t&&n&&n.stateNode===i){var a=Du((i[Re]||null).action),s=r.submitter;s&&null!==(t=(t=s[Re]||null)?Du(t.formAction):s.getAttribute("formAction"))&&(a=t,s=null);var o=new en("action","action",null,r,i);e.push({event:o,listeners:[{instance:null,listener:function(){if(r.defaultPrevented){if(0!==Eu){var e=s?Ou(i,s):new FormData(i);Ds(n,{pending:!0,data:e,method:i.method,action:a},null,e)}}else"function"===typeof a&&(o.preventDefault(),e=s?Ou(i,s):new FormData(i),Ds(n,{pending:!0,data:e,method:i.method,action:a},a,e))},currentTarget:i}]})}}(s,e,r,n,i)}Fu(s,t)}))}function Hu(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Wu(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,a=i.stateNode;if(5!==(i=i.tag)&&26!==i&&27!==i||null===a||(null!=(i=Ft(e,n))&&r.unshift(Hu(e,i,a)),null!=(i=Ft(e,t))&&r.push(Hu(e,i,a))),3===e.tag)return r;e=e.return}return[]}function Gu(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function Ku(e,t,n,r,i){for(var a=t._reactName,s=[];null!==n&&n!==r;){var o=n,l=o.alternate,c=o.stateNode;if(o=o.tag,null!==l&&l===r)break;5!==o&&26!==o&&27!==o||null===c||(l=c,i?null!=(c=Ft(n,a))&&s.unshift(Hu(n,c,l)):i||null!=(c=Ft(n,a))&&s.push(Hu(n,c,l))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var qu=/\r\n?/g,Yu=/\u0000|\uFFFD/g;function Xu(e){return("string"===typeof e?e:""+e).replace(qu,"\n").replace(Yu,"")}function Qu(e,t){return t=Xu(t),Xu(e)===t}function Ju(){}function Zu(e,t,n,r,i,a){switch(n){case"children":"string"===typeof r?"body"===t||"textarea"===t&&""===r||Et(e,r):("number"===typeof r||"bigint"===typeof r)&&"body"!==t&&Et(e,""+r);break;case"className":nt(e,"class",r);break;case"tabIndex":nt(e,"tabindex",r);break;case"dir":case"role":case"viewBox":case"width":case"height":nt(e,n,r);break;case"style":kt(e,r,a);break;case"data":if("object"!==t){nt(e,"data",r);break}case"src":case"href":if(""===r&&("a"!==t||"href"!==n)){e.removeAttribute(n);break}if(null==r||"function"===typeof r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(n);break}r=It(""+r),e.setAttribute(n,r);break;case"action":case"formAction":if("function"===typeof r){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"===typeof a&&("formAction"===n?("input"!==t&&Zu(e,t,"name",i.name,i,null),Zu(e,t,"formEncType",i.formEncType,i,null),Zu(e,t,"formMethod",i.formMethod,i,null),Zu(e,t,"formTarget",i.formTarget,i,null)):(Zu(e,t,"encType",i.encType,i,null),Zu(e,t,"method",i.method,i,null),Zu(e,t,"target",i.target,i,null))),null==r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(n);break}r=It(""+r),e.setAttribute(n,r);break;case"onClick":null!=r&&(e.onclick=Ju);break;case"onScroll":null!=r&&zu("scroll",e);break;case"onScrollEnd":null!=r&&zu("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(s(61));if(null!=(n=r.__html)){if(null!=i.children)throw Error(s(60));e.innerHTML=n}}break;case"multiple":e.multiple=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"muted":e.muted=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==r||"function"===typeof r||"boolean"===typeof r||"symbol"===typeof r){e.removeAttribute("xlink:href");break}n=It(""+r),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,""+r):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":!0===r?e.setAttribute(n,""):!1!==r&&null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,r):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":null!=r&&"function"!==typeof r&&"symbol"!==typeof r&&!isNaN(r)&&1<=r?e.setAttribute(n,r):e.removeAttribute(n);break;case"rowSpan":case"start":null==r||"function"===typeof r||"symbol"===typeof r||isNaN(r)?e.removeAttribute(n):e.setAttribute(n,r);break;case"popover":zu("beforetoggle",e),zu("toggle",e),tt(e,"popover",r);break;case"xlinkActuate":rt(e,"http://www.w3.org/1999/xlink","xlink:actuate",r);break;case"xlinkArcrole":rt(e,"http://www.w3.org/1999/xlink","xlink:arcrole",r);break;case"xlinkRole":rt(e,"http://www.w3.org/1999/xlink","xlink:role",r);break;case"xlinkShow":rt(e,"http://www.w3.org/1999/xlink","xlink:show",r);break;case"xlinkTitle":rt(e,"http://www.w3.org/1999/xlink","xlink:title",r);break;case"xlinkType":rt(e,"http://www.w3.org/1999/xlink","xlink:type",r);break;case"xmlBase":rt(e,"http://www.w3.org/XML/1998/namespace","xml:base",r);break;case"xmlLang":rt(e,"http://www.w3.org/XML/1998/namespace","xml:lang",r);break;case"xmlSpace":rt(e,"http://www.w3.org/XML/1998/namespace","xml:space",r);break;case"is":tt(e,"is",r);break;case"innerText":case"textContent":break;default:(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])&&tt(e,n=Ct.get(n)||n,r)}}function eh(e,t,n,r,i,a){switch(n){case"style":kt(e,r,a);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(s(61));if(null!=(n=r.__html)){if(null!=i.children)throw Error(s(60));e.innerHTML=n}}break;case"children":"string"===typeof r?Et(e,r):("number"===typeof r||"bigint"===typeof r)&&Et(e,""+r);break;case"onScroll":null!=r&&zu("scroll",e);break;case"onScrollEnd":null!=r&&zu("scrollend",e);break;case"onClick":null!=r&&(e.onclick=Ju);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:Ke.hasOwnProperty(n)||("o"!==n[0]||"n"!==n[1]||(i=n.endsWith("Capture"),t=n.slice(2,i?n.length-7:void 0),"function"===typeof(a=null!=(a=e[Re]||null)?a[n]:null)&&e.removeEventListener(t,a,i),"function"!==typeof r)?n in e?e[n]=r:!0===r?e.setAttribute(n,""):tt(e,n,r):("function"!==typeof a&&null!==a&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,r,i)))}}function th(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":zu("error",e),zu("load",e);var r,i=!1,a=!1;for(r in n)if(n.hasOwnProperty(r)){var o=n[r];if(null!=o)switch(r){case"src":i=!0;break;case"srcSet":a=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,t));default:Zu(e,t,r,o,n,null)}}return a&&Zu(e,t,"srcSet",n.srcSet,n,null),void(i&&Zu(e,t,"src",n.src,n,null));case"input":zu("invalid",e);var l=r=o=a=null,c=null,u=null;for(i in n)if(n.hasOwnProperty(i)){var h=n[i];if(null!=h)switch(i){case"name":a=h;break;case"type":o=h;break;case"checked":c=h;break;case"defaultChecked":u=h;break;case"value":r=h;break;case"defaultValue":l=h;break;case"children":case"dangerouslySetInnerHTML":if(null!=h)throw Error(s(137,t));break;default:Zu(e,t,i,h,n,null)}}return vt(e,r,l,c,u,o,a,!1),void ht(e);case"select":for(a in zu("invalid",e),i=o=r=null,n)if(n.hasOwnProperty(a)&&null!=(l=n[a]))switch(a){case"value":r=l;break;case"defaultValue":o=l;break;case"multiple":i=l;default:Zu(e,t,a,l,n,null)}return t=r,n=o,e.multiple=!!i,void(null!=t?bt(e,!!i,t,!1):null!=n&&bt(e,!!i,n,!0));case"textarea":for(o in zu("invalid",e),r=a=i=null,n)if(n.hasOwnProperty(o)&&null!=(l=n[o]))switch(o){case"value":i=l;break;case"defaultValue":a=l;break;case"children":r=l;break;case"dangerouslySetInnerHTML":if(null!=l)throw Error(s(91));break;default:Zu(e,t,o,l,n,null)}return Tt(e,i,a,r),void ht(e);case"option":for(c in n)if(n.hasOwnProperty(c)&&null!=(i=n[c]))if("selected"===c)e.selected=i&&"function"!==typeof i&&"symbol"!==typeof i;else Zu(e,t,c,i,n,null);return;case"dialog":zu("beforetoggle",e),zu("toggle",e),zu("cancel",e),zu("close",e);break;case"iframe":case"object":zu("load",e);break;case"video":case"audio":for(i=0;i<Lu.length;i++)zu(Lu[i],e);break;case"image":zu("error",e),zu("load",e);break;case"details":zu("toggle",e);break;case"embed":case"source":case"link":zu("error",e),zu("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in n)if(n.hasOwnProperty(u)&&null!=(i=n[u]))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,t));default:Zu(e,t,u,i,n,null)}return;default:if(_t(t)){for(h in n)n.hasOwnProperty(h)&&(void 0!==(i=n[h])&&eh(e,t,h,i,n,void 0));return}}for(l in n)n.hasOwnProperty(l)&&(null!=(i=n[l])&&Zu(e,t,l,i,n,null))}var nh=null,rh=null;function ih(e){return 9===e.nodeType?e:e.ownerDocument}function ah(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function sh(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function oh(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"bigint"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var lh=null;var ch="function"===typeof setTimeout?setTimeout:void 0,uh="function"===typeof clearTimeout?clearTimeout:void 0,hh="function"===typeof Promise?Promise:void 0,fh="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof hh?function(e){return hh.resolve(null).then(e).catch(dh)}:ch;function dh(e){setTimeout((function(){throw e}))}function ph(e){return"head"===e}function mh(e,t){var n=t,r=0,i=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)){if(0<r&&8>r){n=r;var s=e.ownerDocument;if(1&n&&Eh(s.documentElement),2&n&&Eh(s.body),4&n)for(Eh(n=s.head),s=n.firstChild;s;){var o=s.nextSibling,l=s.nodeName;s[Ue]||"SCRIPT"===l||"STYLE"===l||"LINK"===l&&"stylesheet"===s.rel.toLowerCase()||n.removeChild(s),s=o}}if(0===i)return e.removeChild(a),void If(t);i--}else"$"===n||"$?"===n||"$!"===n?i++:r=n.charCodeAt(0)-48;else r=0;n=a}while(n);If(t)}function gh(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":gh(n),je(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===n.rel.toLowerCase())continue}e.removeChild(n)}}function vh(e){return"$!"===e.data||"$?"===e.data&&"complete"===e.ownerDocument.readyState}function yh(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"F!"===t||"F"===t)break;if("/$"===t)return null}}return e}var bh=null;function wh(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}function Th(e,t,n){switch(t=ih(n),e){case"html":if(!(e=t.documentElement))throw Error(s(452));return e;case"head":if(!(e=t.head))throw Error(s(453));return e;case"body":if(!(e=t.body))throw Error(s(454));return e;default:throw Error(s(451))}}function Eh(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);je(e)}var Sh=new Map,xh=new Set;function kh(e){return"function"===typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var _h=L.d;L.d={f:function(){var e=_h.f(),t=Vc();return e||t},r:function(e){var t=Ve(e);null!==t&&5===t.tag&&"form"===t.type?Rs(t):_h.r(e)},D:function(e){_h.D(e),Ah("dns-prefetch",e,null)},C:function(e,t){_h.C(e,t),Ah("preconnect",e,t)},L:function(e,t,n){_h.L(e,t,n);var r=Ch;if(r&&e&&t){var i='link[rel="preload"][as="'+mt(t)+'"]';"image"===t&&n&&n.imageSrcSet?(i+='[imagesrcset="'+mt(n.imageSrcSet)+'"]',"string"===typeof n.imageSizes&&(i+='[imagesizes="'+mt(n.imageSizes)+'"]')):i+='[href="'+mt(e)+'"]';var a=i;switch(t){case"style":a=Nh(e);break;case"script":a=Rh(e)}Sh.has(a)||(e=f({rel:"preload",href:"image"===t&&n&&n.imageSrcSet?void 0:e,as:t},n),Sh.set(a,e),null!==r.querySelector(i)||"style"===t&&r.querySelector(Dh(a))||"script"===t&&r.querySelector(Ph(a))||(th(t=r.createElement("link"),"link",e),We(t),r.head.appendChild(t)))}},m:function(e,t){_h.m(e,t);var n=Ch;if(n&&e){var r=t&&"string"===typeof t.as?t.as:"script",i='link[rel="modulepreload"][as="'+mt(r)+'"][href="'+mt(e)+'"]',a=i;switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":a=Rh(e)}if(!Sh.has(a)&&(e=f({rel:"modulepreload",href:e},t),Sh.set(a,e),null===n.querySelector(i))){switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Ph(a)))return}th(r=n.createElement("link"),"link",e),We(r),n.head.appendChild(r)}}},X:function(e,t){_h.X(e,t);var n=Ch;if(n&&e){var r=He(n).hoistableScripts,i=Rh(e),a=r.get(i);a||((a=n.querySelector(Ph(i)))||(e=f({src:e,async:!0},t),(t=Sh.get(i))&&zh(e,t),We(a=n.createElement("script")),th(a,"link",e),n.head.appendChild(a)),a={type:"script",instance:a,count:1,state:null},r.set(i,a))}},S:function(e,t,n){_h.S(e,t,n);var r=Ch;if(r&&e){var i=He(r).hoistableStyles,a=Nh(e);t=t||"default";var s=i.get(a);if(!s){var o={loading:0,preload:null};if(s=r.querySelector(Dh(a)))o.loading=5;else{e=f({rel:"stylesheet",href:e,"data-precedence":t},n),(n=Sh.get(a))&&Fh(e,n);var l=s=r.createElement("link");We(l),th(l,"link",e),l._p=new Promise((function(e,t){l.onload=e,l.onerror=t})),l.addEventListener("load",(function(){o.loading|=1})),l.addEventListener("error",(function(){o.loading|=2})),o.loading|=4,Mh(s,t,r)}s={type:"stylesheet",instance:s,count:1,state:o},i.set(a,s)}}},M:function(e,t){_h.M(e,t);var n=Ch;if(n&&e){var r=He(n).hoistableScripts,i=Rh(e),a=r.get(i);a||((a=n.querySelector(Ph(i)))||(e=f({src:e,async:!0,type:"module"},t),(t=Sh.get(i))&&zh(e,t),We(a=n.createElement("script")),th(a,"link",e),n.head.appendChild(a)),a={type:"script",instance:a,count:1,state:null},r.set(i,a))}}};var Ch="undefined"===typeof document?null:document;function Ah(e,t,n){var r=Ch;if(r&&"string"===typeof t&&t){var i=mt(t);i='link[rel="'+e+'"][href="'+i+'"]',"string"===typeof n&&(i+='[crossorigin="'+n+'"]'),xh.has(i)||(xh.add(i),e={rel:e,crossOrigin:n,href:t},null===r.querySelector(i)&&(th(t=r.createElement("link"),"link",e),We(t),r.head.appendChild(t)))}}function Ih(e,t,n,r){var i,a,o,l,c=(c=H.current)?kh(c):null;if(!c)throw Error(s(446));switch(e){case"meta":case"title":return null;case"style":return"string"===typeof n.precedence&&"string"===typeof n.href?(t=Nh(n.href),(r=(n=He(c).hoistableStyles).get(t))||(r={type:"style",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===n.rel&&"string"===typeof n.href&&"string"===typeof n.precedence){e=Nh(n.href);var u=He(c).hoistableStyles,h=u.get(e);if(h||(c=c.ownerDocument||c,h={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},u.set(e,h),(u=c.querySelector(Dh(e)))&&!u._p&&(h.instance=u,h.state.loading=5),Sh.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Sh.set(e,n),u||(i=c,a=e,o=n,l=h.state,i.querySelector('link[rel="preload"][as="style"]['+a+"]")?l.loading=1:(a=i.createElement("link"),l.preload=a,a.addEventListener("load",(function(){return l.loading|=1})),a.addEventListener("error",(function(){return l.loading|=2})),th(a,"link",o),We(a),i.head.appendChild(a))))),t&&null===r)throw Error(s(528,""));return h}if(t&&null!==r)throw Error(s(529,""));return null;case"script":return t=n.async,"string"===typeof(n=n.src)&&t&&"function"!==typeof t&&"symbol"!==typeof t?(t=Rh(n),(r=(n=He(c).hoistableScripts).get(t))||(r={type:"script",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,e))}}function Nh(e){return'href="'+mt(e)+'"'}function Dh(e){return'link[rel="stylesheet"]['+e+"]"}function Oh(e){return f({},e,{"data-precedence":e.precedence,precedence:null})}function Rh(e){return'[src="'+mt(e)+'"]'}function Ph(e){return"script[async]"+e}function Lh(e,t,n){if(t.count++,null===t.instance)switch(t.type){case"style":var r=e.querySelector('style[data-href~="'+mt(n.href)+'"]');if(r)return t.instance=r,We(r),r;var i=f({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return We(r=(e.ownerDocument||e).createElement("style")),th(r,"style",i),Mh(r,n.precedence,e),t.instance=r;case"stylesheet":i=Nh(n.href);var a=e.querySelector(Dh(i));if(a)return t.state.loading|=4,t.instance=a,We(a),a;r=Oh(n),(i=Sh.get(i))&&Fh(r,i),We(a=(e.ownerDocument||e).createElement("link"));var o=a;return o._p=new Promise((function(e,t){o.onload=e,o.onerror=t})),th(a,"link",r),t.state.loading|=4,Mh(a,n.precedence,e),t.instance=a;case"script":return a=Rh(n.src),(i=e.querySelector(Ph(a)))?(t.instance=i,We(i),i):(r=n,(i=Sh.get(a))&&zh(r=f({},n),i),We(i=(e=e.ownerDocument||e).createElement("script")),th(i,"link",r),e.head.appendChild(i),t.instance=i);case"void":return null;default:throw Error(s(443,t.type))}else"stylesheet"===t.type&&0===(4&t.state.loading)&&(r=t.instance,t.state.loading|=4,Mh(r,n.precedence,e));return t.instance}function Mh(e,t,n){for(var r=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),i=r.length?r[r.length-1]:null,a=i,s=0;s<r.length;s++){var o=r[s];if(o.dataset.precedence===t)a=o;else if(a!==i)break}a?a.parentNode.insertBefore(e,a.nextSibling):(t=9===n.nodeType?n.head:n).insertBefore(e,t.firstChild)}function Fh(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function zh(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var Uh=null;function jh(e,t,n){if(null===Uh){var r=new Map,i=Uh=new Map;i.set(n,r)}else(r=(i=Uh).get(n))||(r=new Map,i.set(n,r));if(r.has(e))return r;for(r.set(e,null),n=n.getElementsByTagName(e),i=0;i<n.length;i++){var a=n[i];if(!(a[Ue]||a[Oe]||"link"===e&&"stylesheet"===a.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==a.namespaceURI){var s=a.getAttribute(t)||"";s=e+s;var o=r.get(s);o?o.push(a):r.set(s,[a])}}return r}function Bh(e,t,n){(e=e.ownerDocument||e).head.insertBefore(n,"title"===t?e.querySelector("head > title"):null)}function Vh(e){return"stylesheet"!==e.type||0!==(3&e.state.loading)}var $h=null;function Hh(){}function Wh(){if(this.count--,0===this.count)if(this.stylesheets)Kh(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var Gh=null;function Kh(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,Gh=new Map,t.forEach(qh,e),Gh=null,Wh.call(e))}function qh(e,t){if(!(4&t.state.loading)){var n=Gh.get(e);if(n)var r=n.get(null);else{n=new Map,Gh.set(e,n);for(var i=e.querySelectorAll("link[data-precedence],style[data-precedence]"),a=0;a<i.length;a++){var s=i[a];"LINK"!==s.nodeName&&"not all"===s.getAttribute("media")||(n.set(s.dataset.precedence,s),r=s)}r&&n.set(null,r)}s=(i=t.instance).getAttribute("data-precedence"),(a=n.get(s)||r)===r&&n.set(null,i),n.set(s,i),this.count++,r=Wh.bind(this),i.addEventListener("load",r),i.addEventListener("error",r),a?a.parentNode.insertBefore(i,a.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(i,e.firstChild),t.state.loading|=4}}var Yh={$$typeof:T,Provider:null,Consumer:null,_currentValue:M,_currentValue2:M,_threadCount:0};function Xh(e,t,n,r,i,a,s,o){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=xe(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=xe(0),this.hiddenUpdates=xe(null),this.identifierPrefix=r,this.onUncaughtError=i,this.onCaughtError=a,this.onRecoverableError=s,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=o,this.incompleteTransitions=new Map}function Qh(e,t,n,r,i,a,s,o,l,c,u,h){return e=new Xh(e,t,n,s,o,l,c,h),t=1,!0===a&&(t|=24),a=Fr(3,null,null,t),e.current=a,a.stateNode=e,(t=Pi()).refCount++,e.pooledCache=t,t.refCount++,a.memoizedState={element:r,isDehydrated:n,cache:t},ra(a),e}function Jh(e){return e?e=Lr:Lr}function Zh(e,t,n,r,i,a){i=Jh(i),null===r.context?r.context=i:r.pendingContext=i,(r=aa(t)).payload={element:n},null!==(a=void 0===a?null:a)&&(r.callback=a),null!==(n=sa(e,r,t))&&(Fc(n,0,t),oa(n,e,t))}function ef(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function tf(e,t){ef(e,t),(e=e.alternate)&&ef(e,t)}function nf(e){if(13===e.tag){var t=Or(e,67108864);null!==t&&Fc(t,0,67108864),tf(e,67108864)}}var rf=!0;function af(e,t,n,r){var i=P.T;P.T=null;var a=L.p;try{L.p=2,of(e,t,n,r)}finally{L.p=a,P.T=i}}function sf(e,t,n,r){var i=P.T;P.T=null;var a=L.p;try{L.p=8,of(e,t,n,r)}finally{L.p=a,P.T=i}}function of(e,t,n,r){if(rf){var i=lf(r);if(null===i)$u(e,t,r,cf,n),wf(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return df=Tf(df,e,t,n,r,i),!0;case"dragenter":return pf=Tf(pf,e,t,n,r,i),!0;case"mouseover":return mf=Tf(mf,e,t,n,r,i),!0;case"pointerover":var a=i.pointerId;return gf.set(a,Tf(gf.get(a)||null,e,t,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,vf.set(a,Tf(vf.get(a)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(wf(e,r),4&t&&-1<bf.indexOf(e)){for(;null!==i;){var a=Ve(i);if(null!==a)switch(a.tag){case 3:if((a=a.stateNode).current.memoizedState.isDehydrated){var s=ye(a.pendingLanes);if(0!==s){var o=a;for(o.pendingLanes|=2,o.entangledLanes|=2;s;){var l=1<<31-de(s);o.entanglements[1]|=l,s&=~l}Su(a),0===(6&rc)&&(Sc=te()+500,xu(0,!1))}}break;case 13:null!==(o=Or(a,2))&&Fc(o,0,2),Vc(),tf(a,2)}if(null===(a=lf(r))&&$u(e,t,r,cf,n),a===i)break;i=a}null!==i&&r.stopPropagation()}else $u(e,t,r,null,n)}}function lf(e){return uf(e=Dt(e))}var cf=null;function uf(e){if(cf=null,null!==(e=Be(e))){var t=l(e);if(null===t)e=null;else{var n=t.tag;if(13===n){if(null!==(e=c(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return cf=e,null}function hf(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ne()){case re:return 2;case ie:return 8;case ae:case se:return 32;case oe:return 268435456;default:return 32}default:return 32}}var ff=!1,df=null,pf=null,mf=null,gf=new Map,vf=new Map,yf=[],bf="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function wf(e,t){switch(e){case"focusin":case"focusout":df=null;break;case"dragenter":case"dragleave":pf=null;break;case"mouseover":case"mouseout":mf=null;break;case"pointerover":case"pointerout":gf.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":vf.delete(t.pointerId)}}function Tf(e,t,n,r,i,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},null!==t&&(null!==(t=Ve(t))&&nf(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Ef(e){var t=Be(e.target);if(null!==t){var n=l(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=c(n)))return e.blockedOn=t,void function(e,t){var n=L.p;try{return L.p=e,t()}finally{L.p=n}}(e.priority,(function(){if(13===n.tag){var e=Lc();e=Ae(e);var t=Or(n,e);null!==t&&Fc(t,0,e),tf(n,e)}}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Sf(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=lf(e.nativeEvent);if(null!==n)return null!==(t=Ve(n))&&nf(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);Nt=r,n.target.dispatchEvent(r),Nt=null,t.shift()}return!0}function xf(e,t,n){Sf(e)&&n.delete(t)}function kf(){ff=!1,null!==df&&Sf(df)&&(df=null),null!==pf&&Sf(pf)&&(pf=null),null!==mf&&Sf(mf)&&(mf=null),gf.forEach(xf),vf.forEach(xf)}function _f(e,t){e.blockedOn===t&&(e.blockedOn=null,ff||(ff=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,kf)))}var Cf=null;function Af(e){Cf!==e&&(Cf=e,r.unstable_scheduleCallback(r.unstable_NormalPriority,(function(){Cf===e&&(Cf=null);for(var t=0;t<e.length;t+=3){var n=e[t],r=e[t+1],i=e[t+2];if("function"!==typeof r){if(null===uf(r||n))continue;break}var a=Ve(n);null!==a&&(e.splice(t,3),t-=3,Ds(a,{pending:!0,data:i,method:n.method,action:r},r,i))}})))}function If(e){function t(t){return _f(t,e)}null!==df&&_f(df,e),null!==pf&&_f(pf,e),null!==mf&&_f(mf,e),gf.forEach(t),vf.forEach(t);for(var n=0;n<yf.length;n++){var r=yf[n];r.blockedOn===e&&(r.blockedOn=null)}for(;0<yf.length&&null===(n=yf[0]).blockedOn;)Ef(n),null===n.blockedOn&&yf.shift();if(null!=(n=(e.ownerDocument||e).$$reactFormReplay))for(r=0;r<n.length;r+=3){var i=n[r],a=n[r+1],s=i[Re]||null;if("function"===typeof a)s||Af(n);else if(s){var o=null;if(a&&a.hasAttribute("formAction")){if(i=a,s=a[Re]||null)o=s.formAction;else if(null!==uf(i))continue}else o=s.action;"function"===typeof o?n[r+1]=o:(n.splice(r,3),r-=3),Af(n)}}}function Nf(e){this._internalRoot=e}function Df(e){this._internalRoot=e}Df.prototype.render=Nf.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Zh(t.current,Lc(),e,t,null,null)},Df.prototype.unmount=Nf.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;Zh(e.current,2,null,e,null,null),Vc(),t[Pe]=null}},Df.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ne();e={blockedOn:null,target:e,priority:t};for(var n=0;n<yf.length&&0!==t&&t<yf[n].priority;n++);yf.splice(n,0,e),0===n&&Ef(e)}};var Of=i.version;if("19.1.0"!==Of)throw Error(s(527,Of,"19.1.0"));L.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=l(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var a=i.alternate;if(null===a){if(null!==(r=i.return)){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return u(i),e;if(a===r)return u(i),t;a=a.sibling}throw Error(s(188))}if(n.return!==r.return)n=i,r=a;else{for(var o=!1,c=i.child;c;){if(c===n){o=!0,n=i,r=a;break}if(c===r){o=!0,r=i,n=a;break}c=c.sibling}if(!o){for(c=a.child;c;){if(c===n){o=!0,n=a,r=i;break}if(c===r){o=!0,r=a,n=i;break}c=c.sibling}if(!o)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(t),e=null===(e=null!==e?h(e):null)?null:e.stateNode};var Rf={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:P,reconcilerVersion:"19.1.0"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Pf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Pf.isDisabled&&Pf.supportsFiber)try{ue=Pf.inject(Rf),he=Pf}catch(Mf){}}t.createRoot=function(e,t){if(!o(e))throw Error(s(299));var n=!1,r="",i=bo,a=wo,l=To;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onUncaughtError&&(i=t.onUncaughtError),void 0!==t.onCaughtError&&(a=t.onCaughtError),void 0!==t.onRecoverableError&&(l=t.onRecoverableError),void 0!==t.unstable_transitionCallbacks&&t.unstable_transitionCallbacks),t=Qh(e,1,!1,null,0,n,r,i,a,l,0,null),e[Pe]=t.current,Bu(e),new Nf(t)},t.hydrateRoot=function(e,t,n){if(!o(e))throw Error(s(299));var r=!1,i="",a=bo,l=wo,c=To,u=null;return null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(i=n.identifierPrefix),void 0!==n.onUncaughtError&&(a=n.onUncaughtError),void 0!==n.onCaughtError&&(l=n.onCaughtError),void 0!==n.onRecoverableError&&(c=n.onRecoverableError),void 0!==n.unstable_transitionCallbacks&&n.unstable_transitionCallbacks,void 0!==n.formState&&(u=n.formState)),(t=Qh(e,1,!0,t,0,r,i,a,l,c,0,u)).context=Jh(null),n=t.current,(i=aa(r=Ae(r=Lc()))).callback=null,sa(n,i,r),n=r,t.current.lanes=n,ke(t,n),Su(t),e[Pe]=t.current,Bu(e),new Df(t)},t.version="19.1.0"},43:(e,t,n)=>{e.exports=n(288)},288:(e,t)=>{var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),d=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var w=b.prototype=new y;w.constructor=b,m(w,v.prototype),w.isPureReactComponent=!0;var T=Array.isArray,E={H:null,A:null,T:null,S:null,V:null},S=Object.prototype.hasOwnProperty;function x(e,t,r,i,a,s){return r=s.ref,{$$typeof:n,type:e,key:t,ref:void 0!==r?r:null,props:s}}function k(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var _=/\/+/g;function C(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function A(){}function I(e,t,i,a,s){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l,c,u=!1;if(null===e)u=!0;else switch(o){case"bigint":case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case r:u=!0;break;case f:return I((u=e._init)(e._payload),t,i,a,s)}}if(u)return s=s(e),u=""===a?"."+C(e,0):a,T(s)?(i="",null!=u&&(i=u.replace(_,"$&/")+"/"),I(s,t,i,"",(function(e){return e}))):null!=s&&(k(s)&&(l=s,c=i+(null==s.key||e&&e.key===s.key?"":(""+s.key).replace(_,"$&/")+"/")+u,s=x(l.type,c,void 0,0,0,l.props)),t.push(s)),1;u=0;var h,p=""===a?".":a+":";if(T(e))for(var m=0;m<e.length;m++)u+=I(a=e[m],t,i,o=p+C(a,m),s);else if("function"===typeof(m=null===(h=e)||"object"!==typeof h?null:"function"===typeof(h=d&&h[d]||h["@@iterator"])?h:null))for(e=m.call(e),m=0;!(a=e.next()).done;)u+=I(a=a.value,t,i,o=p+C(a,m++),s);else if("object"===o){if("function"===typeof e.then)return I(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"===typeof e.status?e.then(A,A):(e.status="pending",e.then((function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)}),(function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)}))),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,i,a,s);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return u}function N(e,t,n){if(null==e)return e;var r=[],i=0;return I(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function D(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var O="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function R(){}t.Children={map:N,forEach:function(e,t,n){N(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return N(e,(function(){t++})),t},toArray:function(e){return N(e,(function(e){return e}))||[]},only:function(e){if(!k(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=i,t.Profiler=s,t.PureComponent=b,t.StrictMode=a,t.Suspense=u,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=E,t.__COMPILER_RUNTIME={__proto__:null,c:function(e){return E.H.useMemoCache(e)}},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("The argument must be a React element, but you passed "+e+".");var r=m({},e.props),i=e.key;if(null!=t)for(a in void 0!==t.ref&&void 0,void 0!==t.key&&(i=""+t.key),t)!S.call(t,a)||"key"===a||"__self"===a||"__source"===a||"ref"===a&&void 0===t.ref||(r[a]=t[a]);var a=arguments.length-2;if(1===a)r.children=n;else if(1<a){for(var s=Array(a),o=0;o<a;o++)s[o]=arguments[o+2];r.children=s}return x(e.type,i,void 0,0,0,r)},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:o,_context:e},e},t.createElement=function(e,t,n){var r,i={},a=null;if(null!=t)for(r in void 0!==t.key&&(a=""+t.key),t)S.call(t,r)&&"key"!==r&&"__self"!==r&&"__source"!==r&&(i[r]=t[r]);var s=arguments.length-2;if(1===s)i.children=n;else if(1<s){for(var o=Array(s),l=0;l<s;l++)o[l]=arguments[l+2];i.children=o}if(e&&e.defaultProps)for(r in s=e.defaultProps)void 0===i[r]&&(i[r]=s[r]);return x(e,a,void 0,0,0,i)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=k,t.lazy=function(e){return{$$typeof:f,_payload:{_status:-1,_result:e},_init:D}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=E.T,n={};E.T=n;try{var r=e(),i=E.S;null!==i&&i(n,r),"object"===typeof r&&null!==r&&"function"===typeof r.then&&r.then(R,O)}catch(a){O(a)}finally{E.T=t}},t.unstable_useCacheRefresh=function(){return E.H.useCacheRefresh()},t.use=function(e){return E.H.use(e)},t.useActionState=function(e,t,n){return E.H.useActionState(e,t,n)},t.useCallback=function(e,t){return E.H.useCallback(e,t)},t.useContext=function(e){return E.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return E.H.useDeferredValue(e,t)},t.useEffect=function(e,t,n){var r=E.H;if("function"===typeof n)throw Error("useEffect CRUD overload is not enabled in this build of React.");return r.useEffect(e,t)},t.useId=function(){return E.H.useId()},t.useImperativeHandle=function(e,t,n){return E.H.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return E.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return E.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return E.H.useMemo(e,t)},t.useOptimistic=function(e,t){return E.H.useOptimistic(e,t)},t.useReducer=function(e,t,n){return E.H.useReducer(e,t,n)},t.useRef=function(e){return E.H.useRef(e)},t.useState=function(e){return E.H.useState(e)},t.useSyncExternalStore=function(e,t,n){return E.H.useSyncExternalStore(e,t,n)},t.useTransition=function(){return E.H.useTransition()},t.version="19.1.0"},391:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(4)},579:(e,t,n)=>{e.exports=n(799)},672:(e,t,n)=>{var r=n(43);function i(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(){}var s={d:{f:a,r:function(){throw Error(i(522))},D:a,C:a,L:a,m:a,X:a,S:a,M:a},p:0,findDOMNode:null},o=Symbol.for("react.portal");var l=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(e,t){return"font"===e?"":"string"===typeof t?"use-credentials"===t?t:"":void 0}t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(i(299));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:o,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.flushSync=function(e){var t=l.T,n=s.p;try{if(l.T=null,s.p=2,e)return e()}finally{l.T=t,s.p=n,s.d.f()}},t.preconnect=function(e,t){"string"===typeof e&&(t?t="string"===typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:t=null,s.d.C(e,t))},t.prefetchDNS=function(e){"string"===typeof e&&s.d.D(e)},t.preinit=function(e,t){if("string"===typeof e&&t&&"string"===typeof t.as){var n=t.as,r=c(n,t.crossOrigin),i="string"===typeof t.integrity?t.integrity:void 0,a="string"===typeof t.fetchPriority?t.fetchPriority:void 0;"style"===n?s.d.S(e,"string"===typeof t.precedence?t.precedence:void 0,{crossOrigin:r,integrity:i,fetchPriority:a}):"script"===n&&s.d.X(e,{crossOrigin:r,integrity:i,fetchPriority:a,nonce:"string"===typeof t.nonce?t.nonce:void 0})}},t.preinitModule=function(e,t){if("string"===typeof e)if("object"===typeof t&&null!==t){if(null==t.as||"script"===t.as){var n=c(t.as,t.crossOrigin);s.d.M(e,{crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0})}}else null==t&&s.d.M(e)},t.preload=function(e,t){if("string"===typeof e&&"object"===typeof t&&null!==t&&"string"===typeof t.as){var n=t.as,r=c(n,t.crossOrigin);s.d.L(e,n,{crossOrigin:r,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0,type:"string"===typeof t.type?t.type:void 0,fetchPriority:"string"===typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"===typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"===typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"===typeof t.imageSizes?t.imageSizes:void 0,media:"string"===typeof t.media?t.media:void 0})}},t.preloadModule=function(e,t){if("string"===typeof e)if(t){var n=c(t.as,t.crossOrigin);s.d.m(e,{as:"string"===typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0})}else s.d.m(e)},t.requestFormReset=function(e){s.d.r(e)},t.unstable_batchedUpdates=function(e,t){return e(t)},t.useFormState=function(e,t,n){return l.H.useFormState(e,t,n)},t.useFormStatus=function(){return l.H.useHostTransitionStatus()},t.version="19.1.0"},799:(e,t)=>{var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.fragment");function i(e,t,r){var i=null;if(void 0!==r&&(i=""+r),void 0!==t.key&&(i=""+t.key),"key"in t)for(var a in r={},t)"key"!==a&&(r[a]=t[a]);else r=t;return t=r.ref,{$$typeof:n,type:e,key:i,ref:void 0!==t?t:null,props:r}}t.Fragment=r,t.jsx=i,t.jsxs=i},853:(e,t,n)=>{e.exports=n(896)},896:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<a(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,s=i>>>1;r<s;){var o=2*(r+1)-1,l=e[o],c=o+1,u=e[c];if(0>a(l,n))c<i&&0>a(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[o]=n,r=o);else{if(!(c<i&&0>a(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(t.unstable_now=void 0,"object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],h=1,f=null,d=3,p=!1,m=!1,g=!1,v=!1,y="function"===typeof setTimeout?setTimeout:null,b="function"===typeof clearTimeout?clearTimeout:null,w="undefined"!==typeof setImmediate?setImmediate:null;function T(e){for(var t=r(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function E(e){if(g=!1,T(e),!m)if(null!==r(c))m=!0,x||(x=!0,S());else{var t=r(u);null!==t&&O(E,t.startTime-e)}}var S,x=!1,k=-1,_=5,C=-1;function A(){return!!v||!(t.unstable_now()-C<_)}function I(){if(v=!1,x){var e=t.unstable_now();C=e;var n=!0;try{e:{m=!1,g&&(g=!1,b(k),k=-1),p=!0;var a=d;try{t:{for(T(e),f=r(c);null!==f&&!(f.expirationTime>e&&A());){var s=f.callback;if("function"===typeof s){f.callback=null,d=f.priorityLevel;var o=s(f.expirationTime<=e);if(e=t.unstable_now(),"function"===typeof o){f.callback=o,T(e),n=!0;break t}f===r(c)&&i(c),T(e)}else i(c);f=r(c)}if(null!==f)n=!0;else{var l=r(u);null!==l&&O(E,l.startTime-e),n=!1}}break e}finally{f=null,d=a,p=!1}n=void 0}}finally{n?S():x=!1}}}if("function"===typeof w)S=function(){w(I)};else if("undefined"!==typeof MessageChannel){var N=new MessageChannel,D=N.port2;N.port1.onmessage=I,S=function(){D.postMessage(null)}}else S=function(){y(I,0)};function O(e,n){k=y((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_next=function(e){switch(d){case 1:case 2:case 3:var t=3;break;default:t=d}var n=d;d=t;try{return e()}finally{d=n}},t.unstable_requestPaint=function(){v=!0},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=d;d=e;try{return t()}finally{d=n}},t.unstable_scheduleCallback=function(e,i,a){var s=t.unstable_now();switch("object"===typeof a&&null!==a?a="number"===typeof(a=a.delay)&&0<a?s+a:s:a=s,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:h++,callback:i,priorityLevel:e,startTime:a,expirationTime:o=a+o,sortIndex:-1},a>s?(e.sortIndex=a,n(u,e),null===r(c)&&e===r(u)&&(g?(b(k),k=-1):g=!0,O(E,a-s))):(e.sortIndex=o,n(c,e),m||p||(m=!0,x||(x=!0,S()))),e},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(e){var t=d;return function(){var n=d;d=t;try{return e.apply(this,arguments)}finally{d=n}}}},950:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(672)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.m=e,n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,r)=>(n.f[r](e,t),t)),[])),n.u=e=>"static/js/"+e+".4b8be825.chunk.js",n.miniCssF=e=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="asignacion-plazas:";n.l=(r,i,a,s)=>{if(e[r])e[r].push(i);else{var o,l;if(void 0!==a)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var h=c[u];if(h.getAttribute("src")==r||h.getAttribute("data-webpack")==t+a){o=h;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,n.nc&&o.setAttribute("nonce",n.nc),o.setAttribute("data-webpack",t+a),o.src=r),e[r]=[i];var f=(t,n)=>{o.onerror=o.onload=null,clearTimeout(d);var i=e[r];if(delete e[r],o.parentNode&&o.parentNode.removeChild(o),i&&i.forEach((e=>e(n))),t)return t(n)},d=setTimeout(f.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=f.bind(null,o.onerror),o.onload=f.bind(null,o.onload),l&&document.head.appendChild(o)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/asignacion-plazas/",(()=>{var e={792:0};n.f.j=(t,r)=>{var i=n.o(e,t)?e[t]:void 0;if(0!==i)if(i)r.push(i[2]);else{var a=new Promise(((n,r)=>i=e[t]=[n,r]));r.push(i[2]=a);var s=n.p+n.u(t),o=new Error;n.l(s,(r=>{if(n.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var a=r&&("load"===r.type?"missing":r.type),s=r&&r.target&&r.target.src;o.message="Loading chunk "+t+" failed.\n("+a+": "+s+")",o.name="ChunkLoadError",o.type=a,o.request=s,i[1](o)}}),"chunk-"+t,t)}};var t=(t,r)=>{var i,a,s=r[0],o=r[1],l=r[2],c=0;if(s.some((t=>0!==e[t]))){for(i in o)n.o(o,i)&&(n.m[i]=o[i]);if(l)l(n)}for(t&&t(r);c<s.length;c++)a=s[c],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0},r=self.webpackChunkasignacion_plazas=self.webpackChunkasignacion_plazas||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var r=n(43),i=n(391);const a=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},s={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const t=e[i],a=i+1<e.length,s=a?e[i+1]:0,o=i+2<e.length,l=o?e[i+2]:0,c=t>>2,u=(3&t)<<4|s>>4;let h=(15&s)<<2|l>>6,f=63&l;o||(f=64,a||(h=64)),r.push(n[c],n[u],n[h],n[f])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(a(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const a=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&a)}else if(i>239&&i<365){const a=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(a>>10)),t[r++]=String.fromCharCode(56320+(1023&a))}else{const a=e[n++],s=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&a)<<6|63&s)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const t=n[e.charAt(i++)],a=i<e.length?n[e.charAt(i)]:0;++i;const s=i<e.length?n[e.charAt(i)]:64;++i;const l=i<e.length?n[e.charAt(i)]:64;if(++i,null==t||null==a||null==s||null==l)throw new o;const c=t<<2|a>>4;if(r.push(c),64!==s){const e=a<<4&240|s>>2;if(r.push(e),64!==l){const e=s<<6&192|l;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class o extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const l=function(e){return function(e){const t=a(e);return s.encodeByteArray(t,!0)}(e).replace(/\./g,"")},c=function(e){try{return s.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};const u=()=>function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,h=()=>{try{return u()||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"/asignacion-plazas",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const t=e&&c(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},f=e=>{const t=(e=>{var t,n;return null===(n=null===(t=h())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]})(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]},d=()=>{var e;return null===(e=h())||void 0===e?void 0:e.config};class p{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function m(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function g(){return!function(){var e;const t=null===(e=h())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(r){return!1}}()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function v(){try{return"object"===typeof indexedDB}catch(e){return!1}}function y(){return new Promise(((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}}))}class b extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,b.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,w.prototype.create)}}class w{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n=`${this.service}/${e}`,r=this.errors[e],i=r?function(e,t){return e.replace(T,((e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`}))}(r,t):"Error",a=`${this.serviceName}: ${i} (${n}).`;return new b(n,a,t)}}const T=/\{\$([^}]+)}/g;function E(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],a=t[i];if(S(n)&&S(a)){if(!E(n,a))return!1}else if(n!==a)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function S(e){return null!==e&&"object"===typeof e}function x(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;const n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3)*Math.pow(t,e),r=Math.round(.5*n*(Math.random()-.5)*2);return Math.min(144e5,n+r)}function k(e){return e&&e._delegate?e._delegate:e}class _{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const C="[DEFAULT]";class A{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new p;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(n){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:C})}catch(t){}for(const[e,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:r});n.resolve(e)}catch(t){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[i,a]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(i)&&a.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const a=this.instances.get(r);return a&&e(a,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch(r){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===C?void 0:i),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch(a){}var i;return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C;return this.component?this.component.multipleInstances?e:C:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class I{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new A(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const N=[];var D;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(D||(D={}));const O={debug:D.DEBUG,verbose:D.VERBOSE,info:D.INFO,warn:D.WARN,error:D.ERROR,silent:D.SILENT},R=D.INFO,P={[D.DEBUG]:"log",[D.VERBOSE]:"log",[D.INFO]:"info",[D.WARN]:"warn",[D.ERROR]:"error"},L=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=P[t];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);for(var i=arguments.length,a=new Array(i>2?i-2:0),s=2;s<i;s++)a[s-2]=arguments[s];console[r](`[${n}]  ${e.name}:`,...a)};class M{constructor(e){this.name=e,this._logLevel=R,this._logHandler=L,this._userLogHandler=null,N.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in D))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?O[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,D.DEBUG,...t),this._logHandler(this,D.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,D.VERBOSE,...t),this._logHandler(this,D.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,D.INFO,...t),this._logHandler(this,D.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,D.WARN,...t),this._logHandler(this,D.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,D.ERROR,...t),this._logHandler(this,D.ERROR,...t)}}let F,z;const U=new WeakMap,j=new WeakMap,B=new WeakMap,V=new WeakMap,H=new WeakMap;let W={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return j.get(e);if("objectStoreNames"===t)return e.objectStoreNames||B.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return q(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function G(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(z||(z=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(Y(this),n),q(U.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return q(e.apply(Y(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const a=e.call(Y(this),t,...r);return B.set(a,t.sort?t.sort():[t]),q(a)}}function K(e){return"function"===typeof e?G(e):(e instanceof IDBTransaction&&function(e){if(j.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",a),e.removeEventListener("abort",a)},i=()=>{t(),r()},a=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",a),e.addEventListener("abort",a)}));j.set(e,t)}(e),t=e,(F||(F=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>t instanceof e))?new Proxy(e,W):e);var t}function q(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",a)},i=()=>{t(q(e.result)),r()},a=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",a)}));return t.then((t=>{t instanceof IDBCursor&&U.set(t,e)})).catch((()=>{})),H.set(t,e),t}(e);if(V.has(e))return V.get(e);const t=K(e);return t!==e&&(V.set(e,t),H.set(t,e)),t}const Y=e=>H.get(e);function X(e,t){let{blocked:n,upgrade:r,blocking:i,terminated:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const s=indexedDB.open(e,t),o=q(s);return r&&s.addEventListener("upgradeneeded",(e=>{r(q(s.result),e.oldVersion,e.newVersion,q(s.transaction),e)})),n&&s.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),o.then((e=>{a&&e.addEventListener("close",(()=>a())),i&&e.addEventListener("versionchange",(e=>i(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),o}const Q=["get","getKey","getAll","getAllKeys","count"],J=["put","add","delete","clear"],Z=new Map;function ee(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(Z.get(t))return Z.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=J.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!Q.includes(n))return;const a=async function(e){const t=this.transaction(e,i?"readwrite":"readonly");let a=t.store;for(var s=arguments.length,o=new Array(s>1?s-1:0),l=1;l<s;l++)o[l-1]=arguments[l];return r&&(a=a.index(o.shift())),(await Promise.all([a[n](...o),i&&t.done]))[0]};return Z.set(t,a),a}W=(e=>({...e,get:(t,n,r)=>ee(t,n)||e.get(t,n,r),has:(t,n)=>!!ee(t,n)||e.has(t,n)}))(W);class te{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const ne="@firebase/app",re="0.11.3",ie=new M("@firebase/app"),ae="@firebase/app-compat",se="@firebase/analytics-compat",oe="@firebase/analytics",le="@firebase/app-check-compat",ce="@firebase/app-check",ue="@firebase/auth",he="@firebase/auth-compat",fe="@firebase/database",de="@firebase/data-connect",pe="@firebase/database-compat",me="@firebase/functions",ge="@firebase/functions-compat",ve="@firebase/installations",ye="@firebase/installations-compat",be="@firebase/messaging",we="@firebase/messaging-compat",Te="@firebase/performance",Ee="@firebase/performance-compat",Se="@firebase/remote-config",xe="@firebase/remote-config-compat",ke="@firebase/storage",_e="@firebase/storage-compat",Ce="@firebase/firestore",Ae="@firebase/vertexai",Ie="@firebase/firestore-compat",Ne="firebase",De="[DEFAULT]",Oe={[ne]:"fire-core",[ae]:"fire-core-compat",[oe]:"fire-analytics",[se]:"fire-analytics-compat",[ce]:"fire-app-check",[le]:"fire-app-check-compat",[ue]:"fire-auth",[he]:"fire-auth-compat",[fe]:"fire-rtdb",[de]:"fire-data-connect",[pe]:"fire-rtdb-compat",[me]:"fire-fn",[ge]:"fire-fn-compat",[ve]:"fire-iid",[ye]:"fire-iid-compat",[be]:"fire-fcm",[we]:"fire-fcm-compat",[Te]:"fire-perf",[Ee]:"fire-perf-compat",[Se]:"fire-rc",[xe]:"fire-rc-compat",[ke]:"fire-gcs",[_e]:"fire-gcs-compat",[Ce]:"fire-fst",[Ie]:"fire-fst-compat",[Ae]:"fire-vertex","fire-js":"fire-js",[Ne]:"fire-js-all"},Re=new Map,Pe=new Map,Le=new Map;function Me(e,t){try{e.container.addComponent(t)}catch(n){ie.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function Fe(e){const t=e.name;if(Le.has(t))return ie.debug(`There were multiple attempts to register component ${t}.`),!1;Le.set(t,e);for(const n of Re.values())Me(n,e);for(const n of Pe.values())Me(n,e);return!0}function ze(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}const Ue=new w("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class je{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new _("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ue.create("app-deleted",{appName:this._name})}}function Be(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const r=Object.assign({name:De,automaticDataCollectionEnabled:!1},t),i=r.name;if("string"!==typeof i||!i)throw Ue.create("bad-app-name",{appName:String(i)});if(n||(n=d()),!n)throw Ue.create("no-options");const a=Re.get(i);if(a){if(E(n,a.options)&&E(r,a.config))return a;throw Ue.create("duplicate-app",{appName:i})}const s=new I(i);for(const l of Le.values())s.addComponent(l);const o=new je(n,r,s);return Re.set(i,o),o}function Ve(e,t,n){var r;let i=null!==(r=Oe[e])&&void 0!==r?r:e;n&&(i+=`-${n}`);const a=i.match(/\s|\//),s=t.match(/\s|\//);if(a||s){const e=[`Unable to register library "${i}" with version "${t}":`];return a&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),a&&s&&e.push("and"),s&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void ie.warn(e.join(" "))}Fe(new _(`${i}-version`,(()=>({library:i,version:t})),"VERSION"))}const $e="firebase-heartbeat-store";let He=null;function We(){return He||(He=X("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore($e)}catch(n){console.warn(n)}}}).catch((e=>{throw Ue.create("idb-open",{originalErrorMessage:e.message})}))),He}async function Ge(e,t){try{const n=(await We()).transaction($e,"readwrite"),r=n.objectStore($e);await r.put(t,Ke(e)),await n.done}catch(n){if(n instanceof b)ie.warn(n.message);else{const e=Ue.create("idb-set",{originalErrorMessage:null===n||void 0===n?void 0:n.message});ie.warn(e.message)}}}function Ke(e){return`${e.name}!${e.options.appId}`}class qe{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Xe(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){var e,t;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Ye();if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some((e=>e.date===r)))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>30){const e=function(e){if(0===e.length)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){ie.warn(n)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=Ye(),{heartbeatsToSend:n,unsentEntries:r}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const i of e){const e=n.find((e=>e.agent===i.agent));if(e){if(e.dates.push(i.date),Qe(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Qe(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),i=l(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return ie.warn(t),""}}}function Ye(){return(new Date).toISOString().substring(0,10)}class Xe{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!v()&&y().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await We()).transaction($e),n=await t.objectStore($e).get(Ke(e));return await t.done,n}catch(t){if(t instanceof b)ie.warn(t.message);else{const e=Ue.create("idb-get",{originalErrorMessage:null===t||void 0===t?void 0:t.message});ie.warn(e.message)}}}(this.app);return(null===e||void 0===e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return Ge(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return Ge(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function Qe(e){return l(JSON.stringify({version:2,heartbeats:e})).length}var Je;Je="",Fe(new _("platform-logger",(e=>new te(e)),"PRIVATE")),Fe(new _("heartbeat",(e=>new qe(e)),"PRIVATE")),Ve(ne,re,Je),Ve(ne,re,"esm2017"),Ve("fire-js","");var Ze,et,tt="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},nt={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(e,t,n){n||(n=0);var r=Array(16);if("string"===typeof t)for(var i=0;16>i;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];var a=e.g[3],s=t+(a^n&(i^a))+r[0]+3614090360&4294967295;s=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=n+(s<<7&4294967295|s>>>25))+((s=a+(i^t&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|s>>>20))+((s=i+(n^a&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^i&(a^t))+r[3]+3250441966&4294967295)<<22&4294967295|s>>>10))+((s=t+(a^n&(i^a))+r[4]+4118548399&4294967295)<<7&4294967295|s>>>25))+((s=a+(i^t&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|s>>>20))+((s=i+(n^a&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^i&(a^t))+r[7]+4249261313&4294967295)<<22&4294967295|s>>>10))+((s=t+(a^n&(i^a))+r[8]+1770035416&4294967295)<<7&4294967295|s>>>25))+((s=a+(i^t&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|s>>>20))+((s=i+(n^a&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^i&(a^t))+r[11]+2304563134&4294967295)<<22&4294967295|s>>>10))+((s=t+(a^n&(i^a))+r[12]+1804603682&4294967295)<<7&4294967295|s>>>25))+((s=a+(i^t&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|s>>>20))+((s=i+(n^a&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^i&(a^t))+r[15]+1236535329&4294967295)<<22&4294967295|s>>>10))+((s=t+(i^a&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|s>>>27))+((s=a+(n^i&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|s>>>23))+((s=i+(t^n&(a^t))+r[11]+643717713&4294967295)<<14&4294967295|s>>>18))+((s=n+(a^t&(i^a))+r[0]+3921069994&4294967295)<<20&4294967295|s>>>12))+((s=t+(i^a&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|s>>>27))+((s=a+(n^i&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|s>>>23))+((s=i+(t^n&(a^t))+r[15]+3634488961&4294967295)<<14&4294967295|s>>>18))+((s=n+(a^t&(i^a))+r[4]+3889429448&4294967295)<<20&4294967295|s>>>12))+((s=t+(i^a&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|s>>>27))+((s=a+(n^i&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|s>>>23))+((s=i+(t^n&(a^t))+r[3]+4107603335&4294967295)<<14&4294967295|s>>>18))+((s=n+(a^t&(i^a))+r[8]+1163531501&4294967295)<<20&4294967295|s>>>12))+((s=t+(i^a&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|s>>>27))+((s=a+(n^i&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|s>>>23))+((s=i+(t^n&(a^t))+r[7]+1735328473&4294967295)<<14&4294967295|s>>>18))+((s=n+(a^t&(i^a))+r[12]+2368359562&4294967295)<<20&4294967295|s>>>12))+((s=t+(n^i^a)+r[5]+4294588738&4294967295)<<4&4294967295|s>>>28))+((s=a+(t^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|s>>>21))+((s=i+(a^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|s>>>16))+((s=n+(i^a^t)+r[14]+4259657740&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^i^a)+r[1]+2763975236&4294967295)<<4&4294967295|s>>>28))+((s=a+(t^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|s>>>21))+((s=i+(a^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|s>>>16))+((s=n+(i^a^t)+r[10]+3200236656&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^i^a)+r[13]+681279174&4294967295)<<4&4294967295|s>>>28))+((s=a+(t^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|s>>>21))+((s=i+(a^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|s>>>16))+((s=n+(i^a^t)+r[6]+76029189&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^i^a)+r[9]+3654602809&4294967295)<<4&4294967295|s>>>28))+((s=a+(t^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|s>>>21))+((s=i+(a^t^n)+r[15]+530742520&4294967295)<<16&4294967295|s>>>16))+((s=n+(i^a^t)+r[2]+3299628645&4294967295)<<23&4294967295|s>>>9))+((s=t+(i^(n|~a))+r[0]+4096336452&4294967295)<<6&4294967295|s>>>26))+((s=a+(n^(t|~i))+r[7]+1126891415&4294967295)<<10&4294967295|s>>>22))+((s=i+(t^(a|~n))+r[14]+2878612391&4294967295)<<15&4294967295|s>>>17))+((s=n+(a^(i|~t))+r[5]+4237533241&4294967295)<<21&4294967295|s>>>11))+((s=t+(i^(n|~a))+r[12]+1700485571&4294967295)<<6&4294967295|s>>>26))+((s=a+(n^(t|~i))+r[3]+2399980690&4294967295)<<10&4294967295|s>>>22))+((s=i+(t^(a|~n))+r[10]+4293915773&4294967295)<<15&4294967295|s>>>17))+((s=n+(a^(i|~t))+r[1]+2240044497&4294967295)<<21&4294967295|s>>>11))+((s=t+(i^(n|~a))+r[8]+1873313359&4294967295)<<6&4294967295|s>>>26))+((s=a+(n^(t|~i))+r[15]+4264355552&4294967295)<<10&4294967295|s>>>22))+((s=i+(t^(a|~n))+r[6]+2734768916&4294967295)<<15&4294967295|s>>>17))+((s=n+(a^(i|~t))+r[13]+1309151649&4294967295)<<21&4294967295|s>>>11))+((a=(t=n+((s=t+(i^(n|~a))+r[4]+4149444226&4294967295)<<6&4294967295|s>>>26))+((s=a+(n^(t|~i))+r[11]+3174756917&4294967295)<<10&4294967295|s>>>22))^((i=a+((s=i+(t^(a|~n))+r[2]+718787259&4294967295)<<15&4294967295|s>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(s<<21&4294967295|s>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+a&4294967295}function r(e,t){this.h=t;for(var n=[],r=!0,i=e.length-1;0<=i;i--){var a=0|e[i];r&&a==t||(n[i]=a,r=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.D=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.C=function(e,n,r){for(var i=Array(arguments.length-2),a=2;a<arguments.length;a++)i[a-2]=arguments[a];return t.prototype[n].apply(e,i)}}(t,(function(){this.blockSize=-1})),t.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var r=t-this.blockSize,i=this.B,a=this.h,s=0;s<t;){if(0==a)for(;s<=r;)n(this,e,s),s+=this.blockSize;if("string"===typeof e){for(;s<t;)if(i[a++]=e.charCodeAt(s++),a==this.blockSize){n(this,i),a=0;break}}else for(;s<t;)if(i[a++]=e[s++],a==this.blockSize){n(this,i),a=0;break}}this.h=a,this.o+=t},t.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.u(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var i={};function a(e){return-128<=e&&128>e?function(e,t){var n=i;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,(function(e){return new r([0|e],0>e?-1:0)})):new r([0|e],0>e?-1:0)}function s(e){if(isNaN(e)||!isFinite(e))return o;if(0>e)return f(s(-e));for(var t=[],n=1,i=0;e>=n;i++)t[i]=e/n|0,n*=4294967296;return new r(t,0)}var o=a(0),l=a(1),c=a(16777216);function u(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function h(e){return-1==e.h}function f(e){for(var t=e.g.length,n=[],i=0;i<t;i++)n[i]=~e.g[i];return new r(n,~e.h).add(l)}function d(e,t){return e.add(f(t))}function p(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function m(e,t){this.g=e,this.h=t}function g(e,t){if(u(t))throw Error("division by zero");if(u(e))return new m(o,o);if(h(e))return t=g(f(e),t),new m(f(t.g),f(t.h));if(h(t))return t=g(e,f(t)),new m(f(t.g),t.h);if(30<e.g.length){if(h(e)||h(t))throw Error("slowDivide_ only works with positive integers.");for(var n=l,r=t;0>=r.l(e);)n=v(n),r=v(r);var i=y(n,1),a=y(r,1);for(r=y(r,2),n=y(n,2);!u(r);){var c=a.add(r);0>=c.l(e)&&(i=i.add(n),a=c),r=y(r,1),n=y(n,1)}return t=d(e,i.j(t)),new m(i,t)}for(i=o;0<=e.l(t);){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),c=(a=s(n)).j(t);h(c)||0<c.l(e);)c=(a=s(n-=r)).j(t);u(a)&&(a=l),i=i.add(a),e=d(e,c)}return new m(i,e)}function v(e){for(var t=e.g.length+1,n=[],i=0;i<t;i++)n[i]=e.i(i)<<1|e.i(i-1)>>>31;return new r(n,e.h)}function y(e,t){var n=t>>5;t%=32;for(var i=e.g.length-n,a=[],s=0;s<i;s++)a[s]=0<t?e.i(s+n)>>>t|e.i(s+n+1)<<32-t:e.i(s+n);return new r(a,e.h)}(e=r.prototype).m=function(){if(h(this))return-f(this).m();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.i(n);e+=(0<=r?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(u(this))return"0";if(h(this))return"-"+f(this).toString(e);for(var t=s(Math.pow(e,6)),n=this,r="";;){var i=g(n,t).g,a=((0<(n=d(n,i.j(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(u(n=i))return a+r;for(;6>a.length;)a="0"+a;r=a+r}},e.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return h(e=d(this,e))?-1:u(e)?0:1},e.abs=function(){return h(this)?f(this):this},e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0,a=0;a<=t;a++){var s=i+(65535&this.i(a))+(65535&e.i(a)),o=(s>>>16)+(this.i(a)>>>16)+(e.i(a)>>>16);i=o>>>16,s&=65535,o&=65535,n[a]=o<<16|s}return new r(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(u(this)||u(e))return o;if(h(this))return h(e)?f(this).j(f(e)):f(f(this).j(e));if(h(e))return f(this.j(f(e)));if(0>this.l(c)&&0>e.l(c))return s(this.m()*e.m());for(var t=this.g.length+e.g.length,n=[],i=0;i<2*t;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(var a=0;a<e.g.length;a++){var l=this.i(i)>>>16,d=65535&this.i(i),m=e.i(a)>>>16,g=65535&e.i(a);n[2*i+2*a]+=d*g,p(n,2*i+2*a),n[2*i+2*a+1]+=l*g,p(n,2*i+2*a+1),n[2*i+2*a+1]+=d*m,p(n,2*i+2*a+1),n[2*i+2*a+2]+=l*m,p(n,2*i+2*a+2)}for(i=0;i<t;i++)n[i]=n[2*i+1]<<16|n[2*i];for(i=t;i<2*t;i++)n[i]=0;return new r(n,0)},e.A=function(e){return g(this,e).h},e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)&e.i(i);return new r(n,this.h&e.h)},e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)|e.i(i);return new r(n,this.h|e.h)},e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)^e.i(i);return new r(n,this.h^e.h)},t.prototype.digest=t.prototype.v,t.prototype.reset=t.prototype.s,t.prototype.update=t.prototype.u,et=nt.Md5=t,r.prototype.add=r.prototype.add,r.prototype.multiply=r.prototype.j,r.prototype.modulo=r.prototype.A,r.prototype.compare=r.prototype.l,r.prototype.toNumber=r.prototype.m,r.prototype.toString=r.prototype.toString,r.prototype.getBits=r.prototype.i,r.fromNumber=s,r.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return f(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=s(Math.pow(n,8)),i=o,a=0;a<t.length;a+=8){var l=Math.min(8,t.length-a),c=parseInt(t.substring(a,a+l),n);8>l?(l=s(Math.pow(n,l)),i=i.j(l).add(s(c))):i=(i=i.j(r)).add(s(c))}return i},Ze=nt.Integer=r}).apply("undefined"!==typeof tt?tt:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var rt,it,at,st,ot,lt,ct,ut,ht="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},ft={};(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof ht&&ht];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(e,r){if(r)e:{var i=n;e=e.split(".");for(var a=0;a<e.length-1;a++){var s=e[a];if(!(s in i))break e;i=i[s]}(r=r(a=i[e=e[e.length-1]]))!=a&&null!=r&&t(i,e,{configurable:!0,writable:!0,value:r})}}("Array.prototype.values",(function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,i={next:function(){if(!r&&n<e.length){var i=n++;return{value:t(i,e[i]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}(this,(function(e,t){return t}))}}));var r=r||{},i=this||self;function a(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function s(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function o(e,t,n){return e.call.apply(e.bind,arguments)}function l(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function c(e,t,n){return(c=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?o:l).apply(null,arguments)}function u(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function h(e,t){function n(){}n.prototype=t.prototype,e.aa=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Qb=function(e,n,r){for(var i=Array(arguments.length-2),a=2;a<arguments.length;a++)i[a-2]=arguments[a];return t.prototype[n].apply(e,i)}}function f(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function d(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(a(t)){const n=e.length||0,r=t.length||0;e.length=n+r;for(let i=0;i<r;i++)e[n+i]=t[i]}else e.push(t)}}function p(e){return/^[\s\xa0]*$/.test(e)}function m(){var e=i.navigator;return e&&(e=e.userAgent)?e:""}function g(e){return g[" "](e),e}g[" "]=function(){};var v=-1!=m().indexOf("Gecko")&&!(-1!=m().toLowerCase().indexOf("webkit")&&-1==m().indexOf("Edge"))&&!(-1!=m().indexOf("Trident")||-1!=m().indexOf("MSIE"))&&-1==m().indexOf("Edge");function y(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function b(e){const t={};for(const n in e)t[n]=e[n];return t}const w="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function T(e,t){let n,r;for(let i=1;i<arguments.length;i++){for(n in r=arguments[i],r)e[n]=r[n];for(let t=0;t<w.length;t++)n=w[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function E(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function S(e){i.setTimeout((()=>{throw e}),0)}function x(){var e=I;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var k=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new _),(e=>e.reset()));class _{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let C,A=!1,I=new class{constructor(){this.h=this.g=null}add(e,t){const n=k.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},N=()=>{const e=i.Promise.resolve(void 0);C=()=>{e.then(D)}};var D=()=>{for(var e;e=x();){try{e.h.call(e.g)}catch(n){S(n)}var t=k;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}A=!1};function O(){this.s=this.s,this.C=this.C}function R(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}O.prototype.s=!1,O.prototype.ma=function(){this.s||(this.s=!0,this.N())},O.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},R.prototype.h=function(){this.defaultPrevented=!0};var P=function(){if(!i.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};i.addEventListener("test",e,t),i.removeEventListener("test",e,t)}catch(n){}return e}();function L(e,t){if(R.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(v){e:{try{g(t.nodeName);var i=!0;break e}catch(a){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:M[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&L.aa.h.call(this)}}h(L,R);var M={2:"touch",3:"pen",4:"mouse"};L.prototype.h=function(){L.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var F="closure_listenable_"+(1e6*Math.random()|0),z=0;function U(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=i,this.key=++z,this.da=this.fa=!1}function j(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function B(e){this.src=e,this.g={},this.h=0}function V(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],a=Array.prototype.indexOf.call(i,t,void 0);(r=0<=a)&&Array.prototype.splice.call(i,a,1),r&&(j(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function $(e,t,n,r){for(var i=0;i<e.length;++i){var a=e[i];if(!a.da&&a.listener==t&&a.capture==!!n&&a.ha==r)return i}return-1}B.prototype.add=function(e,t,n,r,i){var a=e.toString();(e=this.g[a])||(e=this.g[a]=[],this.h++);var s=$(e,t,r,i);return-1<s?(t=e[s],n||(t.fa=!1)):((t=new U(t,this.src,a,!!r,i)).fa=n,e.push(t)),t};var H="closure_lm_"+(1e6*Math.random()|0),W={};function G(e,t,n,r,i){if(r&&r.once)return q(e,t,n,r,i);if(Array.isArray(t)){for(var a=0;a<t.length;a++)G(e,t[a],n,r,i);return null}return n=te(n),e&&e[F]?e.K(t,n,s(r)?!!r.capture:!!r,i):K(e,t,n,!1,r,i)}function K(e,t,n,r,i,a){if(!t)throw Error("Invalid event type");var o=s(i)?!!i.capture:!!i,l=Z(e);if(l||(e[H]=l=new B(e)),(n=l.add(t,n,r,o,a)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=J;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)P||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(Q(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function q(e,t,n,r,i){if(Array.isArray(t)){for(var a=0;a<t.length;a++)q(e,t[a],n,r,i);return null}return n=te(n),e&&e[F]?e.L(t,n,s(r)?!!r.capture:!!r,i):K(e,t,n,!0,r,i)}function Y(e,t,n,r,i){if(Array.isArray(t))for(var a=0;a<t.length;a++)Y(e,t[a],n,r,i);else r=s(r)?!!r.capture:!!r,n=te(n),e&&e[F]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=$(a=e.g[t],n,r,i))&&(j(a[n]),Array.prototype.splice.call(a,n,1),0==a.length&&(delete e.g[t],e.h--)))):e&&(e=Z(e))&&(t=e.g[t.toString()],e=-1,t&&(e=$(t,n,r,i)),(n=-1<e?t[e]:null)&&X(n))}function X(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[F])V(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(Q(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Z(t))?(V(n,e),0==n.h&&(n.src=null,t[H]=null)):j(e)}}}function Q(e){return e in W?W[e]:W[e]="on"+e}function J(e,t){if(e.da)e=!0;else{t=new L(t,this);var n=e.listener,r=e.ha||e.src;e.fa&&X(e),e=n.call(r,t)}return e}function Z(e){return(e=e[H])instanceof B?e:null}var ee="__closure_events_fn_"+(1e9*Math.random()>>>0);function te(e){return"function"===typeof e?e:(e[ee]||(e[ee]=function(t){return e.handleEvent(t)}),e[ee])}function ne(){O.call(this),this.i=new B(this),this.M=this,this.F=null}function re(e,t){var n,r=e.F;if(r)for(n=[];r;r=r.F)n.push(r);if(e=e.M,r=t.type||t,"string"===typeof t)t=new R(t,e);else if(t instanceof R)t.target=t.target||e;else{var i=t;T(t=new R(r,e),i)}if(i=!0,n)for(var a=n.length-1;0<=a;a--){var s=t.g=n[a];i=ie(s,r,!0,t)&&i}if(i=ie(s=t.g=e,r,!0,t)&&i,i=ie(s,r,!1,t)&&i,n)for(a=0;a<n.length;a++)i=ie(s=t.g=n[a],r,!1,t)&&i}function ie(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,a=0;a<t.length;++a){var s=t[a];if(s&&!s.da&&s.capture==n){var o=s.listener,l=s.ha||s.src;s.fa&&V(e.i,s),i=!1!==o.call(l,r)&&i}}return i&&!r.defaultPrevented}function ae(e,t,n){if("function"===typeof e)n&&(e=c(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=c(e.handleEvent,e)}return 2147483647<Number(t)?-1:i.setTimeout(e,t||0)}function se(e){e.g=ae((()=>{e.g=null,e.i&&(e.i=!1,se(e))}),e.l);const t=e.h;e.h=null,e.m.apply(null,t)}h(ne,O),ne.prototype[F]=!0,ne.prototype.removeEventListener=function(e,t,n,r){Y(this,e,t,n,r)},ne.prototype.N=function(){if(ne.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)j(n[r]);delete t.g[e],t.h--}}this.F=null},ne.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},ne.prototype.L=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};class oe extends O{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:se(this)}N(){super.N(),this.g&&(i.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function le(e){O.call(this),this.h=e,this.g={}}h(le,O);var ce=[];function ue(e){y(e.g,(function(e,t){this.g.hasOwnProperty(t)&&X(e)}),e),e.g={}}le.prototype.N=function(){le.aa.N.call(this),ue(this)},le.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var he=i.JSON.stringify,fe=i.JSON.parse,de=class{stringify(e){return i.JSON.stringify(e,void 0)}parse(e){return i.JSON.parse(e,void 0)}};function pe(){}function me(e){return e.h||(e.h=e.i())}function ge(){}pe.prototype.h=null;var ve={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ye(){R.call(this,"d")}function be(){R.call(this,"c")}h(ye,R),h(be,R);var we={},Te=null;function Ee(){return Te=Te||new ne}function Se(e){R.call(this,we.La,e)}function xe(e){const t=Ee();re(t,new Se(t))}function ke(e,t){R.call(this,we.STAT_EVENT,e),this.stat=t}function _e(e){const t=Ee();re(t,new ke(t,e))}function Ce(e,t){R.call(this,we.Ma,e),this.size=t}function Ae(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return i.setTimeout((function(){e()}),t)}function Ie(){this.g=!0}function Ne(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var a=i[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var s=1;s<i.length;s++)i[s]=""}}}return he(n)}catch(o){return t}}(e,n)+(r?" "+r:"")}))}we.La="serverreachability",h(Se,R),we.STAT_EVENT="statevent",h(ke,R),we.Ma="timingevent",h(Ce,R),Ie.prototype.xa=function(){this.g=!1},Ie.prototype.info=function(){};var De,Oe={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Re={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function Pe(){}function Le(e,t,n,r){this.j=e,this.i=t,this.l=n,this.R=r||1,this.U=new le(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Me}function Me(){this.i=null,this.g="",this.h=!1}h(Pe,pe),Pe.prototype.g=function(){return new XMLHttpRequest},Pe.prototype.i=function(){return{}},De=new Pe;var Fe={},ze={};function Ue(e,t,n){e.L=1,e.v=Et(vt(t)),e.m=n,e.P=!0,je(e,null)}function je(e,t){e.F=Date.now(),$e(e),e.A=vt(e.v);var n=e.A,r=e.R;Array.isArray(r)||(r=[String(r)]),Mt(n.i,"t",r),e.C=0,n=e.j.J,e.h=new Me,e.g=xn(e.j,n?t:null,!e.m),0<e.O&&(e.M=new oe(c(e.Y,e,e.g),e.O)),t=e.U,n=e.g,r=e.ca;var i="readystatechange";Array.isArray(i)||(i&&(ce[0]=i.toString()),i=ce);for(var a=0;a<i.length;a++){var s=G(n,i[a],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}t=e.H?b(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),xe(),function(e,t,n,r,i,a){e.info((function(){if(e.g)if(a)for(var s="",o=a.split("&"),l=0;l<o.length;l++){var c=o[l].split("=");if(1<c.length){var u=c[0];c=c[1];var h=u.split("_");s=2<=h.length&&"type"==h[1]?s+(u+"=")+c+"&":s+(u+"=redacted&")}}else s=null;else s=a;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+s}))}(e.i,e.u,e.A,e.l,e.R,e.m)}function Be(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.j.Ca)}function Ve(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?ze:(n=Number(t.substring(n,r)),isNaN(n)?Fe:(r+=1)+n>t.length?ze:(t=t.slice(r,r+n),e.C=r+n,t))}function $e(e){e.S=Date.now()+e.I,He(e,e.I)}function He(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Ae(c(e.ba,e),t)}function We(e){e.B&&(i.clearTimeout(e.B),e.B=null)}function Ge(e){0==e.j.G||e.J||bn(e.j,e)}function Ke(e){We(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,ue(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function qe(e,t){try{var n=e.j;if(0!=n.G&&(n.g==e||Ze(n.h,e)))if(!e.K&&Ze(n.h,e)&&3==n.G){try{var r=n.Da.g.parse(t)}catch(u){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;yn(n),ln(n)}mn(n),_e(18)}}else n.za=i[1],0<n.za-n.T&&37500>i[2]&&n.F&&0==n.v&&!n.C&&(n.C=Ae(c(n.Za,n),6e3));if(1>=Je(n.h)&&n.ca){try{n.ca()}catch(u){}n.ca=void 0}}else Tn(n,11)}else if((e.K||n.g==e)&&yn(n),!p(t))for(i=n.Da.g.parse(t),t=0;t<i.length;t++){let c=i[t];if(n.T=c[0],c=c[1],2==n.G)if("c"==c[0]){n.K=c[1],n.ia=c[2];const t=c[3];null!=t&&(n.la=t,n.j.info("VER="+n.la));const i=c[4];null!=i&&(n.Aa=i,n.j.info("SVER="+n.Aa));const u=c[5];null!=u&&"number"===typeof u&&0<u&&(r=1.5*u,n.L=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var a=r.h;a.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(a.j=a.l,a.g=new Set,a.h&&(et(a,a.h),a.h=null))}if(r.D){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.ya=e,Tt(r.I,r.D,e))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-e.F,n.j.info("Handshake RTT: "+n.R+"ms"));var s=e;if((r=n).qa=Sn(r,r.J?r.ia:null,r.W),s.K){tt(r.h,s);var o=s,l=r.L;l&&(o.I=l),o.B&&(We(o),$e(o)),r.g=s}else pn(r);0<n.i.length&&un(n)}else"stop"!=c[0]&&"close"!=c[0]||Tn(n,7);else 3==n.G&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?Tn(n,7):on(n):"noop"!=c[0]&&n.l&&n.l.ta(c),n.v=0)}xe()}catch(u){}}Le.prototype.ca=function(e){e=e.target;const t=this.M;t&&3==nn(e)?t.j():this.Y(e)},Le.prototype.Y=function(e){try{if(e==this.g)e:{const f=nn(this.g);var t=this.g.Ba();this.g.Z();if(!(3>f)&&(3!=f||this.g&&(this.h.h||this.g.oa()||rn(this.g)))){this.J||4!=f||7==t||xe(),We(this);var n=this.g.Z();this.X=n;t:if(Be(this)){var r=rn(this.g);e="";var a=r.length,s=4==nn(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){Ke(this),Ge(this);var o="";break t}this.h.i=new i.TextDecoder}for(t=0;t<a;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:!(s&&t==a-1)});r.length=0,this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.oa();if(this.o=200==n,function(e,t,n,r,i,a,s){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+a+" "+s}))}(this.i,this.u,this.A,this.l,this.R,f,n),this.o){if(this.T&&!this.K){t:{if(this.g){var l,c=this.g;if((l=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!p(l)){var u=l;break t}}u=null}if(!(n=u)){this.o=!1,this.s=3,_e(12),Ke(this),Ge(this);break e}Ne(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,qe(this,n)}if(this.P){let e;for(n=!0;!this.J&&this.C<o.length;){if(e=Ve(this,o),e==ze){4==f&&(this.s=4,_e(14),n=!1),Ne(this.i,this.l,null,"[Incomplete Response]");break}if(e==Fe){this.s=4,_e(15),Ne(this.i,this.l,o,"[Invalid Chunk]"),n=!1;break}Ne(this.i,this.l,e,null),qe(this,e)}if(Be(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=f||0!=o.length||this.h.h||(this.s=1,_e(16),n=!1),this.o=this.o&&n,n){if(0<o.length&&!this.W){this.W=!0;var h=this.j;h.g==this&&h.ba&&!h.M&&(h.j.info("Great, no buffering proxy detected. Bytes received: "+o.length),gn(h),h.M=!0,_e(11))}}else Ne(this.i,this.l,o,"[Invalid Chunked Response]"),Ke(this),Ge(this)}else Ne(this.i,this.l,o,null),qe(this,o);4==f&&Ke(this),this.o&&!this.J&&(4==f?bn(this.j,this):(this.o=!1,$e(this)))}else(function(e){const t={};e=(e.g&&2<=nn(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(p(e[r]))continue;var n=E(e[r]);const i=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const a=t[i]||[];t[i]=a,a.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.s=3,_e(12)):(this.s=0,_e(13)),Ke(this),Ge(this)}}}catch(f){}},Le.prototype.cancel=function(){this.J=!0,Ke(this)},Le.prototype.ba=function(){this.B=null;const e=Date.now();0<=e-this.S?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.i,this.A),2!=this.L&&(xe(),_e(17)),Ke(this),this.s=2,Ge(this)):He(this,this.S-e)};var Ye=class{constructor(e,t){this.g=e,this.map=t}};function Xe(e){this.l=e||10,i.PerformanceNavigationTiming?e=0<(e=i.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(i.chrome&&i.chrome.loadTimes&&i.chrome.loadTimes()&&i.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Qe(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Je(e){return e.h?1:e.g?e.g.size:0}function Ze(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function et(e,t){e.g?e.g.add(t):e.h=t}function tt(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function nt(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return f(e.i)}function dt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(a(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(a(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}(e),r=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(a(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length,s=0;s<i;s++)t.call(void 0,r[s],n&&n[s],e)}Xe.prototype.cancel=function(){if(this.i=nt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var mt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function gt(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof gt){this.h=e.h,yt(this,e.j),this.o=e.o,this.g=e.g,bt(this,e.s),this.l=e.l;var t=e.i,n=new Ot;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),wt(this,n),this.m=e.m}else e&&(t=String(e).match(mt))?(this.h=!1,yt(this,t[1]||"",!0),this.o=St(t[2]||""),this.g=St(t[3]||"",!0),bt(this,t[4]),this.l=St(t[5]||"",!0),wt(this,t[6]||"",!0),this.m=St(t[7]||"")):(this.h=!1,this.i=new Ot(null,this.h))}function vt(e){return new gt(e)}function yt(e,t,n){e.j=n?St(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function bt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function wt(e,t,n){t instanceof Ot?(e.i=t,function(e,t){t&&!e.j&&(Rt(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(Pt(this,t),Mt(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=xt(t,Nt)),e.i=new Ot(t,e.h))}function Tt(e,t,n){e.i.set(t,n)}function Et(e){return Tt(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function St(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function xt(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,kt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function kt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}gt.prototype.toString=function(){var e=[],t=this.j;t&&e.push(xt(t,Ct,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(xt(t,Ct,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(xt(n,"/"==n.charAt(0)?It:At,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",xt(n,Dt)),e.join("")};var _t,Ct=/[#\/\?@]/g,At=/[#\?:]/g,It=/[#\?]/g,Nt=/[#\?@]/g,Dt=/#/g;function Ot(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Rt(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var a=e[n].substring(0,r);i=e[n].substring(r+1)}else a=e[n];t(a,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function Pt(e,t){Rt(e),t=Ft(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Lt(e,t){return Rt(e),t=Ft(e,t),e.g.has(t)}function Mt(e,t,n){Pt(e,t),0<n.length&&(e.i=null,e.g.set(Ft(e,t),f(n)),e.h+=n.length)}function Ft(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function zt(e,t,n,r,i){try{i&&(i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null),r(n)}catch(a){}}function Ut(){this.g=new de}function jt(e,t,n){const r=n||"";try{dt(e,(function(e,n){let i=e;s(e)&&(i=he(e)),t.push(r+n+"="+encodeURIComponent(i))}))}catch(i){throw t.push(r+"type="+encodeURIComponent("_badmap")),i}}function Bt(e){this.l=e.Ub||null,this.j=e.eb||!1}function Vt(e,t){ne.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function $t(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function Ht(e){e.readyState=4,e.l=null,e.j=null,e.v=null,Wt(e)}function Wt(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Gt(e){let t="";return y(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function Kt(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Gt(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):Tt(e,t,n))}function qt(e){ne.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(e=Ot.prototype).add=function(e,t){Rt(this),this.i=null,e=Ft(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){Rt(this),this.g.forEach((function(n,r){n.forEach((function(n){e.call(t,n,r,this)}),this)}),this)},e.na=function(){Rt(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const i=e[r];for(let e=0;e<i.length;e++)n.push(t[r])}return n},e.V=function(e){Rt(this);let t=[];if("string"===typeof e)Lt(this,e)&&(t=t.concat(this.g.get(Ft(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},e.set=function(e,t){return Rt(this),this.i=null,Lt(this,e=Ft(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const a=encodeURIComponent(String(r)),s=this.V(r);for(r=0;r<s.length;r++){var i=a;""!==s[r]&&(i+="="+encodeURIComponent(String(s[r]))),e.push(i)}}return this.i=e.join("&")},h(Bt,pe),Bt.prototype.g=function(){return new Vt(this.l,this.j)},Bt.prototype.i=(_t={},function(){return _t}),h(Vt,ne),(e=Vt.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,Wt(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||i).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Ht(this)),this.readyState=0},e.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Wt(this)),this.g&&(this.readyState=3,Wt(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if("undefined"!==typeof i.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;$t(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},e.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Ht(this):Wt(this),3==this.readyState&&$t(this)}},e.Ra=function(e){this.g&&(this.response=this.responseText=e,Ht(this))},e.Qa=function(e){this.g&&(this.response=e,Ht(this))},e.ga=function(){this.g&&Ht(this)},e.setRequestHeader=function(e,t){this.u.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Vt.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),h(qt,ne);var Yt=/^https?$/i,Xt=["POST","PUT"];function Qt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,Jt(e),en(e)}function Jt(e){e.A||(e.A=!0,re(e,"complete"),re(e,"error"))}function Zt(e){if(e.h&&"undefined"!=typeof r&&(!e.v[1]||4!=nn(e)||2!=e.Z()))if(e.u&&4==nn(e))ae(e.Ea,0,e);else if(re(e,"readystatechange"),4==nn(e)){e.h=!1;try{const r=e.Z();e:switch(r){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var a;if(a=0===r){var s=String(e.D).match(mt)[1]||null;!s&&i.self&&i.self.location&&(s=i.self.location.protocol.slice(0,-1)),a=!Yt.test(s?s.toLowerCase():"")}n=a}if(n)re(e,"complete"),re(e,"success");else{e.m=6;try{var o=2<nn(e)?e.g.statusText:""}catch(l){o=""}e.l=o+" ["+e.Z()+"]",Jt(e)}}finally{en(e)}}}function en(e,t){if(e.g){tn(e);const r=e.g,i=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||re(e,"ready");try{r.onreadystatechange=i}catch(n){}}}function tn(e){e.I&&(i.clearTimeout(e.I),e.I=null)}function nn(e){return e.g?e.g.readyState:0}function rn(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(pt){return null}}function an(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function sn(e){this.Aa=0,this.i=[],this.j=new Ie,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=an("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=an("baseRetryDelayMs",5e3,e),this.cb=an("retryDelaySeedMs",1e4,e),this.Wa=an("forwardChannelMaxRetries",2,e),this.wa=an("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new Xe(e&&e.concurrentRequestLimit),this.Da=new Ut,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function on(e){if(cn(e),3==e.G){var t=e.U++,n=vt(e.I);if(Tt(n,"SID",e.K),Tt(n,"RID",t),Tt(n,"TYPE","terminate"),fn(e,n),(t=new Le(e,e.j,t)).L=2,t.v=Et(vt(n)),n=!1,i.navigator&&i.navigator.sendBeacon)try{n=i.navigator.sendBeacon(t.v.toString(),"")}catch(r){}!n&&i.Image&&((new Image).src=t.v,n=!0),n||(t.g=xn(t.j,null),t.g.ea(t.v)),t.F=Date.now(),$e(t)}En(e)}function ln(e){e.g&&(gn(e),e.g.cancel(),e.g=null)}function cn(e){ln(e),e.u&&(i.clearTimeout(e.u),e.u=null),yn(e),e.h.cancel(),e.s&&("number"===typeof e.s&&i.clearTimeout(e.s),e.s=null)}function un(e){if(!Qe(e.h)&&!e.s){e.s=!0;var t=e.Ga;C||N(),A||(C(),A=!0),I.add(t,e),e.B=0}}function hn(e,t){var n;n=t?t.l:e.U++;const r=vt(e.I);Tt(r,"SID",e.K),Tt(r,"RID",n),Tt(r,"AID",e.T),fn(e,r),e.m&&e.o&&Kt(r,e.m,e.o),n=new Le(e,e.j,n,e.B+1),null===e.m&&(n.H=e.o),t&&(e.i=t.D.concat(e.i)),t=dn(e,n,1e3),n.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),et(e.h,n),Ue(n,r,t)}function fn(e,t){e.H&&y(e.H,(function(e,n){Tt(t,n,e)})),e.l&&dt({},(function(e,n){Tt(t,n,e)}))}function dn(e,t,n){n=Math.min(e.i.length,n);var r=e.l?c(e.l.Na,e.l,e):null;e:{var i=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=i[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let s=!0;for(let o=0;o<n;o++){let n=i[o].g;const l=i[o].map;if(n-=t,0>n)t=Math.max(0,i[o].g-100),s=!1;else try{jt(l,e,"req"+n+"_")}catch(a){r&&r(l)}}if(s){r=e.join("&");break e}}}return e=e.i.splice(0,n),t.D=e,r}function pn(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;C||N(),A||(C(),A=!0),I.add(t,e),e.v=0}}function mn(e){return!(e.g||e.u||3<=e.v)&&(e.Y++,e.u=Ae(c(e.Fa,e),wn(e,e.v)),e.v++,!0)}function gn(e){null!=e.A&&(i.clearTimeout(e.A),e.A=null)}function vn(e){e.g=new Le(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=vt(e.qa);Tt(t,"RID","rpc"),Tt(t,"SID",e.K),Tt(t,"AID",e.T),Tt(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&Tt(t,"TO",e.ja),Tt(t,"TYPE","xmlhttp"),fn(e,t),e.m&&e.o&&Kt(t,e.m,e.o),e.L&&(e.g.I=e.L);var n=e.g;e=e.ia,n.L=1,n.v=Et(vt(t)),n.m=null,n.P=!0,je(n,e)}function yn(e){null!=e.C&&(i.clearTimeout(e.C),e.C=null)}function bn(e,t){var n=null;if(e.g==t){yn(e),gn(e),e.g=null;var r=2}else{if(!Ze(e.h,t))return;n=t.D,tt(e.h,t),r=1}if(0!=e.G)if(t.o)if(1==r){n=t.m?t.m.length:0,t=Date.now()-t.F;var i=e.B;re(r=Ee(),new Ce(r,n)),un(e)}else pn(e);else if(3==(i=t.s)||0==i&&0<t.X||!(1==r&&function(e,t){return!(Je(e.h)>=e.h.j-(e.s?1:0))&&(e.s?(e.i=t.D.concat(e.i),!0):!(1==e.G||2==e.G||e.B>=(e.Va?0:e.Wa))&&(e.s=Ae(c(e.Ga,e,t),wn(e,e.B)),e.B++,!0))}(e,t)||2==r&&mn(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),i){case 1:Tn(e,5);break;case 4:Tn(e,10);break;case 3:Tn(e,6);break;default:Tn(e,2)}}function wn(e,t){let n=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(n*=2),n*t}function Tn(e,t){if(e.j.info("Error code "+t),2==t){var n=c(e.fb,e),r=e.Xa;const t=!r;r=new gt(r||"//www.google.com/images/cleardot.gif"),i.location&&"http"==i.location.protocol||yt(r,"https"),Et(r),t?function(e,t){const n=new Ie;if(i.Image){const r=new Image;r.onload=u(zt,n,"TestLoadImage: loaded",!0,t,r),r.onerror=u(zt,n,"TestLoadImage: error",!1,t,r),r.onabort=u(zt,n,"TestLoadImage: abort",!1,t,r),r.ontimeout=u(zt,n,"TestLoadImage: timeout",!1,t,r),i.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(r.toString(),n):function(e,t){new Ie;const n=new AbortController,r=setTimeout((()=>{n.abort(),zt(0,0,!1,t)}),1e4);fetch(e,{signal:n.signal}).then((e=>{clearTimeout(r),e.ok?zt(0,0,!0,t):zt(0,0,!1,t)})).catch((()=>{clearTimeout(r),zt(0,0,!1,t)}))}(r.toString(),n)}else _e(2);e.G=0,e.l&&e.l.sa(t),En(e),cn(e)}function En(e){if(e.G=0,e.ka=[],e.l){const t=nt(e.h);0==t.length&&0==e.i.length||(d(e.ka,t),d(e.ka,e.i),e.h.i.length=0,f(e.i),e.i.length=0),e.l.ra()}}function Sn(e,t,n){var r=n instanceof gt?vt(n):new gt(n);if(""!=r.g)t&&(r.g=t+"."+r.g),bt(r,r.s);else{var a=i.location;r=a.protocol,t=t?t+"."+a.hostname:a.hostname,a=+a.port;var s=new gt(null);r&&yt(s,r),t&&(s.g=t),a&&bt(s,a),n&&(s.l=n),r=s}return n=e.D,t=e.ya,n&&t&&Tt(r,n,t),Tt(r,"VER",e.la),fn(e,r),r}function xn(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new qt(new Bt({eb:n})):new qt(e.pa)).Ha(e.J),t}function kn(){}function _n(){}function Cn(e,t){ne.call(this),this.g=new sn(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!p(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!p(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new Nn(this)}function An(e){ye.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function In(){be.call(this),this.status=1}function Nn(e){this.g=e}(e=qt.prototype).Ha=function(e){this.J=e},e.ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():De.g(),this.v=this.o?me(this.o):me(De),this.g.onreadystatechange=c(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(s){return void Qt(this,s)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var a in r)n.set(a,r[a]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find((e=>"content-type"==e.toLowerCase())),a=i.FormData&&e instanceof i.FormData,!(0<=Array.prototype.indexOf.call(Xt,t,void 0))||r||a||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,o]of n)this.g.setRequestHeader(i,o);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{tn(this),this.u=!0,this.g.send(e),this.u=!1}catch(s){Qt(this,s)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,re(this,"complete"),re(this,"abort"),en(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),en(this,!0)),qt.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?Zt(this):this.bb())},e.bb=function(){Zt(this)},e.isActive=function(){return!!this.g},e.Z=function(){try{return 2<nn(this)?this.g.status:-1}catch(_t){return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch(_t){return""}},e.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),fe(t)}},e.Ba=function(){return this.m},e.Ka=function(){return"string"===typeof this.l?this.l:String(this.l)},(e=sn.prototype).la=8,e.G=1,e.connect=function(e,t,n,r){_e(0),this.W=e,this.H=t||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.I=Sn(this,null,this.W),un(this)},e.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const i=new Le(this,this.j,e);let a=this.o;if(this.S&&(a?(a=b(a),T(a,this.S)):a=this.S),null!==this.m||this.O||(i.H=a,a=null),this.P)e:{for(var t=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=dn(this,i,t),Tt(n=vt(this.I),"RID",e),Tt(n,"CVER",22),this.D&&Tt(n,"X-HTTP-Session-Id",this.D),fn(this,n),a&&(this.O?t="headers="+encodeURIComponent(String(Gt(a)))+"&"+t:this.m&&Kt(n,this.m,a)),et(this.h,i),this.Ua&&Tt(n,"TYPE","init"),this.P?(Tt(n,"$req",t),Tt(n,"SID","null"),i.T=!0,Ue(i,n,null)):Ue(i,n,t),this.G=2}}else 3==this.G&&(e?hn(this,e):0==this.i.length||Qe(this.h)||hn(this))},e.Fa=function(){if(this.u=null,vn(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=Ae(c(this.ab,this),e)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,_e(10),ln(this),vn(this))},e.Za=function(){null!=this.C&&(this.C=null,ln(this),mn(this),_e(19))},e.fb=function(e){e?(this.j.info("Successfully pinged google.com"),_e(2)):(this.j.info("Failed to ping google.com"),_e(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=kn.prototype).ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){},_n.prototype.g=function(e,t){return new Cn(e,t)},h(Cn,ne),Cn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Cn.prototype.close=function(){on(this.g)},Cn.prototype.o=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.u&&((n={}).__data__=he(e),e=n);t.i.push(new Ye(t.Ya++,e)),3==t.G&&un(t)},Cn.prototype.N=function(){this.g.l=null,delete this.j,on(this.g),delete this.g,Cn.aa.N.call(this)},h(An,ye),h(In,be),h(Nn,kn),Nn.prototype.ua=function(){re(this.g,"a")},Nn.prototype.ta=function(e){re(this.g,new An(e))},Nn.prototype.sa=function(e){re(this.g,new In)},Nn.prototype.ra=function(){re(this.g,"b")},_n.prototype.createWebChannel=_n.prototype.g,Cn.prototype.send=Cn.prototype.o,Cn.prototype.open=Cn.prototype.m,Cn.prototype.close=Cn.prototype.close,ut=ft.createWebChannelTransport=function(){return new _n},ct=ft.getStatEventTarget=function(){return Ee()},lt=ft.Event=we,ot=ft.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Oe.NO_ERROR=0,Oe.TIMEOUT=8,Oe.HTTP_ERROR=6,st=ft.ErrorCode=Oe,Re.COMPLETE="complete",at=ft.EventType=Re,ge.EventType=ve,ve.OPEN="a",ve.CLOSE="b",ve.ERROR="c",ve.MESSAGE="d",ne.prototype.listen=ne.prototype.K,it=ft.WebChannel=ge,ft.FetchXmlHttpFactory=Bt,qt.prototype.listenOnce=qt.prototype.L,qt.prototype.getLastError=qt.prototype.Ka,qt.prototype.getLastErrorCode=qt.prototype.Ba,qt.prototype.getStatus=qt.prototype.Z,qt.prototype.getResponseJson=qt.prototype.Oa,qt.prototype.getResponseText=qt.prototype.oa,qt.prototype.send=qt.prototype.ea,qt.prototype.setWithCredentials=qt.prototype.Ha,rt=ft.XhrIo=qt}).apply("undefined"!==typeof ht?ht:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const dt="@firebase/firestore",pt="4.7.10";class mt{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}mt.UNAUTHENTICATED=new mt(null),mt.GOOGLE_CREDENTIALS=new mt("google-credentials-uid"),mt.FIRST_PARTY=new mt("first-party-uid"),mt.MOCK_USER=new mt("mock-user");let gt="11.5.0";const vt=new M("@firebase/firestore");function yt(){return vt.logLevel}function bt(e){if(vt.logLevel<=D.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Et);vt.debug(`Firestore (${gt}): ${e}`,...i)}}function wt(e){if(vt.logLevel<=D.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Et);vt.error(`Firestore (${gt}): ${e}`,...i)}}function Tt(e){if(vt.logLevel<=D.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Et);vt.warn(`Firestore (${gt}): ${e}`,...i)}}function Et(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function St(){const e=`FIRESTORE (${gt}) INTERNAL ASSERTION FAILED: `+(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state");throw wt(e),new Error(e)}function xt(e,t){e||St()}function kt(e,t){return e}const _t={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ct extends b{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class At{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class It{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Nt{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(mt.UNAUTHENTICATED)))}shutdown(){}}class Dt{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class Ot{constructor(e){this.t=e,this.currentUser=mt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){xt(void 0===this.o);let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new At;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new At,e.enqueueRetryable((()=>r(this.currentUser)))};const a=()=>{const t=i;e.enqueueRetryable((async()=>{await t.promise,await r(this.currentUser)}))},s=e=>{bt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit((e=>s(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?s(e):(bt("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new At)}}),0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(bt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(xt("string"==typeof t.accessToken),new It(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return xt(null===e||"string"==typeof e),new mt(e)}}class Rt{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=mt.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}}class Pt{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new Rt(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable((()=>t(mt.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Lt{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Mt{constructor(e,t){var n;this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null,this.V=null,null!==(n=e)&&void 0!==n&&void 0!==n.settings&&e.settings.appCheckToken&&(this.V=e.settings.appCheckToken)}start(e,t){xt(void 0===this.o);const n=e=>{null!=e.error&&bt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.R;return this.R=e.token,bt("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const r=e=>{bt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit((e=>r(e))),setTimeout((()=>{if(!this.appCheck){const e=this.A.getImmediate({optional:!0});e?r(e):bt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.V)return Promise.resolve(new Lt(this.V));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(xt("string"==typeof e.token),this.R=e.token,new Lt(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Ft(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}function zt(){return new TextEncoder}class Ut{static newId(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const n=Ft(40);for(let r=0;r<n.length;++r)t.length<20&&n[r]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62))}return t}}function jt(e,t){return e<t?-1:e>t?1:0}function Bt(e,t){let n=0;for(;n<e.length&&n<t.length;){const r=e.codePointAt(n),i=t.codePointAt(n);if(r!==i){if(r<128&&i<128)return jt(r,i);{const a=zt(),s=$t(a.encode(Vt(e,n)),a.encode(Vt(t,n)));return 0!==s?s:jt(r,i)}}n+=r>65535?2:1}return jt(e.length,t.length)}function Vt(e,t){return e.codePointAt(t)>65535?e.substring(t,t+2):e.substring(t,t+1)}function $t(e,t){for(let n=0;n<e.length&&n<t.length;++n)if(e[n]!==t[n])return jt(e[n],t[n]);return jt(e.length,t.length)}function Ht(e,t,n){return e.length===t.length&&e.every(((e,r)=>n(e,t[r])))}function Wt(e){return e+"\0"}const Gt=-62135596800,Kt=1e6;class qt{static now(){return qt.fromMillis(Date.now())}static fromDate(e){return qt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*Kt);return new qt(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ct(_t.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ct(_t.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Gt)throw new Ct(_t.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ct(_t.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Kt}_compareTo(e){return this.seconds===e.seconds?jt(this.nanoseconds,e.nanoseconds):jt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-Gt;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Yt{static fromTimestamp(e){return new Yt(e)}static min(){return new Yt(new qt(0,0))}static max(){return new Yt(new qt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Xt="__name__";class Qt{constructor(e,t,n){void 0===t?t=0:t>e.length&&St(),void 0===n?n=e.length-t:n>e.length-t&&St(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===Qt.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Qt?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=Qt.compareSegments(e.get(r),t.get(r));if(0!==n)return n}return jt(e.length,t.length)}static compareSegments(e,t){const n=Qt.isNumericId(e),r=Qt.isNumericId(t);return n&&!r?-1:!n&&r?1:n&&r?Qt.extractNumericId(e).compare(Qt.extractNumericId(t)):Bt(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ze.fromString(e.substring(4,e.length-2))}}class Jt extends Qt{construct(e,t,n){return new Jt(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n){if(i.indexOf("//")>=0)throw new Ct(_t.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);e.push(...i.split("/").filter((e=>e.length>0)))}return new Jt(e)}static emptyPath(){return new Jt([])}}const Zt=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class en extends Qt{construct(e,t,n){return new en(e,t,n)}static isValidIdentifier(e){return Zt.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),en.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===Xt}static keyField(){return new en([Xt])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new Ct(_t.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let a=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new Ct(_t.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new Ct(_t.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(a=!a,r++):"."!==t||a?(n+=t,r++):(i(),r++)}if(i(),a)throw new Ct(_t.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new en(t)}static emptyPath(){return new en([])}}class tn{constructor(e){this.path=e}static fromPath(e){return new tn(Jt.fromString(e))}static fromName(e){return new tn(Jt.fromString(e).popFirst(5))}static empty(){return new tn(Jt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Jt.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Jt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new tn(new Jt(e.slice()))}}const nn=-1;class rn{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}function an(e){return e.fields.find((e=>2===e.kind))}function sn(e){return e.fields.filter((e=>2!==e.kind))}rn.UNKNOWN_ID=-1;class on{constructor(e,t){this.fieldPath=e,this.kind=t}}class ln{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new ln(0,hn.min())}}function cn(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=Yt.fromTimestamp(1e9===r?new qt(n+1,0):new qt(n,r));return new hn(i,tn.empty(),t)}function un(e){return new hn(e.readTime,e.key,nn)}class hn{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new hn(Yt.min(),tn.empty(),nn)}static max(){return new hn(Yt.max(),tn.empty(),nn)}}function fn(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=tn.comparator(e.documentKey,t.documentKey),0!==n?n:jt(e.largestBatchId,t.largestBatchId))}const dn="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class pn{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function mn(e){if(e.code!==_t.FAILED_PRECONDITION||e.message!==dn)throw e;bt("LocalStore","Unexpectedly lost primary lease")}class gn{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&St(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new gn(((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof gn?t:gn.resolve(t)}catch(e){return gn.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):gn.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):gn.reject(t)}static resolve(e){return new gn(((t,n)=>{t(e)}))}static reject(e){return new gn(((t,n)=>{n(e)}))}static waitFor(e){return new gn(((t,n)=>{let r=0,i=0,a=!1;e.forEach((e=>{++r,e.next((()=>{++i,a&&i===r&&t()}),(e=>n(e)))})),a=!0,i===r&&t()}))}static or(e){let t=gn.resolve(!1);for(const n of e)t=t.next((e=>e?gn.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,r)=>{n.push(t.call(this,e,r))})),this.waitFor(n)}static mapArray(e,t){return new gn(((n,r)=>{const i=e.length,a=new Array(i);let s=0;for(let o=0;o<i;o++){const l=o;t(e[l]).next((e=>{a[l]=e,++s,s===i&&n(a)}),(e=>r(e)))}}))}static doWhile(e,t){return new gn(((n,r)=>{const i=()=>{!0===e()?t().next((()=>{i()}),r):n()};i()}))}}const vn="SimpleDb";class yn{static open(e,t,n,r){try{return new yn(t,e.transaction(r,n))}catch(e){throw new En(t,e)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.m=new At,this.transaction.oncomplete=()=>{this.m.resolve()},this.transaction.onabort=()=>{t.error?this.m.reject(new En(e,t.error)):this.m.resolve()},this.transaction.onerror=t=>{const n=Cn(t.target.error);this.m.reject(new En(e,n))}}get p(){return this.m.promise}abort(e){e&&this.m.reject(e),this.aborted||(bt(vn,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}S(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new xn(t)}}class bn{static delete(e){return bt(vn,"Removing database:",e),kn(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!v())return!1;if(bn.v())return!0;const e=m(),t=bn.C(e),n=0<t&&t<10,r=wn(e),i=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||i)}static v(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.__PRIVATE_env)||void 0===e?void 0:e.F)}static M(e,t){return e.store(t)}static C(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}constructor(e,t,n){this.name=e,this.version=t,this.O=n,12.2===bn.C(m())&&wt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async N(e){return this.db||(bt(vn,"Opening database:",this.name),this.db=await new Promise(((t,n)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=e=>{const n=e.target.result;t(n)},r.onblocked=()=>{n(new En(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=t=>{const r=t.target.error;"VersionError"===r.name?n(new Ct(_t.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===r.name?n(new Ct(_t.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+r)):n(new En(e,r))},r.onupgradeneeded=e=>{bt(vn,'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);const t=e.target.result;this.O.B(t,r.transaction,e.oldVersion,this.version).next((()=>{bt(vn,"Database upgrade to version "+this.version+" complete")}))}}))),this.L&&(this.db.onversionchange=e=>this.L(e)),this.db}k(e){this.L=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,r){const i="readonly"===t;let a=0;for(;;){++a;try{this.db=await this.N(e);const t=yn.open(this.db,e,i?"readonly":"readwrite",n),a=r(t).next((e=>(t.S(),e))).catch((e=>(t.abort(e),gn.reject(e)))).toPromise();return a.catch((()=>{})),await t.p,a}catch(e){const t=e,n="FirebaseError"!==t.name&&a<3;if(bt(vn,"Transaction failed with error:",t.message,"Retrying:",n),this.close(),!n)return Promise.reject(t)}}}close(){this.db&&this.db.close(),this.db=void 0}}function wn(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class Tn{constructor(e){this.q=e,this.$=!1,this.U=null}get isDone(){return this.$}get K(){return this.U}set cursor(e){this.q=e}done(){this.$=!0}W(e){this.U=e}delete(){return kn(this.q.delete())}}class En extends Ct{constructor(e,t){super(_t.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Sn(e){return"IndexedDbTransactionError"===e.name}class xn{constructor(e){this.store=e}put(e,t){let n;return void 0!==t?(bt(vn,"PUT",this.store.name,e,t),n=this.store.put(t,e)):(bt(vn,"PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),kn(n)}add(e){return bt(vn,"ADD",this.store.name,e,e),kn(this.store.add(e))}get(e){return kn(this.store.get(e)).next((t=>(void 0===t&&(t=null),bt(vn,"GET",this.store.name,e,t),t)))}delete(e){return bt(vn,"DELETE",this.store.name,e),kn(this.store.delete(e))}count(){return bt(vn,"COUNT",this.store.name),kn(this.store.count())}G(e,t){const n=this.options(e,t),r=n.index?this.store.index(n.index):this.store;if("function"==typeof r.getAll){const e=r.getAll(n.range);return new gn(((t,n)=>{e.onerror=e=>{n(e.target.error)},e.onsuccess=e=>{t(e.target.result)}}))}{const e=this.cursor(n),t=[];return this.j(e,((e,n)=>{t.push(n)})).next((()=>t))}}H(e,t){const n=this.store.getAll(e,null===t?void 0:t);return new gn(((e,t)=>{n.onerror=e=>{t(e.target.error)},n.onsuccess=t=>{e(t.target.result)}}))}J(e,t){bt(vn,"DELETE ALL",this.store.name);const n=this.options(e,t);n.Y=!1;const r=this.cursor(n);return this.j(r,((e,t,n)=>n.delete()))}Z(e,t){let n;t?n=e:(n={},t=e);const r=this.cursor(n);return this.j(r,t)}X(e){const t=this.cursor({});return new gn(((n,r)=>{t.onerror=e=>{const t=Cn(e.target.error);r(t)},t.onsuccess=t=>{const r=t.target.result;r?e(r.primaryKey,r.value).next((e=>{e?r.continue():n()})):n()}}))}j(e,t){const n=[];return new gn(((r,i)=>{e.onerror=e=>{i(e.target.error)},e.onsuccess=e=>{const i=e.target.result;if(!i)return void r();const a=new Tn(i),s=t(i.primaryKey,i.value,a);if(s instanceof gn){const e=s.catch((e=>(a.done(),gn.reject(e))));n.push(e)}a.isDone?r():null===a.K?i.continue():i.continue(a.K)}})).next((()=>gn.waitFor(n)))}options(e,t){let n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.Y?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function kn(e){return new gn(((t,n)=>{e.onsuccess=e=>{const n=e.target.result;t(n)},e.onerror=e=>{const t=Cn(e.target.error);n(t)}}))}let _n=!1;function Cn(e){const t=bn.C(m());if(t>=12.2&&t<13){const t="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(t)>=0){const e=new Ct("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return _n||(_n=!0,setTimeout((()=>{throw e}),0)),e}}return e}const An="IndexBackfiller";class In{constructor(e,t){this.asyncQueue=e,this.ee=t,this.task=null}start(){this.te(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}te(e){bt(An,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const e=await this.ee.ne();bt(An,`Documents written: ${e}`)}catch(e){Sn(e)?bt(An,"Ignoring IndexedDB error during index backfill: ",e):await mn(e)}await this.te(6e4)}))}}class Nn{constructor(e,t){this.localStore=e,this.persistence=t}async ne(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.re(t,e)))}re(e,t){const n=new Set;let r=t,i=!0;return gn.doWhile((()=>!0===i&&r>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((t=>{if(null!==t&&!n.has(t))return bt(An,`Processing collection: ${t}`),this.ie(e,t,r).next((e=>{r-=e,n.add(t)}));i=!1})))).next((()=>t-r))}ie(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((r=>this.localStore.localDocuments.getNextDocuments(e,t,r,n).next((n=>{const i=n.changes;return this.localStore.indexManager.updateIndexEntries(e,i).next((()=>this.se(r,n))).next((n=>(bt(An,`Updating offset: ${n}`),this.localStore.indexManager.updateCollectionGroup(e,t,n)))).next((()=>i.size))}))))}se(e,t){let n=e;return t.changes.forEach(((e,t)=>{const r=un(t);fn(r,n)>0&&(n=r)})),new hn(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}class Dn{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.oe(e),this._e=e=>t.writeSequenceNumber(e))}oe(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this._e&&this._e(e),e}}Dn.ae=-1;const On=-1;function Rn(e){return null==e}function Pn(e){return 0===e&&1/e==-1/0}function Ln(e){return"number"==typeof e&&Number.isInteger(e)&&!Pn(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}const Mn="\x01";function Fn(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=Un(t)),t=zn(e.get(n),t);return Un(t)}function zn(e,t){let n=t;const r=e.length;for(let i=0;i<r;i++){const t=e.charAt(i);switch(t){case"\0":n+="\x01\x10";break;case Mn:n+="\x01\x11";break;default:n+=t}}return n}function Un(e){return e+Mn+"\x01"}function jn(e){const t=e.length;if(xt(t>=2),2===t)return xt(e.charAt(0)===Mn&&"\x01"===e.charAt(1)),Jt.emptyPath();const n=t-2,r=[];let i="";for(let a=0;a<t;){const t=e.indexOf(Mn,a);switch((t<0||t>n)&&St(),e.charAt(t+1)){case"\x01":const n=e.substring(a,t);let s;0===i.length?s=n:(i+=n,s=i,i=""),r.push(s);break;case"\x10":i+=e.substring(a,t),i+="\0";break;case"\x11":i+=e.substring(a,t+1);break;default:St()}a=t+2}return new Jt(r)}const Bn="remoteDocuments",Vn="owner",$n="owner",Hn="mutationQueues",Wn="mutations",Gn="batchId",Kn="userMutationsIndex",qn=["userId","batchId"];function Yn(e,t){return[e,Fn(t)]}function Xn(e,t,n){return[e,Fn(t),n]}const Qn={},Jn="documentMutations",Zn="remoteDocumentsV14",er=["prefixPath","collectionGroup","readTime","documentId"],tr="documentKeyIndex",nr=["prefixPath","collectionGroup","documentId"],rr="collectionGroupIndex",ir=["collectionGroup","readTime","prefixPath","documentId"],ar="remoteDocumentGlobal",sr="remoteDocumentGlobalKey",or="targets",lr="queryTargetsIndex",cr=["canonicalId","targetId"],ur="targetDocuments",hr=["targetId","path"],fr="documentTargetsIndex",dr=["path","targetId"],pr="targetGlobalKey",mr="targetGlobal",gr="collectionParents",vr=["collectionId","parent"],yr="clientMetadata",br="bundles",wr="namedQueries",Tr="indexConfiguration",Er="collectionGroupIndex",Sr="indexState",xr=["indexId","uid"],kr="sequenceNumberIndex",_r=["uid","sequenceNumber"],Cr="indexEntries",Ar=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Ir="documentKeyIndex",Nr=["indexId","uid","orderedDocumentKey"],Dr="documentOverlays",Or=["userId","collectionPath","documentId"],Rr="collectionPathOverlayIndex",Pr=["userId","collectionPath","largestBatchId"],Lr="collectionGroupOverlayIndex",Mr=["userId","collectionGroup","largestBatchId"],Fr="globals",zr=[Hn,Wn,Jn,Bn,or,Vn,mr,ur,yr,ar,gr,br,wr],Ur=[...zr,Dr],jr=[Hn,Wn,Jn,Zn,or,Vn,mr,ur,yr,ar,gr,br,wr,Dr],Br=jr,Vr=[...Br,Tr,Sr,Cr],$r=Vr,Hr=[...Vr,Fr];class Wr extends pn{constructor(e,t){super(),this.ue=e,this.currentSequenceNumber=t}}function Gr(e,t){const n=kt(e);return bn.M(n.ue,t)}function Kr(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function qr(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Yr(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class Xr{constructor(e,t){this.comparator=e,this.root=t||Jr.EMPTY}insert(e,t){return new Xr(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Jr.BLACK,null,null))}remove(e){return new Xr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Jr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Qr(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Qr(this.root,e,this.comparator,!1)}getReverseIterator(){return new Qr(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Qr(this.root,e,this.comparator,!0)}}class Qr{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Jr{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:Jr.RED,this.left=null!=r?r:Jr.EMPTY,this.right=null!=i?i:Jr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new Jr(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Jr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return Jr.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Jr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Jr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw St();if(this.right.isRed())throw St();const e=this.left.check();if(e!==this.right.check())throw St();return e+(this.isRed()?0:1)}}Jr.EMPTY=null,Jr.RED=!0,Jr.BLACK=!1,Jr.EMPTY=new class{constructor(){this.size=0}get key(){throw St()}get value(){throw St()}get color(){throw St()}get left(){throw St()}get right(){throw St()}copy(e,t,n,r,i){return this}insert(e,t,n){return new Jr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Zr{constructor(e){this.comparator=e,this.data=new Xr(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new ei(this.data.getIterator())}getIteratorFrom(e){return new ei(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof Zr))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Zr(this.comparator);return t.data=e,t}}class ei{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function ti(e){return e.hasNext()?e.getNext():void 0}class ni{constructor(e){this.fields=e,e.sort(en.comparator)}static empty(){return new ni([])}unionWith(e){let t=new Zr(en.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new ni(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ht(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class ri extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class ii{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new ri("Invalid base64 string: "+e):e}}(e);return new ii(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new ii(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return jt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ii.EMPTY_BYTE_STRING=new ii("");const ai=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function si(e){if(xt(!!e),"string"==typeof e){let t=0;const n=ai.exec(e);if(xt(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:oi(e.seconds),nanos:oi(e.nanos)}}function oi(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function li(e){return"string"==typeof e?ii.fromBase64String(e):ii.fromUint8Array(e)}const ci="server_timestamp",ui="__type__",hi="__previous_value__",fi="__local_write_time__";function di(e){var t,n;return(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{})[ui])||void 0===n?void 0:n.stringValue)===ci}function pi(e){const t=e.mapValue.fields[hi];return di(t)?pi(t):t}function mi(e){const t=si(e.mapValue.fields[fi].timestampValue);return new qt(t.seconds,t.nanos)}class gi{constructor(e,t,n,r,i,a,s,o,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=s,this.longPollingOptions=o,this.useFetchStreams=l}}const vi="(default)";class yi{constructor(e,t){this.projectId=e,this.database=t||vi}static empty(){return new yi("","")}get isDefaultDatabase(){return this.database===vi}isEqual(e){return e instanceof yi&&e.projectId===this.projectId&&e.database===this.database}}const bi="__type__",wi="__max__",Ti={mapValue:{fields:{__type__:{stringValue:wi}}}},Ei="__vector__",Si="value",xi={nullValue:"NULL_VALUE"};function ki(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?di(e)?4:Vi(e)?9007199254740991:ji(e)?10:11:St()}function _i(e,t){if(e===t)return!0;const n=ki(e);if(n!==ki(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return mi(e).isEqual(mi(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=si(e.timestampValue),r=si(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return li(e.bytesValue).isEqual(li(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return oi(e.geoPointValue.latitude)===oi(t.geoPointValue.latitude)&&oi(e.geoPointValue.longitude)===oi(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return oi(e.integerValue)===oi(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=oi(e.doubleValue),r=oi(t.doubleValue);return n===r?Pn(n)===Pn(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return Ht(e.arrayValue.values||[],t.arrayValue.values||[],_i);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(Kr(n)!==Kr(r))return!1;for(const i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!_i(n[i],r[i])))return!1;return!0}(e,t);default:return St()}}function Ci(e,t){return void 0!==(e.values||[]).find((e=>_i(e,t)))}function Ai(e,t){if(e===t)return 0;const n=ki(e),r=ki(t);if(n!==r)return jt(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return jt(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=oi(e.integerValue||e.doubleValue),r=oi(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return Ii(e.timestampValue,t.timestampValue);case 4:return Ii(mi(e),mi(t));case 5:return Bt(e.stringValue,t.stringValue);case 6:return function(e,t){const n=li(e),r=li(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let i=0;i<n.length&&i<r.length;i++){const e=jt(n[i],r[i]);if(0!==e)return e}return jt(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=jt(oi(e.latitude),oi(t.latitude));return 0!==n?n:jt(oi(e.longitude),oi(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return Ni(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n,r,i,a;const s=e.fields||{},o=t.fields||{},l=null===(n=s[Si])||void 0===n?void 0:n.arrayValue,c=null===(r=o[Si])||void 0===r?void 0:r.arrayValue,u=jt((null===(i=null==l?void 0:l.values)||void 0===i?void 0:i.length)||0,(null===(a=null==c?void 0:c.values)||void 0===a?void 0:a.length)||0);return 0!==u?u:Ni(l,c)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===Ti.mapValue&&t===Ti.mapValue)return 0;if(e===Ti.mapValue)return 1;if(t===Ti.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},a=Object.keys(i);r.sort(),a.sort();for(let s=0;s<r.length&&s<a.length;++s){const e=Bt(r[s],a[s]);if(0!==e)return e;const t=Ai(n[r[s]],i[a[s]]);if(0!==t)return t}return jt(r.length,a.length)}(e.mapValue,t.mapValue);default:throw St()}}function Ii(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return jt(e,t);const n=si(e),r=si(t),i=jt(n.seconds,r.seconds);return 0!==i?i:jt(n.nanos,r.nanos)}function Ni(e,t){const n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){const e=Ai(n[i],r[i]);if(e)return e}return jt(n.length,r.length)}function Di(e){return Oi(e)}function Oi(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=si(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return li(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return tn.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=Oi(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+=`${i}:${Oi(e.fields[i])}`;return n+"}"}(e.mapValue):St()}function Ri(e){switch(ki(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=pi(e);return t?16+Ri(t):16;case 5:return 2*e.stringValue.length;case 6:return li(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(e){return(e.values||[]).reduce(((e,t)=>e+Ri(t)),0)}(e.arrayValue);case 10:case 11:return function(e){let t=0;return qr(e.fields,((e,n)=>{t+=e.length+Ri(n)})),t}(e.mapValue);default:throw St()}}function Pi(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function Li(e){return!!e&&"integerValue"in e}function Mi(e){return!!e&&"arrayValue"in e}function Fi(e){return!!e&&"nullValue"in e}function zi(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Ui(e){return!!e&&"mapValue"in e}function ji(e){var t,n;return(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{})[bi])||void 0===n?void 0:n.stringValue)===Ei}function Bi(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return qr(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=Bi(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Bi(e.arrayValue.values[n]);return t}return Object.assign({},e)}function Vi(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===wi}const $i={mapValue:{fields:{[bi]:{stringValue:Ei},[Si]:{arrayValue:{}}}}};function Hi(e){return"nullValue"in e?xi:"booleanValue"in e?{booleanValue:!1}:"integerValue"in e||"doubleValue"in e?{doubleValue:NaN}:"timestampValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in e?{stringValue:""}:"bytesValue"in e?{bytesValue:""}:"referenceValue"in e?Pi(yi.empty(),tn.empty()):"geoPointValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in e?{arrayValue:{}}:"mapValue"in e?ji(e)?$i:{mapValue:{}}:St()}function Wi(e){return"nullValue"in e?{booleanValue:!1}:"booleanValue"in e?{doubleValue:NaN}:"integerValue"in e||"doubleValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in e?{stringValue:""}:"stringValue"in e?{bytesValue:""}:"bytesValue"in e?Pi(yi.empty(),tn.empty()):"referenceValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in e?{arrayValue:{}}:"arrayValue"in e?$i:"mapValue"in e?ji(e)?{mapValue:{}}:Ti:St()}function Gi(e,t){const n=Ai(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function Ki(e,t){const n=Ai(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}class qi{constructor(e){this.value=e}static empty(){return new qi({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Ui(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Bi(t)}setAll(e){let t=en.emptyPath(),n={},r=[];e.forEach(((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=Bi(e):r.push(i.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());Ui(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return _i(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];Ui(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){qr(t,((t,n)=>e[t]=n));for(const r of n)delete e[r]}clone(){return new qi(Bi(this.value))}}function Yi(e){const t=[];return qr(e.fields,((e,n)=>{const r=new en([e]);if(Ui(n)){const e=Yi(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)})),new ni(t)}class Xi{constructor(e,t,n,r,i,a,s){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=a,this.documentState=s}static newInvalidDocument(e){return new Xi(e,0,Yt.min(),Yt.min(),Yt.min(),qi.empty(),0)}static newFoundDocument(e,t,n,r){return new Xi(e,1,t,Yt.min(),n,r,0)}static newNoDocument(e,t){return new Xi(e,2,t,Yt.min(),Yt.min(),qi.empty(),0)}static newUnknownDocument(e,t){return new Xi(e,3,t,Yt.min(),Yt.min(),qi.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Yt.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=qi.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=qi.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Yt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Xi&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Xi(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Qi{constructor(e,t){this.position=e,this.inclusive=t}}function Ji(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const a=t[i],s=e.position[i];if(r=a.field.isKeyField()?tn.comparator(tn.fromName(s.referenceValue),n.key):Ai(s,n.data.field(a.field)),"desc"===a.dir&&(r*=-1),0!==r)break}return r}function Zi(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!_i(e.position[n],t.position[n]))return!1;return!0}class ea{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function ta(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class na{}class ra extends na{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new da(e,t,n):"array-contains"===t?new va(e,n):"in"===t?new ya(e,n):"not-in"===t?new ba(e,n):"array-contains-any"===t?new wa(e,n):new ra(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new pa(e,n):new ma(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(Ai(t,this.value)):null!==t&&ki(this.value)===ki(t)&&this.matchesComparison(Ai(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return St()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ia extends na{constructor(e,t){super(),this.filters=e,this.op=t,this.ce=null}static create(e,t){return new ia(e,t)}matches(e){return aa(this)?void 0===this.filters.find((t=>!t.matches(e))):void 0!==this.filters.find((t=>t.matches(e)))}getFlattenedFilters(){return null!==this.ce||(this.ce=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.ce}getFilters(){return Object.assign([],this.filters)}}function aa(e){return"and"===e.op}function sa(e){return"or"===e.op}function oa(e){return la(e)&&aa(e)}function la(e){for(const t of e.filters)if(t instanceof ia)return!1;return!0}function ca(e){if(e instanceof ra)return e.field.canonicalString()+e.op.toString()+Di(e.value);if(oa(e))return e.filters.map((e=>ca(e))).join(",");{const t=e.filters.map((e=>ca(e))).join(",");return`${e.op}(${t})`}}function ua(e,t){return e instanceof ra?function(e,t){return t instanceof ra&&e.op===t.op&&e.field.isEqual(t.field)&&_i(e.value,t.value)}(e,t):e instanceof ia?function(e,t){return t instanceof ia&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce(((e,n,r)=>e&&ua(n,t.filters[r])),!0)}(e,t):void St()}function ha(e,t){const n=e.filters.concat(t);return ia.create(n,e.op)}function fa(e){return e instanceof ra?function(e){return`${e.field.canonicalString()} ${e.op} ${Di(e.value)}`}(e):e instanceof ia?function(e){return e.op.toString()+" {"+e.getFilters().map(fa).join(" ,")+"}"}(e):"Filter"}class da extends ra{constructor(e,t,n){super(e,t,n),this.key=tn.fromName(n.referenceValue)}matches(e){const t=tn.comparator(e.key,this.key);return this.matchesComparison(t)}}class pa extends ra{constructor(e,t){super(e,"in",t),this.keys=ga("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class ma extends ra{constructor(e,t){super(e,"not-in",t),this.keys=ga("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function ga(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>tn.fromName(e.referenceValue)))}class va extends ra{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Mi(t)&&Ci(t.arrayValue,this.value)}}class ya extends ra{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Ci(this.value.arrayValue,t)}}class ba extends ra{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ci(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Ci(this.value.arrayValue,t)}}class wa extends ra{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Mi(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>Ci(this.value.arrayValue,e)))}}class Ta{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=a,this.endAt=s,this.le=null}}function Ea(e){return new Ta(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function Sa(e){const t=kt(e);if(null===t.le){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>ca(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),Rn(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>Di(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>Di(e))).join(",")),t.le=e}return t.le}function xa(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!ta(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!ua(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Zi(e.startAt,t.startAt)&&Zi(e.endAt,t.endAt)}function ka(e){return tn.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function _a(e,t){return e.filters.filter((e=>e instanceof ra&&e.field.isEqual(t)))}function Ca(e,t,n){let r=xi,i=!0;for(const a of _a(e,t)){let e=xi,t=!0;switch(a.op){case"<":case"<=":e=Hi(a.value);break;case"==":case"in":case">=":e=a.value;break;case">":e=a.value,t=!1;break;case"!=":case"not-in":e=xi}Gi({value:r,inclusive:i},{value:e,inclusive:t})<0&&(r=e,i=t)}if(null!==n)for(let a=0;a<e.orderBy.length;++a)if(e.orderBy[a].field.isEqual(t)){const e=n.position[a];Gi({value:r,inclusive:i},{value:e,inclusive:n.inclusive})<0&&(r=e,i=n.inclusive);break}return{value:r,inclusive:i}}function Aa(e,t,n){let r=Ti,i=!0;for(const a of _a(e,t)){let e=Ti,t=!0;switch(a.op){case">=":case">":e=Wi(a.value),t=!1;break;case"==":case"in":case"<=":e=a.value;break;case"<":e=a.value,t=!1;break;case"!=":case"not-in":e=Ti}Ki({value:r,inclusive:i},{value:e,inclusive:t})>0&&(r=e,i=t)}if(null!==n)for(let a=0;a<e.orderBy.length;++a)if(e.orderBy[a].field.isEqual(t)){const e=n.position[a];Ki({value:r,inclusive:i},{value:e,inclusive:n.inclusive})>0&&(r=e,i=n.inclusive);break}return{value:r,inclusive:i}}class Ia{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=a,this.startAt=s,this.endAt=o,this.he=null,this.Pe=null,this.Te=null,this.startAt,this.endAt}}function Na(e,t,n,r,i,a,s,o){return new Ia(e,t,n,r,i,a,s,o)}function Da(e){return new Ia(e)}function Oa(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Ra(e){return null!==e.collectionGroup}function Pa(e){const t=kt(e);if(null===t.he){t.he=[];const e=new Set;for(const i of t.explicitOrderBy)t.he.push(i),e.add(i.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new Zr(en.comparator);return e.filters.forEach((e=>{e.getFlattenedFilters().forEach((e=>{e.isInequality()&&(t=t.add(e.field))}))})),t}(t);r.forEach((r=>{e.has(r.canonicalString())||r.isKeyField()||t.he.push(new ea(r,n))})),e.has(en.keyField().canonicalString())||t.he.push(new ea(en.keyField(),n))}return t.he}function La(e){const t=kt(e);return t.Pe||(t.Pe=Ma(t,Pa(e))),t.Pe}function Ma(e,t){if("F"===e.limitType)return Ea(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map((e=>{const t="desc"===e.dir?"asc":"desc";return new ea(e.field,t)}));const n=e.endAt?new Qi(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new Qi(e.startAt.position,e.startAt.inclusive):null;return Ea(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function Fa(e,t,n){return new Ia(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function za(e,t){return xa(La(e),La(t))&&e.limitType===t.limitType}function Ua(e){return`${Sa(La(e))}|lt:${e.limitType}`}function ja(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>fa(e))).join(", ")}]`),Rn(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e))).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>Di(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>Di(e))).join(",")),`Target(${t})`}(La(e))}; limitType=${e.limitType})`}function Ba(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):tn.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of Pa(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=Ji(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,Pa(e),t))&&!(e.endAt&&!function(e,t,n){const r=Ji(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,Pa(e),t))}(e,t)}function Va(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function $a(e){return(t,n)=>{let r=!1;for(const i of Pa(e)){const e=Ha(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function Ha(e,t,n){const r=e.field.isKeyField()?tn.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?Ai(r,i):St()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return St()}}class Wa{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,i]of n)if(this.equalsFn(r,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){qr(this.inner,((t,n)=>{for(const[r,i]of n)e(r,i)}))}isEmpty(){return Yr(this.inner)}size(){return this.innerSize}}const Ga=new Xr(tn.comparator);function Ka(){return Ga}const qa=new Xr(tn.comparator);function Ya(){let e=qa;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.insert(i.key,i);return e}function Xa(e){let t=qa;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function Qa(){return Za()}function Ja(){return Za()}function Za(){return new Wa((e=>e.toString()),((e,t)=>e.isEqual(t)))}const es=new Xr(tn.comparator),ts=new Zr(tn.comparator);function ns(){let e=ts;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.add(i);return e}const rs=new Zr(jt);function is(){return rs}function as(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Pn(t)?"-0":t}}function ss(e){return{integerValue:""+e}}function os(e,t){return Ln(t)?ss(t):as(e,t)}class ls{constructor(){this._=void 0}}function cs(e,t,n){return e instanceof fs?function(e,t){const n={fields:{[ui]:{stringValue:ci},[fi]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&di(t)&&(t=pi(t)),t&&(n.fields[hi]=t),{mapValue:n}}(n,t):e instanceof ds?ps(e,t):e instanceof ms?gs(e,t):function(e,t){const n=hs(e,t),r=ys(n)+ys(e.Ie);return Li(n)&&Li(e.Ie)?ss(r):as(e.serializer,r)}(e,t)}function us(e,t,n){return e instanceof ds?ps(e,t):e instanceof ms?gs(e,t):n}function hs(e,t){return e instanceof vs?function(e){return Li(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class fs extends ls{}class ds extends ls{constructor(e){super(),this.elements=e}}function ps(e,t){const n=bs(t);for(const r of e.elements)n.some((e=>_i(e,r)))||n.push(r);return{arrayValue:{values:n}}}class ms extends ls{constructor(e){super(),this.elements=e}}function gs(e,t){let n=bs(t);for(const r of e.elements)n=n.filter((e=>!_i(e,r)));return{arrayValue:{values:n}}}class vs extends ls{constructor(e,t){super(),this.serializer=e,this.Ie=t}}function ys(e){return oi(e.integerValue||e.doubleValue)}function bs(e){return Mi(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class ws{constructor(e,t){this.field=e,this.transform=t}}class Ts{constructor(e,t){this.version=e,this.transformResults=t}}class Es{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Es}static exists(e){return new Es(void 0,e)}static updateTime(e){return new Es(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ss(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class xs{}function ks(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Ls(e.key,Es.none()):new Ns(e.key,e.data,Es.none());{const n=e.data,r=qi.empty();let i=new Zr(en.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new Ds(e.key,r,new ni(i.toArray()),Es.none())}}function _s(e,t,n){e instanceof Ns?function(e,t,n){const r=e.value.clone(),i=Rs(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof Ds?function(e,t,n){if(!Ss(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=Rs(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(Os(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function Cs(e,t,n,r){return e instanceof Ns?function(e,t,n,r){if(!Ss(e.precondition,t))return n;const i=e.value.clone(),a=Ps(e.fieldTransforms,r,t);return i.setAll(a),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof Ds?function(e,t,n,r){if(!Ss(e.precondition,t))return n;const i=Ps(e.fieldTransforms,r,t),a=t.data;return a.setAll(Os(e)),a.setAll(i),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,r):function(e,t,n){return Ss(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function As(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=hs(r.transform,e||null);null!=i&&(null===n&&(n=qi.empty()),n.set(r.field,i))}return n||null}function Is(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&Ht(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof ds&&t instanceof ds||e instanceof ms&&t instanceof ms?Ht(e.elements,t.elements,_i):e instanceof vs&&t instanceof vs?_i(e.Ie,t.Ie):e instanceof fs&&t instanceof fs}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Ns extends xs{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Ds extends xs{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Os(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}})),t}function Rs(e,t,n){const r=new Map;xt(e.length===n.length);for(let i=0;i<n.length;i++){const a=e[i],s=a.transform,o=t.data.field(a.field);r.set(a.field,us(s,o,n[i]))}return r}function Ps(e,t,n){const r=new Map;for(const i of e){const e=i.transform,a=n.data.field(i.field);r.set(i.field,cs(e,a,t))}return r}class Ls extends xs{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Ms extends xs{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Fs{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&_s(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Cs(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Cs(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Ja();return this.mutations.forEach((r=>{const i=e.get(r.key),a=i.overlayedDocument;let s=this.applyToLocalView(a,i.mutatedFields);s=t.has(r.key)?null:s;const o=ks(a,s);null!==o&&n.set(r.key,o),a.isValidDocument()||a.convertToNoDocument(Yt.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),ns())}isEqual(e){return this.batchId===e.batchId&&Ht(this.mutations,e.mutations,((e,t)=>Is(e,t)))&&Ht(this.baseMutations,e.baseMutations,((e,t)=>Is(e,t)))}}class zs{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){xt(e.mutations.length===n.length);let r=es;const i=e.mutations;for(let a=0;a<i.length;a++)r=r.insert(i[a].key,n[a].version);return new zs(e,t,n,r)}}class Us{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class js{constructor(e,t){this.count=e,this.unchangedNames=t}}var Bs,Vs;function $s(e){switch(e){case _t.OK:return St();case _t.CANCELLED:case _t.UNKNOWN:case _t.DEADLINE_EXCEEDED:case _t.RESOURCE_EXHAUSTED:case _t.INTERNAL:case _t.UNAVAILABLE:case _t.UNAUTHENTICATED:return!1;case _t.INVALID_ARGUMENT:case _t.NOT_FOUND:case _t.ALREADY_EXISTS:case _t.PERMISSION_DENIED:case _t.FAILED_PRECONDITION:case _t.ABORTED:case _t.OUT_OF_RANGE:case _t.UNIMPLEMENTED:case _t.DATA_LOSS:return!0;default:return St()}}function Hs(e){if(void 0===e)return wt("GRPC error has no .code"),_t.UNKNOWN;switch(e){case Bs.OK:return _t.OK;case Bs.CANCELLED:return _t.CANCELLED;case Bs.UNKNOWN:return _t.UNKNOWN;case Bs.DEADLINE_EXCEEDED:return _t.DEADLINE_EXCEEDED;case Bs.RESOURCE_EXHAUSTED:return _t.RESOURCE_EXHAUSTED;case Bs.INTERNAL:return _t.INTERNAL;case Bs.UNAVAILABLE:return _t.UNAVAILABLE;case Bs.UNAUTHENTICATED:return _t.UNAUTHENTICATED;case Bs.INVALID_ARGUMENT:return _t.INVALID_ARGUMENT;case Bs.NOT_FOUND:return _t.NOT_FOUND;case Bs.ALREADY_EXISTS:return _t.ALREADY_EXISTS;case Bs.PERMISSION_DENIED:return _t.PERMISSION_DENIED;case Bs.FAILED_PRECONDITION:return _t.FAILED_PRECONDITION;case Bs.ABORTED:return _t.ABORTED;case Bs.OUT_OF_RANGE:return _t.OUT_OF_RANGE;case Bs.UNIMPLEMENTED:return _t.UNIMPLEMENTED;case Bs.DATA_LOSS:return _t.DATA_LOSS;default:return St()}}(Vs=Bs||(Bs={}))[Vs.OK=0]="OK",Vs[Vs.CANCELLED=1]="CANCELLED",Vs[Vs.UNKNOWN=2]="UNKNOWN",Vs[Vs.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Vs[Vs.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Vs[Vs.NOT_FOUND=5]="NOT_FOUND",Vs[Vs.ALREADY_EXISTS=6]="ALREADY_EXISTS",Vs[Vs.PERMISSION_DENIED=7]="PERMISSION_DENIED",Vs[Vs.UNAUTHENTICATED=16]="UNAUTHENTICATED",Vs[Vs.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Vs[Vs.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Vs[Vs.ABORTED=10]="ABORTED",Vs[Vs.OUT_OF_RANGE=11]="OUT_OF_RANGE",Vs[Vs.UNIMPLEMENTED=12]="UNIMPLEMENTED",Vs[Vs.INTERNAL=13]="INTERNAL",Vs[Vs.UNAVAILABLE=14]="UNAVAILABLE",Vs[Vs.DATA_LOSS=15]="DATA_LOSS";let Ws=null;const Gs=new Ze([4294967295,4294967295],0);function Ks(e){const t=zt().encode(e),n=new et;return n.update(t),new Uint8Array(n.digest())}function qs(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),a=t.getUint32(12,!0);return[new Ze([n,r],0),new Ze([i,a],0)]}class Ys{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Xs(`Invalid padding: ${t}`);if(n<0)throw new Xs(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new Xs(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new Xs(`Invalid padding when bitmap length is 0: ${t}`);this.Ee=8*e.length-t,this.de=Ze.fromNumber(this.Ee)}Ae(e,t,n){let r=e.add(t.multiply(Ze.fromNumber(n)));return 1===r.compare(Gs)&&(r=new Ze([r.getBits(0),r.getBits(1)],0)),r.modulo(this.de).toNumber()}Re(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Ee)return!1;const t=Ks(e),[n,r]=qs(t);for(let i=0;i<this.hashCount;i++){const e=this.Ae(n,r,i);if(!this.Re(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new Ys(i,r,t);return n.forEach((e=>a.insert(e))),a}insert(e){if(0===this.Ee)return;const t=Ks(e),[n,r]=qs(t);for(let i=0;i<this.hashCount;i++){const e=this.Ae(n,r,i);this.Ve(e)}}Ve(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Xs extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Qs{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,Js.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Qs(Yt.min(),r,new Xr(jt),Ka(),ns())}}class Js{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Js(n,t,ns(),ns(),ns())}}class Zs{constructor(e,t,n,r){this.me=e,this.removedTargetIds=t,this.key=n,this.fe=r}}class eo{constructor(e,t){this.targetId=e,this.ge=t}}class to{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ii.EMPTY_BYTE_STRING,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class no{constructor(){this.pe=0,this.ye=ao(),this.we=ii.EMPTY_BYTE_STRING,this.Se=!1,this.be=!0}get current(){return this.Se}get resumeToken(){return this.we}get De(){return 0!==this.pe}get ve(){return this.be}Ce(e){e.approximateByteSize()>0&&(this.be=!0,this.we=e)}Fe(){let e=ns(),t=ns(),n=ns();return this.ye.forEach(((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:St()}})),new Js(this.we,this.Se,e,t,n)}Me(){this.be=!1,this.ye=ao()}xe(e,t){this.be=!0,this.ye=this.ye.insert(e,t)}Oe(e){this.be=!0,this.ye=this.ye.remove(e)}Ne(){this.pe+=1}Be(){this.pe-=1,xt(this.pe>=0)}Le(){this.be=!0,this.Se=!0}}class ro{constructor(e){this.ke=e,this.qe=new Map,this.Qe=Ka(),this.$e=io(),this.Ue=io(),this.Ke=new Xr(jt)}We(e){for(const t of e.me)e.fe&&e.fe.isFoundDocument()?this.Ge(t,e.fe):this.ze(t,e.key,e.fe);for(const t of e.removedTargetIds)this.ze(t,e.key,e.fe)}je(e){this.forEachTarget(e,(t=>{const n=this.He(t);switch(e.state){case 0:this.Je(t)&&n.Ce(e.resumeToken);break;case 1:n.Be(),n.De||n.Me(),n.Ce(e.resumeToken);break;case 2:n.Be(),n.De||this.removeTarget(t);break;case 3:this.Je(t)&&(n.Le(),n.Ce(e.resumeToken));break;case 4:this.Je(t)&&(this.Ye(t),n.Ce(e.resumeToken));break;default:St()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.qe.forEach(((e,n)=>{this.Je(n)&&t(n)}))}Ze(e){const t=e.targetId,n=e.ge.count,r=this.Xe(t);if(r){const i=r.target;if(ka(i))if(0===n){const e=new tn(i.path);this.ze(t,e,Xi.newNoDocument(e,Yt.min()))}else xt(1===n);else{const r=this.et(t);if(r!==n){const n=this.tt(e),i=n?this.nt(n,e,r):1;if(0!==i){this.Ye(t);const e=2===i?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(t,e)}null==Ws||Ws.rt(function(e,t,n,r,i){var a,s,o,l,c,u;const h={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},f=t.unchangedNames;return f&&(h.bloomFilter={applied:0===i,hashCount:null!==(a=null==f?void 0:f.hashCount)&&void 0!==a?a:0,bitmapLength:null!==(l=null===(o=null===(s=null==f?void 0:f.bits)||void 0===s?void 0:s.bitmap)||void 0===o?void 0:o.length)&&void 0!==l?l:0,padding:null!==(u=null===(c=null==f?void 0:f.bits)||void 0===c?void 0:c.padding)&&void 0!==u?u:0,mightContain:e=>{var t;return null!==(t=null==r?void 0:r.mightContain(e))&&void 0!==t&&t}}),h}(r,e.ge,this.ke.it(),n,i))}}}}tt(e){const t=e.ge.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:i=0}=t;let a,s;try{a=li(n).toUint8Array()}catch(e){if(e instanceof ri)return Tt("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{s=new Ys(a,r,i)}catch(e){return Tt(e instanceof Xs?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===s.Ee?null:s}nt(e,t,n){return t.ge.count===n-this.st(e,t.targetId)?0:2}st(e,t){const n=this.ke.getRemoteKeysForTarget(t);let r=0;return n.forEach((n=>{const i=this.ke.it(),a=`projects/${i.projectId}/databases/${i.database}/documents/${n.path.canonicalString()}`;e.mightContain(a)||(this.ze(t,n,null),r++)})),r}ot(e){const t=new Map;this.qe.forEach(((n,r)=>{const i=this.Xe(r);if(i){if(n.current&&ka(i.target)){const t=new tn(i.target.path);this._t(t).has(r)||this.ut(r,t)||this.ze(r,t,Xi.newNoDocument(t,e))}n.ve&&(t.set(r,n.Fe()),n.Me())}}));let n=ns();this.Ue.forEach(((e,t)=>{let r=!0;t.forEachWhile((e=>{const t=this.Xe(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)})),r&&(n=n.add(e))})),this.Qe.forEach(((t,n)=>n.setReadTime(e)));const r=new Qs(e,t,this.Ke,this.Qe,n);return this.Qe=Ka(),this.$e=io(),this.Ue=io(),this.Ke=new Xr(jt),r}Ge(e,t){if(!this.Je(e))return;const n=this.ut(e,t.key)?2:0;this.He(e).xe(t.key,n),this.Qe=this.Qe.insert(t.key,t),this.$e=this.$e.insert(t.key,this._t(t.key).add(e)),this.Ue=this.Ue.insert(t.key,this.ct(t.key).add(e))}ze(e,t,n){if(!this.Je(e))return;const r=this.He(e);this.ut(e,t)?r.xe(t,1):r.Oe(t),this.Ue=this.Ue.insert(t,this.ct(t).delete(e)),this.Ue=this.Ue.insert(t,this.ct(t).add(e)),n&&(this.Qe=this.Qe.insert(t,n))}removeTarget(e){this.qe.delete(e)}et(e){const t=this.He(e).Fe();return this.ke.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ne(e){this.He(e).Ne()}He(e){let t=this.qe.get(e);return t||(t=new no,this.qe.set(e,t)),t}ct(e){let t=this.Ue.get(e);return t||(t=new Zr(jt),this.Ue=this.Ue.insert(e,t)),t}_t(e){let t=this.$e.get(e);return t||(t=new Zr(jt),this.$e=this.$e.insert(e,t)),t}Je(e){const t=null!==this.Xe(e);return t||bt("WatchChangeAggregator","Detected inactive target",e),t}Xe(e){const t=this.qe.get(e);return t&&t.De?null:this.ke.lt(e)}Ye(e){this.qe.set(e,new no),this.ke.getRemoteKeysForTarget(e).forEach((t=>{this.ze(e,t,null)}))}ut(e,t){return this.ke.getRemoteKeysForTarget(e).has(t)}}function io(){return new Xr(tn.comparator)}function ao(){return new Xr(tn.comparator)}const so={asc:"ASCENDING",desc:"DESCENDING"},oo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},lo={and:"AND",or:"OR"};class co{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function uo(e,t){return e.useProto3Json||Rn(t)?t:{value:t}}function ho(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function fo(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function po(e,t){return ho(e,t.toTimestamp())}function mo(e){return xt(!!e),Yt.fromTimestamp(function(e){const t=si(e);return new qt(t.seconds,t.nanos)}(e))}function go(e,t){return vo(e,t).canonicalString()}function vo(e,t){const n=function(e){return new Jt(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function yo(e){const t=Jt.fromString(e);return xt(jo(t)),t}function bo(e,t){return go(e.databaseId,t.path)}function wo(e,t){const n=yo(t);if(n.get(1)!==e.databaseId.projectId)throw new Ct(_t.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Ct(_t.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new tn(xo(n))}function To(e,t){return go(e.databaseId,t)}function Eo(e){const t=yo(e);return 4===t.length?Jt.emptyPath():xo(t)}function So(e){return new Jt(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function xo(e){return xt(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function ko(e,t,n){return{name:bo(e,t),fields:n.value.mapValue.fields}}function _o(e,t,n){const r=wo(e,t.name),i=mo(t.updateTime),a=t.createTime?mo(t.createTime):Yt.min(),s=new qi({mapValue:{fields:t.fields}}),o=Xi.newFoundDocument(r,i,a,s);return n&&o.setHasCommittedMutations(),n?o.setHasCommittedMutations():o}function Co(e,t){let n;if(t instanceof Ns)n={update:ko(e,t.key,t.value)};else if(t instanceof Ls)n={delete:bo(e,t.key)};else if(t instanceof Ds)n={update:ko(e,t.key,t.data),updateMask:Uo(t.fieldMask)};else{if(!(t instanceof Ms))return St();n={verify:bo(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const n=t.transform;if(n instanceof fs)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof ds)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof ms)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof vs)return{fieldPath:t.field.canonicalString(),increment:n.Ie};throw St()}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:po(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:St()}(e,t.precondition)),n}function Ao(e,t){const n=t.currentDocument?function(e){return void 0!==e.updateTime?Es.updateTime(mo(e.updateTime)):void 0!==e.exists?Es.exists(e.exists):Es.none()}(t.currentDocument):Es.none(),r=t.updateTransforms?t.updateTransforms.map((t=>function(e,t){let n=null;if("setToServerValue"in t)xt("REQUEST_TIME"===t.setToServerValue),n=new fs;else if("appendMissingElements"in t){const e=t.appendMissingElements.values||[];n=new ds(e)}else if("removeAllFromArray"in t){const e=t.removeAllFromArray.values||[];n=new ms(e)}else"increment"in t?n=new vs(e,t.increment):St();const r=en.fromServerFormat(t.fieldPath);return new ws(r,n)}(e,t))):[];if(t.update){t.update.name;const i=wo(e,t.update.name),a=new qi({mapValue:{fields:t.update.fields}});if(t.updateMask){const e=function(e){const t=e.fieldPaths||[];return new ni(t.map((e=>en.fromServerFormat(e))))}(t.updateMask);return new Ds(i,a,e,n,r)}return new Ns(i,a,n,r)}if(t.delete){const r=wo(e,t.delete);return new Ls(r,n)}if(t.verify){const r=wo(e,t.verify);return new Ms(r,n)}return St()}function Io(e,t){return{documents:[To(e,t.path)]}}function No(e,t){const n={structuredQuery:{}},r=t.path;let i;null!==t.collectionGroup?(i=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=To(e,i);const a=function(e){if(0!==e.length)return zo(ia.create(e,"and"))}(t.filters);a&&(n.structuredQuery.where=a);const s=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:Mo(e.field),direction:Ro(e.dir)}}(e)))}(t.orderBy);s&&(n.structuredQuery.orderBy=s);const o=uo(e,t.limit);return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{ht:n,parent:i}}function Do(e){let t=Eo(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){xt(1===r);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let a=[];n.where&&(a=function(e){const t=Oo(e);return t instanceof ia&&oa(t)?t.getFilters():[t]}(n.where));let s=[];n.orderBy&&(s=function(e){return e.map((e=>function(e){return new ea(Fo(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)))}(n.orderBy));let o=null;n.limit&&(o=function(e){let t;return t="object"==typeof e?e.value:e,Rn(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new Qi(n,t)}(n.startAt));let c=null;return n.endAt&&(c=function(e){const t=!e.before,n=e.values||[];return new Qi(n,t)}(n.endAt)),Na(t,i,s,a,o,"F",l,c)}function Oo(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Fo(e.unaryFilter.field);return ra.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=Fo(e.unaryFilter.field);return ra.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Fo(e.unaryFilter.field);return ra.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Fo(e.unaryFilter.field);return ra.create(i,"!=",{nullValue:"NULL_VALUE"});default:return St()}}(e):void 0!==e.fieldFilter?function(e){return ra.create(Fo(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return St()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return ia.create(e.compositeFilter.filters.map((e=>Oo(e))),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return St()}}(e.compositeFilter.op))}(e):St()}function Ro(e){return so[e]}function Po(e){return oo[e]}function Lo(e){return lo[e]}function Mo(e){return{fieldPath:e.canonicalString()}}function Fo(e){return en.fromServerFormat(e.fieldPath)}function zo(e){return e instanceof ra?function(e){if("=="===e.op){if(zi(e.value))return{unaryFilter:{field:Mo(e.field),op:"IS_NAN"}};if(Fi(e.value))return{unaryFilter:{field:Mo(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(zi(e.value))return{unaryFilter:{field:Mo(e.field),op:"IS_NOT_NAN"}};if(Fi(e.value))return{unaryFilter:{field:Mo(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Mo(e.field),op:Po(e.op),value:e.value}}}(e):e instanceof ia?function(e){const t=e.getFilters().map((e=>zo(e)));return 1===t.length?t[0]:{compositeFilter:{op:Lo(e.op),filters:t}}}(e):St()}function Uo(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function jo(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class Bo{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Yt.min(),a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Yt.min(),s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:ii.EMPTY_BYTE_STRING,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=s,this.expectedCount=o}withSequenceNumber(e){return new Bo(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Bo(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Bo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Bo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Vo{constructor(e){this.Tt=e}}function $o(e,t){const n=t.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Ho(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())r.document=function(e,t){return{name:bo(e,t.key),fields:t.data.value.mapValue.fields,updateTime:ho(e,t.version.toTimestamp()),createTime:ho(e,t.createTime.toTimestamp())}}(e.Tt,t);else if(t.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Wo(t.version)};else{if(!t.isUnknownDocument())return St();r.unknownDocument={path:n.path.toArray(),version:Wo(t.version)}}return r}function Ho(e){const t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function Wo(e){const t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function Go(e){const t=new qt(e.seconds,e.nanoseconds);return Yt.fromTimestamp(t)}function Ko(e,t){const n=(t.baseMutations||[]).map((t=>Ao(e.Tt,t)));for(let a=0;a<t.mutations.length-1;++a){const e=t.mutations[a];if(a+1<t.mutations.length&&void 0!==t.mutations[a+1].transform){const n=t.mutations[a+1];e.updateTransforms=n.transform.fieldTransforms,t.mutations.splice(a+1,1),++a}}const r=t.mutations.map((t=>Ao(e.Tt,t))),i=qt.fromMillis(t.localWriteTimeMs);return new Fs(t.batchId,i,n,r)}function qo(e){const t=Go(e.readTime),n=void 0!==e.lastLimboFreeSnapshotVersion?Go(e.lastLimboFreeSnapshotVersion):Yt.min();let r;return r=function(e){return void 0!==e.documents}(e.query)?function(e){return xt(1===e.documents.length),La(Da(Eo(e.documents[0])))}(e.query):function(e){return La(Do(e))}(e.query),new Bo(r,e.targetId,"TargetPurposeListen",e.lastListenSequenceNumber,t,n,ii.fromBase64String(e.resumeToken))}function Yo(e,t){const n=Wo(t.snapshotVersion),r=Wo(t.lastLimboFreeSnapshotVersion);let i;i=ka(t.target)?Io(e.Tt,t.target):No(e.Tt,t.target).ht;const a=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:Sa(t.target),readTime:n,resumeToken:a,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function Xo(e){const t=Do({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Fa(t,t.limit,"L"):t}function Qo(e,t){return new Us(t.largestBatchId,Ao(e.Tt,t.overlayMutation))}function Jo(e,t){const n=t.path.lastSegment();return[e,Fn(t.path.popLast()),n]}function Zo(e,t,n,r){return{indexId:e,uid:t,sequenceNumber:n,readTime:Wo(r.readTime),documentKey:Fn(r.documentKey.path),largestBatchId:r.largestBatchId}}class el{getBundleMetadata(e,t){return tl(e).get(t).next((e=>{if(e)return function(e){return{id:e.bundleId,createTime:Go(e.createTime),version:e.version}}(e)}))}saveBundleMetadata(e,t){return tl(e).put(function(e){return{bundleId:e.id,createTime:Wo(mo(e.createTime)),version:e.version}}(t))}getNamedQuery(e,t){return nl(e).get(t).next((e=>{if(e)return function(e){return{name:e.name,query:Xo(e.bundledQuery),readTime:Go(e.readTime)}}(e)}))}saveNamedQuery(e,t){return nl(e).put(function(e){return{name:e.name,readTime:Wo(mo(e.readTime)),bundledQuery:e.bundledQuery}}(t))}}function tl(e){return Gr(e,br)}function nl(e){return Gr(e,wr)}class rl{constructor(e,t){this.serializer=e,this.userId=t}static It(e,t){const n=t.uid||"";return new rl(e,n)}getOverlay(e,t){return il(e).get(Jo(this.userId,t)).next((e=>e?Qo(this.serializer,e):null))}getOverlays(e,t){const n=Qa();return gn.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){const r=[];return n.forEach(((n,i)=>{const a=new Us(t,i);r.push(this.Et(e,a))})),gn.waitFor(r)}removeOverlaysForBatchId(e,t,n){const r=new Set;t.forEach((e=>r.add(Fn(e.getCollectionPath()))));const i=[];return r.forEach((t=>{const r=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,n+1],!1,!0);i.push(il(e).J(Rr,r))})),gn.waitFor(i)}getOverlaysForCollection(e,t,n){const r=Qa(),i=Fn(t),a=IDBKeyRange.bound([this.userId,i,n],[this.userId,i,Number.POSITIVE_INFINITY],!0);return il(e).G(Rr,a).next((e=>{for(const t of e){const e=Qo(this.serializer,t);r.set(e.getKey(),e)}return r}))}getOverlaysForCollectionGroup(e,t,n,r){const i=Qa();let a;const s=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return il(e).Z({index:Lr,range:s},((e,t,n)=>{const s=Qo(this.serializer,t);i.size()<r||s.largestBatchId===a?(i.set(s.getKey(),s),a=s.largestBatchId):n.done()})).next((()=>i))}Et(e,t){return il(e).put(function(e,t,n){const[r,i,a]=Jo(t,n.mutation.key);return{userId:t,collectionPath:i,documentId:a,collectionGroup:n.mutation.key.getCollectionGroup(),largestBatchId:n.largestBatchId,overlayMutation:Co(e.Tt,n.mutation)}}(this.serializer,this.userId,t))}}function il(e){return Gr(e,Dr)}class al{dt(e){return Gr(e,Fr)}getSessionToken(e){return this.dt(e).get("sessionToken").next((e=>{const t=null==e?void 0:e.value;return t?ii.fromUint8Array(t):ii.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.dt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class sl{constructor(){}At(e,t){this.Rt(e,t),t.Vt()}Rt(e,t){if("nullValue"in e)this.ft(t,5);else if("booleanValue"in e)this.ft(t,10),t.gt(e.booleanValue?1:0);else if("integerValue"in e)this.ft(t,15),t.gt(oi(e.integerValue));else if("doubleValue"in e){const n=oi(e.doubleValue);isNaN(n)?this.ft(t,13):(this.ft(t,15),Pn(n)?t.gt(0):t.gt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.ft(t,20),"string"==typeof n&&(n=si(n)),t.yt(`${n.seconds||""}`),t.gt(n.nanos||0)}else if("stringValue"in e)this.wt(e.stringValue,t),this.St(t);else if("bytesValue"in e)this.ft(t,30),t.bt(li(e.bytesValue)),this.St(t);else if("referenceValue"in e)this.Dt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.ft(t,45),t.gt(n.latitude||0),t.gt(n.longitude||0)}else"mapValue"in e?Vi(e)?this.ft(t,Number.MAX_SAFE_INTEGER):ji(e)?this.vt(e.mapValue,t):(this.Ct(e.mapValue,t),this.St(t)):"arrayValue"in e?(this.Ft(e.arrayValue,t),this.St(t)):St()}wt(e,t){this.ft(t,25),this.Mt(e,t)}Mt(e,t){t.yt(e)}Ct(e,t){const n=e.fields||{};this.ft(t,55);for(const r of Object.keys(n))this.wt(r,t),this.Rt(n[r],t)}vt(e,t){var n,r;const i=e.fields||{};this.ft(t,53);const a=Si,s=(null===(r=null===(n=i[a].arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.length)||0;this.ft(t,15),t.gt(oi(s)),this.wt(a,t),this.Rt(i[a],t)}Ft(e,t){const n=e.values||[];this.ft(t,50);for(const r of n)this.Rt(r,t)}Dt(e,t){this.ft(t,37),tn.fromName(e).path.forEach((e=>{this.ft(t,60),this.Mt(e,t)}))}ft(e,t){e.gt(t)}St(e){e.gt(2)}}sl.xt=new sl;const ol=255;function ll(e){if(0===e)return 8;let t=0;return e>>4||(t+=4,e<<=4),e>>6||(t+=2,e<<=2),e>>7||(t+=1),t}function cl(e){const t=64-function(e){let t=0;for(let n=0;n<8;++n){const r=ll(255&e[n]);if(t+=r,8!==r)break}return t}(e);return Math.ceil(t/8)}class ul{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ot(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Nt(n.value),n=t.next();this.Bt()}Lt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.kt(n.value),n=t.next();this.qt()}Qt(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.Nt(e);else if(e<2048)this.Nt(960|e>>>6),this.Nt(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Nt(480|e>>>12),this.Nt(128|63&e>>>6),this.Nt(128|63&e);else{const e=t.codePointAt(0);this.Nt(240|e>>>18),this.Nt(128|63&e>>>12),this.Nt(128|63&e>>>6),this.Nt(128|63&e)}}this.Bt()}$t(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.kt(e);else if(e<2048)this.kt(960|e>>>6),this.kt(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.kt(480|e>>>12),this.kt(128|63&e>>>6),this.kt(128|63&e);else{const e=t.codePointAt(0);this.kt(240|e>>>18),this.kt(128|63&e>>>12),this.kt(128|63&e>>>6),this.kt(128|63&e)}}this.qt()}Ut(e){const t=this.Kt(e),n=cl(t);this.Wt(1+n),this.buffer[this.position++]=255&n;for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=255&t[r]}Gt(e){const t=this.Kt(e),n=cl(t);this.Wt(1+n),this.buffer[this.position++]=~(255&n);for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}zt(){this.jt(ol),this.jt(255)}Ht(){this.Jt(ol),this.Jt(255)}reset(){this.position=0}seed(e){this.Wt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Yt(){return this.buffer.slice(0,this.position)}Kt(e){const t=function(e){const t=new DataView(new ArrayBuffer(8));return t.setFloat64(0,e,!1),new Uint8Array(t.buffer)}(e),n=!!(128&t[0]);t[0]^=n?255:128;for(let r=1;r<t.length;++r)t[r]^=n?255:0;return t}Nt(e){const t=255&e;0===t?(this.jt(0),this.jt(255)):t===ol?(this.jt(ol),this.jt(0)):this.jt(t)}kt(e){const t=255&e;0===t?(this.Jt(0),this.Jt(255)):t===ol?(this.Jt(ol),this.Jt(0)):this.Jt(e)}Bt(){this.jt(0),this.jt(1)}qt(){this.Jt(0),this.Jt(1)}jt(e){this.Wt(1),this.buffer[this.position++]=e}Jt(e){this.Wt(1),this.buffer[this.position++]=~e}Wt(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}}class hl{constructor(e){this.Zt=e}bt(e){this.Zt.Ot(e)}yt(e){this.Zt.Qt(e)}gt(e){this.Zt.Ut(e)}Vt(){this.Zt.zt()}}class fl{constructor(e){this.Zt=e}bt(e){this.Zt.Lt(e)}yt(e){this.Zt.$t(e)}gt(e){this.Zt.Gt(e)}Vt(){this.Zt.Ht()}}class dl{constructor(){this.Zt=new ul,this.Xt=new hl(this.Zt),this.en=new fl(this.Zt)}seed(e){this.Zt.seed(e)}tn(e){return 0===e?this.Xt:this.en}Yt(){return this.Zt.Yt()}reset(){this.Zt.reset()}}class pl{constructor(e,t,n,r){this.indexId=e,this.documentKey=t,this.arrayValue=n,this.directionalValue=r}nn(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,n=new Uint8Array(t);return n.set(this.directionalValue,0),t!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new pl(this.indexId,this.documentKey,this.arrayValue,n)}}function ml(e,t){let n=e.indexId-t.indexId;return 0!==n?n:(n=gl(e.arrayValue,t.arrayValue),0!==n?n:(n=gl(e.directionalValue,t.directionalValue),0!==n?n:tn.comparator(e.documentKey,t.documentKey)))}function gl(e,t){for(let n=0;n<e.length&&n<t.length;++n){const r=e[n]-t[n];if(0!==r)return r}return e.length-t.length}class vl{constructor(e){this.rn=new Zr(((e,t)=>en.comparator(e.field,t.field))),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.sn=e.orderBy,this._n=[];for(const t of e.filters){const e=t;e.isInequality()?this.rn=this.rn.add(e):this._n.push(e)}}get an(){return this.rn.size>1}un(e){if(xt(e.collectionGroup===this.collectionId),this.an)return!1;const t=an(e);if(void 0!==t&&!this.cn(t))return!1;const n=sn(e);let r=new Set,i=0,a=0;for(;i<n.length&&this.cn(n[i]);++i)r=r.add(n[i].fieldPath.canonicalString());if(i===n.length)return!0;if(this.rn.size>0){const e=this.rn.getIterator().getNext();if(!r.has(e.field.canonicalString())){const t=n[i];if(!this.ln(e,t)||!this.hn(this.sn[a++],t))return!1}++i}for(;i<n.length;++i){const e=n[i];if(a>=this.sn.length||!this.hn(this.sn[a++],e))return!1}return!0}Pn(){if(this.an)return null;let e=new Zr(en.comparator);const t=[];for(const n of this._n)if(!n.field.isKeyField())if("array-contains"===n.op||"array-contains-any"===n.op)t.push(new on(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new on(n.field,0))}for(const n of this.sn)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new on(n.field,"asc"===n.dir?0:1)));return new rn(rn.UNKNOWN_ID,this.collectionId,t,ln.empty())}cn(e){for(const t of this._n)if(this.ln(t,e))return!0;return!1}ln(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;const n="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===n}hn(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function yl(e){var t,n;if(xt(e instanceof ra||e instanceof ia),e instanceof ra){if(e instanceof ya){const r=(null===(n=null===(t=e.value.arrayValue)||void 0===t?void 0:t.values)||void 0===n?void 0:n.map((t=>ra.create(e.field,"==",t))))||[];return ia.create(r,"or")}return e}const r=e.filters.map((e=>yl(e)));return ia.create(r,e.op)}function bl(e){if(0===e.getFilters().length)return[];const t=Sl(yl(e));return xt(El(t)),wl(t)||Tl(t)?[t]:t.getFilters()}function wl(e){return e instanceof ra}function Tl(e){return e instanceof ia&&oa(e)}function El(e){return wl(e)||Tl(e)||function(e){if(e instanceof ia&&sa(e)){for(const t of e.getFilters())if(!wl(t)&&!Tl(t))return!1;return!0}return!1}(e)}function Sl(e){if(xt(e instanceof ra||e instanceof ia),e instanceof ra)return e;if(1===e.filters.length)return Sl(e.filters[0]);const t=e.filters.map((e=>Sl(e)));let n=ia.create(t,e.op);return n=_l(n),El(n)?n:(xt(n instanceof ia),xt(aa(n)),xt(n.filters.length>1),n.filters.reduce(((e,t)=>xl(e,t))))}function xl(e,t){let n;return xt(e instanceof ra||e instanceof ia),xt(t instanceof ra||t instanceof ia),n=e instanceof ra?t instanceof ra?function(e,t){return ia.create([e,t],"and")}(e,t):kl(e,t):t instanceof ra?kl(t,e):function(e,t){if(xt(e.filters.length>0&&t.filters.length>0),aa(e)&&aa(t))return ha(e,t.getFilters());const n=sa(e)?e:t,r=sa(e)?t:e,i=n.filters.map((e=>xl(e,r)));return ia.create(i,"or")}(e,t),_l(n)}function kl(e,t){if(aa(t))return ha(t,e.getFilters());{const n=t.filters.map((t=>xl(e,t)));return ia.create(n,"or")}}function _l(e){if(xt(e instanceof ra||e instanceof ia),e instanceof ra)return e;const t=e.getFilters();if(1===t.length)return _l(t[0]);if(la(e))return e;const n=t.map((e=>_l(e))),r=[];return n.forEach((t=>{t instanceof ra?r.push(t):t instanceof ia&&(t.op===e.op?r.push(...t.filters):r.push(t))})),1===r.length?r[0]:ia.create(r,e.op)}class Cl{constructor(){this.Tn=new Al}addToCollectionParentIndex(e,t){return this.Tn.add(t),gn.resolve()}getCollectionParents(e,t){return gn.resolve(this.Tn.getEntries(t))}addFieldIndex(e,t){return gn.resolve()}deleteFieldIndex(e,t){return gn.resolve()}deleteAllFieldIndexes(e){return gn.resolve()}createTargetIndexes(e,t){return gn.resolve()}getDocumentsMatchingTarget(e,t){return gn.resolve(null)}getIndexType(e,t){return gn.resolve(0)}getFieldIndexes(e,t){return gn.resolve([])}getNextCollectionGroupToUpdate(e){return gn.resolve(null)}getMinOffset(e,t){return gn.resolve(hn.min())}getMinOffsetFromCollectionGroup(e,t){return gn.resolve(hn.min())}updateCollectionGroup(e,t,n){return gn.resolve()}updateIndexEntries(e,t){return gn.resolve()}}class Al{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Zr(Jt.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new Zr(Jt.comparator)).toArray()}}const Il="IndexedDbIndexManager",Nl=new Uint8Array(0);class Dl{constructor(e,t){this.databaseId=t,this.In=new Al,this.En=new Wa((e=>Sa(e)),((e,t)=>xa(e,t))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.In.has(t)){const n=t.lastSegment(),r=t.popLast();e.addOnCommittedListener((()=>{this.In.add(t)}));const i={collectionId:n,parent:Fn(r)};return Ol(e).put(i)}return gn.resolve()}getCollectionParents(e,t){const n=[],r=IDBKeyRange.bound([t,""],[Wt(t),""],!1,!0);return Ol(e).G(r).next((e=>{for(const r of e){if(r.collectionId!==t)break;n.push(jn(r.parent))}return n}))}addFieldIndex(e,t){const n=Pl(e),r=function(e){return{indexId:e.indexId,collectionGroup:e.collectionGroup,fields:e.fields.map((e=>[e.fieldPath.canonicalString(),e.kind]))}}(t);delete r.indexId;const i=n.add(r);if(t.indexState){const n=Ll(e);return i.next((e=>{n.put(Zo(e,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return i.next()}deleteFieldIndex(e,t){const n=Pl(e),r=Ll(e),i=Rl(e);return n.delete(t.indexId).next((()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Pl(e),n=Rl(e),r=Ll(e);return t.J().next((()=>n.J())).next((()=>r.J()))}createTargetIndexes(e,t){return gn.forEach(this.dn(t),(t=>this.getIndexType(e,t).next((n=>{if(0===n||1===n){const n=new vl(t).Pn();if(null!=n)return this.addFieldIndex(e,n)}}))))}getDocumentsMatchingTarget(e,t){const n=Rl(e);let r=!0;const i=new Map;return gn.forEach(this.dn(t),(t=>this.An(e,t).next((e=>{r&&(r=!!e),i.set(t,e)})))).next((()=>{if(r){let e=ns();const r=[];return gn.forEach(i,((i,a)=>{bt(Il,`Using index ${function(e){return`id=${e.indexId}|cg=${e.collectionGroup}|f=${e.fields.map((e=>`${e.fieldPath}:${e.kind}`)).join(",")}`}(i)} to execute ${Sa(t)}`);const s=function(e,t){const n=an(t);if(void 0===n)return null;for(const r of _a(e,n.fieldPath))switch(r.op){case"array-contains-any":return r.value.arrayValue.values||[];case"array-contains":return[r.value]}return null}(a,i),o=function(e,t){const n=new Map;for(const r of sn(t))for(const t of _a(e,r.fieldPath))switch(t.op){case"==":case"in":n.set(r.fieldPath.canonicalString(),t.value);break;case"not-in":case"!=":return n.set(r.fieldPath.canonicalString(),t.value),Array.from(n.values())}return null}(a,i),l=function(e,t){const n=[];let r=!0;for(const i of sn(t)){const t=0===i.kind?Ca(e,i.fieldPath,e.startAt):Aa(e,i.fieldPath,e.startAt);n.push(t.value),r&&(r=t.inclusive)}return new Qi(n,r)}(a,i),c=function(e,t){const n=[];let r=!0;for(const i of sn(t)){const t=0===i.kind?Aa(e,i.fieldPath,e.endAt):Ca(e,i.fieldPath,e.endAt);n.push(t.value),r&&(r=t.inclusive)}return new Qi(n,r)}(a,i),u=this.Rn(i,a,l),h=this.Rn(i,a,c),f=this.Vn(i,a,o),d=this.mn(i.indexId,s,u,l.inclusive,h,c.inclusive,f);return gn.forEach(d,(i=>n.H(i,t.limit).next((t=>{t.forEach((t=>{const n=tn.fromSegments(t.documentKey);e.has(n)||(e=e.add(n),r.push(n))}))}))))})).next((()=>r))}return gn.resolve(null)}))}dn(e){let t=this.En.get(e);return t||(t=0===e.filters.length?[e]:bl(ia.create(e.filters,"and")).map((t=>Ea(e.path,e.collectionGroup,e.orderBy,t.getFilters(),e.limit,e.startAt,e.endAt))),this.En.set(e,t),t)}mn(e,t,n,r,i,a,s){const o=(null!=t?t.length:1)*Math.max(n.length,i.length),l=o/(null!=t?t.length:1),c=[];for(let u=0;u<o;++u){const o=t?this.fn(t[u/l]):Nl,h=this.gn(e,o,n[u%l],r),f=this.pn(e,o,i[u%l],a),d=s.map((t=>this.gn(e,o,t,!0)));c.push(...this.createRange(h,f,d))}return c}gn(e,t,n,r){const i=new pl(e,tn.empty(),t,n);return r?i:i.nn()}pn(e,t,n,r){const i=new pl(e,tn.empty(),t,n);return r?i.nn():i}An(e,t){const n=new vl(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((e=>{let t=null;for(const r of e)n.un(r)&&(!t||r.fields.length>t.fields.length)&&(t=r);return t}))}getIndexType(e,t){let n=2;const r=this.dn(t);return gn.forEach(r,(t=>this.An(e,t).next((e=>{e?0!==n&&e.fields.length<function(e){let t=new Zr(en.comparator),n=!1;for(const r of e.filters)for(const e of r.getFlattenedFilters())e.field.isKeyField()||("array-contains"===e.op||"array-contains-any"===e.op?n=!0:t=t.add(e.field));for(const r of e.orderBy)r.field.isKeyField()||(t=t.add(r.field));return t.size+(n?1:0)}(t)&&(n=1):n=0})))).next((()=>function(e){return null!==e.limit}(t)&&r.length>1&&2===n?1:n))}yn(e,t){const n=new dl;for(const r of sn(e)){const e=t.data.field(r.fieldPath);if(null==e)return null;const i=n.tn(r.kind);sl.xt.At(e,i)}return n.Yt()}fn(e){const t=new dl;return sl.xt.At(e,t.tn(0)),t.Yt()}wn(e,t){const n=new dl;return sl.xt.At(Pi(this.databaseId,t),n.tn(function(e){const t=sn(e);return 0===t.length?0:t[t.length-1].kind}(e))),n.Yt()}Vn(e,t,n){if(null===n)return[];let r=[];r.push(new dl);let i=0;for(const a of sn(e)){const e=n[i++];for(const n of r)if(this.Sn(t,a.fieldPath)&&Mi(e))r=this.bn(r,a,e);else{const t=n.tn(a.kind);sl.xt.At(e,t)}}return this.Dn(r)}Rn(e,t,n){return this.Vn(e,t,n.position)}Dn(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].Yt();return t}bn(e,t,n){const r=[...e],i=[];for(const a of n.arrayValue.values||[])for(const e of r){const n=new dl;n.seed(e.Yt()),sl.xt.At(a,n.tn(t.kind)),i.push(n)}return i}Sn(e,t){return!!e.filters.find((e=>e instanceof ra&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op)))}getFieldIndexes(e,t){const n=Pl(e),r=Ll(e);return(t?n.G(Er,IDBKeyRange.bound(t,t)):n.G()).next((e=>{const t=[];return gn.forEach(e,(e=>r.get([e.indexId,this.uid]).next((n=>{t.push(function(e,t){const n=t?new ln(t.sequenceNumber,new hn(Go(t.readTime),new tn(jn(t.documentKey)),t.largestBatchId)):ln.empty(),r=e.fields.map((e=>{let[t,n]=e;return new on(en.fromServerFormat(t),n)}));return new rn(e.indexId,e.collectionGroup,r,n)}(e,n))})))).next((()=>t))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((e=>0===e.length?null:(e.sort(((e,t)=>{const n=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==n?n:jt(e.collectionGroup,t.collectionGroup)})),e[0].collectionGroup)))}updateCollectionGroup(e,t,n){const r=Pl(e),i=Ll(e);return this.vn(e).next((e=>r.G(Er,IDBKeyRange.bound(t,t)).next((t=>gn.forEach(t,(t=>i.put(Zo(t.indexId,this.uid,e,n))))))))}updateIndexEntries(e,t){const n=new Map;return gn.forEach(t,((t,r)=>{const i=n.get(t.collectionGroup);return(i?gn.resolve(i):this.getFieldIndexes(e,t.collectionGroup)).next((i=>(n.set(t.collectionGroup,i),gn.forEach(i,(n=>this.Cn(e,t,n).next((t=>{const i=this.Fn(r,n);return t.isEqual(i)?gn.resolve():this.Mn(e,r,n,t,i)})))))))}))}xn(e,t,n,r){return Rl(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.wn(n,t.key),documentKey:t.key.path.toArray()})}On(e,t,n,r){return Rl(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.wn(n,t.key),t.key.path.toArray()])}Cn(e,t,n){const r=Rl(e);let i=new Zr(ml);return r.Z({index:Ir,range:IDBKeyRange.only([n.indexId,this.uid,this.wn(n,t)])},((e,r)=>{i=i.add(new pl(n.indexId,t,r.arrayValue,r.directionalValue))})).next((()=>i))}Fn(e,t){let n=new Zr(ml);const r=this.yn(t,e);if(null==r)return n;const i=an(t);if(null!=i){const a=e.data.field(i.fieldPath);if(Mi(a))for(const i of a.arrayValue.values||[])n=n.add(new pl(t.indexId,e.key,this.fn(i),r))}else n=n.add(new pl(t.indexId,e.key,Nl,r));return n}Mn(e,t,n,r,i){bt(Il,"Updating index entries for document '%s'",t.key);const a=[];return function(e,t,n,r,i){const a=e.getIterator(),s=t.getIterator();let o=ti(a),l=ti(s);for(;o||l;){let e=!1,t=!1;if(o&&l){const r=n(o,l);r<0?t=!0:r>0&&(e=!0)}else null!=o?t=!0:e=!0;e?(r(l),l=ti(s)):t?(i(o),o=ti(a)):(o=ti(a),l=ti(s))}}(r,i,ml,(r=>{a.push(this.xn(e,t,n,r))}),(r=>{a.push(this.On(e,t,n,r))})),gn.waitFor(a)}vn(e){let t=1;return Ll(e).Z({index:kr,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((e,n,r)=>{r.done(),t=n.sequenceNumber+1})).next((()=>t))}createRange(e,t,n){n=n.sort(((e,t)=>ml(e,t))).filter(((e,t,n)=>!t||0!==ml(e,n[t-1])));const r=[];r.push(e);for(const a of n){const n=ml(a,e),i=ml(a,t);if(0===n)r[0]=e.nn();else if(n>0&&i<0)r.push(a),r.push(a.nn());else if(i>0)break}r.push(t);const i=[];for(let a=0;a<r.length;a+=2){if(this.Nn(r[a],r[a+1]))return[];const e=[r[a].indexId,this.uid,r[a].arrayValue,r[a].directionalValue,Nl,[]],t=[r[a+1].indexId,this.uid,r[a+1].arrayValue,r[a+1].directionalValue,Nl,[]];i.push(IDBKeyRange.bound(e,t))}return i}Nn(e,t){return ml(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Ml)}getMinOffset(e,t){return gn.mapArray(this.dn(t),(t=>this.An(e,t).next((e=>e||St())))).next(Ml)}}function Ol(e){return Gr(e,gr)}function Rl(e){return Gr(e,Cr)}function Pl(e){return Gr(e,Tr)}function Ll(e){return Gr(e,Sr)}function Ml(e){xt(0!==e.length);let t=e[0].indexState.offset,n=t.largestBatchId;for(let r=1;r<e.length;r++){const i=e[r].indexState.offset;fn(i,t)<0&&(t=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new hn(t.readTime,t.documentKey,n)}const Fl={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},zl=41943040;class Ul{static withCacheSize(e){return new Ul(e,Ul.DEFAULT_COLLECTION_PERCENTILE,Ul.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}function jl(e,t,n){const r=e.store(Wn),i=e.store(Jn),a=[],s=IDBKeyRange.only(n.batchId);let o=0;const l=r.Z({range:s},((e,t,n)=>(o++,n.delete())));a.push(l.next((()=>{xt(1===o)})));const c=[];for(const u of n.mutations){const e=Xn(t,u.key.path,n.batchId);a.push(i.delete(e)),c.push(u.key)}return gn.waitFor(a).next((()=>c))}function Bl(e){if(!e)return 0;let t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw St();t=e.noDocument}return JSON.stringify(t).length}Ul.DEFAULT_COLLECTION_PERCENTILE=10,Ul.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ul.DEFAULT=new Ul(zl,Ul.DEFAULT_COLLECTION_PERCENTILE,Ul.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ul.DISABLED=new Ul(-1,0,0);class Vl{constructor(e,t,n,r){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=r,this.Bn={}}static It(e,t,n,r){xt(""!==e.uid);const i=e.isAuthenticated()?e.uid:"";return new Vl(i,t,n,r)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Hl(e).Z({index:Kn,range:n},((e,n,r)=>{t=!1,r.done()})).next((()=>t))}addMutationBatch(e,t,n,r){const i=Wl(e),a=Hl(e);return a.add({}).next((s=>{xt("number"==typeof s);const o=new Fs(s,t,n,r),l=function(e,t,n){const r=n.baseMutations.map((t=>Co(e.Tt,t))),i=n.mutations.map((t=>Co(e.Tt,t)));return{userId:t,batchId:n.batchId,localWriteTimeMs:n.localWriteTime.toMillis(),baseMutations:r,mutations:i}}(this.serializer,this.userId,o),c=[];let u=new Zr(((e,t)=>jt(e.canonicalString(),t.canonicalString())));for(const e of r){const t=Xn(this.userId,e.key.path,s);u=u.add(e.key.path.popLast()),c.push(a.put(l)),c.push(i.put(t,Qn))}return u.forEach((t=>{c.push(this.indexManager.addToCollectionParentIndex(e,t))})),e.addOnCommittedListener((()=>{this.Bn[s]=o.keys()})),gn.waitFor(c).next((()=>o))}))}lookupMutationBatch(e,t){return Hl(e).get(t).next((e=>e?(xt(e.userId===this.userId),Ko(this.serializer,e)):null))}Ln(e,t){return this.Bn[t]?gn.resolve(this.Bn[t]):this.lookupMutationBatch(e,t).next((e=>{if(e){const n=e.keys();return this.Bn[t]=n,n}return null}))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=IDBKeyRange.lowerBound([this.userId,n]);let i=null;return Hl(e).Z({index:Kn,range:r},((e,t,r)=>{t.userId===this.userId&&(xt(t.batchId>=n),i=Ko(this.serializer,t)),r.done()})).next((()=>i))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=On;return Hl(e).Z({index:Kn,range:t,reverse:!0},((e,t,r)=>{n=t.batchId,r.done()})).next((()=>n))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,On],[this.userId,Number.POSITIVE_INFINITY]);return Hl(e).G(Kn,t).next((e=>e.map((e=>Ko(this.serializer,e)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=Yn(this.userId,t.path),r=IDBKeyRange.lowerBound(n),i=[];return Wl(e).Z({range:r},((n,r,a)=>{const[s,o,l]=n,c=jn(o);if(s===this.userId&&t.path.isEqual(c))return Hl(e).get(l).next((e=>{if(!e)throw St();xt(e.userId===this.userId),i.push(Ko(this.serializer,e))}));a.done()})).next((()=>i))}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Zr(jt);const r=[];return t.forEach((t=>{const i=Yn(this.userId,t.path),a=IDBKeyRange.lowerBound(i),s=Wl(e).Z({range:a},((e,r,i)=>{const[a,s,o]=e,l=jn(s);a===this.userId&&t.path.isEqual(l)?n=n.add(o):i.done()}));r.push(s)})),gn.waitFor(r).next((()=>this.kn(e,n)))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1,i=Yn(this.userId,n),a=IDBKeyRange.lowerBound(i);let s=new Zr(jt);return Wl(e).Z({range:a},((e,t,i)=>{const[a,o,l]=e,c=jn(o);a===this.userId&&n.isPrefixOf(c)?c.length===r&&(s=s.add(l)):i.done()})).next((()=>this.kn(e,s)))}kn(e,t){const n=[],r=[];return t.forEach((t=>{r.push(Hl(e).get(t).next((e=>{if(null===e)throw St();xt(e.userId===this.userId),n.push(Ko(this.serializer,e))})))})),gn.waitFor(r).next((()=>n))}removeMutationBatch(e,t){return jl(e.ue,this.userId,t).next((n=>(e.addOnCommittedListener((()=>{this.qn(t.batchId)})),gn.forEach(n,(t=>this.referenceDelegate.markPotentiallyOrphaned(e,t))))))}qn(e){delete this.Bn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return gn.resolve();const n=IDBKeyRange.lowerBound(function(e){return[e]}(this.userId)),r=[];return Wl(e).Z({range:n},((e,t,n)=>{if(e[0]===this.userId){const t=jn(e[1]);r.push(t)}else n.done()})).next((()=>{xt(0===r.length)}))}))}containsKey(e,t){return $l(e,this.userId,t)}Qn(e){return Gl(e).get(this.userId).next((e=>e||{userId:this.userId,lastAcknowledgedBatchId:On,lastStreamToken:""}))}}function $l(e,t,n){const r=Yn(t,n.path),i=r[1],a=IDBKeyRange.lowerBound(r);let s=!1;return Wl(e).Z({range:a,Y:!0},((e,n,r)=>{const[a,o,l]=e;a===t&&o===i&&(s=!0),r.done()})).next((()=>s))}function Hl(e){return Gr(e,Wn)}function Wl(e){return Gr(e,Jn)}function Gl(e){return Gr(e,Hn)}class Kl{constructor(e){this.$n=e}next(){return this.$n+=2,this.$n}static Un(){return new Kl(0)}static Kn(){return new Kl(-1)}}class ql{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Wn(e).next((t=>{const n=new Kl(t.highestTargetId);return t.highestTargetId=n.next(),this.Gn(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.Wn(e).next((e=>Yt.fromTimestamp(new qt(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.Wn(e).next((e=>e.highestListenSequenceNumber))}setTargetsMetadata(e,t,n){return this.Wn(e).next((r=>(r.highestListenSequenceNumber=t,n&&(r.lastRemoteSnapshotVersion=n.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.Gn(e,r))))}addTargetData(e,t){return this.zn(e,t).next((()=>this.Wn(e).next((n=>(n.targetCount+=1,this.jn(t,n),this.Gn(e,n))))))}updateTargetData(e,t){return this.zn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Yl(e).delete(t.targetId))).next((()=>this.Wn(e))).next((t=>(xt(t.targetCount>0),t.targetCount-=1,this.Gn(e,t))))}removeTargets(e,t,n){let r=0;const i=[];return Yl(e).Z(((a,s)=>{const o=qo(s);o.sequenceNumber<=t&&null===n.get(o.targetId)&&(r++,i.push(this.removeTargetData(e,o)))})).next((()=>gn.waitFor(i))).next((()=>r))}forEachTarget(e,t){return Yl(e).Z(((e,n)=>{const r=qo(n);t(r)}))}Wn(e){return Xl(e).get(pr).next((e=>(xt(null!==e),e)))}Gn(e,t){return Xl(e).put(pr,t)}zn(e,t){return Yl(e).put(Yo(this.serializer,t))}jn(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.Wn(e).next((e=>e.targetCount))}getTargetData(e,t){const n=Sa(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let i=null;return Yl(e).Z({range:r,index:lr},((e,n,r)=>{const a=qo(n);xa(t,a.target)&&(i=a,r.done())})).next((()=>i))}addMatchingKeys(e,t,n){const r=[],i=Ql(e);return t.forEach((t=>{const a=Fn(t.path);r.push(i.put({targetId:n,path:a})),r.push(this.referenceDelegate.addReference(e,n,t))})),gn.waitFor(r)}removeMatchingKeys(e,t,n){const r=Ql(e);return gn.forEach(t,(t=>{const i=Fn(t.path);return gn.waitFor([r.delete([n,i]),this.referenceDelegate.removeReference(e,n,t)])}))}removeMatchingKeysForTargetId(e,t){const n=Ql(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),r=Ql(e);let i=ns();return r.Z({range:n,Y:!0},((e,t,n)=>{const r=jn(e[1]),a=new tn(r);i=i.add(a)})).next((()=>i))}containsKey(e,t){const n=Fn(t.path),r=IDBKeyRange.bound([n],[Wt(n)],!1,!0);let i=0;return Ql(e).Z({index:fr,Y:!0,range:r},((e,t,n)=>{let[r,a]=e;0!==r&&(i++,n.done())})).next((()=>i>0))}lt(e,t){return Yl(e).get(t).next((e=>e?qo(e):null))}}function Yl(e){return Gr(e,or)}function Xl(e){return Gr(e,mr)}function Ql(e){return Gr(e,ur)}const Jl="LruGarbageCollector",Zl=1048576;function ec(e,t){let[n,r]=e,[i,a]=t;const s=jt(n,i);return 0===s?jt(r,a):s}class tc{constructor(e){this.Hn=e,this.buffer=new Zr(ec),this.Jn=0}Yn(){return++this.Jn}Zn(e){const t=[e,this.Yn()];if(this.buffer.size<this.Hn)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();ec(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class nc{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Xn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.er(6e4)}stop(){this.Xn&&(this.Xn.cancel(),this.Xn=null)}get started(){return null!==this.Xn}er(e){bt(Jl,`Garbage collection scheduled in ${e}ms`),this.Xn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Xn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){Sn(e)?bt(Jl,"Ignoring IndexedDB error during garbage collection: ",e):await mn(e)}await this.er(3e5)}))}}class rc{constructor(e,t){this.tr=e,this.params=t}calculateTargetCount(e,t){return this.tr.nr(e).next((e=>Math.floor(t/100*e)))}nthSequenceNumber(e,t){if(0===t)return gn.resolve(Dn.ae);const n=new tc(t);return this.tr.forEachTarget(e,(e=>n.Zn(e.sequenceNumber))).next((()=>this.tr.rr(e,(e=>n.Zn(e))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.tr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.tr.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(bt("LruGarbageCollector","Garbage collection skipped; disabled"),gn.resolve(Fl)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(bt("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Fl):this.ir(e,t)))}getCacheSize(e){return this.tr.getCacheSize(e)}ir(e,t){let n,r,i,a,s,o,l;const c=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((t=>(t>this.params.maximumSequenceNumbersToCollect?(bt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),r=this.params.maximumSequenceNumbersToCollect):r=t,a=Date.now(),this.nthSequenceNumber(e,r)))).next((r=>(n=r,s=Date.now(),this.removeTargets(e,n,t)))).next((t=>(i=t,o=Date.now(),this.removeOrphanedDocuments(e,n)))).next((e=>(l=Date.now(),yt()<=D.DEBUG&&bt("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${a-c}ms\n\tDetermined least recently used ${r} in `+(s-a)+"ms\n"+`\tRemoved ${i} targets in `+(o-s)+"ms\n"+`\tRemoved ${e} documents in `+(l-o)+"ms\n"+`Total Duration: ${l-c}ms`),gn.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e}))))}}function ic(e,t){return new rc(e,t)}class ac{constructor(e,t){this.db=e,this.garbageCollector=ic(this,t)}nr(e){const t=this.sr(e);return this.db.getTargetCache().getTargetCount(e).next((e=>t.next((t=>e+t))))}sr(e){let t=0;return this.rr(e,(e=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}rr(e,t){return this._r(e,((e,n)=>t(n)))}addReference(e,t,n){return sc(e,n)}removeReference(e,t,n){return sc(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return sc(e,t)}ar(e,t){return function(e,t){let n=!1;return Gl(e).X((r=>$l(e,r,t).next((e=>(e&&(n=!0),gn.resolve(!e)))))).next((()=>n))}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let i=0;return this._r(e,((a,s)=>{if(s<=t){const t=this.ar(e,a).next((t=>{if(!t)return i++,n.getEntry(e,a).next((()=>(n.removeEntry(a,Yt.min()),Ql(e).delete(function(e){return[0,Fn(e.path)]}(a)))))}));r.push(t)}})).next((()=>gn.waitFor(r))).next((()=>n.apply(e))).next((()=>i))}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return sc(e,t)}_r(e,t){const n=Ql(e);let r,i=Dn.ae;return n.Z({index:fr},((e,n)=>{let[a,s]=e,{path:o,sequenceNumber:l}=n;0===a?(i!==Dn.ae&&t(new tn(jn(r)),i),i=l,r=o):i=Dn.ae})).next((()=>{i!==Dn.ae&&t(new tn(jn(r)),i)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function sc(e,t){return Ql(e).put(function(e,t){return{targetId:0,path:Fn(e.path),sequenceNumber:t}}(t,e.currentSequenceNumber))}class oc{constructor(){this.changes=new Wa((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Xi.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?gn.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class lc{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return fc(e).put(n)}removeEntry(e,t,n){return fc(e).delete(function(e,t){const n=e.path.toArray();return[n.slice(0,n.length-2),n[n.length-2],Ho(t),n[n.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next((n=>(n.byteSize+=t,this.ur(e,n))))}getEntry(e,t){let n=Xi.newInvalidDocument(t);return fc(e).Z({index:tr,range:IDBKeyRange.only(dc(t))},((e,r)=>{n=this.cr(t,r)})).next((()=>n))}lr(e,t){let n={size:0,document:Xi.newInvalidDocument(t)};return fc(e).Z({index:tr,range:IDBKeyRange.only(dc(t))},((e,r)=>{n={document:this.cr(t,r),size:Bl(r)}})).next((()=>n))}getEntries(e,t){let n=Ka();return this.hr(e,t,((e,t)=>{const r=this.cr(e,t);n=n.insert(e,r)})).next((()=>n))}Pr(e,t){let n=Ka(),r=new Xr(tn.comparator);return this.hr(e,t,((e,t)=>{const i=this.cr(e,t);n=n.insert(e,i),r=r.insert(e,Bl(t))})).next((()=>({documents:n,Tr:r})))}hr(e,t,n){if(t.isEmpty())return gn.resolve();let r=new Zr(mc);t.forEach((e=>r=r.add(e)));const i=IDBKeyRange.bound(dc(r.first()),dc(r.last())),a=r.getIterator();let s=a.getNext();return fc(e).Z({index:tr,range:i},((e,t,r)=>{const i=tn.fromSegments([...t.prefixPath,t.collectionGroup,t.documentId]);for(;s&&mc(s,i)<0;)n(s,null),s=a.getNext();s&&s.isEqual(i)&&(n(s,t),s=a.hasNext()?a.getNext():null),s?r.W(dc(s)):r.done()})).next((()=>{for(;s;)n(s,null),s=a.hasNext()?a.getNext():null}))}getDocumentsMatchingQuery(e,t,n,r,i){const a=t.path,s=[a.popLast().toArray(),a.lastSegment(),Ho(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],o=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return fc(e).G(IDBKeyRange.bound(s,o,!0)).next((e=>{null==i||i.incrementDocumentReadCount(e.length);let n=Ka();for(const i of e){const e=this.cr(tn.fromSegments(i.prefixPath.concat(i.collectionGroup,i.documentId)),i);e.isFoundDocument()&&(Ba(t,e)||r.has(e.key))&&(n=n.insert(e.key,e))}return n}))}getAllFromCollectionGroup(e,t,n,r){let i=Ka();const a=pc(t,n),s=pc(t,hn.max());return fc(e).Z({index:rr,range:IDBKeyRange.bound(a,s,!0)},((e,t,n)=>{const a=this.cr(tn.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);i=i.insert(a.key,a),i.size===r&&n.done()})).next((()=>i))}newChangeBuffer(e){return new uc(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((e=>e.byteSize))}getMetadata(e){return hc(e).get(sr).next((e=>(xt(!!e),e)))}ur(e,t){return hc(e).put(sr,t)}cr(e,t){if(t){const e=function(e,t){let n;if(t.document)n=_o(e.Tt,t.document,!!t.hasCommittedMutations);else if(t.noDocument){const e=tn.fromSegments(t.noDocument.path),r=Go(t.noDocument.readTime);n=Xi.newNoDocument(e,r),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return St();{const e=tn.fromSegments(t.unknownDocument.path),r=Go(t.unknownDocument.version);n=Xi.newUnknownDocument(e,r)}}return t.readTime&&n.setReadTime(function(e){const t=new qt(e[0],e[1]);return Yt.fromTimestamp(t)}(t.readTime)),n}(this.serializer,t);if(!e.isNoDocument()||!e.version.isEqual(Yt.min()))return e}return Xi.newInvalidDocument(e)}}function cc(e){return new lc(e)}class uc extends oc{constructor(e,t){super(),this.Ir=e,this.trackRemovals=t,this.Er=new Wa((e=>e.toString()),((e,t)=>e.isEqual(t)))}applyChanges(e){const t=[];let n=0,r=new Zr(((e,t)=>jt(e.canonicalString(),t.canonicalString())));return this.changes.forEach(((i,a)=>{const s=this.Er.get(i);if(t.push(this.Ir.removeEntry(e,i,s.readTime)),a.isValidDocument()){const o=$o(this.Ir.serializer,a);r=r.add(i.path.popLast());const l=Bl(o);n+=l-s.size,t.push(this.Ir.addEntry(e,i,o))}else if(n-=s.size,this.trackRemovals){const n=$o(this.Ir.serializer,a.convertToNoDocument(Yt.min()));t.push(this.Ir.addEntry(e,i,n))}})),r.forEach((n=>{t.push(this.Ir.indexManager.addToCollectionParentIndex(e,n))})),t.push(this.Ir.updateMetadata(e,n)),gn.waitFor(t)}getFromCache(e,t){return this.Ir.lr(e,t).next((e=>(this.Er.set(t,{size:e.size,readTime:e.document.readTime}),e.document)))}getAllFromCache(e,t){return this.Ir.Pr(e,t).next((e=>{let{documents:t,Tr:n}=e;return n.forEach(((e,n)=>{this.Er.set(e,{size:n,readTime:t.get(e).readTime})})),t}))}}function hc(e){return Gr(e,ar)}function fc(e){return Gr(e,Zn)}function dc(e){const t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function pc(e,t){const n=t.documentKey.path.toArray();return[e,Ho(t.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function mc(e,t){const n=e.path.toArray(),r=t.path.toArray();let i=0;for(let a=0;a<n.length-2&&a<r.length-2;++a)if(i=jt(n[a],r[a]),i)return i;return i=jt(n.length,r.length),i||(i=jt(n[n.length-2],r[r.length-2]),i||jt(n[n.length-1],r[r.length-1]))}class gc{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class vc{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(n=r,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(null!==n&&Cs(n.mutation,e,ni.empty(),qt.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,ns()).next((()=>t))))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ns();const r=Qa();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,n).next((e=>{let t=Ya();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const n=Qa();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,ns())))}populateOverlays(e,t,n){const r=[];return n.forEach((e=>{t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,r){let i=Ka();const a=Za(),s=Za();return t.forEach(((e,t)=>{const s=n.get(t.key);r.has(t.key)&&(void 0===s||s.mutation instanceof Ds)?i=i.insert(t.key,t):void 0!==s?(a.set(t.key,s.mutation.getFieldMask()),Cs(s.mutation,t,s.mutation.getFieldMask(),qt.now())):a.set(t.key,ni.empty())})),this.recalculateAndSaveOverlays(e,i).next((e=>(e.forEach(((e,t)=>a.set(e,t))),t.forEach(((e,t)=>{var n;return s.set(e,new gc(t,null!==(n=a.get(e))&&void 0!==n?n:null))})),s)))}recalculateAndSaveOverlays(e,t){const n=Za();let r=new Xr(((e,t)=>e-t)),i=ns();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const i of e)i.keys().forEach((e=>{const a=t.get(e);if(null===a)return;let s=n.get(e)||ni.empty();s=i.applyToLocalView(a,s),n.set(e,s);const o=(r.get(i.batchId)||ns()).add(e);r=r.insert(i.batchId,o)}))})).next((()=>{const a=[],s=r.getReverseIterator();for(;s.hasNext();){const r=s.getNext(),o=r.key,l=r.value,c=Ja();l.forEach((e=>{if(!i.has(e)){const r=ks(t.get(e),n.get(e));null!==r&&c.set(e,r),i=i.add(e)}})),a.push(this.documentOverlayCache.saveOverlays(e,o,c))}return gn.waitFor(a)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return tn.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Ra(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((i=>{const a=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):gn.resolve(Qa());let s=nn,o=i;return a.next((t=>gn.forEach(t,((t,n)=>(s<n.largestBatchId&&(s=n.largestBatchId),i.get(t)?gn.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{o=o.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,i))).next((()=>this.computeViews(e,o,t,ns()))).next((e=>({batchId:s,changes:Xa(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new tn(t)).next((e=>{let t=Ya();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const i=t.collectionGroup;let a=Ya();return this.indexManager.getCollectionParents(e,i).next((s=>gn.forEach(s,(s=>{const o=function(e,t){return new Ia(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,s.child(i));return this.getDocumentsMatchingCollectionQuery(e,o,n,r).next((e=>{e.forEach(((e,t)=>{a=a.insert(e,t)}))}))})).next((()=>a))))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r)))).next((e=>{i.forEach(((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,Xi.newInvalidDocument(r)))}));let n=Ya();return e.forEach(((e,r)=>{const a=i.get(e);void 0!==a&&Cs(a.mutation,r,ni.empty(),qt.now()),Ba(t,r)&&(n=n.insert(e,r))})),n}))}}class yc{constructor(e){this.serializer=e,this.dr=new Map,this.Ar=new Map}getBundleMetadata(e,t){return gn.resolve(this.dr.get(t))}saveBundleMetadata(e,t){return this.dr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:mo(e.createTime)}}(t)),gn.resolve()}getNamedQuery(e,t){return gn.resolve(this.Ar.get(t))}saveNamedQuery(e,t){return this.Ar.set(t.name,function(e){return{name:e.name,query:Xo(e.bundledQuery),readTime:mo(e.readTime)}}(t)),gn.resolve()}}class bc{constructor(){this.overlays=new Xr(tn.comparator),this.Rr=new Map}getOverlay(e,t){return gn.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Qa();return gn.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,r)=>{this.Et(e,t,r)})),gn.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.Rr.get(n);return void 0!==r&&(r.forEach((e=>this.overlays=this.overlays.remove(e))),this.Rr.delete(n)),gn.resolve()}getOverlaysForCollection(e,t,n){const r=Qa(),i=t.length+1,a=new tn(t.child("")),s=this.overlays.getIteratorFrom(a);for(;s.hasNext();){const e=s.getNext().value,a=e.getKey();if(!t.isPrefixOf(a.path))break;a.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return gn.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new Xr(((e,t)=>e-t));const a=this.overlays.getIterator();for(;a.hasNext();){const e=a.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=Qa(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const s=Qa(),o=i.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach(((e,t)=>s.set(e,t))),!(s.size()>=r)););return gn.resolve(s)}Et(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.Rr.get(r.largestBatchId).delete(n.key);this.Rr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new Us(t,n));let i=this.Rr.get(t);void 0===i&&(i=ns(),this.Rr.set(t,i)),this.Rr.set(t,i.add(n.key))}}class wc{constructor(){this.sessionToken=ii.EMPTY_BYTE_STRING}getSessionToken(e){return gn.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,gn.resolve()}}class Tc{constructor(){this.Vr=new Zr(Ec.mr),this.gr=new Zr(Ec.pr)}isEmpty(){return this.Vr.isEmpty()}addReference(e,t){const n=new Ec(e,t);this.Vr=this.Vr.add(n),this.gr=this.gr.add(n)}yr(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.wr(new Ec(e,t))}Sr(e,t){e.forEach((e=>this.removeReference(e,t)))}br(e){const t=new tn(new Jt([])),n=new Ec(t,e),r=new Ec(t,e+1),i=[];return this.gr.forEachInRange([n,r],(e=>{this.wr(e),i.push(e.key)})),i}Dr(){this.Vr.forEach((e=>this.wr(e)))}wr(e){this.Vr=this.Vr.delete(e),this.gr=this.gr.delete(e)}vr(e){const t=new tn(new Jt([])),n=new Ec(t,e),r=new Ec(t,e+1);let i=ns();return this.gr.forEachInRange([n,r],(e=>{i=i.add(e.key)})),i}containsKey(e){const t=new Ec(e,0),n=this.Vr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class Ec{constructor(e,t){this.key=e,this.Cr=t}static mr(e,t){return tn.comparator(e.key,t.key)||jt(e.Cr,t.Cr)}static pr(e,t){return jt(e.Cr,t.Cr)||tn.comparator(e.key,t.key)}}class Sc{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Fr=1,this.Mr=new Zr(Ec.mr)}checkEmpty(e){return gn.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.Fr;this.Fr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new Fs(i,t,n,r);this.mutationQueue.push(a);for(const s of r)this.Mr=this.Mr.add(new Ec(s.key,i)),this.indexManager.addToCollectionParentIndex(e,s.key.path.popLast());return gn.resolve(a)}lookupMutationBatch(e,t){return gn.resolve(this.Or(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.Nr(n),i=r<0?0:r;return gn.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return gn.resolve(0===this.mutationQueue.length?On:this.Fr-1)}getAllMutationBatches(e){return gn.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Ec(t,0),r=new Ec(t,Number.POSITIVE_INFINITY),i=[];return this.Mr.forEachInRange([n,r],(e=>{const t=this.Or(e.Cr);i.push(t)})),gn.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Zr(jt);return t.forEach((e=>{const t=new Ec(e,0),r=new Ec(e,Number.POSITIVE_INFINITY);this.Mr.forEachInRange([t,r],(e=>{n=n.add(e.Cr)}))})),gn.resolve(this.Br(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;tn.isDocumentKey(i)||(i=i.child(""));const a=new Ec(new tn(i),0);let s=new Zr(jt);return this.Mr.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(s=s.add(e.Cr)),!0)}),a),gn.resolve(this.Br(s))}Br(e){const t=[];return e.forEach((e=>{const n=this.Or(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){xt(0===this.Lr(t.batchId,"removed")),this.mutationQueue.shift();let n=this.Mr;return gn.forEach(t.mutations,(r=>{const i=new Ec(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Mr=n}))}qn(e){}containsKey(e,t){const n=new Ec(t,0),r=this.Mr.firstAfterOrEqual(n);return gn.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,gn.resolve()}Lr(e,t){return this.Nr(e)}Nr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Or(e){const t=this.Nr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class xc{constructor(e){this.kr=e,this.docs=new Xr(tn.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,a=this.kr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return gn.resolve(n?n.document.mutableCopy():Xi.newInvalidDocument(t))}getEntries(e,t){let n=Ka();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():Xi.newInvalidDocument(e))})),gn.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=Ka();const a=t.path,s=new tn(a.child("__id-9223372036854775808__")),o=this.docs.getIteratorFrom(s);for(;o.hasNext();){const{key:e,value:{document:s}}=o.getNext();if(!a.isPrefixOf(e.path))break;e.path.length>a.length+1||fn(un(s),n)<=0||(r.has(s.key)||Ba(t,s))&&(i=i.insert(s.key,s.mutableCopy()))}return gn.resolve(i)}getAllFromCollectionGroup(e,t,n,r){St()}qr(e,t){return gn.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new kc(this)}getSize(e){return gn.resolve(this.size)}}class kc extends oc{constructor(e){super(),this.Ir=e}applyChanges(e){const t=[];return this.changes.forEach(((n,r)=>{r.isValidDocument()?t.push(this.Ir.addEntry(e,r)):this.Ir.removeEntry(n)})),gn.waitFor(t)}getFromCache(e,t){return this.Ir.getEntry(e,t)}getAllFromCache(e,t){return this.Ir.getEntries(e,t)}}class _c{constructor(e){this.persistence=e,this.Qr=new Wa((e=>Sa(e)),xa),this.lastRemoteSnapshotVersion=Yt.min(),this.highestTargetId=0,this.$r=0,this.Ur=new Tc,this.targetCount=0,this.Kr=Kl.Un()}forEachTarget(e,t){return this.Qr.forEach(((e,n)=>t(n))),gn.resolve()}getLastRemoteSnapshotVersion(e){return gn.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return gn.resolve(this.$r)}allocateTargetId(e){return this.highestTargetId=this.Kr.next(),gn.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.$r&&(this.$r=t),gn.resolve()}zn(e){this.Qr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Kr=new Kl(t),this.highestTargetId=t),e.sequenceNumber>this.$r&&(this.$r=e.sequenceNumber)}addTargetData(e,t){return this.zn(t),this.targetCount+=1,gn.resolve()}updateTargetData(e,t){return this.zn(t),gn.resolve()}removeTargetData(e,t){return this.Qr.delete(t.target),this.Ur.br(t.targetId),this.targetCount-=1,gn.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.Qr.forEach(((a,s)=>{s.sequenceNumber<=t&&null===n.get(s.targetId)&&(this.Qr.delete(a),i.push(this.removeMatchingKeysForTargetId(e,s.targetId)),r++)})),gn.waitFor(i).next((()=>r))}getTargetCount(e){return gn.resolve(this.targetCount)}getTargetData(e,t){const n=this.Qr.get(t)||null;return gn.resolve(n)}addMatchingKeys(e,t,n){return this.Ur.yr(t,n),gn.resolve()}removeMatchingKeys(e,t,n){this.Ur.Sr(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((t=>{i.push(r.markPotentiallyOrphaned(e,t))})),gn.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Ur.br(t),gn.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Ur.vr(t);return gn.resolve(n)}containsKey(e,t){return gn.resolve(this.Ur.containsKey(t))}}class Cc{constructor(e,t){this.Wr={},this.overlays={},this.Gr=new Dn(0),this.zr=!1,this.zr=!0,this.jr=new wc,this.referenceDelegate=e(this),this.Hr=new _c(this),this.indexManager=new Cl,this.remoteDocumentCache=function(e){return new xc(e)}((e=>this.referenceDelegate.Jr(e))),this.serializer=new Vo(t),this.Yr=new yc(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.zr=!1,Promise.resolve()}get started(){return this.zr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new bc,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.Wr[e.toKey()];return n||(n=new Sc(t,this.referenceDelegate),this.Wr[e.toKey()]=n),n}getGlobalsCache(){return this.jr}getTargetCache(){return this.Hr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Yr}runTransaction(e,t,n){bt("MemoryPersistence","Starting transaction:",e);const r=new Ac(this.Gr.next());return this.referenceDelegate.Zr(),n(r).next((e=>this.referenceDelegate.Xr(r).next((()=>e)))).toPromise().then((e=>(r.raiseOnCommittedEvent(),e)))}ei(e,t){return gn.or(Object.values(this.Wr).map((n=>()=>n.containsKey(e,t))))}}class Ac extends pn{constructor(e){super(),this.currentSequenceNumber=e}}class Ic{constructor(e){this.persistence=e,this.ti=new Tc,this.ni=null}static ri(e){return new Ic(e)}get ii(){if(this.ni)return this.ni;throw St()}addReference(e,t,n){return this.ti.addReference(n,t),this.ii.delete(n.toString()),gn.resolve()}removeReference(e,t,n){return this.ti.removeReference(n,t),this.ii.add(n.toString()),gn.resolve()}markPotentiallyOrphaned(e,t){return this.ii.add(t.toString()),gn.resolve()}removeTarget(e,t){this.ti.br(t.targetId).forEach((e=>this.ii.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.ii.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}Zr(){this.ni=new Set}Xr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return gn.forEach(this.ii,(n=>{const r=tn.fromPath(n);return this.si(e,r).next((e=>{e||t.removeEntry(r,Yt.min())}))})).next((()=>(this.ni=null,t.apply(e))))}updateLimboDocument(e,t){return this.si(e,t).next((e=>{e?this.ii.delete(t.toString()):this.ii.add(t.toString())}))}Jr(e){return 0}si(e,t){return gn.or([()=>gn.resolve(this.ti.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.ei(e,t)])}}class Nc{constructor(e,t){this.persistence=e,this.oi=new Wa((e=>Fn(e.path)),((e,t)=>e.isEqual(t))),this.garbageCollector=ic(this,t)}static ri(e,t){return new Nc(e,t)}Zr(){}Xr(e){return gn.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}nr(e){const t=this.sr(e);return this.persistence.getTargetCache().getTargetCount(e).next((e=>t.next((t=>e+t))))}sr(e){let t=0;return this.rr(e,(e=>{t++})).next((()=>t))}rr(e,t){return gn.forEach(this.oi,((n,r)=>this.ar(e,n,r).next((e=>e?gn.resolve():t(r)))))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.qr(e,(r=>this.ar(e,r,t).next((e=>{e||(n++,i.removeEntry(r,Yt.min()))})))).next((()=>i.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,t){return this.oi.set(t,e.currentSequenceNumber),gn.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.oi.set(n,e.currentSequenceNumber),gn.resolve()}removeReference(e,t,n){return this.oi.set(n,e.currentSequenceNumber),gn.resolve()}updateLimboDocument(e,t){return this.oi.set(t,e.currentSequenceNumber),gn.resolve()}Jr(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Ri(e.data.value)),t}ar(e,t,n){return gn.or([()=>this.persistence.ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const e=this.oi.get(t);return gn.resolve(void 0!==e&&e>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Dc{constructor(e){this.serializer=e}B(e,t,n,r){const i=new yn("createOrUpgrade",t);n<1&&r>=1&&(function(e){e.createObjectStore(Vn)}(e),function(e){e.createObjectStore(Hn,{keyPath:"userId"});e.createObjectStore(Wn,{keyPath:Gn,autoIncrement:!0}).createIndex(Kn,qn,{unique:!0}),e.createObjectStore(Jn)}(e),Oc(e),function(e){e.createObjectStore(Bn)}(e));let a=gn.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore(ur),e.deleteObjectStore(or),e.deleteObjectStore(mr)}(e),Oc(e)),a=a.next((()=>function(e){const t=e.store(mr),n={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Yt.min().toTimestamp(),targetCount:0};return t.put(pr,n)}(i)))),n<4&&r>=4&&(0!==n&&(a=a.next((()=>function(e,t){return t.store(Wn).G().next((n=>{e.deleteObjectStore(Wn),e.createObjectStore(Wn,{keyPath:Gn,autoIncrement:!0}).createIndex(Kn,qn,{unique:!0});const r=t.store(Wn),i=n.map((e=>r.put(e)));return gn.waitFor(i)}))}(e,i)))),a=a.next((()=>{!function(e){e.createObjectStore(yr,{keyPath:"clientId"})}(e)}))),n<5&&r>=5&&(a=a.next((()=>this._i(i)))),n<6&&r>=6&&(a=a.next((()=>(function(e){e.createObjectStore(ar)}(e),this.ai(i))))),n<7&&r>=7&&(a=a.next((()=>this.ui(i)))),n<8&&r>=8&&(a=a.next((()=>this.ci(e,i)))),n<9&&r>=9&&(a=a.next((()=>{!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e)}))),n<10&&r>=10&&(a=a.next((()=>this.li(i)))),n<11&&r>=11&&(a=a.next((()=>{!function(e){e.createObjectStore(br,{keyPath:"bundleId"})}(e),function(e){e.createObjectStore(wr,{keyPath:"name"})}(e)}))),n<12&&r>=12&&(a=a.next((()=>{!function(e){const t=e.createObjectStore(Dr,{keyPath:Or});t.createIndex(Rr,Pr,{unique:!1}),t.createIndex(Lr,Mr,{unique:!1})}(e)}))),n<13&&r>=13&&(a=a.next((()=>function(e){const t=e.createObjectStore(Zn,{keyPath:er});t.createIndex(tr,nr),t.createIndex(rr,ir)}(e))).next((()=>this.hi(e,i))).next((()=>e.deleteObjectStore(Bn)))),n<14&&r>=14&&(a=a.next((()=>this.Pi(e,i)))),n<15&&r>=15&&(a=a.next((()=>function(e){e.createObjectStore(Tr,{keyPath:"indexId",autoIncrement:!0}).createIndex(Er,"collectionGroup",{unique:!1});e.createObjectStore(Sr,{keyPath:xr}).createIndex(kr,_r,{unique:!1});e.createObjectStore(Cr,{keyPath:Ar}).createIndex(Ir,Nr,{unique:!1})}(e)))),n<16&&r>=16&&(a=a.next((()=>{t.objectStore(Sr).clear()})).next((()=>{t.objectStore(Cr).clear()}))),n<17&&r>=17&&(a=a.next((()=>{!function(e){e.createObjectStore(Fr,{keyPath:"name"})}(e)}))),a}ai(e){let t=0;return e.store(Bn).Z(((e,n)=>{t+=Bl(n)})).next((()=>{const n={byteSize:t};return e.store(ar).put(sr,n)}))}_i(e){const t=e.store(Hn),n=e.store(Wn);return t.G().next((t=>gn.forEach(t,(t=>{const r=IDBKeyRange.bound([t.userId,On],[t.userId,t.lastAcknowledgedBatchId]);return n.G(Kn,r).next((n=>gn.forEach(n,(n=>{xt(n.userId===t.userId);const r=Ko(this.serializer,n);return jl(e,t.userId,r).next((()=>{}))}))))}))))}ui(e){const t=e.store(ur),n=e.store(Bn);return e.store(mr).get(pr).next((e=>{const r=[];return n.Z(((n,i)=>{const a=new Jt(n),s=function(e){return[0,Fn(e)]}(a);r.push(t.get(s).next((n=>n?gn.resolve():(n=>t.put({targetId:0,path:Fn(n),sequenceNumber:e.highestListenSequenceNumber}))(a))))})).next((()=>gn.waitFor(r)))}))}ci(e,t){e.createObjectStore(gr,{keyPath:vr});const n=t.store(gr),r=new Al,i=e=>{if(r.add(e)){const t=e.lastSegment(),r=e.popLast();return n.put({collectionId:t,parent:Fn(r)})}};return t.store(Bn).Z({Y:!0},((e,t)=>{const n=new Jt(e);return i(n.popLast())})).next((()=>t.store(Jn).Z({Y:!0},((e,t)=>{let[n,r,a]=e;const s=jn(r);return i(s.popLast())}))))}li(e){const t=e.store(or);return t.Z(((e,n)=>{const r=qo(n),i=Yo(this.serializer,r);return t.put(i)}))}hi(e,t){const n=t.store(Bn),r=[];return n.Z(((e,n)=>{const i=t.store(Zn),a=function(e){return e.document?new tn(Jt.fromString(e.document.name).popFirst(5)):e.noDocument?tn.fromSegments(e.noDocument.path):e.unknownDocument?tn.fromSegments(e.unknownDocument.path):St()}(n).path.toArray(),s={prefixPath:a.slice(0,a.length-2),collectionGroup:a[a.length-2],documentId:a[a.length-1],readTime:n.readTime||[0,0],unknownDocument:n.unknownDocument,noDocument:n.noDocument,document:n.document,hasCommittedMutations:!!n.hasCommittedMutations};r.push(i.put(s))})).next((()=>gn.waitFor(r)))}Pi(e,t){const n=t.store(Wn),r=cc(this.serializer),i=new Cc(Ic.ri,this.serializer.Tt);return n.G().next((e=>{const n=new Map;return e.forEach((e=>{var t;let r=null!==(t=n.get(e.userId))&&void 0!==t?t:ns();Ko(this.serializer,e).keys().forEach((e=>r=r.add(e))),n.set(e.userId,r)})),gn.forEach(n,((e,n)=>{const a=new mt(n),s=rl.It(this.serializer,a),o=i.getIndexManager(a),l=Vl.It(a,this.serializer,o,i.referenceDelegate);return new vc(r,l,s,o).recalculateAndSaveOverlaysForDocumentKeys(new Wr(t,Dn.ae),e).next()}))}))}}function Oc(e){e.createObjectStore(ur,{keyPath:hr}).createIndex(fr,dr,{unique:!0}),e.createObjectStore(or,{keyPath:"targetId"}).createIndex(lr,cr,{unique:!0}),e.createObjectStore(mr)}const Rc="IndexedDbPersistence",Pc=18e5,Lc=5e3,Mc="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Fc="main";class zc{constructor(e,t,n,r,i,a,s,o,l,c){let u=arguments.length>10&&void 0!==arguments[10]?arguments[10]:17;if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.Ti=i,this.window=a,this.document=s,this.Ii=l,this.Ei=c,this.di=u,this.Gr=null,this.zr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ai=null,this.inForeground=!1,this.Ri=null,this.Vi=null,this.mi=Number.NEGATIVE_INFINITY,this.fi=e=>Promise.resolve(),!zc.D())throw new Ct(_t.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new ac(this,r),this.gi=t+Fc,this.serializer=new Vo(o),this.pi=new bn(this.gi,this.di,new Dc(this.serializer)),this.jr=new al,this.Hr=new ql(this.referenceDelegate,this.serializer),this.remoteDocumentCache=cc(this.serializer),this.Yr=new el,this.window&&this.window.localStorage?this.yi=this.window.localStorage:(this.yi=null,!1===c&&wt(Rc,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Ct(_t.FAILED_PRECONDITION,Mc);return this.Si(),this.bi(),this.Di(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Hr.getHighestSequenceNumber(e)))})).then((e=>{this.Gr=new Dn(e,this.Ii)})).then((()=>{this.zr=!0})).catch((e=>(this.pi&&this.pi.close(),Promise.reject(e))))}Ci(e){return this.fi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.pi.k((async t=>{null===t.newVersion&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Ti.enqueueAndForget((async()=>{this.started&&await this.wi()})))}wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>jc(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Fi(e).next((e=>{e||(this.isPrimary=!1,this.Ti.enqueueRetryable((()=>this.fi(!1))))}))})).next((()=>this.Mi(e))).next((t=>this.isPrimary&&!t?this.xi(e).next((()=>!1)):!!t&&this.Oi(e).next((()=>!0)))))).catch((e=>{if(Sn(e))return bt(Rc,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return bt(Rc,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Ti.enqueueRetryable((()=>this.fi(e))),this.isPrimary=e}))}Fi(e){return Uc(e).get($n).next((e=>gn.resolve(this.Ni(e))))}Bi(e){return jc(e).delete(this.clientId)}async Li(){if(this.isPrimary&&!this.ki(this.mi,Pc)){this.mi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(e=>{const t=Gr(e,yr);return t.G().next((e=>{const n=this.qi(e,Pc),r=e.filter((e=>-1===n.indexOf(e)));return gn.forEach(r,(e=>t.delete(e.clientId))).next((()=>r))}))})).catch((()=>[]));if(this.yi)for(const t of e)this.yi.removeItem(this.Qi(t.clientId))}}Di(){this.Vi=this.Ti.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.wi().then((()=>this.Li())).then((()=>this.Di()))))}Ni(e){return!!e&&e.ownerId===this.clientId}Mi(e){return this.Ei?gn.resolve(!0):Uc(e).get($n).next((t=>{if(null!==t&&this.ki(t.leaseTimestampMs,Lc)&&!this.$i(t.ownerId)){if(this.Ni(t)&&this.networkEnabled)return!0;if(!this.Ni(t)){if(!t.allowTabSynchronization)throw new Ct(_t.FAILED_PRECONDITION,Mc);return!1}}return!(!this.networkEnabled||!this.inForeground)||jc(e).G().next((e=>void 0===this.qi(e,Lc).find((e=>{if(this.clientId!==e.clientId){const t=!this.networkEnabled&&e.networkEnabled,n=!this.inForeground&&e.inForeground,r=this.networkEnabled===e.networkEnabled;if(t||n&&r)return!0}return!1}))))})).next((e=>(this.isPrimary!==e&&bt(Rc,`Client ${e?"is":"is not"} eligible for a primary lease.`),e)))}async shutdown(){this.zr=!1,this.Ui(),this.Vi&&(this.Vi.cancel(),this.Vi=null),this.Ki(),this.Wi(),await this.pi.runTransaction("shutdown","readwrite",[Vn,yr],(e=>{const t=new Wr(e,Dn.ae);return this.xi(t).next((()=>this.Bi(t)))})),this.pi.close(),this.Gi()}qi(e,t){return e.filter((e=>this.ki(e.updateTimeMs,t)&&!this.$i(e.clientId)))}zi(){return this.runTransaction("getActiveClients","readonly",(e=>jc(e).G().next((e=>this.qi(e,Pc).map((e=>e.clientId))))))}get started(){return this.zr}getGlobalsCache(){return this.jr}getMutationQueue(e,t){return Vl.It(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Hr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Dl(e,this.serializer.Tt.databaseId)}getDocumentOverlayCache(e){return rl.It(this.serializer,e)}getBundleCache(){return this.Yr}runTransaction(e,t,n){bt(Rc,"Starting transaction:",e);const r="readonly"===t?"readonly":"readwrite",i=function(e){return 17===e?Hr:16===e?$r:15===e?Vr:14===e?Br:13===e?jr:12===e?Ur:11===e?zr:void St()}(this.di);let a;return this.pi.runTransaction(e,r,i,(r=>(a=new Wr(r,this.Gr?this.Gr.next():Dn.ae),"readwrite-primary"===t?this.Fi(a).next((e=>!!e||this.Mi(a))).next((t=>{if(!t)throw wt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ti.enqueueRetryable((()=>this.fi(!1))),new Ct(_t.FAILED_PRECONDITION,dn);return n(a)})).next((e=>this.Oi(a).next((()=>e)))):this.ji(a).next((()=>n(a)))))).then((e=>(a.raiseOnCommittedEvent(),e)))}ji(e){return Uc(e).get($n).next((e=>{if(null!==e&&this.ki(e.leaseTimestampMs,Lc)&&!this.$i(e.ownerId)&&!this.Ni(e)&&!(this.Ei||this.allowTabSynchronization&&e.allowTabSynchronization))throw new Ct(_t.FAILED_PRECONDITION,Mc)}))}Oi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Uc(e).put($n,t)}static D(){return bn.D()}xi(e){const t=Uc(e);return t.get($n).next((e=>this.Ni(e)?(bt(Rc,"Releasing primary lease."),t.delete($n)):gn.resolve()))}ki(e,t){const n=Date.now();return!(e<n-t)&&(!(e>n)||(wt(`Detected an update time that is in the future: ${e} > ${n}`),!1))}Si(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ri=()=>{this.Ti.enqueueAndForget((()=>(this.inForeground="visible"===this.document.visibilityState,this.wi())))},this.document.addEventListener("visibilitychange",this.Ri),this.inForeground="visible"===this.document.visibilityState)}Ki(){this.Ri&&(this.document.removeEventListener("visibilitychange",this.Ri),this.Ri=null)}bi(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Ai=()=>{this.Ui();const e=/(?:Version|Mobile)\/1[456]/;g()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Ti.enterRestrictedMode(!0),this.Ti.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Ai))}Wi(){this.Ai&&(this.window.removeEventListener("pagehide",this.Ai),this.Ai=null)}$i(e){var t;try{const n=null!==(null===(t=this.yi)||void 0===t?void 0:t.getItem(this.Qi(e)));return bt(Rc,`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(e){return wt(Rc,"Failed to get zombied client id.",e),!1}}Ui(){if(this.yi)try{this.yi.setItem(this.Qi(this.clientId),String(Date.now()))}catch(e){wt("Failed to set zombie client id.",e)}}Gi(){if(this.yi)try{this.yi.removeItem(this.Qi(this.clientId))}catch(e){}}Qi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Uc(e){return Gr(e,Vn)}function jc(e){return Gr(e,yr)}function Bc(e,t){let n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}class Vc{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Hi=n,this.Ji=r}static Yi(e,t){let n=ns(),r=ns();for(const i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new Vc(e,t.fromCache,n,r)}}class $c{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class Hc{constructor(){this.Zi=!1,this.Xi=!1,this.es=100,this.ts=g()?8:wn(m())>0?6:4}initialize(e,t){this.ns=e,this.indexManager=t,this.Zi=!0}getDocumentsMatchingQuery(e,t,n,r){const i={result:null};return this.rs(e,t).next((e=>{i.result=e})).next((()=>{if(!i.result)return this.ss(e,t,r,n).next((e=>{i.result=e}))})).next((()=>{if(i.result)return;const n=new $c;return this._s(e,t,n).next((r=>{if(i.result=r,this.Xi)return this.us(e,t,n,r.size)}))})).next((()=>i.result))}us(e,t,n,r){return n.documentReadCount<this.es?(yt()<=D.DEBUG&&bt("QueryEngine","SDK will not create cache indexes for query:",ja(t),"since it only creates cache indexes for collection contains","more than or equal to",this.es,"documents"),gn.resolve()):(yt()<=D.DEBUG&&bt("QueryEngine","Query:",ja(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.ts*r?(yt()<=D.DEBUG&&bt("QueryEngine","The SDK decides to create cache indexes for query:",ja(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,La(t))):gn.resolve())}rs(e,t){if(Oa(t))return gn.resolve(null);let n=La(t);return this.indexManager.getIndexType(e,n).next((r=>0===r?null:(null!==t.limit&&1===r&&(t=Fa(t,null,"F"),n=La(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((r=>{const i=ns(...r);return this.ns.getDocuments(e,i).next((r=>this.indexManager.getMinOffset(e,n).next((n=>{const a=this.cs(t,r);return this.ls(t,a,i,n.readTime)?this.rs(e,Fa(t,null,"F")):this.hs(e,a,t,n)}))))})))))}ss(e,t,n,r){return Oa(t)||r.isEqual(Yt.min())?gn.resolve(null):this.ns.getDocuments(e,n).next((i=>{const a=this.cs(t,i);return this.ls(t,a,n,r)?gn.resolve(null):(yt()<=D.DEBUG&&bt("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),ja(t)),this.hs(e,a,t,cn(r,nn)).next((e=>e)))}))}cs(e,t){let n=new Zr($a(e));return t.forEach(((t,r)=>{Ba(e,r)&&(n=n.add(r))})),n}ls(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}_s(e,t,n){return yt()<=D.DEBUG&&bt("QueryEngine","Using full collection scan to execute query:",ja(t)),this.ns.getDocumentsMatchingQuery(e,t,hn.min(),n)}hs(e,t,n,r){return this.ns.getDocumentsMatchingQuery(e,n,r).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}const Wc="LocalStore";class Gc{constructor(e,t,n,r){this.persistence=e,this.Ps=t,this.serializer=r,this.Ts=new Xr(jt),this.Is=new Wa((e=>Sa(e)),xa),this.Es=new Map,this.ds=e.getRemoteDocumentCache(),this.Hr=e.getTargetCache(),this.Yr=e.getBundleCache(),this.As(n)}As(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new vc(this.ds,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ds.setIndexManager(this.indexManager),this.Ps.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ts)))}}function Kc(e,t,n,r){return new Gc(e,t,n,r)}async function qc(e,t){const n=kt(e);return await n.persistence.runTransaction("Handle user change","readonly",(e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next((i=>(r=i,n.As(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{const i=[],a=[];let s=ns();for(const e of r){i.push(e.batchId);for(const t of e.mutations)s=s.add(t.key)}for(const e of t){a.push(e.batchId);for(const t of e.mutations)s=s.add(t.key)}return n.localDocuments.getDocuments(e,s).next((e=>({Rs:e,removedBatchIds:i,addedBatchIds:a})))}))}))}function Yc(e){const t=kt(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Hr.getLastRemoteSnapshotVersion(e)))}function Xc(e,t,n){let r=ns(),i=ns();return n.forEach((e=>r=r.add(e))),t.getEntries(e,r).next((e=>{let r=Ka();return n.forEach(((n,a)=>{const s=e.get(n);a.isFoundDocument()!==s.isFoundDocument()&&(i=i.add(n)),a.isNoDocument()&&a.version.isEqual(Yt.min())?(t.removeEntry(n,a.readTime),r=r.insert(n,a)):!s.isValidDocument()||a.version.compareTo(s.version)>0||0===a.version.compareTo(s.version)&&s.hasPendingWrites?(t.addEntry(a),r=r.insert(n,a)):bt(Wc,"Ignoring outdated watch update for ",n,". Current version:",s.version," Watch version:",a.version)})),{Vs:r,fs:i}}))}function Qc(e,t){const n=kt(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=On),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}function Jc(e,t){const n=kt(e);return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let r;return n.Hr.getTargetData(e,t).next((i=>i?(r=i,gn.resolve(r)):n.Hr.allocateTargetId(e).next((i=>(r=new Bo(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.Hr.addTargetData(e,r).next((()=>r)))))))})).then((e=>{const r=n.Ts.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ts=n.Ts.insert(e.targetId,e),n.Is.set(t,e.targetId)),e}))}async function Zc(e,t,n){const r=kt(e),i=r.Ts.get(t),a=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",a,(e=>r.persistence.referenceDelegate.removeTarget(e,i)))}catch(e){if(!Sn(e))throw e;bt(Wc,`Failed to update sequence numbers for target ${t}: ${e}`)}r.Ts=r.Ts.remove(t),r.Is.delete(i.target)}function eu(e,t,n){const r=kt(e);let i=Yt.min(),a=ns();return r.persistence.runTransaction("Execute query","readwrite",(e=>function(e,t,n){const r=kt(e),i=r.Is.get(n);return void 0!==i?gn.resolve(r.Ts.get(i)):r.Hr.getTargetData(t,n)}(r,e,La(t)).next((t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.Hr.getMatchingKeysForTargetId(e,t.targetId).next((e=>{a=e}))})).next((()=>r.Ps.getDocumentsMatchingQuery(e,t,n?i:Yt.min(),n?a:ns()))).next((e=>(tu(r,Va(t),e),{documents:e,gs:a})))))}function tu(e,t,n){let r=e.Es.get(t)||Yt.min();n.forEach(((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.Es.set(t,r)}class nu{constructor(){this.activeTargetIds=is()}Ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}vs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}bs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class ru{constructor(){this.ho=new nu,this.Po={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.ho.Ds(e),this.Po[e]||"not-current"}updateQueryState(e,t,n){this.Po[e]=t}removeLocalQueryTarget(e){this.ho.vs(e)}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){delete this.Po[e]}getAllActiveQueryTargets(){return this.ho.activeTargetIds}isActiveQueryTarget(e){return this.ho.activeTargetIds.has(e)}start(){return this.ho=new nu,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class iu{To(e){}shutdown(){}}const au="ConnectivityMonitor";class su{constructor(){this.Io=()=>this.Eo(),this.Ao=()=>this.Ro(),this.Vo=[],this.mo()}To(e){this.Vo.push(e)}shutdown(){window.removeEventListener("online",this.Io),window.removeEventListener("offline",this.Ao)}mo(){window.addEventListener("online",this.Io),window.addEventListener("offline",this.Ao)}Eo(){bt(au,"Network connectivity changed: AVAILABLE");for(const e of this.Vo)e(0)}Ro(){bt(au,"Network connectivity changed: UNAVAILABLE");for(const e of this.Vo)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let ou=null;function lu(){return null===ou?ou=268435456+Math.round(2147483648*Math.random()):ou++,"0x"+ou.toString(16)}const cu="RestConnection",uu={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class hu{get fo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.po=t+"://"+e.host,this.yo=`projects/${n}/databases/${r}`,this.wo=this.databaseId.database===vi?`project_id=${n}`:`project_id=${n}&database_id=${r}`}So(e,t,n,r,i){const a=lu(),s=this.bo(e,t.toUriEncodedString());bt(cu,`Sending RPC '${e}' ${a}:`,s,n);const o={"google-cloud-resource-prefix":this.yo,"x-goog-request-params":this.wo};return this.Do(o,r,i),this.vo(e,s,o,n).then((t=>(bt(cu,`Received RPC '${e}' ${a}: `,t),t)),(t=>{throw Tt(cu,`RPC '${e}' ${a} failed with error: `,t,"url: ",s,"request:",n),t}))}Co(e,t,n,r,i,a){return this.So(e,t,n,r,i)}Do(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+gt,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}bo(e,t){const n=uu[e];return`${this.po}/v1/${t}:${n}`}terminate(){}}class fu{constructor(e){this.Fo=e.Fo,this.Mo=e.Mo}xo(e){this.Oo=e}No(e){this.Bo=e}Lo(e){this.ko=e}onMessage(e){this.qo=e}close(){this.Mo()}send(e){this.Fo(e)}Qo(){this.Oo()}$o(){this.Bo()}Uo(e){this.ko(e)}Ko(e){this.qo(e)}}const du="WebChannelConnection";class pu extends hu{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}vo(e,t,n,r){const i=lu();return new Promise(((a,s)=>{const o=new rt;o.setWithCredentials(!0),o.listenOnce(at.COMPLETE,(()=>{try{switch(o.getLastErrorCode()){case st.NO_ERROR:const t=o.getResponseJson();bt(du,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(t)),a(t);break;case st.TIMEOUT:bt(du,`RPC '${e}' ${i} timed out`),s(new Ct(_t.DEADLINE_EXCEEDED,"Request time out"));break;case st.HTTP_ERROR:const n=o.getStatus();if(bt(du,`RPC '${e}' ${i} failed with status:`,n,"response text:",o.getResponseText()),n>0){let e=o.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(_t).indexOf(t)>=0?t:_t.UNKNOWN}(t.status);s(new Ct(e,t.message))}else s(new Ct(_t.UNKNOWN,"Server responded with status "+o.getStatus()))}else s(new Ct(_t.UNAVAILABLE,"Connection failed."));break;default:St()}}finally{bt(du,`RPC '${e}' ${i} completed.`)}}));const l=JSON.stringify(r);bt(du,`RPC '${e}' ${i} sending request:`,r),o.send(t,"POST",l,n,15)}))}Wo(e,t,n){const r=lu(),i=[this.po,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=ut(),s=ct(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(o.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(o.useFetchStreams=!0),this.Do(o.initMessageHeaders,t,n),o.encodeInitMessageHeaders=!0;const c=i.join("");bt(du,`Creating RPC '${e}' stream ${r}: ${c}`,o);const u=a.createWebChannel(c,o);let h=!1,f=!1;const d=new fu({Fo:t=>{f?bt(du,`Not sending because RPC '${e}' stream ${r} is closed:`,t):(h||(bt(du,`Opening RPC '${e}' stream ${r} transport.`),u.open(),h=!0),bt(du,`RPC '${e}' stream ${r} sending:`,t),u.send(t))},Mo:()=>u.close()}),p=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return p(u,it.EventType.OPEN,(()=>{f||(bt(du,`RPC '${e}' stream ${r} transport opened.`),d.Qo())})),p(u,it.EventType.CLOSE,(()=>{f||(f=!0,bt(du,`RPC '${e}' stream ${r} transport closed`),d.Uo())})),p(u,it.EventType.ERROR,(t=>{f||(f=!0,Tt(du,`RPC '${e}' stream ${r} transport errored:`,t),d.Uo(new Ct(_t.UNAVAILABLE,"The operation could not be completed")))})),p(u,it.EventType.MESSAGE,(t=>{var n;if(!f){const i=t.data[0];xt(!!i);const a=i,s=(null==a?void 0:a.error)||(null===(n=a[0])||void 0===n?void 0:n.error);if(s){bt(du,`RPC '${e}' stream ${r} received error:`,s);const t=s.status;let n=function(e){const t=Bs[e];if(void 0!==t)return Hs(t)}(t),i=s.message;void 0===n&&(n=_t.INTERNAL,i="Unknown error status: "+t+" with message "+s.message),f=!0,d.Uo(new Ct(n,i)),u.close()}else bt(du,`RPC '${e}' stream ${r} received:`,i),d.Ko(i)}})),p(s,lt.STAT_EVENT,(t=>{t.stat===ot.PROXY?bt(du,`RPC '${e}' stream ${r} detected buffering proxy`):t.stat===ot.NOPROXY&&bt(du,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{d.$o()}),0),d}}function mu(){return"undefined"!=typeof window?window:null}function gu(){return"undefined"!=typeof document?document:null}function vu(e){return new co(e,!0)}class yu{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.Ti=e,this.timerId=t,this.Go=n,this.zo=r,this.jo=i,this.Ho=0,this.Jo=null,this.Yo=Date.now(),this.reset()}reset(){this.Ho=0}Zo(){this.Ho=this.jo}Xo(e){this.cancel();const t=Math.floor(this.Ho+this.e_()),n=Math.max(0,Date.now()-this.Yo),r=Math.max(0,t-n);r>0&&bt("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Ho} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Jo=this.Ti.enqueueAfterDelay(this.timerId,r,(()=>(this.Yo=Date.now(),e()))),this.Ho*=this.zo,this.Ho<this.Go&&(this.Ho=this.Go),this.Ho>this.jo&&(this.Ho=this.jo)}t_(){null!==this.Jo&&(this.Jo.skipDelay(),this.Jo=null)}cancel(){null!==this.Jo&&(this.Jo.cancel(),this.Jo=null)}e_(){return(Math.random()-.5)*this.Ho}}const bu="PersistentStream";class wu{constructor(e,t,n,r,i,a,s,o){this.Ti=e,this.n_=n,this.r_=r,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=s,this.listener=o,this.state=0,this.i_=0,this.s_=null,this.o_=null,this.stream=null,this.__=0,this.a_=new yu(e,t)}u_(){return 1===this.state||5===this.state||this.c_()}c_(){return 2===this.state||3===this.state}start(){this.__=0,4!==this.state?this.auth():this.l_()}async stop(){this.u_()&&await this.close(0)}h_(){this.state=0,this.a_.reset()}P_(){this.c_()&&null===this.s_&&(this.s_=this.Ti.enqueueAfterDelay(this.n_,6e4,(()=>this.T_())))}I_(e){this.E_(),this.stream.send(e)}async T_(){if(this.c_())return this.close(0)}E_(){this.s_&&(this.s_.cancel(),this.s_=null)}d_(){this.o_&&(this.o_.cancel(),this.o_=null)}async close(e,t){this.E_(),this.d_(),this.a_.cancel(),this.i_++,4!==e?this.a_.reset():t&&t.code===_t.RESOURCE_EXHAUSTED?(wt(t.toString()),wt("Using maximum backoff delay to prevent overloading the backend."),this.a_.Zo()):t&&t.code===_t.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.A_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Lo(t)}A_(){}auth(){this.state=1;const e=this.R_(this.i_),t=this.i_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((e=>{let[n,r]=e;this.i_===t&&this.V_(n,r)}),(t=>{e((()=>{const e=new Ct(_t.UNKNOWN,"Fetching auth token failed: "+t.message);return this.m_(e)}))}))}V_(e,t){const n=this.R_(this.i_);this.stream=this.f_(e,t),this.stream.xo((()=>{n((()=>this.listener.xo()))})),this.stream.No((()=>{n((()=>(this.state=2,this.o_=this.Ti.enqueueAfterDelay(this.r_,1e4,(()=>(this.c_()&&(this.state=3),Promise.resolve()))),this.listener.No())))})),this.stream.Lo((e=>{n((()=>this.m_(e)))})),this.stream.onMessage((e=>{n((()=>1==++this.__?this.g_(e):this.onNext(e)))}))}l_(){this.state=5,this.a_.Xo((async()=>{this.state=0,this.start()}))}m_(e){return bt(bu,`close with error: ${e}`),this.stream=null,this.close(4,e)}R_(e){return t=>{this.Ti.enqueueAndForget((()=>this.i_===e?t():(bt(bu,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Tu extends wu{constructor(e,t,n,r,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,a),this.serializer=i}f_(e,t){return this.connection.Wo("Listen",e,t)}g_(e){return this.onNext(e)}onNext(e){this.a_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:St()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],a=function(e,t){return e.useProto3Json?(xt(void 0===t||"string"==typeof t),ii.fromBase64String(t||"")):(xt(void 0===t||t instanceof Buffer||t instanceof Uint8Array),ii.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),s=t.targetChange.cause,o=s&&function(e){const t=void 0===e.code?_t.UNKNOWN:Hs(e.code);return new Ct(t,e.message||"")}(s);n=new to(r,i,a,o||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=wo(e,r.document.name),a=mo(r.document.updateTime),s=r.document.createTime?mo(r.document.createTime):Yt.min(),o=new qi({mapValue:{fields:r.document.fields}}),l=Xi.newFoundDocument(i,a,s,o),c=r.targetIds||[],u=r.removedTargetIds||[];n=new Zs(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=wo(e,r.document),a=r.readTime?mo(r.readTime):Yt.min(),s=Xi.newNoDocument(i,a),o=r.removedTargetIds||[];n=new Zs([],o,s.key,s)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=wo(e,r.document),a=r.removedTargetIds||[];n=new Zs([],a,i,null)}else{if(!("filter"in t))return St();{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:i}=e,a=new js(r,i),s=e.targetId;n=new eo(s,a)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return Yt.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?Yt.min():t.readTime?mo(t.readTime):Yt.min()}(e);return this.listener.p_(t,n)}y_(e){const t={};t.database=So(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=ka(r)?{documents:Io(e,r)}:{query:No(e,r).ht},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=fo(e,t.resumeToken);const r=uo(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(Yt.min())>0){n.readTime=ho(e,t.snapshotVersion.toTimestamp());const r=uo(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return St()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.I_(t)}w_(e){const t={};t.database=So(this.serializer),t.removeTarget=e,this.I_(t)}}class Eu extends wu{constructor(e,t,n,r,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,a),this.serializer=i}get S_(){return this.__>0}start(){this.lastStreamToken=void 0,super.start()}A_(){this.S_&&this.b_([])}f_(e,t){return this.connection.Wo("Write",e,t)}g_(e){return xt(!!e.streamToken),this.lastStreamToken=e.streamToken,xt(!e.writeResults||0===e.writeResults.length),this.listener.D_()}onNext(e){xt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.a_.reset();const t=function(e,t){return e&&e.length>0?(xt(void 0!==t),e.map((e=>function(e,t){let n=e.updateTime?mo(e.updateTime):mo(t);return n.isEqual(Yt.min())&&(n=mo(t)),new Ts(n,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),n=mo(e.commitTime);return this.listener.v_(n,t)}C_(){const e={};e.database=So(this.serializer),this.I_(e)}b_(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>Co(this.serializer,e)))};this.I_(t)}}class Su{}class xu extends Su{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.F_=!1}M_(){if(this.F_)throw new Ct(_t.FAILED_PRECONDITION,"The client has already been terminated.")}So(e,t,n,r){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((i=>{let[a,s]=i;return this.connection.So(e,vo(t,n),r,a,s)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===_t.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Ct(_t.UNKNOWN,e.toString())}))}Co(e,t,n,r,i){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((a=>{let[s,o]=a;return this.connection.Co(e,vo(t,n),r,s,o,i)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===_t.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Ct(_t.UNKNOWN,e.toString())}))}terminate(){this.F_=!0,this.connection.terminate()}}class ku{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.x_=0,this.O_=null,this.N_=!0}B_(){0===this.x_&&(this.L_("Unknown"),this.O_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.O_=null,this.k_("Backend didn't respond within 10 seconds."),this.L_("Offline"),Promise.resolve()))))}q_(e){"Online"===this.state?this.L_("Unknown"):(this.x_++,this.x_>=1&&(this.Q_(),this.k_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.L_("Offline")))}set(e){this.Q_(),this.x_=0,"Online"===e&&(this.N_=!1),this.L_(e)}L_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}k_(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.N_?(wt(t),this.N_=!1):bt("OnlineStateTracker",t)}Q_(){null!==this.O_&&(this.O_.cancel(),this.O_=null)}}const _u="RemoteStore";class Cu{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.U_=[],this.K_=new Map,this.W_=new Set,this.G_=[],this.z_=i,this.z_.To((e=>{n.enqueueAndForget((async()=>{Mu(this)&&(bt(_u,"Restarting streams for network reachability change."),await async function(e){const t=kt(e);t.W_.add(4),await Iu(t),t.j_.set("Unknown"),t.W_.delete(4),await Au(t)}(this))}))})),this.j_=new ku(n,r)}}async function Au(e){if(Mu(e))for(const t of e.G_)await t(!0)}async function Iu(e){for(const t of e.G_)await t(!1)}function Nu(e,t){const n=kt(e);n.K_.has(t.targetId)||(n.K_.set(t.targetId,t),Lu(n)?Pu(n):th(n).c_()&&Ou(n,t))}function Du(e,t){const n=kt(e),r=th(n);n.K_.delete(t),r.c_()&&Ru(n,t),0===n.K_.size&&(r.c_()?r.P_():Mu(n)&&n.j_.set("Unknown"))}function Ou(e,t){if(e.H_.Ne(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Yt.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}th(e).y_(t)}function Ru(e,t){e.H_.Ne(t),th(e).w_(t)}function Pu(e){e.H_=new ro({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),lt:t=>e.K_.get(t)||null,it:()=>e.datastore.serializer.databaseId}),th(e).start(),e.j_.B_()}function Lu(e){return Mu(e)&&!th(e).u_()&&e.K_.size>0}function Mu(e){return 0===kt(e).W_.size}function Fu(e){e.H_=void 0}async function zu(e){e.j_.set("Online")}async function Uu(e){e.K_.forEach(((t,n)=>{Ou(e,t)}))}async function ju(e,t){Fu(e),Lu(e)?(e.j_.q_(t),Pu(e)):e.j_.set("Unknown")}async function Bu(e,t,n){if(e.j_.set("Online"),t instanceof to&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.K_.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.K_.delete(r),e.H_.removeTarget(r))}(e,t)}catch(n){bt(_u,"Failed to remove targets %s: %s ",t.targetIds.join(","),n),await Vu(e,n)}else if(t instanceof Zs?e.H_.We(t):t instanceof eo?e.H_.Ze(t):e.H_.je(t),!n.isEqual(Yt.min()))try{const t=await Yc(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.H_.ot(t);return n.targetChanges.forEach(((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.K_.get(r);i&&e.K_.set(r,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach(((t,n)=>{const r=e.K_.get(t);if(!r)return;e.K_.set(t,r.withResumeToken(ii.EMPTY_BYTE_STRING,r.snapshotVersion)),Ru(e,t);const i=new Bo(r.target,t,n,r.sequenceNumber);Ou(e,i)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){bt(_u,"Failed to raise snapshot:",t),await Vu(e,t)}}async function Vu(e,t,n){if(!Sn(t))throw t;e.W_.add(1),await Iu(e),e.j_.set("Offline"),n||(n=()=>Yc(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{bt(_u,"Retrying IndexedDB access"),await n(),e.W_.delete(1),await Au(e)}))}function $u(e,t){return t().catch((n=>Vu(e,n,t)))}async function Hu(e){const t=kt(e),n=nh(t);let r=t.U_.length>0?t.U_[t.U_.length-1].batchId:On;for(;Wu(t);)try{const e=await Qc(t.localStore,r);if(null===e){0===t.U_.length&&n.P_();break}r=e.batchId,Gu(t,e)}catch(e){await Vu(t,e)}Ku(t)&&qu(t)}function Wu(e){return Mu(e)&&e.U_.length<10}function Gu(e,t){e.U_.push(t);const n=nh(e);n.c_()&&n.S_&&n.b_(t.mutations)}function Ku(e){return Mu(e)&&!nh(e).u_()&&e.U_.length>0}function qu(e){nh(e).start()}async function Yu(e){nh(e).C_()}async function Xu(e){const t=nh(e);for(const n of e.U_)t.b_(n.mutations)}async function Qu(e,t,n){const r=e.U_.shift(),i=zs.from(r,t,n);await $u(e,(()=>e.remoteSyncer.applySuccessfulWrite(i))),await Hu(e)}async function Ju(e,t){t&&nh(e).S_&&await async function(e,t){if(function(e){return $s(e)&&e!==_t.ABORTED}(t.code)){const n=e.U_.shift();nh(e).h_(),await $u(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await Hu(e)}}(e,t),Ku(e)&&qu(e)}async function Zu(e,t){const n=kt(e);n.asyncQueue.verifyOperationInProgress(),bt(_u,"RemoteStore received new credentials");const r=Mu(n);n.W_.add(3),await Iu(n),r&&n.j_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.W_.delete(3),await Au(n)}async function eh(e,t){const n=kt(e);t?(n.W_.delete(2),await Au(n)):t||(n.W_.add(2),await Iu(n),n.j_.set("Unknown"))}function th(e){return e.J_||(e.J_=function(e,t,n){const r=kt(e);return r.M_(),new Tu(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{xo:zu.bind(null,e),No:Uu.bind(null,e),Lo:ju.bind(null,e),p_:Bu.bind(null,e)}),e.G_.push((async t=>{t?(e.J_.h_(),Lu(e)?Pu(e):e.j_.set("Unknown")):(await e.J_.stop(),Fu(e))}))),e.J_}function nh(e){return e.Y_||(e.Y_=function(e,t,n){const r=kt(e);return r.M_(),new Eu(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{xo:()=>Promise.resolve(),No:Yu.bind(null,e),Lo:Ju.bind(null,e),D_:Xu.bind(null,e),v_:Qu.bind(null,e)}),e.G_.push((async t=>{t?(e.Y_.h_(),await Hu(e)):(await e.Y_.stop(),e.U_.length>0&&(bt(_u,`Stopping write stream with ${e.U_.length} pending writes`),e.U_=[]))}))),e.Y_}class rh{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new At,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,i){const a=Date.now()+n,s=new rh(e,t,a,r,i);return s.start(n),s}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Ct(_t.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ih(e,t){if(wt("AsyncQueue",`${t}: ${e}`),Sn(e))return new Ct(_t.UNAVAILABLE,`${t}: ${e}`);throw e}class ah{static emptySet(e){return new ah(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||tn.comparator(t.key,n.key):(e,t)=>tn.comparator(e.key,t.key),this.keyedMap=Ya(),this.sortedSet=new Xr(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof ah))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new ah;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class sh{constructor(){this.Z_=new Xr(tn.comparator)}track(e){const t=e.doc.key,n=this.Z_.get(t);n?0!==e.type&&3===n.type?this.Z_=this.Z_.insert(t,e):3===e.type&&1!==n.type?this.Z_=this.Z_.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Z_=this.Z_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Z_=this.Z_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Z_=this.Z_.remove(t):1===e.type&&2===n.type?this.Z_=this.Z_.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Z_=this.Z_.insert(t,{type:2,doc:e.doc}):St():this.Z_=this.Z_.insert(t,e)}X_(){const e=[];return this.Z_.inorderTraversal(((t,n)=>{e.push(n)})),e}}class oh{constructor(e,t,n,r,i,a,s,o,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=s,this.excludesMetadataChanges=o,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,r,i){const a=[];return t.forEach((e=>{a.push({type:0,doc:e})})),new oh(e,t,ah.emptySet(t),a,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&za(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class lh{constructor(){this.ea=void 0,this.ta=[]}na(){return this.ta.some((e=>e.ra()))}}class ch{constructor(){this.queries=uh(),this.onlineState="Unknown",this.ia=new Set}terminate(){!function(e,t){const n=kt(e),r=n.queries;n.queries=uh(),r.forEach(((e,n)=>{for(const r of n.ta)r.onError(t)}))}(this,new Ct(_t.ABORTED,"Firestore shutting down"))}}function uh(){return new Wa((e=>Ua(e)),za)}async function hh(e,t){const n=kt(e);let r=3;const i=t.query;let a=n.queries.get(i);a?!a.na()&&t.ra()&&(r=2):(a=new lh,r=t.ra()?0:1);try{switch(r){case 0:a.ea=await n.onListen(i,!0);break;case 1:a.ea=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(e){const n=ih(e,`Initialization of query '${ja(t.query)}' failed`);return void t.onError(n)}n.queries.set(i,a),a.ta.push(t),t.sa(n.onlineState),a.ea&&t.oa(a.ea)&&mh(n)}async function fh(e,t){const n=kt(e),r=t.query;let i=3;const a=n.queries.get(r);if(a){const e=a.ta.indexOf(t);e>=0&&(a.ta.splice(e,1),0===a.ta.length?i=t.ra()?0:1:!a.na()&&t.ra()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function dh(e,t){const n=kt(e);let r=!1;for(const i of t){const e=i.query,t=n.queries.get(e);if(t){for(const e of t.ta)e.oa(i)&&(r=!0);t.ea=i}}r&&mh(n)}function ph(e,t,n){const r=kt(e),i=r.queries.get(t);if(i)for(const a of i.ta)a.onError(n);r.queries.delete(t)}function mh(e){e.ia.forEach((e=>{e.next()}))}var gh,vh;(vh=gh||(gh={}))._a="default",vh.Cache="cache";class yh{constructor(e,t,n){this.query=e,this.aa=t,this.ua=!1,this.ca=null,this.onlineState="Unknown",this.options=n||{}}oa(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new oh(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.ua?this.la(e)&&(this.aa.next(e),t=!0):this.ha(e,this.onlineState)&&(this.Pa(e),t=!0),this.ca=e,t}onError(e){this.aa.error(e)}sa(e){this.onlineState=e;let t=!1;return this.ca&&!this.ua&&this.ha(this.ca,e)&&(this.Pa(this.ca),t=!0),t}ha(e,t){if(!e.fromCache)return!0;if(!this.ra())return!0;const n="Offline"!==t;return(!this.options.Ta||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}la(e){if(e.docChanges.length>0)return!0;const t=this.ca&&this.ca.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}Pa(e){e=oh.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ua=!0,this.aa.next(e)}ra(){return this.options.source!==gh.Cache}}class bh{constructor(e){this.key=e}}class wh{constructor(e){this.key=e}}class Th{constructor(e,t){this.query=e,this.fa=t,this.ga=null,this.hasCachedResults=!1,this.current=!1,this.pa=ns(),this.mutatedKeys=ns(),this.ya=$a(e),this.wa=new ah(this.ya)}get Sa(){return this.fa}ba(e,t){const n=t?t.Da:new sh,r=t?t.wa:this.wa;let i=t?t.mutatedKeys:this.mutatedKeys,a=r,s=!1;const o="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((e,t)=>{const c=r.get(e),u=Ba(this.query,t)?t:null,h=!!c&&this.mutatedKeys.has(c.key),f=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let d=!1;c&&u?c.data.isEqual(u.data)?h!==f&&(n.track({type:3,doc:u}),d=!0):this.va(c,u)||(n.track({type:2,doc:u}),d=!0,(o&&this.ya(u,o)>0||l&&this.ya(u,l)<0)&&(s=!0)):!c&&u?(n.track({type:0,doc:u}),d=!0):c&&!u&&(n.track({type:1,doc:c}),d=!0,(o||l)&&(s=!0)),d&&(u?(a=a.add(u),i=f?i.add(e):i.delete(e)):(a=a.delete(e),i=i.delete(e)))})),null!==this.query.limit)for(;a.size>this.query.limit;){const e="F"===this.query.limitType?a.last():a.first();a=a.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{wa:a,Da:n,ls:s,mutatedKeys:i}}va(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const i=this.wa;this.wa=e.wa,this.mutatedKeys=e.mutatedKeys;const a=e.Da.X_();a.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return St()}};return n(e)-n(t)}(e.type,t.type)||this.ya(e.doc,t.doc))),this.Ca(n),r=null!=r&&r;const s=t&&!r?this.Fa():[],o=0===this.pa.size&&this.current&&!r?1:0,l=o!==this.ga;return this.ga=o,0!==a.length||l?{snapshot:new oh(this.query,e.wa,i,a,e.mutatedKeys,0===o,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),Ma:s}:{Ma:s}}sa(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({wa:this.wa,Da:new sh,mutatedKeys:this.mutatedKeys,ls:!1},!1)):{Ma:[]}}xa(e){return!this.fa.has(e)&&!!this.wa.has(e)&&!this.wa.get(e).hasLocalMutations}Ca(e){e&&(e.addedDocuments.forEach((e=>this.fa=this.fa.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.fa=this.fa.delete(e))),this.current=e.current)}Fa(){if(!this.current)return[];const e=this.pa;this.pa=ns(),this.wa.forEach((e=>{this.xa(e.key)&&(this.pa=this.pa.add(e.key))}));const t=[];return e.forEach((e=>{this.pa.has(e)||t.push(new wh(e))})),this.pa.forEach((n=>{e.has(n)||t.push(new bh(n))})),t}Oa(e){this.fa=e.gs,this.pa=ns();const t=this.ba(e.documents);return this.applyChanges(t,!0)}Na(){return oh.fromInitialDocuments(this.query,this.wa,this.mutatedKeys,0===this.ga,this.hasCachedResults)}}const Eh="SyncEngine";class Sh{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class xh{constructor(e){this.key=e,this.Ba=!1}}class kh{constructor(e,t,n,r,i,a){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.La={},this.ka=new Wa((e=>Ua(e)),za),this.qa=new Map,this.Qa=new Set,this.$a=new Xr(tn.comparator),this.Ua=new Map,this.Ka=new Tc,this.Wa={},this.Ga=new Map,this.za=Kl.Kn(),this.onlineState="Unknown",this.ja=void 0}get isPrimaryClient(){return!0===this.ja}}async function _h(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=Kh(e);let i;const a=r.ka.get(t);return a?(r.sharedClientState.addLocalQueryTarget(a.targetId),i=a.view.Na()):i=await Ah(r,t,n,!0),i}async function Ch(e,t){const n=Kh(e);await Ah(n,t,!0,!1)}async function Ah(e,t,n,r){const i=await Jc(e.localStore,La(t)),a=i.targetId,s=e.sharedClientState.addLocalQueryTarget(a,n);let o;return r&&(o=await Ih(e,t,a,"current"===s,i.resumeToken)),e.isPrimaryClient&&n&&Nu(e.remoteStore,i),o}async function Ih(e,t,n,r,i){e.Ha=(t,n,r)=>async function(e,t,n,r){let i=t.view.ba(n);i.ls&&(i=await eu(e.localStore,t.query,!1).then((e=>{let{documents:n}=e;return t.view.ba(n,i)})));const a=r&&r.targetChanges.get(t.targetId),s=r&&null!=r.targetMismatches.get(t.targetId),o=t.view.applyChanges(i,e.isPrimaryClient,a,s);return Bh(e,t.targetId,o.Ma),o.snapshot}(e,t,n,r);const a=await eu(e.localStore,t,!0),s=new Th(t,a.gs),o=s.ba(a.documents),l=Js.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),c=s.applyChanges(o,e.isPrimaryClient,l);Bh(e,n,c.Ma);const u=new Sh(t,n,s);return e.ka.set(t,u),e.qa.has(n)?e.qa.get(n).push(t):e.qa.set(n,[t]),c.snapshot}async function Nh(e,t,n){const r=kt(e),i=r.ka.get(t),a=r.qa.get(i.targetId);if(a.length>1)return r.qa.set(i.targetId,a.filter((e=>!za(e,t)))),void r.ka.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Zc(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Du(r.remoteStore,i.targetId),Uh(r,i.targetId)})).catch(mn)):(Uh(r,i.targetId),await Zc(r.localStore,i.targetId,!0))}async function Dh(e,t){const n=kt(e),r=n.ka.get(t),i=n.qa.get(r.targetId);n.isPrimaryClient&&1===i.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Du(n.remoteStore,r.targetId))}async function Oh(e,t){const n=kt(e);try{const e=await function(e,t){const n=kt(e),r=t.snapshotVersion;let i=n.Ts;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const a=n.ds.newChangeBuffer({trackRemovals:!0});i=n.Ts;const s=[];t.targetChanges.forEach(((a,o)=>{const l=i.get(o);if(!l)return;s.push(n.Hr.removeMatchingKeys(e,a.removedDocuments,o).next((()=>n.Hr.addMatchingKeys(e,a.addedDocuments,o))));let c=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(o)?c=c.withResumeToken(ii.EMPTY_BYTE_STRING,Yt.min()).withLastLimboFreeSnapshotVersion(Yt.min()):a.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(a.resumeToken,r)),i=i.insert(o,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(l,c,a)&&s.push(n.Hr.updateTargetData(e,c))}));let o=Ka(),l=ns();if(t.documentUpdates.forEach((r=>{t.resolvedLimboDocuments.has(r)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),s.push(Xc(e,a,t.documentUpdates).next((e=>{o=e.Vs,l=e.fs}))),!r.isEqual(Yt.min())){const t=n.Hr.getLastRemoteSnapshotVersion(e).next((t=>n.Hr.setTargetsMetadata(e,e.currentSequenceNumber,r)));s.push(t)}return gn.waitFor(s).next((()=>a.apply(e))).next((()=>n.localDocuments.getLocalViewOfDocuments(e,o,l))).next((()=>o))})).then((e=>(n.Ts=i,e)))}(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const r=n.Ua.get(t);r&&(xt(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.Ba=!0:e.modifiedDocuments.size>0?xt(r.Ba):e.removedDocuments.size>0&&(xt(r.Ba),r.Ba=!1))})),await Hh(n,e,t)}catch(e){await mn(e)}}function Rh(e,t,n){const r=kt(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.ka.forEach(((n,r)=>{const i=r.view.sa(t);i.snapshot&&e.push(i.snapshot)})),function(e,t){const n=kt(e);n.onlineState=t;let r=!1;n.queries.forEach(((e,n)=>{for(const i of n.ta)i.sa(t)&&(r=!0)})),r&&mh(n)}(r.eventManager,t),e.length&&r.La.p_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function Ph(e,t,n){const r=kt(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Ua.get(t),a=i&&i.key;if(a){let e=new Xr(tn.comparator);e=e.insert(a,Xi.newNoDocument(a,Yt.min()));const n=ns().add(a),i=new Qs(Yt.min(),new Map,new Xr(jt),e,n);await Oh(r,i),r.$a=r.$a.remove(a),r.Ua.delete(t),$h(r)}else await Zc(r.localStore,t,!1).then((()=>Uh(r,t,n))).catch(mn)}async function Lh(e,t){const n=kt(e),r=t.batch.batchId;try{const e=await function(e,t){const n=kt(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const r=t.batch.keys(),i=n.ds.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,a=i.keys();let s=gn.resolve();return a.forEach((e=>{s=s.next((()=>r.getEntry(t,e))).next((t=>{const a=n.docVersions.get(e);xt(null!==a),t.version.compareTo(a)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),s.next((()=>e.mutationQueue.removeMutationBatch(t,i)))}(n,e,t,i).next((()=>i.apply(e))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=ns();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t)))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(n.localStore,t);zh(n,r,null),Fh(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Hh(n,e)}catch(e){await mn(e)}}async function Mh(e,t,n){const r=kt(e);try{const e=await function(e,t){const n=kt(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next((t=>(xt(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(r.localStore,t);zh(r,t,n),Fh(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await Hh(r,e)}catch(n){await mn(n)}}function Fh(e,t){(e.Ga.get(t)||[]).forEach((e=>{e.resolve()})),e.Ga.delete(t)}function zh(e,t,n){const r=kt(e);let i=r.Wa[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.Wa[r.currentUser.toKey()]=i}}function Uh(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.qa.get(t))e.ka.delete(r),n&&e.La.Ja(r,n);e.qa.delete(t),e.isPrimaryClient&&e.Ka.br(t).forEach((t=>{e.Ka.containsKey(t)||jh(e,t)}))}function jh(e,t){e.Qa.delete(t.path.canonicalString());const n=e.$a.get(t);null!==n&&(Du(e.remoteStore,n),e.$a=e.$a.remove(t),e.Ua.delete(n),$h(e))}function Bh(e,t,n){for(const r of n)r instanceof bh?(e.Ka.addReference(r.key,t),Vh(e,r)):r instanceof wh?(bt(Eh,"Document no longer in limbo: "+r.key),e.Ka.removeReference(r.key,t),e.Ka.containsKey(r.key)||jh(e,r.key)):St()}function Vh(e,t){const n=t.key,r=n.path.canonicalString();e.$a.get(n)||e.Qa.has(r)||(bt(Eh,"New document in limbo: "+n),e.Qa.add(r),$h(e))}function $h(e){for(;e.Qa.size>0&&e.$a.size<e.maxConcurrentLimboResolutions;){const t=e.Qa.values().next().value;e.Qa.delete(t);const n=new tn(Jt.fromString(t)),r=e.za.next();e.Ua.set(r,new xh(n)),e.$a=e.$a.insert(n,r),Nu(e.remoteStore,new Bo(La(Da(n.path)),r,"TargetPurposeLimboResolution",Dn.ae))}}async function Hh(e,t,n){const r=kt(e),i=[],a=[],s=[];r.ka.isEmpty()||(r.ka.forEach(((e,o)=>{s.push(r.Ha(o,t,n).then((e=>{var t;if((e||n)&&r.isPrimaryClient){const i=e?!e.fromCache:null===(t=null==n?void 0:n.targetChanges.get(o.targetId))||void 0===t?void 0:t.current;r.sharedClientState.updateQueryState(o.targetId,i?"current":"not-current")}if(e){i.push(e);const t=Vc.Yi(o.targetId,e);a.push(t)}})))})),await Promise.all(s),r.La.p_(i),await async function(e,t){const n=kt(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>gn.forEach(t,(t=>gn.forEach(t.Hi,(r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r))).next((()=>gn.forEach(t.Ji,(r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))))))}catch(e){if(!Sn(e))throw e;bt(Wc,"Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.Ts.get(e),r=t.snapshotVersion,i=t.withLastLimboFreeSnapshotVersion(r);n.Ts=n.Ts.insert(e,i)}}}(r.localStore,a))}async function Wh(e,t){const n=kt(e);if(!n.currentUser.isEqual(t)){bt(Eh,"User change. New user:",t.toKey());const e=await qc(n.localStore,t);n.currentUser=t,function(e,t){e.Ga.forEach((e=>{e.forEach((e=>{e.reject(new Ct(_t.CANCELLED,t))}))})),e.Ga.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await Hh(n,e.Rs)}}function Gh(e,t){const n=kt(e),r=n.Ua.get(t);if(r&&r.Ba)return ns().add(r.key);{let e=ns();const r=n.qa.get(t);if(!r)return e;for(const t of r){const r=n.ka.get(t);e=e.unionWith(r.view.Sa)}return e}}function Kh(e){const t=kt(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Oh.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Gh.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Ph.bind(null,t),t.La.p_=dh.bind(null,t.eventManager),t.La.Ja=ph.bind(null,t.eventManager),t}function qh(e){const t=kt(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Lh.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Mh.bind(null,t),t}class Yh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=vu(e.databaseInfo.databaseId),this.sharedClientState=this.Za(e),this.persistence=this.Xa(e),await this.persistence.start(),this.localStore=this.eu(e),this.gcScheduler=this.tu(e,this.localStore),this.indexBackfillerScheduler=this.nu(e,this.localStore)}tu(e,t){return null}nu(e,t){return null}eu(e){return Kc(this.persistence,new Hc,e.initialUser,this.serializer)}Xa(e){return new Cc(Ic.ri,this.serializer)}Za(e){return new ru}async terminate(){var e,t;null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(t=this.indexBackfillerScheduler)||void 0===t||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Yh.provider={build:()=>new Yh};class Xh extends Yh{constructor(e){super(),this.cacheSizeBytes=e}tu(e,t){xt(this.persistence.referenceDelegate instanceof Nc);const n=this.persistence.referenceDelegate.garbageCollector;return new nc(n,e.asyncQueue,t)}Xa(e){const t=void 0!==this.cacheSizeBytes?Ul.withCacheSize(this.cacheSizeBytes):Ul.DEFAULT;return new Cc((e=>Nc.ri(e,t)),this.serializer)}}class Qh extends Yh{constructor(e,t,n){super(),this.ru=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.ru.initialize(this,e),await qh(this.ru.syncEngine),await Hu(this.ru.remoteStore),await this.persistence.Ci((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}eu(e){return Kc(this.persistence,new Hc,e.initialUser,this.serializer)}tu(e,t){const n=this.persistence.referenceDelegate.garbageCollector;return new nc(n,e.asyncQueue,t)}nu(e,t){const n=new Nn(t,this.persistence);return new In(e.asyncQueue,n)}Xa(e){const t=Bc(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?Ul.withCacheSize(this.cacheSizeBytes):Ul.DEFAULT;return new zc(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,mu(),gu(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Za(e){return new ru}}class Jh{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>Rh(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Wh.bind(null,this.syncEngine),await eh(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new ch}createDatastore(e){const t=vu(e.databaseInfo.databaseId),n=function(e){return new pu(e)}(e.databaseInfo);return function(e,t,n,r){return new xu(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,i){return new Cu(e,t,n,r,i)}(this.localStore,this.datastore,e.asyncQueue,(e=>Rh(this.syncEngine,e,0)),su.D()?new su:new iu)}createSyncEngine(e,t){return function(e,t,n,r,i,a,s){const o=new kh(e,t,n,r,i,a);return s&&(o.ja=!0),o}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=kt(e);bt(_u,"RemoteStore shutting down."),t.W_.add(5),await Iu(t),t.z_.shutdown(),t.j_.set("Unknown")}(this.remoteStore),null===(e=this.datastore)||void 0===e||e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}Jh.provider={build:()=>new Jh};class Zh{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.iu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.iu(this.observer.error,e):wt("Uncaught Error in snapshot listener:",e.toString()))}su(){this.muted=!0}iu(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const ef="FirestoreClient";class tf{constructor(e,t,n,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=mt.UNAUTHENTICATED,this.clientId=Ut.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,(async e=>{bt(ef,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(bt(ef,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new At;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=ih(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function nf(e,t){e.asyncQueue.verifyOperationInProgress(),bt(ef,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener((async e=>{r.isEqual(e)||(await qc(t.localStore,e),r=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function rf(e,t){e.asyncQueue.verifyOperationInProgress();const n=await af(e);bt(ef,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener((e=>Zu(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>Zu(t.remoteStore,n))),e._onlineComponents=t}async function af(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){bt(ef,"Using user provided OfflineComponentProvider");try{await nf(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(e){return"FirebaseError"===e.name?e.code===_t.FAILED_PRECONDITION||e.code===_t.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;Tt("Error using user provided cache. Falling back to memory cache: "+n),await nf(e,new Yh)}}else bt(ef,"Using default OfflineComponentProvider"),await nf(e,new Xh(void 0));return e._offlineComponents}async function sf(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(bt(ef,"Using user provided OnlineComponentProvider"),await rf(e,e._uninitializedComponentsProvider._online)):(bt(ef,"Using default OnlineComponentProvider"),await rf(e,new Jh))),e._onlineComponents}function of(e){return sf(e).then((e=>e.syncEngine))}async function lf(e){const t=await sf(e),n=t.eventManager;return n.onListen=_h.bind(null,t.syncEngine),n.onUnlisten=Nh.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=Ch.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=Dh.bind(null,t.syncEngine),n}function cf(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new At;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const a=new Zh({next:n=>{a.su(),t.enqueueAndForget((()=>fh(e,s))),n.fromCache&&"server"===r.source?i.reject(new Ct(_t.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),s=new yh(n,a,{includeMetadataChanges:!0,Ta:!0});return hh(e,s)}(await lf(e),e.asyncQueue,t,n,r))),r.promise}function uf(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const hf=new Map;function ff(e,t,n){if(!n)throw new Ct(_t.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function df(e){if(!tn.isDocumentKey(e))throw new Ct(_t.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function pf(e){if(tn.isDocumentKey(e))throw new Ct(_t.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function mf(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":St()}function gf(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Ct(_t.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=mf(e);throw new Ct(_t.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}const vf="firestore.googleapis.com",yf=!0;class bf{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new Ct(_t.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=vf,this.ssl=yf}else this.host=e.host,this.ssl=null!==(t=e.ssl)&&void 0!==t?t:yf;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=zl;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<Zl)throw new Ct(_t.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new Ct(_t.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=uf(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new Ct(_t.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new Ct(_t.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new Ct(_t.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class wf{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new bf({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ct(_t.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Ct(_t.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new bf(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new Nt;switch(e.type){case"firstParty":return new Pt(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Ct(_t.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=hf.get(e);t&&(bt("ComponentProvider","Removing Datastore"),hf.delete(e),t.terminate())}(this),Promise.resolve()}}function Tf(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var i;const a=(e=gf(e,wf))._getSettings(),s=Object.assign(Object.assign({},a),{emulatorOptions:e._getEmulatorOptions()}),o=`${t}:${n}`;a.host!==vf&&a.host!==o&&Tt("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c=Object.assign(Object.assign({},a),{host:o,ssl:!1,emulatorOptions:r});if(!E(c,s)&&(e._setSettings(c),r.mockUserToken)){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=mt.MOCK_USER;else{t=function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[l(JSON.stringify({alg:"none",type:"JWT"})),l(JSON.stringify(a)),""].join(".")}(r.mockUserToken,null===(i=e._app)||void 0===i?void 0:i.options.projectId);const a=r.mockUserToken.sub||r.mockUserToken.user_id;if(!a)throw new Ct(_t.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new mt(a)}e._authCredentials=new Dt(new It(t,n))}}class Ef{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Ef(this.firestore,e,this._query)}}class Sf{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new xf(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Sf(this.firestore,e,this._key)}}class xf extends Ef{constructor(e,t,n){super(e,t,Da(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Sf(this.firestore,null,new tn(e))}withConverter(e){return new xf(this.firestore,e,this._path)}}function kf(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=k(e),ff("collection","path",t),e instanceof wf){const n=Jt.fromString(t,...r);return pf(n),new xf(e,null,n)}{if(!(e instanceof Sf||e instanceof xf))throw new Ct(_t.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Jt.fromString(t,...r));return pf(n),new xf(e.firestore,null,n)}}function _f(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=k(e),1===arguments.length&&(t=Ut.newId()),ff("doc","path",t),e instanceof wf){const n=Jt.fromString(t,...r);return df(n),new Sf(e,null,new tn(n))}{if(!(e instanceof Sf||e instanceof xf))throw new Ct(_t.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Jt.fromString(t,...r));return df(n),new Sf(e.firestore,e instanceof xf?e.converter:null,new tn(n))}}const Cf="AsyncQueue";class Af{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Vu=[],this.mu=!1,this.fu=[],this.gu=null,this.pu=!1,this.yu=!1,this.wu=[],this.a_=new yu(this,"async_queue_retry"),this.Su=()=>{const e=gu();e&&bt(Cf,"Visibility state changed to "+e.visibilityState),this.a_.t_()},this.bu=e;const t=gu();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Su)}get isShuttingDown(){return this.mu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Du(),this.vu(e)}enterRestrictedMode(e){if(!this.mu){this.mu=!0,this.yu=e||!1;const t=gu();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Su)}}enqueue(e){if(this.Du(),this.mu)return new Promise((()=>{}));const t=new At;return this.vu((()=>this.mu&&this.yu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Vu.push(e),this.Cu())))}async Cu(){if(0!==this.Vu.length){try{await this.Vu[0](),this.Vu.shift(),this.a_.reset()}catch(e){if(!Sn(e))throw e;bt(Cf,"Operation failed with retryable error: "+e)}this.Vu.length>0&&this.a_.Xo((()=>this.Cu()))}}vu(e){const t=this.bu.then((()=>(this.pu=!0,e().catch((e=>{this.gu=e,this.pu=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw wt("INTERNAL UNHANDLED ERROR: ",t),e})).then((e=>(this.pu=!1,e))))));return this.bu=t,t}enqueueAfterDelay(e,t,n){this.Du(),this.wu.indexOf(e)>-1&&(t=0);const r=rh.createAndSchedule(this,e,t,n,(e=>this.Fu(e)));return this.fu.push(r),r}Du(){this.gu&&St()}verifyOperationInProgress(){}async Mu(){let e;do{e=this.bu,await e}while(e!==this.bu)}xu(e){for(const t of this.fu)if(t.timerId===e)return!0;return!1}Ou(e){return this.Mu().then((()=>{this.fu.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.fu)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Mu()}))}Nu(e){this.wu.push(e)}Fu(e){const t=this.fu.indexOf(e);this.fu.splice(t,1)}}function If(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const r of t)if(r in n&&"function"==typeof n[r])return!0;return!1}(e,["next","error","complete"])}class Nf extends wf{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new Af,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Af(e),this._firestoreClient=void 0,await e}}}function Df(e){if(e._terminated)throw new Ct(_t.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||Of(e),e._firestoreClient}function Of(e){var t,n,r;const i=e._freezeSettings(),a=function(e,t,n,r){return new gi(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,uf(r.experimentalLongPollingOptions),r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,i);e._componentsProvider||(null===(n=i.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=i.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),e._firestoreClient=new tf(e._authCredentials,e._appCheckCredentials,e._queue,a,e._componentsProvider&&function(e){const t=null==e?void 0:e._online.build();return{_offline:null==e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}function Rf(e,t,n){if((e=gf(e,Nf))._firestoreClient||e._terminated)throw new Ct(_t.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(e._componentsProvider||e._getSettings().localCache)throw new Ct(_t.FAILED_PRECONDITION,"SDK cache is already specified.");e._componentsProvider={_online:t,_offline:n},Of(e)}class Pf{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Pf(ii.fromBase64String(e))}catch(e){throw new Ct(_t.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new Pf(ii.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Lf{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;++r)if(0===t[r].length)throw new Ct(_t.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new en(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Mf{constructor(e){this._methodName=e}}class Ff{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ct(_t.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ct(_t.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return jt(this._lat,e._lat)||jt(this._long,e._long)}}class zf{constructor(e){this._values=(e||[]).map((e=>e))}toArray(){return this._values.map((e=>e))}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}}const Uf=/^__.*__$/;class jf{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new Ds(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ns(e,this.data,t,this.fieldTransforms)}}class Bf{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Ds(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Vf(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw St()}}class $f{constructor(e,t,n,r,i,a){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Bu(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Lu(){return this.settings.Lu}ku(e){return new $f(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}qu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ku({path:n,Qu:!1});return r.$u(e),r}Uu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ku({path:n,Qu:!1});return r.Bu(),r}Ku(e){return this.ku({path:void 0,Qu:!0})}Wu(e){return rd(e,this.settings.methodName,this.settings.Gu||!1,this.path,this.settings.zu)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}Bu(){if(this.path)for(let e=0;e<this.path.length;e++)this.$u(this.path.get(e))}$u(e){if(0===e.length)throw this.Wu("Document fields must not be empty");if(Vf(this.Lu)&&Uf.test(e))throw this.Wu('Document fields cannot begin and end with "__"')}}class Hf{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||vu(e)}ju(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new $f({Lu:e,methodName:t,zu:n,path:en.emptyPath(),Qu:!1,Gu:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Wf(e){const t=e._freezeSettings(),n=vu(e._databaseId);return new Hf(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Gf(e,t,n,r,i){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const s=e.ju(a.merge||a.mergeFields?2:0,t,n,i);Zf("Data must be an object, but it was:",s,r);const o=Qf(r,s);let l,c;if(a.merge)l=new ni(s.fieldMask),c=s.fieldTransforms;else if(a.mergeFields){const e=[];for(const r of a.mergeFields){const i=ed(t,r,n);if(!s.contains(i))throw new Ct(_t.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);id(e,i)||e.push(i)}l=new ni(e),c=s.fieldTransforms.filter((e=>l.covers(e.field)))}else l=null,c=s.fieldTransforms;return new jf(new qi(o),l,c)}class Kf extends Mf{_toFieldTransform(e){if(2!==e.Lu)throw 1===e.Lu?e.Wu(`${this._methodName}() can only appear at the top level of your update data`):e.Wu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Kf}}function qf(e,t,n,r){const i=e.ju(1,t,n);Zf("Data must be an object, but it was:",i,r);const a=[],s=qi.empty();qr(r,((e,r)=>{const o=nd(t,e,n);r=k(r);const l=i.Uu(o);if(r instanceof Kf)a.push(o);else{const e=Xf(r,l);null!=e&&(a.push(o),s.set(o,e))}}));const o=new ni(a);return new Bf(s,o,i.fieldTransforms)}function Yf(e,t,n,r,i,a){const s=e.ju(1,t,n),o=[ed(t,r,n)],l=[i];if(a.length%2!=0)throw new Ct(_t.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<a.length;f+=2)o.push(ed(t,a[f])),l.push(a[f+1]);const c=[],u=qi.empty();for(let f=o.length-1;f>=0;--f)if(!id(c,o[f])){const e=o[f];let t=l[f];t=k(t);const n=s.Uu(e);if(t instanceof Kf)c.push(e);else{const r=Xf(t,n);null!=r&&(c.push(e),u.set(e,r))}}const h=new ni(c);return new Bf(u,h,s.fieldTransforms)}function Xf(e,t){if(Jf(e=k(e)))return Zf("Unsupported field value:",t,e),Qf(e,t);if(e instanceof Mf)return function(e,t){if(!Vf(t.Lu))throw t.Wu(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.Wu(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.Qu&&4!==t.Lu)throw t.Wu("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=Xf(i,t.Ku(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=k(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return os(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=qt.fromDate(e);return{timestampValue:ho(t.serializer,n)}}if(e instanceof qt){const n=new qt(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:ho(t.serializer,n)}}if(e instanceof Ff)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Pf)return{bytesValue:fo(t.serializer,e._byteString)};if(e instanceof Sf){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Wu(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:go(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof zf)return function(e,t){return{mapValue:{fields:{[bi]:{stringValue:Ei},[Si]:{arrayValue:{values:e.toArray().map((e=>{if("number"!=typeof e)throw t.Wu("VectorValues must only contain numeric values.");return as(t.serializer,e)}))}}}}}}(e,t);throw t.Wu(`Unsupported field value: ${mf(e)}`)}(e,t)}function Qf(e,t){const n={};return Yr(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):qr(e,((e,r)=>{const i=Xf(r,t.qu(e));null!=i&&(n[e]=i)})),{mapValue:{fields:n}}}function Jf(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof qt||e instanceof Ff||e instanceof Pf||e instanceof Sf||e instanceof Mf||e instanceof zf)}function Zf(e,t,n){if(!Jf(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const r=mf(n);throw"an object"===r?t.Wu(e+" a custom object"):t.Wu(e+" "+r)}}function ed(e,t,n){if((t=k(t))instanceof Lf)return t._internalPath;if("string"==typeof t)return nd(e,t);throw rd("Field path arguments must be of type string or ",e,!1,void 0,n)}const td=new RegExp("[~\\*/\\[\\]]");function nd(e,t,n){if(t.search(td)>=0)throw rd(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new Lf(...t.split("."))._internalPath}catch(r){throw rd(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function rd(e,t,n,r,i){const a=r&&!r.isEmpty(),s=void 0!==i;let o=`Function ${t}() called with invalid data`;n&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(a||s)&&(l+=" (found",a&&(l+=` in field ${r}`),s&&(l+=` in document ${i}`),l+=")"),new Ct(_t.INVALID_ARGUMENT,o+e+l)}function id(e,t){return e.some((e=>e.isEqual(t)))}class ad{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Sf(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new sd(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(od("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class sd extends ad{data(){return super.data()}}function od(e,t){return"string"==typeof t?nd(e,t):t instanceof Lf?t._internalPath:t._delegate._internalPath}function ld(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Ct(_t.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class cd{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(ki(e)){case 0:return null;case 1:return e.booleanValue;case 2:return oi(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(li(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw St()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return qr(e,((e,r)=>{n[e]=this.convertValue(r,t)})),n}convertVectorValue(e){var t,n,r;const i=null===(r=null===(n=null===(t=e.fields)||void 0===t?void 0:t[Si].arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.map((e=>oi(e.doubleValue)));return new zf(i)}convertGeoPoint(e){return new Ff(oi(e.latitude),oi(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=pi(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(mi(e));default:return null}}convertTimestamp(e){const t=si(e);return new qt(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Jt.fromString(e);xt(jo(n));const r=new yi(n.get(1),n.get(3)),i=new tn(n.popFirst(5));return r.isEqual(t)||wt(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function ud(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class hd{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class fd extends ad{constructor(e,t,n,r,i,a){super(e,t,n,r,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new dd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(od("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class dd extends fd{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class pd{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new hd(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new dd(this._firestore,this._userDataWriter,n.key,n,new hd(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Ct(_t.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>{const r=new dd(e._firestore,e._userDataWriter,n.doc.key,n.doc,new hd(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const r=new dd(e._firestore,e._userDataWriter,t.doc.key,t.doc,new hd(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,a=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),a=n.indexOf(t.doc.key)),{type:md(t.type),doc:r,oldIndex:i,newIndex:a}}))}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function md(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return St()}}class gd extends cd{constructor(e){super(),this.firestore=e}convertBytes(e){return new Pf(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Sf(this.firestore,null,t)}}function vd(e){e=gf(e,Ef);const t=gf(e.firestore,Nf),n=Df(t),r=new gd(t);return ld(e._query),cf(n,e._query).then((n=>new pd(t,r,e,n)))}function yd(e,t,n){e=gf(e,Sf);const r=gf(e.firestore,Nf),i=ud(e.converter,t,n);return Sd(r,[Gf(Wf(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,Es.none())])}function bd(e,t,n){e=gf(e,Sf);const r=gf(e.firestore,Nf),i=Wf(r);let a;for(var s=arguments.length,o=new Array(s>3?s-3:0),l=3;l<s;l++)o[l-3]=arguments[l];return a="string"==typeof(t=k(t))||t instanceof Lf?Yf(i,"updateDoc",e._key,t,n,o):qf(i,"updateDoc",e._key,t),Sd(r,[a.toMutation(e._key,Es.exists(!0))])}function wd(e){return Sd(gf(e.firestore,Nf),[new Ls(e._key,Es.none())])}function Td(e,t){const n=gf(e.firestore,Nf),r=_f(e),i=ud(e.converter,t);return Sd(n,[Gf(Wf(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,Es.exists(!1))]).then((()=>r))}function Ed(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i,a,s;e=k(e);let o={includeMetadataChanges:!1,source:"default"},l=0;"object"!=typeof n[l]||If(n[l])||(o=n[l],l++);const c={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(If(n[l])){const e=n[l];n[l]=null===(i=e.next)||void 0===i?void 0:i.bind(e),n[l+1]=null===(a=e.error)||void 0===a?void 0:a.bind(e),n[l+2]=null===(s=e.complete)||void 0===s?void 0:s.bind(e)}let u,h,f;if(e instanceof Sf)h=gf(e.firestore,Nf),f=Da(e._key.path),u={next:t=>{n[l]&&n[l](xd(h,e,t))},error:n[l+1],complete:n[l+2]};else{const t=gf(e,Ef);h=gf(t.firestore,Nf),f=t._query;const r=new gd(h);u={next:e=>{n[l]&&n[l](new pd(h,r,t,e))},error:n[l+1],complete:n[l+2]},ld(e._query)}return function(e,t,n,r){const i=new Zh(r),a=new yh(t,i,n);return e.asyncQueue.enqueueAndForget((async()=>hh(await lf(e),a))),()=>{i.su(),e.asyncQueue.enqueueAndForget((async()=>fh(await lf(e),a)))}}(Df(h),f,c,u)}function Sd(e,t){return function(e,t){const n=new At;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){const r=qh(e);try{const e=await function(e,t){const n=kt(e),r=qt.now(),i=t.reduce(((e,t)=>e.add(t.key)),ns());let a,s;return n.persistence.runTransaction("Locally write mutations","readwrite",(e=>{let o=Ka(),l=ns();return n.ds.getEntries(e,i).next((e=>{o=e,o.forEach(((e,t)=>{t.isValidDocument()||(l=l.add(e))}))})).next((()=>n.localDocuments.getOverlayedDocuments(e,o))).next((i=>{a=i;const s=[];for(const e of t){const t=As(e,a.get(e.key).overlayedDocument);null!=t&&s.push(new Ds(e.key,t,Yi(t.value.mapValue),Es.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,s,t)})).next((t=>{s=t;const r=t.applyToLocalDocumentSet(a,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)}))})).then((()=>({batchId:s.batchId,changes:Xa(a)})))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Wa[e.currentUser.toKey()];r||(r=new Xr(jt)),r=r.insert(t,n),e.Wa[e.currentUser.toKey()]=r}(r,e.batchId,n),await Hh(r,e.changes),await Hu(r.remoteStore)}catch(e){const t=ih(e,"Failed to persist write");n.reject(t)}}(await of(e),t,n))),n.promise}(Df(e),t)}function xd(e,t,n){const r=n.docs.get(t._key),i=new gd(e);return new fd(e,i,t._key,r,new hd(n.hasPendingWrites,n.fromCache),t.converter)}new WeakMap;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){gt=e}("11.5.0"),Fe(new _("firestore",((e,n)=>{let{instanceIdentifier:r,options:i}=n;const a=e.getProvider("app").getImmediate(),s=new Nf(new Ot(e.getProvider("auth-internal")),new Mt(a,e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Ct(_t.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new yi(e.options.projectId,t)}(a,r),a);return i=Object.assign({useFetchStreams:t},i),s._setSettings(i),s}),"PUBLIC").setMultipleInstances(!0)),Ve(dt,pt,e),Ve(dt,pt,"esm2017")}();Ve("firebase","11.5.0","app");const kd="@firebase/installations",_d="0.6.13",Cd=1e4,Ad=`w:${_d}`,Id="FIS_v2",Nd=36e5,Dd=new w("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function Od(e){return e instanceof b&&e.code.includes("request-failed")}function Rd(e){let{projectId:t}=e;return`https://firebaseinstallations.googleapis.com/v1/projects/${t}/installations`}function Pd(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function Ld(e,t){const n=(await t.json()).error;return Dd.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function Md(e){let{apiKey:t}=e;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function Fd(e,t){let{refreshToken:n}=t;const r=Md(e);return r.append("Authorization",function(e){return`${Id} ${e}`}(n)),r}async function zd(e){const t=await e();return t.status>=500&&t.status<600?e():t}function Ud(e){return new Promise((t=>{setTimeout(t,e)}))}const jd=/^[cdef][\w-]{21}$/;function Bd(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){const t=(n=e,btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_"));var n;return t.substr(0,22)}(e);return jd.test(t)?t:""}catch(e){return""}}function Vd(e){return`${e.appName}!${e.appId}`}const $d=new Map;function Hd(e,t){const n=Vd(e);Wd(n,t),function(e,t){const n=Kd();n&&n.postMessage({key:e,fid:t});qd()}(n,t)}function Wd(e,t){const n=$d.get(e);if(n)for(const r of n)r(t)}let Gd=null;function Kd(){return!Gd&&"BroadcastChannel"in self&&(Gd=new BroadcastChannel("[Firebase] FID Change"),Gd.onmessage=e=>{Wd(e.data.key,e.data.fid)}),Gd}function qd(){0===$d.size&&Gd&&(Gd.close(),Gd=null)}const Yd="firebase-installations-store";let Xd=null;function Qd(){return Xd||(Xd=X("firebase-installations-database",1,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(Yd)}})),Xd}async function Jd(e,t){const n=Vd(e),r=(await Qd()).transaction(Yd,"readwrite"),i=r.objectStore(Yd),a=await i.get(n);return await i.put(t,n),await r.done,a&&a.fid===t.fid||Hd(e,t.fid),t}async function Zd(e){const t=Vd(e),n=(await Qd()).transaction(Yd,"readwrite");await n.objectStore(Yd).delete(t),await n.done}async function ep(e,t){const n=Vd(e),r=(await Qd()).transaction(Yd,"readwrite"),i=r.objectStore(Yd),a=await i.get(n),s=t(a);return void 0===s?await i.delete(n):await i.put(s,n),await r.done,!s||a&&a.fid===s.fid||Hd(e,s.fid),s}async function tp(e){let t;const n=await ep(e.appConfig,(n=>{const r=function(e){const t=e||{fid:Bd(),registrationStatus:0};return ip(t)}(n),i=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine){return{installationEntry:t,registrationPromise:Promise.reject(Dd.create("app-offline"))}}const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=async function(e,t){try{const n=await async function(e,t){let{appConfig:n,heartbeatServiceProvider:r}=e,{fid:i}=t;const a=Rd(n),s=Md(n),o=r.getImmediate({optional:!0});if(o){const e=await o.getHeartbeatsHeader();e&&s.append("x-firebase-client",e)}const l={fid:i,authVersion:Id,appId:n.appId,sdkVersion:Ad},c={method:"POST",headers:s,body:JSON.stringify(l)},u=await zd((()=>fetch(a,c)));if(u.ok){const e=await u.json();return{fid:e.fid||i,registrationStatus:2,refreshToken:e.refreshToken,authToken:Pd(e.authToken)}}throw await Ld("Create Installation",u)}(e,t);return Jd(e.appConfig,n)}catch(n){throw Od(n)&&409===n.customData.serverCode?await Zd(e.appConfig):await Jd(e.appConfig,{fid:t.fid,registrationStatus:0}),n}}(e,n);return{installationEntry:n,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:np(e)}:{installationEntry:t}}(e,r);return t=i.registrationPromise,i.installationEntry}));return""===n.fid?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}async function np(e){let t=await rp(e.appConfig);for(;1===t.registrationStatus;)await Ud(100),t=await rp(e.appConfig);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:n}=await tp(e);return n||t}return t}function rp(e){return ep(e,(e=>{if(!e)throw Dd.create("installation-not-found");return ip(e)}))}function ip(e){return 1===(t=e).registrationStatus&&t.registrationTime+Cd<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}async function ap(e,t){let{appConfig:n,heartbeatServiceProvider:r}=e;const i=function(e,t){let{fid:n}=t;return`${Rd(e)}/${n}/authTokens:generate`}(n,t),a=Fd(n,t),s=r.getImmediate({optional:!0});if(s){const e=await s.getHeartbeatsHeader();e&&a.append("x-firebase-client",e)}const o={installation:{sdkVersion:Ad,appId:n.appId}},l={method:"POST",headers:a,body:JSON.stringify(o)},c=await zd((()=>fetch(i,l)));if(c.ok){return Pd(await c.json())}throw await Ld("Generate Auth Token",c)}async function sp(e){let t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=await ep(e.appConfig,(r=>{if(!lp(r))throw Dd.create("not-registered");const i=r.authToken;if(!n&&function(e){return 2===e.requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+Nd}(e)}(i))return r;if(1===i.requestStatus)return t=async function(e,t){let n=await op(e.appConfig);for(;1===n.authToken.requestStatus;)await Ud(100),n=await op(e.appConfig);const r=n.authToken;return 0===r.requestStatus?sp(e,t):r}(e,n),r;{if(!navigator.onLine)throw Dd.create("app-offline");const n=function(e){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}(r);return t=async function(e,t){try{const n=await ap(e,t),r=Object.assign(Object.assign({},t),{authToken:n});return await Jd(e.appConfig,r),n}catch(n){if(!Od(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await Jd(e.appConfig,n)}else await Zd(e.appConfig);throw n}}(e,n),n}}));return t?await t:r.authToken}function op(e){return ep(e,(e=>{if(!lp(e))throw Dd.create("not-registered");const t=e.authToken;return 1===(n=t).requestStatus&&n.requestTime+Cd<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e;var n}))}function lp(e){return void 0!==e&&2===e.registrationStatus}async function cp(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e;await async function(e){const{registrationPromise:t}=await tp(e);t&&await t}(n);return(await sp(n,t)).token}function up(e){return Dd.create("missing-app-config-values",{valueName:e})}const hp="installations",fp=e=>{const t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw up("App Configuration");if(!e.name)throw up("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw up(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:ze(t,"heartbeat"),_delete:()=>Promise.resolve()}},dp=e=>{const t=ze(e.getProvider("app").getImmediate(),hp).getImmediate();return{getId:()=>async function(e){const t=e,{installationEntry:n,registrationPromise:r}=await tp(t);return r?r.catch(console.error):sp(t).catch(console.error),n.fid}(t),getToken:e=>cp(t,e)}};Fe(new _(hp,fp,"PUBLIC")),Fe(new _("installations-internal",dp,"PRIVATE")),Ve(kd,_d),Ve(kd,_d,"esm2017");const pp="analytics",mp="https://www.googletagmanager.com/gtag/js",gp=new M("@firebase/analytics"),vp=new w("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function yp(e){if(!e.startsWith(mp)){const t=vp.create("invalid-gtag-resource",{gtagURL:e});return gp.warn(t.message),""}return e}function bp(e){return Promise.all(e.map((e=>e.catch((e=>e)))))}function wp(e,t){const n=function(e,t){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(e,t)),n}("firebase-js-sdk-policy",{createScriptURL:yp}),r=document.createElement("script"),i=`${mp}?l=${e}&id=${t}`;r.src=n?null===n||void 0===n?void 0:n.createScriptURL(i):i,r.async=!0,document.head.appendChild(r)}function Tp(e,t,n,r){return async function(i){try{for(var a=arguments.length,s=new Array(a>1?a-1:0),o=1;o<a;o++)s[o-1]=arguments[o];if("event"===i){const[r,i]=s;await async function(e,t,n,r,i){try{let a=[];if(i&&i.send_to){let e=i.send_to;Array.isArray(e)||(e=[e]);const r=await bp(n);for(const n of e){const e=r.find((e=>e.measurementId===n)),i=e&&t[e.appId];if(!i){a=[];break}a.push(i)}}0===a.length&&(a=Object.values(t)),await Promise.all(a),e("event",r,i||{})}catch(a){gp.error(a)}}(e,t,n,r,i)}else if("config"===i){const[i,a]=s;await async function(e,t,n,r,i,a){const s=r[i];try{if(s)await t[s];else{const e=(await bp(n)).find((e=>e.measurementId===i));e&&await t[e.appId]}}catch(o){gp.error(o)}e("config",i,a)}(e,t,n,r,i,a)}else if("consent"===i){const[t,n]=s;e("consent",t,n)}else if("get"===i){const[t,n,r]=s;e("get",t,n,r)}else if("set"===i){const[t]=s;e("set",t)}else e(i,...s)}catch(l){gp.error(l)}}}const Ep=new class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function Sp(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}async function xp(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ep,n=arguments.length>2?arguments[2]:void 0;const{appId:r,apiKey:i,measurementId:a}=e.options;if(!r)throw vp.create("no-app-id");if(!i){if(a)return{measurementId:a,appId:r};throw vp.create("no-api-key")}const s=t.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},o=new _p;return setTimeout((async()=>{o.abort()}),void 0!==n?n:6e4),kp({appId:r,apiKey:i,measurementId:a},s,o,t)}async function kp(e,t,n){let{throttleEndTimeMillis:r,backoffCount:i}=t,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ep;var s;const{appId:o,measurementId:l}=e;try{await function(e,t){return new Promise(((n,r)=>{const i=Math.max(t-Date.now(),0),a=setTimeout(n,i);e.addEventListener((()=>{clearTimeout(a),r(vp.create("fetch-throttle",{throttleEndTimeMillis:t}))}))}))}(n,r)}catch(c){if(l)return gp.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${null===c||void 0===c?void 0:c.message}]`),{appId:o,measurementId:l};throw c}try{const t=await async function(e){var t;const{appId:n,apiKey:r}=e,i={method:"GET",headers:Sp(r)},a="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),s=await fetch(a,i);if(200!==s.status&&304!==s.status){let e="";try{const n=await s.json();(null===(t=n.error)||void 0===t?void 0:t.message)&&(e=n.error.message)}catch(o){}throw vp.create("config-fetch-failed",{httpStatus:s.status,responseMessage:e})}return s.json()}(e);return a.deleteThrottleMetadata(o),t}catch(c){const t=c;if(!function(e){if(!(e instanceof b)||!e.customData)return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(t)){if(a.deleteThrottleMetadata(o),l)return gp.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${null===t||void 0===t?void 0:t.message}]`),{appId:o,measurementId:l};throw c}const r=503===Number(null===(s=null===t||void 0===t?void 0:t.customData)||void 0===s?void 0:s.httpStatus)?x(i,a.intervalMillis,30):x(i,a.intervalMillis),u={throttleEndTimeMillis:Date.now()+r,backoffCount:i+1};return a.setThrottleMetadata(o,u),gp.debug(`Calling attemptFetch again in ${r} millis`),kp(e,u,n,a)}}class _p{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach((e=>e()))}}let Cp,Ap;function Ip(e){Ap=e}function Np(e){Cp=e}async function Dp(e,t,n,r,i,a,s){var o;const l=xp(e);l.then((t=>{n[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&gp.warn(`The measurement ID in the local Firebase config (${e.options.measurementId}) does not match the measurement ID fetched from the server (${t.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)})).catch((e=>gp.error(e))),t.push(l);const c=async function(){if(!v())return gp.warn(vp.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await y()}catch(e){return gp.warn(vp.create("indexeddb-unavailable",{errorInfo:null===e||void 0===e?void 0:e.toString()}).message),!1}return!0}().then((e=>e?r.getId():void 0)),[u,h]=await Promise.all([l,c]);(function(e){const t=window.document.getElementsByTagName("script");for(const n of Object.values(t))if(n.src&&n.src.includes(mp)&&n.src.includes(e))return n;return null})(a)||wp(a,u.measurementId),Ap&&(i("consent","default",Ap),Ip(void 0)),i("js",new Date);const f=null!==(o=null===s||void 0===s?void 0:s.config)&&void 0!==o?o:{};return f.origin="firebase",f.update=!0,null!=h&&(f.firebase_id=h),i("config",u.measurementId,f),Cp&&(i("set",Cp),Np(void 0)),u.measurementId}class Op{constructor(e){this.app=e}_delete(){return delete Rp[this.app.options.appId],Promise.resolve()}}let Rp={},Pp=[];const Lp={};let Mp,Fp,zp="dataLayer",Up="gtag",jp=!1;function Bp(){const e=[];if(function(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}()&&e.push("This is a browser extension environment."),"undefined"!==typeof navigator&&navigator.cookieEnabled||e.push("Cookies are not available."),e.length>0){const t=e.map(((e,t)=>`(${t+1}) ${e}`)).join(" "),n=vp.create("invalid-analytics-context",{errorInfo:t});gp.warn(n.message)}}function Vp(e,t,n){Bp();const r=e.options.appId;if(!r)throw vp.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw vp.create("no-api-key");gp.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=Rp[r])throw vp.create("already-exists",{id:r});if(!jp){!function(e){let t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(zp);const{wrappedGtag:e,gtagCore:t}=function(e,t,n,r,i){let a=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];window[r].push(arguments)};return window[i]&&"function"===typeof window[i]&&(a=window[i]),window[i]=Tp(a,e,t,n),{gtagCore:a,wrappedGtag:window[i]}}(Rp,Pp,Lp,zp,Up);Fp=e,Mp=t,jp=!0}Rp[r]=Dp(e,Pp,Lp,t,Mp,zp,n);return new Op(e)}function $p(e,t,n,r){e=k(e),async function(e,t,n,r,i){if(i&&i.global)e("event",n,r);else{const i=await t;e("event",n,Object.assign(Object.assign({},r),{send_to:i}))}}(Fp,Rp[e.app.options.appId],t,n,r).catch((e=>gp.error(e)))}const Hp="@firebase/analytics",Wp="0.10.12";Fe(new _(pp,((e,t)=>{let{options:n}=t;return Vp(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),n)}),"PUBLIC")),Fe(new _("analytics-internal",(function(e){try{const t=e.getProvider(pp).getImmediate();return{logEvent:(e,n,r)=>$p(t,e,n,r)}}catch(t){throw vp.create("interop-component-reg-failed",{reason:t})}}),"PRIVATE")),Ve(Hp,Wp),Ve(Hp,Wp,"esm2017");const Gp=function(e,t){const n="object"==typeof e?e:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:De;const t=Re.get(e);if(!t&&e===De&&d())return Be();if(!t)throw Ue.create("no-app",{appName:e});return t}(),r="string"==typeof e?e:t||vi,i=ze(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const e=f("firestore");e&&Tf(i,...e)}return i}(Be({apiKey:{NODE_ENV:"production",PUBLIC_URL:"/asignacion-plazas",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_FIREBASE_API_KEY||"AIzaSyDo7X1BLIW1hNYQpJLZcDws_L4aGHJWXOQ",authDomain:{NODE_ENV:"production",PUBLIC_URL:"/asignacion-plazas",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_FIREBASE_AUTH_DOMAIN||"asignacion-plazas.firebaseapp.com",projectId:{NODE_ENV:"production",PUBLIC_URL:"/asignacion-plazas",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_FIREBASE_PROJECT_ID||"asignacion-plazas",storageBucket:{NODE_ENV:"production",PUBLIC_URL:"/asignacion-plazas",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_FIREBASE_STORAGE_BUCKET||"asignacion-plazas.firebasestorage.app",messagingSenderId:{NODE_ENV:"production",PUBLIC_URL:"/asignacion-plazas",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_FIREBASE_MESSAGING_SENDER_ID||"525955676079",appId:{NODE_ENV:"production",PUBLIC_URL:"/asignacion-plazas",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_FIREBASE_APP_ID||"1:525955676079:web:a7e0b00391e75c902fe15a",measurementId:{NODE_ENV:"production",PUBLIC_URL:"/asignacion-plazas",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_FIREBASE_MEASUREMENT_ID||"G-E0DLWYPVKP"}));try{(function(e,t){Tt("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=e._freezeSettings();return Rf(e,Jh.provider,{build:e=>new Qh(e,n.cacheSizeBytes,null==t?void 0:t.forceOwnership)}),Promise.resolve()})(Gp).catch((e=>{"failed-precondition"===e.code?console.warn("La persistencia fall\xf3: m\xfaltiples pesta\xf1as abiertas"):"unimplemented"===e.code&&console.warn("El navegador no soporta persistencia")}))}catch(MS){console.warn("Error al configurar persistencia:",MS)}var Kp={version:"0.18.5"},qp=1200,Yp=1252,Xp=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Qp={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Jp=function(e){-1!=Xp.indexOf(e)&&(Yp=Qp[0]=e)};var Zp=function(e){qp=e,Jp(e)};function em(){Zp(1200),Jp(1252)}function tm(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n+1)+(e.charCodeAt(2*n)<<8));return t.join("")}var nm,rm=function(e){return String.fromCharCode(e)},im=function(e){return String.fromCharCode(e)};var am="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function sm(e){for(var t="",n=0,r=0,i=0,a=0,s=0,o=0,l=0,c=0;c<e.length;)a=(n=e.charCodeAt(c++))>>2,s=(3&n)<<4|(r=e.charCodeAt(c++))>>4,o=(15&r)<<2|(i=e.charCodeAt(c++))>>6,l=63&i,isNaN(r)?o=l=64:isNaN(i)&&(l=64),t+=am.charAt(a)+am.charAt(s)+am.charAt(o)+am.charAt(l);return t}function om(e){var t="",n=0,r=0,i=0,a=0,s=0,o=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)n=am.indexOf(e.charAt(l++))<<2|(a=am.indexOf(e.charAt(l++)))>>4,t+=String.fromCharCode(n),r=(15&a)<<4|(s=am.indexOf(e.charAt(l++)))>>2,64!==s&&(t+=String.fromCharCode(r)),i=(3&s)<<6|(o=am.indexOf(e.charAt(l++))),64!==o&&(t+=String.fromCharCode(i));return t}var lm=function(){return"undefined"!==typeof Buffer&&"undefined"!==typeof process&&"undefined"!==typeof process.versions&&!!process.versions.node}(),cm=function(){if("undefined"!==typeof Buffer){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch(t){e=!0}return e?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function um(e){return lm?Buffer.alloc?Buffer.alloc(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}function hm(e){return lm?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}var fm=function(e){return lm?cm(e,"binary"):e.split("").map((function(e){return 255&e.charCodeAt(0)}))};function dm(e){if("undefined"===typeof ArrayBuffer)return fm(e);for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!=e.length;++r)n[r]=255&e.charCodeAt(r);return t}function pm(e){if(Array.isArray(e))return e.map((function(e){return String.fromCharCode(e)})).join("");for(var t=[],n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}var mm=lm?function(e){return Buffer.concat(e.map((function(e){return Buffer.isBuffer(e)?e:cm(e)})))}:function(e){if("undefined"!==typeof Uint8Array){var t=0,n=0;for(t=0;t<e.length;++t)n+=e[t].length;var r=new Uint8Array(n),i=0;for(t=0,n=0;t<e.length;n+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)r.set(e[t],n);else{if("string"==typeof e[t])throw"wtf";r.set(new Uint8Array(e[t]),n)}return r}return[].concat.apply([],e.map((function(e){return Array.isArray(e)?e:[].slice.call(e)})))};var gm=/\u0000/g,vm=/[\u0001-\u0006]/g;function ym(e){for(var t="",n=e.length-1;n>=0;)t+=e.charAt(n--);return t}function bm(e,t){var n=""+e;return n.length>=t?n:Dg("0",t-n.length)+n}function wm(e,t){var n=""+e;return n.length>=t?n:Dg(" ",t-n.length)+n}function Tm(e,t){var n=""+e;return n.length>=t?n:n+Dg(" ",t-n.length)}var Em=Math.pow(2,32);function Sm(e,t){return e>Em||e<-Em?function(e,t){var n=""+Math.round(e);return n.length>=t?n:Dg("0",t-n.length)+n}(e,t):function(e,t){var n=""+e;return n.length>=t?n:Dg("0",t-n.length)+n}(Math.round(e),t)}function xm(e,t){return t=t||0,e.length>=7+t&&103===(32|e.charCodeAt(t))&&101===(32|e.charCodeAt(t+1))&&110===(32|e.charCodeAt(t+2))&&101===(32|e.charCodeAt(t+3))&&114===(32|e.charCodeAt(t+4))&&97===(32|e.charCodeAt(t+5))&&108===(32|e.charCodeAt(t+6))}var km=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],_m=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];var Cm={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "'},Am={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Im={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Nm(e,t,n){for(var r=e<0?-1:1,i=e*r,a=0,s=1,o=0,l=1,c=0,u=0,h=Math.floor(i);c<t&&(o=(h=Math.floor(i))*s+a,u=h*c+l,!(i-h<5e-8));)i=1/(i-h),a=s,s=o,l=c,c=u;if(u>t&&(c>t?(u=l,o=a):(u=c,o=s)),!n)return[0,r*o,u];var f=Math.floor(r*o/u);return[f,r*o-f*u,u]}function Dm(e,t,n){if(e>2958465||e<0)return null;var r=0|e,i=Math.floor(86400*(e-r)),a=0,s=[],o={D:r,T:i,u:86400*(e-r)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(r+=1462),o.u>.9999&&(o.u=0,86400==++i&&(o.T=i=0,++r,++o.D)),60===r)s=n?[1317,10,29]:[1900,2,29],a=3;else if(0===r)s=n?[1317,8,29]:[1900,1,0],a=6;else{r>60&&--r;var l=new Date(1900,0,1);l.setDate(l.getDate()+r-1),s=[l.getFullYear(),l.getMonth()+1,l.getDate()],a=l.getDay(),r<60&&(a=(a+6)%7),n&&(a=function(e,t){t[0]-=581;var n=e.getDay();e<60&&(n=(n+6)%7);return n}(l,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=a,o}var Om=new Date(1899,11,31,0,0,0),Rm=Om.getTime(),Pm=new Date(1900,2,1,0,0,0);function Lm(e,t){var n=e.getTime();return t?n-=1262304e5:e>=Pm&&(n+=864e5),(n-(Rm+6e4*(e.getTimezoneOffset()-Om.getTimezoneOffset())))/864e5}function Mm(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Fm(e){var t,n=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return t=n>=-4&&n<=-1?e.toPrecision(10+n):Math.abs(n)<=9?function(e){var t=e<0?12:11,n=Mm(e.toFixed(12));return n.length<=t||(n=e.toPrecision(10)).length<=t?n:e.toExponential(5)}(e):10===n?e.toFixed(10).substr(0,12):function(e){var t=Mm(e.toFixed(11));return t.length>(e<0?12:11)||"0"===t||"-0"===t?e.toPrecision(6):t}(e),Mm(function(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(t.toUpperCase()))}function zm(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):Fm(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return ag(14,Lm(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Um(e,t,n,r){var i,a="",s=0,o=0,l=n.y,c=0;switch(e){case 98:l=n.y+543;case 121:switch(t.length){case 1:case 2:i=l%100,c=2;break;default:i=l%1e4,c=4}break;case 109:switch(t.length){case 1:case 2:i=n.m,c=t.length;break;case 3:return _m[n.m-1][1];case 5:return _m[n.m-1][0];default:return _m[n.m-1][2]}break;case 100:switch(t.length){case 1:case 2:i=n.d,c=t.length;break;case 3:return km[n.q][0];default:return km[n.q][1]}break;case 104:switch(t.length){case 1:case 2:i=1+(n.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:i=n.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:i=n.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==n.u||"s"!=t&&"ss"!=t?(o=r>=2?3===r?1e3:100:1===r?10:1,(s=Math.round(o*(n.S+n.u)))>=60*o&&(s=0),"s"===t?0===s?"0":""+s/o:(a=bm(s,2+r),"ss"===t?a.substr(0,2):"."+a.substr(2,t.length-1))):bm(n.S,t.length);case 90:switch(t){case"[h]":case"[hh]":i=24*n.D+n.H;break;case"[m]":case"[mm]":i=60*(24*n.D+n.H)+n.M;break;case"[s]":case"[ss]":i=60*(60*(24*n.D+n.H)+n.M)+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+t}c=3===t.length?1:2;break;case 101:i=l,c=1}return c>0?bm(i,c):""}function jm(e){if(e.length<=3)return e;for(var t=e.length%3,n=e.substr(0,t);t!=e.length;t+=3)n+=(n.length>0?",":"")+e.substr(t,3);return n}var Bm=/%/g;function Vm(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+Vm(e,-t);var i=e.indexOf(".");-1===i&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),-1===(n=(t/Math.pow(10,a)).toPrecision(r+1+(i+a)%i)).indexOf("e")){var s=Math.floor(Math.log(t)*Math.LOG10E);for(-1===n.indexOf(".")?n=n.charAt(0)+"."+n.substr(1)+"E+"+(s-n.length+a):n+="E+"+(s-a);"0."===n.substr(0,2);)n=(n=n.charAt(0)+n.substr(2,i)+"."+n.substr(2+i)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,n,r){return t+n+r.substr(0,(i+a)%i)+"."+r.substr(a)+"E"}))}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var $m=/# (\?+)( ?)\/( ?)(\d+)/;var Hm=/^#*0*\.([0#]+)/,Wm=/\).*[0#]/,Gm=/\(###\) ###\\?-####/;function Km(e){for(var t,n="",r=0;r!=e.length;++r)switch(t=e.charCodeAt(r)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(t)}return n}function qm(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n}function Ym(e,t){var n=e-Math.floor(e),r=Math.pow(10,t);return t<(""+Math.round(n*r)).length?0:Math.round(n*r)}function Xm(e,t,n){if(40===e.charCodeAt(0)&&!t.match(Wm)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?Xm("n",r,n):"("+Xm("n",r,-n)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,n){for(var r=t.length-1;44===t.charCodeAt(r-1);)--r;return Zm(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}(e,t,n);if(-1!==t.indexOf("%"))return function(e,t,n){var r=t.replace(Bm,""),i=t.length-r.length;return Zm(e,r,n*Math.pow(10,2*i))+Dg("%",i)}(e,t,n);if(-1!==t.indexOf("E"))return Vm(t,n);if(36===t.charCodeAt(0))return"$"+Xm(e,t.substr(" "==t.charAt(1)?2:1),n);var i,a,s,o,l=Math.abs(n),c=n<0?"-":"";if(t.match(/^00+$/))return c+Sm(l,t.length);if(t.match(/^[#?]+$/))return"0"===(i=Sm(n,0))&&(i=""),i.length>t.length?i:Km(t.substr(0,t.length-i.length))+i;if(a=t.match($m))return function(e,t,n){var r=parseInt(e[4],10),i=Math.round(t*r),a=Math.floor(i/r),s=i-a*r,o=r;return n+(0===a?"":""+a)+" "+(0===s?Dg(" ",e[1].length+1+e[4].length):wm(s,e[1].length)+e[2]+"/"+e[3]+bm(o,e[4].length))}(a,l,c);if(t.match(/^#+0+$/))return c+Sm(l,t.length-t.indexOf("0"));if(a=t.match(Hm))return i=qm(n,a[1].length).replace(/^([^\.]+)$/,"$1."+Km(a[1])).replace(/\.$/,"."+Km(a[1])).replace(/\.(\d*)$/,(function(e,t){return"."+t+Dg("0",Km(a[1]).length-t.length)})),-1!==t.indexOf("0.")?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return c+qm(l,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return c+jm(Sm(l,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+Xm(e,t,-n):jm(""+(Math.floor(n)+function(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(n,a[1].length)))+"."+bm(Ym(n,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return Xm(e,t.replace(/^#,#*,/,""),n);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=ym(Xm(e,t.replace(/[\\-]/g,""),n)),s=0,ym(ym(t.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return s<i.length?i.charAt(s++):"0"===e?"0":""})));if(t.match(Gm))return"("+(i=Xm(e,"##########",n)).substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),o=Nm(l,Math.pow(10,s)-1,!1),i=""+c," "==(u=Zm("n",a[1],o[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),i+=u+a[2]+"/"+a[3],(u=Tm(o[2],s)).length<a[4].length&&(u=Km(a[4].substr(a[4].length-u.length))+u),i+=u;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),c+((o=Nm(l,Math.pow(10,s)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?wm(o[1],s)+a[2]+"/"+a[3]+Tm(o[2],s):Dg(" ",2*s+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=Sm(n,0),t.length<=i.length?i:Km(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+n.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var h=t.indexOf(".")-s,f=t.length-i.length-h;return Km(t.substr(0,h)+i+t.substr(t.length-f))}if(a=t.match(/^00,000\.([#0]*0)$/))return s=Ym(n,a[1].length),n<0?"-"+Xm(e,t,-n):jm(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?bm(0,3-e.length):"")+e}))+"."+bm(s,a[1].length);switch(t){case"###,##0.00":return Xm(e,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var d=jm(Sm(l,0));return"0"!==d?c+d:"";case"###,###.00":return Xm(e,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return Xm(e,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Qm(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+Qm(e,-t);var i=e.indexOf(".");-1===i&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),!(n=(t/Math.pow(10,a)).toPrecision(r+1+(i+a)%i)).match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);-1===n.indexOf(".")?n=n.charAt(0)+"."+n.substr(1)+"E+"+(s-n.length+a):n+="E+"+(s-a),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,n,r){return t+n+r.substr(0,(i+a)%i)+"."+r.substr(a)+"E"}))}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function Jm(e,t,n){if(40===e.charCodeAt(0)&&!t.match(Wm)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?Jm("n",r,n):"("+Jm("n",r,-n)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,n){for(var r=t.length-1;44===t.charCodeAt(r-1);)--r;return Zm(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}(e,t,n);if(-1!==t.indexOf("%"))return function(e,t,n){var r=t.replace(Bm,""),i=t.length-r.length;return Zm(e,r,n*Math.pow(10,2*i))+Dg("%",i)}(e,t,n);if(-1!==t.indexOf("E"))return Qm(t,n);if(36===t.charCodeAt(0))return"$"+Jm(e,t.substr(" "==t.charAt(1)?2:1),n);var i,a,s,o,l=Math.abs(n),c=n<0?"-":"";if(t.match(/^00+$/))return c+bm(l,t.length);if(t.match(/^[#?]+$/))return i=""+n,0===n&&(i=""),i.length>t.length?i:Km(t.substr(0,t.length-i.length))+i;if(a=t.match($m))return function(e,t,n){return n+(0===t?"":""+t)+Dg(" ",e[1].length+2+e[4].length)}(a,l,c);if(t.match(/^#+0+$/))return c+bm(l,t.length-t.indexOf("0"));if(a=t.match(Hm))return i=(i=(""+n).replace(/^([^\.]+)$/,"$1."+Km(a[1])).replace(/\.$/,"."+Km(a[1]))).replace(/\.(\d*)$/,(function(e,t){return"."+t+Dg("0",Km(a[1]).length-t.length)})),-1!==t.indexOf("0.")?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return c+jm(""+l);if(a=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+Jm(e,t,-n):jm(""+n)+"."+Dg("0",a[1].length);if(a=t.match(/^#,#*,#0/))return Jm(e,t.replace(/^#,#*,/,""),n);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=ym(Jm(e,t.replace(/[\\-]/g,""),n)),s=0,ym(ym(t.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return s<i.length?i.charAt(s++):"0"===e?"0":""})));if(t.match(Gm))return"("+(i=Jm(e,"##########",n)).substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),o=Nm(l,Math.pow(10,s)-1,!1),i=""+c," "==(u=Zm("n",a[1],o[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),i+=u+a[2]+"/"+a[3],(u=Tm(o[2],s)).length<a[4].length&&(u=Km(a[4].substr(a[4].length-u.length))+u),i+=u;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),c+((o=Nm(l,Math.pow(10,s)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?wm(o[1],s)+a[2]+"/"+a[3]+Tm(o[2],s):Dg(" ",2*s+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=""+n,t.length<=i.length?i:Km(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0]+)\.([#0]+)$/)){i=""+n.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var h=t.indexOf(".")-s,f=t.length-i.length-h;return Km(t.substr(0,h)+i+t.substr(t.length-f))}if(a=t.match(/^00,000\.([#0]*0)$/))return n<0?"-"+Jm(e,t,-n):jm(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?bm(0,3-e.length):"")+e}))+"."+bm(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var d=jm(""+l);return"0"!==d?c+d:"";default:if(t.match(/\.[0#?]*$/))return Jm(e,t.slice(0,t.lastIndexOf(".")),n)+Km(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Zm(e,t,n){return(0|n)===n?Jm(e,t,n):Xm(e,t,n)}var eg=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function tg(e){for(var t=0,n="",r="";t<e.length;)switch(n=e.charAt(t)){case"G":xm(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4e0a":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;if("\u4e0a\u5348/\u4e0b\u5348"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(r=n;"]"!==e.charAt(t++)&&t<e.length;)r+=e.charAt(t);if(r.match(eg))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(n=e.charAt(++t))>-1||"\\"==n&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===n;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;default:++t}return!1}var ng=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function rg(e,t){if(null==t)return!1;var n=parseFloat(t[2]);switch(t[1]){case"=":if(e==n)return!0;break;case">":if(e>n)return!0;break;case"<":if(e<n)return!0;break;case"<>":if(e!=n)return!0;break;case">=":if(e>=n)return!0;break;case"<=":if(e<=n)return!0}return!1}function ig(e,t){var n=function(e){for(var t=[],n=!1,r=0,i=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:n=!n;break;case 95:case 42:case 92:++r;break;case 59:t[t.length]=e.substr(i,r-i),i=r+1}if(t[t.length]=e.substr(i),!0===n)throw new Error("Format |"+e+"| unterminated string ");return t}(e),r=n.length,i=n[r-1].indexOf("@");if(r<4&&i>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if("number"!==typeof t)return[4,4===n.length||i>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=i>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=i>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=i>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"]}var a=t>0?n[0]:t<0?n[1]:n[2];if(-1===n[0].indexOf("[")&&-1===n[1].indexOf("["))return[r,a];if(null!=n[0].match(/\[[=<>]/)||null!=n[1].match(/\[[=<>]/)){var s=n[0].match(ng),o=n[1].match(ng);return rg(t,s)?[r,n[0]]:rg(t,o)?[r,n[1]]:[r,n[null!=s&&null!=o?2:1]]}return[r,a]}function ag(e,t,n){null==n&&(n={});var r="";switch(typeof e){case"string":r="m/d/yy"==e&&n.dateNF?n.dateNF:e;break;case"number":null==(r=14==e&&n.dateNF?n.dateNF:(null!=n.table?n.table:Cm)[e])&&(r=n.table&&n.table[Am[e]]||Cm[Am[e]]),null==r&&(r=Im[e]||"General")}if(xm(r,0))return zm(t,n);t instanceof Date&&(t=Lm(t,n.date1904));var i=ig(r,t);if(xm(i[1]))return zm(t,n);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return function(e,t,n,r){for(var i,a,s,o=[],l="",c=0,u="",h="t",f="H";c<e.length;)switch(u=e.charAt(c)){case"G":if(!xm(e,c))throw new Error("unrecognized character "+u+" in "+e);o[o.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";34!==(s=e.charCodeAt(++c))&&c<e.length;)l+=String.fromCharCode(s);o[o.length]={t:"t",v:l},++c;break;case"\\":var d=e.charAt(++c),p="("===d||")"===d?d:"t";o[o.length]={t:p,v:d},++c;break;case"_":o[o.length]={t:"t",v:" "},c+=2;break;case"@":o[o.length]={t:"T",v:t},++c;break;case"B":case"b":if("1"===e.charAt(c+1)||"2"===e.charAt(c+1)){if(null==i&&null==(i=Dm(t,n,"2"===e.charAt(c+1))))return"";o[o.length]={t:"X",v:e.substr(c,2)},h=u,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==i&&null==(i=Dm(t,n)))return"";for(l=u;++c<e.length&&e.charAt(c).toLowerCase()===u;)l+=u;"m"===u&&"h"===h.toLowerCase()&&(u="M"),"h"===u&&(u=f),o[o.length]={t:u,v:l},h=u;break;case"A":case"a":case"\u4e0a":var m={t:u,v:u};if(null==i&&(i=Dm(t,n)),"A/P"===e.substr(c,3).toUpperCase()?(null!=i&&(m.v=i.H>=12?"P":"A"),m.t="T",f="h",c+=3):"AM/PM"===e.substr(c,5).toUpperCase()?(null!=i&&(m.v=i.H>=12?"PM":"AM"),m.t="T",c+=5,f="h"):"\u4e0a\u5348/\u4e0b\u5348"===e.substr(c,5).toUpperCase()?(null!=i&&(m.v=i.H>=12?"\u4e0b\u5348":"\u4e0a\u5348"),m.t="T",c+=5,f="h"):(m.t="t",++c),null==i&&"T"===m.t)return"";o[o.length]=m,h=u;break;case"[":for(l=u;"]"!==e.charAt(c++)&&c<e.length;)l+=e.charAt(c);if("]"!==l.slice(-1))throw'unterminated "[" block: |'+l+"|";if(l.match(eg)){if(null==i&&null==(i=Dm(t,n)))return"";o[o.length]={t:"Z",v:l.toLowerCase()},h=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",tg(e)||(o[o.length]={t:"t",v:l}));break;case".":if(null!=i){for(l=u;++c<e.length&&"0"===(u=e.charAt(c));)l+=u;o[o.length]={t:"s",v:l};break}case"0":case"#":for(l=u;++c<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(c))>-1;)l+=u;o[o.length]={t:"n",v:l};break;case"?":for(l=u;e.charAt(++c)===u;)l+=u;o[o.length]={t:u,v:l},h=u;break;case"*":++c," "!=e.charAt(c)&&"*"!=e.charAt(c)||++c;break;case"(":case")":o[o.length]={t:1===r?"t":u,v:u},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=u;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);o[o.length]={t:"D",v:l};break;case" ":o[o.length]={t:u,v:u},++c;break;case"$":o[o.length]={t:"t",v:"$"},++c;break;default:if(-1===",$-+/():!^&'~{}<>=\u20acacfijklopqrtuvwxzP".indexOf(u))throw new Error("unrecognized character "+u+" in "+e);o[o.length]={t:"t",v:u},++c}var g,v=0,y=0;for(c=o.length-1,h="t";c>=0;--c)switch(o[c].t){case"h":case"H":o[c].t=f,h="h",v<1&&(v=1);break;case"s":(g=o[c].v.match(/\.0+$/))&&(y=Math.max(y,g[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":h=o[c].t;break;case"m":"s"===h&&(o[c].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&o[c].v.match(/[Hh]/)&&(v=1),v<2&&o[c].v.match(/[Mm]/)&&(v=2),v<3&&o[c].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:i.u>=.5&&(i.u=0,++i.S),i.S>=60&&(i.S=0,++i.M),i.M>=60&&(i.M=0,++i.H);break;case 2:i.u>=.5&&(i.u=0,++i.S),i.S>=60&&(i.S=0,++i.M)}var b,w="";for(c=0;c<o.length;++c)switch(o[c].t){case"t":case"T":case" ":case"D":break;case"X":o[c].v="",o[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":o[c].v=Um(o[c].t.charCodeAt(0),o[c].v,i,y),o[c].t="t";break;case"n":case"?":for(b=c+1;null!=o[b]&&("?"===(u=o[b].t)||"D"===u||(" "===u||"t"===u)&&null!=o[b+1]&&("?"===o[b+1].t||"t"===o[b+1].t&&"/"===o[b+1].v)||"("===o[c].t&&(" "===u||"n"===u||")"===u)||"t"===u&&("/"===o[b].v||" "===o[b].v&&null!=o[b+1]&&"?"==o[b+1].t));)o[c].v+=o[b].v,o[b]={v:"",t:";"},++b;w+=o[c].v,c=b-1;break;case"G":o[c].t="t",o[c].v=zm(t,n)}var T,E,S="";if(w.length>0){40==w.charCodeAt(0)?(T=t<0&&45===w.charCodeAt(0)?-t:t,E=Zm("n",w,T)):(E=Zm("n",w,T=t<0&&r>1?-t:t),T<0&&o[0]&&"t"==o[0].t&&(E=E.substr(1),o[0].v="-"+o[0].v)),b=E.length-1;var x=o.length;for(c=0;c<o.length;++c)if(null!=o[c]&&"t"!=o[c].t&&o[c].v.indexOf(".")>-1){x=c;break}var k=o.length;if(x===o.length&&-1===E.indexOf("E")){for(c=o.length-1;c>=0;--c)null!=o[c]&&-1!=="n?".indexOf(o[c].t)&&(b>=o[c].v.length-1?(b-=o[c].v.length,o[c].v=E.substr(b+1,o[c].v.length)):b<0?o[c].v="":(o[c].v=E.substr(0,b+1),b=-1),o[c].t="t",k=c);b>=0&&k<o.length&&(o[k].v=E.substr(0,b+1)+o[k].v)}else if(x!==o.length&&-1===E.indexOf("E")){for(b=E.indexOf(".")-1,c=x;c>=0;--c)if(null!=o[c]&&-1!=="n?".indexOf(o[c].t)){for(a=o[c].v.indexOf(".")>-1&&c===x?o[c].v.indexOf(".")-1:o[c].v.length-1,S=o[c].v.substr(a+1);a>=0;--a)b>=0&&("0"===o[c].v.charAt(a)||"#"===o[c].v.charAt(a))&&(S=E.charAt(b--)+S);o[c].v=S,o[c].t="t",k=c}for(b>=0&&k<o.length&&(o[k].v=E.substr(0,b+1)+o[k].v),b=E.indexOf(".")+1,c=x;c<o.length;++c)if(null!=o[c]&&(-1!=="n?(".indexOf(o[c].t)||c===x)){for(a=o[c].v.indexOf(".")>-1&&c===x?o[c].v.indexOf(".")+1:0,S=o[c].v.substr(0,a);a<o[c].v.length;++a)b<E.length&&(S+=E.charAt(b++));o[c].v=S,o[c].t="t",k=c}}}for(c=0;c<o.length;++c)null!=o[c]&&"n?".indexOf(o[c].t)>-1&&(T=r>1&&t<0&&c>0&&"-"===o[c-1].v?-t:t,o[c].v=Zm(o[c].t,o[c].v,T),o[c].t="t");var _="";for(c=0;c!==o.length;++c)null!=o[c]&&(_+=o[c].v);return _}(i[1],t,n,i[0])}function sg(e,t){if("number"!=typeof t){t=+t||-1;for(var n=0;n<392;++n)if(void 0!=Cm[n]){if(Cm[n]==e){t=n;break}}else t<0&&(t=n);t<0&&(t=391)}return Cm[t]=e,t}function og(e){for(var t=0;392!=t;++t)void 0!==e[t]&&sg(e[t],t)}function lg(){var e;e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "',Cm=e}var cg=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;var ug=function(){var e={};e.version="1.2.0";var t=function(){for(var e=0,t=new Array(256),n=0;256!=n;++n)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=n)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[n]=e;return"undefined"!==typeof Int32Array?new Int32Array(t):t}();var n=function(e){var t=0,n=0,r=0,i="undefined"!==typeof Int32Array?new Int32Array(4096):new Array(4096);for(r=0;256!=r;++r)i[r]=e[r];for(r=0;256!=r;++r)for(n=e[r],t=256+r;t<4096;t+=256)n=i[t]=n>>>8^e[255&n];var a=[];for(r=1;16!=r;++r)a[r-1]="undefined"!==typeof Int32Array?i.subarray(256*r,256*r+256):i.slice(256*r,256*r+256);return a}(t),r=n[0],i=n[1],a=n[2],s=n[3],o=n[4],l=n[5],c=n[6],u=n[7],h=n[8],f=n[9],d=n[10],p=n[11],m=n[12],g=n[13],v=n[14];return e.table=t,e.bstr=function(e,n){for(var r=~n,i=0,a=e.length;i<a;)r=r>>>8^t[255&(r^e.charCodeAt(i++))];return~r},e.buf=function(e,n){for(var y=~n,b=e.length-15,w=0;w<b;)y=v[e[w++]^255&y]^g[e[w++]^y>>8&255]^m[e[w++]^y>>16&255]^p[e[w++]^y>>>24]^d[e[w++]]^f[e[w++]]^h[e[w++]]^u[e[w++]]^c[e[w++]]^l[e[w++]]^o[e[w++]]^s[e[w++]]^a[e[w++]]^i[e[w++]]^r[e[w++]]^t[e[w++]];for(b+=15;w<b;)y=y>>>8^t[255&(y^e[w++])];return~y},e.str=function(e,n){for(var r=~n,i=0,a=e.length,s=0,o=0;i<a;)(s=e.charCodeAt(i++))<128?r=r>>>8^t[255&(r^s)]:s<2048?r=(r=r>>>8^t[255&(r^(192|s>>6&31))])>>>8^t[255&(r^(128|63&s))]:s>=55296&&s<57344?(s=64+(1023&s),o=1023&e.charCodeAt(i++),r=(r=(r=(r=r>>>8^t[255&(r^(240|s>>8&7))])>>>8^t[255&(r^(128|s>>2&63))])>>>8^t[255&(r^(128|o>>6&15|(3&s)<<4))])>>>8^t[255&(r^(128|63&o))]):r=(r=(r=r>>>8^t[255&(r^(224|s>>12&15))])>>>8^t[255&(r^(128|s>>6&63))])>>>8^t[255&(r^(128|63&s))];return~r},e}(),hg=function(){var e,t={};function n(e){if("/"==e.charAt(e.length-1))return-1===e.slice(0,-1).indexOf("/")?e:n(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(0,t+1)}function r(e){if("/"==e.charAt(e.length-1))return r(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(t+1)}function i(e,t){"string"===typeof t&&(t=new Date(t));var n=t.getHours();n=(n=n<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e.write_shift(2,n);var r=t.getFullYear()-1980;r=(r=r<<4|t.getMonth()+1)<<5|t.getDate(),e.write_shift(2,r)}function a(e){sy(e,0);for(var t={},n=0;e.l<=e.length-4;){var r=e.read_shift(2),i=e.read_shift(2),a=e.l+i,s={};if(21589===r)1&(n=e.read_shift(1))&&(s.mtime=e.read_shift(4)),i>5&&(2&n&&(s.atime=e.read_shift(4)),4&n&&(s.ctime=e.read_shift(4))),s.mtime&&(s.mt=new Date(1e3*s.mtime));e.l=a,t[r]=s}return t}function s(){return e||(e={})}function o(e,t){if(80==e[0]&&75==e[1])return re(e,t);if(109==(32|e[0])&&105==(32|e[1]))return function(e,t){if("mime-version:"!=E(e.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var n=t&&t.root||"",r=(lm&&Buffer.isBuffer(e)?e.toString("binary"):E(e)).split("\r\n"),i=0,a="";for(i=0;i<r.length;++i)if(a=r[i],/^Content-Location:/i.test(a)&&(a=a.slice(a.indexOf("file")),n||(n=a.slice(0,a.lastIndexOf("/")+1)),a.slice(0,n.length)!=n))for(;n.length>0&&(n=(n=n.slice(0,n.length-1)).slice(0,n.lastIndexOf("/")+1),a.slice(0,n.length)!=n););var s=(r[1]||"").match(/boundary="(.*?)"/);if(!s)throw new Error("MAD cannot find boundary");var o="--"+(s[1]||""),l=[],c=[],u={FileIndex:l,FullPaths:c};f(u);var h,d=0;for(i=0;i<r.length;++i){var p=r[i];p!==o&&p!==o+"--"||(d++&&ce(u,r.slice(h,i),n),h=i)}return u}(e,t);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var n,r,i,a,s,o,d=512,p=[],m=e.slice(0,512);sy(m,0);var g=function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(y,"Header Signature: "),e.l+=16;var t=e.read_shift(2,"u");return[e.read_shift(2,"u"),t]}(m);switch(n=g[0]){case 3:d=512;break;case 4:d=4096;break;case 0:if(0==g[1])return re(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+n)}512!==d&&sy(m=e.slice(0,d),28);var b=e.slice(0,d);!function(e,t){var n=9;switch(e.l+=2,n=e.read_shift(2)){case 9:if(3!=t)throw new Error("Sector Shift: Expected 9 saw "+n);break;case 12:if(4!=t)throw new Error("Sector Shift: Expected 12 saw "+n);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+n)}e.chk("0600","Mini Sector Shift: "),e.chk("000000000000","Reserved: ")}(m,n);var w=m.read_shift(4,"i");if(3===n&&0!==w)throw new Error("# Directory Sectors: Expected 0 saw "+w);m.l+=4,a=m.read_shift(4,"i"),m.l+=4,m.chk("00100000","Mini Stream Cutoff Size: "),s=m.read_shift(4,"i"),r=m.read_shift(4,"i"),o=m.read_shift(4,"i"),i=m.read_shift(4,"i");for(var T=-1,S=0;S<109&&!((T=m.read_shift(4,"i"))<0);++S)p[S]=T;var x=function(e,t){for(var n=Math.ceil(e.length/t)-1,r=[],i=1;i<n;++i)r[i-1]=e.slice(i*t,(i+1)*t);return r[n-1]=e.slice(n*t),r}(e,d);c(o,i,x,d,p);var k=function(e,t,n,r){var i=e.length,a=[],s=[],o=[],l=[],c=r-1,u=0,h=0,f=0,d=0;for(u=0;u<i;++u)if(o=[],(f=u+t)>=i&&(f-=i),!s[f]){l=[];var p=[];for(h=f;h>=0;){p[h]=!0,s[h]=!0,o[o.length]=h,l.push(e[h]);var m=n[Math.floor(4*h/r)];if(r<4+(d=4*h&c))throw new Error("FAT boundary crossed: "+h+" 4 "+r);if(!e[m])break;if(p[h=Jv(e[m],d)])break}a[f]={nodes:o,data:Cv([l])}}return a}(x,a,p,d);k[a].name="!Directory",r>0&&s!==v&&(k[s].name="!MiniFAT"),k[p[0]].name="!FAT",k.fat_addrs=p,k.ssz=d;var _=[],C=[],A=[];!function(e,t,n,r,i,a,s,o){for(var c,f=0,d=r.length?2:0,p=t[e].data,m=0,g=0;m<p.length;m+=128){var y=p.slice(m,m+128);sy(y,64),g=y.read_shift(2),c=Iv(y,0,g-d),r.push(c);var b={name:c,type:y.read_shift(1),color:y.read_shift(1),L:y.read_shift(4,"i"),R:y.read_shift(4,"i"),C:y.read_shift(4,"i"),clsid:y.read_shift(16),state:y.read_shift(4,"i"),start:0,size:0};0!==y.read_shift(2)+y.read_shift(2)+y.read_shift(2)+y.read_shift(2)&&(b.ct=h(y,y.l-8)),0!==y.read_shift(2)+y.read_shift(2)+y.read_shift(2)+y.read_shift(2)&&(b.mt=h(y,y.l-8)),b.start=y.read_shift(4,"i"),b.size=y.read_shift(4,"i"),b.size<0&&b.start<0&&(b.size=b.type=0,b.start=v,b.name=""),5===b.type?(f=b.start,i>0&&f!==v&&(t[f].name="!StreamData")):b.size>=4096?(b.storage="fat",void 0===t[b.start]&&(t[b.start]=u(n,b.start,t.fat_addrs,t.ssz)),t[b.start].name=b.name,b.content=t[b.start].data.slice(0,b.size)):(b.storage="minifat",b.size<0?b.size=0:f!==v&&b.start!==v&&t[f]&&(b.content=l(b,t[f].data,(t[o]||{}).data))),b.content&&sy(b.content,0),a[c]=b,s.push(b)}}(a,k,x,_,r,{},C,s),function(e,t,n){for(var r=0,i=0,a=0,s=0,o=0,l=n.length,c=[],u=[];r<l;++r)c[r]=u[r]=r,t[r]=n[r];for(;o<u.length;++o)i=e[r=u[o]].L,a=e[r].R,s=e[r].C,c[r]===r&&(-1!==i&&c[i]!==i&&(c[r]=c[i]),-1!==a&&c[a]!==a&&(c[r]=c[a])),-1!==s&&(c[s]=r),-1!==i&&r!=c[r]&&(c[i]=c[r],u.lastIndexOf(i)<o&&u.push(i)),-1!==a&&r!=c[r]&&(c[a]=c[r],u.lastIndexOf(a)<o&&u.push(a));for(r=1;r<l;++r)c[r]===r&&(-1!==a&&c[a]!==a?c[r]=c[a]:-1!==i&&c[i]!==i&&(c[r]=c[i]));for(r=1;r<l;++r)if(0!==e[r].type){if((o=r)!=c[o])do{o=c[o],t[r]=t[o]+"/"+t[r]}while(0!==o&&-1!==c[o]&&o!=c[o]);c[r]=-1}for(t[0]+="/",r=1;r<l;++r)2!==e[r].type&&(t[r]+="/")}(C,A,_),_.shift();var I={FileIndex:C,FullPaths:A};return t&&t.raw&&(I.raw={header:b,sectors:x}),I}function l(e,t,n){for(var r=e.start,i=e.size,a=[],s=r;n&&i>0&&s>=0;)a.push(t.slice(s*g,s*g+g)),i-=g,s=Jv(n,4*s);return 0===a.length?ly(0):mm(a).slice(0,e.size)}function c(e,t,n,r,i){var a=v;if(e===v){if(0!==t)throw new Error("DIFAT chain shorter than expected")}else if(-1!==e){var s=n[e],o=(r>>>2)-1;if(!s)return;for(var l=0;l<o&&(a=Jv(s,4*l))!==v;++l)i.push(a);c(Jv(s,r-4),t-1,n,r,i)}}function u(e,t,n,r,i){var a=[],s=[];i||(i=[]);var o=r-1,l=0,c=0;for(l=t;l>=0;){i[l]=!0,a[a.length]=l,s.push(e[l]);var u=n[Math.floor(4*l/r)];if(r<4+(c=4*l&o))throw new Error("FAT boundary crossed: "+l+" 4 "+r);if(!e[u])break;l=Jv(e[u],c)}return{nodes:a,data:Cv([s])}}function h(e,t){return new Date(1e3*(Qv(e,t+4)/1e7*Math.pow(2,32)+Qv(e,t)/1e7-11644473600))}function f(e,t){var n=t||{},r=n.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=r+"/",e.FileIndex[0]={name:r,type:5}),n.CLSID&&(e.FileIndex[0].clsid=n.CLSID),function(e){var t="\x01Sh33tJ5";if(hg.find(e,"/"+t))return;var n=ly(4);n[0]=55,n[1]=n[3]=50,n[2]=54,e.FileIndex.push({name:t,type:2,content:n,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+t),d(e)}(e)}function d(e,t){f(e);for(var i=!1,a=!1,s=e.FullPaths.length-1;s>=0;--s){var o=e.FileIndex[s];switch(o.type){case 0:a?i=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:a=!0,isNaN(o.R*o.L*o.C)&&(i=!0),o.R>-1&&o.L>-1&&o.R==o.L&&(i=!0);break;default:i=!0}}if(i||t){var l=new Date(1987,1,19),c=0,u=Object.create?Object.create(null):{},h=[];for(s=0;s<e.FullPaths.length;++s)u[e.FullPaths[s]]=!0,0!==e.FileIndex[s].type&&h.push([e.FullPaths[s],e.FileIndex[s]]);for(s=0;s<h.length;++s){var d=n(h[s][0]);(a=u[d])||(h.push([d,{name:r(d).replace("/",""),type:1,clsid:w,ct:l,mt:l,content:null}]),u[d]=!0)}for(h.sort((function(e,t){return function(e,t){for(var n=e.split("/"),r=t.split("/"),i=0,a=0,s=Math.min(n.length,r.length);i<s;++i){if(a=n[i].length-r[i].length)return a;if(n[i]!=r[i])return n[i]<r[i]?-1:1}return n.length-r.length}(e[0],t[0])})),e.FullPaths=[],e.FileIndex=[],s=0;s<h.length;++s)e.FullPaths[s]=h[s][0],e.FileIndex[s]=h[s][1];for(s=0;s<h.length;++s){var p=e.FileIndex[s],m=e.FullPaths[s];if(p.name=r(m).replace("/",""),p.L=p.R=p.C=-(p.color=1),p.size=p.content?p.content.length:0,p.start=0,p.clsid=p.clsid||w,0===s)p.C=h.length>1?1:-1,p.size=0,p.type=5;else if("/"==m.slice(-1)){for(c=s+1;c<h.length&&n(e.FullPaths[c])!=m;++c);for(p.C=c>=h.length?-1:c,c=s+1;c<h.length&&n(e.FullPaths[c])!=n(m);++c);p.R=c>=h.length?-1:c,p.type=1}else n(e.FullPaths[s+1]||"")==n(m)&&(p.R=s+1),p.type=2}}}function p(e,t){var n=t||{};if("mad"==n.fileType)return function(e,t){for(var n=t||{},r=n.boundary||"SheetJS",i=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(r="------="+r).slice(2)+'"',"","",""],a=e.FullPaths[0],s=a,o=e.FileIndex[0],l=1;l<e.FullPaths.length;++l)if(s=e.FullPaths[l].slice(a.length),(o=e.FileIndex[l]).size&&o.content&&"\x01Sh33tJ5"!=s){s=s.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,(function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"})).replace(/[\u0080-\uFFFF]/g,(function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"}));for(var c=o.content,u=lm&&Buffer.isBuffer(c)?c.toString("binary"):E(c),h=0,f=Math.min(1024,u.length),d=0,p=0;p<=f;++p)(d=u.charCodeAt(p))>=32&&d<128&&++h;var m=h>=4*f/5;i.push(r),i.push("Content-Location: "+(n.root||"file:///C:/SheetJS/")+s),i.push("Content-Transfer-Encoding: "+(m?"quoted-printable":"base64")),i.push("Content-Type: "+se(o,s)),i.push(""),i.push(m?le(u):oe(u))}return i.push(r+"--\r\n"),i.join("\r\n")}(e,n);if(d(e),"zip"===n.fileType)return function(e,t){var n=t||{},r=[],a=[],s=ly(1),o=n.compression?8:0,l=0;0;var c=0,u=0,h=0,f=0,d=e.FullPaths[0],p=d,m=e.FileIndex[0],g=[],v=0;for(c=1;c<e.FullPaths.length;++c)if(p=e.FullPaths[c].slice(d.length),(m=e.FileIndex[c]).size&&m.content&&"\x01Sh33tJ5"!=p){var y=h,b=ly(p.length);for(u=0;u<p.length;++u)b.write_shift(1,127&p.charCodeAt(u));b=b.slice(0,b.l),g[f]=ug.buf(m.content,0);var w=m.content;8==o&&(w=S(w)),(s=ly(30)).write_shift(4,67324752),s.write_shift(2,20),s.write_shift(2,l),s.write_shift(2,o),m.mt?i(s,m.mt):s.write_shift(4,0),s.write_shift(-4,8&l?0:g[f]),s.write_shift(4,8&l?0:w.length),s.write_shift(4,8&l?0:m.content.length),s.write_shift(2,b.length),s.write_shift(2,0),h+=s.length,r.push(s),h+=b.length,r.push(b),h+=w.length,r.push(w),8&l&&((s=ly(12)).write_shift(-4,g[f]),s.write_shift(4,w.length),s.write_shift(4,m.content.length),h+=s.l,r.push(s)),(s=ly(46)).write_shift(4,33639248),s.write_shift(2,0),s.write_shift(2,20),s.write_shift(2,l),s.write_shift(2,o),s.write_shift(4,0),s.write_shift(-4,g[f]),s.write_shift(4,w.length),s.write_shift(4,m.content.length),s.write_shift(2,b.length),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(4,0),s.write_shift(4,y),v+=s.l,a.push(s),v+=b.length,a.push(b),++f}return s=ly(22),s.write_shift(4,101010256),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,f),s.write_shift(2,f),s.write_shift(4,v),s.write_shift(4,h),s.write_shift(2,0),mm([mm(r),mm(a),s])}(e,n);var r=function(e){for(var t=0,n=0,r=0;r<e.FileIndex.length;++r){var i=e.FileIndex[r];if(i.content){var a=i.content.length;a>0&&(a<4096?t+=a+63>>6:n+=a+511>>9)}}for(var s=e.FullPaths.length+3>>2,o=t+127>>7,l=(t+7>>3)+n+s+o,c=l+127>>7,u=c<=109?0:Math.ceil((c-109)/127);l+c+u+127>>7>c;)u=++c<=109?0:Math.ceil((c-109)/127);var h=[1,u,c,o,s,n,t,0];return e.FileIndex[0].size=t<<6,h[7]=(e.FileIndex[0].start=h[0]+h[1]+h[2]+h[3]+h[4]+h[5])+(h[6]+7>>3),h}(e),a=ly(r[7]<<9),s=0,o=0;for(s=0;s<8;++s)a.write_shift(1,b[s]);for(s=0;s<8;++s)a.write_shift(2,0);for(a.write_shift(2,62),a.write_shift(2,3),a.write_shift(2,65534),a.write_shift(2,9),a.write_shift(2,6),s=0;s<3;++s)a.write_shift(2,0);for(a.write_shift(4,0),a.write_shift(4,r[2]),a.write_shift(4,r[0]+r[1]+r[2]+r[3]-1),a.write_shift(4,0),a.write_shift(4,4096),a.write_shift(4,r[3]?r[0]+r[1]+r[2]-1:v),a.write_shift(4,r[3]),a.write_shift(-4,r[1]?r[0]-1:v),a.write_shift(4,r[1]),s=0;s<109;++s)a.write_shift(-4,s<r[2]?r[1]+s:-1);if(r[1])for(o=0;o<r[1];++o){for(;s<236+127*o;++s)a.write_shift(-4,s<r[2]?r[1]+s:-1);a.write_shift(-4,o===r[1]-1?v:o+1)}var l=function(e){for(o+=e;s<o-1;++s)a.write_shift(-4,s+1);e&&(++s,a.write_shift(-4,v))};for(o=s=0,o+=r[1];s<o;++s)a.write_shift(-4,T.DIFSECT);for(o+=r[2];s<o;++s)a.write_shift(-4,T.FATSECT);l(r[3]),l(r[4]);for(var c=0,u=0,h=e.FileIndex[0];c<e.FileIndex.length;++c)(h=e.FileIndex[c]).content&&((u=h.content.length)<4096||(h.start=o,l(u+511>>9)));for(l(r[6]+7>>3);511&a.l;)a.write_shift(-4,T.ENDOFCHAIN);for(o=s=0,c=0;c<e.FileIndex.length;++c)(h=e.FileIndex[c]).content&&(!(u=h.content.length)||u>=4096||(h.start=o,l(u+63>>6)));for(;511&a.l;)a.write_shift(-4,T.ENDOFCHAIN);for(s=0;s<r[4]<<2;++s){var f=e.FullPaths[s];if(f&&0!==f.length){h=e.FileIndex[s],0===s&&(h.start=h.size?h.start-1:v);var p=0===s&&n.root||h.name;if(u=2*(p.length+1),a.write_shift(64,p,"utf16le"),a.write_shift(2,u),a.write_shift(1,h.type),a.write_shift(1,h.color),a.write_shift(-4,h.L),a.write_shift(-4,h.R),a.write_shift(-4,h.C),h.clsid)a.write_shift(16,h.clsid,"hex");else for(c=0;c<4;++c)a.write_shift(4,0);a.write_shift(4,h.state||0),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(4,h.start),a.write_shift(4,h.size),a.write_shift(4,0)}else{for(c=0;c<17;++c)a.write_shift(4,0);for(c=0;c<3;++c)a.write_shift(4,-1);for(c=0;c<12;++c)a.write_shift(4,0)}}for(s=1;s<e.FileIndex.length;++s)if((h=e.FileIndex[s]).size>=4096)if(a.l=h.start+1<<9,lm&&Buffer.isBuffer(h.content))h.content.copy(a,a.l,0,h.size),a.l+=h.size+511&-512;else{for(c=0;c<h.size;++c)a.write_shift(1,h.content[c]);for(;511&c;++c)a.write_shift(1,0)}for(s=1;s<e.FileIndex.length;++s)if((h=e.FileIndex[s]).size>0&&h.size<4096)if(lm&&Buffer.isBuffer(h.content))h.content.copy(a,a.l,0,h.size),a.l+=h.size+63&-64;else{for(c=0;c<h.size;++c)a.write_shift(1,h.content[c]);for(;63&c;++c)a.write_shift(1,0)}if(lm)a.l=a.length;else for(;a.l<a.length;)a.write_shift(1,0);return a}t.version="1.2.1";var m,g=64,v=-2,y="d0cf11e0a1b11ae1",b=[208,207,17,224,161,177,26,225],w="00000000000000000000000000000000",T={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:v,FREESECT:-1,HEADER_SIGNATURE:y,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:w,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function E(e){for(var t=new Array(e.length),n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function S(e){return m?m.deflateRawSync(e):q(e)}var x=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],k=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],_=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function C(e){var t=139536&(e<<1|e<<11)|558144&(e<<5|e<<15);return 255&(t>>16|t>>8|t)}for(var A="undefined"!==typeof Uint8Array,I=A?new Uint8Array(256):[],N=0;N<256;++N)I[N]=C(N);function D(e,t){var n=I[255&e];return t<=8?n>>>8-t:(n=n<<8|I[e>>8&255],t<=16?n>>>16-t:(n=n<<8|I[e>>16&255])>>>24-t)}function O(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=6?0:e[r+1]<<8))>>>n&3}function R(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=5?0:e[r+1]<<8))>>>n&7}function P(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=3?0:e[r+1]<<8))>>>n&31}function L(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=1?0:e[r+1]<<8))>>>n&127}function M(e,t,n){var r=7&t,i=t>>>3,a=(1<<n)-1,s=e[i]>>>r;return n<8-r?s&a:(s|=e[i+1]<<8-r,n<16-r?s&a:(s|=e[i+2]<<16-r,n<24-r?s&a:(s|=e[i+3]<<24-r)&a))}function F(e,t,n){var r=7&t,i=t>>>3;return r<=5?e[i]|=(7&n)<<r:(e[i]|=n<<r&255,e[i+1]=(7&n)>>8-r),t+3}function z(e,t,n){return n=(1&n)<<(7&t),e[t>>>3]|=n,t+1}function U(e,t,n){var r=t>>>3;return n<<=7&t,e[r]|=255&n,n>>>=8,e[r+1]=n,t+8}function j(e,t,n){var r=t>>>3;return n<<=7&t,e[r]|=255&n,n>>>=8,e[r+1]=255&n,e[r+2]=n>>>8,t+16}function B(e,t){var n=e.length,r=2*n>t?2*n:t+5,i=0;if(n>=t)return e;if(lm){var a=hm(r);if(e.copy)e.copy(a);else for(;i<e.length;++i)a[i]=e[i];return a}if(A){var s=new Uint8Array(r);if(s.set)s.set(e);else for(;i<n;++i)s[i]=e[i];return s}return e.length=r,e}function V(e){for(var t=new Array(e),n=0;n<e;++n)t[n]=0;return t}function $(e,t,n){var r=1,i=0,a=0,s=0,o=0,l=e.length,c=A?new Uint16Array(32):V(32);for(a=0;a<32;++a)c[a]=0;for(a=l;a<n;++a)e[a]=0;l=e.length;var u=A?new Uint16Array(l):V(l);for(a=0;a<l;++a)c[i=e[a]]++,r<i&&(r=i),u[a]=0;for(c[0]=0,a=1;a<=r;++a)c[a+16]=o=o+c[a-1]<<1;for(a=0;a<l;++a)0!=(o=e[a])&&(u[a]=c[o+16]++);var h=0;for(a=0;a<l;++a)if(0!=(h=e[a]))for(o=D(u[a],r)>>r-h,s=(1<<r+4-h)-1;s>=0;--s)t[o|s<<h]=15&h|a<<4;return r}var H=A?new Uint16Array(512):V(512),W=A?new Uint16Array(32):V(32);if(!A){for(var G=0;G<512;++G)H[G]=0;for(G=0;G<32;++G)W[G]=0}!function(){for(var e=[],t=0;t<32;t++)e.push(5);$(e,W,32);var n=[];for(t=0;t<=143;t++)n.push(8);for(;t<=255;t++)n.push(9);for(;t<=279;t++)n.push(7);for(;t<=287;t++)n.push(8);$(n,H,288)}();var K=function(){for(var e=A?new Uint8Array(32768):[],t=0,n=0;t<_.length-1;++t)for(;n<_[t+1];++n)e[n]=t;for(;n<32768;++n)e[n]=29;var r=A?new Uint8Array(259):[];for(t=0,n=0;t<k.length-1;++t)for(;n<k[t+1];++n)r[n]=t;return function(t,n){return t.length<8?function(e,t){for(var n=0;n<e.length;){var r=Math.min(65535,e.length-n),i=n+r==e.length;for(t.write_shift(1,+i),t.write_shift(2,r),t.write_shift(2,65535&~r);r-- >0;)t[t.l++]=e[n++]}return t.l}(t,n):function(t,n){for(var i=0,a=0,s=A?new Uint16Array(32768):[];a<t.length;){var o=Math.min(65535,t.length-a);if(o<10){for(7&(i=F(n,i,+!(a+o!=t.length)))&&(i+=8-(7&i)),n.l=i/8|0,n.write_shift(2,o),n.write_shift(2,65535&~o);o-- >0;)n[n.l++]=t[a++];i=8*n.l}else{i=F(n,i,+!(a+o!=t.length)+2);for(var l=0;o-- >0;){var c=t[a],u=-1,h=0;if((u=s[l=32767&(l<<5^c)])&&((u|=-32768&a)>a&&(u-=32768),u<a))for(;t[u+h]==t[a+h]&&h<250;)++h;if(h>2){(c=r[h])<=22?i=U(n,i,I[c+1]>>1)-1:(U(n,i,3),U(n,i+=5,I[c-23]>>5),i+=3);var f=c<8?0:c-4>>2;f>0&&(j(n,i,h-k[c]),i+=f),c=e[a-u],i=U(n,i,I[c]>>3),i-=3;var d=c<4?0:c-2>>1;d>0&&(j(n,i,a-u-_[c]),i+=d);for(var p=0;p<h;++p)s[l]=32767&a,l=32767&(l<<5^t[a]),++a;o-=h-1}else c<=143?c+=48:i=z(n,i,1),i=U(n,i,I[c]),s[l]=32767&a,++a}i=U(n,i,0)-1}}return n.l=(i+7)/8|0,n.l}(t,n)}}();function q(e){var t=ly(50+Math.floor(1.1*e.length)),n=K(e,t);return t.slice(0,n)}var Y=A?new Uint16Array(32768):V(32768),X=A?new Uint16Array(32768):V(32768),Q=A?new Uint16Array(128):V(128),J=1,Z=1;function ee(e,t){var n=P(e,t)+257,r=P(e,t+=5)+1,i=function(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=4?0:e[r+1]<<8))>>>n&15}(e,t+=5)+4;t+=4;for(var a=0,s=A?new Uint8Array(19):V(19),o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=1,c=A?new Uint8Array(8):V(8),u=A?new Uint8Array(8):V(8),h=s.length,f=0;f<i;++f)s[x[f]]=a=R(e,t),l<a&&(l=a),c[a]++,t+=3;var d=0;for(c[0]=0,f=1;f<=l;++f)u[f]=d=d+c[f-1]<<1;for(f=0;f<h;++f)0!=(d=s[f])&&(o[f]=u[d]++);var p=0;for(f=0;f<h;++f)if(0!=(p=s[f])){d=I[o[f]]>>8-p;for(var m=(1<<7-p)-1;m>=0;--m)Q[d|m<<p]=7&p|f<<3}var g=[];for(l=1;g.length<n+r;)switch(t+=7&(d=Q[L(e,t)]),d>>>=3){case 16:for(a=3+O(e,t),t+=2,d=g[g.length-1];a-- >0;)g.push(d);break;case 17:for(a=3+R(e,t),t+=3;a-- >0;)g.push(0);break;case 18:for(a=11+L(e,t),t+=7;a-- >0;)g.push(0);break;default:g.push(d),l<d&&(l=d)}var v=g.slice(0,n),y=g.slice(n);for(f=n;f<286;++f)v[f]=0;for(f=r;f<30;++f)y[f]=0;return J=$(v,Y,286),Z=$(y,X,30),t}function te(e,t){var n=function(e,t){if(3==e[0]&&!(3&e[1]))return[um(t),2];for(var n=0,r=0,i=hm(t||1<<18),a=0,s=i.length>>>0,o=0,l=0;0==(1&r);)if(r=R(e,n),n+=3,r>>>1!=0)for(r>>1==1?(o=9,l=5):(n=ee(e,n),o=J,l=Z);;){!t&&s<a+32767&&(s=(i=B(i,a+32767)).length);var c=M(e,n,o),u=r>>>1==1?H[c]:Y[c];if(n+=15&u,0===((u>>>=4)>>>8&255))i[a++]=u;else{if(256==u)break;var h=(u-=257)<8?0:u-4>>2;h>5&&(h=0);var f=a+k[u];h>0&&(f+=M(e,n,h),n+=h),c=M(e,n,l),n+=15&(u=r>>>1==1?W[c]:X[c]);var d=(u>>>=4)<4?0:u-2>>1,p=_[u];for(d>0&&(p+=M(e,n,d),n+=d),!t&&s<f&&(s=(i=B(i,f+100)).length);a<f;)i[a]=i[a-p],++a}}else{7&n&&(n+=8-(7&n));var m=e[n>>>3]|e[1+(n>>>3)]<<8;if(n+=32,m>0)for(!t&&s<a+m&&(s=(i=B(i,a+m)).length);m-- >0;)i[a++]=e[n>>>3],n+=8}return t?[i,n+7>>>3]:[i.slice(0,a),n+7>>>3]}(e.slice(e.l||0),t);return e.l+=n[1],n[0]}function ne(e,t){if(!e)throw new Error(t);"undefined"!==typeof console&&console.error(t)}function re(e,t){var n=e;sy(n,0);var r={FileIndex:[],FullPaths:[]};f(r,{root:t.root});for(var i=n.length-4;(80!=n[i]||75!=n[i+1]||5!=n[i+2]||6!=n[i+3])&&i>=0;)--i;n.l=i+4,n.l+=4;var s=n.read_shift(2);n.l+=6;var o=n.read_shift(4);for(n.l=o,i=0;i<s;++i){n.l+=20;var l=n.read_shift(4),c=n.read_shift(4),u=n.read_shift(2),h=n.read_shift(2),d=n.read_shift(2);n.l+=8;var p=n.read_shift(4),m=a(n.slice(n.l+u,n.l+u+h));n.l+=u+h+d;var g=n.l;n.l=p+4,ie(n,l,c,r,m),n.l=g}return r}function ie(e,t,n,r,i){e.l+=2;var s=e.read_shift(2),o=e.read_shift(2),l=function(e){var t=65535&e.read_shift(2),n=65535&e.read_shift(2),r=new Date,i=31&n,a=15&(n>>>=5);n>>>=4,r.setMilliseconds(0),r.setFullYear(n+1980),r.setMonth(a-1),r.setDate(i);var s=31&t,o=63&(t>>>=5);return t>>>=6,r.setHours(t),r.setMinutes(o),r.setSeconds(s<<1),r}(e);if(8257&s)throw new Error("Unsupported ZIP encryption");e.read_shift(4);for(var c=e.read_shift(4),u=e.read_shift(4),h=e.read_shift(2),f=e.read_shift(2),d="",p=0;p<h;++p)d+=String.fromCharCode(e[e.l++]);if(f){var g=a(e.slice(e.l,e.l+f));(g[21589]||{}).mt&&(l=g[21589].mt),((i||{})[21589]||{}).mt&&(l=i[21589].mt)}e.l+=f;var v=e.slice(e.l,e.l+c);switch(o){case 8:v=function(e,t){if(!m)return te(e,t);var n=new(0,m.InflateRaw),r=n._processChunk(e.slice(e.l),n._finishFlushFlag);return e.l+=n.bytesRead,r}(e,u);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+o)}var y=!1;8&s&&(134695760==e.read_shift(4)&&(e.read_shift(4),y=!0),c=e.read_shift(4),u=e.read_shift(4)),c!=t&&ne(y,"Bad compressed size: "+t+" != "+c),u!=n&&ne(y,"Bad uncompressed size: "+n+" != "+u),ue(r,d,v,{unsafe:!0,mt:l})}var ae={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function se(e,t){if(e.ctype)return e.ctype;var n=e.name||"",r=n.match(/\.([^\.]+)$/);return r&&ae[r[1]]||t&&(r=(n=t).match(/[\.\\]([^\.\\])+$/))&&ae[r[1]]?ae[r[1]]:"application/octet-stream"}function oe(e){for(var t=sm(e),n=[],r=0;r<t.length;r+=76)n.push(t.slice(r,r+76));return n.join("\r\n")+"\r\n"}function le(e){var t=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,(function(e){var t=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==t.length?"0"+t:t)}));"\n"==(t=t.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(t="=0D"+t.slice(1));for(var n=[],r=(t=t.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),i=0;i<r.length;++i){var a=r[i];if(0!=a.length)for(var s=0;s<a.length;){var o=76,l=a.slice(s,s+o);"="==l.charAt(o-1)?o--:"="==l.charAt(o-2)?o-=2:"="==l.charAt(o-3)&&(o-=3),l=a.slice(s,s+o),(s+=o)<a.length&&(l+="="),n.push(l)}else n.push("")}return n.join("\r\n")}function ce(e,t,n){for(var r,i="",a="",s="",o=0;o<10;++o){var l=t[o];if(!l||l.match(/^\s*$/))break;var c=l.match(/^(.*?):\s*([^\s].*)$/);if(c)switch(c[1].toLowerCase()){case"content-location":i=c[2].trim();break;case"content-type":s=c[2].trim();break;case"content-transfer-encoding":a=c[2].trim()}}switch(++o,a.toLowerCase()){case"base64":r=fm(om(t.slice(o).join("")));break;case"quoted-printable":r=function(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n];n<=e.length&&"="==r.charAt(r.length-1);)r=r.slice(0,r.length-1)+e[++n];t.push(r)}for(var i=0;i<t.length;++i)t[i]=t[i].replace(/[=][0-9A-Fa-f]{2}/g,(function(e){return String.fromCharCode(parseInt(e.slice(1),16))}));return fm(t.join("\r\n"))}(t.slice(o));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+a)}var u=ue(e,i.slice(n.length),r,{unsafe:!0});s&&(u.ctype=s)}function ue(e,t,n,i){var a=i&&i.unsafe;a||f(e);var s=!a&&hg.find(e,t);if(!s){var o=e.FullPaths[0];t.slice(0,o.length)==o?o=t:("/"!=o.slice(-1)&&(o+="/"),o=(o+t).replace("//","/")),s={name:r(t),type:2},e.FileIndex.push(s),e.FullPaths.push(o),a||hg.utils.cfb_gc(e)}return s.content=n,s.size=n?n.length:0,i&&(i.CLSID&&(s.clsid=i.CLSID),i.mt&&(s.mt=i.mt),i.ct&&(s.ct=i.ct)),s}return t.find=function(e,t){var n=e.FullPaths.map((function(e){return e.toUpperCase()})),r=n.map((function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]})),i=!1;47===t.charCodeAt(0)?(i=!0,t=n[0].slice(0,-1)+t):i=-1!==t.indexOf("/");var a=t.toUpperCase(),s=!0===i?n.indexOf(a):r.indexOf(a);if(-1!==s)return e.FileIndex[s];var o=!a.match(vm);for(a=a.replace(gm,""),o&&(a=a.replace(vm,"!")),s=0;s<n.length;++s){if((o?n[s].replace(vm,"!"):n[s]).replace(gm,"")==a)return e.FileIndex[s];if((o?r[s].replace(vm,"!"):r[s]).replace(gm,"")==a)return e.FileIndex[s]}return null},t.read=function(t,n){var r=n&&n.type;switch(r||lm&&Buffer.isBuffer(t)&&(r="buffer"),r||"base64"){case"file":return function(t,n){return s(),o(e.readFileSync(t),n)}(t,n);case"base64":return o(fm(om(t)),n);case"binary":return o(fm(t),n)}return o(t,n)},t.parse=o,t.write=function(t,n){var r=p(t,n);switch(n&&n.type||"buffer"){case"file":return s(),e.writeFileSync(n.filename,r),r;case"binary":return"string"==typeof r?r:E(r);case"base64":return sm("string"==typeof r?r:E(r));case"buffer":if(lm)return Buffer.isBuffer(r)?r:cm(r);case"array":return"string"==typeof r?fm(r):r}return r},t.writeFile=function(t,n,r){s();var i=p(t,r);e.writeFileSync(n,i)},t.utils={cfb_new:function(e){var t={};return f(t,e),t},cfb_add:ue,cfb_del:function(e,t){f(e);var n=hg.find(e,t);if(n)for(var r=0;r<e.FileIndex.length;++r)if(e.FileIndex[r]==n)return e.FileIndex.splice(r,1),e.FullPaths.splice(r,1),!0;return!1},cfb_mov:function(e,t,n){f(e);var i=hg.find(e,t);if(i)for(var a=0;a<e.FileIndex.length;++a)if(e.FileIndex[a]==i)return e.FileIndex[a].name=r(n),e.FullPaths[a]=n,!0;return!1},cfb_gc:function(e){d(e,!0)},ReadShift:ey,CheckField:ay,prep_blob:sy,bconcat:mm,use_zlib:function(e){try{var t=new(0,e.InflateRaw);if(t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag),!t.bytesRead)throw new Error("zlib does not expose bytesRead");m=e}catch(n){console.error("cannot use native zlib: "+(n.message||n))}},_deflateRaw:q,_inflateRaw:te,consts:T},t}();let fg;function dg(e){return"string"===typeof e?dm(e):Array.isArray(e)?function(e){if("undefined"===typeof Uint8Array)throw new Error("Unsupported");return new Uint8Array(e)}(e):e}function pg(e,t,n){if("undefined"!==typeof fg&&fg.writeFileSync)return n?fg.writeFileSync(e,t,n):fg.writeFileSync(e,t);if("undefined"!==typeof Deno){if(n&&"string"==typeof t)switch(n){case"utf8":t=new TextEncoder(n).encode(t);break;case"binary":t=dm(t);break;default:throw new Error("Unsupported encoding "+n)}return Deno.writeFileSync(e,t)}var r="utf8"==n?Jg(t):t;if("undefined"!==typeof IE_SaveFile)return IE_SaveFile(r,e);if("undefined"!==typeof Blob){var i=new Blob([dg(r)],{type:"application/octet-stream"});if("undefined"!==typeof navigator&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if("undefined"!==typeof saveAs)return saveAs(i,e);if("undefined"!==typeof URL&&"undefined"!==typeof document&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(i);if("object"===typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&"undefined"!==typeof setTimeout&&setTimeout((function(){URL.revokeObjectURL(a)}),6e4),chrome.downloads.download({url:a,filename:e,saveAs:!0});var s=document.createElement("a");if(null!=s.download)return s.download=e,s.href=a,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&"undefined"!==typeof setTimeout&&setTimeout((function(){URL.revokeObjectURL(a)}),6e4),a}}if("undefined"!==typeof $&&"undefined"!==typeof File&&"undefined"!==typeof Folder)try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=pm(t)),o.write(t),o.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function mg(e){for(var t=Object.keys(e),n=[],r=0;r<t.length;++r)Object.prototype.hasOwnProperty.call(e,t[r])&&n.push(t[r]);return n}function gg(e,t){for(var n=[],r=mg(e),i=0;i!==r.length;++i)null==n[e[r[i]][t]]&&(n[e[r[i]][t]]=r[i]);return n}function vg(e){for(var t=[],n=mg(e),r=0;r!==n.length;++r)t[e[n[r]]]=n[r];return t}function yg(e){for(var t=[],n=mg(e),r=0;r!==n.length;++r)t[e[n[r]]]=parseInt(n[r],10);return t}var bg=new Date(1899,11,30,0,0,0);function wg(e,t){var n=e.getTime();return t&&(n-=1263168e5),(n-(bg.getTime()+6e4*(e.getTimezoneOffset()-bg.getTimezoneOffset())))/864e5}var Tg=new Date,Eg=bg.getTime()+6e4*(Tg.getTimezoneOffset()-bg.getTimezoneOffset()),Sg=Tg.getTimezoneOffset();function xg(e){var t=new Date;return t.setTime(24*e*60*60*1e3+Eg),t.getTimezoneOffset()!==Sg&&t.setTime(t.getTime()+6e4*(t.getTimezoneOffset()-Sg)),t}var kg=new Date("2017-02-19T19:06:09.000Z"),_g=isNaN(kg.getFullYear())?new Date("2/19/17"):kg,Cg=2017==_g.getFullYear();function Ag(e,t){var n=new Date(e);if(Cg)return t>0?n.setTime(n.getTime()+60*n.getTimezoneOffset()*1e3):t<0&&n.setTime(n.getTime()-60*n.getTimezoneOffset()*1e3),n;if(e instanceof Date)return e;if(1917==_g.getFullYear()&&!isNaN(n.getFullYear())){var r=n.getFullYear();return e.indexOf(""+r)>-1||n.setFullYear(n.getFullYear()+100),n}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-60*a.getTimezoneOffset()*1e3)),a}function Ig(e,t){if(lm&&Buffer.isBuffer(e)){if(t){if(255==e[0]&&254==e[1])return Jg(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return Jg(tm(e.slice(2).toString("binary")))}return e.toString("binary")}if("undefined"!==typeof TextDecoder)try{if(t){if(255==e[0]&&254==e[1])return Jg(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return Jg(new TextDecoder("utf-16be").decode(e.slice(2)))}var n={"\u20ac":"\x80","\u201a":"\x82","\u0192":"\x83","\u201e":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02c6":"\x88","\u2030":"\x89","\u0160":"\x8a","\u2039":"\x8b","\u0152":"\x8c","\u017d":"\x8e","\u2018":"\x91","\u2019":"\x92","\u201c":"\x93","\u201d":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02dc":"\x98","\u2122":"\x99","\u0161":"\x9a","\u203a":"\x9b","\u0153":"\x9c","\u017e":"\x9e","\u0178":"\x9f"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[\u20ac\u201a\u0192\u201e\u2026\u2020\u2021\u02c6\u2030\u0160\u2039\u0152\u017d\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u02dc\u2122\u0161\u203a\u0153\u017e\u0178]/g,(function(e){return n[e]||e}))}catch(a){}for(var r=[],i=0;i!=e.length;++i)r.push(String.fromCharCode(e[i]));return r.join("")}function Ng(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=Ng(e[n]));return t}function Dg(e,t){for(var n="";n.length<t;)n+=e;return n}function Og(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var n=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,(function(){return n*=100,""}));return isNaN(t=Number(r))?(r=r.replace(/[(](.*)[)]/,(function(e,t){return n=-n,t})),isNaN(t=Number(r))?t:t/n):t/n}var Rg=["january","february","march","april","may","june","july","august","september","october","november","december"];function Pg(e){var t=new Date(e),n=new Date(NaN),r=t.getYear(),i=t.getMonth(),a=t.getDate();if(isNaN(a))return n;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==Rg.indexOf(s))return n}else if(s.match(/[a-z]/))return n;return r<0||r>8099?n:(i>0||a>1)&&101!=r?t:e.match(/[^-0-9:,\/\\]/)?n:t}function Lg(e,t,n){if(e.FullPaths){var r;if("string"==typeof n)return r=lm?cm(n):function(e){for(var t=[],n=0,r=e.length+250,i=um(e.length+255),a=0;a<e.length;++a){var s=e.charCodeAt(a);if(s<128)i[n++]=s;else if(s<2048)i[n++]=192|s>>6&31,i[n++]=128|63&s;else if(s>=55296&&s<57344){s=64+(1023&s);var o=1023&e.charCodeAt(++a);i[n++]=240|s>>8&7,i[n++]=128|s>>2&63,i[n++]=128|o>>6&15|(3&s)<<4,i[n++]=128|63&o}else i[n++]=224|s>>12&15,i[n++]=128|s>>6&63,i[n++]=128|63&s;n>r&&(t.push(i.slice(0,n)),n=0,i=um(65535),r=65530)}return t.push(i.slice(0,n)),mm(t)}(n),hg.utils.cfb_add(e,t,r);hg.utils.cfb_add(e,t,n)}else e.file(t,n)}function Mg(){return hg.utils.cfb_new()}var Fg='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n';var zg={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Ug=vg(zg),jg=/[&<>'"]/g,Bg=/[\u0000-\u0008\u000b-\u001f]/g;function Vg(e){return(e+"").replace(jg,(function(e){return Ug[e]})).replace(Bg,(function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"}))}function $g(e){return Vg(e).replace(/ /g,"_x0020_")}var Hg=/[\u0000-\u001f]/g;function Wg(e){return(e+"").replace(jg,(function(e){return Ug[e]})).replace(/\n/g,"<br/>").replace(Hg,(function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"}))}function Gg(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Kg(e){for(var t="",n=0,r=0,i=0,a=0,s=0,o=0;n<e.length;)(r=e.charCodeAt(n++))<128?t+=String.fromCharCode(r):(i=e.charCodeAt(n++),r>191&&r<224?(s=(31&r)<<6,s|=63&i,t+=String.fromCharCode(s)):(a=e.charCodeAt(n++),r<240?t+=String.fromCharCode((15&r)<<12|(63&i)<<6|63&a):(o=((7&r)<<18|(63&i)<<12|(63&a)<<6|63&(s=e.charCodeAt(n++)))-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(1023&o)))));return t}function qg(e){var t,n,r,i=um(2*e.length),a=1,s=0,o=0;for(n=0;n<e.length;n+=a)a=1,(r=e.charCodeAt(n))<128?t=r:r<224?(t=64*(31&r)+(63&e.charCodeAt(n+1)),a=2):r<240?(t=4096*(15&r)+64*(63&e.charCodeAt(n+1))+(63&e.charCodeAt(n+2)),a=3):(a=4,t=262144*(7&r)+4096*(63&e.charCodeAt(n+1))+64*(63&e.charCodeAt(n+2))+(63&e.charCodeAt(n+3)),o=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==o&&(i[s++]=255&o,i[s++]=o>>>8,o=0),i[s++]=t%256,i[s++]=t>>>8;return i.slice(0,s).toString("ucs2")}function Yg(e){return cm(e,"binary").toString("utf8")}var Xg="foo bar baz\xe2\x98\x83\xf0\x9f\x8d\xa3",Qg=lm&&(Yg(Xg)==Kg(Xg)&&Yg||qg(Xg)==Kg(Xg)&&qg)||Kg,Jg=lm?function(e){return cm(e,"utf8").toString("binary")}:function(e){for(var t=[],n=0,r=0,i=0;n<e.length;)switch(r=e.charCodeAt(n++),!0){case r<128:t.push(String.fromCharCode(r));break;case r<2048:t.push(String.fromCharCode(192+(r>>6))),t.push(String.fromCharCode(128+(63&r)));break;case r>=55296&&r<57344:r-=55296,i=e.charCodeAt(n++)-56320+(r<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(63&i)));break;default:t.push(String.fromCharCode(224+(r>>12))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(63&r)))}return t.join("")},Zg=function(){var e=[["nbsp"," "],["middot","\xb7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map((function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]}));return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),r=0;r<e.length;++r)n=n.replace(e[r][0],e[r][1]);return n}}();var ev=/(^\s|\s$|\n)/;function tv(e,t){return"<"+e+(t.match(ev)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function nv(e){return mg(e).map((function(t){return" "+t+'="'+e[t]+'"'})).join("")}function rv(e,t,n){return"<"+e+(null!=n?nv(n):"")+(null!=t?(t.match(ev)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function iv(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(n){if(t)throw n}return""}var av="http://schemas.openxmlformats.org/package/2006/metadata/core-properties",sv="http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",ov="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",lv="http://schemas.openxmlformats.org/package/2006/content-types",cv="http://schemas.openxmlformats.org/package/2006/relationships",uv="http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",hv="http://purl.org/dc/elements/1.1/",fv="http://purl.org/dc/terms/",dv="http://purl.org/dc/dcmitype/",pv="http://schemas.openxmlformats.org/officeDocument/2006/relationships",mv="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",gv="http://www.w3.org/2001/XMLSchema-instance",vv="http://www.w3.org/2001/XMLSchema",yv=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],bv="urn:schemas-microsoft-com:office:office",wv="urn:schemas-microsoft-com:office:excel",Tv="urn:schemas-microsoft-com:office:spreadsheet",Ev="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",Sv="http://macVmlSchemaUri",xv="urn:schemas-microsoft-com:vml",kv="http://www.w3.org/TR/REC-html40";var _v=function(e){for(var t=[],n=0;n<e[0].length;++n)if(e[0][n])for(var r=0,i=e[0][n].length;r<i;r+=10240)t.push.apply(t,e[0][n].slice(r,r+10240));return t},Cv=lm?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map((function(e){return Buffer.isBuffer(e)?e:cm(e)}))):_v(e)}:_v,Av=function(e,t,n){for(var r=[],i=t;i<n;i+=2)r.push(String.fromCharCode(Yv(e,i)));return r.join("").replace(gm,"")},Iv=lm?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf16le",t,n).replace(gm,""):Av(e,t,n)}:Av,Nv=function(e,t,n){for(var r=[],i=t;i<t+n;++i)r.push(("0"+e[i].toString(16)).slice(-2));return r.join("")},Dv=lm?function(e,t,n){return Buffer.isBuffer(e)?e.toString("hex",t,t+n):Nv(e,t,n)}:Nv,Ov=function(e,t,n){for(var r=[],i=t;i<n;i++)r.push(String.fromCharCode(qv(e,i)));return r.join("")},Rv=lm?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf8",t,n):Ov(e,t,n)}:Ov,Pv=function(e,t){var n=Qv(e,t);return n>0?Rv(e,t+4,t+4+n-1):""},Lv=Pv,Mv=function(e,t){var n=Qv(e,t);return n>0?Rv(e,t+4,t+4+n-1):""},Fv=Mv,zv=function(e,t){var n=2*Qv(e,t);return n>0?Rv(e,t+4,t+4+n-1):""},Uv=zv,jv=function(e,t){var n=Qv(e,t);return n>0?Iv(e,t+4,t+4+n):""},Bv=jv,Vv=function(e,t){var n=Qv(e,t);return n>0?Rv(e,t+4,t+4+n):""},$v=Vv,Hv=function(e,t){return function(e,t){for(var n=1-2*(e[t+7]>>>7),r=((127&e[t+7])<<4)+(e[t+6]>>>4&15),i=15&e[t+6],a=5;a>=0;--a)i=256*i+e[t+a];return 2047==r?0==i?n*(1/0):NaN:(0==r?r=-1022:(r-=1023,i+=Math.pow(2,52)),n*Math.pow(2,r-52)*i)}(e,t)},Wv=Hv,Gv=function(e){return Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array};function Kv(){Iv=function(e,t,n){return nm.utils.decode(1200,e.slice(t,n)).replace(gm,"")},Rv=function(e,t,n){return nm.utils.decode(65001,e.slice(t,n))},Lv=function(e,t){var n=Qv(e,t);return n>0?nm.utils.decode(Yp,e.slice(t+4,t+4+n-1)):""},Fv=function(e,t){var n=Qv(e,t);return n>0?nm.utils.decode(qp,e.slice(t+4,t+4+n-1)):""},Uv=function(e,t){var n=2*Qv(e,t);return n>0?nm.utils.decode(1200,e.slice(t+4,t+4+n-1)):""},Bv=function(e,t){var n=Qv(e,t);return n>0?nm.utils.decode(1200,e.slice(t+4,t+4+n)):""},$v=function(e,t){var n=Qv(e,t);return n>0?nm.utils.decode(65001,e.slice(t+4,t+4+n)):""}}lm&&(Lv=function(e,t){if(!Buffer.isBuffer(e))return Pv(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},Fv=function(e,t){if(!Buffer.isBuffer(e))return Mv(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},Uv=function(e,t){if(!Buffer.isBuffer(e))return zv(e,t);var n=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n-1)},Bv=function(e,t){if(!Buffer.isBuffer(e))return jv(e,t);var n=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n)},$v=function(e,t){if(!Buffer.isBuffer(e))return Vv(e,t);var n=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+n)},Wv=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):Hv(e,t)},Gv=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array}),"undefined"!==typeof nm&&Kv();var qv=function(e,t){return e[t]},Yv=function(e,t){return 256*e[t+1]+e[t]},Xv=function(e,t){var n=256*e[t+1]+e[t];return n<32768?n:-1*(65535-n+1)},Qv=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Jv=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Zv=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function ey(e,t){var n,r,i,a,s,o,l="",c=[];switch(t){case"dbcs":if(o=this.l,lm&&Buffer.isBuffer(this))l=this.slice(this.l,this.l+2*e).toString("utf16le");else for(s=0;s<e;++s)l+=String.fromCharCode(Yv(this,o)),o+=2;e*=2;break;case"utf8":l=Rv(this,this.l,this.l+e);break;case"utf16le":e*=2,l=Iv(this,this.l,this.l+e);break;case"wstr":if("undefined"===typeof nm)return ey.call(this,e,"dbcs");l=nm.utils.decode(qp,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":l=Lv(this,this.l),e=4+Qv(this,this.l);break;case"lpstr-cp":l=Fv(this,this.l),e=4+Qv(this,this.l);break;case"lpwstr":l=Uv(this,this.l),e=4+2*Qv(this,this.l);break;case"lpp4":e=4+Qv(this,this.l),l=Bv(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+Qv(this,this.l),l=$v(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,l="";0!==(i=qv(this,this.l+e++));)c.push(rm(i));l=c.join("");break;case"_wstr":for(e=0,l="";0!==(i=Yv(this,this.l+e));)c.push(rm(i)),e+=2;e+=2,l=c.join("");break;case"dbcs-cont":for(l="",o=this.l,s=0;s<e;++s){if(this.lens&&-1!==this.lens.indexOf(o))return i=qv(this,o),this.l=o+1,a=ey.call(this,e-s,i?"dbcs-cont":"sbcs-cont"),c.join("")+a;c.push(rm(Yv(this,o))),o+=2}l=c.join(""),e*=2;break;case"cpstr":if("undefined"!==typeof nm){l=nm.utils.decode(qp,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(l="",o=this.l,s=0;s!=e;++s){if(this.lens&&-1!==this.lens.indexOf(o))return i=qv(this,o),this.l=o+1,a=ey.call(this,e-s,i?"dbcs-cont":"sbcs-cont"),c.join("")+a;c.push(rm(qv(this,o))),o+=1}l=c.join("");break;default:switch(e){case 1:return n=qv(this,this.l),this.l++,n;case 2:return n=("i"===t?Xv:Yv)(this,this.l),this.l+=2,n;case 4:case-4:return"i"===t||0===(128&this[this.l+3])?(n=(e>0?Jv:Zv)(this,this.l),this.l+=4,n):(r=Qv(this,this.l),this.l+=4,r);case 8:case-8:if("f"===t)return r=8==e?Wv(this,this.l):Wv([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,r;e=8;case 16:l=Dv(this,this.l,e)}}return this.l+=e,l}var ty=function(e,t,n){e[n]=255&t,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24&255},ny=function(e,t,n){e[n]=255&t,e[n+1]=t>>8&255,e[n+2]=t>>16&255,e[n+3]=t>>24&255},ry=function(e,t,n){e[n]=255&t,e[n+1]=t>>>8&255};function iy(e,t,n){var r=0,i=0;if("dbcs"===n){for(i=0;i!=t.length;++i)ry(this,t.charCodeAt(i),this.l+2*i);r=2*t.length}else if("sbcs"===n){if("undefined"!==typeof nm&&874==Yp)for(i=0;i!=t.length;++i){var a=nm.utils.encode(Yp,t.charAt(i));this[this.l+i]=a[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=255&t.charCodeAt(i);r=t.length}else{if("hex"===n){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}if("utf16le"===n){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var o=t.charCodeAt(i);this[this.l++]=255&o,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}switch(e){case 1:r=1,this[this.l]=255&t;break;case 2:r=2,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t;break;case 3:r=3,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t,t>>>=8,this[this.l+2]=255&t;break;case 4:r=4,ty(this,t,this.l);break;case 8:if(r=8,"f"===n){!function(e,t,n){var r=(t<0||1/t==-1/0?1:0)<<7,i=0,a=0,s=r?-t:t;isFinite(s)?0==s?i=a=0:(i=Math.floor(Math.log(s)/Math.LN2),a=s*Math.pow(2,52-i),i<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?i=-1022:(a-=Math.pow(2,52),i+=1023)):(i=2047,a=isNaN(t)?26985:0);for(var o=0;o<=5;++o,a/=256)e[n+o]=255&a;e[n+6]=(15&i)<<4|15&a,e[n+7]=i>>4|r}(this,t,this.l);break}case 16:break;case-4:r=4,ny(this,t,this.l)}}return this.l+=r,this}function ay(e,t){var n=Dv(this,this.l,e.length>>1);if(n!==e)throw new Error(t+"Expected "+e+" saw "+n);this.l+=e.length>>1}function sy(e,t){e.l=t,e.read_shift=ey,e.chk=ay,e.write_shift=iy}function oy(e,t){e.l+=t}function ly(e){var t=um(e);return sy(t,0),t}function cy(){var e=[],t=lm?256:2048,n=function(e){var t=ly(e);return sy(t,0),t},r=n(t),i=function(){r&&(r.length>r.l&&((r=r.slice(0,r.l)).l=r.length),r.length>0&&e.push(r),r=null)},a=function(e){return r&&e<r.length-r.l?r:(i(),r=n(Math.max(e+1,t)))};return{next:a,push:function(e){i(),null==(r=e).l&&(r.l=r.length),a(t)},end:function(){return i(),mm(e)},_bufs:e}}function uy(e,t,n,r){var i,a=+t;if(!isNaN(a)){r||(r=TE[a].p||(n||[]).length||0),i=1+(a>=128?1:0)+1,r>=128&&++i,r>=16384&&++i,r>=2097152&&++i;var s=e.next(i);a<=127?s.write_shift(1,a):(s.write_shift(1,128+(127&a)),s.write_shift(1,a>>7));for(var o=0;4!=o;++o){if(!(r>=128)){s.write_shift(1,r);break}s.write_shift(1,128+(127&r)),r>>=7}r>0&&Gv(n)&&e.push(n)}}function hy(e,t,n){var r=Ng(e);if(t.s?(r.cRel&&(r.c+=t.s.c),r.rRel&&(r.r+=t.s.r)):(r.cRel&&(r.c+=t.c),r.rRel&&(r.r+=t.r)),!n||n.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function fy(e,t,n){var r=Ng(e);return r.s=hy(r.s,t.s,n),r.e=hy(r.e,t.s,n),r}function dy(e,t){if(e.cRel&&e.c<0)for(e=Ng(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Ng(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var n=wy(e);return e.cRel||null==e.cRel||(n=n.replace(/^([A-Z])/,"$$$1")),e.rRel||null==e.rRel||(n=function(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(n)),n}function py(e,t){return 0!=e.s.r||e.s.rRel||e.e.r!=(t.biff>=12?1048575:t.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(t.biff>=12?16383:255)||e.e.cRel?dy(e.s,t.biff)+":"+dy(e.e,t.biff):(e.s.rRel?"":"$")+gy(e.s.r)+":"+(e.e.rRel?"":"$")+gy(e.e.r):(e.s.cRel?"":"$")+yy(e.s.c)+":"+(e.e.cRel?"":"$")+yy(e.e.c)}function my(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function gy(e){return""+(e+1)}function vy(e){for(var t=e.replace(/^\$([A-Z])/,"$1"),n=0,r=0;r!==t.length;++r)n=26*n+t.charCodeAt(r)-64;return n-1}function yy(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function by(e){for(var t=0,n=0,r=0;r<e.length;++r){var i=e.charCodeAt(r);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(n=26*n+(i-64))}return{c:n-1,r:t-1}}function wy(e){for(var t=e.c+1,n="";t;t=(t-1)/26|0)n=String.fromCharCode((t-1)%26+65)+n;return n+(e.r+1)}function Ty(e){var t=e.indexOf(":");return-1==t?{s:by(e),e:by(e)}:{s:by(e.slice(0,t)),e:by(e.slice(t+1))}}function Ey(e,t){return"undefined"===typeof t||"number"===typeof t?Ey(e.s,e.e):("string"!==typeof e&&(e=wy(e)),"string"!==typeof t&&(t=wy(t)),e==t?e:e+":"+t)}function Sy(e){var t={s:{c:0,r:0},e:{c:0,r:0}},n=0,r=0,i=0,a=e.length;for(n=0;r<a&&!((i=e.charCodeAt(r)-64)<1||i>26);++r)n=26*n+i;for(t.s.c=--n,n=0;r<a&&!((i=e.charCodeAt(r)-48)<0||i>9);++r)n=10*n+i;if(t.s.r=--n,r===a||10!=i)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++r,n=0;r!=a&&!((i=e.charCodeAt(r)-64)<1||i>26);++r)n=26*n+i;for(t.e.c=--n,n=0;r!=a&&!((i=e.charCodeAt(r)-48)<0||i>9);++r)n=10*n+i;return t.e.r=--n,t}function xy(e,t){var n="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=ag(e.z,n?wg(t):t)}catch(r){}try{return e.w=ag((e.XF||{}).numFmtId||(n?14:0),n?wg(t):t)}catch(r){return""+t}}function ky(e,t,n){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&n&&n.dateNF&&(e.z=n.dateNF),"e"==e.t?sb[e.v]||e.v:xy(e,void 0==t?e.v:t))}function _y(e,t){var n=t&&t.sheet?t.sheet:"Sheet1",r={};return r[n]=e,{SheetNames:[n],Sheets:r}}function Cy(e,t,n){var r=n||{},i=e?Array.isArray(e):r.dense;var a=e||(i?[]:{}),s=0,o=0;if(a&&null!=r.origin){if("number"==typeof r.origin)s=r.origin;else{var l="string"==typeof r.origin?by(r.origin):r.origin;s=l.r,o=l.c}a["!ref"]||(a["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var u=Sy(a["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),-1==s&&(c.e.r=s=u.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=t[h].length;++f)if("undefined"!==typeof t[h][f]){var d={v:t[h][f]},p=s+h,m=o+f;if(c.s.r>p&&(c.s.r=p),c.s.c>m&&(c.s.c=m),c.e.r<p&&(c.e.r=p),c.e.c<m&&(c.e.c=m),!t[h][f]||"object"!==typeof t[h][f]||Array.isArray(t[h][f])||t[h][f]instanceof Date)if(Array.isArray(d.v)&&(d.f=t[h][f][1],d.v=d.v[0]),null===d.v)if(d.f)d.t="n";else if(r.nullError)d.t="e",d.v=0;else{if(!r.sheetStubs)continue;d.t="z"}else"number"===typeof d.v?d.t="n":"boolean"===typeof d.v?d.t="b":d.v instanceof Date?(d.z=r.dateNF||Cm[14],r.cellDates?(d.t="d",d.w=ag(d.z,wg(d.v))):(d.t="n",d.v=wg(d.v),d.w=ag(d.z,d.v))):d.t="s";else d=t[h][f];if(i)a[p]||(a[p]=[]),a[p][m]&&a[p][m].z&&(d.z=a[p][m].z),a[p][m]=d;else{var g=wy({c:m,r:p});a[g]&&a[g].z&&(d.z=a[g].z),a[g]=d}}}return c.s.c<1e7&&(a["!ref"]=Ey(c)),a}function Ay(e,t){return Cy(null,e,t)}function Iy(e,t){return t||(t=ly(4)),t.write_shift(4,e),t}function Ny(e){var t=e.read_shift(4);return 0===t?"":e.read_shift(t,"dbcs")}function Dy(e,t){var n=!1;return null==t&&(n=!0,t=ly(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}function Oy(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Ry(e,t){var n=e.l,r=e.read_shift(1),i=Ny(e),a=[],s={t:i,h:i};if(0!==(1&r)){for(var o=e.read_shift(4),l=0;l!=o;++l)a.push(Oy(e));s.r=a}else s.r=[{ich:0,ifnt:0}];return e.l=n+t,s}var Py=Ry;function Ly(e,t){var n=!1;return null==t&&(n=!0,t=ly(23+4*e.t.length)),t.write_shift(1,1),Dy(e.t,t),t.write_shift(4,1),function(e,t){t||(t=ly(4)),t.write_shift(2,e.ich||0),t.write_shift(2,e.ifnt||0)}({ich:0,ifnt:0},t),n?t.slice(0,t.l):t}function My(e){var t=e.read_shift(4),n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:n}}function Fy(e,t){return null==t&&(t=ly(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function zy(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Uy(e,t){return null==t&&(t=ly(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var jy=Ny,By=Dy;function Vy(e){var t=e.read_shift(4);return 0===t||4294967295===t?"":e.read_shift(t,"dbcs")}function $y(e,t){var n=!1;return null==t&&(n=!0,t=ly(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}var Hy=Ny,Wy=Vy,Gy=$y;function Ky(e){var t=e.slice(e.l,e.l+4),n=1&t[0],r=2&t[0];e.l+=4;var i=0===r?Wv([0,0,0,0,252&t[0],t[1],t[2],t[3]],0):Jv(t,0)>>2;return n?i/100:i}function qy(e,t){null==t&&(t=ly(4));var n=0,r=0,i=100*e;if(e==(0|e)&&e>=-(1<<29)&&e<1<<29?r=1:i==(0|i)&&i>=-(1<<29)&&i<1<<29&&(r=1,n=1),!r)throw new Error("unsupported RkNumber "+e);t.write_shift(-4,((n?i:e)<<2)+(n+2))}function Yy(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Xy=Yy,Qy=function(e,t){return t||(t=ly(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t};function Jy(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Zy(e,t){return(t||ly(8)).write_shift(8,e,"f")}function eb(e,t){if(t||(t=ly(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;null!=e.index?(t.write_shift(1,2),t.write_shift(1,e.index)):null!=e.theme?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var n=e.tint||0;if(n>0?n*=32767:n<0&&(n*=32768),t.write_shift(2,n),e.rgb&&null==e.theme){var r=e.rgb||"FFFFFF";"number"==typeof r&&(r=("000000"+r.toString(16)).slice(-6)),t.write_shift(1,parseInt(r.slice(0,2),16)),t.write_shift(1,parseInt(r.slice(2,4),16)),t.write_shift(1,parseInt(r.slice(4,6),16)),t.write_shift(1,255)}else t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);return t}var tb=80,nb={1:{n:"CodePage",t:2},2:{n:"Category",t:tb},3:{n:"PresentationFormat",t:tb},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:tb},15:{n:"Company",t:tb},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:tb},27:{n:"ContentStatus",t:tb},28:{n:"Language",t:tb},29:{n:"Version",t:tb},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},rb={1:{n:"CodePage",t:2},2:{n:"Title",t:tb},3:{n:"Subject",t:tb},4:{n:"Author",t:tb},5:{n:"Keywords",t:tb},6:{n:"Comments",t:tb},7:{n:"Template",t:tb},8:{n:"LastAuthor",t:tb},9:{n:"RevNumber",t:tb},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:tb},19:{n:"DocSecurity",t:3},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}};function ib(e){return e.map((function(e){return[e>>16&255,e>>8&255,255&e]}))}var ab=Ng(ib([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),sb={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},ob={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},lb={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function cb(e,t){var n,r=function(e){for(var t=[],n=mg(e),r=0;r!==n.length;++r)null==t[e[n[r]]]&&(t[e[n[r]]]=[]),t[e[n[r]]].push(n[r]);return t}(ob),i=[];i[i.length]=Fg,i[i.length]=rv("Types",null,{xmlns:lv,"xmlns:xsd":vv,"xmlns:xsi":gv}),i=i.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map((function(e){return rv("Default",null,{Extension:e[0],ContentType:e[1]})})));var a=function(r){e[r]&&e[r].length>0&&(n=e[r][0],i[i.length]=rv("Override",null,{PartName:("/"==n[0]?"":"/")+n,ContentType:lb[r][t.bookType]||lb[r].xlsx}))},s=function(n){(e[n]||[]).forEach((function(e){i[i.length]=rv("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:lb[n][t.bookType]||lb[n].xlsx})}))},o=function(t){(e[t]||[]).forEach((function(e){i[i.length]=rv("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:r[t][0]})}))};return a("workbooks"),s("sheets"),s("charts"),o("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),s("metadata"),o("people"),i.length>2&&(i[i.length]="</Types>",i[1]=i[1].replace("/>",">")),i.join("")}var ub={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function hb(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function fb(e){var t=[Fg,rv("Relationships",null,{xmlns:cv})];return mg(e["!id"]).forEach((function(n){t[t.length]=rv("Relationship",null,e["!id"][n])})),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function db(e,t,n,r,i,a){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=r,i.Target=n,a?i.TargetMode=a:[ub.HLINK,ub.XPATH,ub.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}function pb(e,t,n){return['  <rdf:Description rdf:about="'+e+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(n||"odf")+"#"+t+'"/>\n',"  </rdf:Description>\n"].join("")}function mb(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Kp.version+"</meta:generator></office:meta></office:document-meta>"}var gb=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function vb(e,t,n,r,i){null==i[e]&&null!=t&&""!==t&&(i[e]=t,t=Vg(t),r[r.length]=n?rv(e,t,n):tv(e,t))}function yb(e,t){var n=t||{},r=[Fg,rv("cp:coreProperties",null,{"xmlns:cp":av,"xmlns:dc":hv,"xmlns:dcterms":fv,"xmlns:dcmitype":dv,"xmlns:xsi":gv})],i={};if(!e&&!n.Props)return r.join("");e&&(null!=e.CreatedDate&&vb("dcterms:created","string"===typeof e.CreatedDate?e.CreatedDate:iv(e.CreatedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i),null!=e.ModifiedDate&&vb("dcterms:modified","string"===typeof e.ModifiedDate?e.ModifiedDate:iv(e.ModifiedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i));for(var a=0;a!=gb.length;++a){var s=gb[a],o=n.Props&&null!=n.Props[s[1]]?n.Props[s[1]]:e?e[s[1]]:null;!0===o?o="1":!1===o?o="0":"number"==typeof o&&(o=String(o)),null!=o&&vb(s[0],o,null,r,i)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var bb=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],wb=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Tb(e){var t=[],n=rv;return e||(e={}),e.Application="SheetJS",t[t.length]=Fg,t[t.length]=rv("Properties",null,{xmlns:ov,"xmlns:vt":mv}),bb.forEach((function(r){if(void 0!==e[r[1]]){var i;switch(r[2]){case"string":i=Vg(String(e[r[1]]));break;case"bool":i=e[r[1]]?"true":"false"}void 0!==i&&(t[t.length]=n(r[0],i))}})),t[t.length]=n("HeadingPairs",n("vt:vector",n("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+n("vt:variant",n("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=n("TitlesOfParts",n("vt:vector",e.SheetNames.map((function(e){return"<vt:lpstr>"+Vg(e)+"</vt:lpstr>"})).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function Eb(e){var t=[Fg,rv("Properties",null,{xmlns:sv,"xmlns:vt":mv})];if(!e)return t.join("");var n=1;return mg(e).forEach((function(r){++n,t[t.length]=rv("property",function(e,t){switch(typeof e){case"string":var n=rv("vt:lpwstr",Vg(e));return t&&(n=n.replace(/&quot;/g,"_x0022_")),n;case"number":return rv((0|e)==e?"vt:i4":"vt:r8",Vg(String(e)));case"boolean":return rv("vt:bool",e?"true":"false")}if(e instanceof Date)return rv("vt:filetime",iv(e));throw new Error("Unable to serialize "+e)}(e[r],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:n,name:Vg(r)})})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Sb={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function xb(e,t){var n=ly(4),r=ly(4);switch(n.write_shift(4,80==e?31:e),e){case 3:r.write_shift(-4,t);break;case 5:(r=ly(8)).write_shift(8,t,"f");break;case 11:r.write_shift(4,t?1:0);break;case 64:r=function(e){var t=("string"==typeof e?new Date(Date.parse(e)):e).getTime()/1e3+11644473600,n=t%Math.pow(2,32),r=(t-n)/Math.pow(2,32);r*=1e7;var i=(n*=1e7)/Math.pow(2,32)|0;i>0&&(n%=Math.pow(2,32),r+=i);var a=ly(8);return a.write_shift(4,n),a.write_shift(4,r),a}(t);break;case 31:case 80:for((r=ly(4+2*(t.length+1)+(t.length%2?0:2))).write_shift(4,t.length+1),r.write_shift(0,t,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return mm([n,r])}var kb=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function _b(e){switch(typeof e){case"boolean":return 11;case"number":return(0|e)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64}return-1}function Cb(e,t,n){var r=ly(8),i=[],a=[],s=8,o=0,l=ly(8),c=ly(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),a.push(l),i.push(c),s+=8+l.length,!t){(c=ly(8)).write_shift(4,0),i.unshift(c);var u=[ly(4)];for(u[0].write_shift(4,e.length),o=0;o<e.length;++o){var h=e[o][0];for((l=ly(8+2*(h.length+1)+(h.length%2?0:2))).write_shift(4,o+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=mm(u),a.unshift(l),s+=8+l.length}for(o=0;o<e.length;++o)if((!t||t[e[o][0]])&&!(kb.indexOf(e[o][0])>-1||wb.indexOf(e[o][0])>-1)&&null!=e[o][1]){var f=e[o][1],d=0;if(t){var p=n[d=+t[e[o][0]]];if("version"==p.p&&"string"==typeof f){var m=f.split(".");f=(+m[0]<<16)+(+m[1]||0)}l=xb(p.t,f)}else{var g=_b(f);-1==g&&(g=31,f=String(f)),l=xb(g,f)}a.push(l),(c=ly(8)).write_shift(4,t?d:2+o),i.push(c),s+=8+l.length}var v=8*(a.length+1);for(o=0;o<a.length;++o)i[o].write_shift(4,v),v+=a[o].length;return r.write_shift(4,s),r.write_shift(4,a.length),mm([r].concat(i).concat(a))}function Ab(e,t,n,r,i,a){var s=ly(i?68:48),o=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,hg.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,i?2:1),s.write_shift(16,t,"hex"),s.write_shift(4,i?68:48);var l=Cb(e,n,r);if(o.push(l),i){var c=Cb(i,null,null);s.write_shift(16,a,"hex"),s.write_shift(4,68+l.length),o.push(c)}return mm(o)}function Ib(e,t){return 1===e.read_shift(t)}function Nb(e,t){return t||(t=ly(2)),t.write_shift(2,+!!e),t}function Db(e){return e.read_shift(2,"u")}function Ob(e,t){return t||(t=ly(2)),t.write_shift(2,e),t}function Rb(e,t,n){return n||(n=ly(2)),n.write_shift(1,"e"==t?+e:+!!e),n.write_shift(1,"e"==t?1:0),n}function Pb(e,t,n){var r=e.read_shift(n&&n.biff>=12?2:1),i="sbcs-cont",a=qp;(n&&n.biff>=8&&(qp=1200),n&&8!=n.biff)?12==n.biff&&(i="wstr"):e.read_shift(1)&&(i="dbcs-cont");n.biff>=2&&n.biff<=5&&(i="cpstr");var s=r?e.read_shift(r,i):"";return qp=a,s}function Lb(e){var t=e.t||"",n=ly(3);n.write_shift(2,t.length),n.write_shift(1,1);var r=ly(2*t.length);return r.write_shift(2*t.length,t,"utf16le"),mm([n,r])}function Mb(e,t,n){if(n){if(n.biff>=2&&n.biff<=5)return e.read_shift(t,"cpstr");if(n.biff>=12)return e.read_shift(t,"dbcs-cont")}return 0===e.read_shift(1)?e.read_shift(t,"sbcs-cont"):e.read_shift(t,"dbcs-cont")}function Fb(e,t,n){var r=e.read_shift(n&&2==n.biff?1:2);return 0===r?(e.l++,""):Mb(e,r,n)}function zb(e,t,n){if(n.biff>5)return Fb(e,0,n);var r=e.read_shift(1);return 0===r?(e.l++,""):e.read_shift(r,n.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Ub(e,t,n){return n||(n=ly(3+2*e.length)),n.write_shift(2,e.length),n.write_shift(1,1),n.write_shift(31,e,"utf16le"),n}function jb(e,t){t||(t=ly(6+2*e.length)),t.write_shift(4,1+e.length);for(var n=0;n<e.length;++n)t.write_shift(2,e.charCodeAt(n));return t.write_shift(2,0),t}function Bb(e){var t=ly(512),n=0,r=e.Target;"file://"==r.slice(0,7)&&(r=r.slice(7));var i=r.indexOf("#"),a=i>-1?31:23;switch(r.charAt(0)){case"#":a=28;break;case".":a&=-3}t.write_shift(4,2),t.write_shift(4,a);var s=[8,6815827,6619237,4849780,83];for(n=0;n<s.length;++n)t.write_shift(4,s[n]);if(28==a)jb(r=r.slice(1),t);else if(2&a){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<s.length;++n)t.write_shift(1,parseInt(s[n],16));var o=i>-1?r.slice(0,i):r;for(t.write_shift(4,2*(o.length+1)),n=0;n<o.length;++n)t.write_shift(2,o.charCodeAt(n));t.write_shift(2,0),8&a&&jb(i>-1?r.slice(i+1):"",t)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),n=0;n<s.length;++n)t.write_shift(1,parseInt(s[n],16));for(var l=0;"../"==r.slice(3*l,3*l+3)||"..\\"==r.slice(3*l,3*l+3);)++l;for(t.write_shift(2,l),t.write_shift(4,r.length-3*l+1),n=0;n<r.length-3*l;++n)t.write_shift(1,255&r.charCodeAt(n+3*l));for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),n=0;n<6;++n)t.write_shift(4,0)}return t.slice(0,t.l)}function Vb(e,t,n,r){return r||(r=ly(6)),r.write_shift(2,e),r.write_shift(2,t),r.write_shift(2,n||0),r}function $b(e,t,n){var r=n.biff>8?4:2;return[e.read_shift(r),e.read_shift(r,"i"),e.read_shift(r,"i")]}function Hb(e){var t=e.read_shift(2),n=e.read_shift(2);return{s:{c:e.read_shift(2),r:t},e:{c:e.read_shift(2),r:n}}}function Wb(e,t){return t||(t=ly(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Gb(e,t,n){var r=1536,i=16;switch(n.bookType){case"biff8":case"xla":break;case"biff5":r=1280,i=8;break;case"biff4":r=4,i=6;break;case"biff3":r=3,i=6;break;case"biff2":r=2,i=4;break;default:throw new Error("unsupported BIFF version")}var a=ly(i);return a.write_shift(2,r),a.write_shift(2,t),i>4&&a.write_shift(2,29282),i>6&&a.write_shift(2,1997),i>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function Kb(e,t){var n=!t||t.biff>=8?2:1,r=ly(8+n*e.name.length);r.write_shift(4,e.pos),r.write_shift(1,e.hs||0),r.write_shift(1,e.dt),r.write_shift(1,e.name.length),t.biff>=8&&r.write_shift(1,1),r.write_shift(n*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=r.slice(0,r.l);return i.l=r.l,i}function qb(e,t,n,r){var i=n&&5==n.biff;r||(r=ly(i?3+t.length:5+2*t.length)),r.write_shift(2,e),r.write_shift(i?1:2,t.length),i||r.write_shift(1,1),r.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var a=r.length>r.l?r.slice(0,r.l):r;return null==a.l&&(a.l=a.length),a}function Yb(e,t,n,r){var i=n&&5==n.biff;r||(r=ly(i?16:20)),r.write_shift(2,0),e.style?(r.write_shift(2,e.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,e.numFmtId||0),r.write_shift(2,t<<4));var a=0;return e.numFmtId>0&&i&&(a|=1024),r.write_shift(4,a),r.write_shift(4,0),i||r.write_shift(4,0),r.write_shift(2,0),r}function Xb(e,t,n){if(n.biff<8)return function(e,t,n){3==e[e.l+1]&&e[e.l]++;var r=Pb(e,0,n);return 3==r.charCodeAt(0)?r.slice(1):r}(e,0,n);for(var r=[],i=e.l+t,a=e.read_shift(n.biff>8?4:2);0!==a--;)r.push($b(e,n.biff,n));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return r}function Qb(e){var t=ly(24),n=by(e[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(r[i],16));return mm([t,Bb(e[1])])}function Jb(e){var t=e[1].Tooltip,n=ly(10+2*(t.length+1));n.write_shift(2,2048);var r=by(e[0]);n.write_shift(2,r.r),n.write_shift(2,r.r),n.write_shift(2,r.c),n.write_shift(2,r.c);for(var i=0;i<t.length;++i)n.write_shift(2,t.charCodeAt(i));return n.write_shift(2,0),n}function Zb(e,t,n){if(!n.cellStyles)return oy(e,t);var r=n&&n.biff>=12?4:2,i=e.read_shift(r),a=e.read_shift(r),s=e.read_shift(r),o=e.read_shift(r),l=e.read_shift(2);2==r&&(e.l+=2);var c={s:i,e:a,w:s,ixfe:o,flags:l};return(n.biff>=5||!n.biff)&&(c.level=l>>8&7),c}var ew=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=vg({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(t,n){var r=n||{};r.dateNF||(r.dateNF="yyyymmdd");var i=Ay(function(t,n){var r=[],i=um(1);switch(n.type){case"base64":i=fm(om(t));break;case"binary":i=fm(t);break;case"buffer":case"array":i=t}sy(i,0);var a=i.read_shift(1),s=!!(136&a),o=!1,l=!1;switch(a){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:o=!0,s=!0;break;case 140:l=!0;break;default:throw new Error("DBF Unsupported Version: "+a.toString(16))}var c=0,u=521;2==a&&(c=i.read_shift(2)),i.l+=3,2!=a&&(c=i.read_shift(4)),c>1048576&&(c=1e6),2!=a&&(u=i.read_shift(2));var h=i.read_shift(2),f=n.codepage||1252;2!=a&&(i.l+=16,i.read_shift(1),0!==i[i.l]&&(f=e[i[i.l]]),i.l+=1,i.l+=2),l&&(i.l+=36);for(var d=[],p={},m=Math.min(i.length,2==a?521:u-10-(o?264:0)),g=l?32:11;i.l<m&&13!=i[i.l];)switch((p={}).name=nm.utils.decode(f,i.slice(i.l,i.l+g)).replace(/[\u0000\r\n].*$/g,""),i.l+=g,p.type=String.fromCharCode(i.read_shift(1)),2==a||l||(p.offset=i.read_shift(4)),p.len=i.read_shift(1),2==a&&(p.offset=i.read_shift(2)),p.dec=i.read_shift(1),p.name.length&&d.push(p),2!=a&&(i.l+=l?13:14),p.type){case"B":o&&8==p.len||!n.WTF||console.log("Skipping "+p.name+":"+p.type);break;case"G":case"P":n.WTF&&console.log("Skipping "+p.name+":"+p.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+p.type)}if(13!==i[i.l]&&(i.l=u-1),13!==i.read_shift(1))throw new Error("DBF Terminator not found "+i.l+" "+i[i.l]);i.l=u;var v=0,y=0;for(r[0]=[],y=0;y!=d.length;++y)r[0][y]=d[y].name;for(;c-- >0;)if(42!==i[i.l])for(++i.l,r[++v]=[],y=0,y=0;y!=d.length;++y){var b=i.slice(i.l,i.l+d[y].len);i.l+=d[y].len,sy(b,0);var w=nm.utils.decode(f,b);switch(d[y].type){case"C":w.trim().length&&(r[v][y]=w.replace(/\s+$/,""));break;case"D":8===w.length?r[v][y]=new Date(+w.slice(0,4),+w.slice(4,6)-1,+w.slice(6,8)):r[v][y]=w;break;case"F":r[v][y]=parseFloat(w.trim());break;case"+":case"I":r[v][y]=l?2147483648^b.read_shift(-4,"i"):b.read_shift(4,"i");break;case"L":switch(w.trim().toUpperCase()){case"Y":case"T":r[v][y]=!0;break;case"N":case"F":r[v][y]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+w+"|")}break;case"M":if(!s)throw new Error("DBF Unexpected MEMO for type "+a.toString(16));r[v][y]="##MEMO##"+(l?parseInt(w.trim(),10):b.read_shift(4));break;case"N":(w=w.replace(/\u0000/g,"").trim())&&"."!=w&&(r[v][y]=+w||0);break;case"@":r[v][y]=new Date(b.read_shift(-8,"f")-621356832e5);break;case"T":r[v][y]=new Date(864e5*(b.read_shift(4)-2440588)+b.read_shift(4));break;case"Y":r[v][y]=b.read_shift(4,"i")/1e4+b.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":r[v][y]=-b.read_shift(-8,"f");break;case"B":if(o&&8==d[y].len){r[v][y]=b.read_shift(8,"f");break}case"G":case"P":b.l+=d[y].len;break;case"0":if("_NullFlags"===d[y].name)break;default:throw new Error("DBF Unsupported data type "+d[y].type)}}else i.l+=h;if(2!=a&&i.l<i.length&&26!=i[i.l++])throw new Error("DBF EOF Marker missing "+(i.l-1)+" of "+i.length+" "+i[i.l-1].toString(16));return n&&n.sheetRows&&(r=r.slice(0,n.sheetRows)),n.DBF=d,r}(t,r),r);return i["!cols"]=r.DBF.map((function(e){return{wch:e.len,DBF:e}})),delete r.DBF,i}var r={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function(e,t){try{return _y(n(e,t),t)}catch(r){if(t&&t.WTF)throw r}return{SheetNames:[],Sheets:{}}},to_sheet:n,from_sheet:function(e,n){var i=n||{};if(+i.codepage>=0&&Zp(+i.codepage),"string"==i.type)throw new Error("Cannot write DBF to JS string");var a=cy(),s=yS(e,{header:1,raw:!0,cellDates:!0}),o=s[0],l=s.slice(1),c=e["!cols"]||[],u=0,h=0,f=0,d=1;for(u=0;u<o.length;++u)if(((c[u]||{}).DBF||{}).name)o[u]=c[u].DBF.name,++f;else if(null!=o[u]){if(++f,"number"===typeof o[u]&&(o[u]=o[u].toString(10)),"string"!==typeof o[u])throw new Error("DBF Invalid column name "+o[u]+" |"+typeof o[u]+"|");if(o.indexOf(o[u])!==u)for(h=0;h<1024;++h)if(-1==o.indexOf(o[u]+"_"+h)){o[u]+="_"+h;break}}var p=Sy(e["!ref"]),m=[],g=[],v=[];for(u=0;u<=p.e.c-p.s.c;++u){var y="",b="",w=0,T=[];for(h=0;h<l.length;++h)null!=l[h][u]&&T.push(l[h][u]);if(0!=T.length&&null!=o[u]){for(h=0;h<T.length;++h){switch(typeof T[h]){case"number":b="B";break;case"string":default:b="C";break;case"boolean":b="L";break;case"object":b=T[h]instanceof Date?"D":"C"}w=Math.max(w,String(T[h]).length),y=y&&y!=b?"C":b}w>250&&(w=250),"C"==(b=((c[u]||{}).DBF||{}).type)&&c[u].DBF.len>w&&(w=c[u].DBF.len),"B"==y&&"N"==b&&(y="N",v[u]=c[u].DBF.dec,w=c[u].DBF.len),g[u]="C"==y||"N"==b?w:r[y]||0,d+=g[u],m[u]=y}else m[u]="?"}var E=a.next(32);for(E.write_shift(4,318902576),E.write_shift(4,l.length),E.write_shift(2,296+32*f),E.write_shift(2,d),u=0;u<4;++u)E.write_shift(4,0);for(E.write_shift(4,(+t[Yp]||3)<<8),u=0,h=0;u<o.length;++u)if(null!=o[u]){var S=a.next(32),x=(o[u].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);S.write_shift(1,x,"sbcs"),S.write_shift(1,"?"==m[u]?"C":m[u],"sbcs"),S.write_shift(4,h),S.write_shift(1,g[u]||r[m[u]]||0),S.write_shift(1,v[u]||0),S.write_shift(1,2),S.write_shift(4,0),S.write_shift(1,0),S.write_shift(4,0),S.write_shift(4,0),h+=g[u]||r[m[u]]||0}var k=a.next(264);for(k.write_shift(4,13),u=0;u<65;++u)k.write_shift(4,0);for(u=0;u<l.length;++u){var _=a.next(d);for(_.write_shift(1,0),h=0;h<o.length;++h)if(null!=o[h])switch(m[h]){case"L":_.write_shift(1,null==l[u][h]?63:l[u][h]?84:70);break;case"B":_.write_shift(8,l[u][h]||0,"f");break;case"N":var C="0";for("number"==typeof l[u][h]&&(C=l[u][h].toFixed(v[h]||0)),f=0;f<g[h]-C.length;++f)_.write_shift(1,32);_.write_shift(1,C,"sbcs");break;case"D":l[u][h]?(_.write_shift(4,("0000"+l[u][h].getFullYear()).slice(-4),"sbcs"),_.write_shift(2,("00"+(l[u][h].getMonth()+1)).slice(-2),"sbcs"),_.write_shift(2,("00"+l[u][h].getDate()).slice(-2),"sbcs")):_.write_shift(8,"00000000","sbcs");break;case"C":var A=String(null!=l[u][h]?l[u][h]:"").slice(0,g[h]);for(_.write_shift(1,A,"sbcs"),f=0;f<g[h]-A.length;++f)_.write_shift(1,32)}}return a.next(1).write_shift(1,26),a.end()}}}(),tw=function(){var e={AA:"\xc0",BA:"\xc1",CA:"\xc2",DA:195,HA:"\xc4",JA:197,AE:"\xc8",BE:"\xc9",CE:"\xca",HE:"\xcb",AI:"\xcc",BI:"\xcd",CI:"\xce",HI:"\xcf",AO:"\xd2",BO:"\xd3",CO:"\xd4",DO:213,HO:"\xd6",AU:"\xd9",BU:"\xda",CU:"\xdb",HU:"\xdc",Aa:"\xe0",Ba:"\xe1",Ca:"\xe2",Da:227,Ha:"\xe4",Ja:229,Ae:"\xe8",Be:"\xe9",Ce:"\xea",He:"\xeb",Ai:"\xec",Bi:"\xed",Ci:"\xee",Hi:"\xef",Ao:"\xf2",Bo:"\xf3",Co:"\xf4",Do:245,Ho:"\xf6",Au:"\xf9",Bu:"\xfa",Cu:"\xfb",Hu:"\xfc",KC:"\xc7",Kc:"\xe7",q:"\xe6",z:"\u0153",a:"\xc6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1bN("+mg(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(t,n){var r=e[n];return"number"==typeof r?im(r):r},r=function(e,t,n){var r=t.charCodeAt(0)-32<<4|n.charCodeAt(0)-48;return 59==r?e:im(r)};function i(e,i){var a,s=e.split(/[\n\r]+/),o=-1,l=-1,c=0,u=0,h=[],f=[],d=null,p={},m=[],g=[],v=[],y=0;for(+i.codepage>=0&&Zp(+i.codepage);c!==s.length;++c){y=0;var b,w=s[c].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(t,n),T=w.replace(/;;/g,"\0").split(";").map((function(e){return e.replace(/\u0000/g,";")})),E=T[0];if(w.length>0)switch(E){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==T[1].charAt(0)&&f.push(w.slice(3).replace(/;;/g,";"));break;case"C":var S=!1,x=!1,k=!1,_=!1,C=-1,A=-1;for(u=1;u<T.length;++u)switch(T[u].charAt(0)){case"A":case"G":break;case"X":l=parseInt(T[u].slice(1))-1,x=!0;break;case"Y":for(o=parseInt(T[u].slice(1))-1,x||(l=0),a=h.length;a<=o;++a)h[a]=[];break;case"K":'"'===(b=T[u].slice(1)).charAt(0)?b=b.slice(1,b.length-1):"TRUE"===b?b=!0:"FALSE"===b?b=!1:isNaN(Og(b))?isNaN(Pg(b).getDate())||(b=Ag(b)):(b=Og(b),null!==d&&tg(d)&&(b=xg(b))),"undefined"!==typeof nm&&"string"==typeof b&&"string"!=(i||{}).type&&(i||{}).codepage&&(b=nm.utils.decode(i.codepage,b)),S=!0;break;case"E":_=!0;var I=Gw(T[u].slice(1),{r:o,c:l});h[o][l]=[h[o][l],I];break;case"S":k=!0,h[o][l]=[h[o][l],"S5S"];break;case"R":C=parseInt(T[u].slice(1))-1;break;case"C":A=parseInt(T[u].slice(1))-1;break;default:if(i&&i.WTF)throw new Error("SYLK bad record "+w)}if(S&&(h[o][l]&&2==h[o][l].length?h[o][l][0]=b:h[o][l]=b,d=null),k){if(_)throw new Error("SYLK shared formula cannot have own formula");var N=C>-1&&h[C][A];if(!N||!N[1])throw new Error("SYLK shared formula cannot find base");h[o][l][1]=Yw(N[1],{r:o-C,c:l-A})}break;case"F":var D=0;for(u=1;u<T.length;++u)switch(T[u].charAt(0)){case"X":l=parseInt(T[u].slice(1))-1,++D;break;case"Y":for(o=parseInt(T[u].slice(1))-1,a=h.length;a<=o;++a)h[a]=[];break;case"M":y=parseInt(T[u].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":d=f[parseInt(T[u].slice(1))];break;case"W":for(v=T[u].slice(1).split(" "),a=parseInt(v[0],10);a<=parseInt(v[1],10);++a)y=parseInt(v[2],10),g[a-1]=0===y?{hidden:!0}:{wch:y},yw(g[a-1]);break;case"C":g[l=parseInt(T[u].slice(1))-1]||(g[l]={});break;case"R":m[o=parseInt(T[u].slice(1))-1]||(m[o]={}),y>0?(m[o].hpt=y,m[o].hpx=Tw(y)):0===y&&(m[o].hidden=!0);break;default:if(i&&i.WTF)throw new Error("SYLK bad record "+w)}D<1&&(d=null);break;default:if(i&&i.WTF)throw new Error("SYLK bad record "+w)}}return m.length>0&&(p["!rows"]=m),g.length>0&&(p["!cols"]=g),i&&i.sheetRows&&(h=h.slice(0,i.sheetRows)),[h,p]}function a(e,t){var n=function(e,t){switch(t.type){case"base64":return i(om(e),t);case"binary":return i(e,t);case"buffer":return i(lm&&Buffer.isBuffer(e)?e.toString("binary"):pm(e),t);case"array":return i(Ig(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),r=n[0],a=n[1],s=Ay(r,t);return mg(a).forEach((function(e){s[e]=a[e]})),s}function s(e,t,n,r){var i="C;Y"+(n+1)+";X"+(r+1)+";K";switch(e.t){case"n":i+=e.v||0,e.f&&!e.F&&(i+=";E"+qw(e.f,{r:n,c:r}));break;case"b":i+=e.v?"TRUE":"FALSE";break;case"e":i+=e.w||e.v;break;case"d":i+='"'+(e.w||e.v)+'"';break;case"s":i+='"'+e.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return i}return e["|"]=254,{to_workbook:function(e,t){return _y(a(e,t),t)},to_sheet:a,from_sheet:function(e,t){var n,r,i=["ID;PWXL;N;E"],a=[],o=Sy(e["!ref"]),l=Array.isArray(e),c="\r\n";i.push("P;PGeneral"),i.push("F;P0;DG0G8;M255"),e["!cols"]&&(r=i,e["!cols"].forEach((function(e,t){var n="F;W"+(t+1)+" "+(t+1)+" ";e.hidden?n+="0":("number"!=typeof e.width||e.wpx||(e.wpx=mw(e.width)),"number"!=typeof e.wpx||e.wch||(e.wch=gw(e.wpx)),"number"==typeof e.wch&&(n+=Math.round(e.wch)))," "!=n.charAt(n.length-1)&&r.push(n)}))),e["!rows"]&&function(e,t){t.forEach((function(t,n){var r="F;";t.hidden?r+="M0;":t.hpt?r+="M"+20*t.hpt+";":t.hpx&&(r+="M"+20*ww(t.hpx)+";"),r.length>2&&e.push(r+"R"+(n+1))}))}(i,e["!rows"]),i.push("B;Y"+(o.e.r-o.s.r+1)+";X"+(o.e.c-o.s.c+1)+";D"+[o.s.c,o.s.r,o.e.c,o.e.r].join(" "));for(var u=o.s.r;u<=o.e.r;++u)for(var h=o.s.c;h<=o.e.c;++h){var f=wy({r:u,c:h});(n=l?(e[u]||[])[h]:e[f])&&(null!=n.v||n.f&&!n.F)&&a.push(s(n,0,u,h))}return i.join(c)+c+a.join(c)+c+"E"+c}}}(),nw=function(){function e(e,t){for(var n=e.split("\n"),r=-1,i=-1,a=0,s=[];a!==n.length;++a)if("BOT"!==n[a].trim()){if(!(r<0)){for(var o=n[a].trim().split(","),l=o[0],c=o[1],u=n[++a]||"";1&(u.match(/["]/g)||[]).length&&a<n.length-1;)u+="\n"+n[++a];switch(u=u.trim(),+l){case-1:if("BOT"===u){s[++r]=[],i=0;continue}if("EOD"!==u)throw new Error("Unrecognized DIF special command "+u);break;case 0:"TRUE"===u?s[r][i]=!0:"FALSE"===u?s[r][i]=!1:isNaN(Og(c))?isNaN(Pg(c).getDate())?s[r][i]=c:s[r][i]=Ag(c):s[r][i]=Og(c),++i;break;case 1:(u=(u=u.slice(1,u.length-1)).replace(/""/g,'"'))&&u.match(/^=".*"$/)&&(u=u.slice(2,-1)),s[r][i++]=""!==u?u:null}if("EOD"===u)break}}else s[++r]=[],i=0;return t&&t.sheetRows&&(s=s.slice(0,t.sheetRows)),s}function t(t,n){return Ay(function(t,n){switch(n.type){case"base64":return e(om(t),n);case"binary":return e(t,n);case"buffer":return e(lm&&Buffer.isBuffer(t)?t.toString("binary"):pm(t),n);case"array":return e(Ig(t),n)}throw new Error("Unrecognized type "+n.type)}(t,n),n)}var n=function(){var e=function(e,t,n,r,i){e.push(t),e.push(n+","+r),e.push('"'+i.replace(/"/g,'""')+'"')},t=function(e,t,n,r){e.push(t+","+n),e.push(1==t?'"'+r.replace(/"/g,'""')+'"':r)};return function(n){var r,i=[],a=Sy(n["!ref"]),s=Array.isArray(n);e(i,"TABLE",0,1,"sheetjs"),e(i,"VECTORS",0,a.e.r-a.s.r+1,""),e(i,"TUPLES",0,a.e.c-a.s.c+1,""),e(i,"DATA",0,0,"");for(var o=a.s.r;o<=a.e.r;++o){t(i,-1,0,"BOT");for(var l=a.s.c;l<=a.e.c;++l){var c=wy({r:o,c:l});if(r=s?(n[o]||[])[l]:n[c])switch(r.t){case"n":var u=r.w;u||null==r.v||(u=r.v),null==u?r.f&&!r.F?t(i,1,0,"="+r.f):t(i,1,0,""):t(i,0,u,"V");break;case"b":t(i,0,r.v?1:0,r.v?"TRUE":"FALSE");break;case"s":t(i,1,0,isNaN(r.v)?r.v:'="'+r.v+'"');break;case"d":r.w||(r.w=ag(r.z||Cm[14],wg(Ag(r.v)))),t(i,0,r.w,"V");break;default:t(i,1,0,"")}else t(i,1,0,"")}}t(i,-1,0,"EOD");return i.join("\r\n")}}();return{to_workbook:function(e,n){return _y(t(e,n),n)},to_sheet:t,from_sheet:n}}(),rw=function(){function e(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(e,t){return Ay(function(e,t){for(var n=e.split("\n"),r=-1,i=-1,a=0,s=[];a!==n.length;++a){var o=n[a].trim().split(":");if("cell"===o[0]){var l=by(o[1]);if(s.length<=l.r)for(r=s.length;r<=l.r;++r)s[r]||(s[r]=[]);switch(r=l.r,i=l.c,o[2]){case"t":s[r][i]=o[3].replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n");break;case"v":s[r][i]=+o[3];break;case"vtf":var c=o[o.length-1];case"vtc":"nl"===o[3]?s[r][i]=!!+o[4]:s[r][i]=+o[4],"vtf"==o[2]&&(s[r][i]=[s[r][i],c])}}}return t&&t.sheetRows&&(s=s.slice(0,t.sheetRows)),s}(e,t),t)}var n=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),r=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",i=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),a="--SocialCalcSpreadsheetControlSave--";function s(t){if(!t||!t["!ref"])return"";for(var n,r=[],i=[],a="",s=Ty(t["!ref"]),o=Array.isArray(t),l=s.s.r;l<=s.e.r;++l)for(var c=s.s.c;c<=s.e.c;++c)if(a=wy({r:l,c:c}),(n=o?(t[l]||[])[c]:t[a])&&null!=n.v&&"z"!==n.t){switch(i=["cell",a,"t"],n.t){case"s":case"str":i.push(e(n.v));break;case"n":n.f?(i[2]="vtf",i[3]="n",i[4]=n.v,i[5]=e(n.f)):(i[2]="v",i[3]=n.v);break;case"b":i[2]="vt"+(n.f?"f":"c"),i[3]="nl",i[4]=n.v?"1":"0",i[5]=e(n.f||(n.v?"TRUE":"FALSE"));break;case"d":var u=wg(Ag(n.v));i[2]="vtc",i[3]="nd",i[4]=""+u,i[5]=n.w||ag(n.z||Cm[14],u);break;case"e":continue}r.push(i.join(":"))}return r.push("sheet:c:"+(s.e.c-s.s.c+1)+":r:"+(s.e.r-s.s.r+1)+":tvf:1"),r.push("valueformat:1:text-wiki"),r.join("\n")}return{to_workbook:function(e,n){return _y(t(e,n),n)},to_sheet:t,from_sheet:function(e){return[n,r,i,r,s(e),a].join("\n")}}}(),iw=function(){function e(e,t,n,r,i){i.raw?t[n][r]=e:""===e||("TRUE"===e?t[n][r]=!0:"FALSE"===e?t[n][r]=!1:isNaN(Og(e))?isNaN(Pg(e).getDate())?t[n][r]=e:t[n][r]=Ag(e):t[n][r]=Og(e))}var t={44:",",9:"\t",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function r(e){for(var r={},i=!1,a=0,s=0;a<e.length;++a)34==(s=e.charCodeAt(a))?i=!i:!i&&s in t&&(r[s]=(r[s]||0)+1);for(a in s=[],r)Object.prototype.hasOwnProperty.call(r,a)&&s.push([r[a],a]);if(!s.length)for(a in r=n)Object.prototype.hasOwnProperty.call(r,a)&&s.push([r[a],a]);return s.sort((function(e,t){return e[0]-t[0]||n[e[1]]-n[t[1]]})),t[s.pop()[1]]||44}function i(e,t){var n=t||{},i="";var a=n.dense?[]:{},s={s:{c:0,r:0},e:{c:0,r:0}};"sep="==e.slice(0,4)?13==e.charCodeAt(5)&&10==e.charCodeAt(6)?(i=e.charAt(4),e=e.slice(7)):13==e.charCodeAt(5)||10==e.charCodeAt(5)?(i=e.charAt(4),e=e.slice(6)):i=r(e.slice(0,1024)):i=n&&n.FS?n.FS:r(e.slice(0,1024));var o=0,l=0,c=0,u=0,h=0,f=i.charCodeAt(0),d=!1,p=0,m=e.charCodeAt(0);e=e.replace(/\r\n/gm,"\n");var g=null!=n.dateNF?function(e){var t="number"==typeof e?Cm[e]:e;return t=t.replace(cg,"(\\d+)"),new RegExp("^"+t+"$")}(n.dateNF):null;function v(){var t=e.slice(u,h),r={};if('"'==t.charAt(0)&&'"'==t.charAt(t.length-1)&&(t=t.slice(1,-1).replace(/""/g,'"')),0===t.length)r.t="z";else if(n.raw)r.t="s",r.v=t;else if(0===t.trim().length)r.t="s",r.v=t;else if(61==t.charCodeAt(0))34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(r.t="s",r.v=t.slice(2,-1).replace(/""/g,'"')):1!=t.length?(r.t="n",r.f=t.slice(1)):(r.t="s",r.v=t);else if("TRUE"==t)r.t="b",r.v=!0;else if("FALSE"==t)r.t="b",r.v=!1;else if(isNaN(c=Og(t)))if(!isNaN(Pg(t).getDate())||g&&t.match(g)){r.z=n.dateNF||Cm[14];var i=0;g&&t.match(g)&&(t=function(e,t,n){var r=-1,i=-1,a=-1,s=-1,o=-1,l=-1;(t.match(cg)||[]).forEach((function(e,t){var c=parseInt(n[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":r=c;break;case"d":a=c;break;case"h":s=c;break;case"s":l=c;break;case"m":s>=0?o=c:i=c}})),l>=0&&-1==o&&i>=0&&(o=i,i=-1);var c=(""+(r>=0?r:(new Date).getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);7==c.length&&(c="0"+c),8==c.length&&(c="20"+c);var u=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return-1==s&&-1==o&&-1==l?c:-1==r&&-1==i&&-1==a?u:c+"T"+u}(0,n.dateNF,t.match(g)||[]),i=1),n.cellDates?(r.t="d",r.v=Ag(t,i)):(r.t="n",r.v=wg(Ag(t,i))),!1!==n.cellText&&(r.w=ag(r.z,r.v instanceof Date?wg(r.v):r.v)),n.cellNF||delete r.z}else r.t="s",r.v=t;else r.t="n",!1!==n.cellText&&(r.w=t),r.v=c;if("z"==r.t||(n.dense?(a[o]||(a[o]=[]),a[o][l]=r):a[wy({c:l,r:o})]=r),u=h+1,m=e.charCodeAt(u),s.e.c<l&&(s.e.c=l),s.e.r<o&&(s.e.r=o),p==f)++l;else if(l=0,++o,n.sheetRows&&n.sheetRows<=o)return!0}e:for(;h<e.length;++h)switch(p=e.charCodeAt(h)){case 34:34===m&&(d=!d);break;case f:case 10:case 13:if(!d&&v())break e}return h-u>0&&v(),a["!ref"]=Ey(s),a}function a(t,n){return n&&n.PRN?n.FS||"sep="==t.slice(0,4)||t.indexOf("\t")>=0||t.indexOf(",")>=0||t.indexOf(";")>=0?i(t,n):Ay(function(t,n){var r=n||{},i=[];if(!t||0===t.length)return i;for(var a=t.split(/[\r\n]/),s=a.length-1;s>=0&&0===a[s].length;)--s;for(var o=10,l=0,c=0;c<=s;++c)-1==(l=a[c].indexOf(" "))?l=a[c].length:l++,o=Math.max(o,l);for(c=0;c<=s;++c){i[c]=[];var u=0;for(e(a[c].slice(0,o).trim(),i,c,u,r),u=1;u<=(a[c].length-o)/10+1;++u)e(a[c].slice(o+10*(u-1),o+10*u).trim(),i,c,u,r)}return r.sheetRows&&(i=i.slice(0,r.sheetRows)),i}(t,n),n):i(t,n)}function s(e,t){var n="",r="string"==t.type?[0,0,0,0]:uS(e,t);switch(t.type){case"base64":n=om(e);break;case"binary":case"string":n=e;break;case"buffer":n=65001==t.codepage?e.toString("utf8"):t.codepage&&"undefined"!==typeof nm?nm.utils.decode(t.codepage,e):lm&&Buffer.isBuffer(e)?e.toString("binary"):pm(e);break;case"array":n=Ig(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==r[0]&&187==r[1]&&191==r[2]?n=Qg(n.slice(3)):"string"!=t.type&&"buffer"!=t.type&&65001==t.codepage?n=Qg(n):"binary"==t.type&&"undefined"!==typeof nm&&t.codepage&&(n=nm.utils.decode(t.codepage,nm.utils.encode(28591,n))),"socialcalc:version:"==n.slice(0,19)?rw.to_sheet("string"==t.type?n:Qg(n),t):a(n,t)}return{to_workbook:function(e,t){return _y(s(e,t),t)},to_sheet:s,from_sheet:function(e){for(var t,n=[],r=Sy(e["!ref"]),i=Array.isArray(e),a=r.s.r;a<=r.e.r;++a){for(var s=[],o=r.s.c;o<=r.e.c;++o){var l=wy({r:a,c:o});if((t=i?(e[a]||[])[o]:e[l])&&null!=t.v){for(var c=(t.w||(ky(t),t.w)||"").slice(0,10);c.length<10;)c+=" ";s.push(c+(0===o?" ":""))}else s.push("          ")}n.push(s.join(""))}return n.join("\n")}}}();var aw=function(){function e(e,t,n){if(e){sy(e,e.l||0);for(var r=n.Enum||v;e.l<e.length;){var i=e.read_shift(2),a=r[i]||r[65535],s=e.read_shift(2),o=e.l+s,l=a.f&&a.f(e,s,n);if(e.l=o,t(l,a,i))return}}}function t(t,n){if(!t)return t;var r=n||{};var i=r.dense?[]:{},a="Sheet1",s="",o=0,l={},c=[],u=[],h={s:{r:0,c:0},e:{r:0,c:0}},f=r.sheetRows||0;if(0==t[2]&&(8==t[3]||9==t[3])&&t.length>=16&&5==t[14]&&108===t[15])throw new Error("Unsupported Works 3 for Mac file");if(2==t[2])r.Enum=v,e(t,(function(e,t,n){switch(n){case 0:r.vers=e,e>=4096&&(r.qpro=!0);break;case 6:h=e;break;case 204:e&&(s=e);break;case 222:s=e;break;case 15:case 51:r.qpro||(e[1].v=e[1].v.slice(1));case 13:case 14:case 16:14==n&&112==(112&e[2])&&(15&e[2])>1&&(15&e[2])<15&&(e[1].z=r.dateNF||Cm[14],r.cellDates&&(e[1].t="d",e[1].v=xg(e[1].v))),r.qpro&&e[3]>o&&(i["!ref"]=Ey(h),l[a]=i,c.push(a),i=r.dense?[]:{},h={s:{r:0,c:0},e:{r:0,c:0}},o=e[3],a=s||"Sheet"+(o+1),s="");var u=r.dense?(i[e[0].r]||[])[e[0].c]:i[wy(e[0])];if(u){u.t=e[1].t,u.v=e[1].v,null!=e[1].z&&(u.z=e[1].z),null!=e[1].f&&(u.f=e[1].f);break}r.dense?(i[e[0].r]||(i[e[0].r]=[]),i[e[0].r][e[0].c]=e[1]):i[wy(e[0])]=e[1]}}),r);else{if(26!=t[2]&&14!=t[2])throw new Error("Unrecognized LOTUS BOF "+t[2]);r.Enum=y,14==t[2]&&(r.qpro=!0,t.l=0),e(t,(function(e,t,n){switch(n){case 204:a=e;break;case 22:e[1].v=e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(e[3]>o&&(i["!ref"]=Ey(h),l[a]=i,c.push(a),i=r.dense?[]:{},h={s:{r:0,c:0},e:{r:0,c:0}},o=e[3],a="Sheet"+(o+1)),f>0&&e[0].r>=f)break;r.dense?(i[e[0].r]||(i[e[0].r]=[]),i[e[0].r][e[0].c]=e[1]):i[wy(e[0])]=e[1],h.e.c<e[0].c&&(h.e.c=e[0].c),h.e.r<e[0].r&&(h.e.r=e[0].r);break;case 27:e[14e3]&&(u[e[14e3][0]]=e[14e3][1]);break;case 1537:u[e[0]]=e[1],e[0]==o&&(a=e[1])}}),r)}if(i["!ref"]=Ey(h),l[s||a]=i,c.push(s||a),!u.length)return{SheetNames:c,Sheets:l};for(var d={},p=[],m=0;m<u.length;++m)l[c[m]]?(p.push(u[m]||c[m]),d[u[m]]=l[u[m]]||l[c[m]]):(p.push(u[m]),d[u[m]]={"!ref":"A1"});return{SheetNames:p,Sheets:d}}function n(e,t,n){var r=[{c:0,r:0},{t:"n",v:0},0,0];return n.qpro&&20768!=n.vers?(r[0].c=e.read_shift(1),r[3]=e.read_shift(1),r[0].r=e.read_shift(2),e.l+=2):(r[2]=e.read_shift(1),r[0].c=e.read_shift(2),r[0].r=e.read_shift(2)),r}function r(e,t,r){var i=e.l+t,a=n(e,0,r);if(a[1].t="s",20768==r.vers){e.l++;var s=e.read_shift(1);return a[1].v=e.read_shift(s,"utf8"),a}return r.qpro&&e.l++,a[1].v=e.read_shift(i-e.l,"cstr"),a}function i(e,t,n){var r=ly(7+n.length);r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(1,39);for(var i=0;i<r.length;++i){var a=n.charCodeAt(i);r.write_shift(1,a>=128?95:a)}return r.write_shift(1,0),r}function a(e,t,n){var r=ly(7);return r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(2,n,"i"),r}function s(e,t,n){var r=ly(13);return r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(8,n,"f"),r}function o(e,t,n){var r=32768&t;return t=(r?e:0)+((t&=-32769)>=8192?t-16384:t),(r?"":"$")+(n?yy(t):gy(t))}var l={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},c=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function u(e){var t=[{c:0,r:0},{t:"n",v:0},0];return t[0].r=e.read_shift(2),t[3]=e[e.l++],t[0].c=e[e.l++],t}function h(e,t,n,r){var i=ly(6+r.length);i.write_shift(2,e),i.write_shift(1,n),i.write_shift(1,t),i.write_shift(1,39);for(var a=0;a<r.length;++a){var s=r.charCodeAt(a);i.write_shift(1,s>=128?95:s)}return i.write_shift(1,0),i}function f(e,t){var n=u(e),r=e.read_shift(4),i=e.read_shift(4),a=e.read_shift(2);if(65535==a)return 0===r&&3221225472===i?(n[1].t="e",n[1].v=15):0===r&&3489660928===i?(n[1].t="e",n[1].v=42):n[1].v=0,n;var s=32768&a;return a=(32767&a)-16446,n[1].v=(1-2*s)*(i*Math.pow(2,a+32)+r*Math.pow(2,a)),n}function d(e,t,n,r){var i=ly(14);if(i.write_shift(2,e),i.write_shift(1,n),i.write_shift(1,t),0==r)return i.write_shift(4,0),i.write_shift(4,0),i.write_shift(2,65535),i;var a,s=0,o=0,l=0;return r<0&&(s=1,r=-r),o=0|Math.log2(r),0==(2147483648&(l=(r/=Math.pow(2,o-31))>>>0))&&(++o,l=(r/=2)>>>0),r-=l,l|=2147483648,l>>>=0,a=(r*=Math.pow(2,32))>>>0,i.write_shift(4,a),i.write_shift(4,l),o+=16383+(s?32768:0),i.write_shift(2,o),i}function p(e,t){var n=u(e),r=e.read_shift(8,"f");return n[1].v=r,n}function m(e,t){return 0==e[e.l+t-1]?e.read_shift(t,"cstr"):""}function g(e,t){var n=ly(5+e.length);n.write_shift(2,14e3),n.write_shift(2,t);for(var r=0;r<e.length;++r){var i=e.charCodeAt(r);n[n.l++]=i>127?95:i}return n[n.l++]=0,n}var v={0:{n:"BOF",f:Db},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e,t,n){var r={s:{c:0,r:0},e:{c:0,r:0}};return 8==t&&n.qpro?(r.s.c=e.read_shift(1),e.l++,r.s.r=e.read_shift(2),r.e.c=e.read_shift(1),e.l++,r.e.r=e.read_shift(2),r):(r.s.c=e.read_shift(2),r.s.r=e.read_shift(2),12==t&&n.qpro&&(e.l+=2),r.e.c=e.read_shift(2),r.e.r=e.read_shift(2),12==t&&n.qpro&&(e.l+=2),65535==r.s.c&&(r.s.c=r.e.c=r.s.r=r.e.r=0),r)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,t,r){var i=n(e,0,r);return i[1].v=e.read_shift(2,"i"),i}},14:{n:"NUMBER",f:function(e,t,r){var i=n(e,0,r);return i[1].v=e.read_shift(8,"f"),i}},15:{n:"LABEL",f:r},16:{n:"FORMULA",f:function(e,t,r){var i=e.l+t,a=n(e,0,r);if(a[1].v=e.read_shift(8,"f"),r.qpro)e.l=i;else{var s=e.read_shift(2);!function(e,t){sy(e,0);var n=[],r=0,i="",a="",s="",u="";for(;e.l<e.length;){var h=e[e.l++];switch(h){case 0:n.push(e.read_shift(8,"f"));break;case 1:a=o(t[0].c,e.read_shift(2),!0),i=o(t[0].r,e.read_shift(2),!1),n.push(a+i);break;case 2:var f=o(t[0].c,e.read_shift(2),!0),d=o(t[0].r,e.read_shift(2),!1);a=o(t[0].c,e.read_shift(2),!0),i=o(t[0].r,e.read_shift(2),!1),n.push(f+d+":"+a+i);break;case 3:if(e.l<e.length)return void console.error("WK1 premature formula end");break;case 4:n.push("("+n.pop()+")");break;case 5:n.push(e.read_shift(2));break;case 6:for(var p="";h=e[e.l++];)p+=String.fromCharCode(h);n.push('"'+p.replace(/"/g,'""')+'"');break;case 8:n.push("-"+n.pop());break;case 23:n.push("+"+n.pop());break;case 22:n.push("NOT("+n.pop()+")");break;case 20:case 21:u=n.pop(),s=n.pop(),n.push(["AND","OR"][h-20]+"("+s+","+u+")");break;default:if(h<32&&c[h])u=n.pop(),s=n.pop(),n.push(s+c[h]+u);else{if(!l[h])return h<=7?console.error("WK1 invalid opcode "+h.toString(16)):h<=24?console.error("WK1 unsupported op "+h.toString(16)):h<=30?console.error("WK1 invalid opcode "+h.toString(16)):h<=115?console.error("WK1 unsupported function opcode "+h.toString(16)):console.error("WK1 unrecognized opcode "+h.toString(16));if(69==(r=l[h][1])&&(r=e[e.l++]),r>n.length)return void console.error("WK1 bad formula parse 0x"+h.toString(16)+":|"+n.join("|")+"|");var m=n.slice(-r);n.length-=r,n.push(l[h][0]+"("+m.join(",")+")")}}}1==n.length?t[1].f=""+n[0]:console.error("WK1 bad formula parse |"+n.join("|")+"|")}(e.slice(e.l,e.l+s),a),e.l+=s}return a}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:r},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:m},222:{n:"SHEETNAMELP",f:function(e,t){var n=e[e.l++];n>t-1&&(n=t-1);for(var r="";r.length<n;)r+=String.fromCharCode(e[e.l++]);return r}},65535:{n:""}},y={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(e,t){var n=u(e);return n[1].t="s",n[1].v=e.read_shift(t-4,"cstr"),n}},23:{n:"NUMBER17",f:f},24:{n:"NUMBER18",f:function(e,t){var n=u(e);n[1].v=e.read_shift(2);var r=n[1].v>>1;if(1&n[1].v)switch(7&r){case 0:r=5e3*(r>>3);break;case 1:r=500*(r>>3);break;case 2:r=(r>>3)/20;break;case 3:r=(r>>3)/200;break;case 4:r=(r>>3)/2e3;break;case 5:r=(r>>3)/2e4;break;case 6:r=(r>>3)/16;break;case 7:r=(r>>3)/64}return n[1].v=r,n}},25:{n:"FORMULA19",f:function(e,t){var n=f(e);return e.l+=t-14,n}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(e,t){for(var n={},r=e.l+t;e.l<r;){var i=e.read_shift(2);if(14e3==i){for(n[i]=[0,""],n[i][0]=e.read_shift(2);e[e.l];)n[i][1]+=String.fromCharCode(e[e.l]),e.l++;e.l++}}return n}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(e,t){var n=u(e),r=e.read_shift(4);return n[1].v=r>>6,n}},38:{n:"??"},39:{n:"NUMBER27",f:p},40:{n:"FORMULA28",f:function(e,t){var n=p(e);return e.l+=t-10,n}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:m},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(e,t,n){if(n.qpro&&!(t<21)){var r=e.read_shift(1);return e.l+=17,e.l+=1,e.l+=2,[r,e.read_shift(t-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function(e,t){var n=t||{};if(+n.codepage>=0&&Zp(+n.codepage),"string"==n.type)throw new Error("Cannot write WK1 to JS string");var r=cy(),o=Sy(e["!ref"]),l=Array.isArray(e),c=[];EE(r,0,function(e){var t=ly(2);return t.write_shift(2,e),t}(1030)),EE(r,6,function(e){var t=ly(8);return t.write_shift(2,e.s.c),t.write_shift(2,e.s.r),t.write_shift(2,e.e.c),t.write_shift(2,e.e.r),t}(o));for(var u=Math.min(o.e.r,8191),h=o.s.r;h<=u;++h)for(var f=gy(h),d=o.s.c;d<=o.e.c;++d){h===o.s.r&&(c[d]=yy(d));var p=c[d]+f,m=l?(e[h]||[])[d]:e[p];if(m&&"z"!=m.t)if("n"==m.t)(0|m.v)==m.v&&m.v>=-32768&&m.v<=32767?EE(r,13,a(h,d,m.v)):EE(r,14,s(h,d,m.v));else EE(r,15,i(h,d,ky(m).slice(0,239)))}return EE(r,1),r.end()},book_to_wk3:function(e,t){var n=t||{};if(+n.codepage>=0&&Zp(+n.codepage),"string"==n.type)throw new Error("Cannot write WK3 to JS string");var r=cy();EE(r,0,function(e){var t=ly(26);t.write_shift(2,4096),t.write_shift(2,4),t.write_shift(4,0);for(var n=0,r=0,i=0,a=0;a<e.SheetNames.length;++a){var s=e.SheetNames[a],o=e.Sheets[s];if(o&&o["!ref"]){++i;var l=Ty(o["!ref"]);n<l.e.r&&(n=l.e.r),r<l.e.c&&(r=l.e.c)}}n>8191&&(n=8191);return t.write_shift(2,n),t.write_shift(1,i),t.write_shift(1,r),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,1),t.write_shift(1,2),t.write_shift(4,0),t.write_shift(4,0),t}(e));for(var i=0,a=0;i<e.SheetNames.length;++i)(e.Sheets[e.SheetNames[i]]||{})["!ref"]&&EE(r,27,g(e.SheetNames[i],a++));var s=0;for(i=0;i<e.SheetNames.length;++i){var o=e.Sheets[e.SheetNames[i]];if(o&&o["!ref"]){for(var l=Sy(o["!ref"]),c=Array.isArray(o),u=[],f=Math.min(l.e.r,8191),p=l.s.r;p<=f;++p)for(var m=gy(p),v=l.s.c;v<=l.e.c;++v){p===l.s.r&&(u[v]=yy(v));var y=u[v]+m,b=c?(o[p]||[])[v]:o[y];if(b&&"z"!=b.t)if("n"==b.t)EE(r,23,d(p,v,s,b.v));else EE(r,22,h(p,v,s,ky(b).slice(0,239)))}++s}}return EE(r,1),r.end()},to_workbook:function(e,n){switch(n.type){case"base64":return t(fm(om(e)),n);case"binary":return t(fm(e),n);case"buffer":case"array":return t(e,n)}throw"Unsupported type "+n.type}}}();var sw=/^\s|\s$|[\t\n\r]/;function ow(e,t){if(!t.bookSST)return"";var n=[Fg];n[n.length]=rv("sst",null,{xmlns:yv[0],count:e.Count,uniqueCount:e.Unique});for(var r=0;r!=e.length;++r)if(null!=e[r]){var i=e[r],a="<si>";i.r?a+=i.r:(a+="<t",i.t||(i.t=""),i.t.match(sw)&&(a+=' xml:space="preserve"'),a+=">"+Vg(i.t)+"</t>"),a+="</si>",n[n.length]=a}return n.length>2&&(n[n.length]="</sst>",n[1]=n[1].replace("/>",">")),n.join("")}var lw=function(e,t){var n=!1;return null==t&&(n=!0,t=ly(15+4*e.t.length)),t.write_shift(1,0),Dy(e.t,t),n?t.slice(0,t.l):t};function cw(e){var t=cy();uy(t,159,function(e,t){return t||(t=ly(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}(e));for(var n=0;n<e.length;++n)uy(t,19,lw(e[n]));return uy(t,160),t.end()}function uw(e){if("undefined"!==typeof nm)return nm.utils.encode(Yp,e);for(var t=[],n=e.split(""),r=0;r<n.length;++r)t[r]=n[r].charCodeAt(0);return t}function hw(e){var t,n,r=0,i=uw(e),a=i.length+1;for((t=um(a))[0]=i.length,n=1;n!=a;++n)t[n]=i[n-1];for(n=a-1;n>=0;--n)r=((0===(16384&r)?0:1)|r<<1&32767)^t[n];return 52811^r}var fw=function(){function e(e,n){switch(n.type){case"base64":return t(om(e),n);case"binary":return t(e,n);case"buffer":return t(lm&&Buffer.isBuffer(e)?e.toString("binary"):pm(e),n);case"array":return t(Ig(e),n)}throw new Error("Unrecognized type "+n.type)}function t(e,t){var n=(t||{}).dense?[]:{},r=e.match(/\\trowd.*?\\row\b/g);if(!r.length)throw new Error("RTF missing table");var i={s:{c:0,r:0},e:{c:0,r:r.length-1}};return r.forEach((function(e,t){Array.isArray(n)&&(n[t]=[]);for(var r,a=/\\\w+\b/g,s=0,o=-1;r=a.exec(e);){if("\\cell"===r[0]){var l=e.slice(s,a.lastIndex-r[0].length);if(" "==l[0]&&(l=l.slice(1)),++o,l.length){var c={v:l,t:"s"};Array.isArray(n)?n[t][o]=c:n[wy({r:t,c:o})]=c}}s=a.lastIndex}o>i.e.c&&(i.e.c=o)})),n["!ref"]=Ey(i),n}return{to_workbook:function(t,n){return _y(e(t,n),n)},to_sheet:e,from_sheet:function(e){for(var t,n=["{\\rtf1\\ansi"],r=Sy(e["!ref"]),i=Array.isArray(e),a=r.s.r;a<=r.e.r;++a){n.push("\\trowd\\trautofit1");for(var s=r.s.c;s<=r.e.c;++s)n.push("\\cellx"+(s+1));for(n.push("\\pard\\intbl"),s=r.s.c;s<=r.e.c;++s){var o=wy({r:a,c:s});(t=i?(e[a]||[])[s]:e[o])&&(null!=t.v||t.f&&!t.F)&&(n.push(" "+(t.w||(ky(t),t.w))),n.push("\\cell"))}n.push("\\pard\\intbl\\row")}return n.join("")+"}"}}}();function dw(e){for(var t=0,n=1;3!=t;++t)n=256*n+(e[t]>255?255:e[t]<0?0:e[t]);return n.toString(16).toUpperCase().slice(1)}var pw=6;function mw(e){return Math.floor((e+Math.round(128/pw)/256)*pw)}function gw(e){return Math.floor((e-5)/pw*100+.5)/100}function vw(e){return Math.round((e*pw+5)/pw*256)/256}function yw(e){e.width?(e.wpx=mw(e.width),e.wch=gw(e.wpx),e.MDW=pw):e.wpx?(e.wch=gw(e.wpx),e.width=vw(e.wch),e.MDW=pw):"number"==typeof e.wch&&(e.width=vw(e.wch),e.wpx=mw(e.width),e.MDW=pw),e.customWidth&&delete e.customWidth}var bw=96;function ww(e){return 96*e/bw}function Tw(e){return e*bw/96}function Ew(e,t){var n,r=[Fg,rv("styleSheet",null,{xmlns:yv[0],"xmlns:vt":mv})];return e.SSF&&null!=(n=function(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach((function(n){for(var r=n[0];r<=n[1];++r)null!=e[r]&&(t[t.length]=rv("numFmt",null,{numFmtId:r,formatCode:Vg(e[r])}))})),1===t.length?"":(t[t.length]="</numFmts>",t[0]=rv("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(e.SSF))&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=function(e){var t=[];return t[t.length]=rv("cellXfs",null),e.forEach((function(e){t[t.length]=rv("xf",null,e)})),t[t.length]="</cellXfs>",2===t.length?"":(t[0]=rv("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Sw(e,t,n){n||(n=ly(6+4*t.length)),n.write_shift(2,e),Dy(t,n);var r=n.length>n.l?n.slice(0,n.l):n;return null==n.l&&(n.l=n.length),r}function xw(e,t){t||(t=ly(153)),t.write_shift(2,20*e.sz),function(e,t){t||(t=ly(2));var n=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);t.write_shift(1,n),t.write_shift(1,0)}(e,t),t.write_shift(2,e.bold?700:400);var n=0;"superscript"==e.vertAlign?n=1:"subscript"==e.vertAlign&&(n=2),t.write_shift(2,n),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),eb(e.color,t);var r=0;return"major"==e.scheme&&(r=1),"minor"==e.scheme&&(r=2),t.write_shift(1,r),Dy(e.name,t),t.length>t.l?t.slice(0,t.l):t}var kw,_w=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Cw=oy;function Aw(e,t){t||(t=ly(84)),kw||(kw=vg(_w));var n=kw[e.patternType];null==n&&(n=40),t.write_shift(4,n);var r=0;if(40!=n)for(eb({auto:1},t),eb({auto:1},t);r<12;++r)t.write_shift(4,0);else{for(;r<4;++r)t.write_shift(4,0);for(;r<12;++r)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function Iw(e,t,n){n||(n=ly(16)),n.write_shift(2,t||0),n.write_shift(2,e.numFmtId||0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);return n.write_shift(1,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(1,0),n}function Nw(e,t){return t||(t=ly(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var Dw=oy;function Ow(e){var t;uy(e,613,Iy(1)),uy(e,46,(t||(t=ly(51)),t.write_shift(1,0),Nw(0,t),Nw(0,t),Nw(0,t),Nw(0,t),Nw(0,t),t.length>t.l?t.slice(0,t.l):t)),uy(e,614)}function Rw(e){var t,n;uy(e,619,Iy(1)),uy(e,48,(t={xfId:0,builtinId:0,name:"Normal"},n||(n=ly(52)),n.write_shift(4,t.xfId),n.write_shift(2,1),n.write_shift(1,+t.builtinId),n.write_shift(1,0),$y(t.name||"",n),n.length>n.l?n.slice(0,n.l):n)),uy(e,620)}function Pw(e){uy(e,508,function(e,t,n){var r=ly(2052);return r.write_shift(4,e),$y(t,r),$y(n,r),r.length>r.l?r.slice(0,r.l):r}(0,"TableStyleMedium9","PivotStyleMedium4")),uy(e,509)}function Lw(e,t){var n=cy();return uy(n,278),function(e,t){if(t){var n=0;[[5,8],[23,26],[41,44],[50,392]].forEach((function(e){for(var r=e[0];r<=e[1];++r)null!=t[r]&&++n})),0!=n&&(uy(e,615,Iy(n)),[[5,8],[23,26],[41,44],[50,392]].forEach((function(n){for(var r=n[0];r<=n[1];++r)null!=t[r]&&uy(e,44,Sw(r,t[r]))})),uy(e,616))}}(n,e.SSF),function(e){uy(e,611,Iy(1)),uy(e,43,xw({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),uy(e,612)}(n),function(e){uy(e,603,Iy(2)),uy(e,45,Aw({patternType:"none"})),uy(e,45,Aw({patternType:"gray125"})),uy(e,604)}(n),Ow(n),function(e){uy(e,626,Iy(1)),uy(e,47,Iw({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),uy(e,627)}(n),function(e,t){uy(e,617,Iy(t.length)),t.forEach((function(t){uy(e,47,Iw(t,0))})),uy(e,618)}(n,t.cellXfs),Rw(n),function(e){uy(e,505,Iy(0)),uy(e,506)}(n),Pw(n),uy(n,279),n.end()}function Mw(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;var n=[Fg];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',n[n.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',n[n.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',n[n.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',n[n.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',n[n.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',n[n.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function Fw(){var e=cy();return uy(e,332),uy(e,334,Iy(1)),uy(e,335,function(e){var t=ly(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Dy(e.name,t),t.slice(0,t.l)}({name:"XLDAPR",version:12e4,flags:3496657072})),uy(e,336),uy(e,339,function(e,t){var n=ly(8+2*t.length);return n.write_shift(4,e),Dy(t,n),n.slice(0,n.l)}(1,"XLDAPR")),uy(e,52),uy(e,35,Iy(514)),uy(e,4096,Iy(0)),uy(e,4097,Ob(1)),uy(e,36),uy(e,53),uy(e,340),uy(e,337,function(e,t){var n=ly(8);return n.write_shift(4,e),n.write_shift(4,t?1:0),n}(1,!0)),uy(e,51,function(e){var t=ly(4+8*e.length);t.write_shift(4,e.length);for(var n=0;n<e.length;++n)t.write_shift(4,e[n][0]),t.write_shift(4,e[n][1]);return t}([[1,0]])),uy(e,338),uy(e,333),e.end()}function zw(){var e=[Fg];return e.push('<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">\n  <metadataTypes count="1">\n    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>\n  </metadataTypes>\n  <futureMetadata name="XLDAPR" count="1">\n    <bk>\n      <extLst>\n        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">\n          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>\n        </ext>\n      </extLst>\n    </bk>\n  </futureMetadata>\n  <cellMetadata count="1">\n    <bk>\n      <rc t="1" v="0"/>\n    </bk>\n  </cellMetadata>\n</metadata>'),e.join("")}var Uw=1024;function jw(e,t){for(var n=[21600,21600],r=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),i=[rv("xml",null,{"xmlns:v":xv,"xmlns:o":bv,"xmlns:x":wv,"xmlns:mv":Sv}).replace(/\/>/,">"),rv("o:shapelayout",rv("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),rv("v:shapetype",[rv("v:stroke",null,{joinstyle:"miter"}),rv("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:n.join(","),path:r})];Uw<1e3*e;)Uw+=1e3;return t.forEach((function(e){var t=by(e[0]),n={color2:"#BEFF82",type:"gradient"};"gradient"==n.type&&(n.angle="-180");var r="gradient"==n.type?rv("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,a=rv("v:fill",r,n);++Uw,i=i.concat(["<v:shape"+nv({id:"_x0000_s"+Uw,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",a,rv("v:shadow",null,{on:"t",obscured:"t"}),rv("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",tv("x:Anchor",[t.c+1,0,t.r+1,0,t.c+3,20,t.r+5,20].join(",")),tv("x:AutoFill","False"),tv("x:Row",String(t.r)),tv("x:Column",String(t.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])})),i.push("</xml>"),i.join("")}function Bw(e){var t=[Fg,rv("comments",null,{xmlns:yv[0]})],n=[];return t.push("<authors>"),e.forEach((function(e){e[1].forEach((function(e){var r=Vg(e.a);-1==n.indexOf(r)&&(n.push(r),t.push("<author>"+r+"</author>")),e.T&&e.ID&&-1==n.indexOf("tc="+e.ID)&&(n.push("tc="+e.ID),t.push("<author>tc="+e.ID+"</author>"))}))})),0==n.length&&(n.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach((function(e){var r=0,i=[];if(e[1][0]&&e[1][0].T&&e[1][0].ID?r=n.indexOf("tc="+e[1][0].ID):e[1].forEach((function(e){e.a&&(r=n.indexOf(Vg(e.a))),i.push(e.t||"")})),t.push('<comment ref="'+e[0]+'" authorId="'+r+'"><text>'),i.length<=1)t.push(tv("t",Vg(i[0]||"")));else{for(var a="Comment:\n    "+i[0]+"\n",s=1;s<i.length;++s)a+="Reply:\n    "+i[s]+"\n";t.push(tv("t",Vg(a)))}t.push("</text></comment>")})),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function Vw(e,t,n){var r=[Fg,rv("ThreadedComments",null,{xmlns:uv}).replace(/[\/]>/,">")];return e.forEach((function(e){var i="";(e[1]||[]).forEach((function(a,s){if(a.T){a.a&&-1==t.indexOf(a.a)&&t.push(a.a);var o={ref:e[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+n.tcid++).slice(-12)+"}"};0==s?i=o.id:o.parentId=i,a.ID=o.id,a.a&&(o.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(a.a)).slice(-12)+"}"),r.push(rv("threadedComment",tv("text",a.t||""),o))}else delete a.ID}))})),r.push("</ThreadedComments>"),r.join("")}var $w=Ny;function Hw(e){var t=cy(),n=[];return uy(t,628),uy(t,630),e.forEach((function(e){e[1].forEach((function(e){n.indexOf(e.a)>-1||(n.push(e.a.slice(0,54)),uy(t,632,function(e){return Dy(e.slice(0,54))}(e.a)))}))})),uy(t,631),uy(t,633),e.forEach((function(e){e[1].forEach((function(r){r.iauthor=n.indexOf(r.a);var i={s:by(e[0]),e:by(e[0])};uy(t,635,function(e,t){return null==t&&(t=ly(36)),t.write_shift(4,e[1].iauthor),Qy(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}([i,r])),r.t&&r.t.length>0&&uy(t,637,Ly(r)),uy(t,636),delete r.iauthor}))})),uy(t,634),uy(t,629),t.end()}var Ww=["xlsb","xlsm","xlam","biff8","xla"];var Gw=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function n(e,n,r,i){var a=!1,s=!1;0==r.length?s=!0:"["==r.charAt(0)&&(s=!0,r=r.slice(1,-1)),0==i.length?a=!0:"["==i.charAt(0)&&(a=!0,i=i.slice(1,-1));var o=r.length>0?0|parseInt(r,10):0,l=i.length>0?0|parseInt(i,10):0;return a?l+=t.c:--l,s?o+=t.r:--o,n+(a?"":"$")+yy(l)+(s?"":"$")+gy(o)}return function(r,i){return t=i,r.replace(e,n)}}(),Kw=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,qw=function(){return function(e,t){return e.replace(Kw,(function(e,n,r,i,a,s){var o=vy(i)-(r?0:t.c),l=my(s)-(a?0:t.r);return n+"R"+(0==l?"":a?l+1:"["+l+"]")+"C"+(0==o?"":r?o+1:"["+o+"]")}))}}();function Yw(e,t){return e.replace(Kw,(function(e,n,r,i,a,s){return n+("$"==r?r+i:yy(vy(i)+t.c))+("$"==a?a+s:gy(my(s)+t.r))}))}function Xw(e){e.l+=1}function Qw(e,t){var n=e.read_shift(1==t?1:2);return[16383&n,n>>14&1,n>>15&1]}function Jw(e,t,n){var r=2;if(n){if(n.biff>=2&&n.biff<=5)return Zw(e);12==n.biff&&(r=4)}var i=e.read_shift(r),a=e.read_shift(r),s=Qw(e,2),o=Qw(e,2);return{s:{r:i,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function Zw(e){var t=Qw(e,2),n=Qw(e,2),r=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:r,cRel:t[1],rRel:t[2]},e:{r:n[0],c:i,cRel:n[1],rRel:n[2]}}}function eT(e,t,n){if(n&&n.biff>=2&&n.biff<=5)return function(e){var t=Qw(e,2),n=e.read_shift(1);return{r:t[0],c:n,cRel:t[1],rRel:t[2]}}(e);var r=e.read_shift(n&&12==n.biff?4:2),i=Qw(e,2);return{r:r,c:i[0],cRel:i[1],rRel:i[2]}}function tT(e){var t=e.read_shift(2),n=e.read_shift(2);return{r:t,c:255&n,fQuoted:!!(16384&n),cRel:n>>15,rRel:n>>15}}function nT(e){var t=1&e[e.l+1];return e.l+=4,[t,1]}function rT(e){return[e.read_shift(1),e.read_shift(1)]}function iT(e,t){var n=[e.read_shift(1)];if(12==t)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2}switch(n[0]){case 4:n[1]=Ib(e,1)?"TRUE":"FALSE",12!=t&&(e.l+=7);break;case 37:case 16:n[1]=sb[e[e.l]],e.l+=12==t?4:8;break;case 0:e.l+=8;break;case 1:n[1]=Jy(e);break;case 2:n[1]=zb(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function aT(e,t,n){for(var r=e.read_shift(12==n.biff?4:2),i=[],a=0;a!=r;++a)i.push((12==n.biff?Xy:Hb)(e,8));return i}function sT(e,t,n){var r=0,i=0;12==n.biff?(r=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),r=1+e.read_shift(2)),n.biff>=2&&n.biff<8&&(--r,0==--i&&(i=256));for(var a=0,s=[];a!=r&&(s[a]=[]);++a)for(var o=0;o!=i;++o)s[a][o]=iT(e,n.biff);return s}function oT(e,t,n){return e.l+=2,[tT(e)]}function lT(e){return e.l+=6,[]}function cT(e){return e.l+=2,[Db(e),1&e.read_shift(2)]}var uT=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];var hT={1:{n:"PtgExp",f:function(e,t,n){return e.l++,n&&12==n.biff?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(n&&2==n.biff?1:2)]}},2:{n:"PtgTbl",f:oy},3:{n:"PtgAdd",f:Xw},4:{n:"PtgSub",f:Xw},5:{n:"PtgMul",f:Xw},6:{n:"PtgDiv",f:Xw},7:{n:"PtgPower",f:Xw},8:{n:"PtgConcat",f:Xw},9:{n:"PtgLt",f:Xw},10:{n:"PtgLe",f:Xw},11:{n:"PtgEq",f:Xw},12:{n:"PtgGe",f:Xw},13:{n:"PtgGt",f:Xw},14:{n:"PtgNe",f:Xw},15:{n:"PtgIsect",f:Xw},16:{n:"PtgUnion",f:Xw},17:{n:"PtgRange",f:Xw},18:{n:"PtgUplus",f:Xw},19:{n:"PtgUminus",f:Xw},20:{n:"PtgPercent",f:Xw},21:{n:"PtgParen",f:Xw},22:{n:"PtgMissArg",f:Xw},23:{n:"PtgStr",f:function(e,t,n){return e.l++,Pb(e,0,n)}},26:{n:"PtgSheet",f:function(e,t,n){return e.l+=5,e.l+=2,e.l+=2==n.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(e,t,n){return e.l+=2==n.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(e){return e.l++,sb[e.read_shift(1)]}},29:{n:"PtgBool",f:function(e){return e.l++,0!==e.read_shift(1)}},30:{n:"PtgInt",f:function(e){return e.l++,e.read_shift(2)}},31:{n:"PtgNum",f:function(e){return e.l++,Jy(e)}},32:{n:"PtgArray",f:function(e,t,n){var r=(96&e[e.l++])>>5;return e.l+=2==n.biff?6:12==n.biff?14:7,[r]}},33:{n:"PtgFunc",f:function(e,t,n){var r=(96&e[e.l])>>5;e.l+=1;var i=e.read_shift(n&&n.biff<=3?1:2);return[NT[i],IT[i],r]}},34:{n:"PtgFuncVar",f:function(e,t,n){var r=e[e.l++],i=e.read_shift(1),a=n&&n.biff<=3?[88==r?-1:0,e.read_shift(1)]:function(e){return[e[e.l+1]>>7,32767&e.read_shift(2)]}(e);return[i,(0===a[0]?IT:AT)[a[1]]]}},35:{n:"PtgName",f:function(e,t,n){var r=e.read_shift(1)>>>5&3,i=!n||n.biff>=8?4:2,a=e.read_shift(i);switch(n.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[r,0,a]}},36:{n:"PtgRef",f:function(e,t,n){var r=(96&e[e.l])>>5;return e.l+=1,[r,eT(e,0,n)]}},37:{n:"PtgArea",f:function(e,t,n){return[(96&e[e.l++])>>5,Jw(e,n.biff>=2&&n.biff,n)]}},38:{n:"PtgMemArea",f:function(e,t,n){var r=e.read_shift(1)>>>5&3;return e.l+=n&&2==n.biff?3:4,[r,e.read_shift(n&&2==n.biff?1:2)]}},39:{n:"PtgMemErr",f:oy},40:{n:"PtgMemNoMem",f:oy},41:{n:"PtgMemFunc",f:function(e,t,n){return[e.read_shift(1)>>>5&3,e.read_shift(n&&2==n.biff?1:2)]}},42:{n:"PtgRefErr",f:function(e,t,n){var r=e.read_shift(1)>>>5&3;return e.l+=4,n.biff<8&&e.l--,12==n.biff&&(e.l+=2),[r]}},43:{n:"PtgAreaErr",f:function(e,t,n){var r=(96&e[e.l++])>>5;return e.l+=n&&n.biff>8?12:n.biff<8?6:8,[r]}},44:{n:"PtgRefN",f:function(e,t,n){var r=(96&e[e.l])>>5;e.l+=1;var i=function(e,t,n){var r=n&&n.biff?n.biff:8;if(r>=2&&r<=5)return function(e){var t=e.read_shift(2),n=e.read_shift(1),r=(32768&t)>>15,i=(16384&t)>>14;return t&=16383,1==r&&t>=8192&&(t-=16384),1==i&&n>=128&&(n-=256),{r:t,c:n,cRel:i,rRel:r}}(e);var i=e.read_shift(r>=12?4:2),a=e.read_shift(2),s=(16384&a)>>14,o=(32768&a)>>15;if(a&=16383,1==o)for(;i>524287;)i-=1048576;if(1==s)for(;a>8191;)a-=16384;return{r:i,c:a,cRel:s,rRel:o}}(e,0,n);return[r,i]}},45:{n:"PtgAreaN",f:function(e,t,n){var r=(96&e[e.l++])>>5,i=function(e,t,n){if(n.biff<8)return Zw(e);var r=e.read_shift(12==n.biff?4:2),i=e.read_shift(12==n.biff?4:2),a=Qw(e,2),s=Qw(e,2);return{s:{r:r,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:s[0],cRel:s[1],rRel:s[2]}}}(e,0,n);return[r,i]}},46:{n:"PtgMemAreaN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},57:{n:"PtgNameX",f:function(e,t,n){return 5==n.biff?function(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[t,n,r]}(e):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}},58:{n:"PtgRef3d",f:function(e,t,n){var r=(96&e[e.l])>>5;e.l+=1;var i=e.read_shift(2);return n&&5==n.biff&&(e.l+=12),[r,i,eT(e,0,n)]}},59:{n:"PtgArea3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,i=e.read_shift(2,"i");if(n)switch(n.biff){case 5:e.l+=12;break;case 12:0}return[r,i,Jw(e,0,n)]}},60:{n:"PtgRefErr3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,i=e.read_shift(2),a=4;if(n)switch(n.biff){case 5:a=15;break;case 12:a=6}return e.l+=a,[r,i]}},61:{n:"PtgAreaErr3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,i=e.read_shift(2),a=8;if(n)switch(n.biff){case 5:e.l+=12,a=6;break;case 12:a=12}return e.l+=a,[r,i]}},255:{}},fT={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},dT={1:{n:"PtgElfLel",f:cT},2:{n:"PtgElfRw",f:oT},3:{n:"PtgElfCol",f:oT},6:{n:"PtgElfRwV",f:oT},7:{n:"PtgElfColV",f:oT},10:{n:"PtgElfRadical",f:oT},11:{n:"PtgElfRadicalS",f:lT},13:{n:"PtgElfColS",f:lT},15:{n:"PtgElfColSV",f:lT},16:{n:"PtgElfRadicalLel",f:cT},25:{n:"PtgList",f:function(e){e.l+=2;var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(4),i=e.read_shift(2),a=e.read_shift(2);return{ixti:t,coltype:3&n,rt:uT[n>>2&31],idx:r,c:i,C:a}}},29:{n:"PtgSxName",f:function(e){return e.l+=2,[e.read_shift(4)]}},255:{}},pT={0:{n:"PtgAttrNoop",f:function(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=n&&2==n.biff?3:4,[r]}},2:{n:"PtgAttrIf",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e.read_shift(n&&2==n.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(e,t,n){e.l+=2;for(var r=e.read_shift(n&&2==n.biff?1:2),i=[],a=0;a<=r;++a)i.push(e.read_shift(n&&2==n.biff?1:2));return i}},8:{n:"PtgAttrGoto",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e.read_shift(n&&2==n.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(e,t,n){e.l+=n&&2==n.biff?3:4}},32:{n:"PtgAttrBaxcel",f:nT},33:{n:"PtgAttrBaxcel",f:nT},64:{n:"PtgAttrSpace",f:function(e){return e.read_shift(2),rT(e)}},65:{n:"PtgAttrSpaceSemi",f:function(e){return e.read_shift(2),rT(e)}},128:{n:"PtgAttrIfError",f:function(e){var t=255&e[e.l+1]?1:0;return e.l+=2,[t,e.read_shift(2)]}},255:{}};function mT(e,t,n,r){if(r.biff<8)return oy(e,t);for(var i=e.l+t,a=[],s=0;s!==n.length;++s)switch(n[s][0]){case"PtgArray":n[s][1]=sT(e,0,r),a.push(n[s][1]);break;case"PtgMemArea":n[s][2]=aT(e,n[s][1],r),a.push(n[s][2]);break;case"PtgExp":r&&12==r.biff&&(n[s][1][1]=e.read_shift(4),a.push(n[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[s][0]}return 0!==(t=i-e.l)&&a.push(oy(e,t)),a}function gT(e,t,n){for(var r,i,a=e.l+t,s=[];a!=e.l;)t=a-e.l,i=e[e.l],r=hT[i]||hT[fT[i]],24!==i&&25!==i||(r=(24===i?dT:pT)[e[e.l+1]]),r&&r.f?s.push([r.n,r.f(e,t,n)]):oy(e,t);return s}function vT(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n],i=[],a=0;a<r.length;++a){var s=r[a];if(s)if(2===s[0])i.push('"'+s[1].replace(/"/g,'""')+'"');else i.push(s[1]);else i.push("")}t.push(i.join(","))}return t.join(";")}var yT={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function bT(e,t,n){if(!e)return"SH33TJSERR0";if(n.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[t];if(n.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),0==t?"":e.XTI[t-1];if(!r)return"SH33TJSERR1";var i="";if(n.biff>8)switch(e[r[0]][0]){case 357:return i=-1==r[1]?"#REF":e.SheetNames[r[1]],r[1]==r[2]?i:i+":"+e.SheetNames[r[2]];case 358:return null!=n.SID?e.SheetNames[n.SID]:"SH33TJSSAME"+e[r[0]][0];default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return i=-1==r[1]?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?i:i+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map((function(e){return e.Name})).join(";;");default:return e[r[0]][0][3]?(i=-1==r[1]?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?i:i+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function wT(e,t,n){var r=bT(e,t,n);return"#REF"==r?r:function(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}(r,n)}function TT(e,t,n,r,i){var a,s,o,l,c=i&&i.biff||8,u={s:{c:0,r:0},e:{c:0,r:0}},h=[],f=0,d=0,p="";if(!e[0]||!e[0][0])return"";for(var m=-1,g="",v=0,y=e[0].length;v<y;++v){var b=e[0][v];switch(b[0]){case"PtgUminus":h.push("-"+h.pop());break;case"PtgUplus":h.push("+"+h.pop());break;case"PtgPercent":h.push(h.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(a=h.pop(),s=h.pop(),m>=0){switch(e[0][m][1][0]){case 0:g=Dg(" ",e[0][m][1][1]);break;case 1:g=Dg("\r",e[0][m][1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}s+=g,m=-1}h.push(s+yT[b[0]]+a);break;case"PtgIsect":a=h.pop(),s=h.pop(),h.push(s+" "+a);break;case"PtgUnion":a=h.pop(),s=h.pop(),h.push(s+","+a);break;case"PtgRange":a=h.pop(),s=h.pop(),h.push(s+":"+a);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":o=hy(b[1][1],u,i),h.push(dy(o,c));break;case"PtgRefN":o=n?hy(b[1][1],n,i):b[1][1],h.push(dy(o,c));break;case"PtgRef3d":f=b[1][1],o=hy(b[1][2],u,i);p=wT(r,f,i);h.push(p+"!"+dy(o,c));break;case"PtgFunc":case"PtgFuncVar":var w=b[1][0],T=b[1][1];w||(w=0);var E=0==(w&=127)?[]:h.slice(-w);h.length-=w,"User"===T&&(T=E.shift()),h.push(T+"("+E.join(",")+")");break;case"PtgBool":h.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":h.push(b[1]);break;case"PtgNum":h.push(String(b[1]));break;case"PtgStr":h.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":l=fy(b[1][1],n?{s:n}:u,i),h.push(py(l,i));break;case"PtgArea":l=fy(b[1][1],u,i),h.push(py(l,i));break;case"PtgArea3d":f=b[1][1],l=b[1][2],p=wT(r,f,i),h.push(p+"!"+py(l,i));break;case"PtgAttrSum":h.push("SUM("+h.pop()+")");break;case"PtgName":d=b[1][2];var S=(r.names||[])[d-1]||(r[0]||[])[d],x=S?S.Name:"SH33TJSNAME"+String(d);x&&"_xlfn."==x.slice(0,6)&&!i.xlfn&&(x=x.slice(6)),h.push(x);break;case"PtgNameX":var k,_=b[1][1];if(d=b[1][2],!(i.biff<=5)){var C="";if(14849==((r[_]||[])[0]||[])[0]||(1025==((r[_]||[])[0]||[])[0]?r[_][d]&&r[_][d].itab>0&&(C=r.SheetNames[r[_][d].itab-1]+"!"):C=r.SheetNames[d-1]+"!"),r[_]&&r[_][d])C+=r[_][d].Name;else if(r[0]&&r[0][d])C+=r[0][d].Name;else{var A=(bT(r,_,i)||"").split(";;");A[d-1]?C=A[d-1]:C+="SH33TJSERRX"}h.push(C);break}_<0&&(_=-_),r[_]&&(k=r[_][d]),k||(k={Name:"SH33TJSERRY"}),h.push(k.Name);break;case"PtgParen":var I="(",N=")";if(m>=0){switch(g="",e[0][m][1][0]){case 2:I=Dg(" ",e[0][m][1][1])+I;break;case 3:I=Dg("\r",e[0][m][1][1])+I;break;case 4:N=Dg(" ",e[0][m][1][1])+N;break;case 5:N=Dg("\r",e[0][m][1][1])+N;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}h.push(I+h.pop()+N);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":h.push("#REF!");break;case"PtgExp":o={c:b[1][1],r:b[1][0]};var D={c:n.c,r:n.r};if(r.sharedf[wy(o)]){var O=r.sharedf[wy(o)];h.push(TT(O,u,D,r,i))}else{var R=!1;for(a=0;a!=r.arrayf.length;++a)if(s=r.arrayf[a],!(o.c<s[0].s.c||o.c>s[0].e.c)&&!(o.r<s[0].s.r||o.r>s[0].e.r)){h.push(TT(s[1],u,D,r,i)),R=!0;break}R||h.push(b[1])}break;case"PtgArray":h.push("{"+vT(b[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=v;break;case"PtgMissArg":h.push("");break;case"PtgList":h.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(b))}if(3!=i.biff&&m>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][v][0])){var P=!0;switch((b=e[0][m])[1][0]){case 4:P=!1;case 0:g=Dg(" ",b[1][1]);break;case 5:P=!1;case 1:g=Dg("\r",b[1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}h.push((P?g:"")+h.pop()+(P?"":g)),m=-1}}if(h.length>1&&i.WTF)throw new Error("bad formula stack");return h[0]}function ET(e,t,n,r,i){var a=Vb(t,n,i),s=function(e){if(null==e){var t=ly(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}return Zy("number"==typeof e?e:0)}(e.v),o=ly(6);o.write_shift(2,33),o.write_shift(4,0);for(var l=ly(e.bf.length),c=0;c<e.bf.length;++c)l[c]=e.bf[c];return mm([a,s,o,l])}function ST(e,t,n){var r=e.read_shift(4),i=gT(e,r,n),a=e.read_shift(4);return[i,a>0?mT(e,a,i,n):null]}var xT=ST,kT=ST,_T=ST,CT=ST,AT={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},IT={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},NT={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};var DT="undefined"!==typeof Map;function OT(e,t,n){var r=0,i=e.length;if(n){if(DT?n.has(t):Object.prototype.hasOwnProperty.call(n,t))for(var a=DT?n.get(t):n[t];r<a.length;++r)if(e[a[r]].t===t)return e.Count++,a[r]}else for(;r<i;++r)if(e[r].t===t)return e.Count++,r;return e[i]={t:t},e.Count++,e.Unique++,n&&(DT?(n.has(t)||n.set(t,[]),n.get(t).push(i)):(Object.prototype.hasOwnProperty.call(n,t)||(n[t]=[]),n[t].push(i))),i}function RT(e,t){var n={min:e+1,max:e+1},r=-1;return t.MDW&&(pw=t.MDW),null!=t.width?n.customWidth=1:null!=t.wpx?r=gw(t.wpx):null!=t.wch&&(r=t.wch),r>-1?(n.width=vw(r),n.customWidth=1):null!=t.width&&(n.width=t.width),t.hidden&&(n.hidden=!0),null!=t.level&&(n.outlineLevel=n.level=t.level),n}function PT(e,t){if(e){var n=[.7,.7,.75,.75,.3,.3];"xlml"==t&&(n=[1,1,1,1,.5,.5]),null==e.left&&(e.left=n[0]),null==e.right&&(e.right=n[1]),null==e.top&&(e.top=n[2]),null==e.bottom&&(e.bottom=n[3]),null==e.header&&(e.header=n[4]),null==e.footer&&(e.footer=n[5])}}function LT(e,t,n){var r=n.revssf[null!=t.z?t.z:"General"],i=60,a=e.length;if(null==r&&n.ssf)for(;i<392;++i)if(null==n.ssf[i]){sg(t.z,i),n.ssf[i]=t.z,n.revssf[t.z]=r=i;break}for(i=0;i!=a;++i)if(e[i].numFmtId===r)return i;return e[a]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function MT(e,t,n){if(e&&e["!ref"]){var r=Sy(e["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+n+"): "+e["!ref"])}}var FT=["objects","scenarios","selectLockedCells","selectUnlockedCells"],zT=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function UT(e,t,n,r){if(e.c&&n["!comments"].push([t,e.c]),void 0===e.v&&"string"!==typeof e.f||"z"===e.t&&!e.f)return"";var i="",a=e.t,s=e.v;if("z"!==e.t)switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=sb[e.v];break;case"d":r&&r.cellDates?i=Ag(e.v,-1).toISOString():((e=Ng(e)).t="n",i=""+(e.v=wg(Ag(e.v)))),"undefined"===typeof e.z&&(e.z=Cm[14]);break;default:i=e.v}var o=tv("v",Vg(i)),l={r:t},c=LT(r.cellXfs,e,r);switch(0!==c&&(l.s=c),e.t){case"n":case"z":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;default:if(null==e.v){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){o=tv("v",""+OT(r.Strings,e.v,r.revStrings)),l.t="s";break}l.t="str"}if(e.t!=a&&(e.t=a,e.v=s),"string"==typeof e.f&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=rv("f",Vg(e.f),u)+(null!=e.v?o:"")}return e.l&&n["!links"].push([t,e.l]),e.D&&(l.cm=1),rv("c",o,l)}function jT(e,t,n,r){var i,a=[Fg,rv("worksheet",null,{xmlns:yv[0],"xmlns:r":pv})],s=n.SheetNames[e],o="",l=n.Sheets[s];null==l&&(l={});var c=l["!ref"]||"A1",u=Sy(c);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=Ey(u)}r||(r={}),l["!comments"]=[];var h=[];!function(e,t,n,r,i){var a=!1,s={},o=null;if("xlsx"!==r.bookType&&t.vbaraw){var l=t.SheetNames[n];try{t.Workbook&&(l=t.Workbook.Sheets[n].CodeName||l)}catch(u){}a=!0,s.codeName=Jg(Vg(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),o=(o||"")+rv("outlinePr",null,c)}(a||o)&&(i[i.length]=rv("sheetPr",o,s))}(l,n,e,t,a),a[a.length]=rv("dimension",null,{ref:c}),a[a.length]=function(e,t,n,r){var i={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),rv("sheetViews",rv("sheetView",null,i),{})}(0,0,0,n),t.sheetFormat&&(a[a.length]=rv("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),null!=l["!cols"]&&l["!cols"].length>0&&(a[a.length]=function(e,t){for(var n,r=["<cols>"],i=0;i!=t.length;++i)(n=t[i])&&(r[r.length]=rv("col",null,RT(i,n)));return r[r.length]="</cols>",r.join("")}(0,l["!cols"])),a[i=a.length]="<sheetData/>",l["!links"]=[],null!=l["!ref"]&&(o=function(e,t){var n,r,i=[],a=[],s=Sy(e["!ref"]),o="",l="",c=[],u=0,h=0,f=e["!rows"],d=Array.isArray(e),p={r:l},m=-1;for(h=s.s.c;h<=s.e.c;++h)c[h]=yy(h);for(u=s.s.r;u<=s.e.r;++u){for(a=[],l=gy(u),h=s.s.c;h<=s.e.c;++h){n=c[h]+l;var g=d?(e[u]||[])[h]:e[n];void 0!==g&&null!=(o=UT(g,n,e,t))&&a.push(o)}(a.length>0||f&&f[u])&&(p={r:l},f&&f[u]&&((r=f[u]).hidden&&(p.hidden=1),m=-1,r.hpx?m=ww(r.hpx):r.hpt&&(m=r.hpt),m>-1&&(p.ht=m,p.customHeight=1),r.level&&(p.outlineLevel=r.level)),i[i.length]=rv("row",a.join(""),p))}if(f)for(;u<f.length;++u)f&&f[u]&&(p={r:u+1},(r=f[u]).hidden&&(p.hidden=1),m=-1,r.hpx?m=ww(r.hpx):r.hpt&&(m=r.hpt),m>-1&&(p.ht=m,p.customHeight=1),r.level&&(p.outlineLevel=r.level),i[i.length]=rv("row","",p));return i.join("")}(l,t,0,0),o.length>0&&(a[a.length]=o)),a.length>i+1&&(a[a.length]="</sheetData>",a[i]=a[i].replace("/>",">")),l["!protect"]&&(a[a.length]=function(e){var t={sheet:1};return FT.forEach((function(n){null!=e[n]&&e[n]&&(t[n]="1")})),zT.forEach((function(n){null==e[n]||e[n]||(t[n]="0")})),e.password&&(t.password=hw(e.password).toString(16).toUpperCase()),rv("sheetProtection",null,t)}(l["!protect"])),null!=l["!autofilter"]&&(a[a.length]=function(e,t,n,r){var i="string"==typeof e.ref?e.ref:Ey(e.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var a=n.Workbook.Names,s=Ty(i);s.s.r==s.e.r&&(s.e.r=Ty(t["!ref"]).e.r,i=Ey(s));for(var o=0;o<a.length;++o){var l=a[o];if("_xlnm._FilterDatabase"==l.Name&&l.Sheet==r){l.Ref="'"+n.SheetNames[r]+"'!"+i;break}}return o==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+i}),rv("autoFilter",null,{ref:i})}(l["!autofilter"],l,n,e)),null!=l["!merges"]&&l["!merges"].length>0&&(a[a.length]=function(e){if(0===e.length)return"";for(var t='<mergeCells count="'+e.length+'">',n=0;n!=e.length;++n)t+='<mergeCell ref="'+Ey(e[n])+'"/>';return t+"</mergeCells>"}(l["!merges"]));var f,d,p=-1,m=-1;return l["!links"].length>0&&(a[a.length]="<hyperlinks>",l["!links"].forEach((function(e){e[1].Target&&(f={ref:e[0]},"#"!=e[1].Target.charAt(0)&&(m=db(r,-1,Vg(e[1].Target).replace(/#.*$/,""),ub.HLINK),f["r:id"]="rId"+m),(p=e[1].Target.indexOf("#"))>-1&&(f.location=Vg(e[1].Target.slice(p+1))),e[1].Tooltip&&(f.tooltip=Vg(e[1].Tooltip)),a[a.length]=rv("hyperlink",null,f))})),a[a.length]="</hyperlinks>"),delete l["!links"],null!=l["!margins"]&&(a[a.length]=(PT(d=l["!margins"]),rv("pageMargins",null,d))),t&&!t.ignoreEC&&void 0!=t.ignoreEC||(a[a.length]=tv("ignoredErrors",rv("ignoredError",null,{numberStoredAsText:1,sqref:c}))),h.length>0&&(m=db(r,-1,"../drawings/drawing"+(e+1)+".xml",ub.DRAW),a[a.length]=rv("drawing",null,{"r:id":"rId"+m}),l["!drawing"]=h),l["!comments"].length>0&&(m=db(r,-1,"../drawings/vmlDrawing"+(e+1)+".vml",ub.VML),a[a.length]=rv("legacyDrawing",null,{"r:id":"rId"+m}),l["!legacy"]=m),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function BT(e,t,n,r){var i=function(e,t,n){var r=ly(145),i=(n["!rows"]||[])[e]||{};r.write_shift(4,e),r.write_shift(4,0);var a=320;i.hpx?a=20*ww(i.hpx):i.hpt&&(a=20*i.hpt),r.write_shift(2,a),r.write_shift(1,0);var s=0;i.level&&(s|=i.level),i.hidden&&(s|=16),(i.hpx||i.hpt)&&(s|=32),r.write_shift(1,s),r.write_shift(1,0);var o=0,l=r.l;r.l+=4;for(var c={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var h=-1,f=-1,d=u<<10;d<u+1<<10;++d)c.c=d,(Array.isArray(n)?(n[c.r]||[])[c.c]:n[wy(c)])&&(h<0&&(h=d),f=d);h<0||(++o,r.write_shift(4,h),r.write_shift(4,f))}var p=r.l;return r.l=l,r.write_shift(4,o),r.l=p,r.length>r.l?r.slice(0,r.l):r}(r,n,t);(i.length>17||(t["!rows"]||[])[r])&&uy(e,0,i)}var VT=Xy,$T=Qy;function HT(e){return[zy(e),Jy(e),"n"]}var WT=Xy,GT=Qy;var KT=["left","right","top","bottom","header","footer"];function qT(e,t,n,r,i,a,s){if(void 0===t.v)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":(t=Ng(t)).z=t.z||Cm[14],t.v=wg(Ag(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v}var l={r:n,c:r};switch(l.s=LT(i.cellXfs,t,i),t.l&&a["!links"].push([wy(l),t.l]),t.c&&a["!comments"].push([wy(l),t.c]),t.t){case"s":case"str":return i.bookSST?(o=OT(i.Strings,t.v,i.revStrings),l.t="s",l.v=o,s?uy(e,18,function(e,t,n){return null==n&&(n=ly(8)),Uy(t,n),n.write_shift(4,t.v),n}(0,l)):uy(e,7,function(e,t,n){return null==n&&(n=ly(12)),Fy(t,n),n.write_shift(4,t.v),n}(0,l))):(l.t="str",s?uy(e,17,function(e,t,n){return null==n&&(n=ly(8+4*e.v.length)),Uy(t,n),Dy(e.v,n),n.length>n.l?n.slice(0,n.l):n}(t,l)):uy(e,6,function(e,t,n){return null==n&&(n=ly(12+4*e.v.length)),Fy(t,n),Dy(e.v,n),n.length>n.l?n.slice(0,n.l):n}(t,l))),!0;case"n":return t.v==(0|t.v)&&t.v>-1e3&&t.v<1e3?s?uy(e,13,function(e,t,n){return null==n&&(n=ly(8)),Uy(t,n),qy(e.v,n),n}(t,l)):uy(e,2,function(e,t,n){return null==n&&(n=ly(12)),Fy(t,n),qy(e.v,n),n}(t,l)):s?uy(e,16,function(e,t,n){return null==n&&(n=ly(12)),Uy(t,n),Zy(e.v,n),n}(t,l)):uy(e,5,function(e,t,n){return null==n&&(n=ly(16)),Fy(t,n),Zy(e.v,n),n}(t,l)),!0;case"b":return l.t="b",s?uy(e,15,function(e,t,n){return null==n&&(n=ly(5)),Uy(t,n),n.write_shift(1,e.v?1:0),n}(t,l)):uy(e,4,function(e,t,n){return null==n&&(n=ly(9)),Fy(t,n),n.write_shift(1,e.v?1:0),n}(t,l)),!0;case"e":return l.t="e",s?uy(e,14,function(e,t,n){return null==n&&(n=ly(8)),Uy(t,n),n.write_shift(1,e.v),n.write_shift(2,0),n.write_shift(1,0),n}(t,l)):uy(e,3,function(e,t,n){return null==n&&(n=ly(9)),Fy(t,n),n.write_shift(1,e.v),n}(t,l)),!0}return s?uy(e,12,function(e,t,n){return null==n&&(n=ly(4)),Uy(t,n)}(0,l)):uy(e,1,function(e,t,n){return null==n&&(n=ly(8)),Fy(t,n)}(0,l)),!0}function YT(e,t){var n,r;t&&t["!merges"]&&(uy(e,177,(n=t["!merges"].length,null==r&&(r=ly(4)),r.write_shift(4,n),r)),t["!merges"].forEach((function(t){uy(e,176,GT(t))})),uy(e,178))}function XT(e,t){t&&t["!cols"]&&(uy(e,390),t["!cols"].forEach((function(t,n){t&&uy(e,60,function(e,t,n){null==n&&(n=ly(18));var r=RT(e,t);n.write_shift(-4,e),n.write_shift(-4,e),n.write_shift(4,256*(r.width||10)),n.write_shift(4,0);var i=0;return t.hidden&&(i|=1),"number"==typeof r.width&&(i|=2),t.level&&(i|=t.level<<8),n.write_shift(2,i),n}(n,t))})),uy(e,391))}function QT(e,t){t&&t["!ref"]&&(uy(e,648),uy(e,649,function(e){var t=ly(24);return t.write_shift(4,4),t.write_shift(4,1),Qy(e,t),t}(Sy(t["!ref"]))),uy(e,650))}function JT(e,t,n){t["!links"].forEach((function(t){if(t[1].Target){var r=db(n,-1,t[1].Target.replace(/#.*$/,""),ub.HLINK);uy(e,494,function(e,t){var n=ly(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Qy({s:by(e[0]),e:by(e[0])},n),Gy("rId"+t,n);var r=e[1].Target.indexOf("#");return Dy((-1==r?"":e[1].Target.slice(r+1))||"",n),Dy(e[1].Tooltip||"",n),Dy("",n),n.slice(0,n.l)}(t,r))}})),delete t["!links"]}function ZT(e,t,n){uy(e,133),uy(e,137,function(e,t,n){null==n&&(n=ly(30));var r=924;return(((t||{}).Views||[])[0]||{}).RTL&&(r|=32),n.write_shift(2,r),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,100),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(4,0),n}(0,n)),uy(e,138),uy(e,134)}function eE(e,t){var n,r;t["!protect"]&&uy(e,535,(n=t["!protect"],null==r&&(r=ly(66)),r.write_shift(2,n.password?hw(n.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach((function(e){e[1]?r.write_shift(4,null==n[e[0]]||n[e[0]]?0:1):r.write_shift(4,null!=n[e[0]]&&n[e[0]]?0:1)})),r))}function tE(e,t,n,r){var i=cy(),a=n.SheetNames[e],s=n.Sheets[a]||{},o=a;try{n&&n.Workbook&&(o=n.Workbook.Sheets[e].CodeName||o)}catch(h){}var l,c,u=Sy(s["!ref"]||"A1");if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],uy(i,129),(n.vbaraw||s["!outline"])&&uy(i,147,function(e,t,n){null==n&&(n=ly(84+4*e.length));var r=192;t&&(t.above&&(r&=-65),t.left&&(r&=-129)),n.write_shift(1,r);for(var i=1;i<3;++i)n.write_shift(1,0);return eb({auto:1},n),n.write_shift(-4,-1),n.write_shift(-4,-1),By(e,n),n.slice(0,n.l)}(o,s["!outline"])),uy(i,148,$T(u)),ZT(i,0,n.Workbook),XT(i,s),function(e,t,n,r){var i,a=Sy(t["!ref"]||"A1"),s="",o=[];uy(e,145);var l=Array.isArray(t),c=a.e.r;t["!rows"]&&(c=Math.max(a.e.r,t["!rows"].length-1));for(var u=a.s.r;u<=c;++u){s=gy(u),BT(e,t,a,u);var h=!1;if(u<=a.e.r)for(var f=a.s.c;f<=a.e.c;++f){u===a.s.r&&(o[f]=yy(f)),i=o[f]+s;var d=l?(t[u]||[])[f]:t[i];h=!!d&&qT(e,d,u,f,r,t,h)}}uy(e,146)}(i,s,0,t),eE(i,s),function(e,t,n,r){if(t["!autofilter"]){var i=t["!autofilter"],a="string"===typeof i.ref?i.ref:Ey(i.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var s=n.Workbook.Names,o=Ty(a);o.s.r==o.e.r&&(o.e.r=Ty(t["!ref"]).e.r,a=Ey(o));for(var l=0;l<s.length;++l){var c=s[l];if("_xlnm._FilterDatabase"==c.Name&&c.Sheet==r){c.Ref="'"+n.SheetNames[r]+"'!"+a;break}}l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+a}),uy(e,161,Qy(Sy(a))),uy(e,162)}}(i,s,n,e),YT(i,s),JT(i,s,r),s["!margins"]&&uy(i,476,(l=s["!margins"],null==c&&(c=ly(48)),PT(l),KT.forEach((function(e){Zy(l[e],c)})),c)),t&&!t.ignoreEC&&void 0!=t.ignoreEC||QT(i,s),function(e,t,n,r){if(t["!comments"].length>0){var i=db(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",ub.VML);uy(e,551,Gy("rId"+i)),t["!legacy"]=i}}(i,s,e,r),uy(i,130),i.end()}var nE=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];var rE="][*?/\\".split("");function iE(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var n=!0;return rE.forEach((function(r){if(-1!=e.indexOf(r)){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");n=!1}})),n}function aE(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];!function(e,t,n){e.forEach((function(r,i){iE(r);for(var a=0;a<i;++a)if(r==e[a])throw new Error("Duplicate Sheet Name: "+r);if(n){var s=t&&t[i]&&t[i].CodeName||r;if(95==s.charCodeAt(0)&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}}))}(e.SheetNames,t,!!e.vbaraw);for(var n=0;n<e.SheetNames.length;++n)MT(e.Sheets[e.SheetNames[n]],e.SheetNames[n],n)}function sE(e){var t=[Fg];t[t.length]=rv("workbook",null,{xmlns:yv[0],"xmlns:r":pv});var n=e.Workbook&&(e.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(nE.forEach((function(t){null!=e.Workbook.WBProps[t[0]]&&e.Workbook.WBProps[t[0]]!=t[1]&&(r[t[0]]=e.Workbook.WBProps[t[0]])})),e.Workbook.WBProps.CodeName&&(r.codeName=e.Workbook.WBProps.CodeName,delete r.CodeName)),t[t.length]=rv("workbookPr",null,r);var i=e.Workbook&&e.Workbook.Sheets||[],a=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",a=0;a!=e.SheetNames.length&&i[a]&&i[a].Hidden;++a);a==e.SheetNames.length&&(a=0),t[t.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",a=0;a!=e.SheetNames.length;++a){var s={name:Vg(e.SheetNames[a].slice(0,31))};if(s.sheetId=""+(a+1),s["r:id"]="rId"+(a+1),i[a])switch(i[a].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden"}t[t.length]=rv("sheet",null,s)}return t[t.length]="</sheets>",n&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach((function(e){var n={name:e.Name};e.Comment&&(n.comment=e.Comment),null!=e.Sheet&&(n.localSheetId=""+e.Sheet),e.Hidden&&(n.hidden="1"),e.Ref&&(t[t.length]=rv("definedName",Vg(e.Ref),n))})),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function oE(e,t){if(t.Workbook&&t.Workbook.Sheets){for(var n,r,i=t.Workbook.Sheets,a=0,s=-1,o=-1;a<i.length;++a)!i[a]||!i[a].Hidden&&-1==s?s=a:1==i[a].Hidden&&-1==o&&(o=a);if(!(o>s))uy(e,135),uy(e,158,(n=s,r||(r=ly(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,n),r.write_shift(4,n),r.write_shift(1,120),r.length>r.l?r.slice(0,r.l):r)),uy(e,136)}}function lE(e,t){var n=cy();return uy(n,131),uy(n,128,function(e,t){t||(t=ly(127));for(var n=0;4!=n;++n)t.write_shift(4,0);return Dy("SheetJS",t),Dy(Kp.version,t),Dy(Kp.version,t),Dy("7262",t),t.length>t.l?t.slice(0,t.l):t}()),uy(n,153,function(e,t){t||(t=ly(72));var n=0;return e&&e.filterPrivacy&&(n|=8),t.write_shift(4,n),t.write_shift(4,0),By(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}(e.Workbook&&e.Workbook.WBProps||null)),oE(n,e),function(e,t){uy(e,143);for(var n=0;n!=t.SheetNames.length;++n){uy(e,156,(r={Hidden:t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[n]&&t.Workbook.Sheets[n].Hidden||0,iTabID:n+1,strRelID:"rId"+(n+1),name:t.SheetNames[n]},(i=void 0)||(i=ly(127)),i.write_shift(4,r.Hidden),i.write_shift(4,r.iTabID),Gy(r.strRelID,i),Dy(r.name.slice(0,31),i),i.length>i.l?i.slice(0,i.l):i))}var r,i;uy(e,144)}(n,e),uy(n,132),n.end()}function cE(e,t,n,r,i){return(".bin"===t.slice(-4)?tE:jT)(e,n,r,i)}function uE(e,t,n){return(".bin"===t.slice(-4)?Hw:Bw)(e,n)}function hE(e,t){var n=[];return e.Props&&n.push(function(e,t){var n=[];return mg(Sb).map((function(e){for(var t=0;t<gb.length;++t)if(gb[t][1]==e)return gb[t];for(t=0;t<bb.length;++t)if(bb[t][1]==e)return bb[t];throw e})).forEach((function(r){if(null!=e[r[1]]){var i=t&&t.Props&&null!=t.Props[r[1]]?t.Props[r[1]]:e[r[1]];"date"===r[2]&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"Z")),"number"==typeof i?i=String(i):!0===i||!1===i?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),n.push(tv(Sb[r[1]]||r[1],i))}})),rv("DocumentProperties",n.join(""),{xmlns:bv})}(e.Props,t)),e.Custprops&&n.push(function(e,t){var n=["Worksheets","SheetNames"],r="CustomDocumentProperties",i=[];return e&&mg(e).forEach((function(t){if(Object.prototype.hasOwnProperty.call(e,t)){for(var r=0;r<gb.length;++r)if(t==gb[r][1])return;for(r=0;r<bb.length;++r)if(t==bb[r][1])return;for(r=0;r<n.length;++r)if(t==n[r])return;var a=e[t],s="string";"number"==typeof a?(s="float",a=String(a)):!0===a||!1===a?(s="boolean",a=a?"1":"0"):a=String(a),i.push(rv($g(t),a,{"dt:dt":s}))}})),t&&mg(t).forEach((function(n){if(Object.prototype.hasOwnProperty.call(t,n)&&(!e||!Object.prototype.hasOwnProperty.call(e,n))){var r=t[n],a="string";"number"==typeof r?(a="float",r=String(r)):!0===r||!1===r?(a="boolean",r=r?"1":"0"):r instanceof Date?(a="dateTime.tz",r=r.toISOString()):r=String(r),i.push(rv($g(n),r,{"dt:dt":a}))}})),"<"+r+' xmlns="'+bv+'">'+i.join("")+"</"+r+">"}(e.Props,e.Custprops)),n.join("")}function fE(e){return rv("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+qw(e.Ref,{r:0,c:0})})}function dE(e,t,n,r,i,a,s){if(!e||void 0==e.v&&void 0==e.f)return"";var o={};if(e.f&&(o["ss:Formula"]="="+Vg(qw(e.f,s))),e.F&&e.F.slice(0,t.length)==t){var l=by(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==s.r?"":"["+(l.r-s.r)+"]")+"C"+(l.c==s.c?"":"["+(l.c-s.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=Vg(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=Vg(e.l.Tooltip))),n["!merges"])for(var c=n["!merges"],u=0;u!=c.length;++u)c[u].s.c==s.c&&c[u].s.r==s.r&&(c[u].e.c>c[u].s.c&&(o["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(o["ss:MergeDown"]=c[u].e.r-c[u].s.r));var h="",f="";switch(e.t){case"z":if(!r.sheetStubs)return"";break;case"n":h="Number",f=String(e.v);break;case"b":h="Boolean",f=e.v?"1":"0";break;case"e":h="Error",f=sb[e.v];break;case"d":h="DateTime",f=new Date(e.v).toISOString(),null==e.z&&(e.z=e.z||Cm[14]);break;case"s":h="String",f=((e.v||"")+"").replace(jg,(function(e){return Ug[e]})).replace(Hg,(function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"}))}var d=LT(r.cellXfs,e,r);o["ss:StyleID"]="s"+(21+d),o["ss:Index"]=s.c+1;var p=null!=e.v?f:"",m="z"==e.t?"":'<Data ss:Type="'+h+'">'+p+"</Data>";return(e.c||[]).length>0&&(m+=e.c.map((function(e){var t=rv("ss:Data",(e.t||"").replace(/(\r\n|[\r\n])/g,"&#10;"),{xmlns:"http://www.w3.org/TR/REC-html40"});return rv("Comment",t,{"ss:Author":e.a})})).join("")),rv("Cell",m,o)}function pE(e,t){var n='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Tw(t.hpt)),t.hpx&&(n+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(n+=' ss:Hidden="1"')),n+">"}function mE(e,t,n){var r=[],i=n.SheetNames[e],a=n.Sheets[i],s=a?function(e,t,n,r){if(!e)return"";if(!((r||{}).Workbook||{}).Names)return"";for(var i=r.Workbook.Names,a=[],s=0;s<i.length;++s){var o=i[s];o.Sheet==n&&(o.Name.match(/^_xlfn\./)||a.push(fE(o)))}return a.join("")}(a,0,e,n):"";return s.length>0&&r.push("<Names>"+s+"</Names>"),s=a?function(e,t){if(!e["!ref"])return"";var n=Sy(e["!ref"]),r=e["!merges"]||[],i=0,a=[];e["!cols"]&&e["!cols"].forEach((function(e,t){yw(e);var n=!!e.width,r=RT(t,e),i={"ss:Index":t+1};n&&(i["ss:Width"]=mw(r.width)),e.hidden&&(i["ss:Hidden"]="1"),a.push(rv("Column",null,i))}));for(var s=Array.isArray(e),o=n.s.r;o<=n.e.r;++o){for(var l=[pE(o,(e["!rows"]||[])[o])],c=n.s.c;c<=n.e.c;++c){var u=!1;for(i=0;i!=r.length;++i)if(!(r[i].s.c>c)&&!(r[i].s.r>o)&&!(r[i].e.c<c)&&!(r[i].e.r<o)){r[i].s.c==c&&r[i].s.r==o||(u=!0);break}if(!u){var h={r:o,c:c},f=wy(h),d=s?(e[o]||[])[c]:e[f];l.push(dE(d,f,e,t,0,0,h))}}l.push("</Row>"),l.length>2&&a.push(l.join(""))}return a.join("")}(a,t):"",s.length>0&&r.push("<Table>"+s+"</Table>"),r.push(function(e,t,n,r){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(rv("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(rv("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(rv("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[n])if(r.Workbook.Sheets[n].Hidden)i.push(rv("Visible",1==r.Workbook.Sheets[n].Hidden?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<n&&(!r.Workbook.Sheets[a]||r.Workbook.Sheets[a].Hidden);++a);a==n&&i.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(tv("ProtectContents","True")),e["!protect"].objects&&i.push(tv("ProtectObjects","True")),e["!protect"].scenarios&&i.push(tv("ProtectScenarios","True")),null==e["!protect"].selectLockedCells||e["!protect"].selectLockedCells?null==e["!protect"].selectUnlockedCells||e["!protect"].selectUnlockedCells||i.push(tv("EnableSelection","UnlockedCells")):i.push(tv("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach((function(t){e["!protect"][t[0]]&&i.push("<"+t[1]+"/>")}))),0==i.length?"":rv("WorksheetOptions",i.join(""),{xmlns:wv})}(a,0,e,n)),r.join("")}function gE(e,t){t||(t={}),e.SSF||(e.SSF=Ng(Cm)),e.SSF&&(lg(),og(e.SSF),t.revssf=yg(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],LT(t.cellXfs,{},{revssf:{General:0}}));var n=[];n.push(hE(e,t)),n.push(""),n.push(""),n.push("");for(var r=0;r<e.SheetNames.length;++r)n.push(rv("Worksheet",mE(r,t,e),{"ss:Name":Vg(e.SheetNames[r])}));return n[2]=function(e,t){var n=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach((function(e,t){var r=[];r.push(rv("NumberFormat",null,{"ss:Format":Vg(Cm[e.numFmtId])}));var i={"ss:ID":"s"+(21+t)};n.push(rv("Style",r.join(""),i))})),rv("Styles",n.join(""))}(0,t),n[3]=function(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,n=[],r=0;r<t.length;++r){var i=t[r];null==i.Sheet&&(i.Name.match(/^_xlfn\./)||n.push(fE(i)))}return rv("Names",n.join(""))}(e),Fg+rv("Workbook",n.join(""),{xmlns:Tv,"xmlns:o":bv,"xmlns:x":wv,"xmlns:ss":Tv,"xmlns:dt":Ev,"xmlns:html":kv})}var vE="e0859ff2f94f6810ab9108002b27b3d9",yE="02d5cdd59c2e1b10939708002b2cf9ae",bE="05d5cdd59c2e1b10939708002b2cf9ae";function wE(e,t){var n=t||{},r=hg.utils.cfb_new({root:"R"}),i="/Workbook";switch(n.bookType||"xls"){case"xls":n.bookType="biff8";case"xla":n.bookType||(n.bookType="xla");case"biff8":i="/Workbook",n.biff=8;break;case"biff5":i="/Book",n.biff=5;break;default:throw new Error("invalid type "+n.bookType+" for XLS CFB")}return hg.utils.cfb_add(r,i,DE(e,n)),8==n.biff&&(e.Props||e.Custprops)&&function(e,t){var n,r=[],i=[],a=[],s=0,o=gg(nb,"n"),l=gg(rb,"n");if(e.Props)for(n=mg(e.Props),s=0;s<n.length;++s)(Object.prototype.hasOwnProperty.call(o,n[s])?r:Object.prototype.hasOwnProperty.call(l,n[s])?i:a).push([n[s],e.Props[n[s]]]);if(e.Custprops)for(n=mg(e.Custprops),s=0;s<n.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},n[s])||(Object.prototype.hasOwnProperty.call(o,n[s])?r:Object.prototype.hasOwnProperty.call(l,n[s])?i:a).push([n[s],e.Custprops[n[s]]]);var c=[];for(s=0;s<a.length;++s)kb.indexOf(a[s][0])>-1||wb.indexOf(a[s][0])>-1||null!=a[s][1]&&c.push(a[s]);i.length&&hg.utils.cfb_add(t,"/\x05SummaryInformation",Ab(i,vE,l,rb)),(r.length||c.length)&&hg.utils.cfb_add(t,"/\x05DocumentSummaryInformation",Ab(r,yE,o,nb,c.length?c:null,bE))}(e,r),8==n.biff&&e.vbaraw&&function(e,t){t.FullPaths.forEach((function(n,r){if(0!=r){var i=n.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");"/"!==i.slice(-1)&&hg.utils.cfb_add(e,i,t.FileIndex[r].content)}}))}(r,hg.read(e.vbaraw,{type:"string"==typeof e.vbaraw?"binary":"buffer"})),r}var TE={0:{f:function(e,t){var n={},r=e.l+t;n.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=r,7&a&&(n.level=7&a),16&a&&(n.hidden=!0),32&a&&(n.hpt=i/20),n}},1:{f:function(e){return[My(e)]}},2:{f:function(e){return[My(e),Ky(e),"n"]}},3:{f:function(e){return[My(e),e.read_shift(1),"e"]}},4:{f:function(e){return[My(e),e.read_shift(1),"b"]}},5:{f:function(e){return[My(e),Jy(e),"n"]}},6:{f:function(e){return[My(e),Ny(e),"str"]}},7:{f:function(e){return[My(e),e.read_shift(4),"s"]}},8:{f:function(e,t,n){var r=e.l+t,i=My(e);i.r=n["!row"];var a=[i,Ny(e),"str"];if(n.cellFormula){e.l+=2;var s=kT(e,r-e.l,n);a[3]=TT(s,0,i,n.supbooks,n)}else e.l=r;return a}},9:{f:function(e,t,n){var r=e.l+t,i=My(e);i.r=n["!row"];var a=[i,Jy(e),"n"];if(n.cellFormula){e.l+=2;var s=kT(e,r-e.l,n);a[3]=TT(s,0,i,n.supbooks,n)}else e.l=r;return a}},10:{f:function(e,t,n){var r=e.l+t,i=My(e);i.r=n["!row"];var a=[i,e.read_shift(1),"b"];if(n.cellFormula){e.l+=2;var s=kT(e,r-e.l,n);a[3]=TT(s,0,i,n.supbooks,n)}else e.l=r;return a}},11:{f:function(e,t,n){var r=e.l+t,i=My(e);i.r=n["!row"];var a=[i,e.read_shift(1),"e"];if(n.cellFormula){e.l+=2;var s=kT(e,r-e.l,n);a[3]=TT(s,0,i,n.supbooks,n)}else e.l=r;return a}},12:{f:function(e){return[zy(e)]}},13:{f:function(e){return[zy(e),Ky(e),"n"]}},14:{f:function(e){return[zy(e),e.read_shift(1),"e"]}},15:{f:function(e){return[zy(e),e.read_shift(1),"b"]}},16:{f:HT},17:{f:function(e){return[zy(e),Ny(e),"str"]}},18:{f:function(e){return[zy(e),e.read_shift(4),"s"]}},19:{f:Ry},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(e,t,n){var r=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),a=Hy(e),s=_T(e,0,n),o=Vy(e);e.l=r;var l={Name:a,Ptg:s};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}},40:{},42:{},43:{f:function(e,t,n){var r={};r.sz=e.read_shift(2)/20;var i=function(e){var t=e.read_shift(1);return e.l++,{fBold:1&t,fItalic:2&t,fUnderline:4&t,fStrikeout:8&t,fOutline:16&t,fShadow:32&t,fCondense:64&t,fExtend:128&t}}(e);switch(i.fItalic&&(r.italic=1),i.fCondense&&(r.condense=1),i.fExtend&&(r.extend=1),i.fShadow&&(r.shadow=1),i.fOutline&&(r.outline=1),i.fStrikeout&&(r.strike=1),700===e.read_shift(2)&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript"}var a=e.read_shift(1);0!=a&&(r.underline=a);var s=e.read_shift(1);s>0&&(r.family=s);var o=e.read_shift(1);switch(o>0&&(r.charset=o),e.l++,r.color=function(e){var t={},n=e.read_shift(1)>>>1,r=e.read_shift(1),i=e.read_shift(2,"i"),a=e.read_shift(1),s=e.read_shift(1),o=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=r;var l=ab[r];l&&(t.rgb=dw(l));break;case 2:t.rgb=dw([a,s,o]);break;case 3:t.theme=r}return 0!=i&&(t.tint=i>0?i/32767:i/32768),t}(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor"}return r.name=Ny(e),r}},44:{f:function(e,t){return[e.read_shift(2),Ny(e)]}},45:{f:Cw},46:{f:Dw},47:{f:function(e,t){var n=e.l+t,r=e.read_shift(2),i=e.read_shift(2);return e.l=n,{ixfe:r,numFmtId:i}}},48:{},49:{f:function(e){return e.read_shift(4,"i")}},50:{},51:{f:function(e){for(var t=[],n=e.read_shift(4);n-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Zb},62:{f:function(e){return[My(e),Ry(e),"is"]}},63:{f:function(e){var t={};t.i=e.read_shift(4);var n={};n.r=e.read_shift(4),n.c=e.read_shift(4),t.r=wy(n);var r=e.read_shift(1);return 2&r&&(t.l="1"),8&r&&(t.a="1"),t}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:oy,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(e){var t=e.read_shift(2);return e.l+=28,{RTL:32&t}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(e,t){var n={},r=e[e.l];return++e.l,n.above=!(64&r),n.left=!(128&r),e.l+=18,n.name=jy(e,t-19),n}},148:{f:VT,p:16},151:{f:function(){}},152:{},153:{f:function(e,t){var n={},r=e.read_shift(4);n.defaultThemeVersion=e.read_shift(4);var i=t>8?Ny(e):"";return i.length>0&&(n.CodeName=i),n.autoCompressPictures=!!(65536&r),n.backupFile=!!(64&r),n.checkCompatibility=!!(4096&r),n.date1904=!!(1&r),n.filterPrivacy=!!(8&r),n.hidePivotFieldList=!!(1024&r),n.promptedSolutions=!!(16&r),n.publishItems=!!(2048&r),n.refreshAllConnections=!!(262144&r),n.saveExternalLinkValues=!!(128&r),n.showBorderUnselectedTables=!!(4&r),n.showInkAnnotation=!!(32&r),n.showObjects=["all","placeholders","none"][r>>13&3],n.showPivotChartFilter=!!(32768&r),n.updateLinks=["userSet","never","always"][r>>8&3],n}},154:{},155:{},156:{f:function(e,t){var n={};return n.Hidden=e.read_shift(4),n.iTabID=e.read_shift(4),n.strRelID=Wy(e,t-8),n.name=Ny(e),n}},157:{},158:{},159:{T:1,f:function(e){return[e.read_shift(4),e.read_shift(4)]}},160:{T:-1},161:{T:1,f:Xy},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:WT},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Ny(e)}}},336:{T:-1},337:{f:function(e){return e.l+=4,0!=e.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Wy},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Xb},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(e,t,n){var r=e.l+t,i=Yy(e),a=e.read_shift(1),s=[i];if(s[2]=a,n.cellFormula){var o=xT(e,r-e.l,n);s[1]=o}else e.l=r;return s}},427:{f:function(e,t,n){var r=e.l+t,i=[Xy(e,16)];if(n.cellFormula){var a=CT(e,r-e.l,n);i[1]=a,e.l=r}else e.l=r;return i}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(e){var t={};return KT.forEach((function(n){t[n]=Jy(e)})),t}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(e,t){var n=e.l+t,r=Xy(e,16),i=Vy(e),a=Ny(e),s=Ny(e),o=Ny(e);e.l=n;var l={rfx:r,relId:i,loc:a,display:o};return s&&(l.Tooltip=s),l}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Wy},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:$w},633:{T:1},634:{T:-1},635:{T:1,f:function(e){var t={};t.iauthor=e.read_shift(4);var n=Xy(e,16);return t.rfx=n.s,t.ref=wy(n.s),e.l+=16,t}},636:{T:-1},637:{f:Py},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(e,t){return e.l+=10,{name:Ny(e)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function EE(e,t,n,r){var i=t;if(!isNaN(i)){var a=r||(n||[]).length||0,s=e.next(4);s.write_shift(2,i),s.write_shift(2,a),a>0&&Gv(n)&&e.push(n)}}function SE(e,t,n){return e||(e=ly(7)),e.write_shift(2,t),e.write_shift(2,n),e.write_shift(2,0),e.write_shift(1,0),e}function xE(e,t,n,r){if(null!=t.v)switch(t.t){case"d":case"n":var i="d"==t.t?wg(Ag(t.v)):t.v;return void(i==(0|i)&&i>=0&&i<65536?EE(e,2,function(e,t,n){var r=ly(9);return SE(r,e,t),r.write_shift(2,n),r}(n,r,i)):EE(e,3,function(e,t,n){var r=ly(15);return SE(r,e,t),r.write_shift(8,n,"f"),r}(n,r,i)));case"b":case"e":return void EE(e,5,function(e,t,n,r){var i=ly(9);return SE(i,e,t),Rb(n,r||"b",i),i}(n,r,t.v,t.t));case"s":case"str":return void EE(e,4,function(e,t,n){var r=ly(8+2*n.length);return SE(r,e,t),r.write_shift(1,n.length),r.write_shift(n.length,n,"sbcs"),r.l<r.length?r.slice(0,r.l):r}(n,r,(t.v||"").slice(0,255)))}EE(e,1,SE(null,n,r))}function kE(e,t){var n=t||{};for(var r=cy(),i=0,a=0;a<e.SheetNames.length;++a)e.SheetNames[a]==n.sheet&&(i=a);if(0==i&&n.sheet&&e.SheetNames[0]!=n.sheet)throw new Error("Sheet not found: "+n.sheet);return EE(r,4==n.biff?1033:3==n.biff?521:9,Gb(0,16,n)),function(e,t,n,r){var i,a=Array.isArray(t),s=Sy(t["!ref"]||"A1"),o="",l=[];if(s.e.c>255||s.e.r>16383){if(r.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),i=Ey(s)}for(var c=s.s.r;c<=s.e.r;++c){o=gy(c);for(var u=s.s.c;u<=s.e.c;++u){c===s.s.r&&(l[u]=yy(u)),i=l[u]+o;var h=a?(t[c]||[])[u]:t[i];h&&xE(e,h,c,u)}}}(r,e.Sheets[e.SheetNames[i]],0,n),EE(r,10),r.end()}function _E(e,t,n){EE(e,49,function(e,t){var n=e.name||"Arial",r=t&&5==t.biff,i=ly(r?15+n.length:16+2*n.length);return i.write_shift(2,20*(e.sz||12)),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,n.length),r||i.write_shift(1,1),i.write_shift((r?1:2)*n.length,n,r?"sbcs":"utf16le"),i}({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},n))}function CE(e,t){if(t){var n=0;t.forEach((function(t,r){++n<=256&&t&&EE(e,125,function(e,t){var n=ly(12);n.write_shift(2,t),n.write_shift(2,t),n.write_shift(2,256*e.width),n.write_shift(2,0);var r=0;return e.hidden&&(r|=1),n.write_shift(1,r),r=e.level||0,n.write_shift(1,r),n.write_shift(2,0),n}(RT(r,t),r))}))}}function AE(e,t,n,r,i){var a=16+LT(i.cellXfs,t,i);if(null!=t.v||t.bf)if(t.bf)EE(e,6,ET(t,n,r,0,a));else switch(t.t){case"d":case"n":EE(e,515,function(e,t,n,r){var i=ly(14);return Vb(e,t,r,i),Zy(n,i),i}(n,r,"d"==t.t?wg(Ag(t.v)):t.v,a));break;case"b":case"e":EE(e,517,function(e,t,n,r,i,a){var s=ly(8);return Vb(e,t,r,s),Rb(n,a,s),s}(n,r,t.v,a,0,t.t));break;case"s":case"str":if(i.bookSST)EE(e,253,function(e,t,n,r){var i=ly(10);return Vb(e,t,r,i),i.write_shift(4,n),i}(n,r,OT(i.Strings,t.v,i.revStrings),a));else EE(e,516,function(e,t,n,r,i){var a=!i||8==i.biff,s=ly(+a+8+(1+a)*n.length);return Vb(e,t,r,s),s.write_shift(2,n.length),a&&s.write_shift(1,1),s.write_shift((1+a)*n.length,n,a?"utf16le":"sbcs"),s}(n,r,(t.v||"").slice(0,255),a,i));break;default:EE(e,513,Vb(n,r,a))}else EE(e,513,Vb(n,r,a))}function IE(e,t,n){var r,i=cy(),a=n.SheetNames[e],s=n.Sheets[a]||{},o=(n||{}).Workbook||{},l=(o.Sheets||[])[e]||{},c=Array.isArray(s),u=8==t.biff,h="",f=[],d=Sy(s["!ref"]||"A1"),p=u?65536:16384;if(d.e.c>255||d.e.r>=p){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");d.e.c=Math.min(d.e.c,255),d.e.r=Math.min(d.e.c,p-1)}EE(i,2057,Gb(0,16,t)),EE(i,13,Ob(1)),EE(i,12,Ob(100)),EE(i,15,Nb(!0)),EE(i,17,Nb(!1)),EE(i,16,Zy(.001)),EE(i,95,Nb(!0)),EE(i,42,Nb(!1)),EE(i,43,Nb(!1)),EE(i,130,Ob(1)),EE(i,128,function(e){var t=ly(8);return t.write_shift(4,0),t.write_shift(2,e[0]?e[0]+1:0),t.write_shift(2,e[1]?e[1]+1:0),t}([0,0])),EE(i,131,Nb(!1)),EE(i,132,Nb(!1)),u&&CE(i,s["!cols"]),EE(i,512,function(e,t){var n=8!=t.biff&&t.biff?2:4,r=ly(2*n+6);return r.write_shift(n,e.s.r),r.write_shift(n,e.e.r+1),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c+1),r.write_shift(2,0),r}(d,t)),u&&(s["!links"]=[]);for(var m=d.s.r;m<=d.e.r;++m){h=gy(m);for(var g=d.s.c;g<=d.e.c;++g){m===d.s.r&&(f[g]=yy(g)),r=f[g]+h;var v=c?(s[m]||[])[g]:s[r];v&&(AE(i,v,m,g,t),u&&v.l&&s["!links"].push([r,v.l]))}}var y=l.CodeName||l.name||a;return u&&EE(i,574,function(e){var t=ly(18),n=1718;return e&&e.RTL&&(n|=64),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}((o.Views||[])[0])),u&&(s["!merges"]||[]).length&&EE(i,229,function(e){var t=ly(2+8*e.length);t.write_shift(2,e.length);for(var n=0;n<e.length;++n)Wb(e[n],t);return t}(s["!merges"])),u&&function(e,t){for(var n=0;n<t["!links"].length;++n){var r=t["!links"][n];EE(e,440,Qb(r)),r[1].Tooltip&&EE(e,2048,Jb(r))}delete t["!links"]}(i,s),EE(i,442,Ub(y)),u&&function(e,t){var n=ly(19);n.write_shift(4,2151),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,1),n.write_shift(4,0),EE(e,2151,n),(n=ly(39)).write_shift(4,2152),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(2,1),n.write_shift(4,4),n.write_shift(2,0),Wb(Sy(t["!ref"]||"A1"),n),n.write_shift(4,4),EE(e,2152,n)}(i,s),EE(i,10),i.end()}function NE(e,t,n){var r=cy(),i=(e||{}).Workbook||{},a=i.Sheets||[],s=i.WBProps||{},o=8==n.biff,l=5==n.biff;(EE(r,2057,Gb(0,5,n)),"xla"==n.bookType&&EE(r,135),EE(r,225,o?Ob(1200):null),EE(r,193,function(e,t){t||(t=ly(e));for(var n=0;n<e;++n)t.write_shift(1,0);return t}(2)),l&&EE(r,191),l&&EE(r,192),EE(r,226),EE(r,92,function(e,t){var n=!t||8==t.biff,r=ly(n?112:54);for(r.write_shift(8==t.biff?2:1,7),n&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(n?0:536870912));r.l<r.length;)r.write_shift(1,n?0:32);return r}(0,n)),EE(r,66,Ob(o?1200:1252)),o&&EE(r,353,Ob(0)),o&&EE(r,448),EE(r,317,function(e){for(var t=ly(2*e),n=0;n<e;++n)t.write_shift(2,n+1);return t}(e.SheetNames.length)),o&&e.vbaraw&&EE(r,211),o&&e.vbaraw)&&EE(r,442,Ub(s.CodeName||"ThisWorkbook"));EE(r,156,Ob(17)),EE(r,25,Nb(!1)),EE(r,18,Nb(!1)),EE(r,19,Ob(0)),o&&EE(r,431,Nb(!1)),o&&EE(r,444,Ob(0)),EE(r,61,function(){var e=ly(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}()),EE(r,64,Nb(!1)),EE(r,141,Ob(0)),EE(r,34,Nb("true"==function(e){return e.Workbook&&e.Workbook.WBProps&&Gg(e.Workbook.WBProps.date1904)?"true":"false"}(e))),EE(r,14,Nb(!0)),o&&EE(r,439,Nb(!1)),EE(r,218,Ob(0)),_E(r,0,n),function(e,t,n){t&&[[5,8],[23,26],[41,44],[50,392]].forEach((function(r){for(var i=r[0];i<=r[1];++i)null!=t[i]&&EE(e,1054,qb(i,t[i],n))}))}(r,e.SSF,n),function(e,t){for(var n=0;n<16;++n)EE(e,224,Yb({numFmtId:0,style:!0},0,t));t.cellXfs.forEach((function(n){EE(e,224,Yb(n,0,t))}))}(r,n),o&&EE(r,352,Nb(!1));var c,u=r.end(),h=cy();o&&EE(h,140,(c||(c=ly(4)),c.write_shift(2,1),c.write_shift(2,1),c)),o&&n.Strings&&function(e,t,n,r){var i=r||(n||[]).length||0;if(i<=8224)return EE(e,t,n,i);var a=t;if(!isNaN(a)){for(var s=n.parts||[],o=0,l=0,c=0;c+(s[o]||8224)<=8224;)c+=s[o]||8224,o++;var u=e.next(4);for(u.write_shift(2,a),u.write_shift(2,c),e.push(n.slice(l,l+c)),l+=c;l<i;){for((u=e.next(4)).write_shift(2,60),c=0;c+(s[o]||8224)<=8224;)c+=s[o]||8224,o++;u.write_shift(2,c),e.push(n.slice(l,l+c)),l+=c}}}(h,252,function(e){var t=ly(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var n=[],r=0;r<e.length;++r)n[r]=Lb(e[r]);var i=mm([t].concat(n));return i.parts=[t.length].concat(n.map((function(e){return e.length}))),i}(n.Strings)),EE(h,10);var f=h.end(),d=cy(),p=0,m=0;for(m=0;m<e.SheetNames.length;++m)p+=(o?12:11)+(o?2:1)*e.SheetNames[m].length;var g=u.length+p+f.length;for(m=0;m<e.SheetNames.length;++m){EE(d,133,Kb({pos:g,hs:(a[m]||{}).Hidden||0,dt:0,name:e.SheetNames[m]},n)),g+=t[m].length}var v=d.end();if(p!=v.length)throw new Error("BS8 "+p+" != "+v.length);var y=[];return u.length&&y.push(u),v.length&&y.push(v),f.length&&y.push(f),mm(y)}function DE(e,t){for(var n=0;n<=e.SheetNames.length;++n){var r=e.Sheets[e.SheetNames[n]];if(r&&r["!ref"])Ty(r["!ref"]).e.c>255&&"undefined"!=typeof console&&console.error&&console.error("Worksheet '"+e.SheetNames[n]+"' extends beyond column IV (255).  Data may be lost.")}var i=t||{};switch(i.biff||2){case 8:case 5:return function(e,t){var n=t||{},r=[];e&&!e.SSF&&(e.SSF=Ng(Cm)),e&&e.SSF&&(lg(),og(e.SSF),n.revssf=yg(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF),n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,oS(n),n.cellXfs=[],LT(n.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)r[r.length]=IE(i,n,e);return r.unshift(NE(e,r,n)),mm(r)}(e,t);case 4:case 3:case 2:return kE(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function OE(e,t,n,r){for(var i=e["!merges"]||[],a=[],s=t.s.c;s<=t.e.c;++s){for(var o=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>n||i[c].s.c>s)&&!(i[c].e.r<n||i[c].e.c<s)){if(i[c].s.r<n||i[c].s.c<s){o=-1;break}o=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var u=wy({r:n,c:s}),h=r.dense?(e[n]||[])[s]:e[u],f=h&&null!=h.v&&(h.h||Wg(h.w||(ky(h),h.w)||""))||"",d={};o>1&&(d.rowspan=o),l>1&&(d.colspan=l),r.editable?f='<span contenteditable="true">'+f+"</span>":h&&(d["data-t"]=h&&h.t||"z",null!=h.v&&(d["data-v"]=h.v),null!=h.z&&(d["data-z"]=h.z),h.l&&"#"!=(h.l.Target||"#").charAt(0)&&(f='<a href="'+h.l.Target+'">'+f+"</a>")),d.id=(r.id||"sjs")+"-"+u,a.push(rv("td",f,d))}}return"<tr>"+a.join("")+"</tr>"}var RE='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',PE="</body></html>";function LE(e,t,n){return[].join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function ME(e,t){var n=t||{},r=null!=n.header?n.header:RE,i=null!=n.footer?n.footer:PE,a=[r],s=Ty(e["!ref"]);n.dense=Array.isArray(e),a.push(LE(0,0,n));for(var o=s.s.r;o<=s.e.r;++o)a.push(OE(e,s,o,n));return a.push("</table>"+i),a.join("")}function FE(e,t,n){var r=n||{};var i=0,a=0;if(null!=r.origin)if("number"==typeof r.origin)i=r.origin;else{var s="string"==typeof r.origin?by(r.origin):r.origin;i=s.r,a=s.c}var o=t.getElementsByTagName("tr"),l=Math.min(r.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:i,c:a}};if(e["!ref"]){var u=Ty(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),-1==i&&(c.e.r=i=u.e.r+1)}var h=[],f=0,d=e["!rows"]||(e["!rows"]=[]),p=0,m=0,g=0,v=0,y=0,b=0;for(e["!cols"]||(e["!cols"]=[]);p<o.length&&m<l;++p){var w=o[p];if(UE(w)){if(r.display)continue;d[m]={hidden:!0}}var T=w.children;for(g=v=0;g<T.length;++g){var E=T[g];if(!r.display||!UE(E)){var S=E.hasAttribute("data-v")?E.getAttribute("data-v"):E.hasAttribute("v")?E.getAttribute("v"):Zg(E.innerHTML),x=E.getAttribute("data-z")||E.getAttribute("z");for(f=0;f<h.length;++f){var k=h[f];k.s.c==v+a&&k.s.r<m+i&&m+i<=k.e.r&&(v=k.e.c+1-a,f=-1)}b=+E.getAttribute("colspan")||1,((y=+E.getAttribute("rowspan")||1)>1||b>1)&&h.push({s:{r:m+i,c:v+a},e:{r:m+i+(y||1)-1,c:v+a+(b||1)-1}});var _={t:"s",v:S},C=E.getAttribute("data-t")||E.getAttribute("t")||"";null!=S&&(0==S.length?_.t=C||"z":r.raw||0==S.trim().length||"s"==C||("TRUE"===S?_={t:"b",v:!0}:"FALSE"===S?_={t:"b",v:!1}:isNaN(Og(S))?isNaN(Pg(S).getDate())||(_={t:"d",v:Ag(S)},r.cellDates||(_={t:"n",v:wg(_.v)}),_.z=r.dateNF||Cm[14]):_={t:"n",v:Og(S)})),void 0===_.z&&null!=x&&(_.z=x);var A="",I=E.getElementsByTagName("A");if(I&&I.length)for(var N=0;N<I.length&&(!I[N].hasAttribute("href")||"#"==(A=I[N].getAttribute("href")).charAt(0));++N);A&&"#"!=A.charAt(0)&&(_.l={Target:A}),r.dense?(e[m+i]||(e[m+i]=[]),e[m+i][v+a]=_):e[wy({c:v+a,r:m+i})]=_,c.e.c<v+a&&(c.e.c=v+a),v+=b}}++m}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,m-1+i),e["!ref"]=Ey(c),m>=l&&(e["!fullref"]=Ey((c.e.r=o.length-p+m-1+i,c))),e}function zE(e,t){return FE((t||{}).dense?[]:{},e,t)}function UE(e){var t="",n=function(e){return e.ownerDocument.defaultView&&"function"===typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"===typeof getComputedStyle?getComputedStyle:null}(e);return n&&(t=n(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),"none"===t}var jE=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+nv({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Fg+t}}(),BE=function(){var e="          <table:table-cell />\n",t=function(t,n,r){var i=[];i.push('      <table:table table:name="'+Vg(n.SheetNames[r])+'" table:style-name="ta1">\n');var a=0,s=0,o=Ty(t["!ref"]||"A1"),l=t["!merges"]||[],c=0,u=Array.isArray(t);if(t["!cols"])for(s=0;s<=o.e.c;++s)i.push("        <table:table-column"+(t["!cols"][s]?' table:style-name="co'+t["!cols"][s].ods+'"':"")+"></table:table-column>\n");var h="",f=t["!rows"]||[];for(a=0;a<o.s.r;++a)h=f[a]?' table:style-name="ro'+f[a].ods+'"':"",i.push("        <table:table-row"+h+"></table:table-row>\n");for(;a<=o.e.r;++a){for(h=f[a]?' table:style-name="ro'+f[a].ods+'"':"",i.push("        <table:table-row"+h+">\n"),s=0;s<o.s.c;++s)i.push(e);for(;s<=o.e.c;++s){var d=!1,p={},m="";for(c=0;c!=l.length;++c)if(!(l[c].s.c>s)&&!(l[c].s.r>a)&&!(l[c].e.c<s)&&!(l[c].e.r<a)){l[c].s.c==s&&l[c].s.r==a||(d=!0),p["table:number-columns-spanned"]=l[c].e.c-l[c].s.c+1,p["table:number-rows-spanned"]=l[c].e.r-l[c].s.r+1;break}if(d)i.push("          <table:covered-table-cell/>\n");else{var g=wy({r:a,c:s}),v=u?(t[a]||[])[s]:t[g];if(v&&v.f&&(p["table:formula"]=Vg(("of:="+v.f.replace(Kw,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")),v.F&&v.F.slice(0,g.length)==g)){var y=Ty(v.F);p["table:number-matrix-columns-spanned"]=y.e.c-y.s.c+1,p["table:number-matrix-rows-spanned"]=y.e.r-y.s.r+1}if(v){switch(v.t){case"b":m=v.v?"TRUE":"FALSE",p["office:value-type"]="boolean",p["office:boolean-value"]=v.v?"true":"false";break;case"n":m=v.w||String(v.v||0),p["office:value-type"]="float",p["office:value"]=v.v||0;break;case"s":case"str":m=null==v.v?"":v.v,p["office:value-type"]="string";break;case"d":m=v.w||Ag(v.v).toISOString(),p["office:value-type"]="date",p["office:date-value"]=Ag(v.v).toISOString(),p["table:style-name"]="ce1";break;default:i.push(e);continue}var b=Vg(m).replace(/  +/g,(function(e){return'<text:s text:c="'+e.length+'"/>'})).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>");if(v.l&&v.l.Target){var w=v.l.Target;"#"==(w="#"==w.charAt(0)?"#"+w.slice(1).replace(/\./,"!"):w).charAt(0)||w.match(/^\w+:/)||(w="../"+w),b=rv("text:a",b,{"xlink:href":w.replace(/&/g,"&amp;")})}i.push("          "+rv("table:table-cell",rv("text:p",b,{}),p)+"\n")}else i.push(e)}}i.push("        </table:table-row>\n")}return i.push("      </table:table>\n"),i.join("")};return function(e,n){var r=[Fg],i=nv({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),a=nv({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==n.bookType?(r.push("<office:document"+i+a+">\n"),r.push(mb().replace(/office:document-meta/g,"office:meta"))):r.push("<office:document-content"+i+">\n"),function(e,t){e.push(" <office:automatic-styles>\n"),e.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),e.push('   <number:month number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push('   <number:day number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push("   <number:year/>\n"),e.push("  </number:date-style>\n");var n=0;t.SheetNames.map((function(e){return t.Sheets[e]})).forEach((function(t){if(t&&t["!cols"])for(var r=0;r<t["!cols"].length;++r)if(t["!cols"][r]){var i=t["!cols"][r];if(null==i.width&&null==i.wpx&&null==i.wch)continue;yw(i),i.ods=n;var a=t["!cols"][r].wpx+"px";e.push('  <style:style style:name="co'+n+'" style:family="table-column">\n'),e.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+a+'"/>\n'),e.push("  </style:style>\n"),++n}}));var r=0;t.SheetNames.map((function(e){return t.Sheets[e]})).forEach((function(t){if(t&&t["!rows"])for(var n=0;n<t["!rows"].length;++n)if(t["!rows"][n]){t["!rows"][n].ods=r;var i=t["!rows"][n].hpx+"px";e.push('  <style:style style:name="ro'+r+'" style:family="table-row">\n'),e.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+i+'"/>\n'),e.push("  </style:style>\n"),++r}})),e.push('  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">\n'),e.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n'),e.push("  </style:style>\n"),e.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),e.push(" </office:automatic-styles>\n")}(r,e),r.push("  <office:body>\n"),r.push("    <office:spreadsheet>\n");for(var s=0;s!=e.SheetNames.length;++s)r.push(t(e.Sheets[e.SheetNames[s]],e,s));return r.push("    </office:spreadsheet>\n"),r.push("  </office:body>\n"),"fods"==n.bookType?r.push("</office:document>"):r.push("</office:document-content>"),r.join("")}}();function VE(e,t){if("fods"==t.bookType)return BE(e,t);var n=Mg(),r="",i=[],a=[];return Lg(n,r="mimetype","application/vnd.oasis.opendocument.spreadsheet"),Lg(n,r="content.xml",BE(e,t)),i.push([r,"text/xml"]),a.push([r,"ContentFile"]),Lg(n,r="styles.xml",jE(e,t)),i.push([r,"text/xml"]),a.push([r,"StylesFile"]),Lg(n,r="meta.xml",Fg+mb()),i.push([r,"text/xml"]),a.push([r,"MetadataFile"]),Lg(n,r="manifest.rdf",function(e){var t,n,r=[Fg];r.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var i=0;i!=e.length;++i)r.push(pb(e[i][0],e[i][1])),r.push((t="",n=e[i][0],['  <rdf:Description rdf:about="'+t+'">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+n+'"/>\n',"  </rdf:Description>\n"].join("")));return r.push(pb("","Document","pkg")),r.push("</rdf:RDF>"),r.join("")}(a)),i.push([r,"application/rdf+xml"]),Lg(n,r="META-INF/manifest.xml",function(e){var t=[Fg];t.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),t.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var n=0;n<e.length;++n)t.push('  <manifest:file-entry manifest:full-path="'+e[n][0]+'" manifest:media-type="'+e[n][1]+'"/>\n');return t.push("</manifest:manifest>"),t.join("")}(i)),n}function $E(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function HE(e){return"undefined"!=typeof TextEncoder?(new TextEncoder).encode(e):fm(Jg(e))}function WE(e){var t=e.reduce((function(e,t){return e+t.length}),0),n=new Uint8Array(t),r=0;return e.forEach((function(e){n.set(e,r),r+=e.length})),n}function GE(e,t){var n=t?t[0]:0,r=127&e[n];e:if(e[n++]>=128){if(r|=(127&e[n])<<7,e[n++]<128)break e;if(r|=(127&e[n])<<14,e[n++]<128)break e;if(r|=(127&e[n])<<21,e[n++]<128)break e;if(r+=(127&e[n])*Math.pow(2,28),++n,e[n++]<128)break e;if(r+=(127&e[n])*Math.pow(2,35),++n,e[n++]<128)break e;if(r+=(127&e[n])*Math.pow(2,42),++n,e[n++]<128)break e}return t&&(t[0]=n),r}function KE(e){var t=new Uint8Array(7);t[0]=127&e;var n=1;e:if(e>127){if(t[n-1]|=128,t[n]=e>>7&127,++n,e<=16383)break e;if(t[n-1]|=128,t[n]=e>>14&127,++n,e<=2097151)break e;if(t[n-1]|=128,t[n]=e>>21&127,++n,e<=268435455)break e;if(t[n-1]|=128,t[n]=e/256>>>21&127,++n,e<=34359738367)break e;if(t[n-1]|=128,t[n]=e/65536>>>21&127,++n,e<=4398046511103)break e;t[n-1]|=128,t[n]=e/16777216>>>21&127,++n}return t.slice(0,n)}function qE(e){var t=0,n=127&e[t];e:if(e[t++]>=128){if(n|=(127&e[t])<<7,e[t++]<128)break e;if(n|=(127&e[t])<<14,e[t++]<128)break e;if(n|=(127&e[t])<<21,e[t++]<128)break e;n|=(127&e[t])<<28}return n}function YE(e){for(var t=[],n=[0];n[0]<e.length;){var r,i=n[0],a=GE(e,n),s=7&a,o=0;if(0==(a=Math.floor(a/8)))break;switch(s){case 0:for(var l=n[0];e[n[0]++]>=128;);r=e.slice(l,n[0]);break;case 5:o=4,r=e.slice(n[0],n[0]+o),n[0]+=o;break;case 1:o=8,r=e.slice(n[0],n[0]+o),n[0]+=o;break;case 2:o=GE(e,n),r=e.slice(n[0],n[0]+o),n[0]+=o;break;default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(i))}var c={data:r,type:s};null==t[a]?t[a]=[c]:t[a].push(c)}return t}function XE(e){var t=[];return e.forEach((function(e,n){e.forEach((function(e){e.data&&(t.push(KE(8*n+e.type)),2==e.type&&t.push(KE(e.data.length)),t.push(e.data))}))})),WE(t)}function QE(e){for(var t,n=[],r=[0];r[0]<e.length;){var i=GE(e,r),a=YE(e.slice(r[0],r[0]+i));r[0]+=i;var s={id:qE(a[1][0].data),messages:[]};a[2].forEach((function(t){var n=YE(t.data),i=qE(n[3][0].data);s.messages.push({meta:n,data:e.slice(r[0],r[0]+i)}),r[0]+=i})),(null==(t=a[3])?void 0:t[0])&&(s.merge=qE(a[3][0].data)>>>0>0),n.push(s)}return n}function JE(e){var t=[];return e.forEach((function(e){var n=[];n[1]=[{data:KE(e.id),type:0}],n[2]=[],null!=e.merge&&(n[3]=[{data:KE(+!!e.merge),type:0}]);var r=[];e.messages.forEach((function(e){r.push(e.data),e.meta[3]=[{type:0,data:KE(e.data.length)}],n[2].push({data:XE(e.meta),type:2})}));var i=XE(n);t.push(KE(i.length)),t.push(i),r.forEach((function(e){return t.push(e)}))})),WE(t)}function ZE(e,t){if(0!=e)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var n=[0],r=GE(t,n),i=[];n[0]<t.length;){var a=3&t[n[0]];if(0!=a){var s=0,o=0;if(1==a?(o=4+(t[n[0]]>>2&7),s=(224&t[n[0]++])<<3,s|=t[n[0]++]):(o=1+(t[n[0]++]>>2),2==a?(s=t[n[0]]|t[n[0]+1]<<8,n[0]+=2):(s=(t[n[0]]|t[n[0]+1]<<8|t[n[0]+2]<<16|t[n[0]+3]<<24)>>>0,n[0]+=4)),i=[WE(i)],0==s)throw new Error("Invalid offset 0");if(s>i[0].length)throw new Error("Invalid offset beyond length");if(o>=s)for(i.push(i[0].slice(-s)),o-=s;o>=i[i.length-1].length;)i.push(i[i.length-1]),o-=i[i.length-1].length;i.push(i[0].slice(-s,-s+o))}else{var l=t[n[0]++]>>2;if(l<60)++l;else{var c=l-59;l=t[n[0]],c>1&&(l|=t[n[0]+1]<<8),c>2&&(l|=t[n[0]+2]<<16),c>3&&(l|=t[n[0]+3]<<24),l>>>=0,l++,n[0]+=c}i.push(t.slice(n[0],n[0]+l)),n[0]+=l}}var u=WE(i);if(u.length!=r)throw new Error("Unexpected length: ".concat(u.length," != ").concat(r));return u}function eS(e){for(var t=[],n=0;n<e.length;){var r=e[n++],i=e[n]|e[n+1]<<8|e[n+2]<<16;n+=3,t.push(ZE(r,e.slice(n,n+i))),n+=i}if(n!==e.length)throw new Error("data is not a valid framed stream!");return WE(t)}function tS(e){for(var t=[],n=0;n<e.length;){var r=Math.min(e.length-n,268435455),i=new Uint8Array(4);t.push(i);var a=KE(r),s=a.length;t.push(a),r<=60?(s++,t.push(new Uint8Array([r-1<<2]))):r<=256?(s+=2,t.push(new Uint8Array([240,r-1&255]))):r<=65536?(s+=3,t.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(s+=4,t.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(s+=5,t.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),t.push(e.slice(n,n+r)),s+=r,i[0]=0,i[1]=255&s,i[2]=s>>8&255,i[3]=s>>16&255,n+=r}return WE(t)}function nS(e,t){var n=new Uint8Array(32),r=$E(n),i=12,a=0;switch(n[0]=5,e.t){case"n":n[1]=2,function(e,t,n){var r=Math.floor(0==n?0:Math.LOG10E*Math.log(Math.abs(n)))+6176-20,i=n/Math.pow(10,r-6176);e[t+15]|=r>>7,e[t+14]|=(127&r)<<1;for(var a=0;i>=1;++a,i/=256)e[t+a]=255&i;e[t+15]|=n>=0?0:128}(n,i,e.v),a|=1,i+=16;break;case"b":n[1]=6,r.setFloat64(i,e.v?1:0,!0),a|=2,i+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));n[1]=3,r.setUint32(i,t.indexOf(e.v),!0),a|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(8,a,!0),n.slice(0,i)}function rS(e,t){var n=new Uint8Array(32),r=$E(n),i=12,a=0;switch(n[0]=3,e.t){case"n":n[2]=2,r.setFloat64(i,e.v,!0),a|=32,i+=8;break;case"b":n[2]=6,r.setFloat64(i,e.v?1:0,!0),a|=32,i+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));n[2]=3,r.setUint32(i,t.indexOf(e.v),!0),a|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(4,a,!0),n.slice(0,i)}function iS(e){return GE(YE(e)[1][0].data)}function aS(e,t,n){var r,i,a,s;if(!(null==(r=e[6])?void 0:r[0])||!(null==(i=e[7])?void 0:i[0]))throw"Mutation only works on post-BNC storages!";if((null==(s=null==(a=e[8])?void 0:a[0])?void 0:s.data)&&qE(e[8][0].data)>0||!1)throw"Math only works with normal offsets";for(var o=0,l=$E(e[7][0].data),c=0,u=[],h=$E(e[4][0].data),f=0,d=[],p=0;p<t.length;++p)if(null!=t[p]){var m,g;switch(l.setUint16(2*p,c,!0),h.setUint16(2*p,f,!0),typeof t[p]){case"string":m=nS({t:"s",v:t[p]},n),g=rS({t:"s",v:t[p]},n);break;case"number":m=nS({t:"n",v:t[p]},n),g=rS({t:"n",v:t[p]},n);break;case"boolean":m=nS({t:"b",v:t[p]},n),g=rS({t:"b",v:t[p]},n);break;default:throw new Error("Unsupported value "+t[p])}u.push(m),c+=m.length,d.push(g),f+=g.length,++o}else l.setUint16(2*p,65535,!0),h.setUint16(2*p,65535);for(e[2][0].data=KE(o);p<e[7][0].data.length/2;++p)l.setUint16(2*p,65535,!0),h.setUint16(2*p,65535,!0);return e[6][0].data=WE(u),e[3][0].data=WE(d),o}function sS(e){return function(t){for(var n=0;n!=e.length;++n){var r=e[n];void 0===t[r[0]]&&(t[r[0]]=r[1]),"n"===r[2]&&(t[r[0]]=Number(t[r[0]]))}}}function oS(e){sS([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function lS(e,t){return"ods"==t.bookType?VE(e,t):"numbers"==t.bookType?function(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var n=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=Ty(n["!ref"]);r.s.r=r.s.c=0;var i=!1;r.e.c>9&&(i=!0,r.e.c=9),r.e.r>49&&(i=!0,r.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(Ey(r)));var a=yS(n,{range:r,header:1}),s=["~Sh33tJ5~"];a.forEach((function(e){return e.forEach((function(e){"string"==typeof e&&s.push(e)}))}));var o={},l=[],c=hg.read(t.numbers,{type:"base64"});c.FileIndex.map((function(e,t){return[e,c.FullPaths[t]]})).forEach((function(e){var t=e[0],n=e[1];2==t.type&&t.name.match(/\.iwa/)&&QE(eS(t.content)).forEach((function(e){l.push(e.id),o[e.id]={deps:[],location:n,type:qE(e.messages[0].meta[1][0].data)}}))})),l.sort((function(e,t){return e-t}));var u=l.filter((function(e){return e>1})).map((function(e){return[e,KE(e)]}));c.FileIndex.map((function(e,t){return[e,c.FullPaths[t]]})).forEach((function(e){var t=e[0];e[1],t.name.match(/\.iwa/)&&QE(eS(t.content)).forEach((function(e){e.messages.forEach((function(t){u.forEach((function(t){e.messages.some((function(e){return 11006!=qE(e.meta[1][0].data)&&function(e,t){e:for(var n=0;n<=e.length-t.length;++n){for(var r=0;r<t.length;++r)if(e[n+r]!=t[r])continue e;return!0}return!1}(e.data,t[1])}))&&o[t[0]].deps.push(e.id)}))}))}))}));for(var h,f=hg.find(c,o[1].location),d=QE(eS(f.content)),p=0;p<d.length;++p){var m=d[p];1==m.id&&(h=m)}var g=iS(YE(h.messages[0].data)[1][0].data);for(d=QE(eS((f=hg.find(c,o[g].location)).content)),p=0;p<d.length;++p)(m=d[p]).id==g&&(h=m);for(g=iS(YE(h.messages[0].data)[2][0].data),d=QE(eS((f=hg.find(c,o[g].location)).content)),p=0;p<d.length;++p)(m=d[p]).id==g&&(h=m);for(g=iS(YE(h.messages[0].data)[2][0].data),d=QE(eS((f=hg.find(c,o[g].location)).content)),p=0;p<d.length;++p)(m=d[p]).id==g&&(h=m);var v=YE(h.messages[0].data);v[6][0].data=KE(r.e.r+1),v[7][0].data=KE(r.e.c+1);for(var y=iS(v[46][0].data),b=hg.find(c,o[y].location),w=QE(eS(b.content)),T=0;T<w.length&&w[T].id!=y;++T);if(w[T].id!=y)throw"Bad ColumnRowUIDMapArchive";var E=YE(w[T].messages[0].data);E[1]=[],E[2]=[],E[3]=[];for(var S=0;S<=r.e.c;++S){var x=[];x[1]=x[2]=[{type:0,data:KE(S+420690)}],E[1].push({type:2,data:XE(x)}),E[2].push({type:0,data:KE(S)}),E[3].push({type:0,data:KE(S)})}E[4]=[],E[5]=[],E[6]=[];for(var k=0;k<=r.e.r;++k)(x=[])[1]=x[2]=[{type:0,data:KE(k+726270)}],E[4].push({type:2,data:XE(x)}),E[5].push({type:0,data:KE(k)}),E[6].push({type:0,data:KE(k)});w[T].messages[0].data=XE(E),b.content=tS(JE(w)),b.size=b.content.length,delete v[46];var _=YE(v[4][0].data);_[7][0].data=KE(r.e.r+1);var C=iS(YE(_[1][0].data)[2][0].data);if((w=QE(eS((b=hg.find(c,o[C].location)).content)))[0].id!=C)throw"Bad HeaderStorageBucket";var A=YE(w[0].messages[0].data);for(k=0;k<a.length;++k){var I=YE(A[2][0].data);I[1][0].data=KE(k),I[4][0].data=KE(a[k].length),A[2][k]={type:A[2][0].type,data:XE(I)}}w[0].messages[0].data=XE(A),b.content=tS(JE(w)),b.size=b.content.length;var N=iS(_[2][0].data);if((w=QE(eS((b=hg.find(c,o[N].location)).content)))[0].id!=N)throw"Bad HeaderStorageBucket";for(A=YE(w[0].messages[0].data),S=0;S<=r.e.c;++S)(I=YE(A[2][0].data))[1][0].data=KE(S),I[4][0].data=KE(r.e.r+1),A[2][S]={type:A[2][0].type,data:XE(I)};w[0].messages[0].data=XE(A),b.content=tS(JE(w)),b.size=b.content.length;var D=iS(_[4][0].data);!function(){for(var e,t=hg.find(c,o[D].location),n=QE(eS(t.content)),r=0;r<n.length;++r){var i=n[r];i.id==D&&(e=i)}var a=YE(e.messages[0].data);a[3]=[];var l=[];s.forEach((function(e,t){l[1]=[{type:0,data:KE(t)}],l[2]=[{type:0,data:KE(1)}],l[3]=[{type:2,data:HE(e)}],a[3].push({type:2,data:XE(l)})})),e.messages[0].data=XE(a);var u=tS(JE(n));t.content=u,t.size=t.content.length}();var O=YE(_[3][0].data),R=O[1][0];delete O[2];var P=YE(R.data),L=iS(P[2][0].data);!function(){for(var e,t=hg.find(c,o[L].location),n=QE(eS(t.content)),i=0;i<n.length;++i){var l=n[i];l.id==L&&(e=l)}var u=YE(e.messages[0].data);delete u[6],delete O[7];var h=new Uint8Array(u[5][0].data);u[5]=[];for(var f=0,d=0;d<=r.e.r;++d){var p=YE(h);f+=aS(p,a[d],s),p[1][0].data=KE(d),u[5].push({data:XE(p),type:2})}u[1]=[{type:0,data:KE(r.e.c+1)}],u[2]=[{type:0,data:KE(r.e.r+1)}],u[3]=[{type:0,data:KE(f)}],u[4]=[{type:0,data:KE(r.e.r+1)}],e.messages[0].data=XE(u);var m=tS(JE(n));t.content=m,t.size=t.content.length}(),R.data=XE(P),_[3][0].data=XE(O),v[4][0].data=XE(_),h.messages[0].data=XE(v);var M=tS(JE(d));return f.content=M,f.size=f.content.length,c}(e,t):"xlsb"==t.bookType?function(e,t){Uw=1024,e&&!e.SSF&&(e.SSF=Ng(Cm));e&&e.SSF&&(lg(),og(e.SSF),t.revssf=yg(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF);t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,DT?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n="xlsb"==t.bookType?"bin":"xml",r=Ww.indexOf(t.bookType)>-1,i={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};oS(t=t||{});var a=Mg(),s="",o=0;t.cellXfs=[],LT(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});if(Lg(a,s="docProps/core.xml",yb(e.Props,t)),i.coreprops.push(s),db(t.rels,2,s,ub.CORE_PROPS),s="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,Lg(a,s,Tb(e.Props)),i.extprops.push(s),db(t.rels,3,s,ub.EXT_PROPS),e.Custprops!==e.Props&&mg(e.Custprops||{}).length>0&&(Lg(a,s="docProps/custom.xml",Eb(e.Custprops)),i.custprops.push(s),db(t.rels,4,s,ub.CUST_PROPS));for(o=1;o<=e.SheetNames.length;++o){var u={"!id":{}},h=e.Sheets[e.SheetNames[o-1]];(h||{})["!type"];if(Lg(a,s="xl/worksheets/sheet"+o+"."+n,cE(o-1,s,t,e,u)),i.sheets.push(s),db(t.wbrels,-1,"worksheets/sheet"+o+"."+n,ub.WS[0]),h){var f=h["!comments"],d=!1,p="";f&&f.length>0&&(Lg(a,p="xl/comments"+o+"."+n,uE(f,p,t)),i.comments.push(p),db(u,-1,"../comments"+o+"."+n,ub.CMNT),d=!0),h["!legacy"]&&d&&Lg(a,"xl/drawings/vmlDrawing"+o+".vml",jw(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}u["!id"].rId1&&Lg(a,hb(s),fb(u))}null!=t.Strings&&t.Strings.length>0&&(Lg(a,s="xl/sharedStrings."+n,function(e,t,n){return(".bin"===t.slice(-4)?cw:ow)(e,n)}(t.Strings,s,t)),i.strs.push(s),db(t.wbrels,-1,"sharedStrings."+n,ub.SST));Lg(a,s="xl/workbook."+n,function(e,t,n){return(".bin"===t.slice(-4)?lE:sE)(e,n)}(e,s,t)),i.workbooks.push(s),db(t.rels,1,s,ub.WB),Lg(a,s="xl/theme/theme1.xml",Mw(e.Themes,t)),i.themes.push(s),db(t.wbrels,-1,"theme/theme1.xml",ub.THEME),Lg(a,s="xl/styles."+n,function(e,t,n){return(".bin"===t.slice(-4)?Lw:Ew)(e,n)}(e,s,t)),i.styles.push(s),db(t.wbrels,-1,"styles."+n,ub.STY),e.vbaraw&&r&&(Lg(a,s="xl/vbaProject.bin",e.vbaraw),i.vba.push(s),db(t.wbrels,-1,"vbaProject.bin",ub.VBA));return Lg(a,s="xl/metadata."+n,function(e){return(".bin"===e.slice(-4)?Fw:zw)()}(s)),i.metadata.push(s),db(t.wbrels,-1,"metadata."+n,ub.XLMETA),Lg(a,"[Content_Types].xml",cb(i,t)),Lg(a,"_rels/.rels",fb(t.rels)),Lg(a,"xl/_rels/workbook."+n+".rels",fb(t.wbrels)),delete t.revssf,delete t.ssf,a}(e,t):cS(e,t)}function cS(e,t){Uw=1024,e&&!e.SSF&&(e.SSF=Ng(Cm)),e&&e.SSF&&(lg(),og(e.SSF),t.revssf=yg(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,DT?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n="xml",r=Ww.indexOf(t.bookType)>-1,i={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};oS(t=t||{});var a=Mg(),s="",o=0;if(t.cellXfs=[],LT(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),Lg(a,s="docProps/core.xml",yb(e.Props,t)),i.coreprops.push(s),db(t.rels,2,s,ub.CORE_PROPS),s="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,Lg(a,s,Tb(e.Props)),i.extprops.push(s),db(t.rels,3,s,ub.EXT_PROPS),e.Custprops!==e.Props&&mg(e.Custprops||{}).length>0&&(Lg(a,s="docProps/custom.xml",Eb(e.Custprops)),i.custprops.push(s),db(t.rels,4,s,ub.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var h={"!id":{}},f=e.Sheets[e.SheetNames[o-1]];(f||{})["!type"];if(Lg(a,s="xl/worksheets/sheet"+o+"."+n,jT(o-1,t,e,h)),i.sheets.push(s),db(t.wbrels,-1,"worksheets/sheet"+o+"."+n,ub.WS[0]),f){var d=f["!comments"],p=!1,m="";if(d&&d.length>0){var g=!1;d.forEach((function(e){e[1].forEach((function(e){1==e.T&&(g=!0)}))})),g&&(Lg(a,m="xl/threadedComments/threadedComment"+o+"."+n,Vw(d,u,t)),i.threadedcomments.push(m),db(h,-1,"../threadedComments/threadedComment"+o+"."+n,ub.TCMNT)),Lg(a,m="xl/comments"+o+"."+n,Bw(d)),i.comments.push(m),db(h,-1,"../comments"+o+"."+n,ub.CMNT),p=!0}f["!legacy"]&&p&&Lg(a,"xl/drawings/vmlDrawing"+o+".vml",jw(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}h["!id"].rId1&&Lg(a,hb(s),fb(h))}return null!=t.Strings&&t.Strings.length>0&&(Lg(a,s="xl/sharedStrings."+n,ow(t.Strings,t)),i.strs.push(s),db(t.wbrels,-1,"sharedStrings."+n,ub.SST)),Lg(a,s="xl/workbook."+n,sE(e)),i.workbooks.push(s),db(t.rels,1,s,ub.WB),Lg(a,s="xl/theme/theme1.xml",Mw(e.Themes,t)),i.themes.push(s),db(t.wbrels,-1,"theme/theme1.xml",ub.THEME),Lg(a,s="xl/styles."+n,Ew(e,t)),i.styles.push(s),db(t.wbrels,-1,"styles."+n,ub.STY),e.vbaraw&&r&&(Lg(a,s="xl/vbaProject.bin",e.vbaraw),i.vba.push(s),db(t.wbrels,-1,"vbaProject.bin",ub.VBA)),Lg(a,s="xl/metadata."+n,zw()),i.metadata.push(s),db(t.wbrels,-1,"metadata."+n,ub.XLMETA),u.length>1&&(Lg(a,s="xl/persons/person.xml",function(e){var t=[Fg,rv("personList",null,{xmlns:uv,"xmlns:x":yv[0]}).replace(/[\/]>/,">")];return e.forEach((function(e,n){t.push(rv("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:e,providerId:"None"}))})),t.push("</personList>"),t.join("")}(u)),i.people.push(s),db(t.wbrels,-1,"persons/person.xml",ub.PEOPLE)),Lg(a,"[Content_Types].xml",cb(i,t)),Lg(a,"_rels/.rels",fb(t.rels)),Lg(a,"xl/_rels/workbook.xml.rels",fb(t.wbrels)),delete t.revssf,delete t.ssf,a}function uS(e,t){var n="";switch((t||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":n=om(e.slice(0,12));break;case"binary":n=e;break;default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function hS(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return pg(t.file,hg.write(e,{type:lm?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return hg.write(e,t)}function fS(e,t){var n={},r=lm?"nodebuffer":"undefined"!==typeof Uint8Array?"array":"string";if(t.compression&&(n.compression="DEFLATE"),t.password)n.type=r;else switch(t.type){case"base64":n.type="base64";break;case"binary":n.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":n.type=r;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?hg.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[n.type]||n.type,compression:!!t.compression}):e.generate(n);if("undefined"!==typeof Deno&&"string"==typeof i){if("binary"==t.type||"base64"==t.type)return i;i=new Uint8Array(dm(i))}return t.password&&"undefined"!==typeof encrypt_agile?hS(encrypt_agile(i,t.password),t):"file"===t.type?pg(t.file,i):"string"==t.type?Qg(i):i}function dS(e,t,n){n||(n="");var r=n+e;switch(t.type){case"base64":return sm(Jg(r));case"binary":return Jg(r);case"string":return e;case"file":return pg(t.file,r,"utf8");case"buffer":return lm?cm(r,"utf8"):"undefined"!==typeof TextEncoder?(new TextEncoder).encode(r):dS(r,{type:"binary"}).split("").map((function(e){return e.charCodeAt(0)}))}throw new Error("Unrecognized type "+t.type)}function pS(e,t){switch(t.type){case"string":case"base64":case"binary":for(var n="",r=0;r<e.length;++r)n+=String.fromCharCode(e[r]);return"base64"==t.type?sm(n):"string"==t.type?Qg(n):n;case"file":return pg(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function mS(e,t){em(),aE(e);var n=Ng(t||{});if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),"array"==n.type){n.type="binary";var r=mS(e,n);return n.type="array",dm(r)}var i=0;if(n.sheet&&(i="number"==typeof n.sheet?n.sheet:e.SheetNames.indexOf(n.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+n.sheet+" : "+typeof n.sheet);switch(n.bookType||"xlsb"){case"xml":case"xlml":return dS(gE(e,n),n);case"slk":case"sylk":return dS(tw.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"htm":case"html":return dS(ME(e.Sheets[e.SheetNames[i]],n),n);case"txt":return function(e,t){switch(t.type){case"base64":return sm(e);case"binary":case"string":return e;case"file":return pg(t.file,e,"binary");case"buffer":return lm?cm(e,"binary"):e.split("").map((function(e){return e.charCodeAt(0)}))}throw new Error("Unrecognized type "+t.type)}(ES(e.Sheets[e.SheetNames[i]],n),n);case"csv":return dS(TS(e.Sheets[e.SheetNames[i]],n),n,"\ufeff");case"dif":return dS(nw.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"dbf":return pS(ew.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"prn":return dS(iw.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"rtf":return dS(fw.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"eth":return dS(rw.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"fods":return dS(VE(e,n),n);case"wk1":return pS(aw.sheet_to_wk1(e.Sheets[e.SheetNames[i]],n),n);case"wk3":return pS(aw.book_to_wk3(e,n),n);case"biff2":n.biff||(n.biff=2);case"biff3":n.biff||(n.biff=3);case"biff4":return n.biff||(n.biff=4),pS(DE(e,n),n);case"biff5":n.biff||(n.biff=5);case"biff8":case"xla":case"xls":return n.biff||(n.biff=8),function(e,t){var n=t||{};return hS(wE(e,n),n)}(e,n);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return function(e,t){var n=Ng(t||{});return fS(lS(e,n),n)}(e,n);default:throw new Error("Unrecognized bookType |"+n.bookType+"|")}}function gS(e){if(!e.bookType){var t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[e.bookType]||e.bookType}}function vS(e,t,n,r,i,a,s,o){var l=gy(n),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,f=1===i?[]:{};if(1!==i)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:n,enumerable:!1})}catch(g){f.__rowNum__=n}else f.__rowNum__=n;if(!s||e[n])for(var d=t.s.c;d<=t.e.c;++d){var p=s?e[n][d]:e[r[d]+l];if(void 0!==p&&void 0!==p.t){var m=p.v;switch(p.t){case"z":if(null==m)break;continue;case"e":m=0==m?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(null!=a[d]){if(null==m)if("e"==p.t&&null===m)f[a[d]]=null;else if(void 0!==c)f[a[d]]=c;else{if(!u||null!==m)continue;f[a[d]]=null}else f[a[d]]=u&&("n"!==p.t||"n"===p.t&&!1!==o.rawNumbers)?m:ky(p,m,o);null!=m&&(h=!1)}}else{if(void 0===c)continue;null!=a[d]&&(f[a[d]]=c)}}return{row:f,isempty:h}}function yS(e,t){if(null==e||null==e["!ref"])return[];var n={t:"n",v:0},r=0,i=1,a=[],s=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=null!=c.range?c.range:e["!ref"];switch(1===c.header?r=1:"A"===c.header?r=2:Array.isArray(c.header)?r=3:null==c.header&&(r=0),typeof u){case"string":l=Sy(u);break;case"number":(l=Sy(e["!ref"])).s.r=u;break;default:l=u}r>0&&(i=0);var h=gy(l.s.r),f=[],d=[],p=0,m=0,g=Array.isArray(e),v=l.s.r,y=0,b={};g&&!e[v]&&(e[v]=[]);var w=c.skipHidden&&e["!cols"]||[],T=c.skipHidden&&e["!rows"]||[];for(y=l.s.c;y<=l.e.c;++y)if(!(w[y]||{}).hidden)switch(f[y]=yy(y),n=g?e[v][y]:e[f[y]+h],r){case 1:a[y]=y-l.s.c;break;case 2:a[y]=f[y];break;case 3:a[y]=c.header[y-l.s.c];break;default:if(null==n&&(n={w:"__EMPTY",t:"s"}),o=s=ky(n,null,c),m=b[s]||0){do{o=s+"_"+m++}while(b[o]);b[s]=m,b[o]=1}else b[s]=1;a[y]=o}for(v=l.s.r+i;v<=l.e.r;++v)if(!(T[v]||{}).hidden){var E=vS(e,l,v,f,r,a,g,c);(!1===E.isempty||(1===r?!1!==c.blankrows:c.blankrows))&&(d[p++]=E.row)}return d.length=p,d}var bS=/"/g;function wS(e,t,n,r,i,a,s,o){for(var l=!0,c=[],u="",h=gy(n),f=t.s.c;f<=t.e.c;++f)if(r[f]){var d=o.dense?(e[n]||[])[f]:e[r[f]+h];if(null==d)u="";else if(null!=d.v){l=!1,u=""+(o.rawNumbers&&"n"==d.t?d.v:ky(d,null,o));for(var p=0,m=0;p!==u.length;++p)if((m=u.charCodeAt(p))===i||m===a||34===m||o.forceQuotes){u='"'+u.replace(bS,'""')+'"';break}"ID"==u&&(u='"ID"')}else null==d.f||d.F?u="":(l=!1,(u="="+d.f).indexOf(",")>=0&&(u='"'+u.replace(bS,'""')+'"'));c.push(u)}return!1===o.blankrows&&l?null:c.join(s)}function TS(e,t){var n=[],r=null==t?{}:t;if(null==e||null==e["!ref"])return"";var i=Sy(e["!ref"]),a=void 0!==r.FS?r.FS:",",s=a.charCodeAt(0),o=void 0!==r.RS?r.RS:"\n",l=o.charCodeAt(0),c=new RegExp(("|"==a?"\\|":a)+"+$"),u="",h=[];r.dense=Array.isArray(e);for(var f=r.skipHidden&&e["!cols"]||[],d=r.skipHidden&&e["!rows"]||[],p=i.s.c;p<=i.e.c;++p)(f[p]||{}).hidden||(h[p]=yy(p));for(var m=0,g=i.s.r;g<=i.e.r;++g)(d[g]||{}).hidden||null!=(u=wS(e,i,g,h,s,l,a,r))&&(r.strip&&(u=u.replace(c,"")),(u||!1!==r.blankrows)&&n.push((m++?o:"")+u));return delete r.dense,n.join("")}function ES(e,t){t||(t={}),t.FS="\t",t.RS="\n";var n=TS(e,t);if("undefined"==typeof nm||"string"==t.type)return n;var r=nm.utils.encode(1200,n,"str");return String.fromCharCode(255)+String.fromCharCode(254)+r}function SS(e,t,n){var r,i=n||{},a=+!i.skipHeader,s=e||{},o=0,l=0;if(s&&null!=i.origin)if("number"==typeof i.origin)o=i.origin;else{var c="string"==typeof i.origin?by(i.origin):i.origin;o=c.r,l=c.c}var u={s:{c:0,r:0},e:{c:l,r:o+t.length-1+a}};if(s["!ref"]){var h=Sy(s["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),-1==o&&(o=h.e.r+1,u.e.r=o+t.length-1+a)}else-1==o&&(o=0,u.e.r=t.length-1+a);var f=i.header||[],d=0;t.forEach((function(e,t){mg(e).forEach((function(n){-1==(d=f.indexOf(n))&&(f[d=f.length]=n);var c=e[n],u="z",h="",p=wy({c:l+d,r:o+t+a});r=xS(s,p),!c||"object"!==typeof c||c instanceof Date?("number"==typeof c?u="n":"boolean"==typeof c?u="b":"string"==typeof c?u="s":c instanceof Date?(u="d",i.cellDates||(u="n",c=wg(c)),h=i.dateNF||Cm[14]):null===c&&i.nullError&&(u="e",c=0),r?(r.t=u,r.v=c,delete r.w,delete r.R,h&&(r.z=h)):s[p]=r={t:u,v:c},h&&(r.z=h)):s[p]=c}))})),u.e.c=Math.max(u.e.c,l+f.length-1);var p=gy(o);if(a)for(d=0;d<f.length;++d)s[yy(d+l)+p]={t:"s",v:f[d]};return s["!ref"]=Ey(u),s}function xS(e,t,n){if("string"==typeof t){if(Array.isArray(e)){var r=by(t);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return xS(e,wy("number"!=typeof t?t:{r:t,c:n||0}))}function kS(){return{SheetNames:[],Sheets:{}}}function _S(e,t,n,r){var i=1;if(!n)for(;i<=65535&&-1!=e.SheetNames.indexOf(n="Sheet"+i);++i,n=void 0);if(!n||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(n)>=0){var a=n.match(/(^.*?)(\d+)$/);i=a&&+a[2]||0;var s=a&&a[1]||n;for(++i;i<=65535&&-1!=e.SheetNames.indexOf(n=s+i);++i);}if(iE(n),e.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return e.SheetNames.push(n),e.Sheets[n]=t,n}function CS(e,t,n){return t?(e.l={Target:t},n&&(e.l.Tooltip=n)):delete e.l,e}var AS={encode_col:yy,encode_row:gy,encode_cell:wy,encode_range:Ey,decode_col:vy,decode_row:my,split_cell:function(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:by,decode_range:Ty,format_cell:ky,sheet_add_aoa:Cy,sheet_add_json:SS,sheet_add_dom:FE,aoa_to_sheet:Ay,json_to_sheet:function(e,t){return SS(null,e,t)},table_to_sheet:zE,table_to_book:function(e,t){return _y(zE(e,t),t)},sheet_to_csv:TS,sheet_to_txt:ES,sheet_to_json:yS,sheet_to_html:ME,sheet_to_formulae:function(e){var t,n="",r="";if(null==e||null==e["!ref"])return[];var i,a=Sy(e["!ref"]),s="",o=[],l=[],c=Array.isArray(e);for(i=a.s.c;i<=a.e.c;++i)o[i]=yy(i);for(var u=a.s.r;u<=a.e.r;++u)for(s=gy(u),i=a.s.c;i<=a.e.c;++i)if(n=o[i]+s,r="",void 0!==(t=c?(e[u]||[])[i]:e[n])){if(null!=t.F){if(n=t.F,!t.f)continue;r=t.f,-1==n.indexOf(":")&&(n=n+":"+n)}if(null!=t.f)r=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)r=""+t.v;else if("b"==t.t)r=t.v?"TRUE":"FALSE";else if(void 0!==t.w)r="'"+t.w;else{if(void 0===t.v)continue;r="s"==t.t?"'"+t.v:""+t.v}}l[l.length]=n+"="+r}return l},sheet_to_row_object_array:yS,sheet_get_cell:xS,book_new:kS,book_append_sheet:_S,book_set_sheet_visibility:function(e,t,n){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=function(e,t){if("number"==typeof t){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"==typeof t){var n=e.SheetNames.indexOf(t);if(n>-1)return n;throw new Error("Cannot find sheet name |"+t+"|")}throw new Error("Cannot find sheet |"+t+"|")}(e,t);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}e.Workbook.Sheets[r].Hidden=n},cell_set_number_format:function(e,t){return e.z=t,e},cell_set_hyperlink:CS,cell_set_internal_link:function(e,t,n){return CS(e,"#"+t,n)},cell_add_comment:function(e,t,n){e.c||(e.c=[]),e.c.push({t:t,a:n||"SheetJS"})},sheet_set_array_formula:function(e,t,n,r){for(var i="string"!=typeof t?t:Sy(t),a="string"==typeof t?t:Ey(t),s=i.s.r;s<=i.e.r;++s)for(var o=i.s.c;o<=i.e.c;++o){var l=xS(e,s,o);l.t="n",l.F=a,delete l.v,s==i.s.r&&o==i.s.c&&(l.f=n,r&&(l.D=!0))}return e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};Kp.version;var IS=n(579);const NS=e=>{let{assignments:t}=e;if(!t.length)return(0,IS.jsxs)("div",{style:{textAlign:"center",padding:"40px 20px",backgroundColor:"#f5f7fa",borderRadius:"8px",color:"#5c6c7c"},children:[(0,IS.jsx)("div",{style:{fontSize:"36px",marginBottom:"15px"},children:"\ud83d\udccb"}),(0,IS.jsx)("div",{style:{fontSize:"18px",fontWeight:"bold",marginBottom:"10px"},children:"No hay asignaciones realizadas"}),(0,IS.jsx)("div",{style:{fontSize:"14px"},children:"Las asignaciones aparecer\xe1n aqu\xed una vez procesadas las solicitudes"})]});const n=t.reduce(((e,t)=>(e[t.order]||(e[t.order]=[]),e[t.order].push(t),e)),{}),r=Object.keys(n).map(Number).sort(((e,t)=>e-t)),i={container:{position:"relative"},infoContainer:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px",flexWrap:"wrap",gap:"15px"},statsContainer:{display:"flex",gap:"15px",flexWrap:"wrap"},statCard:{backgroundColor:"white",padding:"12px 18px",borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.05)",border:"1px solid #eaeaea",minWidth:"120px",display:"flex",alignItems:"center",gap:"10px"},statIcon:{backgroundColor:"#e6f7ff",borderRadius:"50%",width:"40px",height:"40px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"18px",color:"#1890ff"},statContent:{flex:1},statValue:{fontSize:"18px",fontWeight:"bold",color:"#2c3e50"},statLabel:{fontSize:"12px",color:"#95a5a6"},exportButton:{padding:"10px 18px",backgroundImage:"linear-gradient(to right, #3498db, #2980b9)",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",transition:"all 0.2s ease",fontSize:"14px",fontWeight:"500"},infoBox:{padding:"12px 15px",backgroundColor:"#f8f9fa",borderRadius:"6px",marginBottom:"20px",borderLeft:"4px solid #3498db",fontSize:"14px",color:"#2c3e50",lineHeight:"1.5"},tableContainer:{overflowX:"auto",paddingBottom:"5px",border:"1px solid #eaeaea",borderRadius:"8px"},table:{width:"100%",borderCollapse:"collapse"},tableHeader:{backgroundImage:"linear-gradient(to right, #f8f9fa, #e9ecef)",position:"sticky",top:0,zIndex:10},th:{textAlign:"left",padding:"14px 16px",fontSize:"14px",fontWeight:"600",color:"#495057",borderBottom:"2px solid #dee2e6"},tr:{transition:"background-color 0.2s ease"},td:{padding:"14px 16px",borderBottom:"1px solid #e9ecef",fontSize:"14px",verticalAlign:"middle"},priorityBadge:{display:"inline-block",padding:"3px 8px",backgroundColor:"#fff3cd",color:"#856404",borderRadius:"30px",fontSize:"11px",fontWeight:"600",marginLeft:"8px"},centerName:{fontWeight:"600",color:"#2c3e50"},timestamp:{color:"#7f8c8d",fontSize:"13px"}};return(0,IS.jsxs)("div",{style:i.container,children:[(0,IS.jsxs)("div",{style:i.infoContainer,children:[(0,IS.jsxs)("div",{style:i.statsContainer,children:[(0,IS.jsxs)("div",{style:i.statCard,children:[(0,IS.jsx)("div",{style:i.statIcon,children:"\ud83d\udc65"}),(0,IS.jsxs)("div",{style:i.statContent,children:[(0,IS.jsx)("div",{style:i.statValue,children:r.length}),(0,IS.jsx)("div",{style:i.statLabel,children:"Personas asignadas"})]})]}),(0,IS.jsxs)("div",{style:i.statCard,children:[(0,IS.jsx)("div",{style:i.statIcon,children:"\ud83c\udfe2"}),(0,IS.jsxs)("div",{style:i.statContent,children:[(0,IS.jsx)("div",{style:i.statValue,children:new Set(t.map((e=>e.id))).size}),(0,IS.jsx)("div",{style:i.statLabel,children:"Centros con asignaciones"})]})]})]}),(0,IS.jsxs)("button",{onClick:()=>{const e=AS.book_new(),t=[];r.forEach((e=>{n[e].forEach((e=>{t.push({"N\xfamero de Orden":e.order,Localidad:e.localidad,"Centro de Trabajo":e.centro,Municipio:e.municipio})}))}));const i=AS.json_to_sheet(t);AS.book_append_sheet(e,i,"Asignaciones"),function(e,t,n){var r=n||{};r.type="file",r.file=t,gS(r),mS(e,r)}(e,"asignaciones_plazas.xlsx")},style:i.exportButton,children:[(0,IS.jsx)("span",{style:{marginRight:"6px"},children:"\ud83d\udcca"}),"Exportar a Excel"]})]}),(0,IS.jsxs)("div",{style:i.infoBox,children:[(0,IS.jsx)("strong",{children:"Informaci\xf3n importante:"})," Las plazas han sido asignadas por n\xfamero de orden (a menor n\xfamero, mayor prioridad) y respetando el orden de preferencia de centros indicado por cada solicitante."]}),(0,IS.jsx)("div",{style:i.tableContainer,children:(0,IS.jsxs)("table",{style:i.table,children:[(0,IS.jsx)("thead",{style:i.tableHeader,children:(0,IS.jsxs)("tr",{children:[(0,IS.jsx)("th",{style:{...i.th,width:"12%"},children:"N\xba Orden"}),(0,IS.jsx)("th",{style:{...i.th,width:"33%"},children:"Centro de Trabajo"}),(0,IS.jsx)("th",{style:{...i.th,width:"20%"},children:"Localidad"}),(0,IS.jsx)("th",{style:{...i.th,width:"20%"},children:"Municipio"}),(0,IS.jsx)("th",{style:{...i.th,width:"15%"},children:"Fecha/Hora"})]})}),(0,IS.jsx)("tbody",{children:r.map((e=>n[e].map(((t,n)=>{const r=new Date(t.timestamp),a=`${r.toLocaleDateString()} ${r.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`,s=e<=50;return(0,IS.jsxs)("tr",{style:{...i.tr,backgroundColor:s?"#fff9e6":n%2===0?"white":"#f8f9fa"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor=s?"#fff3cd":"#f1f3f5"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor=s?"#fff9e6":n%2===0?"white":"#f8f9fa"},children:[(0,IS.jsxs)("td",{style:i.td,children:[(0,IS.jsx)("span",{style:{fontWeight:s?"bold":"normal"},children:e}),s&&(0,IS.jsx)("span",{style:i.priorityBadge,children:"Alta prioridad"})]}),(0,IS.jsx)("td",{style:i.td,children:(0,IS.jsx)("div",{style:i.centerName,children:t.centro})}),(0,IS.jsx)("td",{style:i.td,children:t.localidad}),(0,IS.jsx)("td",{style:i.td,children:t.municipio}),(0,IS.jsx)("td",{style:i.td,children:(0,IS.jsx)("div",{style:i.timestamp,children:a})})]},`${e}-${n}`)}))))})]})})]})},DS=e=>{let{availablePlazas:t,assignments:n,searchTerm:i,setSearchTerm:a,orderNumber:s,setOrderNumber:o,centrosSeleccionados:l,setCentrosSeleccionados:c,handleOrderSubmit:u,isProcessing:h}=e;const[f,d]=(0,r.useState)(1),[p,m]=(0,r.useState)(10),[g,v]=(0,r.useState)("undefined"!==typeof window?window.innerWidth:1200),[y,b]=(0,r.useState)(null),[w,T]=(0,r.useState)(""),[E,S]=(0,r.useState)(""),[x,k]=(0,r.useState)("");(0,r.useEffect)((()=>{const e=()=>{v(window.innerWidth)};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]);const _=g<768,C=e=>{const n=new Set;return t.forEach((t=>{t[e]&&n.add(t[e])})),Array.from(n).sort()},A=C("asi"),I=C("departamento"),N=C("municipio"),D=[...t.filter((e=>{if(i){var t,n,r,a,s,o;const l=i.toLowerCase();if(!((null===(t=e.centro)||void 0===t?void 0:t.toLowerCase().includes(l))||(null===(n=e.localidad)||void 0===n?void 0:n.toLowerCase().includes(l))||(null===(r=e.municipio)||void 0===r?void 0:r.toLowerCase().includes(l))||(null===(a=e.codigo)||void 0===a?void 0:a.toLowerCase().includes(l))||(null===(s=e.asi)||void 0===s?void 0:s.toLowerCase().includes(l))||(null===(o=e.departamento)||void 0===o?void 0:o.toLowerCase().includes(l))))return!1}return(!w||e.asi===w)&&(!E||e.departamento===E)&&(!x||e.municipio===x)}))].sort(((e,t)=>{var n;const r=e.plazas-(e.asignadas||0),i=t.plazas-(t.asignadas||0);return 0===i&&r>0?-1:0===r&&i>0?1:r!==i?i-r:(null===(n=e.centro)||void 0===n?void 0:n.localeCompare(t.centro||""))||0})),O=Math.ceil(D.length/p),R=f*p,P=R-p,L=D.slice(P,R),M=t.reduce(((e,t)=>e+(t.plazas||0)),0),F=(t.reduce(((e,t)=>e+(t.asignadas||0)),0),()=>{b(null)}),z=e=>{const t=Number(e.target.value);if(e.target.checked)l.includes(t)||c([...l,t]);else{const e=l.filter((e=>e!==t));c(e)}};return(0,IS.jsxs)("div",{className:"plazas-container",children:[(0,IS.jsx)("h2",{children:"Plazas Disponibles"}),(0,IS.jsxs)("div",{style:{marginBottom:"25px",padding:"20px",backgroundColor:"#f8f9fa",borderRadius:"8px",border:"1px solid #e9ecef",boxShadow:"0 2px 8px rgba(0,0,0,0.05)"},children:[(0,IS.jsx)("h3",{style:{fontSize:"18px",color:"#343a40",marginTop:0,marginBottom:"15px",borderBottom:"2px solid #e9ecef",paddingBottom:"10px"},children:"Solicitar una plaza"}),(0,IS.jsxs)("form",{onSubmit:u,children:[(0,IS.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,IS.jsx)("label",{htmlFor:"orderNumber",style:{display:"block",marginBottom:"8px",fontWeight:"bold",color:"#495057"},children:"N\xfamero de Orden:"}),(0,IS.jsx)("input",{type:"number",id:"orderNumber",value:s,onChange:e=>o(e.target.value),style:{width:"100%",padding:"12px 15px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"16px",boxShadow:"inset 0 1px 3px rgba(0,0,0,0.05)"},required:!0,placeholder:"Introduce tu n\xfamero de orden"})]}),(0,IS.jsxs)("div",{style:{padding:"10px 15px",backgroundColor:"#e9f5fe",borderRadius:"6px",marginBottom:"20px",fontSize:"14px",borderLeft:"4px solid #3498db"},children:[(0,IS.jsx)("strong",{children:"Importante:"})," Selecciona tus centros por orden de preferencia. El primer centro que selecciones ser\xe1 tu primera opci\xf3n."]}),l.length>0&&(0,IS.jsxs)("div",{style:{marginBottom:"20px",padding:"15px",backgroundColor:"#e8f5e9",borderRadius:"6px",border:"1px solid #c8e6c9"},children:[(0,IS.jsx)("strong",{style:{color:"#2E7D32"},children:"Centros seleccionados en orden de preferencia:"}),(0,IS.jsx)("ol",{style:{paddingLeft:"25px",marginTop:"10px",marginBottom:"0",color:"#333"},children:l.map(((e,n)=>{const r=t.find((t=>t.id===e));return r?(0,IS.jsxs)("li",{style:{marginBottom:"8px"},children:[(0,IS.jsx)("strong",{children:r.centro}),(0,IS.jsxs)("span",{style:{color:"#555"},children:["(",r.municipio,")"]}),0===n&&(0,IS.jsx)("span",{style:{display:"inline-block",marginLeft:"8px",fontSize:"12px",color:"#d35400",backgroundColor:"#fff3cd",padding:"1px 5px",borderRadius:"10px",fontWeight:"bold"},children:"1\xaa opci\xf3n"})]},e):null}))}),(0,IS.jsx)("div",{style:{marginTop:"10px",textAlign:"right"},children:(0,IS.jsx)("button",{type:"button",onClick:()=>c([]),style:{padding:"6px 12px",backgroundColor:"#f8d7da",color:"#721c24",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"13px"},children:"Limpiar selecci\xf3n"})})]}),(0,IS.jsx)("div",{style:{textAlign:"center"},children:(0,IS.jsx)("button",{type:"submit",disabled:h||0===l.length,style:{padding:"12px 25px",backgroundImage:h?"linear-gradient(to right, #cccccc, #dddddd)":"linear-gradient(to right, #3498db, #2980b9)",color:"white",border:"none",borderRadius:"6px",cursor:h||0===l.length?"not-allowed":"pointer",display:"inline-flex",alignItems:"center",justifyContent:"center",fontSize:"16px",fontWeight:"500",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:h?(0,IS.jsxs)(IS.Fragment,{children:[(0,IS.jsx)("span",{style:{display:"inline-block",width:"18px",height:"18px",border:"3px solid rgba(255,255,255,0.3)",borderRadius:"50%",borderTopColor:"white",animation:"spin 1s linear infinite",marginRight:"10px"}}),"Procesando..."]}):(0,IS.jsx)(IS.Fragment,{children:"Solicitar Plaza"})})})]})]}),(0,IS.jsxs)("div",{className:"search-container",children:[(0,IS.jsx)("input",{type:"text",className:"search-box",placeholder:"Buscar por centro, municipio o c\xf3digo...",value:i,onChange:e=>{a(e.target.value),d(1)}}),i&&(0,IS.jsx)("button",{className:"clear-search",onClick:()=>a(""),children:"\xd7"})]}),(0,IS.jsxs)("div",{className:"filters-container",children:[(0,IS.jsxs)("select",{className:"filter-select",value:w,onChange:e=>{T(e.target.value),d(1)},children:[(0,IS.jsx)("option",{value:"",children:"Todos los ASI"}),A.map((e=>(0,IS.jsx)("option",{value:e,children:e},e)))]}),(0,IS.jsxs)("select",{className:"filter-select",value:E,onChange:e=>{S(e.target.value),d(1)},children:[(0,IS.jsx)("option",{value:"",children:"Todos los departamentos"}),I.map((e=>(0,IS.jsx)("option",{value:e,children:e},e)))]}),(0,IS.jsxs)("select",{className:"filter-select",value:x,onChange:e=>{k(e.target.value),d(1)},children:[(0,IS.jsx)("option",{value:"",children:"Todos los municipios"}),N.map((e=>(0,IS.jsx)("option",{value:e,children:e},e)))]}),(0,IS.jsxs)("select",{className:"filter-select",value:p,onChange:e=>{m(Number(e.target.value)),d(1)},children:[(0,IS.jsx)("option",{value:10,children:"10 por p\xe1gina"}),(0,IS.jsx)("option",{value:25,children:"25 por p\xe1gina"}),(0,IS.jsx)("option",{value:50,children:"50 por p\xe1gina"}),(0,IS.jsx)("option",{value:100,children:"100 por p\xe1gina"})]})]}),(0,IS.jsxs)("div",{className:"results-info",children:[(0,IS.jsxs)("span",{children:["Mostrando ",L.length," de ",D.length," centros"]}),(0,IS.jsxs)("span",{children:["Total plazas: ",M]})]}),(0,IS.jsx)("div",{className:"plazas-grid",children:0===D.length?(0,IS.jsxs)("div",{className:"empty-state",children:[(0,IS.jsx)("div",{className:"empty-icon",children:"\ud83d\udd0d"}),(0,IS.jsx)("p",{children:"No se encontraron plazas con los criterios seleccionados."}),(0,IS.jsx)("button",{className:"reset-filters",onClick:()=>{a(""),d(1)},children:"Limpiar filtros"})]}):(0,IS.jsxs)("table",{className:"tabla-plazas",children:[(0,IS.jsx)("thead",{children:(0,IS.jsxs)("tr",{children:[(0,IS.jsx)("th",{style:{width:"60px"}}),(0,IS.jsx)("th",{children:"C\xf3digo"}),(0,IS.jsx)("th",{className:"centro-column",children:"Centro"}),(0,IS.jsx)("th",{children:"Municipio"}),(0,IS.jsx)("th",{children:"Plazas"}),g<768&&(0,IS.jsx)("th",{style:{width:"40px"},children:"Info"})]})}),(0,IS.jsx)("tbody",{children:L.map(((e,t)=>{const n=e.plazas-e.asignadas,r=l.includes(e.id);r&&l.indexOf(e.id);let i=t%2===0?"white":"#f9f9f9";r?i="#e6f7ff":0===n?i="#ffe6e6":n<=2&&(i="#fff3cd");const a=e.docId||`plaza-${e.id}-${t}`;return(0,IS.jsxs)("tr",{style:{backgroundColor:i,transition:"background-color 0.2s ease"},onClick:()=>{_&&(r?c(l.filter((t=>t!==e.id))):l.includes(e.id)||c([...l,e.id]))},children:[(0,IS.jsx)("td",{children:(0,IS.jsx)("input",{type:"checkbox",id:`plaza-${e.id}`,value:e.id,onChange:z,checked:l.includes(e.id),style:{width:"20px",height:"20px",cursor:"pointer"}})}),(0,IS.jsx)("td",{children:e.codigo}),(0,IS.jsx)("td",{className:"centro-column",title:e.centro,children:e.centro}),(0,IS.jsx)("td",{children:e.municipio}),(0,IS.jsx)("td",{children:e.plazas}),g<768&&(0,IS.jsx)("td",{children:(0,IS.jsx)("button",{className:"info-button",onClick:t=>{t.stopPropagation(),(e=>{b({...e,disponibles:e.plazas-(e.asignadas||0)})})(e)},children:"\u2139\ufe0f"})})]},a)}))})]})}),D.length>0&&(0,IS.jsxs)("div",{className:"pagination",children:[(0,IS.jsx)("button",{className:"pagination-button",onClick:()=>d(1),disabled:1===f,children:"\xab\xab"}),(0,IS.jsx)("button",{className:"pagination-button",onClick:()=>d((e=>Math.max(1,e-1))),disabled:1===f,children:"\xab"}),(O<=5?Array.from({length:O},((e,t)=>t+1)):f<=3?[1,2,3,4,5]:f>=O-2?[O-4,O-3,O-2,O-1,O]:[f-2,f-1,f,f+1,f+2]).map((e=>(0,IS.jsx)("button",{className:"pagination-button "+(f===e?"active":""),onClick:()=>d(e),children:e},e))),(0,IS.jsx)("button",{className:"pagination-button",onClick:()=>d((e=>Math.min(O,e+1))),disabled:f===O,children:"\xbb"}),(0,IS.jsx)("button",{className:"pagination-button",onClick:()=>d(O),disabled:f===O,children:"\xbb\xbb"})]}),y&&(0,IS.jsx)("div",{className:"info-modal",children:(0,IS.jsxs)("div",{className:"info-content",children:[(0,IS.jsx)("h3",{children:"Informaci\xf3n del centro"}),(0,IS.jsxs)("p",{children:[(0,IS.jsx)("strong",{children:"Centro:"})," ",y.centro]}),(0,IS.jsxs)("p",{children:[(0,IS.jsx)("strong",{children:"C\xf3digo:"})," ",y.codigo]}),(0,IS.jsxs)("p",{children:[(0,IS.jsx)("strong",{children:"Municipio:"})," ",y.municipio]}),(0,IS.jsxs)("p",{children:[(0,IS.jsx)("strong",{children:"Departamento:"})," ",y.departamento]}),(0,IS.jsxs)("p",{children:[(0,IS.jsx)("strong",{children:"ASI:"})," ",y.asi]}),(0,IS.jsxs)("p",{children:[(0,IS.jsx)("strong",{children:"Plazas disponibles:"})," ",y.disponibles]}),(0,IS.jsxs)("div",{className:"modal-footer",children:[(0,IS.jsx)("button",{className:"close-button",onClick:F,children:"Cerrar"}),(0,IS.jsx)("button",{className:"select-button",onClick:()=>{z({target:{value:y.id}}),F()},children:l.includes(y.id)?"Deseleccionar":"Seleccionar"})]})]})}),(0,IS.jsx)("style",{children:"\n        .plazas-container {\n          background-color: white;\n          border-radius: 8px;\n          box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);\n          padding: 20px;\n          height: 100%;\n          display: flex;\n          flex-direction: column;\n        }\n        \n        .search-container {\n          position: relative;\n          margin-bottom: 15px;\n          width: 100%;\n        }\n        \n        .search-box {\n          width: 100%;\n          padding: 14px 16px;\n          border: 2px solid #ddd;\n          border-radius: 6px;\n          font-size: 16px;\n          transition: border-color 0.3s;\n        }\n        \n        .search-box:focus {\n          border-color: #1976d2;\n          outline: none;\n          box-shadow: 0 0 0 3px rgba(25, 118, 210, 0.2);\n        }\n        \n        .clear-search {\n          position: absolute;\n          right: 10px;\n          top: 50%;\n          transform: translateY(-50%);\n          background: none;\n          border: none;\n          font-size: 24px;\n          cursor: pointer;\n          color: #999;\n        }\n        \n        .clear-search:hover {\n          color: #333;\n        }\n        \n        .filters-container {\n          display: flex;\n          flex-wrap: wrap;\n          gap: 10px;\n          margin-bottom: 15px;\n        }\n        \n        .filter-select {\n          padding: 10px;\n          border: 1px solid #ddd;\n          border-radius: 4px;\n          min-width: 150px;\n          flex-grow: 1;\n        }\n        \n        .results-info {\n          display: flex;\n          justify-content: space-between;\n          margin-bottom: 10px;\n          font-size: 14px;\n          color: #555;\n          font-weight: 500;\n        }\n        \n        .plazas-grid {\n          overflow-y: auto;\n          height: 100%;\n          border: 1px solid #eee;\n          border-radius: 4px;\n          margin-bottom: 15px;\n        }\n        \n        .tabla-plazas {\n          width: 100%;\n          border-collapse: collapse;\n        }\n        \n        .tabla-plazas th {\n          background-color: #f5f5f5;\n          position: sticky;\n          top: 0;\n          padding: 12px 10px;\n          text-align: left;\n          border-bottom: 2px solid #ddd;\n          z-index: 10;\n          font-weight: 600;\n        }\n        \n        .tabla-plazas td {\n          padding: 12px 10px;\n          border-bottom: 1px solid #eee;\n        }\n        \n        .centro-column {\n          max-width: 300px;\n          white-space: nowrap;\n          overflow: hidden;\n          text-overflow: ellipsis;\n        }\n        \n        .tabla-plazas tr:hover {\n          background-color: #f9f9f9;\n        }\n        \n        .selected-row {\n          background-color: #e3f2fd;\n        }\n        \n        .selected-row:hover {\n          background-color: #bbdefb;\n        }\n        \n        .empty-state {\n          display: flex;\n          flex-direction: column;\n          align-items: center;\n          justify-content: center;\n          padding: 40px 0;\n          text-align: center;\n          color: #757575;\n        }\n        \n        .empty-icon {\n          font-size: 48px;\n          margin-bottom: 20px;\n        }\n        \n        .reset-filters {\n          margin-top: 15px;\n          padding: 8px 16px;\n          background-color: #1976d2;\n          color: white;\n          border: none;\n          border-radius: 4px;\n          cursor: pointer;\n        }\n        \n        .pagination {\n          display: flex;\n          justify-content: center;\n          gap: 5px;\n          margin-top: 15px;\n          flex-wrap: wrap;\n        }\n        \n        .pagination-button {\n          padding: 8px 12px;\n          border: 1px solid #ddd;\n          background-color: white;\n          border-radius: 4px;\n          cursor: pointer;\n          transition: all 0.2s;\n        }\n        \n        .pagination-button.active {\n          background-color: #1976d2;\n          color: white;\n          border-color: #1976d2;\n        }\n        \n        .pagination-button:hover:not(:disabled) {\n          background-color: #f0f0f0;\n          border-color: #bbb;\n        }\n        \n        .pagination-button:disabled {\n          cursor: not-allowed;\n          opacity: 0.5;\n        }\n        \n        .info-button {\n          background: none;\n          border: none;\n          cursor: pointer;\n          font-size: 18px;\n          padding: 2px;\n        }\n        \n        .info-modal {\n          position: fixed;\n          top: 0;\n          left: 0;\n          right: 0;\n          bottom: 0;\n          background-color: rgba(0, 0, 0, 0.5);\n          display: flex;\n          justify-content: center;\n          align-items: center;\n          z-index: 1000;\n        }\n        \n        .info-content {\n          background-color: white;\n          border-radius: 8px;\n          padding: 20px;\n          width: 90%;\n          max-width: 500px;\n          max-height: 80vh;\n          overflow-y: auto;\n          box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);\n        }\n        \n        .info-content h3 {\n          margin-top: 0;\n          color: #1a237e;\n          border-bottom: 1px solid #eee;\n          padding-bottom: 10px;\n        }\n        \n        .modal-footer {\n          display: flex;\n          justify-content: flex-end;\n          gap: 10px;\n          margin-top: 20px;\n          border-top: 1px solid #eee;\n          padding-top: 15px;\n        }\n        \n        .close-button, .select-button {\n          padding: 8px 16px;\n          border-radius: 4px;\n          border: none;\n          cursor: pointer;\n        }\n        \n        .close-button {\n          background-color: #f5f5f5;\n          color: #333;\n        }\n        \n        .select-button {\n          background-color: #1976d2;\n          color: white;\n        }\n        \n        /* Dise\xf1o responsive */\n        @media (max-width: 768px) {\n          .plazas-container {\n            padding: 15px 10px;\n          }\n          \n          .filters-container {\n            flex-direction: column;\n            gap: 8px;\n          }\n          \n          .filter-select {\n            width: 100%;\n          }\n          \n          .tabla-plazas th, .tabla-plazas td {\n            padding: 10px 5px;\n            font-size: 14px;\n          }\n          \n          .centro-column {\n            max-width: 120px;\n          }\n          \n          .pagination-button {\n            padding: 6px 10px;\n          }\n        }\n      "})]})},OS=e=>{let{solicitudes:t,assignments:n,availablePlazas:i}=e;const[a,s]=(0,r.useState)(1),[o,l]=(0,r.useState)(10),[c,u]=(0,r.useState)(""),[h,f]=(0,r.useState)("undefined"!==typeof window?window.innerWidth:1200);(0,r.useEffect)((()=>{const e=()=>{f(window.innerWidth)};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]);const d=h<768,p=[...t.filter((e=>{const t=e.orden.toString(),n=e.centrosIds.map((e=>{const t=i.find((t=>t.id===e));return t?t.centro+" "+t.localidad+" "+t.municipio:""})).join(" ").toLowerCase();return t.includes(c.toLowerCase())||n.includes(c.toLowerCase())}))].sort(((e,t)=>e.orden-t.orden)),m=Math.ceil(p.length/o),g=a*o,v=g-o,y=p.slice(v,g);return t.length?(0,IS.jsxs)("div",{children:[(0,IS.jsxs)("div",{style:{marginBottom:"15px",fontSize:"14px",padding:"12px 15px",backgroundColor:"#fff7f0",borderRadius:"6px",borderLeft:"4px solid #d35400",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:["A continuaci\xf3n se muestran las solicitudes pendientes con sus preferencias de centros en orden.",(0,IS.jsx)("p",{style:{color:"#d35400",fontWeight:"bold",marginTop:"8px",marginBottom:"0"},children:"\u26a0\ufe0f Las solicitudes se procesan por orden de prioridad (n\xfamero de orden menor = mayor prioridad)"})]}),(0,IS.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,IS.jsxs)("div",{style:{marginBottom:"10px",position:"relative"},children:[(0,IS.jsx)("input",{type:"text",placeholder:"Buscar por n\xfamero de orden o centro...",value:c,onChange:e=>{u(e.target.value),s(1)},style:{padding:"12px 15px",paddingLeft:"40px",border:"1px solid #ddd",borderRadius:"6px",width:"100%",fontSize:"16px",boxShadow:"inset 0 1px 3px rgba(0,0,0,0.05)"}}),(0,IS.jsx)("div",{style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",color:"#666",fontSize:"18px"},children:"\ud83d\udd0d"})]}),(0,IS.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"10px"},children:[(0,IS.jsxs)("div",{style:{marginBottom:"10px",fontSize:"14px",color:"#666"},children:["Mostrando ",(0,IS.jsxs)("strong",{children:[p.length>0?v+1:0,"-",Math.min(g,p.length)]})," de ",(0,IS.jsx)("strong",{children:p.length})," solicitudes",c&&` (filtradas de ${t.length})`]}),(0,IS.jsx)("div",{children:(0,IS.jsxs)("select",{value:o,onChange:e=>{l(Number(e.target.value)),s(1)},style:{padding:"8px 12px",border:"1px solid #ddd",borderRadius:"6px",backgroundColor:"white",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:[(0,IS.jsx)("option",{value:10,children:"10 por p\xe1gina"}),(0,IS.jsx)("option",{value:25,children:"25 por p\xe1gina"}),(0,IS.jsx)("option",{value:50,children:"50 por p\xe1gina"}),(0,IS.jsx)("option",{value:p.length,children:"Ver todas"})]})})]})]}),d&&(0,IS.jsx)("div",{style:{marginBottom:"15px",fontSize:"13px",color:"#666",textAlign:"center",backgroundColor:"#fff3cd",padding:"8px",borderRadius:"4px"},children:"\u2190 Desliza para ver la tabla completa \u2192"}),(0,IS.jsx)("div",{style:{overflowX:"auto",border:"1px solid #e1e8f0",borderRadius:"6px",WebkitOverflowScrolling:"touch"},children:(0,IS.jsxs)("table",{className:"responsive-table",style:{width:"100%",borderCollapse:"collapse",minWidth:d?"768px":"auto"},children:[(0,IS.jsx)("thead",{children:(0,IS.jsxs)("tr",{style:{backgroundImage:"linear-gradient(to right, #fef5ec, #fde4ce)",position:"sticky",top:0,zIndex:5},children:[(0,IS.jsx)("th",{style:{border:"1px solid #ddd",padding:"12px 15px",textAlign:"left",color:"#d35400"},children:"N\xba Orden"}),(0,IS.jsx)("th",{style:{border:"1px solid #ddd",padding:"12px 15px",textAlign:"left",color:"#d35400"},children:"Fecha/Hora"}),(0,IS.jsx)("th",{style:{border:"1px solid #ddd",padding:"12px 15px",textAlign:"left",color:"#d35400"},children:"Centros Seleccionados (en orden de preferencia)"}),(0,IS.jsx)("th",{style:{border:"1px solid #ddd",padding:"12px 15px",textAlign:"center",color:"#d35400"},children:"Estado"})]})}),(0,IS.jsxs)("tbody",{children:[y.map(((e,t)=>{const r=new Date(e.timestamp),a=`${r.toLocaleDateString()} ${r.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`,s=n.some((t=>t.order===e.orden)),o=n.find((t=>t.order===e.orden)),l=s?"#e8f5e9":t%2===0?"white":"#fef9f4";return(0,IS.jsxs)("tr",{style:{backgroundColor:l,opacity:s?.8:1,transition:"background-color 0.2s ease"},children:[(0,IS.jsxs)("td",{style:{border:"1px solid #ddd",padding:"12px 15px",fontWeight:"bold",backgroundColor:e.orden<=50?"#fff3cd":"inherit"},children:[e.orden,e.orden<=50&&(0,IS.jsx)("span",{style:{display:"inline-block",marginLeft:"8px",fontSize:"12px",color:"#856404",backgroundColor:"#fff3cd",padding:"2px 6px",borderRadius:"12px",boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},children:"Alta prioridad"})]}),(0,IS.jsx)("td",{style:{border:"1px solid #ddd",padding:"12px 15px"},children:a}),(0,IS.jsx)("td",{style:{border:"1px solid #ddd",padding:"12px 15px"},children:(0,IS.jsx)("ol",{style:{margin:"0",paddingLeft:"20px"},children:e.centrosIds.map(((e,t)=>{const n=i.find((t=>t.id===e)),r=o&&o.id===e;return(0,IS.jsx)("li",{style:{marginBottom:"8px",backgroundColor:r?"#e8f5e9":"inherit",padding:r?"6px 8px":"0",borderRadius:r?"4px":"0",border:r?"1px solid #c8e6c9":"none"},children:n?(0,IS.jsxs)(IS.Fragment,{children:[(0,IS.jsx)("strong",{style:{color:0===t?"#d35400":"inherit"},children:n.centro}),(0,IS.jsxs)("span",{style:{fontSize:"14px",color:"#666"},children:["- ",n.localidad," (",n.municipio,")"]}),0===t&&(0,IS.jsx)("span",{style:{display:"inline-block",marginLeft:"8px",fontSize:"12px",color:"#d35400",backgroundColor:"#fff3cd",padding:"1px 5px",borderRadius:"10px",fontWeight:"bold"},children:"1\xaa opci\xf3n"}),n.plazas-n.asignadas<=0&&!r&&(0,IS.jsx)("span",{style:{color:"#e74c3c",marginLeft:"10px",fontSize:"12px",fontWeight:"bold",backgroundColor:"#ffebee",padding:"1px 6px",borderRadius:"10px"},children:"Completo"}),r&&(0,IS.jsx)("span",{style:{color:"#2E7D32",marginLeft:"10px",fontSize:"12px",fontWeight:"bold",backgroundColor:"#e8f5e9",padding:"1px 6px",borderRadius:"10px"},children:"\u2713 Asignado"})]}):(0,IS.jsxs)("span",{style:{color:"#999"},children:["Centro no disponible (ID: ",e,")"]})},t)}))})}),(0,IS.jsx)("td",{style:{border:"1px solid #ddd",padding:"12px 15px",textAlign:"center"},children:s?(0,IS.jsx)("div",{style:{backgroundColor:"#e8f5e9",color:"#2E7D32",padding:"8px 12px",borderRadius:"6px",fontSize:"14px",fontWeight:"bold",border:"1px solid #c8e6c9",display:"inline-block"},children:"\u2713 Asignado"}):(0,IS.jsx)("div",{style:{backgroundColor:"#fff7e6",color:"#f39c12",padding:"8px 12px",borderRadius:"6px",fontSize:"14px",fontWeight:"bold",border:"1px solid #ffeeba",display:"inline-block"},children:"Pendiente"})})]},t)})),0===y.length&&(0,IS.jsx)("tr",{children:(0,IS.jsx)("td",{colSpan:"4",style:{textAlign:"center",padding:"30px",color:"#666"},children:c?`No se encontraron solicitudes que coincidan con "${c}"`:"No hay solicitudes pendientes para mostrar"})})]})]})}),p.length>o&&(0,IS.jsxs)("div",{style:{display:"flex",justifyContent:"center",marginTop:"20px",gap:"5px",flexWrap:"wrap"},children:[(0,IS.jsx)("button",{onClick:()=>{a>1&&s(a-1)},disabled:1===a,style:{padding:"8px 12px",backgroundColor:1===a?"#f1f1f1":"white",border:"1px solid #ddd",borderRadius:"4px",cursor:1===a?"not-allowed":"pointer"},children:"\xab Anterior"}),Array.from({length:Math.min(5,m)},((e,t)=>{let n;return n=m<=5||a<=3?t+1:a>=m-2?m-4+t:a-2+t,(0,IS.jsx)("button",{onClick:()=>s(n),style:{padding:"8px 12px",backgroundColor:a===n?"#e67e22":"white",color:a===n?"white":"#333",border:"1px solid #ddd",borderRadius:"4px",cursor:"pointer"},children:n},n)})),(0,IS.jsx)("button",{onClick:()=>{a<m&&s(a+1)},disabled:a===m,style:{padding:"8px 12px",backgroundColor:a===m?"#f1f1f1":"white",border:"1px solid #ddd",borderRadius:"4px",cursor:a===m?"not-allowed":"pointer"},children:"Siguiente \xbb"})]})]}):(0,IS.jsxs)("div",{style:{textAlign:"center",padding:"40px 20px",backgroundColor:"#f5f7fa",borderRadius:"8px",color:"#5c6c7c"},children:[(0,IS.jsx)("div",{style:{fontSize:"36px",marginBottom:"15px"},children:"\ud83d\udcdd"}),(0,IS.jsx)("div",{style:{fontSize:"18px",fontWeight:"bold",marginBottom:"10px"},children:"No hay solicitudes pendientes"}),(0,IS.jsx)("div",{style:{fontSize:"14px"},children:'Las solicitudes aparecer\xe1n aqu\xed cuando se env\xeden desde la pesta\xf1a "Plazas Disponibles"'})]})};const RS=function(){return(0,IS.jsxs)("div",{style:{marginTop:"40px",marginBottom:"20px",padding:"15px",borderTop:"1px solid #eee",textAlign:"center",color:"#666",fontSize:"14px"},children:[(0,IS.jsxs)("p",{children:["Realizado por ",(0,IS.jsx)("a",{href:"https://ag-marketing.es",target:"_blank",rel:"noopener noreferrer",style:{color:"#18539E",textDecoration:"none",fontWeight:"bold"},children:"AG-Marketing"})]}),(0,IS.jsxs)("p",{children:["\xa9 ",(new Date).getFullYear()," - Todos los derechos reservados"]})]})};const PS=function(){const[e,t]=(0,r.useState)([]),[n,i]=(0,r.useState)([]),[a,s]=(0,r.useState)([]),[o,l]=(0,r.useState)(!1),[c,u]=(0,r.useState)(""),[h,f]=(0,r.useState)(!1),[d,p]=(0,r.useState)(""),[m,g]=(0,r.useState)([]),[v,y]=(0,r.useState)(!1),[b,w]=(0,r.useState)(null),[T,E]=(0,r.useState)(""),[S,x]=(0,r.useState)(!1),[k,_]=(0,r.useState)(""),[C,A]=(0,r.useState)("success"),[I,N]=(0,r.useState)("asignaciones"),D=(0,r.useRef)(!1),O=(0,r.useRef)(!1),R=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";_(e),A(t),x(!0),"error"!==t&&setTimeout((()=>{x(!1)}),5e3)},P=async e=>{try{u(`Limpiando colecci\xf3n ${e}...`);const t=await vd(kf(Gp,e));if(t.size>0){console.log(`Eliminando ${t.size} documentos de ${e}...`);for(const n of t.docs)await wd(_f(Gp,e,n.id));console.log(`Colecci\xf3n ${e} limpiada correctamente`)}else console.log(`No hay documentos en la colecci\xf3n ${e} para eliminar`);return!0}catch(MS){throw console.error(`Error al limpiar colecci\xf3n ${e}:`,MS),MS}},L=async()=>{try{const e=(await vd(kf(Gp,"centros"))).docs.map((e=>({...e.data(),docId:e.id})));t(e),console.log(`Cargados ${e.length} centros desde Firebase`);const n=(await vd(kf(Gp,"asignaciones"))).docs.map((e=>({...e.data(),docId:e.id})));i(n),console.log(`Cargadas ${n.length} asignaciones desde Firebase`);const r=(await vd(kf(Gp,"solicitudesPendientes"))).docs.map((e=>({...e.data(),docId:e.id})));return s(r),console.log(`Cargadas ${r.length} solicitudes desde Firebase`),!0}catch(MS){throw console.error("Error al cargar datos desde Firebase:",MS),MS}};(0,r.useEffect)((()=>{let e;return(async()=>{if(D.current||O.current)console.log("Inicializaci\xf3n ya en progreso o completada. Omitiendo...");else{D.current=!0,console.log("Iniciando verificaci\xf3n de datos en Firebase...");try{const n=(await vd(kf(Gp,"centros"))).size;0===n?(console.log("No hay centros en Firebase. Cargando desde CSV..."),await P("centros"),await(async()=>{f(!0),u("Cargando datos del archivo plazas.csv...");try{await P("centros");const s=await fetch("/asignacion-plazas/plazas.csv");if(!s.ok)throw new Error(`Error al cargar el CSV: ${s.status} - ${s.statusText}`);const o=await s.text();if(console.log(`CSV cargado, tama\xf1o: ${o.length} caracteres`),o.length<100)throw new Error("El archivo CSV parece estar vac\xedo o es demasiado peque\xf1o");const l=o.split("\n").map((e=>e.replace(/"/g,"").trim())).filter(Boolean);if(l.length<5)throw new Error("El archivo CSV no contiene suficientes l\xedneas de datos");const c=l.findIndex((e=>e.includes("A.S.I.;")));if(-1===c){const e=l.findIndex((e=>e.includes("ASI;")||e.includes("DEPARTAMENTO;")||e.includes("CODIGO;")));if(-1===e)throw new Error("No se encontr\xf3 una l\xednea de encabezado v\xe1lida en el CSV");console.log(`Encabezado alternativo encontrado en l\xednea ${e}: ${l[e]}`),c=e}else console.log(`Encabezado encontrado en l\xednea ${c}: ${l[c]}`);if(l[c].split(";").length<5)throw new Error("El formato del encabezado no es v\xe1lido, faltan columnas necesarias");const h=new Set,d=new Set,p=[];let m=1,g=0,v=0,y=0;u("Analizando datos del CSV...");for(let f=c+1;f<l.length;f++){var e,t,n,r,i,a;const s=l[f].trim();if(!s)continue;if(s.includes("de 11")||s.includes("TOTAL ="))continue;const o=s.split(";");if(o.length<5){v++;continue}const c=(null===(e=o[0])||void 0===e?void 0:e.trim())||"",b=(null===(t=o[1])||void 0===t?void 0:t.trim())||"",w=(null===(n=o[2])||void 0===n?void 0:n.trim())||"",T=(null===(r=o[3])||void 0===r?void 0:r.trim())||"",E=(null===(i=o[4])||void 0===i?void 0:i.trim())||"";if(!w||w.length<2){console.warn(`L\xednea ${f+1}: C\xf3digo inv\xe1lido o ausente: "${w}"`),v++;continue}if(!T||T.length<2){console.warn(`L\xednea ${f+1}: Nombre de centro inv\xe1lido o ausente: "${T}"`),v++;continue}if(!E){console.warn(`L\xednea ${f+1}: Municipio ausente para centro: "${T}"`),v++;continue}const S=`${w}-${T}-${E}`.toLowerCase();if(h.has(S)){y++;continue}d.has(w)&&console.warn(`Posible duplicado con c\xf3digo ${w}: "${T}" en ${E}`),h.add(S),d.add(w);let x=1;if(o.length>5&&null!==(a=o[5])&&void 0!==a&&a.trim()){const e=o[5].trim(),t=parseInt(e);!isNaN(t)&&t>0?x=t:console.warn(`L\xednea ${f+1}: Valor de plazas inv\xe1lido: "${e}", usando 1 por defecto`)}else console.warn(`L\xednea ${f+1}: No se especific\xf3 n\xfamero de plazas para "${T}", usando 1 por defecto`);g+=x,p.push({id:m++,asi:c,departamento:b,codigo:w,centro:T,localidad:E,municipio:E,plazas:x,asignadas:0}),p.length%100===0&&u(`Procesando CSV: ${p.length} centros encontrados...`)}if(console.log(`Procesamiento completado: ${p.length} centros v\xe1lidos, ${v} l\xedneas inv\xe1lidas, ${y} duplicados`),console.log(`Total de plazas antes de ajuste: ${g}`),0===p.length)throw new Error("No se pudieron extraer centros v\xe1lidos del CSV");const b=7066;if(g!==b){console.log(`Ajustando conteo de plazas: ${g} \u2192 ${b}`);const e=[...p].sort(((e,t)=>t.plazas-e.plazas)),t=g-b;if(Math.abs(t)>100&&console.warn(`Diferencia muy grande (${t} plazas) entre el total calculado y el objetivo`),t>0){let n=t,r=0;for(;n>0&&r<Math.min(5,e.length);){const i=e[r],a=Math.min(Math.ceil(t/5),i.plazas-1,n);a>0&&(i.plazas-=a,n-=a,console.log(`Reducidas ${a} plazas del centro "${i.centro}" (quedan ${i.plazas})`)),r++}n>0&&(e[0].plazas-=n,console.log(`Reducidas ${n} plazas adicionales del centro "${e[0].centro}"`))}else if(t<0){let n=Math.abs(t),r=0;for(;n>0&&r<Math.min(5,e.length);){const i=e[r],a=Math.min(Math.ceil(Math.abs(t)/5),n);i.plazas+=a,n-=a,console.log(`A\xf1adidas ${a} plazas al centro "${i.centro}" (total ${i.plazas})`),r++}n>0&&(e[0].plazas+=n,console.log(`A\xf1adidas ${n} plazas adicionales al centro "${e[0].centro}"`))}const n=p.reduce(((e,t)=>e+t.plazas),0);if(n!==b)throw console.error(`Error en el ajuste: ${n} \u2260 ${b}`),new Error(`No se pudo ajustar el n\xfamero de plazas correctamente: ${n} \u2260 ${b}`);console.log(`Ajuste completado correctamente. Total final: ${n} plazas`)}u(`A\xf1adiendo ${p.length} centros a Firebase...`);let w=0;const T=await vd(kf(Gp,"centros"));if(T.size>0)return console.log(`ADVERTENCIA: Ya existen ${T.size} centros en Firebase. Cancelando carga para evitar duplicaci\xf3n.`),R("Se encontraron datos existentes. Usando datos actuales para evitar duplicaci\xf3n.","warning"),f(!1),await L();const E=100;for(let e=0;e<p.length;e+=E){const t=p.slice(e,e+E);u(`A\xf1adiendo centros: ${e}/${p.length}`);for(const e of t){const t=_f(kf(Gp,"centros"));await yd(t,{...e,docId:t.id}),w++}console.log(`Procesados ${w}/${p.length} centros`)}return u("Datos cargados correctamente"),console.log(`Se han a\xf1adido ${w} centros a Firebase con un total exacto de ${b} plazas`),await L(),f(!1),R(`Se han cargado ${w} centros y exactamente ${b} plazas correctamente`,"success"),!0}catch(MS){return console.error("Error al cargar o procesar el CSV:",MS),R(`Error en la importaci\xf3n: ${MS.message}`,"error"),f(!1),!1}})()):(console.log(`Ya hay ${n} centros en Firebase. Cargando datos existentes...`),await L()),e=(()=>{const e=Ed(kf(Gp,"centros"),(e=>{const n=[];e.forEach((e=>{n.push({...e.data(),docId:e.id})})),n.length>0&&(console.log(`Datos de centros actualizados: ${n.length} centros`),t(n))})),n=Ed(kf(Gp,"asignaciones"),(e=>{const t=[];e.forEach((e=>{t.push({...e.data(),docId:e.id})})),console.log(`Datos de asignaciones actualizados: ${t.length} asignaciones`),i(t)})),r=Ed(kf(Gp,"solicitudesPendientes"),(e=>{const t=[];e.forEach((e=>{t.push({...e.data(),docId:e.id})})),console.log(`Datos de solicitudes pendientes actualizados: ${t.length} solicitudes`),s(t)}));return()=>{e(),n(),r()}})(),O.current=!0}catch(MS){console.error("Error al inicializar app:",MS),R(`Error al inicializar: ${MS.message}`,"error")}finally{D.current=!1}}})(),()=>{e&&e()}}),[]);const M=async()=>{if(!o){l(!0),u("Iniciando procesamiento de todas las solicitudes...");try{console.log("Procesando todas las solicitudes...");const t=await(async(e,t,n,r)=>{try{if(!e.length)return r&&r("No hay solicitudes pendientes para procesar"),{success:!0,message:"No hay solicitudes pendientes para procesar"};r&&r("Iniciando procesamiento de solicitudes...");const i=[...e].sort(((e,t)=>e.orden-t.orden));console.log("Procesando solicitudes ordenadas por n\xfamero de orden:",i);let a=[...n];r&&r("Eliminando asignaciones existentes para procesar desde cero...");for(const e of t)if(e.docId)try{await wd(_f(Gp,"asignaciones",e.docId))}catch(MS){console.error(`Error al eliminar asignaci\xf3n ${e.docId}:`,MS)}for(let e=0;e<a.length;e++)if(a[e].docId)try{await bd(_f(Gp,"centros",a[e].docId),{asignadas:0}),a[e]={...a[e],asignadas:0}}catch(MS){console.error(`Error al resetear contadores para centro ${a[e].id}:`,MS)}r&&r(`Procesando ${i.length} solicitudes en orden de prioridad...`);let s=0,o=0;const l=[],c={};a.forEach((e=>{c[e.id]={id:e.id,plazas:e.plazas,asignadas:0,docId:e.docId,centro:e.centro,localidad:e.localidad,municipio:e.municipio}}));for(const e of i){o++;const{orden:t,centrosIds:n}=e;console.log(`Procesando solicitud para orden ${t} con centros preferidos: ${n.join(", ")}`);let a=!1;for(const e of n){const r=c[e];if(r)if(r.asignadas<r.plazas){console.log(`Encontrada plaza disponible en centro ${r.centro} (${r.asignadas}/${r.plazas}) para orden ${t}`);const i={order:t,id:e,localidad:r.localidad,centro:r.centro,municipio:r.municipio,timestamp:Date.now()};try{const o=await Td(kf(Gp,"asignaciones"),i);i.docId=o.id,r.asignadas++,await bd(_f(Gp,"centros",r.docId),{asignadas:r.asignadas}),l.push(i),s++,a=!0,console.log(`\u2705 Asignaci\xf3n exitosa: Orden ${t} asignado a centro ${r.centro} (preferencia ${n.indexOf(e)+1})`);break}catch(MS){console.error(`Error al crear asignaci\xf3n para orden ${t} en centro ${r.centro}:`,MS)}}else console.log(`Centro ${r.centro} sin plazas disponibles (${r.asignadas}/${r.plazas}) para orden ${t}`);else console.warn(`Centro con ID ${e} no encontrado para orden ${t}`)}a||console.log(`\u26a0\ufe0f No se pudo asignar plaza para orden ${t}. Todos sus centros preferidos est\xe1n completos.`),o%5!==0&&o!==i.length||r&&r(`Procesando solicitudes... ${o}/${i.length} (${s} asignaciones realizadas)`)}return a=a.map((e=>{const t=c[e.id];return{...e,asignadas:t?t.asignadas:e.asignadas}})),r&&r(`Procesamiento completado. ${o} solicitudes procesadas. ${s} asignaciones realizadas.`),{success:!0,plazasActualizadas:a,asignacionesNuevas:s,message:`Procesamiento completado. ${o} solicitudes procesadas. ${s} asignaciones realizadas.`}}catch(MS){return console.error("Error al procesar solicitudes:",MS),r&&r("Error al procesar solicitudes: "+MS.message),{success:!1,error:MS.message,message:"Error al procesar solicitudes: "+MS.message}}})(a,n,e,u);t.success?(l(!1),R(t.message,"success")):(l(!1),R(`Error al procesar solicitudes: ${t.error}`,"error"))}catch(MS){console.error("Error al procesar solicitudes:",MS),l(!1),R(`Error al procesar solicitudes: ${MS.message}`,"error")}}},F={container:{maxWidth:"1280px",margin:"0 auto",padding:"20px",backgroundColor:"#f8f9fa",minHeight:"100vh",fontFamily:"Arial, sans-serif"},header:{textAlign:"center",marginBottom:"30px",borderBottom:"1px solid #e7e7e7",paddingBottom:"15px"},title:{color:"#2c3e50",fontSize:"28px",margin:"0 0 10px 0"},subtitle:{color:"#7f8c8d",fontSize:"16px",fontWeight:"normal",margin:0},tabs:{display:"flex",gap:"2px",marginBottom:"20px",backgroundColor:"#e9ecef",borderRadius:"10px",padding:"3px",overflow:"hidden"},tab:{padding:"12px 20px",cursor:"pointer",flex:1,textAlign:"center",borderRadius:"8px",transition:"all 0.3s ease",fontSize:"15px",fontWeight:"500"},activeTab:{backgroundColor:"#fff",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",color:"#3498db"},inactiveTab:{backgroundColor:"transparent",color:"#7f8c8d"},sectionTitle:{fontSize:"20px",color:"#2c3e50",marginBottom:"15px",paddingBottom:"8px",borderBottom:"2px solid #e7e7e7"},cardContainer:{backgroundColor:"white",borderRadius:"10px",padding:"20px",boxShadow:"0 2px 10px rgba(0,0,0,0.05)",marginBottom:"20px"},popup:{position:"fixed",top:"20px",right:"20px",padding:"15px 20px",borderRadius:"10px",boxShadow:"0 3px 15px rgba(0,0,0,0.2)",zIndex:1e3,maxWidth:"350px",animation:"slideIn 0.3s ease"},processingButton:{padding:"12px 20px",backgroundImage:o?"linear-gradient(to right, #cccccc, #dddddd)":"linear-gradient(to right, #3498db, #2980b9)",color:"white",border:"none",borderRadius:"6px",cursor:o||0===a.length?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"15px",fontWeight:"500",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",margin:"10px auto"},reloadButton:{padding:"12px 20px",backgroundImage:h?"linear-gradient(to right, #cccccc, #dddddd)":"linear-gradient(to right, #e74c3c, #c0392b)",color:"white",border:"none",borderRadius:"6px",cursor:h?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"15px",fontWeight:"500",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",margin:"10px auto"}};return(0,IS.jsxs)("div",{style:F.container,children:[(0,IS.jsxs)("div",{style:F.header,children:[(0,IS.jsx)("h1",{style:F.title,children:"Sistema de Asignaci\xf3n de Plazas"}),(0,IS.jsx)("h2",{style:F.subtitle,children:"Gesti\xf3n y seguimiento de solicitudes y asignaciones"})]}),(0,IS.jsxs)("div",{style:F.tabs,children:[(0,IS.jsx)("div",{style:{...F.tab,..."asignaciones"===I?F.activeTab:F.inactiveTab},onClick:()=>N("asignaciones"),children:"\ud83d\udccb Historial de Asignaciones"}),(0,IS.jsx)("div",{style:{...F.tab,..."solicitudes"===I?F.activeTab:F.inactiveTab},onClick:()=>N("solicitudes"),children:"\ud83d\udd0d Solicitudes Pendientes"}),(0,IS.jsx)("div",{style:{...F.tab,..."plazas"===I?F.activeTab:F.inactiveTab},onClick:()=>N("plazas"),children:"\ud83c\udfe2 Plazas Disponibles"})]}),a.length>0&&(0,IS.jsx)("div",{style:{textAlign:"center",marginBottom:"20px"},children:(0,IS.jsx)("button",{onClick:M,disabled:o||0===a.length,style:F.processingButton,children:o?(0,IS.jsxs)(IS.Fragment,{children:[(0,IS.jsx)("span",{style:{display:"inline-block",width:"18px",height:"18px",border:"3px solid rgba(255,255,255,0.3)",borderRadius:"50%",borderTopColor:"white",animation:"spin 1s linear infinite",marginRight:"10px"}}),"Procesando..."]}):"Procesar todas las solicitudes"})}),"asignaciones"===I&&(0,IS.jsxs)("div",{style:F.cardContainer,children:[(0,IS.jsx)("h3",{style:F.sectionTitle,children:"Historial de Asignaciones"}),(0,IS.jsx)(NS,{assignments:n})]}),"solicitudes"===I&&(0,IS.jsxs)("div",{style:F.cardContainer,children:[(0,IS.jsx)("h3",{style:F.sectionTitle,children:"Solicitudes Pendientes"}),(0,IS.jsx)(OS,{solicitudes:a,availablePlazas:e,assignments:n})]}),"plazas"===I&&(0,IS.jsxs)("div",{style:F.cardContainer,children:[(0,IS.jsx)("h3",{style:F.sectionTitle,children:"Plazas Disponibles"}),e.length>0?(0,IS.jsx)(DS,{availablePlazas:e,assignments:n,searchTerm:T,setSearchTerm:E,orderNumber:d,setOrderNumber:p,centrosSeleccionados:m,setCentrosSeleccionados:g,handleOrderSubmit:async e=>{e.preventDefault();const t=parseInt(d,10);if(isNaN(t)||t<=0)return void R("Por favor, introduce un n\xfamero de orden v\xe1lido","error");if(0===m.length)return void R("Por favor, selecciona al menos un centro de trabajo","error");const r=n.find((e=>e.order===t));r&&(w(r),R(`Ya tienes una plaza asignada en: ${r.centro}. Puedes seguir enviando solicitudes para otras plazas que te interesen aunque ya tengas una asignada.`,"warning")),y(!0);try{const e=m.map((e=>Number(e)));console.log("Intentando guardar solicitud con centros:",e);const n=a.find((e=>e.orden===t)),r={orden:t,centrosIds:e,timestamp:Date.now()};if(n){console.log("Actualizando solicitud existente:",n.docId);const e=_f(Gp,"solicitudesPendientes",n.docId);await bd(e,r),console.log("Solicitud actualizada correctamente"),y(!1),R("Tu solicitud ha sido actualizada. Se procesar\xe1 seg\xfan orden de preferencia.","success"),p(""),g([]),await M()}else{console.log("Creando nueva solicitud");const e=await Td(kf(Gp,"solicitudesPendientes"),r);console.log("Nueva solicitud creada con ID:",e.id),y(!1),R("Tu solicitud ha sido registrada. Se procesar\xe1 seg\xfan tu n\xfamero de orden y preferencias de centros.","success"),p(""),g([]),await M()}}catch(MS){console.error("Error al guardar solicitud:",MS),R("Error al guardar la solicitud: "+MS.message,"error"),y(!1)}},isProcessing:v}):(0,IS.jsxs)("div",{style:{textAlign:"center",padding:"40px 20px",backgroundColor:"#f5f7fa",borderRadius:"8px",color:"#5c6c7c"},children:[(0,IS.jsx)("div",{style:{fontSize:"36px",marginBottom:"15px"},children:"\ud83c\udfe2"}),(0,IS.jsx)("div",{style:{fontSize:"18px",fontWeight:"bold",marginBottom:"10px"},children:"Cargando plazas..."}),(0,IS.jsx)("div",{style:{fontSize:"14px",marginBottom:"20px"},children:"Por favor espera mientras se cargan los datos de los centros."}),(0,IS.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"10px"},children:[(0,IS.jsx)("div",{style:{width:"20px",height:"20px",border:"3px solid rgba(0,0,0,0.1)",borderRadius:"50%",borderTopColor:"#3498db",animation:"spin 1s linear infinite"}}),(0,IS.jsx)("div",{children:"Cargando datos..."})]})]})]}),(0,IS.jsx)(RS,{}),S&&(0,IS.jsx)("div",{style:{...F.popup,backgroundColor:"success"===C?"#d4edda":"warning"===C?"#fff3cd":"#f8d7da",color:"success"===C?"#155724":"warning"===C?"#856404":"#721c24"},children:(0,IS.jsxs)("div",{style:{display:"flex",alignItems:"flex-start"},children:[(0,IS.jsx)("div",{style:{flex:1},children:k}),(0,IS.jsx)("button",{onClick:()=>x(!1),style:{background:"none",border:"none",cursor:"pointer",fontSize:"18px",marginLeft:"10px",color:"inherit"},children:"\xd7"})]})}),(o||h)&&(0,IS.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:999},children:(0,IS.jsxs)("div",{style:{backgroundColor:"white",padding:"20px",borderRadius:"10px",boxShadow:"0 0 20px rgba(0,0,0,0.2)",maxWidth:"500px",width:"90%",textAlign:"center"},children:[(0,IS.jsx)("div",{style:{marginBottom:"15px",fontSize:"18px"},children:h?"Cargando datos...":"Procesando solicitudes..."}),(0,IS.jsx)("div",{children:c}),(0,IS.jsx)("div",{style:{width:"100%",height:"4px",backgroundColor:"#f1f1f1",borderRadius:"2px",marginTop:"15px",overflow:"hidden",position:"relative"},children:(0,IS.jsx)("div",{style:{position:"absolute",top:0,left:0,height:"100%",width:"30%",backgroundColor:"#3498db",borderRadius:"2px",animation:"loading 1.5s infinite ease-in-out"}})})]})}),(0,IS.jsx)("style",{children:"\n        @keyframes slideIn {\n          0% { transform: translateX(100%); opacity: 0; }\n          100% { transform: translateX(0); opacity: 1; }\n        }\n        @keyframes loading {\n          0% { left: -30%; }\n          100% { left: 100%; }\n        }\n        @keyframes spin {\n          0% { transform: rotate(0deg); }\n          100% { transform: rotate(360deg); }\n        }\n      "})]})},LS=e=>{e&&e instanceof Function&&n.e(453).then(n.bind(n,453)).then((t=>{let{getCLS:n,getFID:r,getFCP:i,getLCP:a,getTTFB:s}=t;n(e),r(e),i(e),a(e),s(e)}))};i.createRoot(document.getElementById("root")).render((0,IS.jsx)(r.StrictMode,{children:(0,IS.jsx)(PS,{})})),LS()})();
//# sourceMappingURL=main.ac80eb0d.js.map