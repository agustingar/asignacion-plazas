/*! For license information please see main.c8456760.js.LICENSE.txt */
(()=>{"use strict";var e={43:(e,t,n)=>{e.exports=n(202)},52:(e,t,n)=>{n.d(t,{KO:()=>J,MF:()=>Y,Sx:()=>X,Wp:()=>Q,j6:()=>H,om:()=>$,xZ:()=>G});var r=n(812),a=n(443),i=n(529),s=n(799);class o{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const c="@firebase/app",l="0.11.4",u=new a.Vy("@firebase/app"),d="@firebase/app-compat",h="@firebase/analytics-compat",f="@firebase/analytics",p="@firebase/app-check-compat",g="@firebase/app-check",m="@firebase/auth",v="@firebase/auth-compat",y="@firebase/database",b="@firebase/data-connect",w="@firebase/database-compat",x="@firebase/functions",E="@firebase/functions-compat",T="@firebase/installations",S="@firebase/installations-compat",I="@firebase/messaging",k="@firebase/messaging-compat",C="@firebase/performance",_="@firebase/performance-compat",A="@firebase/remote-config",N="@firebase/remote-config-compat",R="@firebase/storage",O="@firebase/storage-compat",D="@firebase/firestore",P="@firebase/vertexai",L="@firebase/firestore-compat",M="firebase",F="[DEFAULT]",z={[c]:"fire-core",[d]:"fire-core-compat",[f]:"fire-analytics",[h]:"fire-analytics-compat",[g]:"fire-app-check",[p]:"fire-app-check-compat",[m]:"fire-auth",[v]:"fire-auth-compat",[y]:"fire-rtdb",[b]:"fire-data-connect",[w]:"fire-rtdb-compat",[x]:"fire-fn",[E]:"fire-fn-compat",[T]:"fire-iid",[S]:"fire-iid-compat",[I]:"fire-fcm",[k]:"fire-fcm-compat",[C]:"fire-perf",[_]:"fire-perf-compat",[A]:"fire-rc",[N]:"fire-rc-compat",[R]:"fire-gcs",[O]:"fire-gcs-compat",[D]:"fire-fst",[L]:"fire-fst-compat",[P]:"fire-vertex","fire-js":"fire-js",[M]:"fire-js-all"},j=new Map,U=new Map,B=new Map;function V(e,t){try{e.container.addComponent(t)}catch(n){u.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function $(e){const t=e.name;if(B.has(t))return u.debug(`There were multiple attempts to register component ${t}.`),!1;B.set(t,e);for(const n of j.values())V(n,e);for(const n of U.values())V(n,e);return!0}function H(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function G(e){return null!==e&&void 0!==e&&void 0!==e.settings}const W={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},K=new i.FA("app","Firebase",W);class q{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new r.uA("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw K.create("app-deleted",{appName:this._name})}}const Y="11.6.0";function Q(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const a=Object.assign({name:F,automaticDataCollectionEnabled:!1},t),s=a.name;if("string"!==typeof s||!s)throw K.create("bad-app-name",{appName:String(s)});if(n||(n=(0,i.T9)()),!n)throw K.create("no-options");const o=j.get(s);if(o){if((0,i.bD)(n,o.options)&&(0,i.bD)(a,o.config))return o;throw K.create("duplicate-app",{appName:s})}const c=new r.h1(s);for(const r of B.values())c.addComponent(r);const l=new q(n,a,c);return j.set(s,l),l}function X(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F;const t=j.get(e);if(!t&&e===F&&(0,i.T9)())return Q();if(!t)throw K.create("no-app",{appName:e});return t}function J(e,t,n){var a;let i=null!==(a=z[e])&&void 0!==a?a:e;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const e=[`Unable to register library "${i}" with version "${t}":`];return s&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&e.push("and"),o&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void u.warn(e.join(" "))}$(new r.uA(`${i}-version`,(()=>({library:i,version:t})),"VERSION"))}const Z="firebase-heartbeat-store";let ee=null;function te(){return ee||(ee=(0,s.P2)("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(Z)}catch(n){console.warn(n)}}}).catch((e=>{throw K.create("idb-open",{originalErrorMessage:e.message})}))),ee}async function ne(e,t){try{const n=(await te()).transaction(Z,"readwrite"),r=n.objectStore(Z);await r.put(t,re(e)),await n.done}catch(n){if(n instanceof i.g)u.warn(n.message);else{const e=K.create("idb-set",{originalErrorMessage:null===n||void 0===n?void 0:n.message});u.warn(e.message)}}}function re(e){return`${e.name}!${e.options.appId}`}class ae{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new se(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){var e,t;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=ie();if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some((e=>e.date===r)))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>30){const e=function(e){if(0===e.length)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){u.warn(n)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=ie(),{heartbeatsToSend:n,unsentEntries:r}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const a of e){const e=n.find((e=>e.agent===a.agent));if(e){if(e.dates.push(a.date),oe(n)>t){e.dates.pop();break}}else if(n.push({agent:a.agent,dates:[a.date]}),oe(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),a=(0,i.Uj)(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(t){return u.warn(t),""}}}function ie(){return(new Date).toISOString().substring(0,10)}class se{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!(0,i.zW)()&&(0,i.eX)().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await te()).transaction(Z),n=await t.objectStore(Z).get(re(e));return await t.done,n}catch(t){if(t instanceof i.g)u.warn(t.message);else{const e=K.create("idb-get",{originalErrorMessage:null===t||void 0===t?void 0:t.message});u.warn(e.message)}}}(this.app);return(null===e||void 0===e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return ne(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return ne(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function oe(e){return(0,i.Uj)(JSON.stringify({version:2,heartbeats:e})).length}var ce;ce="",$(new r.uA("platform-logger",(e=>new o(e)),"PRIVATE")),$(new r.uA("heartbeat",(e=>new ae(e)),"PRIVATE")),J(c,l,ce),J(c,l,"esm2017"),J("fire-js","")},153:(e,t,n)=>{var r=n(43),a=Symbol.for("react.element"),i=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,n){var r,i={},l=null,u=null;for(r in void 0!==n&&(l=""+n),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(u=t.ref),t)s.call(t,r)&&!c.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:a,type:e,key:l,ref:u,props:i,_owner:o.current}}t.Fragment=i,t.jsx=l,t.jsxs=l},202:(e,t)=>{var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),c=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,m={};function v(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var w=b.prototype=new y;w.constructor=b,g(w,v.prototype),w.isPureReactComponent=!0;var x=Array.isArray,E=Object.prototype.hasOwnProperty,T={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function I(e,t,r){var a,i={},s=null,o=null;if(null!=t)for(a in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(s=""+t.key),t)E.call(t,a)&&!S.hasOwnProperty(a)&&(i[a]=t[a]);var c=arguments.length-2;if(1===c)i.children=r;else if(1<c){for(var l=Array(c),u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}if(e&&e.defaultProps)for(a in c=e.defaultProps)void 0===i[a]&&(i[a]=c[a]);return{$$typeof:n,type:e,key:s,ref:o,props:i,_owner:T.current}}function k(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var C=/\/+/g;function _(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function A(e,t,a,i,s){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var c=!1;if(null===e)c=!0;else switch(o){case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case n:case r:c=!0}}if(c)return s=s(c=e),e=""===i?"."+_(c,0):i,x(s)?(a="",null!=e&&(a=e.replace(C,"$&/")+"/"),A(s,t,a,"",(function(e){return e}))):null!=s&&(k(s)&&(s=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,a+(!s.key||c&&c.key===s.key?"":(""+s.key).replace(C,"$&/")+"/")+e)),t.push(s)),1;if(c=0,i=""===i?".":i+":",x(e))for(var l=0;l<e.length;l++){var u=i+_(o=e[l],l);c+=A(o,t,a,u,s)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),l=0;!(o=e.next()).done;)c+=A(o=o.value,t,a,u=i+_(o,l++),s);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return c}function N(e,t,n){if(null==e)return e;var r=[],a=0;return A(e,r,"","",(function(e){return t.call(n,e,a++)})),r}function R(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var O={current:null},D={transition:null},P={ReactCurrentDispatcher:O,ReactCurrentBatchConfig:D,ReactCurrentOwner:T};function L(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:N,forEach:function(e,t,n){N(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return N(e,(function(){t++})),t},toArray:function(e){return N(e,(function(e){return e}))||[]},only:function(e){if(!k(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=a,t.Profiler=s,t.PureComponent=b,t.StrictMode=i,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=P,t.act=L,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=g({},e.props),i=e.key,s=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,o=T.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(l in t)E.call(t,l)&&!S.hasOwnProperty(l)&&(a[l]=void 0===t[l]&&void 0!==c?c[l]:t[l])}var l=arguments.length-2;if(1===l)a.children=r;else if(1<l){c=Array(l);for(var u=0;u<l;u++)c[u]=arguments[u+2];a.children=c}return{$$typeof:n,type:e.type,key:i,ref:s,props:a,_owner:o}},t.createContext=function(e){return(e={$$typeof:c,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=I,t.createFactory=function(e){var t=I.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:l,render:e}},t.isValidElement=k,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:R}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=D.transition;D.transition={};try{e()}finally{D.transition=t}},t.unstable_act=L,t.useCallback=function(e,t){return O.current.useCallback(e,t)},t.useContext=function(e){return O.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return O.current.useDeferredValue(e)},t.useEffect=function(e,t){return O.current.useEffect(e,t)},t.useId=function(){return O.current.useId()},t.useImperativeHandle=function(e,t,n){return O.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return O.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return O.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return O.current.useMemo(e,t)},t.useReducer=function(e,t,n){return O.current.useReducer(e,t,n)},t.useRef=function(e){return O.current.useRef(e)},t.useState=function(e){return O.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return O.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return O.current.useTransition()},t.version="18.3.1"},213:(e,t,n)=>{n.d(t,{db:()=>Jr});var r=n(52);(0,r.KO)("firebase","11.6.0","app");var a=n(472),i=n(443),s=n(529),o=n(812),c=n(799);const l="@firebase/installations",u="0.6.13",d=1e4,h=`w:${u}`,f="FIS_v2",p=36e5,g={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},m=new s.FA("installations","Installations",g);function v(e){return e instanceof s.g&&e.code.includes("request-failed")}function y(e){let{projectId:t}=e;return`https://firebaseinstallations.googleapis.com/v1/projects/${t}/installations`}function b(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function w(e,t){const n=(await t.json()).error;return m.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function x(e){let{apiKey:t}=e;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function E(e,t){let{refreshToken:n}=t;const r=x(e);return r.append("Authorization",function(e){return`${f} ${e}`}(n)),r}async function T(e){const t=await e();return t.status>=500&&t.status<600?e():t}function S(e){return new Promise((t=>{setTimeout(t,e)}))}const I=/^[cdef][\w-]{21}$/;function k(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){const t=(n=e,btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_"));var n;return t.substr(0,22)}(e);return I.test(t)?t:""}catch(e){return""}}function C(e){return`${e.appName}!${e.appId}`}const _=new Map;function A(e,t){const n=C(e);N(n,t),function(e,t){const n=O();n&&n.postMessage({key:e,fid:t});D()}(n,t)}function N(e,t){const n=_.get(e);if(n)for(const r of n)r(t)}let R=null;function O(){return!R&&"BroadcastChannel"in self&&(R=new BroadcastChannel("[Firebase] FID Change"),R.onmessage=e=>{N(e.data.key,e.data.fid)}),R}function D(){0===_.size&&R&&(R.close(),R=null)}const P="firebase-installations-store";let L=null;function M(){return L||(L=(0,c.P2)("firebase-installations-database",1,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(P)}})),L}async function F(e,t){const n=C(e),r=(await M()).transaction(P,"readwrite"),a=r.objectStore(P),i=await a.get(n);return await a.put(t,n),await r.done,i&&i.fid===t.fid||A(e,t.fid),t}async function z(e){const t=C(e),n=(await M()).transaction(P,"readwrite");await n.objectStore(P).delete(t),await n.done}async function j(e,t){const n=C(e),r=(await M()).transaction(P,"readwrite"),a=r.objectStore(P),i=await a.get(n),s=t(i);return void 0===s?await a.delete(n):await a.put(s,n),await r.done,!s||i&&i.fid===s.fid||A(e,s.fid),s}async function U(e){let t;const n=await j(e.appConfig,(n=>{const r=function(e){const t=e||{fid:k(),registrationStatus:0};return $(t)}(n),a=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine){return{installationEntry:t,registrationPromise:Promise.reject(m.create("app-offline"))}}const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=async function(e,t){try{const n=await async function(e,t){let{appConfig:n,heartbeatServiceProvider:r}=e,{fid:a}=t;const i=y(n),s=x(n),o=r.getImmediate({optional:!0});if(o){const e=await o.getHeartbeatsHeader();e&&s.append("x-firebase-client",e)}const c={fid:a,authVersion:f,appId:n.appId,sdkVersion:h},l={method:"POST",headers:s,body:JSON.stringify(c)},u=await T((()=>fetch(i,l)));if(u.ok){const e=await u.json();return{fid:e.fid||a,registrationStatus:2,refreshToken:e.refreshToken,authToken:b(e.authToken)}}throw await w("Create Installation",u)}(e,t);return F(e.appConfig,n)}catch(n){throw v(n)&&409===n.customData.serverCode?await z(e.appConfig):await F(e.appConfig,{fid:t.fid,registrationStatus:0}),n}}(e,n);return{installationEntry:n,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:B(e)}:{installationEntry:t}}(e,r);return t=a.registrationPromise,a.installationEntry}));return""===n.fid?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}async function B(e){let t=await V(e.appConfig);for(;1===t.registrationStatus;)await S(100),t=await V(e.appConfig);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:n}=await U(e);return n||t}return t}function V(e){return j(e,(e=>{if(!e)throw m.create("installation-not-found");return $(e)}))}function $(e){return 1===(t=e).registrationStatus&&t.registrationTime+d<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}async function H(e,t){let{appConfig:n,heartbeatServiceProvider:r}=e;const a=function(e,t){let{fid:n}=t;return`${y(e)}/${n}/authTokens:generate`}(n,t),i=E(n,t),s=r.getImmediate({optional:!0});if(s){const e=await s.getHeartbeatsHeader();e&&i.append("x-firebase-client",e)}const o={installation:{sdkVersion:h,appId:n.appId}},c={method:"POST",headers:i,body:JSON.stringify(o)},l=await T((()=>fetch(a,c)));if(l.ok){return b(await l.json())}throw await w("Generate Auth Token",l)}async function G(e){let t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=await j(e.appConfig,(r=>{if(!K(r))throw m.create("not-registered");const a=r.authToken;if(!n&&function(e){return 2===e.requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+p}(e)}(a))return r;if(1===a.requestStatus)return t=async function(e,t){let n=await W(e.appConfig);for(;1===n.authToken.requestStatus;)await S(100),n=await W(e.appConfig);const r=n.authToken;return 0===r.requestStatus?G(e,t):r}(e,n),r;{if(!navigator.onLine)throw m.create("app-offline");const n=function(e){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}(r);return t=async function(e,t){try{const n=await H(e,t),r=Object.assign(Object.assign({},t),{authToken:n});return await F(e.appConfig,r),n}catch(n){if(!v(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await F(e.appConfig,n)}else await z(e.appConfig);throw n}}(e,n),n}}));return t?await t:r.authToken}function W(e){return j(e,(e=>{if(!K(e))throw m.create("not-registered");const t=e.authToken;return 1===(n=t).requestStatus&&n.requestTime+d<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e;var n}))}function K(e){return void 0!==e&&2===e.registrationStatus}async function q(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e;await async function(e){const{registrationPromise:t}=await U(e);t&&await t}(n);return(await G(n,t)).token}function Y(e){return m.create("missing-app-config-values",{valueName:e})}const Q="installations",X=e=>{const t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw Y("App Configuration");if(!e.name)throw Y("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw Y(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:(0,r.j6)(t,"heartbeat"),_delete:()=>Promise.resolve()}},J=e=>{const t=e.getProvider("app").getImmediate(),n=(0,r.j6)(t,Q).getImmediate();return{getId:()=>async function(e){const t=e,{installationEntry:n,registrationPromise:r}=await U(t);return r?r.catch(console.error):G(t).catch(console.error),n.fid}(n),getToken:e=>q(n,e)}};(0,r.om)(new o.uA(Q,X,"PUBLIC")),(0,r.om)(new o.uA("installations-internal",J,"PRIVATE")),(0,r.KO)(l,u),(0,r.KO)(l,u,"esm2017");const Z="analytics",ee="https://www.googletagmanager.com/gtag/js",te=new i.Vy("@firebase/analytics"),ne={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},re=new s.FA("analytics","Analytics",ne);function ae(e){if(!e.startsWith(ee)){const t=re.create("invalid-gtag-resource",{gtagURL:e});return te.warn(t.message),""}return e}function ie(e){return Promise.all(e.map((e=>e.catch((e=>e)))))}function se(e,t){const n=function(e,t){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(e,t)),n}("firebase-js-sdk-policy",{createScriptURL:ae}),r=document.createElement("script"),a=`${ee}?l=${e}&id=${t}`;r.src=n?null===n||void 0===n?void 0:n.createScriptURL(a):a,r.async=!0,document.head.appendChild(r)}function oe(e,t,n,r){return async function(a){try{for(var i=arguments.length,s=new Array(i>1?i-1:0),o=1;o<i;o++)s[o-1]=arguments[o];if("event"===a){const[r,a]=s;await async function(e,t,n,r,a){try{let i=[];if(a&&a.send_to){let e=a.send_to;Array.isArray(e)||(e=[e]);const r=await ie(n);for(const n of e){const e=r.find((e=>e.measurementId===n)),a=e&&t[e.appId];if(!a){i=[];break}i.push(a)}}0===i.length&&(i=Object.values(t)),await Promise.all(i),e("event",r,a||{})}catch(i){te.error(i)}}(e,t,n,r,a)}else if("config"===a){const[a,i]=s;await async function(e,t,n,r,a,i){const s=r[a];try{if(s)await t[s];else{const e=(await ie(n)).find((e=>e.measurementId===a));e&&await t[e.appId]}}catch(o){te.error(o)}e("config",a,i)}(e,t,n,r,a,i)}else if("consent"===a){const[t,n]=s;e("consent",t,n)}else if("get"===a){const[t,n,r]=s;e("get",t,n,r)}else if("set"===a){const[t]=s;e("set",t)}else e(a,...s)}catch(c){te.error(c)}}}const ce=new class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function le(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}async function ue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ce,n=arguments.length>2?arguments[2]:void 0;const{appId:r,apiKey:a,measurementId:i}=e.options;if(!r)throw re.create("no-app-id");if(!a){if(i)return{measurementId:i,appId:r};throw re.create("no-api-key")}const s=t.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},o=new he;return setTimeout((async()=>{o.abort()}),void 0!==n?n:6e4),de({appId:r,apiKey:a,measurementId:i},s,o,t)}async function de(e,t,n){let{throttleEndTimeMillis:r,backoffCount:a}=t,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ce;var o;const{appId:c,measurementId:l}=e;try{await function(e,t){return new Promise(((n,r)=>{const a=Math.max(t-Date.now(),0),i=setTimeout(n,a);e.addEventListener((()=>{clearTimeout(i),r(re.create("fetch-throttle",{throttleEndTimeMillis:t}))}))}))}(n,r)}catch(u){if(l)return te.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${null===u||void 0===u?void 0:u.message}]`),{appId:c,measurementId:l};throw u}try{const t=await async function(e){var t;const{appId:n,apiKey:r}=e,a={method:"GET",headers:le(r)},i="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),s=await fetch(i,a);if(200!==s.status&&304!==s.status){let e="";try{const n=await s.json();(null===(t=n.error)||void 0===t?void 0:t.message)&&(e=n.error.message)}catch(o){}throw re.create("config-fetch-failed",{httpStatus:s.status,responseMessage:e})}return s.json()}(e);return i.deleteThrottleMetadata(c),t}catch(u){const t=u;if(!function(e){if(!(e instanceof s.g)||!e.customData)return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(t)){if(i.deleteThrottleMetadata(c),l)return te.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${null===t||void 0===t?void 0:t.message}]`),{appId:c,measurementId:l};throw u}const r=503===Number(null===(o=null===t||void 0===t?void 0:t.customData)||void 0===o?void 0:o.httpStatus)?(0,s.p9)(a,i.intervalMillis,30):(0,s.p9)(a,i.intervalMillis),d={throttleEndTimeMillis:Date.now()+r,backoffCount:a+1};return i.setThrottleMetadata(c,d),te.debug(`Calling attemptFetch again in ${r} millis`),de(e,d,n,i)}}class he{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach((e=>e()))}}let fe,pe;function ge(e){pe=e}function me(e){fe=e}async function ve(e,t,n,r,a,i,o){var c;const l=ue(e);l.then((t=>{n[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&te.warn(`The measurement ID in the local Firebase config (${e.options.measurementId}) does not match the measurement ID fetched from the server (${t.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)})).catch((e=>te.error(e))),t.push(l);const u=async function(){if(!(0,s.zW)())return te.warn(re.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await(0,s.eX)()}catch(e){return te.warn(re.create("indexeddb-unavailable",{errorInfo:null===e||void 0===e?void 0:e.toString()}).message),!1}return!0}().then((e=>e?r.getId():void 0)),[d,h]=await Promise.all([l,u]);(function(e){const t=window.document.getElementsByTagName("script");for(const n of Object.values(t))if(n.src&&n.src.includes(ee)&&n.src.includes(e))return n;return null})(i)||se(i,d.measurementId),pe&&(a("consent","default",pe),ge(void 0)),a("js",new Date);const f=null!==(c=null===o||void 0===o?void 0:o.config)&&void 0!==c?c:{};return f.origin="firebase",f.update=!0,null!=h&&(f.firebase_id=h),a("config",d.measurementId,f),fe&&(a("set",fe),me(void 0)),d.measurementId}class ye{constructor(e){this.app=e}_delete(){return delete be[this.app.options.appId],Promise.resolve()}}let be={},we=[];const xe={};let Ee,Te,Se="dataLayer",Ie="gtag",ke=!1;function Ce(e,t,n){!function(){const e=[];if((0,s.sr)()&&e.push("This is a browser extension environment."),(0,s.dM)()||e.push("Cookies are not available."),e.length>0){const t=e.map(((e,t)=>`(${t+1}) ${e}`)).join(" "),n=re.create("invalid-analytics-context",{errorInfo:t});te.warn(n.message)}}();const r=e.options.appId;if(!r)throw re.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw re.create("no-api-key");te.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=be[r])throw re.create("already-exists",{id:r});if(!ke){!function(e){let t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(Se);const{wrappedGtag:e,gtagCore:t}=function(e,t,n,r,a){let i=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];window[r].push(arguments)};return window[a]&&"function"===typeof window[a]&&(i=window[a]),window[a]=oe(i,e,t,n),{gtagCore:i,wrappedGtag:window[a]}}(be,we,xe,Se,Ie);Te=e,Ee=t,ke=!0}be[r]=ve(e,we,xe,t,Ee,Se,n);return new ye(e)}function _e(e,t,n,r){e=(0,s.Ku)(e),async function(e,t,n,r,a){if(a&&a.global)e("event",n,r);else{const a=await t;e("event",n,Object.assign(Object.assign({},r),{send_to:a}))}}(Te,be[e.app.options.appId],t,n,r).catch((e=>te.error(e)))}const Ae="@firebase/analytics",Ne="0.10.12";(0,r.om)(new o.uA(Z,((e,t)=>{let{options:n}=t;return Ce(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),n)}),"PUBLIC")),(0,r.om)(new o.uA("analytics-internal",(function(e){try{const t=e.getProvider(Z).getImmediate();return{logEvent:(e,n,r)=>_e(t,e,n,r)}}catch(t){throw re.create("interop-component-reg-failed",{reason:t})}}),"PRIVATE")),(0,r.KO)(Ae,Ne),(0,r.KO)(Ae,Ne,"esm2017");function Re(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;function Oe(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const De=Oe,Pe=new s.FA("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Le=new i.Vy("@firebase/auth");function Me(e){if(Le.logLevel<=i.$b.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];Le.error(`Auth (${r.MF}): ${e}`,...n)}}function Fe(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw Be(e,...n)}function ze(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Be(e,...n)}function je(e,t,n){const r=Object.assign(Object.assign({},De()),{[t]:n});return new s.FA("auth","Firebase",r).create(t,{appName:e.name})}function Ue(e){return je(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Be(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){const t=n[0],r=[...n.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(t,...r)}return Pe.create(e,...n)}function Ve(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];throw Be(t,...r)}}function $e(e){const t="INTERNAL ASSERTION FAILED: "+e;throw Me(t),new Error(t)}function He(e,t){e||$e(t)}function Ge(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function We(){return"http:"===Ke()||"https:"===Ke()}function Ke(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class qe{constructor(e,t){this.shortDelay=e,this.longDelay=t,He(t>e,"Short delay should be less than long delay!"),this.isMobile=(0,s.jZ)()||(0,s.lV)()}get(){return"undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(We()||(0,s.sr)()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function Ye(e,t){He(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class Qe{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void $e("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void $e("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void $e("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Xe={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Je=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Ze=new qe(3e4,6e4);function et(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function tt(e,t,n,r){return nt(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},(async()=>{let a={},i={};r&&("GET"===t?i=r:a={body:JSON.stringify(r)});const o=(0,s.Am)(Object.assign({key:e.config.apiKey},i)).slice(1),c=await e._getAdditionalHeaders();c["Content-Type"]="application/json",e.languageCode&&(c["X-Firebase-Locale"]=e.languageCode);const l=Object.assign({method:t,headers:c},a);return(0,s.c1)()||(l.referrerPolicy="no-referrer"),Qe.fetch()(await at(e,e.config.apiHost,n,o),l)}))}async function nt(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},Xe),t);try{const t=new st(e),a=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const i=await a.json();if("needConfirmation"in i)throw ot(e,"account-exists-with-different-credential",i);if(a.ok&&!("errorMessage"in i))return i;{const t=a.ok?i.errorMessage:i.error.message,[n,s]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw ot(e,"credential-already-in-use",i);if("EMAIL_EXISTS"===n)throw ot(e,"email-already-in-use",i);if("USER_DISABLED"===n)throw ot(e,"user-disabled",i);const o=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(s)throw je(e,o,s);Fe(e,o)}}catch(a){if(a instanceof s.g)throw a;Fe(e,"network-request-failed",{message:String(a)})}}async function rt(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const i=await tt(e,t,n,r,a);return"mfaPendingCredential"in i&&Fe(e,"multi-factor-auth-required",{_serverResponse:i}),i}async function at(e,t,n,r){const a=`${t}${n}?${r}`,i=e,s=i.config.emulator?Ye(e.config,a):`${e.config.apiScheme}://${a}`;if(Je.includes(n)&&(await i._persistenceManagerAvailable,"COOKIE"===i._getPersistenceType())){return i._getPersistence()._getFinalTarget(s).toString()}return s}function it(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class st{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(ze(this.auth,"network-request-failed"))),Ze.get())}))}}function ot(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const a=ze(e,t,r);return a.customData._tokenResponse=n,a}function ct(e){return void 0!==e&&void 0!==e.enterprise}class lt{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return it(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function ut(e,t){return tt(e,"GET","/v2/recaptchaConfig",et(e,t))}async function dt(e,t){return tt(e,"POST","/v1/accounts:lookup",t)}function ht(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(t){}}function ft(e){return 1e3*Number(e)}function pt(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return Me("JWT malformed, contained fewer than 3 sections"),null;try{const e=(0,s.u)(n);return e?JSON.parse(e):(Me("Failed to decode base64 JWT payload"),null)}catch(a){return Me("Caught error parsing JWT payload as JSON",null===a||void 0===a?void 0:a.toString()),null}}function gt(e){const t=pt(e);return Ve(t,"internal-error"),Ve("undefined"!==typeof t.exp,"internal-error"),Ve("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function mt(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(n){throw n instanceof s.g&&function(e){let{code:t}=e;return"auth/user-disabled"===t||"auth/user-token-expired"===t}(n)&&e.auth.currentUser===e&&await e.auth.signOut(),n}}class vt{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===(null===e||void 0===e?void 0:e.code)&&this.schedule(!0))}this.schedule()}}class yt{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=ht(this.lastLoginAt),this.creationTime=ht(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function bt(e){var t;const n=e.auth,r=await e.getIdToken(),a=await mt(e,dt(n,{idToken:r}));Ve(null===a||void 0===a?void 0:a.users.length,n,"internal-error");const i=a.users[0];e._notifyReloadListener(i);const s=(null===(t=i.providerUserInfo)||void 0===t?void 0:t.length)?wt(i.providerUserInfo):[],o=(c=e.providerData,l=s,[...c.filter((e=>!l.some((t=>t.providerId===e.providerId)))),...l]);var c,l;const u=e.isAnonymous,d=!(e.email&&i.passwordHash)&&!(null===o||void 0===o?void 0:o.length),h=!!u&&d,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new yt(i.createdAt,i.lastLoginAt),isAnonymous:h};Object.assign(e,f)}function wt(e){return e.map((e=>{var{providerId:t}=e,n=Re(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}))}class xt{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ve(e.idToken,"internal-error"),Ve("undefined"!==typeof e.idToken,"internal-error"),Ve("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):gt(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Ve(0!==e.length,"internal-error");const t=gt(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||!this.accessToken||this.isExpired?(Ve(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:a}=await async function(e,t){const n=await nt(e,{},(async()=>{const n=(0,s.Am)({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:a}=e.config,i=await at(e,r,"/v1/token",`key=${a}`),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",Qe.fetch()(i,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(a))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:a}=t,i=new xt;return n&&(Ve("string"===typeof n,"internal-error",{appName:e}),i.refreshToken=n),r&&(Ve("string"===typeof r,"internal-error",{appName:e}),i.accessToken=r),a&&(Ve("number"===typeof a,"internal-error",{appName:e}),i.expirationTime=a),i}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new xt,this.toJSON())}_performRefresh(){return $e("not implemented")}}function Et(e,t){Ve("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class Tt{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,a=Re(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new vt(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new yt(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const t=await mt(this,this.stsTokenManager.getToken(this.auth,e));return Ve(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=(0,s.Ku)(e),r=await n.getIdToken(t),a=pt(r);Ve(a&&a.exp&&a.auth_time&&a.iat,n.auth,"internal-error");const i="object"===typeof a.firebase?a.firebase:void 0,o=null===i||void 0===i?void 0:i.sign_in_provider;return{claims:a,token:r,authTime:ht(ft(a.auth_time)),issuedAtTime:ht(ft(a.iat)),expirationTime:ht(ft(a.exp)),signInProvider:o||null,signInSecondFactor:(null===i||void 0===i?void 0:i.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=(0,s.Ku)(e);await bt(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(Ve(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Tt(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Ve(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await bt(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if((0,r.xZ)(this.auth.app))return Promise.reject(Ue(this.auth));const e=await this.getIdToken();return await mt(this,async function(e,t){return tt(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,a,i,s,o,c,l;const u=null!==(n=t.displayName)&&void 0!==n?n:void 0,d=null!==(r=t.email)&&void 0!==r?r:void 0,h=null!==(a=t.phoneNumber)&&void 0!==a?a:void 0,f=null!==(i=t.photoURL)&&void 0!==i?i:void 0,p=null!==(s=t.tenantId)&&void 0!==s?s:void 0,g=null!==(o=t._redirectEventId)&&void 0!==o?o:void 0,m=null!==(c=t.createdAt)&&void 0!==c?c:void 0,v=null!==(l=t.lastLoginAt)&&void 0!==l?l:void 0,{uid:y,emailVerified:b,isAnonymous:w,providerData:x,stsTokenManager:E}=t;Ve(y&&E,e,"internal-error");const T=xt.fromJSON(this.name,E);Ve("string"===typeof y,e,"internal-error"),Et(u,e.name),Et(d,e.name),Ve("boolean"===typeof b,e,"internal-error"),Ve("boolean"===typeof w,e,"internal-error"),Et(h,e.name),Et(f,e.name),Et(p,e.name),Et(g,e.name),Et(m,e.name),Et(v,e.name);const S=new Tt({uid:y,auth:e,email:d,emailVerified:b,displayName:u,isAnonymous:w,photoURL:f,phoneNumber:h,tenantId:p,stsTokenManager:T,createdAt:m,lastLoginAt:v});return x&&Array.isArray(x)&&(S.providerData=x.map((e=>Object.assign({},e)))),g&&(S._redirectEventId=g),S}static async _fromIdTokenResponse(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=new xt;r.updateFromServerResponse(t);const a=new Tt({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await bt(a),a}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];Ve(void 0!==r.localId,"internal-error");const a=void 0!==r.providerUserInfo?wt(r.providerUserInfo):[],i=!(r.email&&r.passwordHash)&&!(null===a||void 0===a?void 0:a.length),s=new xt;s.updateFromIdToken(n);const o=new Tt({uid:r.localId,auth:e,stsTokenManager:s,isAnonymous:i}),c={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:a,metadata:new yt(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(null===a||void 0===a?void 0:a.length)};return Object.assign(o,c),o}}const St=new Map;function It(e){He(e instanceof Function,"Expected a class definition");let t=St.get(e);return t?(He(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,St.set(e,t),t)}class kt{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}kt.type="NONE";const Ct=kt;function _t(e,t,n){return`firebase:${e}:${t}:${n}`}class At{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:a}=this.auth;this.fullUserKey=_t(this.userKey,r.apiKey,a),this.fullPersistenceKey=_t("persistence",r.apiKey,a),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if("string"===typeof e){const t=await dt(this.auth,{idToken:e}).catch((()=>{}));return t?Tt._fromGetAccountInfoResponse(this.auth,t,e):null}return Tt._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new At(It(Ct),e,n);const r=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let a=r[0]||It(Ct);const i=_t(n,e.config.apiKey,e.name);let s=null;for(const l of t)try{const t=await l._get(i);if(t){let n;if("string"===typeof t){const r=await dt(e,{idToken:t}).catch((()=>{}));if(!r)break;n=await Tt._fromGetAccountInfoResponse(e,r,t)}else n=Tt._fromJSON(e,t);l!==a&&(s=n),a=l;break}}catch(c){}const o=r.filter((e=>e._shouldAllowMigration));return a._shouldAllowMigration&&o.length?(a=o[0],s&&await a._set(i,s.toJSON()),await Promise.all(t.map((async e=>{if(e!==a)try{await e._remove(i)}catch(c){}}))),new At(a,e,n)):new At(a,e,n)}}function Nt(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Pt(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Rt(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Mt(t))return"Blackberry";if(Ft(t))return"Webos";if(Ot(t))return"Safari";if((t.includes("chrome/")||Dt(t))&&!t.includes("edge/"))return"Chrome";if(Lt(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null===n||void 0===n?void 0:n.length))return n[1]}return"Other"}function Rt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,s.ZQ)();return/firefox\//i.test(e)}function Ot(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,s.ZQ)()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Dt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,s.ZQ)();return/crios\//i.test(e)}function Pt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,s.ZQ)();return/iemobile/i.test(e)}function Lt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,s.ZQ)();return/android/i.test(e)}function Mt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,s.ZQ)();return/blackberry/i.test(e)}function Ft(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,s.ZQ)();return/webos/i.test(e)}function zt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,s.ZQ)();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function jt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,s.ZQ)();return zt(e)||Lt(e)||Ft(e)||Mt(e)||/windows phone/i.test(e)||Pt(e)}function Ut(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=Nt((0,s.ZQ)());break;case"Worker":t=`${Nt((0,s.ZQ)())}-${e}`;break;default:t=e}const a=n.length?n.join(","):"FirebaseCore-web";return`${t}/JsCore/${r.MF}/${a}`}class Bt{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,r)=>{try{n(e(t))}catch(a){r(a)}}));n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const e of t)try{e()}catch(r){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===n||void 0===n?void 0:n.message})}}}class Vt{constructor(e){var t,n,r,a;const i=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=i.minPasswordLength)&&void 0!==t?t:6,i.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=i.maxPasswordLength),void 0!==i.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=i.containsLowercaseCharacter),void 0!==i.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=i.containsUppercaseCharacter),void 0!==i.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=i.containsNumericCharacter),void 0!==i.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=i.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(r=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==r?r:"",this.forceUpgradeOnSignin=null!==(a=e.forceUpgradeOnSignin)&&void 0!==a&&a,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,r,a,i,s;const o={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,o),this.validatePasswordCharacterOptions(e,o),o.isValid&&(o.isValid=null===(t=o.meetsMinPasswordLength)||void 0===t||t),o.isValid&&(o.isValid=null===(n=o.meetsMaxPasswordLength)||void 0===n||n),o.isValid&&(o.isValid=null===(r=o.containsLowercaseLetter)||void 0===r||r),o.isValid&&(o.isValid=null===(a=o.containsUppercaseLetter)||void 0===a||a),o.isValid&&(o.isValid=null===(i=o.containsNumericCharacter)||void 0===i||i),o.isValid&&(o.isValid=null===(s=o.containsNonAlphanumericCharacter)||void 0===s||s),o}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}class $t{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Gt(this),this.idTokenSubscription=new Gt(this),this.beforeStateQueue=new Bt(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Pe,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise((e=>this._resolvePersistenceManagerAvailable=e))}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=It(t)),this._initializationPromise=this.queue((async()=>{var n,r,a;if(!this._deleted&&(this.persistenceManager=await At.create(this,e),null===(n=this._resolvePersistenceManagerAvailable)||void 0===n||n.call(this),!this._deleted)){if(null===(r=this._popupRedirectResolver)||void 0===r?void 0:r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(i){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(a=this.currentUser)||void 0===a?void 0:a.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await dt(this,{idToken:e}),n=await Tt._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if((0,r.xZ)(this.app)){const e=this.app.settings.authIdToken;return e?new Promise((t=>{setTimeout((()=>this.initializeCurrentUserFromIdToken(e).then(t,t)))})):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let a=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,r=null===a||void 0===a?void 0:a._redirectEventId,s=await this.tryRedirectSignIn(e);n&&n!==r||!(null===s||void 0===s?void 0:s.user)||(a=s.user,i=!0)}if(!a)return this.directlySetCurrentUser(null);if(!a._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(a)}catch(s){a=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(s)))}return a?this.reloadAndSetCurrentUserOrClear(a):this.directlySetCurrentUser(null)}return Ve(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===a._redirectEventId?this.directlySetCurrentUser(a):this.reloadAndSetCurrentUserOrClear(a)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(n){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await bt(e)}catch(t){if("auth/network-request-failed"!==(null===t||void 0===t?void 0:t.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if((0,r.xZ)(this.app))return Promise.reject(Ue(this));const t=e?(0,s.Ku)(e):null;return t&&Ve(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&Ve(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return(0,r.xZ)(this.app)?Promise.reject(Ue(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return(0,r.xZ)(this.app)?Promise.reject(Ue(this)):this.queue((async()=>{await this.assertedPersistence.setPersistence(It(e))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e){return tt(e,"GET","/v2/passwordPolicy",et(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}(this),t=new Vt(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new s.FA("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise(((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged((()=>{n(),e()}),t)}}))}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return tt(e,"POST","/v2/accounts:revokeToken",et(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&It(e)||this._popupRedirectResolver;Ve(t,this,"argument-error"),this.redirectPersistenceManager=await At.create(this,[It(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const a="function"===typeof t?t:t.next.bind(t);let i=!1;const s=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ve(s,this,"internal-error"),s.then((()=>{i||a(this.currentUser)})),"function"===typeof t){const a=e.addObserver(t,n,r);return()=>{i=!0,a()}}{const n=e.addObserver(t);return()=>{i=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ve(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Ut(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;if((0,r.xZ)(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null===t||void 0===t?void 0:t.error)&&function(e){if(Le.logLevel<=i.$b.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];Le.warn(`Auth (${r.MF}): ${e}`,...n)}}(`Error while retrieving App Check token: ${t.error}`),null===t||void 0===t?void 0:t.token}}function Ht(e){return(0,s.Ku)(e)}class Gt{constructor(e){this.auth=e,this.observer=null,this.addObserver=(0,s.tD)((e=>this.observer=e))}get next(){return Ve(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Wt={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Kt(e){return Wt.loadJS(e)}function qt(e){return`__${e}${Math.floor(1e6*Math.random())}`}class Yt{constructor(){this.enterprise=new Qt}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class Qt{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const Xt="NO_RECAPTCHA";class Jt{constructor(e){this.type="recaptcha-enterprise",this.auth=Ht(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(t,n,r){const a=window.grecaptcha;ct(a)?a.enterprise.ready((()=>{a.enterprise.execute(t,{action:e}).then((e=>{n(e)})).catch((()=>{n(Xt)}))})):r(Error("No reCAPTCHA enterprise script loaded."))}if(this.auth.settings.appVerificationDisabledForTesting){return(new Yt).execute("siteKey",{action:"verify"})}return new Promise(((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise((async(t,n)=>{ut(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((r=>{if(void 0!==r.recaptchaKey){const n=new lt(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((e=>{n(e)}))}))})(this.auth).then((a=>{if(!t&&ct(window.grecaptcha))n(a,e,r);else{if("undefined"===typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=Wt.recaptchaEnterpriseScript;0!==t.length&&(t+=a),Kt(t).then((()=>{n(a,e,r)})).catch((e=>{r(e)}))}})).catch((e=>{r(e)}))}))}}async function Zt(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const i=new Jt(e);let s;if(a)s=Xt;else try{s=await i.verify(n)}catch(c){s=await i.verify(n,!0)}const o=Object.assign({},t);if("mfaSmsEnrollment"===n||"mfaSmsSignIn"===n){if("phoneEnrollmentInfo"in o){const e=o.phoneEnrollmentInfo.phoneNumber,t=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:t,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){const e=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:e,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function en(e,t,n,r,a){var i,s;if("EMAIL_PASSWORD_PROVIDER"===a){if(null===(i=e._getRecaptchaConfig())||void 0===i?void 0:i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await Zt(e,t,n,"getOobCode"===n);return r(e,a)}return r(e,t).catch((async a=>{if("auth/missing-recaptcha-token"===a.code){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await Zt(e,t,n,"getOobCode"===n);return r(e,a)}return Promise.reject(a)}))}if("PHONE_PROVIDER"===a){if(null===(s=e._getRecaptchaConfig())||void 0===s?void 0:s.isProviderEnabled("PHONE_PROVIDER")){const a=await Zt(e,t,n);return r(e,a).catch((async a=>{var i;if("AUDIT"===(null===(i=e._getRecaptchaConfig())||void 0===i?void 0:i.getProviderEnforcementState("PHONE_PROVIDER"))&&("auth/missing-recaptcha-token"===a.code||"auth/invalid-app-credential"===a.code)){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${n} flow.`);const a=await Zt(e,t,n,!1,!0);return r(e,a)}return Promise.reject(a)}))}{const a=await Zt(e,t,n,!1,!0);return r(e,a)}}return Promise.reject(a+" provider is not supported.")}async function tn(e){const t=Ht(e),n=await ut(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new lt(n);if(null==t.tenantId?t._agentRecaptchaConfig=r:t._tenantRecaptchaConfigs[t.tenantId]=r,r.isAnyProviderEnabled()){new Jt(t).verify()}}function nn(e,t,n){const r=Ht(e);Ve(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const a=!!(null===n||void 0===n?void 0:n.disableWarnings),i=rn(t),{host:o,port:c}=function(e){const t=rn(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(r);if(a){const e=a[1];return{host:e,port:an(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:an(t)}}}(t),l={url:`${i}//${o}${null===c?"":`:${c}`}/`},u=Object.freeze({host:o,port:c,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!r._canInitEmulator)return Ve(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),void Ve((0,s.bD)(l,r.config.emulator)&&(0,s.bD)(u,r.emulatorConfig),r,"emulator-config-failed");r.config.emulator=l,r.emulatorConfig=u,r.settings.appVerificationDisabledForTesting=!0,a||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function rn(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function an(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class sn{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return $e("not implemented")}_getIdTokenResponse(e){return $e("not implemented")}_linkToIdToken(e,t){return $e("not implemented")}_getReauthenticationResolver(e){return $e("not implemented")}}async function on(e,t){return tt(e,"POST","/v1/accounts:signUp",t)}async function cn(e,t){return rt(e,"POST","/v1/accounts:signInWithPassword",et(e,t))}class ln extends sn{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new ln(e,t,"password")}static _fromEmailAndCode(e,t){return new ln(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return en(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",cn,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return rt(e,"POST","/v1/accounts:signInWithEmailLink",et(e,t))}(e,{email:this._email,oobCode:this._password});default:Fe(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return en(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",on,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return rt(e,"POST","/v1/accounts:signInWithEmailLink",et(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:Fe(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function un(e,t){return rt(e,"POST","/v1/accounts:signInWithIdp",et(e,t))}class dn extends sn{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new dn(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Fe("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,a=Re(t,["providerId","signInMethod"]);if(!n||!r)return null;const i=new dn(n,r);return i.idToken=a.idToken||void 0,i.accessToken=a.accessToken||void 0,i.secret=a.secret,i.nonce=a.nonce,i.pendingToken=a.pendingToken||null,i}_getIdTokenResponse(e){return un(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,un(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,un(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=(0,s.Am)(t)}return e}}async function hn(e,t){return tt(e,"POST","/v1/accounts:sendVerificationCode",et(e,t))}const fn={USER_NOT_FOUND:"user-not-found"};class pn extends sn{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new pn({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new pn({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return rt(e,"POST","/v1/accounts:signInWithPhoneNumber",et(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await rt(e,"POST","/v1/accounts:signInWithPhoneNumber",et(e,t));if(n.temporaryProof)throw ot(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return rt(e,"POST","/v1/accounts:signInWithPhoneNumber",et(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),fn)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:a}=e;return n||t||r||a?new pn({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:a}):null}}class gn{constructor(e){var t,n,r,a,i,o;const c=(0,s.I9)((0,s.hp)(e)),l=null!==(t=c.apiKey)&&void 0!==t?t:null,u=null!==(n=c.oobCode)&&void 0!==n?n:null,d=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=c.mode)&&void 0!==r?r:null);Ve(l&&u&&d,"argument-error"),this.apiKey=l,this.operation=d,this.code=u,this.continueUrl=null!==(a=c.continueUrl)&&void 0!==a?a:null,this.languageCode=null!==(i=c.languageCode)&&void 0!==i?i:null,this.tenantId=null!==(o=c.tenantId)&&void 0!==o?o:null}static parseLink(e){const t=function(e){const t=(0,s.I9)((0,s.hp)(e)).link,n=t?(0,s.I9)((0,s.hp)(t)).deep_link_id:null,r=(0,s.I9)((0,s.hp)(e)).deep_link_id;return(r?(0,s.I9)((0,s.hp)(r)).link:null)||r||n||t||e}(e);try{return new gn(t)}catch(n){return null}}}class mn{constructor(){this.providerId=mn.PROVIDER_ID}static credential(e,t){return ln._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=gn.parseLink(t);return Ve(n,"argument-error"),ln._fromEmailAndCode(e,n.code,n.tenantId)}}mn.PROVIDER_ID="password",mn.EMAIL_PASSWORD_SIGN_IN_METHOD="password",mn.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class vn{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class yn extends vn{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class bn extends yn{constructor(){super("facebook.com")}static credential(e){return dn._fromParams({providerId:bn.PROVIDER_ID,signInMethod:bn.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return bn.credentialFromTaggedObject(e)}static credentialFromError(e){return bn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return bn.credential(t.oauthAccessToken)}catch(n){return null}}}bn.FACEBOOK_SIGN_IN_METHOD="facebook.com",bn.PROVIDER_ID="facebook.com";class wn extends yn{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return dn._fromParams({providerId:wn.PROVIDER_ID,signInMethod:wn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return wn.credentialFromTaggedObject(e)}static credentialFromError(e){return wn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:r}=t;if(!n&&!r)return null;try{return wn.credential(n,r)}catch(a){return null}}}wn.GOOGLE_SIGN_IN_METHOD="google.com",wn.PROVIDER_ID="google.com";class xn extends yn{constructor(){super("github.com")}static credential(e){return dn._fromParams({providerId:xn.PROVIDER_ID,signInMethod:xn.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return xn.credentialFromTaggedObject(e)}static credentialFromError(e){return xn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return xn.credential(t.oauthAccessToken)}catch(n){return null}}}xn.GITHUB_SIGN_IN_METHOD="github.com",xn.PROVIDER_ID="github.com";class En extends yn{constructor(){super("twitter.com")}static credential(e,t){return dn._fromParams({providerId:En.PROVIDER_ID,signInMethod:En.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return En.credentialFromTaggedObject(e)}static credentialFromError(e){return En.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=t;if(!n||!r)return null;try{return En.credential(n,r)}catch(a){return null}}}En.TWITTER_SIGN_IN_METHOD="twitter.com",En.PROVIDER_ID="twitter.com";class Tn{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=await Tt._fromIdTokenResponse(e,n,r),i=Sn(n);return new Tn({user:a,providerId:i,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=Sn(n);return new Tn({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function Sn(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class In extends s.g{constructor(e,t,n,r){var a;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,In.prototype),this.customData={appName:e.name,tenantId:null!==(a=e.tenantId)&&void 0!==a?a:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new In(e,t,n,r)}}function kn(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw In._fromErrorAndOperation(e,n,t,r);throw n}))}async function Cn(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=await mt(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return Tn._forOperation(e,"link",r)}async function _n(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:a}=e;if((0,r.xZ)(a.app))return Promise.reject(Ue(a));const i="reauthenticate";try{const r=await mt(e,kn(a,i,t,e),n);Ve(r.idToken,a,"internal-error");const s=pt(r.idToken);Ve(s,a,"internal-error");const{sub:o}=s;return Ve(e.uid===o,a,"user-mismatch"),Tn._forOperation(e,i,r)}catch(s){throw"auth/user-not-found"===(null===s||void 0===s?void 0:s.code)&&Fe(a,"user-mismatch"),s}}async function An(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if((0,r.xZ)(e.app))return Promise.reject(Ue(e));const a="signIn",i=await kn(e,a,t),s=await Tn._fromIdTokenResponse(e,a,i);return n||await e._updateCurrentUser(s.user),s}function Nn(e,t){return tt(e,"POST","/v2/accounts/mfaEnrollment:start",et(e,t))}new WeakMap;const Rn="__sak";class On{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Rn,"1"),this.storage.removeItem(Rn),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class Dn extends On{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=jt(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},a=this.storage.getItem(n);(0,s.lT)()&&10===document.documentMode&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Dn.type="LOCAL";const Pn=Dn;function Ln(e){var t,n;const r=e.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),a=RegExp(`${r}=([^;]+)`);return null!==(n=null===(t=document.cookie.match(a))||void 0===t?void 0:t[1])&&void 0!==n?n:null}function Mn(e){return`${"http:"===window.location.protocol?"__dev_":"__HOST-"}FIREBASE_${e.split(":")[3]}`}class Fn{constructor(){this.type="COOKIE",this.listenerUnsubscribes=new Map}_getFinalTarget(e){if(void 0===typeof window)return e;const t=new URL(`${window.location.origin}/__cookies__`);return t.searchParams.set("finalTarget",e),t}async _isAvailable(){var e;return!("boolean"===typeof isSecureContext&&!isSecureContext)&&("undefined"!==typeof navigator&&"undefined"!==typeof document&&(null===(e=navigator.cookieEnabled)||void 0===e||e))}async _set(e,t){}async _get(e){if(!this._isAvailable())return null;const t=Mn(e);if(window.cookieStore){const e=await window.cookieStore.get(t);return null===e||void 0===e?void 0:e.value}return Ln(t)}async _remove(e){if(!this._isAvailable())return;if(!await this._get(e))return;const t=Mn(e);document.cookie=`${t}=;Max-Age=34560000;Partitioned;Secure;SameSite=Strict;Path=/;Priority=High`,await fetch("/__cookies__",{method:"DELETE"}).catch((()=>{}))}_addListener(e,t){if(!this._isAvailable())return;const n=Mn(e);if(window.cookieStore){const e=e=>{const r=e.changed.find((e=>e.name===n));r&&t(r.value);e.deleted.find((e=>e.name===n))&&t(null)},r=()=>window.cookieStore.removeEventListener("change",e);return this.listenerUnsubscribes.set(t,r),window.cookieStore.addEventListener("change",e)}let r=Ln(n);const a=setInterval((()=>{const e=Ln(n);e!==r&&(t(e),r=e)}),1e3);this.listenerUnsubscribes.set(t,(()=>clearInterval(a)))}_removeListener(e,t){const n=this.listenerUnsubscribes.get(t);n&&(n(),this.listenerUnsubscribes.delete(t))}}Fn.type="COOKIE";class zn extends On{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}zn.type="SESSION";const jn=zn;class Un{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new Un(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:a}=t.data,i=this.handlersMap[r];if(!(null===i||void 0===i?void 0:i.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const s=Array.from(i).map((async e=>e(t.origin,a))),o=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}})))}(s);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:o})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Bn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}Un.receivers=[];class Vn{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const r="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let a,i;return new Promise(((s,o)=>{const c=Bn("",20);r.port1.start();const l=setTimeout((()=>{o(new Error("unsupported_event"))}),n);i={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(l),a=setTimeout((()=>{o(new Error("timeout"))}),3e3);break;case"done":clearTimeout(a),s(t.data.response);break;default:clearTimeout(l),clearTimeout(a),o(new Error("invalid_response"))}}},this.handlers.add(i),r.port1.addEventListener("message",i.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[r.port2])})).finally((()=>{i&&this.removeMessageHandler(i)}))}}function $n(){return window}function Hn(){return"undefined"!==typeof $n().WorkerGlobalScope&&"function"===typeof $n().importScripts}const Gn="firebaseLocalStorageDb",Wn="firebaseLocalStorage",Kn="fbase_key";class qn{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function Yn(e,t){return e.transaction([Wn],t?"readwrite":"readonly").objectStore(Wn)}function Qn(){const e=indexedDB.open(Gn,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(Wn,{keyPath:Kn})}catch(r){n(r)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(Wn)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(Gn);return new qn(e).toPromise()}(),t(await Qn()))}))}))}async function Xn(e,t,n){const r=Yn(e,!0).put({[Kn]:t,value:n});return new qn(r).toPromise()}function Jn(e,t){const n=Yn(e,!0).delete(t);return new qn(n).toPromise()}class Zn{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await Qn()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(n){if(t++>3)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Hn()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Un._getInstance(Hn()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new Vn(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Qn();return await Xn(e,Rn,"1"),await Jn(e,Rn),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>Xn(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=Yn(e,!1).get(t),r=await new qn(n).toPromise();return void 0===r?null:r.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>Jn(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=Yn(e,!1).getAll();return new qn(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:a}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(a)&&(this.notifyListeners(r,a),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Zn.type="LOCAL";const er=Zn;function tr(e,t){return tt(e,"POST","/v2/accounts/mfaSignIn:start",et(e,t))}qt("rcb"),new qe(3e4,6e4);const nr="recaptcha";async function rr(e,t,n){var r;if(!e._getRecaptchaConfig())try{await tn(e)}catch(a){console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let a;if(a="string"===typeof t?{phoneNumber:t}:t,"session"in a){const t=a.session;if("phoneNumber"in a){Ve("enroll"===t.type,e,"internal-error");const r={idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:a.phoneNumber,clientType:"CLIENT_TYPE_WEB"}},i=en(e,r,"mfaSmsEnrollment",(async(e,t)=>{if(t.phoneEnrollmentInfo.captchaResponse===Xt){Ve((null===n||void 0===n?void 0:n.type)===nr,e,"argument-error");return Nn(e,await ar(e,t,n))}return Nn(e,t)}),"PHONE_PROVIDER");return(await i.catch((e=>Promise.reject(e)))).phoneSessionInfo.sessionInfo}{Ve("signin"===t.type,e,"internal-error");const i=(null===(r=a.multiFactorHint)||void 0===r?void 0:r.uid)||a.multiFactorUid;Ve(i,e,"missing-multi-factor-info");const s={mfaPendingCredential:t.credential,mfaEnrollmentId:i,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}},o=en(e,s,"mfaSmsSignIn",(async(e,t)=>{if(t.phoneSignInInfo.captchaResponse===Xt){Ve((null===n||void 0===n?void 0:n.type)===nr,e,"argument-error");return tr(e,await ar(e,t,n))}return tr(e,t)}),"PHONE_PROVIDER");return(await o.catch((e=>Promise.reject(e)))).phoneResponseInfo.sessionInfo}}{const t={phoneNumber:a.phoneNumber,clientType:"CLIENT_TYPE_WEB"},r=en(e,t,"sendVerificationCode",(async(e,t)=>{if(t.captchaResponse===Xt){Ve((null===n||void 0===n?void 0:n.type)===nr,e,"argument-error");return hn(e,await ar(e,t,n))}return hn(e,t)}),"PHONE_PROVIDER");return(await r.catch((e=>Promise.reject(e)))).sessionInfo}}finally{null===n||void 0===n||n._reset()}}async function ar(e,t,n){Ve(n.type===nr,e,"argument-error");const r=await n.verify();Ve("string"===typeof r,e,"argument-error");const a=Object.assign({},t);if("phoneEnrollmentInfo"in a){const e=a.phoneEnrollmentInfo.phoneNumber,t=a.phoneEnrollmentInfo.captchaResponse,n=a.phoneEnrollmentInfo.clientType,i=a.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:r,captchaResponse:t,clientType:n,recaptchaVersion:i}}),a}if("phoneSignInInfo"in a){const e=a.phoneSignInInfo.captchaResponse,t=a.phoneSignInInfo.clientType,n=a.phoneSignInInfo.recaptchaVersion;return Object.assign(a,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:e,clientType:t,recaptchaVersion:n}}),a}return Object.assign(a,{recaptchaToken:r}),a}class ir{constructor(e){this.providerId=ir.PROVIDER_ID,this.auth=Ht(e)}verifyPhoneNumber(e,t){return rr(this.auth,e,(0,s.Ku)(t))}static credential(e,t){return pn._fromVerification(e,t)}static credentialFromResult(e){const t=e;return ir.credentialFromTaggedObject(t)}static credentialFromError(e){return ir.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:n,temporaryProof:r}=t;return n&&r?pn._fromTokenResponse(n,r):null}}function sr(e,t){return t?It(t):(Ve(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}ir.PROVIDER_ID="phone",ir.PHONE_SIGN_IN_METHOD="phone";class or extends sn{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return un(e,this._buildIdpRequest())}_linkToIdToken(e,t){return un(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return un(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function cr(e){return An(e.auth,new or(e),e.bypassAuthState)}function lr(e){const{auth:t,user:n}=e;return Ve(n,t,"internal-error"),_n(n,new or(e),e.bypassAuthState)}async function ur(e){const{auth:t,user:n}=e;return Ve(n,t,"internal-error"),Cn(n,new or(e),e.bypassAuthState)}class dr{constructor(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:a,error:i,type:s}=e;if(i)return void this.reject(i);const o={auth:this.auth,requestUri:t,sessionId:n,tenantId:a||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(s)(o))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return cr;case"linkViaPopup":case"linkViaRedirect":return ur;case"reauthViaPopup":case"reauthViaRedirect":return lr;default:Fe(this.auth,"internal-error")}}resolve(e){He(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){He(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const hr=new qe(2e3,1e4);class fr extends dr{constructor(e,t,n,r,a){super(e,t,r,a),this.provider=n,this.authWindow=null,this.pollId=null,fr.currentPopupAction&&fr.currentPopupAction.cancel(),fr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ve(e,this.auth,"internal-error"),e}async onExecution(){He(1===this.filter.length,"Popup operations only handle one event");const e=Bn();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(ze(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(ze(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,fr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(ze(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(e,hr.get())};e()}}fr.currentPopupAction=null;const pr=new Map;class gr extends dr{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=pr.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=yr(t),r=vr(e);if(!await r._isAvailable())return!1;const a="true"===await r._get(n);return await r._remove(n),a}(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}pr.set(this.auth._key(),e)}return this.bypassAuthState||pr.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function mr(e,t){pr.set(e._key(),t)}function vr(e){return It(e._redirectPersistence)}function yr(e){return _t("pendingRedirect",e.config.apiKey,e.name)}async function br(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if((0,r.xZ)(e.app))return Promise.reject(Ue(e));const a=Ht(e),i=sr(a,t),s=new gr(a,i,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await a._persistUserIfCurrent(o.user),await a._setRedirectUser(null,t)),o}class wr{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Er(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!Er(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(ze(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(xr(e))}saveEventToCache(e){this.cachedEventUids.add(xr(e)),this.lastProcessedEventTime=Date.now()}}function xr(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function Er(e){let{type:t,error:n}=e;return"unknown"===t&&"auth/no-auth-event"===(null===n||void 0===n?void 0:n.code)}const Tr=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Sr=/^https?/;async function Ir(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e){return tt(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(e);for(const r of t)try{if(kr(r))return}catch(n){}Fe(e,"unauthorized-domain")}function kr(e){const t=Ge(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const a=new URL(e);return""===a.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&a.hostname===r}if(!Sr.test(n))return!1;if(Tr.test(e))return r===e;const a=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(r)}const Cr=new qe(3e4,6e4);function _r(){const e=$n().___jsl;if(null===e||void 0===e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function Ar(e){return new Promise(((t,n)=>{var r,a,i;function s(){_r(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{_r(),n(ze(e,"network-request-failed"))},timeout:Cr.get()})}if(null===(a=null===(r=$n().gapi)||void 0===r?void 0:r.iframes)||void 0===a?void 0:a.Iframe)t(gapi.iframes.getContext());else{if(!(null===(i=$n().gapi)||void 0===i?void 0:i.load)){const t=qt("iframefcb");return $n()[t]=()=>{gapi.load?s():n(ze(e,"network-request-failed"))},Kt(`${Wt.gapiScript}?onload=${t}`).catch((e=>n(e)))}s()}})).catch((e=>{throw Nr=null,e}))}let Nr=null;const Rr=new qe(5e3,15e3),Or={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Dr=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Pr(e){const t=e.config;Ve(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?Ye(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,a={apiKey:t.apiKey,appName:e.name,v:r.MF},i=Dr.get(e.config.apiHost);i&&(a.eid=i);const o=e._getFrameworks();return o.length&&(a.fw=o.join(",")),`${n}?${(0,s.Am)(a).slice(1)}`}async function Lr(e){const t=await function(e){return Nr=Nr||Ar(e),Nr}(e),n=$n().gapi;return Ve(n,e,"internal-error"),t.open({where:document.body,url:Pr(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Or,dontclear:!0},(t=>new Promise((async(n,r)=>{await t.restyle({setHideOnLeave:!1});const a=ze(e,"network-request-failed"),i=$n().setTimeout((()=>{r(a)}),Rr.get());function s(){$n().clearTimeout(i),n(t)}t.ping(s).then(s,(()=>{r(a)}))}))))}const Mr={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Fr{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function zr(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const i=Math.max((window.screen.availHeight-a)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const l=Object.assign(Object.assign({},Mr),{width:r.toString(),height:a.toString(),top:i,left:o}),u=(0,s.ZQ)().toLowerCase();n&&(c=Dt(u)?"_blank":n),Rt(u)&&(t=t||"http://localhost",l.scrollbars="yes");const d=Object.entries(l).reduce(((e,t)=>{let[n,r]=t;return`${e}${n}=${r},`}),"");if(function(){var e;return zt(arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,s.ZQ)())&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(u)&&"_self"!==c)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",c),new Fr(null);const h=window.open(t||"",c,d);Ve(h,e,"popup-blocked");try{h.focus()}catch(f){}return new Fr(h)}const jr="__/auth/handler",Ur="emulator/auth/handler",Br=encodeURIComponent("fac");async function Vr(e,t,n,a,i,o){Ve(e.config.authDomain,e,"auth-domain-config-required"),Ve(e.config.apiKey,e,"invalid-api-key");const c={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:a,v:r.MF,eventId:i};if(t instanceof vn){t.setDefaultLanguage(e.languageCode),c.providerId=t.providerId||"",(0,s.Im)(t.getCustomParameters())||(c.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(o||{}))c[e]=t}if(t instanceof yn){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(c.scopes=e.join(","))}e.tenantId&&(c.tid=e.tenantId);const l=c;for(const r of Object.keys(l))void 0===l[r]&&delete l[r];const u=await e._getAppCheckToken(),d=u?`#${Br}=${encodeURIComponent(u)}`:"";return`${function(e){let{config:t}=e;if(!t.emulator)return`https://${t.authDomain}/${jr}`;return Ye(t,Ur)}(e)}?${(0,s.Am)(l).slice(1)}${d}`}const $r="webStorageSupport";const Hr=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=jn,this._completeRedirectFn=br,this._overrideRedirectResult=mr}async _openPopup(e,t,n,r){var a;He(null===(a=this.eventManagers[e._key()])||void 0===a?void 0:a.manager,"_initialize() not called before _openPopup()");return zr(e,await Vr(e,t,n,Ge(),r),Bn())}async _openRedirect(e,t,n,r){await this._originValidation(e);return function(e){$n().location.href=e}(await Vr(e,t,n,Ge(),r)),new Promise((()=>{}))}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(He(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await Lr(e),n=new wr(e);return t.register("authEvent",(t=>{Ve(null===t||void 0===t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send($r,{type:$r},(n=>{var r;const a=null===(r=null===n||void 0===n?void 0:n[0])||void 0===r?void 0:r[$r];void 0!==a&&t(!!a),Fe(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Ir(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return jt()||Ot()||zt()}};var Gr="@firebase/auth",Wr="1.10.0";class Kr{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ve(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const qr=(0,s.XA)("authIdTokenMaxAge")||300;let Yr=null;var Qr;Wt={loadJS:e=>new Promise(((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=ze("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)})),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},Qr="Browser",(0,r.om)(new o.uA("auth",((e,t)=>{let{options:n}=t;const r=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:s,authDomain:o}=r.options;Ve(s&&!s.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:s,authDomain:o,clientPlatform:Qr,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Ut(Qr)},l=new $t(r,a,i,c);return function(e,t){const n=(null===t||void 0===t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(It);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null===t||void 0===t?void 0:t.popupRedirectResolver)}(l,n),l}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),(0,r.om)(new o.uA("auth-internal",(e=>(e=>new Kr(e))(Ht(e.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),(0,r.KO)(Gr,Wr,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(Qr)),(0,r.KO)(Gr,Wr,"esm2017");const Xr=(0,r.Wp)({apiKey:"AIzaSyDo7X1BLIW1hNYQpJLZcDws_L4aGHJWXOQ",authDomain:"asignacion-plazas.firebaseapp.com",projectId:"asignacion-plazas",storageBucket:"asignacion-plazas.firebasestorage.app",messagingSenderId:"525955676079",appId:"1:525955676079:web:a7e0b00391e75c902fe15a",measurementId:"G-E0DLWYPVKP"}),Jr=(0,a.aU)(Xr);!function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.Sx)();const t=(0,r.j6)(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=(0,r.j6)(e,"auth");if(n.isInitialized()){const e=n.getImmediate(),r=n.getOptions();if((0,s.bD)(r,null!==t&&void 0!==t?t:{}))return e;Fe(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:Hr,persistence:[er,Pn,jn]}),a=(0,s.XA)("authTokenSyncURL");if(a&&"boolean"===typeof isSecureContext&&isSecureContext){const e=new URL(a,location.origin);if(location.origin===e.origin){const t=(i=e.toString(),async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>qr)return;const r=null===t||void 0===t?void 0:t.token;Yr!==r&&(Yr=r,await fetch(i,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))});!function(e,t,n){(0,s.Ku)(e).beforeAuthStateChanged(t,n)}(n,t,(()=>t(n.currentUser))),function(e,t,n,r){(0,s.Ku)(e).onIdTokenChanged(t,n,r)}(n,(e=>t(e)))}}var i;const o=(0,s.Tj)("auth");o&&nn(n,`http://${o}`)}(Xr);try{(0,a.ol)(Jr).catch((e=>{"failed-precondition"===e.code||e.code}))}catch(Zr){}},234:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,a=e[r];if(!(0<i(a,t)))break e;e[r]=t,e[n]=a,n=r}}function r(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length,s=a>>>1;r<s;){var o=2*(r+1)-1,c=e[o],l=o+1,u=e[l];if(0>i(c,n))l<a&&0>i(u,c)?(e[r]=u,e[l]=n,r=l):(e[r]=c,e[o]=n,r=o);else{if(!(l<a&&0>i(u,n)))break e;e[r]=u,e[l]=n,r=l}}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,c=o.now();t.unstable_now=function(){return o.now()-c}}var l=[],u=[],d=1,h=null,f=3,p=!1,g=!1,m=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=r(u);null!==t;){if(null===t.callback)a(u);else{if(!(t.startTime<=e))break;a(u),t.sortIndex=t.expirationTime,n(l,t)}t=r(u)}}function x(e){if(m=!1,w(e),!g)if(null!==r(l))g=!0,D(E);else{var t=r(u);null!==t&&P(x,t.startTime-e)}}function E(e,n){g=!1,m&&(m=!1,y(k),k=-1),p=!0;var i=f;try{for(w(n),h=r(l);null!==h&&(!(h.expirationTime>n)||e&&!A());){var s=h.callback;if("function"===typeof s){h.callback=null,f=h.priorityLevel;var o=s(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof o?h.callback=o:h===r(l)&&a(l),w(n)}else a(l);h=r(l)}if(null!==h)var c=!0;else{var d=r(u);null!==d&&P(x,d.startTime-n),c=!1}return c}finally{h=null,f=i,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var T,S=!1,I=null,k=-1,C=5,_=-1;function A(){return!(t.unstable_now()-_<C)}function N(){if(null!==I){var e=t.unstable_now();_=e;var n=!0;try{n=I(!0,e)}finally{n?T():(S=!1,I=null)}}else S=!1}if("function"===typeof b)T=function(){b(N)};else if("undefined"!==typeof MessageChannel){var R=new MessageChannel,O=R.port2;R.port1.onmessage=N,T=function(){O.postMessage(null)}}else T=function(){v(N,0)};function D(e){I=e,S||(S=!0,T())}function P(e,n){k=v((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){g||p||(g=!0,D(E))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,a,i){var s=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?s+i:s:i=s,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:d++,callback:a,priorityLevel:e,startTime:i,expirationTime:o=i+o,sortIndex:-1},i>s?(e.sortIndex=i,n(u,e),null===r(l)&&e===r(u)&&(m?(y(k),k=-1):m=!0,P(x,i-s))):(e.sortIndex=o,n(l,e),g||p||(g=!0,D(E))),e},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},391:(e,t,n)=>{var r=n(950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},443:(e,t,n)=>{n.d(t,{$b:()=>a,Vy:()=>l});const r=[];var a;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(a||(a={}));const i={debug:a.DEBUG,verbose:a.VERBOSE,info:a.INFO,warn:a.WARN,error:a.ERROR,silent:a.SILENT},s=a.INFO,o={[a.DEBUG]:"log",[a.VERBOSE]:"log",[a.INFO]:"info",[a.WARN]:"warn",[a.ERROR]:"error"},c=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=o[t];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);for(var a=arguments.length,i=new Array(a>2?a-2:0),s=2;s<a;s++)i[s-2]=arguments[s];console[r](`[${n}]  ${e.name}:`,...i)};class l{constructor(e){this.name=e,this._logLevel=s,this._logHandler=c,this._userLogHandler=null,r.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in a))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?i[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,a.DEBUG,...t),this._logHandler(this,a.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,a.VERBOSE,...t),this._logHandler(this,a.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,a.INFO,...t),this._logHandler(this,a.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,a.WARN,...t),this._logHandler(this,a.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,a.ERROR,...t),this._logHandler(this,a.ERROR,...t)}}},472:(e,t,n)=>{n.d(t,{gS:()=>Gd,rJ:()=>Pu,kd:()=>Hd,H9:()=>Lu,ol:()=>$u,GG:()=>Bd,aU:()=>Uu,AB:()=>Ad,aQ:()=>Wd,P:()=>Sd,O5:()=>Xd,BN:()=>Vd,mZ:()=>$d,_M:()=>kd,wP:()=>Jd});var r,a,i=n(52),s=n(812),o=n(443),c=n(529),l="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},u={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(e,t,n){n||(n=0);var r=Array(16);if("string"===typeof t)for(var a=0;16>a;++a)r[a]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(a=0;16>a;++a)r[a]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],a=e.g[2];var i=e.g[3],s=t+(i^n&(a^i))+r[0]+3614090360&4294967295;s=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=n+(s<<7&4294967295|s>>>25))+((s=i+(a^t&(n^a))+r[1]+3905402710&4294967295)<<12&4294967295|s>>>20))+((s=a+(n^i&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^a&(i^t))+r[3]+3250441966&4294967295)<<22&4294967295|s>>>10))+((s=t+(i^n&(a^i))+r[4]+4118548399&4294967295)<<7&4294967295|s>>>25))+((s=i+(a^t&(n^a))+r[5]+1200080426&4294967295)<<12&4294967295|s>>>20))+((s=a+(n^i&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^a&(i^t))+r[7]+4249261313&4294967295)<<22&4294967295|s>>>10))+((s=t+(i^n&(a^i))+r[8]+1770035416&4294967295)<<7&4294967295|s>>>25))+((s=i+(a^t&(n^a))+r[9]+2336552879&4294967295)<<12&4294967295|s>>>20))+((s=a+(n^i&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^a&(i^t))+r[11]+2304563134&4294967295)<<22&4294967295|s>>>10))+((s=t+(i^n&(a^i))+r[12]+1804603682&4294967295)<<7&4294967295|s>>>25))+((s=i+(a^t&(n^a))+r[13]+4254626195&4294967295)<<12&4294967295|s>>>20))+((s=a+(n^i&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^a&(i^t))+r[15]+1236535329&4294967295)<<22&4294967295|s>>>10))+((s=t+(a^i&(n^a))+r[1]+4129170786&4294967295)<<5&4294967295|s>>>27))+((s=i+(n^a&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|s>>>23))+((s=a+(t^n&(i^t))+r[11]+643717713&4294967295)<<14&4294967295|s>>>18))+((s=n+(i^t&(a^i))+r[0]+3921069994&4294967295)<<20&4294967295|s>>>12))+((s=t+(a^i&(n^a))+r[5]+3593408605&4294967295)<<5&4294967295|s>>>27))+((s=i+(n^a&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|s>>>23))+((s=a+(t^n&(i^t))+r[15]+3634488961&4294967295)<<14&4294967295|s>>>18))+((s=n+(i^t&(a^i))+r[4]+3889429448&4294967295)<<20&4294967295|s>>>12))+((s=t+(a^i&(n^a))+r[9]+568446438&4294967295)<<5&4294967295|s>>>27))+((s=i+(n^a&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|s>>>23))+((s=a+(t^n&(i^t))+r[3]+4107603335&4294967295)<<14&4294967295|s>>>18))+((s=n+(i^t&(a^i))+r[8]+1163531501&4294967295)<<20&4294967295|s>>>12))+((s=t+(a^i&(n^a))+r[13]+2850285829&4294967295)<<5&4294967295|s>>>27))+((s=i+(n^a&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|s>>>23))+((s=a+(t^n&(i^t))+r[7]+1735328473&4294967295)<<14&4294967295|s>>>18))+((s=n+(i^t&(a^i))+r[12]+2368359562&4294967295)<<20&4294967295|s>>>12))+((s=t+(n^a^i)+r[5]+4294588738&4294967295)<<4&4294967295|s>>>28))+((s=i+(t^n^a)+r[8]+2272392833&4294967295)<<11&4294967295|s>>>21))+((s=a+(i^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|s>>>16))+((s=n+(a^i^t)+r[14]+4259657740&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^a^i)+r[1]+2763975236&4294967295)<<4&4294967295|s>>>28))+((s=i+(t^n^a)+r[4]+1272893353&4294967295)<<11&4294967295|s>>>21))+((s=a+(i^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|s>>>16))+((s=n+(a^i^t)+r[10]+3200236656&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^a^i)+r[13]+681279174&4294967295)<<4&4294967295|s>>>28))+((s=i+(t^n^a)+r[0]+3936430074&4294967295)<<11&4294967295|s>>>21))+((s=a+(i^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|s>>>16))+((s=n+(a^i^t)+r[6]+76029189&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^a^i)+r[9]+3654602809&4294967295)<<4&4294967295|s>>>28))+((s=i+(t^n^a)+r[12]+3873151461&4294967295)<<11&4294967295|s>>>21))+((s=a+(i^t^n)+r[15]+530742520&4294967295)<<16&4294967295|s>>>16))+((s=n+(a^i^t)+r[2]+3299628645&4294967295)<<23&4294967295|s>>>9))+((s=t+(a^(n|~i))+r[0]+4096336452&4294967295)<<6&4294967295|s>>>26))+((s=i+(n^(t|~a))+r[7]+1126891415&4294967295)<<10&4294967295|s>>>22))+((s=a+(t^(i|~n))+r[14]+2878612391&4294967295)<<15&4294967295|s>>>17))+((s=n+(i^(a|~t))+r[5]+4237533241&4294967295)<<21&4294967295|s>>>11))+((s=t+(a^(n|~i))+r[12]+1700485571&4294967295)<<6&4294967295|s>>>26))+((s=i+(n^(t|~a))+r[3]+2399980690&4294967295)<<10&4294967295|s>>>22))+((s=a+(t^(i|~n))+r[10]+4293915773&4294967295)<<15&4294967295|s>>>17))+((s=n+(i^(a|~t))+r[1]+2240044497&4294967295)<<21&4294967295|s>>>11))+((s=t+(a^(n|~i))+r[8]+1873313359&4294967295)<<6&4294967295|s>>>26))+((s=i+(n^(t|~a))+r[15]+4264355552&4294967295)<<10&4294967295|s>>>22))+((s=a+(t^(i|~n))+r[6]+2734768916&4294967295)<<15&4294967295|s>>>17))+((s=n+(i^(a|~t))+r[13]+1309151649&4294967295)<<21&4294967295|s>>>11))+((i=(t=n+((s=t+(a^(n|~i))+r[4]+4149444226&4294967295)<<6&4294967295|s>>>26))+((s=i+(n^(t|~a))+r[11]+3174756917&4294967295)<<10&4294967295|s>>>22))^((a=i+((s=a+(t^(i|~n))+r[2]+718787259&4294967295)<<15&4294967295|s>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(a+(s<<21&4294967295|s>>>11))&4294967295,e.g[2]=e.g[2]+a&4294967295,e.g[3]=e.g[3]+i&4294967295}function i(e,t){this.h=t;for(var n=[],r=!0,a=e.length-1;0<=a;a--){var i=0|e[a];r&&i==t||(n[a]=i,r=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.D=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.C=function(e,n,r){for(var a=Array(arguments.length-2),i=2;i<arguments.length;i++)a[i-2]=arguments[i];return t.prototype[n].apply(e,a)}}(t,(function(){this.blockSize=-1})),t.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var r=t-this.blockSize,a=this.B,i=this.h,s=0;s<t;){if(0==i)for(;s<=r;)n(this,e,s),s+=this.blockSize;if("string"===typeof e){for(;s<t;)if(a[i++]=e.charCodeAt(s++),i==this.blockSize){n(this,a),i=0;break}}else for(;s<t;)if(a[i++]=e[s++],i==this.blockSize){n(this,a),i=0;break}}this.h=i,this.o+=t},t.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.u(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var s={};function o(e){return-128<=e&&128>e?function(e,t){var n=s;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,(function(e){return new i([0|e],0>e?-1:0)})):new i([0|e],0>e?-1:0)}function c(e){if(isNaN(e)||!isFinite(e))return l;if(0>e)return g(c(-e));for(var t=[],n=1,r=0;e>=n;r++)t[r]=e/n|0,n*=4294967296;return new i(t,0)}var l=o(0),d=o(1),h=o(16777216);function f(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function p(e){return-1==e.h}function g(e){for(var t=e.g.length,n=[],r=0;r<t;r++)n[r]=~e.g[r];return new i(n,~e.h).add(d)}function m(e,t){return e.add(g(t))}function v(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function y(e,t){this.g=e,this.h=t}function b(e,t){if(f(t))throw Error("division by zero");if(f(e))return new y(l,l);if(p(e))return t=b(g(e),t),new y(g(t.g),g(t.h));if(p(t))return t=b(e,g(t)),new y(g(t.g),t.h);if(30<e.g.length){if(p(e)||p(t))throw Error("slowDivide_ only works with positive integers.");for(var n=d,r=t;0>=r.l(e);)n=w(n),r=w(r);var a=x(n,1),i=x(r,1);for(r=x(r,2),n=x(n,2);!f(r);){var s=i.add(r);0>=s.l(e)&&(a=a.add(n),i=s),r=x(r,1),n=x(n,1)}return t=m(e,a.j(t)),new y(a,t)}for(a=l;0<=e.l(t);){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),s=(i=c(n)).j(t);p(s)||0<s.l(e);)s=(i=c(n-=r)).j(t);f(i)&&(i=d),a=a.add(i),e=m(e,s)}return new y(a,e)}function w(e){for(var t=e.g.length+1,n=[],r=0;r<t;r++)n[r]=e.i(r)<<1|e.i(r-1)>>>31;return new i(n,e.h)}function x(e,t){var n=t>>5;t%=32;for(var r=e.g.length-n,a=[],s=0;s<r;s++)a[s]=0<t?e.i(s+n)>>>t|e.i(s+n+1)<<32-t:e.i(s+n);return new i(a,e.h)}(e=i.prototype).m=function(){if(p(this))return-g(this).m();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.i(n);e+=(0<=r?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(f(this))return"0";if(p(this))return"-"+g(this).toString(e);for(var t=c(Math.pow(e,6)),n=this,r="";;){var a=b(n,t).g,i=((0<(n=m(n,a.j(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(f(n=a))return i+r;for(;6>i.length;)i="0"+i;r=i+r}},e.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return p(e=m(this,e))?-1:f(e)?0:1},e.abs=function(){return p(this)?g(this):this},e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0,a=0;a<=t;a++){var s=r+(65535&this.i(a))+(65535&e.i(a)),o=(s>>>16)+(this.i(a)>>>16)+(e.i(a)>>>16);r=o>>>16,s&=65535,o&=65535,n[a]=o<<16|s}return new i(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(f(this)||f(e))return l;if(p(this))return p(e)?g(this).j(g(e)):g(g(this).j(e));if(p(e))return g(this.j(g(e)));if(0>this.l(h)&&0>e.l(h))return c(this.m()*e.m());for(var t=this.g.length+e.g.length,n=[],r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var a=0;a<e.g.length;a++){var s=this.i(r)>>>16,o=65535&this.i(r),u=e.i(a)>>>16,d=65535&e.i(a);n[2*r+2*a]+=o*d,v(n,2*r+2*a),n[2*r+2*a+1]+=s*d,v(n,2*r+2*a+1),n[2*r+2*a+1]+=o*u,v(n,2*r+2*a+1),n[2*r+2*a+2]+=s*u,v(n,2*r+2*a+2)}for(r=0;r<t;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=t;r<2*t;r++)n[r]=0;return new i(n,0)},e.A=function(e){return b(this,e).h},e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)&e.i(r);return new i(n,this.h&e.h)},e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)|e.i(r);return new i(n,this.h|e.h)},e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)^e.i(r);return new i(n,this.h^e.h)},t.prototype.digest=t.prototype.v,t.prototype.reset=t.prototype.s,t.prototype.update=t.prototype.u,a=u.Md5=t,i.prototype.add=i.prototype.add,i.prototype.multiply=i.prototype.j,i.prototype.modulo=i.prototype.A,i.prototype.compare=i.prototype.l,i.prototype.toNumber=i.prototype.m,i.prototype.toString=i.prototype.toString,i.prototype.getBits=i.prototype.i,i.fromNumber=c,i.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return g(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=c(Math.pow(n,8)),a=l,i=0;i<t.length;i+=8){var s=Math.min(8,t.length-i),o=parseInt(t.substring(i,i+s),n);8>s?(s=c(Math.pow(n,s)),a=a.j(s).add(c(o))):a=(a=a.j(r)).add(c(o))}return a},r=u.Integer=i}).apply("undefined"!==typeof l?l:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var d,h,f,p,g,m,v,y,b="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},w={};(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof b&&b];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(e,r){if(r)e:{var a=n;e=e.split(".");for(var i=0;i<e.length-1;i++){var s=e[i];if(!(s in a))break e;a=a[s]}(r=r(i=a[e=e[e.length-1]]))!=i&&null!=r&&t(a,e,{configurable:!0,writable:!0,value:r})}}("Array.prototype.values",(function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,a={next:function(){if(!r&&n<e.length){var a=n++;return{value:t(a,e[a]),done:!1}}return r=!0,{done:!0,value:void 0}}};return a[Symbol.iterator]=function(){return a},a}(this,(function(e,t){return t}))}}));var r=r||{},a=this||self;function i(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function s(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function o(e,t,n){return e.call.apply(e.bind,arguments)}function c(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function l(e,t,n){return(l=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?o:c).apply(null,arguments)}function u(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function x(e,t){function n(){}n.prototype=t.prototype,e.aa=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Qb=function(e,n,r){for(var a=Array(arguments.length-2),i=2;i<arguments.length;i++)a[i-2]=arguments[i];return t.prototype[n].apply(e,a)}}function T(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function S(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(i(t)){const n=e.length||0,r=t.length||0;e.length=n+r;for(let a=0;a<r;a++)e[n+a]=t[a]}else e.push(t)}}function I(e){return/^[\s\xa0]*$/.test(e)}function k(){var e=a.navigator;return e&&(e=e.userAgent)?e:""}function C(e){return C[" "](e),e}C[" "]=function(){};var _=-1!=k().indexOf("Gecko")&&!(-1!=k().toLowerCase().indexOf("webkit")&&-1==k().indexOf("Edge"))&&!(-1!=k().indexOf("Trident")||-1!=k().indexOf("MSIE"))&&-1==k().indexOf("Edge");function A(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function N(e){const t={};for(const n in e)t[n]=e[n];return t}const R="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function O(e,t){let n,r;for(let a=1;a<arguments.length;a++){for(n in r=arguments[a],r)e[n]=r[n];for(let t=0;t<R.length;t++)n=R[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function D(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function P(e){a.setTimeout((()=>{throw e}),0)}function L(){var e=U;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var M=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new F),(e=>e.reset()));class F{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let z,j=!1,U=new class{constructor(){this.h=this.g=null}add(e,t){const n=M.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},B=()=>{const e=a.Promise.resolve(void 0);z=()=>{e.then(V)}};var V=()=>{for(var e;e=L();){try{e.h.call(e.g)}catch(n){P(n)}var t=M;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}j=!1};function $(){this.s=this.s,this.C=this.C}function H(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}$.prototype.s=!1,$.prototype.ma=function(){this.s||(this.s=!0,this.N())},$.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},H.prototype.h=function(){this.defaultPrevented=!0};var G=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};a.addEventListener("test",e,t),a.removeEventListener("test",e,t)}catch(n){}return e}();function W(e,t){if(H.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(_){e:{try{C(t.nodeName);var a=!0;break e}catch(i){}a=!1}a||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:K[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&W.aa.h.call(this)}}x(W,H);var K={2:"touch",3:"pen",4:"mouse"};W.prototype.h=function(){W.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var q="closure_listenable_"+(1e6*Math.random()|0),Y=0;function Q(e,t,n,r,a){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=a,this.key=++Y,this.da=this.fa=!1}function X(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function J(e){this.src=e,this.g={},this.h=0}function Z(e,t){var n=t.type;if(n in e.g){var r,a=e.g[n],i=Array.prototype.indexOf.call(a,t,void 0);(r=0<=i)&&Array.prototype.splice.call(a,i,1),r&&(X(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function ee(e,t,n,r){for(var a=0;a<e.length;++a){var i=e[a];if(!i.da&&i.listener==t&&i.capture==!!n&&i.ha==r)return a}return-1}J.prototype.add=function(e,t,n,r,a){var i=e.toString();(e=this.g[i])||(e=this.g[i]=[],this.h++);var s=ee(e,t,r,a);return-1<s?(t=e[s],n||(t.fa=!1)):((t=new Q(t,this.src,i,!!r,a)).fa=n,e.push(t)),t};var te="closure_lm_"+(1e6*Math.random()|0),ne={};function re(e,t,n,r,a){if(r&&r.once)return ie(e,t,n,r,a);if(Array.isArray(t)){for(var i=0;i<t.length;i++)re(e,t[i],n,r,a);return null}return n=he(n),e&&e[q]?e.K(t,n,s(r)?!!r.capture:!!r,a):ae(e,t,n,!1,r,a)}function ae(e,t,n,r,a,i){if(!t)throw Error("Invalid event type");var o=s(a)?!!a.capture:!!a,c=ue(e);if(c||(e[te]=c=new J(e)),(n=c.add(t,n,r,o,i)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=le;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)G||(a=o),void 0===a&&(a=!1),e.addEventListener(t.toString(),r,a);else if(e.attachEvent)e.attachEvent(ce(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function ie(e,t,n,r,a){if(Array.isArray(t)){for(var i=0;i<t.length;i++)ie(e,t[i],n,r,a);return null}return n=he(n),e&&e[q]?e.L(t,n,s(r)?!!r.capture:!!r,a):ae(e,t,n,!0,r,a)}function se(e,t,n,r,a){if(Array.isArray(t))for(var i=0;i<t.length;i++)se(e,t[i],n,r,a);else r=s(r)?!!r.capture:!!r,n=he(n),e&&e[q]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=ee(i=e.g[t],n,r,a))&&(X(i[n]),Array.prototype.splice.call(i,n,1),0==i.length&&(delete e.g[t],e.h--)))):e&&(e=ue(e))&&(t=e.g[t.toString()],e=-1,t&&(e=ee(t,n,r,a)),(n=-1<e?t[e]:null)&&oe(n))}function oe(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[q])Z(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(ce(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=ue(t))?(Z(n,e),0==n.h&&(n.src=null,t[te]=null)):X(e)}}}function ce(e){return e in ne?ne[e]:ne[e]="on"+e}function le(e,t){if(e.da)e=!0;else{t=new W(t,this);var n=e.listener,r=e.ha||e.src;e.fa&&oe(e),e=n.call(r,t)}return e}function ue(e){return(e=e[te])instanceof J?e:null}var de="__closure_events_fn_"+(1e9*Math.random()>>>0);function he(e){return"function"===typeof e?e:(e[de]||(e[de]=function(t){return e.handleEvent(t)}),e[de])}function fe(){$.call(this),this.i=new J(this),this.M=this,this.F=null}function pe(e,t){var n,r=e.F;if(r)for(n=[];r;r=r.F)n.push(r);if(e=e.M,r=t.type||t,"string"===typeof t)t=new H(t,e);else if(t instanceof H)t.target=t.target||e;else{var a=t;O(t=new H(r,e),a)}if(a=!0,n)for(var i=n.length-1;0<=i;i--){var s=t.g=n[i];a=ge(s,r,!0,t)&&a}if(a=ge(s=t.g=e,r,!0,t)&&a,a=ge(s,r,!1,t)&&a,n)for(i=0;i<n.length;i++)a=ge(s=t.g=n[i],r,!1,t)&&a}function ge(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var a=!0,i=0;i<t.length;++i){var s=t[i];if(s&&!s.da&&s.capture==n){var o=s.listener,c=s.ha||s.src;s.fa&&Z(e.i,s),a=!1!==o.call(c,r)&&a}}return a&&!r.defaultPrevented}function me(e,t,n){if("function"===typeof e)n&&(e=l(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=l(e.handleEvent,e)}return 2147483647<Number(t)?-1:a.setTimeout(e,t||0)}function ve(e){e.g=me((()=>{e.g=null,e.i&&(e.i=!1,ve(e))}),e.l);const t=e.h;e.h=null,e.m.apply(null,t)}x(fe,$),fe.prototype[q]=!0,fe.prototype.removeEventListener=function(e,t,n,r){se(this,e,t,n,r)},fe.prototype.N=function(){if(fe.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)X(n[r]);delete t.g[e],t.h--}}this.F=null},fe.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},fe.prototype.L=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};class ye extends ${constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:ve(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function be(e){$.call(this),this.h=e,this.g={}}x(be,$);var we=[];function xe(e){A(e.g,(function(e,t){this.g.hasOwnProperty(t)&&oe(e)}),e),e.g={}}be.prototype.N=function(){be.aa.N.call(this),xe(this)},be.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ee=a.JSON.stringify,Te=a.JSON.parse,Se=class{stringify(e){return a.JSON.stringify(e,void 0)}parse(e){return a.JSON.parse(e,void 0)}};function Ie(){}function ke(e){return e.h||(e.h=e.i())}function Ce(){}Ie.prototype.h=null;var _e={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ae(){H.call(this,"d")}function Ne(){H.call(this,"c")}x(Ae,H),x(Ne,H);var Re={},Oe=null;function De(){return Oe=Oe||new fe}function Pe(e){H.call(this,Re.La,e)}function Le(e){const t=De();pe(t,new Pe(t))}function Me(e,t){H.call(this,Re.STAT_EVENT,e),this.stat=t}function Fe(e){const t=De();pe(t,new Me(t,e))}function ze(e,t){H.call(this,Re.Ma,e),this.size=t}function je(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return a.setTimeout((function(){e()}),t)}function Ue(){this.g=!0}function Be(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var a=r[1];if(Array.isArray(a)&&!(1>a.length)){var i=a[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(var s=1;s<a.length;s++)a[s]=""}}}return Ee(n)}catch(o){return t}}(e,n)+(r?" "+r:"")}))}Re.La="serverreachability",x(Pe,H),Re.STAT_EVENT="statevent",x(Me,H),Re.Ma="timingevent",x(ze,H),Ue.prototype.xa=function(){this.g=!1},Ue.prototype.info=function(){};var Ve,$e={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},He={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function Ge(){}function We(e,t,n,r){this.j=e,this.i=t,this.l=n,this.R=r||1,this.U=new be(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Ke}function Ke(){this.i=null,this.g="",this.h=!1}x(Ge,Ie),Ge.prototype.g=function(){return new XMLHttpRequest},Ge.prototype.i=function(){return{}},Ve=new Ge;var qe={},Ye={};function Qe(e,t,n){e.L=1,e.v=Et(vt(t)),e.m=n,e.P=!0,Xe(e,null)}function Xe(e,t){e.F=Date.now(),et(e),e.A=vt(e.v);var n=e.A,r=e.R;Array.isArray(r)||(r=[String(r)]),Mt(n.i,"t",r),e.C=0,n=e.j.J,e.h=new Ke,e.g=Sn(e.j,n?t:null,!e.m),0<e.O&&(e.M=new ye(l(e.Y,e,e.g),e.O)),t=e.U,n=e.g,r=e.ca;var a="readystatechange";Array.isArray(a)||(a&&(we[0]=a.toString()),a=we);for(var i=0;i<a.length;i++){var s=re(n,a[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}t=e.H?N(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),Le(),function(e,t,n,r,a,i){e.info((function(){if(e.g)if(i)for(var s="",o=i.split("&"),c=0;c<o.length;c++){var l=o[c].split("=");if(1<l.length){var u=l[0];l=l[1];var d=u.split("_");s=2<=d.length&&"type"==d[1]?s+(u+"=")+l+"&":s+(u+"=redacted&")}}else s=null;else s=i;return"XMLHTTP REQ ("+r+") [attempt "+a+"]: "+t+"\n"+n+"\n"+s}))}(e.i,e.u,e.A,e.l,e.R,e.m)}function Je(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.j.Ca)}function Ze(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Ye:(n=Number(t.substring(n,r)),isNaN(n)?qe:(r+=1)+n>t.length?Ye:(t=t.slice(r,r+n),e.C=r+n,t))}function et(e){e.S=Date.now()+e.I,tt(e,e.I)}function tt(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=je(l(e.ba,e),t)}function nt(e){e.B&&(a.clearTimeout(e.B),e.B=null)}function rt(e){0==e.j.G||e.J||bn(e.j,e)}function at(e){nt(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,xe(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function it(e,t){try{var n=e.j;if(0!=n.G&&(n.g==e||ut(n.h,e)))if(!e.K&&ut(n.h,e)&&3==n.G){try{var r=n.Da.g.parse(t)}catch(u){r=null}if(Array.isArray(r)&&3==r.length){var a=r;if(0==a[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;yn(n),cn(n)}gn(n),Fe(18)}}else n.za=a[1],0<n.za-n.T&&37500>a[2]&&n.F&&0==n.v&&!n.C&&(n.C=je(l(n.Za,n),6e3));if(1>=lt(n.h)&&n.ca){try{n.ca()}catch(u){}n.ca=void 0}}else xn(n,11)}else if((e.K||n.g==e)&&yn(n),!I(t))for(a=n.Da.g.parse(t),t=0;t<a.length;t++){let l=a[t];if(n.T=l[0],l=l[1],2==n.G)if("c"==l[0]){n.K=l[1],n.ia=l[2];const t=l[3];null!=t&&(n.la=t,n.j.info("VER="+n.la));const a=l[4];null!=a&&(n.Aa=a,n.j.info("SVER="+n.Aa));const u=l[5];null!=u&&"number"===typeof u&&0<u&&(r=1.5*u,n.L=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const d=e.g;if(d){const e=d.g?d.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var i=r.h;i.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(i.j=i.l,i.g=new Set,i.h&&(dt(i,i.h),i.h=null))}if(r.D){const e=d.g?d.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.ya=e,xt(r.I,r.D,e))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-e.F,n.j.info("Handshake RTT: "+n.R+"ms"));var s=e;if((r=n).qa=Tn(r,r.J?r.ia:null,r.W),s.K){ht(r.h,s);var o=s,c=r.L;c&&(o.I=c),o.B&&(nt(o),et(o)),r.g=s}else pn(r);0<n.i.length&&un(n)}else"stop"!=l[0]&&"close"!=l[0]||xn(n,7);else 3==n.G&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?xn(n,7):on(n):"noop"!=l[0]&&n.l&&n.l.ta(l),n.v=0)}Le()}catch(u){}}We.prototype.ca=function(e){e=e.target;const t=this.M;t&&3==nn(e)?t.j():this.Y(e)},We.prototype.Y=function(e){try{if(e==this.g)e:{const h=nn(this.g);var t=this.g.Ba();this.g.Z();if(!(3>h)&&(3!=h||this.g&&(this.h.h||this.g.oa()||rn(this.g)))){this.J||4!=h||7==t||Le(),nt(this);var n=this.g.Z();this.X=n;t:if(Je(this)){var r=rn(this.g);e="";var i=r.length,s=4==nn(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){at(this),rt(this);var o="";break t}this.h.i=new a.TextDecoder}for(t=0;t<i;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:!(s&&t==i-1)});r.length=0,this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.oa();if(this.o=200==n,function(e,t,n,r,a,i,s){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+a+"]: "+t+"\n"+n+"\n"+i+" "+s}))}(this.i,this.u,this.A,this.l,this.R,h,n),this.o){if(this.T&&!this.K){t:{if(this.g){var c,l=this.g;if((c=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!I(c)){var u=c;break t}}u=null}if(!(n=u)){this.o=!1,this.s=3,Fe(12),at(this),rt(this);break e}Be(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,it(this,n)}if(this.P){let e;for(n=!0;!this.J&&this.C<o.length;){if(e=Ze(this,o),e==Ye){4==h&&(this.s=4,Fe(14),n=!1),Be(this.i,this.l,null,"[Incomplete Response]");break}if(e==qe){this.s=4,Fe(15),Be(this.i,this.l,o,"[Invalid Chunk]"),n=!1;break}Be(this.i,this.l,e,null),it(this,e)}if(Je(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=h||0!=o.length||this.h.h||(this.s=1,Fe(16),n=!1),this.o=this.o&&n,n){if(0<o.length&&!this.W){this.W=!0;var d=this.j;d.g==this&&d.ba&&!d.M&&(d.j.info("Great, no buffering proxy detected. Bytes received: "+o.length),mn(d),d.M=!0,Fe(11))}}else Be(this.i,this.l,o,"[Invalid Chunked Response]"),at(this),rt(this)}else Be(this.i,this.l,o,null),it(this,o);4==h&&at(this),this.o&&!this.J&&(4==h?bn(this.j,this):(this.o=!1,et(this)))}else(function(e){const t={};e=(e.g&&2<=nn(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(I(e[r]))continue;var n=D(e[r]);const a=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const i=t[a]||[];t[a]=i,i.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.s=3,Fe(12)):(this.s=0,Fe(13)),at(this),rt(this)}}}catch(h){}},We.prototype.cancel=function(){this.J=!0,at(this)},We.prototype.ba=function(){this.B=null;const e=Date.now();0<=e-this.S?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.i,this.A),2!=this.L&&(Le(),Fe(17)),at(this),this.s=2,rt(this)):tt(this,this.S-e)};var st=class{constructor(e,t){this.g=e,this.map=t}};function ot(e){this.l=e||10,a.PerformanceNavigationTiming?e=0<(e=a.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ct(e){return!!e.h||!!e.g&&e.g.size>=e.j}function lt(e){return e.h?1:e.g?e.g.size:0}function ut(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function dt(e,t){e.g?e.g.add(t):e.h=t}function ht(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function ft(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return T(e.i)}function pt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(i(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(i(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}(e),r=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(i(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),a=r.length,s=0;s<a;s++)t.call(void 0,r[s],n&&n[s],e)}ot.prototype.cancel=function(){if(this.i=ft(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var gt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function mt(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof mt){this.h=e.h,yt(this,e.j),this.o=e.o,this.g=e.g,bt(this,e.s),this.l=e.l;var t=e.i,n=new Ot;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),wt(this,n),this.m=e.m}else e&&(t=String(e).match(gt))?(this.h=!1,yt(this,t[1]||"",!0),this.o=Tt(t[2]||""),this.g=Tt(t[3]||"",!0),bt(this,t[4]),this.l=Tt(t[5]||"",!0),wt(this,t[6]||"",!0),this.m=Tt(t[7]||"")):(this.h=!1,this.i=new Ot(null,this.h))}function vt(e){return new mt(e)}function yt(e,t,n){e.j=n?Tt(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function bt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function wt(e,t,n){t instanceof Ot?(e.i=t,function(e,t){t&&!e.j&&(Dt(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(Pt(this,t),Mt(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=St(t,Nt)),e.i=new Ot(t,e.h))}function xt(e,t,n){e.i.set(t,n)}function Et(e){return xt(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function Tt(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function St(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,It),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function It(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}mt.prototype.toString=function(){var e=[],t=this.j;t&&e.push(St(t,Ct,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(St(t,Ct,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(St(n,"/"==n.charAt(0)?At:_t,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",St(n,Rt)),e.join("")};var kt,Ct=/[#\/\?@]/g,_t=/[#\?:]/g,At=/[#\?]/g,Nt=/[#\?@]/g,Rt=/#/g;function Ot(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Dt(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),a=null;if(0<=r){var i=e[n].substring(0,r);a=e[n].substring(r+1)}else i=e[n];t(i,a?decodeURIComponent(a.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function Pt(e,t){Dt(e),t=Ft(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Lt(e,t){return Dt(e),t=Ft(e,t),e.g.has(t)}function Mt(e,t,n){Pt(e,t),0<n.length&&(e.i=null,e.g.set(Ft(e,t),T(n)),e.h+=n.length)}function Ft(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function zt(e,t,n,r,a){try{a&&(a.onload=null,a.onerror=null,a.onabort=null,a.ontimeout=null),r(n)}catch(i){}}function jt(){this.g=new Se}function Ut(e,t,n){const r=n||"";try{pt(e,(function(e,n){let a=e;s(e)&&(a=Ee(e)),t.push(r+n+"="+encodeURIComponent(a))}))}catch(a){throw t.push(r+"type="+encodeURIComponent("_badmap")),a}}function Bt(e){this.l=e.Ub||null,this.j=e.eb||!1}function Vt(e,t){fe.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function $t(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function Ht(e){e.readyState=4,e.l=null,e.j=null,e.v=null,Gt(e)}function Gt(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Wt(e){let t="";return A(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function Kt(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Wt(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):xt(e,t,n))}function qt(e){fe.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(e=Ot.prototype).add=function(e,t){Dt(this),this.i=null,e=Ft(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){Dt(this),this.g.forEach((function(n,r){n.forEach((function(n){e.call(t,n,r,this)}),this)}),this)},e.na=function(){Dt(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const a=e[r];for(let e=0;e<a.length;e++)n.push(t[r])}return n},e.V=function(e){Dt(this);let t=[];if("string"===typeof e)Lt(this,e)&&(t=t.concat(this.g.get(Ft(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},e.set=function(e,t){return Dt(this),this.i=null,Lt(this,e=Ft(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const i=encodeURIComponent(String(r)),s=this.V(r);for(r=0;r<s.length;r++){var a=i;""!==s[r]&&(a+="="+encodeURIComponent(String(s[r]))),e.push(a)}}return this.i=e.join("&")},x(Bt,Ie),Bt.prototype.g=function(){return new Vt(this.l,this.j)},Bt.prototype.i=(kt={},function(){return kt}),x(Vt,fe),(e=Vt.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,Gt(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||a).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Ht(this)),this.readyState=0},e.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Gt(this)),this.g&&(this.readyState=3,Gt(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if("undefined"!==typeof a.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;$t(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},e.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Ht(this):Gt(this),3==this.readyState&&$t(this)}},e.Ra=function(e){this.g&&(this.response=this.responseText=e,Ht(this))},e.Qa=function(e){this.g&&(this.response=e,Ht(this))},e.ga=function(){this.g&&Ht(this)},e.setRequestHeader=function(e,t){this.u.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Vt.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),x(qt,fe);var Yt=/^https?$/i,Qt=["POST","PUT"];function Xt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,Jt(e),en(e)}function Jt(e){e.A||(e.A=!0,pe(e,"complete"),pe(e,"error"))}function Zt(e){if(e.h&&"undefined"!=typeof r&&(!e.v[1]||4!=nn(e)||2!=e.Z()))if(e.u&&4==nn(e))me(e.Ea,0,e);else if(pe(e,"readystatechange"),4==nn(e)){e.h=!1;try{const r=e.Z();e:switch(r){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var i;if(i=0===r){var s=String(e.D).match(gt)[1]||null;!s&&a.self&&a.self.location&&(s=a.self.location.protocol.slice(0,-1)),i=!Yt.test(s?s.toLowerCase():"")}n=i}if(n)pe(e,"complete"),pe(e,"success");else{e.m=6;try{var o=2<nn(e)?e.g.statusText:""}catch(c){o=""}e.l=o+" ["+e.Z()+"]",Jt(e)}}finally{en(e)}}}function en(e,t){if(e.g){tn(e);const r=e.g,a=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||pe(e,"ready");try{r.onreadystatechange=a}catch(n){}}}function tn(e){e.I&&(a.clearTimeout(e.I),e.I=null)}function nn(e){return e.g?e.g.readyState:0}function rn(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(E){return null}}function an(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function sn(e){this.Aa=0,this.i=[],this.j=new Ue,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=an("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=an("baseRetryDelayMs",5e3,e),this.cb=an("retryDelaySeedMs",1e4,e),this.Wa=an("forwardChannelMaxRetries",2,e),this.wa=an("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new ot(e&&e.concurrentRequestLimit),this.Da=new jt,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function on(e){if(ln(e),3==e.G){var t=e.U++,n=vt(e.I);if(xt(n,"SID",e.K),xt(n,"RID",t),xt(n,"TYPE","terminate"),hn(e,n),(t=new We(e,e.j,t)).L=2,t.v=Et(vt(n)),n=!1,a.navigator&&a.navigator.sendBeacon)try{n=a.navigator.sendBeacon(t.v.toString(),"")}catch(r){}!n&&a.Image&&((new Image).src=t.v,n=!0),n||(t.g=Sn(t.j,null),t.g.ea(t.v)),t.F=Date.now(),et(t)}En(e)}function cn(e){e.g&&(mn(e),e.g.cancel(),e.g=null)}function ln(e){cn(e),e.u&&(a.clearTimeout(e.u),e.u=null),yn(e),e.h.cancel(),e.s&&("number"===typeof e.s&&a.clearTimeout(e.s),e.s=null)}function un(e){if(!ct(e.h)&&!e.s){e.s=!0;var t=e.Ga;z||B(),j||(z(),j=!0),U.add(t,e),e.B=0}}function dn(e,t){var n;n=t?t.l:e.U++;const r=vt(e.I);xt(r,"SID",e.K),xt(r,"RID",n),xt(r,"AID",e.T),hn(e,r),e.m&&e.o&&Kt(r,e.m,e.o),n=new We(e,e.j,n,e.B+1),null===e.m&&(n.H=e.o),t&&(e.i=t.D.concat(e.i)),t=fn(e,n,1e3),n.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),dt(e.h,n),Qe(n,r,t)}function hn(e,t){e.H&&A(e.H,(function(e,n){xt(t,n,e)})),e.l&&pt({},(function(e,n){xt(t,n,e)}))}function fn(e,t,n){n=Math.min(e.i.length,n);var r=e.l?l(e.l.Na,e.l,e):null;e:{var a=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=a[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let s=!0;for(let o=0;o<n;o++){let n=a[o].g;const c=a[o].map;if(n-=t,0>n)t=Math.max(0,a[o].g-100),s=!1;else try{Ut(c,e,"req"+n+"_")}catch(i){r&&r(c)}}if(s){r=e.join("&");break e}}}return e=e.i.splice(0,n),t.D=e,r}function pn(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;z||B(),j||(z(),j=!0),U.add(t,e),e.v=0}}function gn(e){return!(e.g||e.u||3<=e.v)&&(e.Y++,e.u=je(l(e.Fa,e),wn(e,e.v)),e.v++,!0)}function mn(e){null!=e.A&&(a.clearTimeout(e.A),e.A=null)}function vn(e){e.g=new We(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=vt(e.qa);xt(t,"RID","rpc"),xt(t,"SID",e.K),xt(t,"AID",e.T),xt(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&xt(t,"TO",e.ja),xt(t,"TYPE","xmlhttp"),hn(e,t),e.m&&e.o&&Kt(t,e.m,e.o),e.L&&(e.g.I=e.L);var n=e.g;e=e.ia,n.L=1,n.v=Et(vt(t)),n.m=null,n.P=!0,Xe(n,e)}function yn(e){null!=e.C&&(a.clearTimeout(e.C),e.C=null)}function bn(e,t){var n=null;if(e.g==t){yn(e),mn(e),e.g=null;var r=2}else{if(!ut(e.h,t))return;n=t.D,ht(e.h,t),r=1}if(0!=e.G)if(t.o)if(1==r){n=t.m?t.m.length:0,t=Date.now()-t.F;var a=e.B;pe(r=De(),new ze(r,n)),un(e)}else pn(e);else if(3==(a=t.s)||0==a&&0<t.X||!(1==r&&function(e,t){return!(lt(e.h)>=e.h.j-(e.s?1:0))&&(e.s?(e.i=t.D.concat(e.i),!0):!(1==e.G||2==e.G||e.B>=(e.Va?0:e.Wa))&&(e.s=je(l(e.Ga,e,t),wn(e,e.B)),e.B++,!0))}(e,t)||2==r&&gn(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),a){case 1:xn(e,5);break;case 4:xn(e,10);break;case 3:xn(e,6);break;default:xn(e,2)}}function wn(e,t){let n=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(n*=2),n*t}function xn(e,t){if(e.j.info("Error code "+t),2==t){var n=l(e.fb,e),r=e.Xa;const t=!r;r=new mt(r||"//www.google.com/images/cleardot.gif"),a.location&&"http"==a.location.protocol||yt(r,"https"),Et(r),t?function(e,t){const n=new Ue;if(a.Image){const r=new Image;r.onload=u(zt,n,"TestLoadImage: loaded",!0,t,r),r.onerror=u(zt,n,"TestLoadImage: error",!1,t,r),r.onabort=u(zt,n,"TestLoadImage: abort",!1,t,r),r.ontimeout=u(zt,n,"TestLoadImage: timeout",!1,t,r),a.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(r.toString(),n):function(e,t){new Ue;const n=new AbortController,r=setTimeout((()=>{n.abort(),zt(0,0,!1,t)}),1e4);fetch(e,{signal:n.signal}).then((e=>{clearTimeout(r),e.ok?zt(0,0,!0,t):zt(0,0,!1,t)})).catch((()=>{clearTimeout(r),zt(0,0,!1,t)}))}(r.toString(),n)}else Fe(2);e.G=0,e.l&&e.l.sa(t),En(e),ln(e)}function En(e){if(e.G=0,e.ka=[],e.l){const t=ft(e.h);0==t.length&&0==e.i.length||(S(e.ka,t),S(e.ka,e.i),e.h.i.length=0,T(e.i),e.i.length=0),e.l.ra()}}function Tn(e,t,n){var r=n instanceof mt?vt(n):new mt(n);if(""!=r.g)t&&(r.g=t+"."+r.g),bt(r,r.s);else{var i=a.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var s=new mt(null);r&&yt(s,r),t&&(s.g=t),i&&bt(s,i),n&&(s.l=n),r=s}return n=e.D,t=e.ya,n&&t&&xt(r,n,t),xt(r,"VER",e.la),hn(e,r),r}function Sn(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new qt(new Bt({eb:n})):new qt(e.pa)).Ha(e.J),t}function In(){}function kn(){}function Cn(e,t){fe.call(this),this.g=new sn(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!I(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!I(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new Nn(this)}function _n(e){Ae.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function An(){Ne.call(this),this.status=1}function Nn(e){this.g=e}(e=qt.prototype).Ha=function(e){this.J=e},e.ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ve.g(),this.v=this.o?ke(this.o):ke(Ve),this.g.onreadystatechange=l(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(s){return void Xt(this,s)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find((e=>"content-type"==e.toLowerCase())),i=a.FormData&&e instanceof a.FormData,!(0<=Array.prototype.indexOf.call(Qt,t,void 0))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[a,o]of n)this.g.setRequestHeader(a,o);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{tn(this),this.u=!0,this.g.send(e),this.u=!1}catch(s){Xt(this,s)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,pe(this,"complete"),pe(this,"abort"),en(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),en(this,!0)),qt.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?Zt(this):this.bb())},e.bb=function(){Zt(this)},e.isActive=function(){return!!this.g},e.Z=function(){try{return 2<nn(this)?this.g.status:-1}catch(kt){return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch(kt){return""}},e.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),Te(t)}},e.Ba=function(){return this.m},e.Ka=function(){return"string"===typeof this.l?this.l:String(this.l)},(e=sn.prototype).la=8,e.G=1,e.connect=function(e,t,n,r){Fe(0),this.W=e,this.H=t||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.I=Tn(this,null,this.W),un(this)},e.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const a=new We(this,this.j,e);let i=this.o;if(this.S&&(i?(i=N(i),O(i,this.S)):i=this.S),null!==this.m||this.O||(a.H=i,i=null),this.P)e:{for(var t=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=fn(this,a,t),xt(n=vt(this.I),"RID",e),xt(n,"CVER",22),this.D&&xt(n,"X-HTTP-Session-Id",this.D),hn(this,n),i&&(this.O?t="headers="+encodeURIComponent(String(Wt(i)))+"&"+t:this.m&&Kt(n,this.m,i)),dt(this.h,a),this.Ua&&xt(n,"TYPE","init"),this.P?(xt(n,"$req",t),xt(n,"SID","null"),a.T=!0,Qe(a,n,null)):Qe(a,n,t),this.G=2}}else 3==this.G&&(e?dn(this,e):0==this.i.length||ct(this.h)||dn(this))},e.Fa=function(){if(this.u=null,vn(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=je(l(this.ab,this),e)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Fe(10),cn(this),vn(this))},e.Za=function(){null!=this.C&&(this.C=null,cn(this),gn(this),Fe(19))},e.fb=function(e){e?(this.j.info("Successfully pinged google.com"),Fe(2)):(this.j.info("Failed to ping google.com"),Fe(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=In.prototype).ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){},kn.prototype.g=function(e,t){return new Cn(e,t)},x(Cn,fe),Cn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Cn.prototype.close=function(){on(this.g)},Cn.prototype.o=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.u&&((n={}).__data__=Ee(e),e=n);t.i.push(new st(t.Ya++,e)),3==t.G&&un(t)},Cn.prototype.N=function(){this.g.l=null,delete this.j,on(this.g),delete this.g,Cn.aa.N.call(this)},x(_n,Ae),x(An,Ne),x(Nn,In),Nn.prototype.ua=function(){pe(this.g,"a")},Nn.prototype.ta=function(e){pe(this.g,new _n(e))},Nn.prototype.sa=function(e){pe(this.g,new An)},Nn.prototype.ra=function(){pe(this.g,"b")},kn.prototype.createWebChannel=kn.prototype.g,Cn.prototype.send=Cn.prototype.o,Cn.prototype.open=Cn.prototype.m,Cn.prototype.close=Cn.prototype.close,y=w.createWebChannelTransport=function(){return new kn},v=w.getStatEventTarget=function(){return De()},m=w.Event=Re,g=w.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},$e.NO_ERROR=0,$e.TIMEOUT=8,$e.HTTP_ERROR=6,p=w.ErrorCode=$e,He.COMPLETE="complete",f=w.EventType=He,Ce.EventType=_e,_e.OPEN="a",_e.CLOSE="b",_e.ERROR="c",_e.MESSAGE="d",fe.prototype.listen=fe.prototype.K,h=w.WebChannel=Ce,w.FetchXmlHttpFactory=Bt,qt.prototype.listenOnce=qt.prototype.L,qt.prototype.getLastError=qt.prototype.Ka,qt.prototype.getLastErrorCode=qt.prototype.Ba,qt.prototype.getStatus=qt.prototype.Z,qt.prototype.getResponseJson=qt.prototype.Oa,qt.prototype.getResponseText=qt.prototype.oa,qt.prototype.send=qt.prototype.ea,qt.prototype.setWithCredentials=qt.prototype.Ha,d=w.XhrIo=qt}).apply("undefined"!==typeof b?b:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const x="@firebase/firestore",E="4.7.10";class T{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}T.UNAUTHENTICATED=new T(null),T.GOOGLE_CREDENTIALS=new T("google-credentials-uid"),T.FIRST_PARTY=new T("first-party-uid"),T.MOCK_USER=new T("mock-user");let S="11.5.0";const I=new o.Vy("@firebase/firestore");function k(){return I.logLevel}function C(e){if(I.logLevel<=o.$b.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const a=n.map(N);I.debug(`Firestore (${S}): ${e}`,...a)}}function _(e){if(I.logLevel<=o.$b.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const a=n.map(N);I.error(`Firestore (${S}): ${e}`,...a)}}function A(e){if(I.logLevel<=o.$b.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const a=n.map(N);I.warn(`Firestore (${S}): ${e}`,...a)}}function N(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function R(){const e=`FIRESTORE (${S}) INTERNAL ASSERTION FAILED: `+(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state");throw _(e),new Error(e)}function O(e,t){e||R()}function D(e,t){return e}const P={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class L extends c.g{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class M{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class F{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class z{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(T.UNAUTHENTICATED)))}shutdown(){}}class j{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class U{constructor(e){this.t=e,this.currentUser=T.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){O(void 0===this.o);let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let a=new M;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new M,e.enqueueRetryable((()=>r(this.currentUser)))};const i=()=>{const t=a;e.enqueueRetryable((async()=>{await t.promise,await r(this.currentUser)}))},s=e=>{C("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),i())};this.t.onInit((e=>s(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?s(e):(C("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new M)}}),0),i()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(C("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(O("string"==typeof t.accessToken),new F(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return O(null===e||"string"==typeof e),new T(e)}}class B{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=T.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}}class V{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new B(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable((()=>t(T.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class ${constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class H{constructor(e,t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null,this.V=null,(0,i.xZ)(e)&&e.settings.appCheckToken&&(this.V=e.settings.appCheckToken)}start(e,t){O(void 0===this.o);const n=e=>{null!=e.error&&C("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.R;return this.R=e.token,C("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const r=e=>{C("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit((e=>r(e))),setTimeout((()=>{if(!this.appCheck){const e=this.A.getImmediate({optional:!0});e?r(e):C("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.V)return Promise.resolve(new $(this.V));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(O("string"==typeof e.token),this.R=e.token,new $(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function G(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}function W(){return new TextEncoder}class K{static newId(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const n=G(40);for(let r=0;r<n.length;++r)t.length<20&&n[r]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62))}return t}}function q(e,t){return e<t?-1:e>t?1:0}function Y(e,t){let n=0;for(;n<e.length&&n<t.length;){const r=e.codePointAt(n),a=t.codePointAt(n);if(r!==a){if(r<128&&a<128)return q(r,a);{const i=W(),s=X(i.encode(Q(e,n)),i.encode(Q(t,n)));return 0!==s?s:q(r,a)}}n+=r>65535?2:1}return q(e.length,t.length)}function Q(e,t){return e.codePointAt(t)>65535?e.substring(t,t+2):e.substring(t,t+1)}function X(e,t){for(let n=0;n<e.length&&n<t.length;++n)if(e[n]!==t[n])return q(e[n],t[n]);return q(e.length,t.length)}function J(e,t,n){return e.length===t.length&&e.every(((e,r)=>n(e,t[r])))}function Z(e){return e+"\0"}const ee=-62135596800,te=1e6;class ne{static now(){return ne.fromMillis(Date.now())}static fromDate(e){return ne.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*te);return new ne(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new L(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new L(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<ee)throw new L(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new L(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/te}_compareTo(e){return this.seconds===e.seconds?q(this.nanoseconds,e.nanoseconds):q(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-ee;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class re{static fromTimestamp(e){return new re(e)}static min(){return new re(new ne(0,0))}static max(){return new re(new ne(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const ae="__name__";class ie{constructor(e,t,n){void 0===t?t=0:t>e.length&&R(),void 0===n?n=e.length-t:n>e.length-t&&R(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===ie.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ie?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=ie.compareSegments(e.get(r),t.get(r));if(0!==n)return n}return q(e.length,t.length)}static compareSegments(e,t){const n=ie.isNumericId(e),r=ie.isNumericId(t);return n&&!r?-1:!n&&r?1:n&&r?ie.extractNumericId(e).compare(ie.extractNumericId(t)):Y(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return r.fromString(e.substring(4,e.length-2))}}class se extends ie{construct(e,t,n){return new se(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const a of n){if(a.indexOf("//")>=0)throw new L(P.INVALID_ARGUMENT,`Invalid segment (${a}). Paths must not contain // in them.`);e.push(...a.split("/").filter((e=>e.length>0)))}return new se(e)}static emptyPath(){return new se([])}}const oe=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ce extends ie{construct(e,t,n){return new ce(e,t,n)}static isValidIdentifier(e){return oe.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ce.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===ae}static keyField(){return new ce([ae])}static fromServerFormat(e){const t=[];let n="",r=0;const a=()=>{if(0===n.length)throw new L(P.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let i=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new L(P.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new L(P.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(i=!i,r++):"."!==t||i?(n+=t,r++):(a(),r++)}if(a(),i)throw new L(P.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ce(t)}static emptyPath(){return new ce([])}}class le{constructor(e){this.path=e}static fromPath(e){return new le(se.fromString(e))}static fromName(e){return new le(se.fromString(e).popFirst(5))}static empty(){return new le(se.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===se.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return se.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new le(new se(e.slice()))}}const ue=-1;class de{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}function he(e){return e.fields.find((e=>2===e.kind))}function fe(e){return e.fields.filter((e=>2!==e.kind))}de.UNKNOWN_ID=-1;class pe{constructor(e,t){this.fieldPath=e,this.kind=t}}class ge{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new ge(0,ye.min())}}function me(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,a=re.fromTimestamp(1e9===r?new ne(n+1,0):new ne(n,r));return new ye(a,le.empty(),t)}function ve(e){return new ye(e.readTime,e.key,ue)}class ye{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new ye(re.min(),le.empty(),ue)}static max(){return new ye(re.max(),le.empty(),ue)}}function be(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=le.comparator(e.documentKey,t.documentKey),0!==n?n:q(e.largestBatchId,t.largestBatchId))}const we="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class xe{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Ee(e){if(e.code!==P.FAILED_PRECONDITION||e.message!==we)throw e;C("LocalStore","Unexpectedly lost primary lease")}class Te{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&R(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Te(((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Te?t:Te.resolve(t)}catch(e){return Te.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Te.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Te.reject(t)}static resolve(e){return new Te(((t,n)=>{t(e)}))}static reject(e){return new Te(((t,n)=>{n(e)}))}static waitFor(e){return new Te(((t,n)=>{let r=0,a=0,i=!1;e.forEach((e=>{++r,e.next((()=>{++a,i&&a===r&&t()}),(e=>n(e)))})),i=!0,a===r&&t()}))}static or(e){let t=Te.resolve(!1);for(const n of e)t=t.next((e=>e?Te.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,r)=>{n.push(t.call(this,e,r))})),this.waitFor(n)}static mapArray(e,t){return new Te(((n,r)=>{const a=e.length,i=new Array(a);let s=0;for(let o=0;o<a;o++){const c=o;t(e[c]).next((e=>{i[c]=e,++s,s===a&&n(i)}),(e=>r(e)))}}))}static doWhile(e,t){return new Te(((n,r)=>{const a=()=>{!0===e()?t().next((()=>{a()}),r):n()};a()}))}}const Se="SimpleDb";class Ie{static open(e,t,n,r){try{return new Ie(t,e.transaction(r,n))}catch(e){throw new Ae(t,e)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.m=new M,this.transaction.oncomplete=()=>{this.m.resolve()},this.transaction.onabort=()=>{t.error?this.m.reject(new Ae(e,t.error)):this.m.resolve()},this.transaction.onerror=t=>{const n=Pe(t.target.error);this.m.reject(new Ae(e,n))}}get p(){return this.m.promise}abort(e){e&&this.m.reject(e),this.aborted||(C(Se,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}S(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new Re(t)}}class ke{static delete(e){return C(Se,"Removing database:",e),Oe(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!(0,c.zW)())return!1;if(ke.v())return!0;const e=(0,c.ZQ)(),t=ke.C(e),n=0<t&&t<10,r=Ce(e),a=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||a)}static v(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.__PRIVATE_env)||void 0===e?void 0:e.F)}static M(e,t){return e.store(t)}static C(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}constructor(e,t,n){this.name=e,this.version=t,this.O=n,12.2===ke.C((0,c.ZQ)())&&_("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async N(e){return this.db||(C(Se,"Opening database:",this.name),this.db=await new Promise(((t,n)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=e=>{const n=e.target.result;t(n)},r.onblocked=()=>{n(new Ae(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=t=>{const r=t.target.error;"VersionError"===r.name?n(new L(P.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===r.name?n(new L(P.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+r)):n(new Ae(e,r))},r.onupgradeneeded=e=>{C(Se,'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);const t=e.target.result;this.O.B(t,r.transaction,e.oldVersion,this.version).next((()=>{C(Se,"Database upgrade to version "+this.version+" complete")}))}}))),this.L&&(this.db.onversionchange=e=>this.L(e)),this.db}k(e){this.L=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,r){const a="readonly"===t;let i=0;for(;;){++i;try{this.db=await this.N(e);const t=Ie.open(this.db,e,a?"readonly":"readwrite",n),i=r(t).next((e=>(t.S(),e))).catch((e=>(t.abort(e),Te.reject(e)))).toPromise();return i.catch((()=>{})),await t.p,i}catch(e){const t=e,n="FirebaseError"!==t.name&&i<3;if(C(Se,"Transaction failed with error:",t.message,"Retrying:",n),this.close(),!n)return Promise.reject(t)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Ce(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class _e{constructor(e){this.q=e,this.$=!1,this.U=null}get isDone(){return this.$}get K(){return this.U}set cursor(e){this.q=e}done(){this.$=!0}W(e){this.U=e}delete(){return Oe(this.q.delete())}}class Ae extends L{constructor(e,t){super(P.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Ne(e){return"IndexedDbTransactionError"===e.name}class Re{constructor(e){this.store=e}put(e,t){let n;return void 0!==t?(C(Se,"PUT",this.store.name,e,t),n=this.store.put(t,e)):(C(Se,"PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Oe(n)}add(e){return C(Se,"ADD",this.store.name,e,e),Oe(this.store.add(e))}get(e){return Oe(this.store.get(e)).next((t=>(void 0===t&&(t=null),C(Se,"GET",this.store.name,e,t),t)))}delete(e){return C(Se,"DELETE",this.store.name,e),Oe(this.store.delete(e))}count(){return C(Se,"COUNT",this.store.name),Oe(this.store.count())}G(e,t){const n=this.options(e,t),r=n.index?this.store.index(n.index):this.store;if("function"==typeof r.getAll){const e=r.getAll(n.range);return new Te(((t,n)=>{e.onerror=e=>{n(e.target.error)},e.onsuccess=e=>{t(e.target.result)}}))}{const e=this.cursor(n),t=[];return this.j(e,((e,n)=>{t.push(n)})).next((()=>t))}}H(e,t){const n=this.store.getAll(e,null===t?void 0:t);return new Te(((e,t)=>{n.onerror=e=>{t(e.target.error)},n.onsuccess=t=>{e(t.target.result)}}))}J(e,t){C(Se,"DELETE ALL",this.store.name);const n=this.options(e,t);n.Y=!1;const r=this.cursor(n);return this.j(r,((e,t,n)=>n.delete()))}Z(e,t){let n;t?n=e:(n={},t=e);const r=this.cursor(n);return this.j(r,t)}X(e){const t=this.cursor({});return new Te(((n,r)=>{t.onerror=e=>{const t=Pe(e.target.error);r(t)},t.onsuccess=t=>{const r=t.target.result;r?e(r.primaryKey,r.value).next((e=>{e?r.continue():n()})):n()}}))}j(e,t){const n=[];return new Te(((r,a)=>{e.onerror=e=>{a(e.target.error)},e.onsuccess=e=>{const a=e.target.result;if(!a)return void r();const i=new _e(a),s=t(a.primaryKey,a.value,i);if(s instanceof Te){const e=s.catch((e=>(i.done(),Te.reject(e))));n.push(e)}i.isDone?r():null===i.K?a.continue():a.continue(i.K)}})).next((()=>Te.waitFor(n)))}options(e,t){let n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.Y?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Oe(e){return new Te(((t,n)=>{e.onsuccess=e=>{const n=e.target.result;t(n)},e.onerror=e=>{const t=Pe(e.target.error);n(t)}}))}let De=!1;function Pe(e){const t=ke.C((0,c.ZQ)());if(t>=12.2&&t<13){const t="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(t)>=0){const e=new L("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return De||(De=!0,setTimeout((()=>{throw e}),0)),e}}return e}const Le="IndexBackfiller";class Me{constructor(e,t){this.asyncQueue=e,this.ee=t,this.task=null}start(){this.te(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}te(e){C(Le,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const e=await this.ee.ne();C(Le,`Documents written: ${e}`)}catch(e){Ne(e)?C(Le,"Ignoring IndexedDB error during index backfill: ",e):await Ee(e)}await this.te(6e4)}))}}class Fe{constructor(e,t){this.localStore=e,this.persistence=t}async ne(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.re(t,e)))}re(e,t){const n=new Set;let r=t,a=!0;return Te.doWhile((()=>!0===a&&r>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((t=>{if(null!==t&&!n.has(t))return C(Le,`Processing collection: ${t}`),this.ie(e,t,r).next((e=>{r-=e,n.add(t)}));a=!1})))).next((()=>t-r))}ie(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((r=>this.localStore.localDocuments.getNextDocuments(e,t,r,n).next((n=>{const a=n.changes;return this.localStore.indexManager.updateIndexEntries(e,a).next((()=>this.se(r,n))).next((n=>(C(Le,`Updating offset: ${n}`),this.localStore.indexManager.updateCollectionGroup(e,t,n)))).next((()=>a.size))}))))}se(e,t){let n=e;return t.changes.forEach(((e,t)=>{const r=ve(t);be(r,n)>0&&(n=r)})),new ye(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}class ze{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.oe(e),this._e=e=>t.writeSequenceNumber(e))}oe(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this._e&&this._e(e),e}}ze.ae=-1;const je=-1;function Ue(e){return null==e}function Be(e){return 0===e&&1/e==-1/0}function Ve(e){return"number"==typeof e&&Number.isInteger(e)&&!Be(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}const $e="\x01";function He(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=We(t)),t=Ge(e.get(n),t);return We(t)}function Ge(e,t){let n=t;const r=e.length;for(let a=0;a<r;a++){const t=e.charAt(a);switch(t){case"\0":n+="\x01\x10";break;case $e:n+="\x01\x11";break;default:n+=t}}return n}function We(e){return e+$e+"\x01"}function Ke(e){const t=e.length;if(O(t>=2),2===t)return O(e.charAt(0)===$e&&"\x01"===e.charAt(1)),se.emptyPath();const n=t-2,r=[];let a="";for(let i=0;i<t;){const t=e.indexOf($e,i);switch((t<0||t>n)&&R(),e.charAt(t+1)){case"\x01":const n=e.substring(i,t);let s;0===a.length?s=n:(a+=n,s=a,a=""),r.push(s);break;case"\x10":a+=e.substring(i,t),a+="\0";break;case"\x11":a+=e.substring(i,t+1);break;default:R()}i=t+2}return new se(r)}const qe="remoteDocuments",Ye="owner",Qe="owner",Xe="mutationQueues",Je="mutations",Ze="batchId",et="userMutationsIndex",tt=["userId","batchId"];function nt(e,t){return[e,He(t)]}function rt(e,t,n){return[e,He(t),n]}const at={},it="documentMutations",st="remoteDocumentsV14",ot=["prefixPath","collectionGroup","readTime","documentId"],ct="documentKeyIndex",lt=["prefixPath","collectionGroup","documentId"],ut="collectionGroupIndex",dt=["collectionGroup","readTime","prefixPath","documentId"],ht="remoteDocumentGlobal",ft="remoteDocumentGlobalKey",pt="targets",gt="queryTargetsIndex",mt=["canonicalId","targetId"],vt="targetDocuments",yt=["targetId","path"],bt="documentTargetsIndex",wt=["path","targetId"],xt="targetGlobalKey",Et="targetGlobal",Tt="collectionParents",St=["collectionId","parent"],It="clientMetadata",kt="bundles",Ct="namedQueries",_t="indexConfiguration",At="collectionGroupIndex",Nt="indexState",Rt=["indexId","uid"],Ot="sequenceNumberIndex",Dt=["uid","sequenceNumber"],Pt="indexEntries",Lt=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Mt="documentKeyIndex",Ft=["indexId","uid","orderedDocumentKey"],zt="documentOverlays",jt=["userId","collectionPath","documentId"],Ut="collectionPathOverlayIndex",Bt=["userId","collectionPath","largestBatchId"],Vt="collectionGroupOverlayIndex",$t=["userId","collectionGroup","largestBatchId"],Ht="globals",Gt=[Xe,Je,it,qe,pt,Ye,Et,vt,It,ht,Tt,kt,Ct],Wt=[...Gt,zt],Kt=[Xe,Je,it,st,pt,Ye,Et,vt,It,ht,Tt,kt,Ct,zt],qt=Kt,Yt=[...qt,_t,Nt,Pt],Qt=Yt,Xt=[...Yt,Ht];class Jt extends xe{constructor(e,t){super(),this.ue=e,this.currentSequenceNumber=t}}function Zt(e,t){const n=D(e);return ke.M(n.ue,t)}function en(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function tn(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function nn(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class rn{constructor(e,t){this.comparator=e,this.root=t||sn.EMPTY}insert(e,t){return new rn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,sn.BLACK,null,null))}remove(e){return new rn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,sn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new an(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new an(this.root,e,this.comparator,!1)}getReverseIterator(){return new an(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new an(this.root,e,this.comparator,!0)}}class an{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?n(e.key,t):1,t&&r&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(0===a){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class sn{constructor(e,t,n,r,a){this.key=e,this.value=t,this.color=null!=n?n:sn.RED,this.left=null!=r?r:sn.EMPTY,this.right=null!=a?a:sn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,a){return new sn(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=a?a:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const a=n(e,r.key);return r=a<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===a?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return sn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return sn.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,sn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,sn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw R();if(this.right.isRed())throw R();const e=this.left.check();if(e!==this.right.check())throw R();return e+(this.isRed()?0:1)}}sn.EMPTY=null,sn.RED=!0,sn.BLACK=!1,sn.EMPTY=new class{constructor(){this.size=0}get key(){throw R()}get value(){throw R()}get color(){throw R()}get left(){throw R()}get right(){throw R()}copy(e,t,n,r,a){return this}insert(e,t,n){return new sn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class on{constructor(e){this.comparator=e,this.data=new rn(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new cn(this.data.getIterator())}getIteratorFrom(e){return new cn(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof on))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new on(this.comparator);return t.data=e,t}}class cn{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function ln(e){return e.hasNext()?e.getNext():void 0}class un{constructor(e){this.fields=e,e.sort(ce.comparator)}static empty(){return new un([])}unionWith(e){let t=new on(ce.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new un(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return J(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class dn extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class hn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new dn("Invalid base64 string: "+e):e}}(e);return new hn(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new hn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return q(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}hn.EMPTY_BYTE_STRING=new hn("");const fn=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function pn(e){if(O(!!e),"string"==typeof e){let t=0;const n=fn.exec(e);if(O(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:gn(e.seconds),nanos:gn(e.nanos)}}function gn(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function mn(e){return"string"==typeof e?hn.fromBase64String(e):hn.fromUint8Array(e)}const vn="server_timestamp",yn="__type__",bn="__previous_value__",wn="__local_write_time__";function xn(e){var t,n;return(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{})[yn])||void 0===n?void 0:n.stringValue)===vn}function En(e){const t=e.mapValue.fields[bn];return xn(t)?En(t):t}function Tn(e){const t=pn(e.mapValue.fields[wn].timestampValue);return new ne(t.seconds,t.nanos)}class Sn{constructor(e,t,n,r,a,i,s,o,c){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=a,this.forceLongPolling=i,this.autoDetectLongPolling=s,this.longPollingOptions=o,this.useFetchStreams=c}}const In="(default)";class kn{constructor(e,t){this.projectId=e,this.database=t||In}static empty(){return new kn("","")}get isDefaultDatabase(){return this.database===In}isEqual(e){return e instanceof kn&&e.projectId===this.projectId&&e.database===this.database}}const Cn="__type__",_n="__max__",An={mapValue:{fields:{__type__:{stringValue:_n}}}},Nn="__vector__",Rn="value",On={nullValue:"NULL_VALUE"};function Dn(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?xn(e)?4:Qn(e)?9007199254740991:qn(e)?10:11:R()}function Pn(e,t){if(e===t)return!0;const n=Dn(e);if(n!==Dn(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Tn(e).isEqual(Tn(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=pn(e.timestampValue),r=pn(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return mn(e.bytesValue).isEqual(mn(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return gn(e.geoPointValue.latitude)===gn(t.geoPointValue.latitude)&&gn(e.geoPointValue.longitude)===gn(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return gn(e.integerValue)===gn(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=gn(e.doubleValue),r=gn(t.doubleValue);return n===r?Be(n)===Be(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return J(e.arrayValue.values||[],t.arrayValue.values||[],Pn);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(en(n)!==en(r))return!1;for(const a in n)if(n.hasOwnProperty(a)&&(void 0===r[a]||!Pn(n[a],r[a])))return!1;return!0}(e,t);default:return R()}}function Ln(e,t){return void 0!==(e.values||[]).find((e=>Pn(e,t)))}function Mn(e,t){if(e===t)return 0;const n=Dn(e),r=Dn(t);if(n!==r)return q(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return q(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=gn(e.integerValue||e.doubleValue),r=gn(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return Fn(e.timestampValue,t.timestampValue);case 4:return Fn(Tn(e),Tn(t));case 5:return Y(e.stringValue,t.stringValue);case 6:return function(e,t){const n=mn(e),r=mn(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let a=0;a<n.length&&a<r.length;a++){const e=q(n[a],r[a]);if(0!==e)return e}return q(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=q(gn(e.latitude),gn(t.latitude));return 0!==n?n:q(gn(e.longitude),gn(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return zn(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n,r,a,i;const s=e.fields||{},o=t.fields||{},c=null===(n=s[Rn])||void 0===n?void 0:n.arrayValue,l=null===(r=o[Rn])||void 0===r?void 0:r.arrayValue,u=q((null===(a=null==c?void 0:c.values)||void 0===a?void 0:a.length)||0,(null===(i=null==l?void 0:l.values)||void 0===i?void 0:i.length)||0);return 0!==u?u:zn(c,l)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===An.mapValue&&t===An.mapValue)return 0;if(e===An.mapValue)return 1;if(t===An.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),a=t.fields||{},i=Object.keys(a);r.sort(),i.sort();for(let s=0;s<r.length&&s<i.length;++s){const e=Y(r[s],i[s]);if(0!==e)return e;const t=Mn(n[r[s]],a[i[s]]);if(0!==t)return t}return q(r.length,i.length)}(e.mapValue,t.mapValue);default:throw R()}}function Fn(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return q(e,t);const n=pn(e),r=pn(t),a=q(n.seconds,r.seconds);return 0!==a?a:q(n.nanos,r.nanos)}function zn(e,t){const n=e.values||[],r=t.values||[];for(let a=0;a<n.length&&a<r.length;++a){const e=Mn(n[a],r[a]);if(e)return e}return q(n.length,r.length)}function jn(e){return Un(e)}function Un(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=pn(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return mn(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return le.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=Un(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const a of t)r?r=!1:n+=",",n+=`${a}:${Un(e.fields[a])}`;return n+"}"}(e.mapValue):R()}function Bn(e){switch(Dn(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=En(e);return t?16+Bn(t):16;case 5:return 2*e.stringValue.length;case 6:return mn(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(e){return(e.values||[]).reduce(((e,t)=>e+Bn(t)),0)}(e.arrayValue);case 10:case 11:return function(e){let t=0;return tn(e.fields,((e,n)=>{t+=e.length+Bn(n)})),t}(e.mapValue);default:throw R()}}function Vn(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function $n(e){return!!e&&"integerValue"in e}function Hn(e){return!!e&&"arrayValue"in e}function Gn(e){return!!e&&"nullValue"in e}function Wn(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Kn(e){return!!e&&"mapValue"in e}function qn(e){var t,n;return(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{})[Cn])||void 0===n?void 0:n.stringValue)===Nn}function Yn(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return tn(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=Yn(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Yn(e.arrayValue.values[n]);return t}return Object.assign({},e)}function Qn(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===_n}const Xn={mapValue:{fields:{[Cn]:{stringValue:Nn},[Rn]:{arrayValue:{}}}}};function Jn(e){return"nullValue"in e?On:"booleanValue"in e?{booleanValue:!1}:"integerValue"in e||"doubleValue"in e?{doubleValue:NaN}:"timestampValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in e?{stringValue:""}:"bytesValue"in e?{bytesValue:""}:"referenceValue"in e?Vn(kn.empty(),le.empty()):"geoPointValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in e?{arrayValue:{}}:"mapValue"in e?qn(e)?Xn:{mapValue:{}}:R()}function Zn(e){return"nullValue"in e?{booleanValue:!1}:"booleanValue"in e?{doubleValue:NaN}:"integerValue"in e||"doubleValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in e?{stringValue:""}:"stringValue"in e?{bytesValue:""}:"bytesValue"in e?Vn(kn.empty(),le.empty()):"referenceValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in e?{arrayValue:{}}:"arrayValue"in e?Xn:"mapValue"in e?qn(e)?{mapValue:{}}:An:R()}function er(e,t){const n=Mn(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function tr(e,t){const n=Mn(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}class nr{constructor(e){this.value=e}static empty(){return new nr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Kn(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Yn(t)}setAll(e){let t=ce.emptyPath(),n={},r=[];e.forEach(((e,a)=>{if(!t.isImmediateParentOf(a)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=a.popLast()}e?n[a.lastSegment()]=Yn(e):r.push(a.lastSegment())}));const a=this.getFieldsMap(t);this.applyChanges(a,n,r)}delete(e){const t=this.field(e.popLast());Kn(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Pn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];Kn(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){tn(t,((t,n)=>e[t]=n));for(const r of n)delete e[r]}clone(){return new nr(Yn(this.value))}}function rr(e){const t=[];return tn(e.fields,((e,n)=>{const r=new ce([e]);if(Kn(n)){const e=rr(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)})),new un(t)}class ar{constructor(e,t,n,r,a,i,s){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=a,this.data=i,this.documentState=s}static newInvalidDocument(e){return new ar(e,0,re.min(),re.min(),re.min(),nr.empty(),0)}static newFoundDocument(e,t,n,r){return new ar(e,1,t,re.min(),n,r,0)}static newNoDocument(e,t){return new ar(e,2,t,re.min(),re.min(),nr.empty(),0)}static newUnknownDocument(e,t){return new ar(e,3,t,re.min(),re.min(),nr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(re.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=nr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=nr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=re.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof ar&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ar(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class ir{constructor(e,t){this.position=e,this.inclusive=t}}function sr(e,t,n){let r=0;for(let a=0;a<e.position.length;a++){const i=t[a],s=e.position[a];if(r=i.field.isKeyField()?le.comparator(le.fromName(s.referenceValue),n.key):Mn(s,n.data.field(i.field)),"desc"===i.dir&&(r*=-1),0!==r)break}return r}function or(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Pn(e.position[n],t.position[n]))return!1;return!0}class cr{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function lr(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class ur{}class dr extends ur{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new xr(e,t,n):"array-contains"===t?new Ir(e,n):"in"===t?new kr(e,n):"not-in"===t?new Cr(e,n):"array-contains-any"===t?new _r(e,n):new dr(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new Er(e,n):new Tr(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(Mn(t,this.value)):null!==t&&Dn(this.value)===Dn(t)&&this.matchesComparison(Mn(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return R()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class hr extends ur{constructor(e,t){super(),this.filters=e,this.op=t,this.ce=null}static create(e,t){return new hr(e,t)}matches(e){return fr(this)?void 0===this.filters.find((t=>!t.matches(e))):void 0!==this.filters.find((t=>t.matches(e)))}getFlattenedFilters(){return null!==this.ce||(this.ce=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.ce}getFilters(){return Object.assign([],this.filters)}}function fr(e){return"and"===e.op}function pr(e){return"or"===e.op}function gr(e){return mr(e)&&fr(e)}function mr(e){for(const t of e.filters)if(t instanceof hr)return!1;return!0}function vr(e){if(e instanceof dr)return e.field.canonicalString()+e.op.toString()+jn(e.value);if(gr(e))return e.filters.map((e=>vr(e))).join(",");{const t=e.filters.map((e=>vr(e))).join(",");return`${e.op}(${t})`}}function yr(e,t){return e instanceof dr?function(e,t){return t instanceof dr&&e.op===t.op&&e.field.isEqual(t.field)&&Pn(e.value,t.value)}(e,t):e instanceof hr?function(e,t){return t instanceof hr&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce(((e,n,r)=>e&&yr(n,t.filters[r])),!0)}(e,t):void R()}function br(e,t){const n=e.filters.concat(t);return hr.create(n,e.op)}function wr(e){return e instanceof dr?function(e){return`${e.field.canonicalString()} ${e.op} ${jn(e.value)}`}(e):e instanceof hr?function(e){return e.op.toString()+" {"+e.getFilters().map(wr).join(" ,")+"}"}(e):"Filter"}class xr extends dr{constructor(e,t,n){super(e,t,n),this.key=le.fromName(n.referenceValue)}matches(e){const t=le.comparator(e.key,this.key);return this.matchesComparison(t)}}class Er extends dr{constructor(e,t){super(e,"in",t),this.keys=Sr("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class Tr extends dr{constructor(e,t){super(e,"not-in",t),this.keys=Sr("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Sr(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>le.fromName(e.referenceValue)))}class Ir extends dr{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Hn(t)&&Ln(t.arrayValue,this.value)}}class kr extends dr{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Ln(this.value.arrayValue,t)}}class Cr extends dr{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ln(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Ln(this.value.arrayValue,t)}}class _r extends dr{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Hn(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>Ln(this.value.arrayValue,e)))}}class Ar{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=a,this.startAt=i,this.endAt=s,this.le=null}}function Nr(e){return new Ar(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function Rr(e){const t=D(e);if(null===t.le){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>vr(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),Ue(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>jn(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>jn(e))).join(",")),t.le=e}return t.le}function Or(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!lr(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!yr(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!or(e.startAt,t.startAt)&&or(e.endAt,t.endAt)}function Dr(e){return le.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function Pr(e,t){return e.filters.filter((e=>e instanceof dr&&e.field.isEqual(t)))}function Lr(e,t,n){let r=On,a=!0;for(const i of Pr(e,t)){let e=On,t=!0;switch(i.op){case"<":case"<=":e=Jn(i.value);break;case"==":case"in":case">=":e=i.value;break;case">":e=i.value,t=!1;break;case"!=":case"not-in":e=On}er({value:r,inclusive:a},{value:e,inclusive:t})<0&&(r=e,a=t)}if(null!==n)for(let i=0;i<e.orderBy.length;++i)if(e.orderBy[i].field.isEqual(t)){const e=n.position[i];er({value:r,inclusive:a},{value:e,inclusive:n.inclusive})<0&&(r=e,a=n.inclusive);break}return{value:r,inclusive:a}}function Mr(e,t,n){let r=An,a=!0;for(const i of Pr(e,t)){let e=An,t=!0;switch(i.op){case">=":case">":e=Zn(i.value),t=!1;break;case"==":case"in":case"<=":e=i.value;break;case"<":e=i.value,t=!1;break;case"!=":case"not-in":e=An}tr({value:r,inclusive:a},{value:e,inclusive:t})>0&&(r=e,a=t)}if(null!==n)for(let i=0;i<e.orderBy.length;++i)if(e.orderBy[i].field.isEqual(t)){const e=n.position[i];tr({value:r,inclusive:a},{value:e,inclusive:n.inclusive})>0&&(r=e,a=n.inclusive);break}return{value:r,inclusive:a}}class Fr{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=a,this.limitType=i,this.startAt=s,this.endAt=o,this.he=null,this.Pe=null,this.Te=null,this.startAt,this.endAt}}function zr(e,t,n,r,a,i,s,o){return new Fr(e,t,n,r,a,i,s,o)}function jr(e){return new Fr(e)}function Ur(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Br(e){return null!==e.collectionGroup}function Vr(e){const t=D(e);if(null===t.he){t.he=[];const e=new Set;for(const a of t.explicitOrderBy)t.he.push(a),e.add(a.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new on(ce.comparator);return e.filters.forEach((e=>{e.getFlattenedFilters().forEach((e=>{e.isInequality()&&(t=t.add(e.field))}))})),t}(t);r.forEach((r=>{e.has(r.canonicalString())||r.isKeyField()||t.he.push(new cr(r,n))})),e.has(ce.keyField().canonicalString())||t.he.push(new cr(ce.keyField(),n))}return t.he}function $r(e){const t=D(e);return t.Pe||(t.Pe=Hr(t,Vr(e))),t.Pe}function Hr(e,t){if("F"===e.limitType)return Nr(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map((e=>{const t="desc"===e.dir?"asc":"desc";return new cr(e.field,t)}));const n=e.endAt?new ir(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new ir(e.startAt.position,e.startAt.inclusive):null;return Nr(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function Gr(e,t){const n=e.filters.concat([t]);return new Fr(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function Wr(e,t,n){return new Fr(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Kr(e,t){return Or($r(e),$r(t))&&e.limitType===t.limitType}function qr(e){return`${Rr($r(e))}|lt:${e.limitType}`}function Yr(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>wr(e))).join(", ")}]`),Ue(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e))).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>jn(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>jn(e))).join(",")),`Target(${t})`}($r(e))}; limitType=${e.limitType})`}function Qr(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):le.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of Vr(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=sr(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,Vr(e),t))&&!(e.endAt&&!function(e,t,n){const r=sr(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,Vr(e),t))}(e,t)}function Xr(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Jr(e){return(t,n)=>{let r=!1;for(const a of Vr(e)){const e=Zr(a,t,n);if(0!==e)return e;r=r||a.field.isKeyField()}return 0}}function Zr(e,t,n){const r=e.field.isKeyField()?le.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),a=n.data.field(e);return null!==r&&null!==a?Mn(r,a):R()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return R()}}class ea{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,a]of n)if(this.equalsFn(r,e))return a}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let a=0;a<r.length;a++)if(this.equalsFn(r[a][0],e))return void(r[a]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){tn(this.inner,((t,n)=>{for(const[r,a]of n)e(r,a)}))}isEmpty(){return nn(this.inner)}size(){return this.innerSize}}const ta=new rn(le.comparator);function na(){return ta}const ra=new rn(le.comparator);function aa(){let e=ra;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const a of n)e=e.insert(a.key,a);return e}function ia(e){let t=ra;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function sa(){return ca()}function oa(){return ca()}function ca(){return new ea((e=>e.toString()),((e,t)=>e.isEqual(t)))}const la=new rn(le.comparator),ua=new on(le.comparator);function da(){let e=ua;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const a of n)e=e.add(a);return e}const ha=new on(q);function fa(){return ha}function pa(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Be(t)?"-0":t}}function ga(e){return{integerValue:""+e}}function ma(e,t){return Ve(t)?ga(t):pa(e,t)}class va{constructor(){this._=void 0}}function ya(e,t,n){return e instanceof xa?function(e,t){const n={fields:{[yn]:{stringValue:vn},[wn]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&xn(t)&&(t=En(t)),t&&(n.fields[bn]=t),{mapValue:n}}(n,t):e instanceof Ea?Ta(e,t):e instanceof Sa?Ia(e,t):function(e,t){const n=wa(e,t),r=Ca(n)+Ca(e.Ie);return $n(n)&&$n(e.Ie)?ga(r):pa(e.serializer,r)}(e,t)}function ba(e,t,n){return e instanceof Ea?Ta(e,t):e instanceof Sa?Ia(e,t):n}function wa(e,t){return e instanceof ka?function(e){return $n(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class xa extends va{}class Ea extends va{constructor(e){super(),this.elements=e}}function Ta(e,t){const n=_a(t);for(const r of e.elements)n.some((e=>Pn(e,r)))||n.push(r);return{arrayValue:{values:n}}}class Sa extends va{constructor(e){super(),this.elements=e}}function Ia(e,t){let n=_a(t);for(const r of e.elements)n=n.filter((e=>!Pn(e,r)));return{arrayValue:{values:n}}}class ka extends va{constructor(e,t){super(),this.serializer=e,this.Ie=t}}function Ca(e){return gn(e.integerValue||e.doubleValue)}function _a(e){return Hn(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class Aa{constructor(e,t){this.field=e,this.transform=t}}class Na{constructor(e,t){this.version=e,this.transformResults=t}}class Ra{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Ra}static exists(e){return new Ra(void 0,e)}static updateTime(e){return new Ra(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Oa(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Da{}function Pa(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Ha(e.key,Ra.none()):new ja(e.key,e.data,Ra.none());{const n=e.data,r=nr.empty();let a=new on(ce.comparator);for(let e of t.fields)if(!a.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),a=a.add(e)}return new Ua(e.key,r,new un(a.toArray()),Ra.none())}}function La(e,t,n){e instanceof ja?function(e,t,n){const r=e.value.clone(),a=Va(e.fieldTransforms,t,n.transformResults);r.setAll(a),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof Ua?function(e,t,n){if(!Oa(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=Va(e.fieldTransforms,t,n.transformResults),a=t.data;a.setAll(Ba(e)),a.setAll(r),t.convertToFoundDocument(n.version,a).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function Ma(e,t,n,r){return e instanceof ja?function(e,t,n,r){if(!Oa(e.precondition,t))return n;const a=e.value.clone(),i=$a(e.fieldTransforms,r,t);return a.setAll(i),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),null}(e,t,n,r):e instanceof Ua?function(e,t,n,r){if(!Oa(e.precondition,t))return n;const a=$a(e.fieldTransforms,r,t),i=t.data;return i.setAll(Ba(e)),i.setAll(a),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,r):function(e,t,n){return Oa(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Fa(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),a=wa(r.transform,e||null);null!=a&&(null===n&&(n=nr.empty()),n.set(r.field,a))}return n||null}function za(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&J(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Ea&&t instanceof Ea||e instanceof Sa&&t instanceof Sa?J(e.elements,t.elements,Pn):e instanceof ka&&t instanceof ka?Pn(e.Ie,t.Ie):e instanceof xa&&t instanceof xa}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class ja extends Da{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Ua extends Da{constructor(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function Ba(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}})),t}function Va(e,t,n){const r=new Map;O(e.length===n.length);for(let a=0;a<n.length;a++){const i=e[a],s=i.transform,o=t.data.field(i.field);r.set(i.field,ba(s,o,n[a]))}return r}function $a(e,t,n){const r=new Map;for(const a of e){const e=a.transform,i=n.data.field(a.field);r.set(a.field,ya(e,i,t))}return r}class Ha extends Da{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Ga extends Da{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Wa{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&La(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Ma(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Ma(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=oa();return this.mutations.forEach((r=>{const a=e.get(r.key),i=a.overlayedDocument;let s=this.applyToLocalView(i,a.mutatedFields);s=t.has(r.key)?null:s;const o=Pa(i,s);null!==o&&n.set(r.key,o),i.isValidDocument()||i.convertToNoDocument(re.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),da())}isEqual(e){return this.batchId===e.batchId&&J(this.mutations,e.mutations,((e,t)=>za(e,t)))&&J(this.baseMutations,e.baseMutations,((e,t)=>za(e,t)))}}class Ka{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){O(e.mutations.length===n.length);let r=la;const a=e.mutations;for(let i=0;i<a.length;i++)r=r.insert(a[i].key,n[i].version);return new Ka(e,t,n,r)}}class qa{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Ya{constructor(e,t){this.count=e,this.unchangedNames=t}}var Qa,Xa;function Ja(e){switch(e){case P.OK:return R();case P.CANCELLED:case P.UNKNOWN:case P.DEADLINE_EXCEEDED:case P.RESOURCE_EXHAUSTED:case P.INTERNAL:case P.UNAVAILABLE:case P.UNAUTHENTICATED:return!1;case P.INVALID_ARGUMENT:case P.NOT_FOUND:case P.ALREADY_EXISTS:case P.PERMISSION_DENIED:case P.FAILED_PRECONDITION:case P.ABORTED:case P.OUT_OF_RANGE:case P.UNIMPLEMENTED:case P.DATA_LOSS:return!0;default:return R()}}function Za(e){if(void 0===e)return _("GRPC error has no .code"),P.UNKNOWN;switch(e){case Qa.OK:return P.OK;case Qa.CANCELLED:return P.CANCELLED;case Qa.UNKNOWN:return P.UNKNOWN;case Qa.DEADLINE_EXCEEDED:return P.DEADLINE_EXCEEDED;case Qa.RESOURCE_EXHAUSTED:return P.RESOURCE_EXHAUSTED;case Qa.INTERNAL:return P.INTERNAL;case Qa.UNAVAILABLE:return P.UNAVAILABLE;case Qa.UNAUTHENTICATED:return P.UNAUTHENTICATED;case Qa.INVALID_ARGUMENT:return P.INVALID_ARGUMENT;case Qa.NOT_FOUND:return P.NOT_FOUND;case Qa.ALREADY_EXISTS:return P.ALREADY_EXISTS;case Qa.PERMISSION_DENIED:return P.PERMISSION_DENIED;case Qa.FAILED_PRECONDITION:return P.FAILED_PRECONDITION;case Qa.ABORTED:return P.ABORTED;case Qa.OUT_OF_RANGE:return P.OUT_OF_RANGE;case Qa.UNIMPLEMENTED:return P.UNIMPLEMENTED;case Qa.DATA_LOSS:return P.DATA_LOSS;default:return R()}}(Xa=Qa||(Qa={}))[Xa.OK=0]="OK",Xa[Xa.CANCELLED=1]="CANCELLED",Xa[Xa.UNKNOWN=2]="UNKNOWN",Xa[Xa.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Xa[Xa.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Xa[Xa.NOT_FOUND=5]="NOT_FOUND",Xa[Xa.ALREADY_EXISTS=6]="ALREADY_EXISTS",Xa[Xa.PERMISSION_DENIED=7]="PERMISSION_DENIED",Xa[Xa.UNAUTHENTICATED=16]="UNAUTHENTICATED",Xa[Xa.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Xa[Xa.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Xa[Xa.ABORTED=10]="ABORTED",Xa[Xa.OUT_OF_RANGE=11]="OUT_OF_RANGE",Xa[Xa.UNIMPLEMENTED=12]="UNIMPLEMENTED",Xa[Xa.INTERNAL=13]="INTERNAL",Xa[Xa.UNAVAILABLE=14]="UNAVAILABLE",Xa[Xa.DATA_LOSS=15]="DATA_LOSS";let ei=null;const ti=new r([4294967295,4294967295],0);function ni(e){const t=W().encode(e),n=new a;return n.update(t),new Uint8Array(n.digest())}function ri(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),a=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new r([n,a],0),new r([i,s],0)]}class ai{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new ii(`Invalid padding: ${t}`);if(n<0)throw new ii(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new ii(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new ii(`Invalid padding when bitmap length is 0: ${t}`);this.Ee=8*e.length-t,this.de=r.fromNumber(this.Ee)}Ae(e,t,n){let a=e.add(t.multiply(r.fromNumber(n)));return 1===a.compare(ti)&&(a=new r([a.getBits(0),a.getBits(1)],0)),a.modulo(this.de).toNumber()}Re(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Ee)return!1;const t=ni(e),[n,r]=ri(t);for(let a=0;a<this.hashCount;a++){const e=this.Ae(n,r,a);if(!this.Re(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),i=new ai(a,r,t);return n.forEach((e=>i.insert(e))),i}insert(e){if(0===this.Ee)return;const t=ni(e),[n,r]=ri(t);for(let a=0;a<this.hashCount;a++){const e=this.Ae(n,r,a);this.Ve(e)}}Ve(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class ii extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class si{constructor(e,t,n,r,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,oi.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new si(re.min(),r,new rn(q),na(),da())}}class oi{constructor(e,t,n,r,a){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new oi(n,t,da(),da(),da())}}class ci{constructor(e,t,n,r){this.me=e,this.removedTargetIds=t,this.key=n,this.fe=r}}class li{constructor(e,t){this.targetId=e,this.ge=t}}class ui{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:hn.EMPTY_BYTE_STRING,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class di{constructor(){this.pe=0,this.ye=pi(),this.we=hn.EMPTY_BYTE_STRING,this.Se=!1,this.be=!0}get current(){return this.Se}get resumeToken(){return this.we}get De(){return 0!==this.pe}get ve(){return this.be}Ce(e){e.approximateByteSize()>0&&(this.be=!0,this.we=e)}Fe(){let e=da(),t=da(),n=da();return this.ye.forEach(((r,a)=>{switch(a){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:R()}})),new oi(this.we,this.Se,e,t,n)}Me(){this.be=!1,this.ye=pi()}xe(e,t){this.be=!0,this.ye=this.ye.insert(e,t)}Oe(e){this.be=!0,this.ye=this.ye.remove(e)}Ne(){this.pe+=1}Be(){this.pe-=1,O(this.pe>=0)}Le(){this.be=!0,this.Se=!0}}class hi{constructor(e){this.ke=e,this.qe=new Map,this.Qe=na(),this.$e=fi(),this.Ue=fi(),this.Ke=new rn(q)}We(e){for(const t of e.me)e.fe&&e.fe.isFoundDocument()?this.Ge(t,e.fe):this.ze(t,e.key,e.fe);for(const t of e.removedTargetIds)this.ze(t,e.key,e.fe)}je(e){this.forEachTarget(e,(t=>{const n=this.He(t);switch(e.state){case 0:this.Je(t)&&n.Ce(e.resumeToken);break;case 1:n.Be(),n.De||n.Me(),n.Ce(e.resumeToken);break;case 2:n.Be(),n.De||this.removeTarget(t);break;case 3:this.Je(t)&&(n.Le(),n.Ce(e.resumeToken));break;case 4:this.Je(t)&&(this.Ye(t),n.Ce(e.resumeToken));break;default:R()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.qe.forEach(((e,n)=>{this.Je(n)&&t(n)}))}Ze(e){const t=e.targetId,n=e.ge.count,r=this.Xe(t);if(r){const a=r.target;if(Dr(a))if(0===n){const e=new le(a.path);this.ze(t,e,ar.newNoDocument(e,re.min()))}else O(1===n);else{const r=this.et(t);if(r!==n){const n=this.tt(e),a=n?this.nt(n,e,r):1;if(0!==a){this.Ye(t);const e=2===a?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(t,e)}null==ei||ei.rt(function(e,t,n,r,a){var i,s,o,c,l,u;const d={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},h=t.unchangedNames;return h&&(d.bloomFilter={applied:0===a,hashCount:null!==(i=null==h?void 0:h.hashCount)&&void 0!==i?i:0,bitmapLength:null!==(c=null===(o=null===(s=null==h?void 0:h.bits)||void 0===s?void 0:s.bitmap)||void 0===o?void 0:o.length)&&void 0!==c?c:0,padding:null!==(u=null===(l=null==h?void 0:h.bits)||void 0===l?void 0:l.padding)&&void 0!==u?u:0,mightContain:e=>{var t;return null!==(t=null==r?void 0:r.mightContain(e))&&void 0!==t&&t}}),d}(r,e.ge,this.ke.it(),n,a))}}}}tt(e){const t=e.ge.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:a=0}=t;let i,s;try{i=mn(n).toUint8Array()}catch(e){if(e instanceof dn)return A("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{s=new ai(i,r,a)}catch(e){return A(e instanceof ii?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===s.Ee?null:s}nt(e,t,n){return t.ge.count===n-this.st(e,t.targetId)?0:2}st(e,t){const n=this.ke.getRemoteKeysForTarget(t);let r=0;return n.forEach((n=>{const a=this.ke.it(),i=`projects/${a.projectId}/databases/${a.database}/documents/${n.path.canonicalString()}`;e.mightContain(i)||(this.ze(t,n,null),r++)})),r}ot(e){const t=new Map;this.qe.forEach(((n,r)=>{const a=this.Xe(r);if(a){if(n.current&&Dr(a.target)){const t=new le(a.target.path);this._t(t).has(r)||this.ut(r,t)||this.ze(r,t,ar.newNoDocument(t,e))}n.ve&&(t.set(r,n.Fe()),n.Me())}}));let n=da();this.Ue.forEach(((e,t)=>{let r=!0;t.forEachWhile((e=>{const t=this.Xe(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)})),r&&(n=n.add(e))})),this.Qe.forEach(((t,n)=>n.setReadTime(e)));const r=new si(e,t,this.Ke,this.Qe,n);return this.Qe=na(),this.$e=fi(),this.Ue=fi(),this.Ke=new rn(q),r}Ge(e,t){if(!this.Je(e))return;const n=this.ut(e,t.key)?2:0;this.He(e).xe(t.key,n),this.Qe=this.Qe.insert(t.key,t),this.$e=this.$e.insert(t.key,this._t(t.key).add(e)),this.Ue=this.Ue.insert(t.key,this.ct(t.key).add(e))}ze(e,t,n){if(!this.Je(e))return;const r=this.He(e);this.ut(e,t)?r.xe(t,1):r.Oe(t),this.Ue=this.Ue.insert(t,this.ct(t).delete(e)),this.Ue=this.Ue.insert(t,this.ct(t).add(e)),n&&(this.Qe=this.Qe.insert(t,n))}removeTarget(e){this.qe.delete(e)}et(e){const t=this.He(e).Fe();return this.ke.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ne(e){this.He(e).Ne()}He(e){let t=this.qe.get(e);return t||(t=new di,this.qe.set(e,t)),t}ct(e){let t=this.Ue.get(e);return t||(t=new on(q),this.Ue=this.Ue.insert(e,t)),t}_t(e){let t=this.$e.get(e);return t||(t=new on(q),this.$e=this.$e.insert(e,t)),t}Je(e){const t=null!==this.Xe(e);return t||C("WatchChangeAggregator","Detected inactive target",e),t}Xe(e){const t=this.qe.get(e);return t&&t.De?null:this.ke.lt(e)}Ye(e){this.qe.set(e,new di),this.ke.getRemoteKeysForTarget(e).forEach((t=>{this.ze(e,t,null)}))}ut(e,t){return this.ke.getRemoteKeysForTarget(e).has(t)}}function fi(){return new rn(le.comparator)}function pi(){return new rn(le.comparator)}const gi={asc:"ASCENDING",desc:"DESCENDING"},mi={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},vi={and:"AND",or:"OR"};class yi{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function bi(e,t){return e.useProto3Json||Ue(t)?t:{value:t}}function wi(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function xi(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Ei(e,t){return wi(e,t.toTimestamp())}function Ti(e){return O(!!e),re.fromTimestamp(function(e){const t=pn(e);return new ne(t.seconds,t.nanos)}(e))}function Si(e,t){return Ii(e,t).canonicalString()}function Ii(e,t){const n=function(e){return new se(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function ki(e){const t=se.fromString(e);return O(qi(t)),t}function Ci(e,t){return Si(e.databaseId,t.path)}function _i(e,t){const n=ki(t);if(n.get(1)!==e.databaseId.projectId)throw new L(P.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new L(P.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new le(Oi(n))}function Ai(e,t){return Si(e.databaseId,t)}function Ni(e){const t=ki(e);return 4===t.length?se.emptyPath():Oi(t)}function Ri(e){return new se(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Oi(e){return O(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function Di(e,t,n){return{name:Ci(e,t),fields:n.value.mapValue.fields}}function Pi(e,t,n){const r=_i(e,t.name),a=Ti(t.updateTime),i=t.createTime?Ti(t.createTime):re.min(),s=new nr({mapValue:{fields:t.fields}}),o=ar.newFoundDocument(r,a,i,s);return n&&o.setHasCommittedMutations(),n?o.setHasCommittedMutations():o}function Li(e,t){let n;if(t instanceof ja)n={update:Di(e,t.key,t.value)};else if(t instanceof Ha)n={delete:Ci(e,t.key)};else if(t instanceof Ua)n={update:Di(e,t.key,t.data),updateMask:Ki(t.fieldMask)};else{if(!(t instanceof Ga))return R();n={verify:Ci(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const n=t.transform;if(n instanceof xa)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Ea)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Sa)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof ka)return{fieldPath:t.field.canonicalString(),increment:n.Ie};throw R()}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Ei(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:R()}(e,t.precondition)),n}function Mi(e,t){const n=t.currentDocument?function(e){return void 0!==e.updateTime?Ra.updateTime(Ti(e.updateTime)):void 0!==e.exists?Ra.exists(e.exists):Ra.none()}(t.currentDocument):Ra.none(),r=t.updateTransforms?t.updateTransforms.map((t=>function(e,t){let n=null;if("setToServerValue"in t)O("REQUEST_TIME"===t.setToServerValue),n=new xa;else if("appendMissingElements"in t){const e=t.appendMissingElements.values||[];n=new Ea(e)}else if("removeAllFromArray"in t){const e=t.removeAllFromArray.values||[];n=new Sa(e)}else"increment"in t?n=new ka(e,t.increment):R();const r=ce.fromServerFormat(t.fieldPath);return new Aa(r,n)}(e,t))):[];if(t.update){t.update.name;const a=_i(e,t.update.name),i=new nr({mapValue:{fields:t.update.fields}});if(t.updateMask){const e=function(e){const t=e.fieldPaths||[];return new un(t.map((e=>ce.fromServerFormat(e))))}(t.updateMask);return new Ua(a,i,e,n,r)}return new ja(a,i,n,r)}if(t.delete){const r=_i(e,t.delete);return new Ha(r,n)}if(t.verify){const r=_i(e,t.verify);return new Ga(r,n)}return R()}function Fi(e,t){return{documents:[Ai(e,t.path)]}}function zi(e,t){const n={structuredQuery:{}},r=t.path;let a;null!==t.collectionGroup?(a=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(a=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Ai(e,a);const i=function(e){if(0!==e.length)return Wi(hr.create(e,"and"))}(t.filters);i&&(n.structuredQuery.where=i);const s=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:Hi(e.field),direction:Bi(e.dir)}}(e)))}(t.orderBy);s&&(n.structuredQuery.orderBy=s);const o=bi(e,t.limit);return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{ht:n,parent:a}}function ji(e){let t=Ni(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let a=null;if(r>0){O(1===r);const e=n.from[0];e.allDescendants?a=e.collectionId:t=t.child(e.collectionId)}let i=[];n.where&&(i=function(e){const t=Ui(e);return t instanceof hr&&gr(t)?t.getFilters():[t]}(n.where));let s=[];n.orderBy&&(s=function(e){return e.map((e=>function(e){return new cr(Gi(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)))}(n.orderBy));let o=null;n.limit&&(o=function(e){let t;return t="object"==typeof e?e.value:e,Ue(t)?null:t}(n.limit));let c=null;n.startAt&&(c=function(e){const t=!!e.before,n=e.values||[];return new ir(n,t)}(n.startAt));let l=null;return n.endAt&&(l=function(e){const t=!e.before,n=e.values||[];return new ir(n,t)}(n.endAt)),zr(t,a,s,i,o,"F",c,l)}function Ui(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Gi(e.unaryFilter.field);return dr.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=Gi(e.unaryFilter.field);return dr.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Gi(e.unaryFilter.field);return dr.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Gi(e.unaryFilter.field);return dr.create(a,"!=",{nullValue:"NULL_VALUE"});default:return R()}}(e):void 0!==e.fieldFilter?function(e){return dr.create(Gi(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return R()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return hr.create(e.compositeFilter.filters.map((e=>Ui(e))),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return R()}}(e.compositeFilter.op))}(e):R()}function Bi(e){return gi[e]}function Vi(e){return mi[e]}function $i(e){return vi[e]}function Hi(e){return{fieldPath:e.canonicalString()}}function Gi(e){return ce.fromServerFormat(e.fieldPath)}function Wi(e){return e instanceof dr?function(e){if("=="===e.op){if(Wn(e.value))return{unaryFilter:{field:Hi(e.field),op:"IS_NAN"}};if(Gn(e.value))return{unaryFilter:{field:Hi(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Wn(e.value))return{unaryFilter:{field:Hi(e.field),op:"IS_NOT_NAN"}};if(Gn(e.value))return{unaryFilter:{field:Hi(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Hi(e.field),op:Vi(e.op),value:e.value}}}(e):e instanceof hr?function(e){const t=e.getFilters().map((e=>Wi(e)));return 1===t.length?t[0]:{compositeFilter:{op:$i(e.op),filters:t}}}(e):R()}function Ki(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function qi(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class Yi{constructor(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:re.min(),i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:re.min(),s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:hn.EMPTY_BYTE_STRING,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=i,this.resumeToken=s,this.expectedCount=o}withSequenceNumber(e){return new Yi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Yi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Yi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Yi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Qi{constructor(e){this.Tt=e}}function Xi(e,t){const n=t.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Ji(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())r.document=function(e,t){return{name:Ci(e,t.key),fields:t.data.value.mapValue.fields,updateTime:wi(e,t.version.toTimestamp()),createTime:wi(e,t.createTime.toTimestamp())}}(e.Tt,t);else if(t.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Zi(t.version)};else{if(!t.isUnknownDocument())return R();r.unknownDocument={path:n.path.toArray(),version:Zi(t.version)}}return r}function Ji(e){const t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function Zi(e){const t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function es(e){const t=new ne(e.seconds,e.nanoseconds);return re.fromTimestamp(t)}function ts(e,t){const n=(t.baseMutations||[]).map((t=>Mi(e.Tt,t)));for(let i=0;i<t.mutations.length-1;++i){const e=t.mutations[i];if(i+1<t.mutations.length&&void 0!==t.mutations[i+1].transform){const n=t.mutations[i+1];e.updateTransforms=n.transform.fieldTransforms,t.mutations.splice(i+1,1),++i}}const r=t.mutations.map((t=>Mi(e.Tt,t))),a=ne.fromMillis(t.localWriteTimeMs);return new Wa(t.batchId,a,n,r)}function ns(e){const t=es(e.readTime),n=void 0!==e.lastLimboFreeSnapshotVersion?es(e.lastLimboFreeSnapshotVersion):re.min();let r;return r=function(e){return void 0!==e.documents}(e.query)?function(e){return O(1===e.documents.length),$r(jr(Ni(e.documents[0])))}(e.query):function(e){return $r(ji(e))}(e.query),new Yi(r,e.targetId,"TargetPurposeListen",e.lastListenSequenceNumber,t,n,hn.fromBase64String(e.resumeToken))}function rs(e,t){const n=Zi(t.snapshotVersion),r=Zi(t.lastLimboFreeSnapshotVersion);let a;a=Dr(t.target)?Fi(e.Tt,t.target):zi(e.Tt,t.target).ht;const i=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:Rr(t.target),readTime:n,resumeToken:i,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:a}}function as(e){const t=ji({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Wr(t,t.limit,"L"):t}function is(e,t){return new qa(t.largestBatchId,Mi(e.Tt,t.overlayMutation))}function ss(e,t){const n=t.path.lastSegment();return[e,He(t.path.popLast()),n]}function os(e,t,n,r){return{indexId:e,uid:t,sequenceNumber:n,readTime:Zi(r.readTime),documentKey:He(r.documentKey.path),largestBatchId:r.largestBatchId}}class cs{getBundleMetadata(e,t){return ls(e).get(t).next((e=>{if(e)return function(e){return{id:e.bundleId,createTime:es(e.createTime),version:e.version}}(e)}))}saveBundleMetadata(e,t){return ls(e).put(function(e){return{bundleId:e.id,createTime:Zi(Ti(e.createTime)),version:e.version}}(t))}getNamedQuery(e,t){return us(e).get(t).next((e=>{if(e)return function(e){return{name:e.name,query:as(e.bundledQuery),readTime:es(e.readTime)}}(e)}))}saveNamedQuery(e,t){return us(e).put(function(e){return{name:e.name,readTime:Zi(Ti(e.readTime)),bundledQuery:e.bundledQuery}}(t))}}function ls(e){return Zt(e,kt)}function us(e){return Zt(e,Ct)}class ds{constructor(e,t){this.serializer=e,this.userId=t}static It(e,t){const n=t.uid||"";return new ds(e,n)}getOverlay(e,t){return hs(e).get(ss(this.userId,t)).next((e=>e?is(this.serializer,e):null))}getOverlays(e,t){const n=sa();return Te.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){const r=[];return n.forEach(((n,a)=>{const i=new qa(t,a);r.push(this.Et(e,i))})),Te.waitFor(r)}removeOverlaysForBatchId(e,t,n){const r=new Set;t.forEach((e=>r.add(He(e.getCollectionPath()))));const a=[];return r.forEach((t=>{const r=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,n+1],!1,!0);a.push(hs(e).J(Ut,r))})),Te.waitFor(a)}getOverlaysForCollection(e,t,n){const r=sa(),a=He(t),i=IDBKeyRange.bound([this.userId,a,n],[this.userId,a,Number.POSITIVE_INFINITY],!0);return hs(e).G(Ut,i).next((e=>{for(const t of e){const e=is(this.serializer,t);r.set(e.getKey(),e)}return r}))}getOverlaysForCollectionGroup(e,t,n,r){const a=sa();let i;const s=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return hs(e).Z({index:Vt,range:s},((e,t,n)=>{const s=is(this.serializer,t);a.size()<r||s.largestBatchId===i?(a.set(s.getKey(),s),i=s.largestBatchId):n.done()})).next((()=>a))}Et(e,t){return hs(e).put(function(e,t,n){const[r,a,i]=ss(t,n.mutation.key);return{userId:t,collectionPath:a,documentId:i,collectionGroup:n.mutation.key.getCollectionGroup(),largestBatchId:n.largestBatchId,overlayMutation:Li(e.Tt,n.mutation)}}(this.serializer,this.userId,t))}}function hs(e){return Zt(e,zt)}class fs{dt(e){return Zt(e,Ht)}getSessionToken(e){return this.dt(e).get("sessionToken").next((e=>{const t=null==e?void 0:e.value;return t?hn.fromUint8Array(t):hn.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.dt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class ps{constructor(){}At(e,t){this.Rt(e,t),t.Vt()}Rt(e,t){if("nullValue"in e)this.ft(t,5);else if("booleanValue"in e)this.ft(t,10),t.gt(e.booleanValue?1:0);else if("integerValue"in e)this.ft(t,15),t.gt(gn(e.integerValue));else if("doubleValue"in e){const n=gn(e.doubleValue);isNaN(n)?this.ft(t,13):(this.ft(t,15),Be(n)?t.gt(0):t.gt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.ft(t,20),"string"==typeof n&&(n=pn(n)),t.yt(`${n.seconds||""}`),t.gt(n.nanos||0)}else if("stringValue"in e)this.wt(e.stringValue,t),this.St(t);else if("bytesValue"in e)this.ft(t,30),t.bt(mn(e.bytesValue)),this.St(t);else if("referenceValue"in e)this.Dt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.ft(t,45),t.gt(n.latitude||0),t.gt(n.longitude||0)}else"mapValue"in e?Qn(e)?this.ft(t,Number.MAX_SAFE_INTEGER):qn(e)?this.vt(e.mapValue,t):(this.Ct(e.mapValue,t),this.St(t)):"arrayValue"in e?(this.Ft(e.arrayValue,t),this.St(t)):R()}wt(e,t){this.ft(t,25),this.Mt(e,t)}Mt(e,t){t.yt(e)}Ct(e,t){const n=e.fields||{};this.ft(t,55);for(const r of Object.keys(n))this.wt(r,t),this.Rt(n[r],t)}vt(e,t){var n,r;const a=e.fields||{};this.ft(t,53);const i=Rn,s=(null===(r=null===(n=a[i].arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.length)||0;this.ft(t,15),t.gt(gn(s)),this.wt(i,t),this.Rt(a[i],t)}Ft(e,t){const n=e.values||[];this.ft(t,50);for(const r of n)this.Rt(r,t)}Dt(e,t){this.ft(t,37),le.fromName(e).path.forEach((e=>{this.ft(t,60),this.Mt(e,t)}))}ft(e,t){e.gt(t)}St(e){e.gt(2)}}ps.xt=new ps;const gs=255;function ms(e){if(0===e)return 8;let t=0;return e>>4||(t+=4,e<<=4),e>>6||(t+=2,e<<=2),e>>7||(t+=1),t}function vs(e){const t=64-function(e){let t=0;for(let n=0;n<8;++n){const r=ms(255&e[n]);if(t+=r,8!==r)break}return t}(e);return Math.ceil(t/8)}class ys{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ot(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Nt(n.value),n=t.next();this.Bt()}Lt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.kt(n.value),n=t.next();this.qt()}Qt(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.Nt(e);else if(e<2048)this.Nt(960|e>>>6),this.Nt(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Nt(480|e>>>12),this.Nt(128|63&e>>>6),this.Nt(128|63&e);else{const e=t.codePointAt(0);this.Nt(240|e>>>18),this.Nt(128|63&e>>>12),this.Nt(128|63&e>>>6),this.Nt(128|63&e)}}this.Bt()}$t(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.kt(e);else if(e<2048)this.kt(960|e>>>6),this.kt(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.kt(480|e>>>12),this.kt(128|63&e>>>6),this.kt(128|63&e);else{const e=t.codePointAt(0);this.kt(240|e>>>18),this.kt(128|63&e>>>12),this.kt(128|63&e>>>6),this.kt(128|63&e)}}this.qt()}Ut(e){const t=this.Kt(e),n=vs(t);this.Wt(1+n),this.buffer[this.position++]=255&n;for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=255&t[r]}Gt(e){const t=this.Kt(e),n=vs(t);this.Wt(1+n),this.buffer[this.position++]=~(255&n);for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}zt(){this.jt(gs),this.jt(255)}Ht(){this.Jt(gs),this.Jt(255)}reset(){this.position=0}seed(e){this.Wt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Yt(){return this.buffer.slice(0,this.position)}Kt(e){const t=function(e){const t=new DataView(new ArrayBuffer(8));return t.setFloat64(0,e,!1),new Uint8Array(t.buffer)}(e),n=!!(128&t[0]);t[0]^=n?255:128;for(let r=1;r<t.length;++r)t[r]^=n?255:0;return t}Nt(e){const t=255&e;0===t?(this.jt(0),this.jt(255)):t===gs?(this.jt(gs),this.jt(0)):this.jt(t)}kt(e){const t=255&e;0===t?(this.Jt(0),this.Jt(255)):t===gs?(this.Jt(gs),this.Jt(0)):this.Jt(e)}Bt(){this.jt(0),this.jt(1)}qt(){this.Jt(0),this.Jt(1)}jt(e){this.Wt(1),this.buffer[this.position++]=e}Jt(e){this.Wt(1),this.buffer[this.position++]=~e}Wt(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}}class bs{constructor(e){this.Zt=e}bt(e){this.Zt.Ot(e)}yt(e){this.Zt.Qt(e)}gt(e){this.Zt.Ut(e)}Vt(){this.Zt.zt()}}class ws{constructor(e){this.Zt=e}bt(e){this.Zt.Lt(e)}yt(e){this.Zt.$t(e)}gt(e){this.Zt.Gt(e)}Vt(){this.Zt.Ht()}}class xs{constructor(){this.Zt=new ys,this.Xt=new bs(this.Zt),this.en=new ws(this.Zt)}seed(e){this.Zt.seed(e)}tn(e){return 0===e?this.Xt:this.en}Yt(){return this.Zt.Yt()}reset(){this.Zt.reset()}}class Es{constructor(e,t,n,r){this.indexId=e,this.documentKey=t,this.arrayValue=n,this.directionalValue=r}nn(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,n=new Uint8Array(t);return n.set(this.directionalValue,0),t!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new Es(this.indexId,this.documentKey,this.arrayValue,n)}}function Ts(e,t){let n=e.indexId-t.indexId;return 0!==n?n:(n=Ss(e.arrayValue,t.arrayValue),0!==n?n:(n=Ss(e.directionalValue,t.directionalValue),0!==n?n:le.comparator(e.documentKey,t.documentKey)))}function Ss(e,t){for(let n=0;n<e.length&&n<t.length;++n){const r=e[n]-t[n];if(0!==r)return r}return e.length-t.length}class Is{constructor(e){this.rn=new on(((e,t)=>ce.comparator(e.field,t.field))),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.sn=e.orderBy,this._n=[];for(const t of e.filters){const e=t;e.isInequality()?this.rn=this.rn.add(e):this._n.push(e)}}get an(){return this.rn.size>1}un(e){if(O(e.collectionGroup===this.collectionId),this.an)return!1;const t=he(e);if(void 0!==t&&!this.cn(t))return!1;const n=fe(e);let r=new Set,a=0,i=0;for(;a<n.length&&this.cn(n[a]);++a)r=r.add(n[a].fieldPath.canonicalString());if(a===n.length)return!0;if(this.rn.size>0){const e=this.rn.getIterator().getNext();if(!r.has(e.field.canonicalString())){const t=n[a];if(!this.ln(e,t)||!this.hn(this.sn[i++],t))return!1}++a}for(;a<n.length;++a){const e=n[a];if(i>=this.sn.length||!this.hn(this.sn[i++],e))return!1}return!0}Pn(){if(this.an)return null;let e=new on(ce.comparator);const t=[];for(const n of this._n)if(!n.field.isKeyField())if("array-contains"===n.op||"array-contains-any"===n.op)t.push(new pe(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new pe(n.field,0))}for(const n of this.sn)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new pe(n.field,"asc"===n.dir?0:1)));return new de(de.UNKNOWN_ID,this.collectionId,t,ge.empty())}cn(e){for(const t of this._n)if(this.ln(t,e))return!0;return!1}ln(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;const n="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===n}hn(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function ks(e){var t,n;if(O(e instanceof dr||e instanceof hr),e instanceof dr){if(e instanceof kr){const r=(null===(n=null===(t=e.value.arrayValue)||void 0===t?void 0:t.values)||void 0===n?void 0:n.map((t=>dr.create(e.field,"==",t))))||[];return hr.create(r,"or")}return e}const r=e.filters.map((e=>ks(e)));return hr.create(r,e.op)}function Cs(e){if(0===e.getFilters().length)return[];const t=Rs(ks(e));return O(Ns(t)),_s(t)||As(t)?[t]:t.getFilters()}function _s(e){return e instanceof dr}function As(e){return e instanceof hr&&gr(e)}function Ns(e){return _s(e)||As(e)||function(e){if(e instanceof hr&&pr(e)){for(const t of e.getFilters())if(!_s(t)&&!As(t))return!1;return!0}return!1}(e)}function Rs(e){if(O(e instanceof dr||e instanceof hr),e instanceof dr)return e;if(1===e.filters.length)return Rs(e.filters[0]);const t=e.filters.map((e=>Rs(e)));let n=hr.create(t,e.op);return n=Ps(n),Ns(n)?n:(O(n instanceof hr),O(fr(n)),O(n.filters.length>1),n.filters.reduce(((e,t)=>Os(e,t))))}function Os(e,t){let n;return O(e instanceof dr||e instanceof hr),O(t instanceof dr||t instanceof hr),n=e instanceof dr?t instanceof dr?function(e,t){return hr.create([e,t],"and")}(e,t):Ds(e,t):t instanceof dr?Ds(t,e):function(e,t){if(O(e.filters.length>0&&t.filters.length>0),fr(e)&&fr(t))return br(e,t.getFilters());const n=pr(e)?e:t,r=pr(e)?t:e,a=n.filters.map((e=>Os(e,r)));return hr.create(a,"or")}(e,t),Ps(n)}function Ds(e,t){if(fr(t))return br(t,e.getFilters());{const n=t.filters.map((t=>Os(e,t)));return hr.create(n,"or")}}function Ps(e){if(O(e instanceof dr||e instanceof hr),e instanceof dr)return e;const t=e.getFilters();if(1===t.length)return Ps(t[0]);if(mr(e))return e;const n=t.map((e=>Ps(e))),r=[];return n.forEach((t=>{t instanceof dr?r.push(t):t instanceof hr&&(t.op===e.op?r.push(...t.filters):r.push(t))})),1===r.length?r[0]:hr.create(r,e.op)}class Ls{constructor(){this.Tn=new Ms}addToCollectionParentIndex(e,t){return this.Tn.add(t),Te.resolve()}getCollectionParents(e,t){return Te.resolve(this.Tn.getEntries(t))}addFieldIndex(e,t){return Te.resolve()}deleteFieldIndex(e,t){return Te.resolve()}deleteAllFieldIndexes(e){return Te.resolve()}createTargetIndexes(e,t){return Te.resolve()}getDocumentsMatchingTarget(e,t){return Te.resolve(null)}getIndexType(e,t){return Te.resolve(0)}getFieldIndexes(e,t){return Te.resolve([])}getNextCollectionGroupToUpdate(e){return Te.resolve(null)}getMinOffset(e,t){return Te.resolve(ye.min())}getMinOffsetFromCollectionGroup(e,t){return Te.resolve(ye.min())}updateCollectionGroup(e,t,n){return Te.resolve()}updateIndexEntries(e,t){return Te.resolve()}}class Ms{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new on(se.comparator),a=!r.has(n);return this.index[t]=r.add(n),a}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new on(se.comparator)).toArray()}}const Fs="IndexedDbIndexManager",zs=new Uint8Array(0);class js{constructor(e,t){this.databaseId=t,this.In=new Ms,this.En=new ea((e=>Rr(e)),((e,t)=>Or(e,t))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.In.has(t)){const n=t.lastSegment(),r=t.popLast();e.addOnCommittedListener((()=>{this.In.add(t)}));const a={collectionId:n,parent:He(r)};return Us(e).put(a)}return Te.resolve()}getCollectionParents(e,t){const n=[],r=IDBKeyRange.bound([t,""],[Z(t),""],!1,!0);return Us(e).G(r).next((e=>{for(const r of e){if(r.collectionId!==t)break;n.push(Ke(r.parent))}return n}))}addFieldIndex(e,t){const n=Vs(e),r=function(e){return{indexId:e.indexId,collectionGroup:e.collectionGroup,fields:e.fields.map((e=>[e.fieldPath.canonicalString(),e.kind]))}}(t);delete r.indexId;const a=n.add(r);if(t.indexState){const n=$s(e);return a.next((e=>{n.put(os(e,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return a.next()}deleteFieldIndex(e,t){const n=Vs(e),r=$s(e),a=Bs(e);return n.delete(t.indexId).next((()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Vs(e),n=Bs(e),r=$s(e);return t.J().next((()=>n.J())).next((()=>r.J()))}createTargetIndexes(e,t){return Te.forEach(this.dn(t),(t=>this.getIndexType(e,t).next((n=>{if(0===n||1===n){const n=new Is(t).Pn();if(null!=n)return this.addFieldIndex(e,n)}}))))}getDocumentsMatchingTarget(e,t){const n=Bs(e);let r=!0;const a=new Map;return Te.forEach(this.dn(t),(t=>this.An(e,t).next((e=>{r&&(r=!!e),a.set(t,e)})))).next((()=>{if(r){let e=da();const r=[];return Te.forEach(a,((a,i)=>{C(Fs,`Using index ${function(e){return`id=${e.indexId}|cg=${e.collectionGroup}|f=${e.fields.map((e=>`${e.fieldPath}:${e.kind}`)).join(",")}`}(a)} to execute ${Rr(t)}`);const s=function(e,t){const n=he(t);if(void 0===n)return null;for(const r of Pr(e,n.fieldPath))switch(r.op){case"array-contains-any":return r.value.arrayValue.values||[];case"array-contains":return[r.value]}return null}(i,a),o=function(e,t){const n=new Map;for(const r of fe(t))for(const t of Pr(e,r.fieldPath))switch(t.op){case"==":case"in":n.set(r.fieldPath.canonicalString(),t.value);break;case"not-in":case"!=":return n.set(r.fieldPath.canonicalString(),t.value),Array.from(n.values())}return null}(i,a),c=function(e,t){const n=[];let r=!0;for(const a of fe(t)){const t=0===a.kind?Lr(e,a.fieldPath,e.startAt):Mr(e,a.fieldPath,e.startAt);n.push(t.value),r&&(r=t.inclusive)}return new ir(n,r)}(i,a),l=function(e,t){const n=[];let r=!0;for(const a of fe(t)){const t=0===a.kind?Mr(e,a.fieldPath,e.endAt):Lr(e,a.fieldPath,e.endAt);n.push(t.value),r&&(r=t.inclusive)}return new ir(n,r)}(i,a),u=this.Rn(a,i,c),d=this.Rn(a,i,l),h=this.Vn(a,i,o),f=this.mn(a.indexId,s,u,c.inclusive,d,l.inclusive,h);return Te.forEach(f,(a=>n.H(a,t.limit).next((t=>{t.forEach((t=>{const n=le.fromSegments(t.documentKey);e.has(n)||(e=e.add(n),r.push(n))}))}))))})).next((()=>r))}return Te.resolve(null)}))}dn(e){let t=this.En.get(e);return t||(t=0===e.filters.length?[e]:Cs(hr.create(e.filters,"and")).map((t=>Nr(e.path,e.collectionGroup,e.orderBy,t.getFilters(),e.limit,e.startAt,e.endAt))),this.En.set(e,t),t)}mn(e,t,n,r,a,i,s){const o=(null!=t?t.length:1)*Math.max(n.length,a.length),c=o/(null!=t?t.length:1),l=[];for(let u=0;u<o;++u){const o=t?this.fn(t[u/c]):zs,d=this.gn(e,o,n[u%c],r),h=this.pn(e,o,a[u%c],i),f=s.map((t=>this.gn(e,o,t,!0)));l.push(...this.createRange(d,h,f))}return l}gn(e,t,n,r){const a=new Es(e,le.empty(),t,n);return r?a:a.nn()}pn(e,t,n,r){const a=new Es(e,le.empty(),t,n);return r?a.nn():a}An(e,t){const n=new Is(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((e=>{let t=null;for(const r of e)n.un(r)&&(!t||r.fields.length>t.fields.length)&&(t=r);return t}))}getIndexType(e,t){let n=2;const r=this.dn(t);return Te.forEach(r,(t=>this.An(e,t).next((e=>{e?0!==n&&e.fields.length<function(e){let t=new on(ce.comparator),n=!1;for(const r of e.filters)for(const e of r.getFlattenedFilters())e.field.isKeyField()||("array-contains"===e.op||"array-contains-any"===e.op?n=!0:t=t.add(e.field));for(const r of e.orderBy)r.field.isKeyField()||(t=t.add(r.field));return t.size+(n?1:0)}(t)&&(n=1):n=0})))).next((()=>function(e){return null!==e.limit}(t)&&r.length>1&&2===n?1:n))}yn(e,t){const n=new xs;for(const r of fe(e)){const e=t.data.field(r.fieldPath);if(null==e)return null;const a=n.tn(r.kind);ps.xt.At(e,a)}return n.Yt()}fn(e){const t=new xs;return ps.xt.At(e,t.tn(0)),t.Yt()}wn(e,t){const n=new xs;return ps.xt.At(Vn(this.databaseId,t),n.tn(function(e){const t=fe(e);return 0===t.length?0:t[t.length-1].kind}(e))),n.Yt()}Vn(e,t,n){if(null===n)return[];let r=[];r.push(new xs);let a=0;for(const i of fe(e)){const e=n[a++];for(const n of r)if(this.Sn(t,i.fieldPath)&&Hn(e))r=this.bn(r,i,e);else{const t=n.tn(i.kind);ps.xt.At(e,t)}}return this.Dn(r)}Rn(e,t,n){return this.Vn(e,t,n.position)}Dn(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].Yt();return t}bn(e,t,n){const r=[...e],a=[];for(const i of n.arrayValue.values||[])for(const e of r){const n=new xs;n.seed(e.Yt()),ps.xt.At(i,n.tn(t.kind)),a.push(n)}return a}Sn(e,t){return!!e.filters.find((e=>e instanceof dr&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op)))}getFieldIndexes(e,t){const n=Vs(e),r=$s(e);return(t?n.G(At,IDBKeyRange.bound(t,t)):n.G()).next((e=>{const t=[];return Te.forEach(e,(e=>r.get([e.indexId,this.uid]).next((n=>{t.push(function(e,t){const n=t?new ge(t.sequenceNumber,new ye(es(t.readTime),new le(Ke(t.documentKey)),t.largestBatchId)):ge.empty(),r=e.fields.map((e=>{let[t,n]=e;return new pe(ce.fromServerFormat(t),n)}));return new de(e.indexId,e.collectionGroup,r,n)}(e,n))})))).next((()=>t))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((e=>0===e.length?null:(e.sort(((e,t)=>{const n=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==n?n:q(e.collectionGroup,t.collectionGroup)})),e[0].collectionGroup)))}updateCollectionGroup(e,t,n){const r=Vs(e),a=$s(e);return this.vn(e).next((e=>r.G(At,IDBKeyRange.bound(t,t)).next((t=>Te.forEach(t,(t=>a.put(os(t.indexId,this.uid,e,n))))))))}updateIndexEntries(e,t){const n=new Map;return Te.forEach(t,((t,r)=>{const a=n.get(t.collectionGroup);return(a?Te.resolve(a):this.getFieldIndexes(e,t.collectionGroup)).next((a=>(n.set(t.collectionGroup,a),Te.forEach(a,(n=>this.Cn(e,t,n).next((t=>{const a=this.Fn(r,n);return t.isEqual(a)?Te.resolve():this.Mn(e,r,n,t,a)})))))))}))}xn(e,t,n,r){return Bs(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.wn(n,t.key),documentKey:t.key.path.toArray()})}On(e,t,n,r){return Bs(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.wn(n,t.key),t.key.path.toArray()])}Cn(e,t,n){const r=Bs(e);let a=new on(Ts);return r.Z({index:Mt,range:IDBKeyRange.only([n.indexId,this.uid,this.wn(n,t)])},((e,r)=>{a=a.add(new Es(n.indexId,t,r.arrayValue,r.directionalValue))})).next((()=>a))}Fn(e,t){let n=new on(Ts);const r=this.yn(t,e);if(null==r)return n;const a=he(t);if(null!=a){const i=e.data.field(a.fieldPath);if(Hn(i))for(const a of i.arrayValue.values||[])n=n.add(new Es(t.indexId,e.key,this.fn(a),r))}else n=n.add(new Es(t.indexId,e.key,zs,r));return n}Mn(e,t,n,r,a){C(Fs,"Updating index entries for document '%s'",t.key);const i=[];return function(e,t,n,r,a){const i=e.getIterator(),s=t.getIterator();let o=ln(i),c=ln(s);for(;o||c;){let e=!1,t=!1;if(o&&c){const r=n(o,c);r<0?t=!0:r>0&&(e=!0)}else null!=o?t=!0:e=!0;e?(r(c),c=ln(s)):t?(a(o),o=ln(i)):(o=ln(i),c=ln(s))}}(r,a,Ts,(r=>{i.push(this.xn(e,t,n,r))}),(r=>{i.push(this.On(e,t,n,r))})),Te.waitFor(i)}vn(e){let t=1;return $s(e).Z({index:Ot,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((e,n,r)=>{r.done(),t=n.sequenceNumber+1})).next((()=>t))}createRange(e,t,n){n=n.sort(((e,t)=>Ts(e,t))).filter(((e,t,n)=>!t||0!==Ts(e,n[t-1])));const r=[];r.push(e);for(const i of n){const n=Ts(i,e),a=Ts(i,t);if(0===n)r[0]=e.nn();else if(n>0&&a<0)r.push(i),r.push(i.nn());else if(a>0)break}r.push(t);const a=[];for(let i=0;i<r.length;i+=2){if(this.Nn(r[i],r[i+1]))return[];const e=[r[i].indexId,this.uid,r[i].arrayValue,r[i].directionalValue,zs,[]],t=[r[i+1].indexId,this.uid,r[i+1].arrayValue,r[i+1].directionalValue,zs,[]];a.push(IDBKeyRange.bound(e,t))}return a}Nn(e,t){return Ts(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Hs)}getMinOffset(e,t){return Te.mapArray(this.dn(t),(t=>this.An(e,t).next((e=>e||R())))).next(Hs)}}function Us(e){return Zt(e,Tt)}function Bs(e){return Zt(e,Pt)}function Vs(e){return Zt(e,_t)}function $s(e){return Zt(e,Nt)}function Hs(e){O(0!==e.length);let t=e[0].indexState.offset,n=t.largestBatchId;for(let r=1;r<e.length;r++){const a=e[r].indexState.offset;be(a,t)<0&&(t=a),n<a.largestBatchId&&(n=a.largestBatchId)}return new ye(t.readTime,t.documentKey,n)}const Gs={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Ws=41943040;class Ks{static withCacheSize(e){return new Ks(e,Ks.DEFAULT_COLLECTION_PERCENTILE,Ks.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}function qs(e,t,n){const r=e.store(Je),a=e.store(it),i=[],s=IDBKeyRange.only(n.batchId);let o=0;const c=r.Z({range:s},((e,t,n)=>(o++,n.delete())));i.push(c.next((()=>{O(1===o)})));const l=[];for(const u of n.mutations){const e=rt(t,u.key.path,n.batchId);i.push(a.delete(e)),l.push(u.key)}return Te.waitFor(i).next((()=>l))}function Ys(e){if(!e)return 0;let t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw R();t=e.noDocument}return JSON.stringify(t).length}Ks.DEFAULT_COLLECTION_PERCENTILE=10,Ks.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ks.DEFAULT=new Ks(Ws,Ks.DEFAULT_COLLECTION_PERCENTILE,Ks.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ks.DISABLED=new Ks(-1,0,0);class Qs{constructor(e,t,n,r){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=r,this.Bn={}}static It(e,t,n,r){O(""!==e.uid);const a=e.isAuthenticated()?e.uid:"";return new Qs(a,t,n,r)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Js(e).Z({index:et,range:n},((e,n,r)=>{t=!1,r.done()})).next((()=>t))}addMutationBatch(e,t,n,r){const a=Zs(e),i=Js(e);return i.add({}).next((s=>{O("number"==typeof s);const o=new Wa(s,t,n,r),c=function(e,t,n){const r=n.baseMutations.map((t=>Li(e.Tt,t))),a=n.mutations.map((t=>Li(e.Tt,t)));return{userId:t,batchId:n.batchId,localWriteTimeMs:n.localWriteTime.toMillis(),baseMutations:r,mutations:a}}(this.serializer,this.userId,o),l=[];let u=new on(((e,t)=>q(e.canonicalString(),t.canonicalString())));for(const e of r){const t=rt(this.userId,e.key.path,s);u=u.add(e.key.path.popLast()),l.push(i.put(c)),l.push(a.put(t,at))}return u.forEach((t=>{l.push(this.indexManager.addToCollectionParentIndex(e,t))})),e.addOnCommittedListener((()=>{this.Bn[s]=o.keys()})),Te.waitFor(l).next((()=>o))}))}lookupMutationBatch(e,t){return Js(e).get(t).next((e=>e?(O(e.userId===this.userId),ts(this.serializer,e)):null))}Ln(e,t){return this.Bn[t]?Te.resolve(this.Bn[t]):this.lookupMutationBatch(e,t).next((e=>{if(e){const n=e.keys();return this.Bn[t]=n,n}return null}))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=IDBKeyRange.lowerBound([this.userId,n]);let a=null;return Js(e).Z({index:et,range:r},((e,t,r)=>{t.userId===this.userId&&(O(t.batchId>=n),a=ts(this.serializer,t)),r.done()})).next((()=>a))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=je;return Js(e).Z({index:et,range:t,reverse:!0},((e,t,r)=>{n=t.batchId,r.done()})).next((()=>n))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,je],[this.userId,Number.POSITIVE_INFINITY]);return Js(e).G(et,t).next((e=>e.map((e=>ts(this.serializer,e)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=nt(this.userId,t.path),r=IDBKeyRange.lowerBound(n),a=[];return Zs(e).Z({range:r},((n,r,i)=>{const[s,o,c]=n,l=Ke(o);if(s===this.userId&&t.path.isEqual(l))return Js(e).get(c).next((e=>{if(!e)throw R();O(e.userId===this.userId),a.push(ts(this.serializer,e))}));i.done()})).next((()=>a))}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new on(q);const r=[];return t.forEach((t=>{const a=nt(this.userId,t.path),i=IDBKeyRange.lowerBound(a),s=Zs(e).Z({range:i},((e,r,a)=>{const[i,s,o]=e,c=Ke(s);i===this.userId&&t.path.isEqual(c)?n=n.add(o):a.done()}));r.push(s)})),Te.waitFor(r).next((()=>this.kn(e,n)))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1,a=nt(this.userId,n),i=IDBKeyRange.lowerBound(a);let s=new on(q);return Zs(e).Z({range:i},((e,t,a)=>{const[i,o,c]=e,l=Ke(o);i===this.userId&&n.isPrefixOf(l)?l.length===r&&(s=s.add(c)):a.done()})).next((()=>this.kn(e,s)))}kn(e,t){const n=[],r=[];return t.forEach((t=>{r.push(Js(e).get(t).next((e=>{if(null===e)throw R();O(e.userId===this.userId),n.push(ts(this.serializer,e))})))})),Te.waitFor(r).next((()=>n))}removeMutationBatch(e,t){return qs(e.ue,this.userId,t).next((n=>(e.addOnCommittedListener((()=>{this.qn(t.batchId)})),Te.forEach(n,(t=>this.referenceDelegate.markPotentiallyOrphaned(e,t))))))}qn(e){delete this.Bn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return Te.resolve();const n=IDBKeyRange.lowerBound(function(e){return[e]}(this.userId)),r=[];return Zs(e).Z({range:n},((e,t,n)=>{if(e[0]===this.userId){const t=Ke(e[1]);r.push(t)}else n.done()})).next((()=>{O(0===r.length)}))}))}containsKey(e,t){return Xs(e,this.userId,t)}Qn(e){return eo(e).get(this.userId).next((e=>e||{userId:this.userId,lastAcknowledgedBatchId:je,lastStreamToken:""}))}}function Xs(e,t,n){const r=nt(t,n.path),a=r[1],i=IDBKeyRange.lowerBound(r);let s=!1;return Zs(e).Z({range:i,Y:!0},((e,n,r)=>{const[i,o,c]=e;i===t&&o===a&&(s=!0),r.done()})).next((()=>s))}function Js(e){return Zt(e,Je)}function Zs(e){return Zt(e,it)}function eo(e){return Zt(e,Xe)}class to{constructor(e){this.$n=e}next(){return this.$n+=2,this.$n}static Un(){return new to(0)}static Kn(){return new to(-1)}}class no{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Wn(e).next((t=>{const n=new to(t.highestTargetId);return t.highestTargetId=n.next(),this.Gn(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.Wn(e).next((e=>re.fromTimestamp(new ne(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.Wn(e).next((e=>e.highestListenSequenceNumber))}setTargetsMetadata(e,t,n){return this.Wn(e).next((r=>(r.highestListenSequenceNumber=t,n&&(r.lastRemoteSnapshotVersion=n.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.Gn(e,r))))}addTargetData(e,t){return this.zn(e,t).next((()=>this.Wn(e).next((n=>(n.targetCount+=1,this.jn(t,n),this.Gn(e,n))))))}updateTargetData(e,t){return this.zn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>ro(e).delete(t.targetId))).next((()=>this.Wn(e))).next((t=>(O(t.targetCount>0),t.targetCount-=1,this.Gn(e,t))))}removeTargets(e,t,n){let r=0;const a=[];return ro(e).Z(((i,s)=>{const o=ns(s);o.sequenceNumber<=t&&null===n.get(o.targetId)&&(r++,a.push(this.removeTargetData(e,o)))})).next((()=>Te.waitFor(a))).next((()=>r))}forEachTarget(e,t){return ro(e).Z(((e,n)=>{const r=ns(n);t(r)}))}Wn(e){return ao(e).get(xt).next((e=>(O(null!==e),e)))}Gn(e,t){return ao(e).put(xt,t)}zn(e,t){return ro(e).put(rs(this.serializer,t))}jn(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.Wn(e).next((e=>e.targetCount))}getTargetData(e,t){const n=Rr(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let a=null;return ro(e).Z({range:r,index:gt},((e,n,r)=>{const i=ns(n);Or(t,i.target)&&(a=i,r.done())})).next((()=>a))}addMatchingKeys(e,t,n){const r=[],a=io(e);return t.forEach((t=>{const i=He(t.path);r.push(a.put({targetId:n,path:i})),r.push(this.referenceDelegate.addReference(e,n,t))})),Te.waitFor(r)}removeMatchingKeys(e,t,n){const r=io(e);return Te.forEach(t,(t=>{const a=He(t.path);return Te.waitFor([r.delete([n,a]),this.referenceDelegate.removeReference(e,n,t)])}))}removeMatchingKeysForTargetId(e,t){const n=io(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),r=io(e);let a=da();return r.Z({range:n,Y:!0},((e,t,n)=>{const r=Ke(e[1]),i=new le(r);a=a.add(i)})).next((()=>a))}containsKey(e,t){const n=He(t.path),r=IDBKeyRange.bound([n],[Z(n)],!1,!0);let a=0;return io(e).Z({index:bt,Y:!0,range:r},((e,t,n)=>{let[r,i]=e;0!==r&&(a++,n.done())})).next((()=>a>0))}lt(e,t){return ro(e).get(t).next((e=>e?ns(e):null))}}function ro(e){return Zt(e,pt)}function ao(e){return Zt(e,Et)}function io(e){return Zt(e,vt)}const so="LruGarbageCollector",oo=1048576;function co(e,t){let[n,r]=e,[a,i]=t;const s=q(n,a);return 0===s?q(r,i):s}class lo{constructor(e){this.Hn=e,this.buffer=new on(co),this.Jn=0}Yn(){return++this.Jn}Zn(e){const t=[e,this.Yn()];if(this.buffer.size<this.Hn)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();co(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class uo{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Xn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.er(6e4)}stop(){this.Xn&&(this.Xn.cancel(),this.Xn=null)}get started(){return null!==this.Xn}er(e){C(so,`Garbage collection scheduled in ${e}ms`),this.Xn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Xn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){Ne(e)?C(so,"Ignoring IndexedDB error during garbage collection: ",e):await Ee(e)}await this.er(3e5)}))}}class ho{constructor(e,t){this.tr=e,this.params=t}calculateTargetCount(e,t){return this.tr.nr(e).next((e=>Math.floor(t/100*e)))}nthSequenceNumber(e,t){if(0===t)return Te.resolve(ze.ae);const n=new lo(t);return this.tr.forEachTarget(e,(e=>n.Zn(e.sequenceNumber))).next((()=>this.tr.rr(e,(e=>n.Zn(e))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.tr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.tr.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(C("LruGarbageCollector","Garbage collection skipped; disabled"),Te.resolve(Gs)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(C("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Gs):this.ir(e,t)))}getCacheSize(e){return this.tr.getCacheSize(e)}ir(e,t){let n,r,a,i,s,c,l;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((t=>(t>this.params.maximumSequenceNumbersToCollect?(C("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),r=this.params.maximumSequenceNumbersToCollect):r=t,i=Date.now(),this.nthSequenceNumber(e,r)))).next((r=>(n=r,s=Date.now(),this.removeTargets(e,n,t)))).next((t=>(a=t,c=Date.now(),this.removeOrphanedDocuments(e,n)))).next((e=>(l=Date.now(),k()<=o.$b.DEBUG&&C("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${i-u}ms\n\tDetermined least recently used ${r} in `+(s-i)+"ms\n"+`\tRemoved ${a} targets in `+(c-s)+"ms\n"+`\tRemoved ${e} documents in `+(l-c)+"ms\n"+`Total Duration: ${l-u}ms`),Te.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:a,documentsRemoved:e}))))}}function fo(e,t){return new ho(e,t)}class po{constructor(e,t){this.db=e,this.garbageCollector=fo(this,t)}nr(e){const t=this.sr(e);return this.db.getTargetCache().getTargetCount(e).next((e=>t.next((t=>e+t))))}sr(e){let t=0;return this.rr(e,(e=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}rr(e,t){return this._r(e,((e,n)=>t(n)))}addReference(e,t,n){return go(e,n)}removeReference(e,t,n){return go(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return go(e,t)}ar(e,t){return function(e,t){let n=!1;return eo(e).X((r=>Xs(e,r,t).next((e=>(e&&(n=!0),Te.resolve(!e)))))).next((()=>n))}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let a=0;return this._r(e,((i,s)=>{if(s<=t){const t=this.ar(e,i).next((t=>{if(!t)return a++,n.getEntry(e,i).next((()=>(n.removeEntry(i,re.min()),io(e).delete(function(e){return[0,He(e.path)]}(i)))))}));r.push(t)}})).next((()=>Te.waitFor(r))).next((()=>n.apply(e))).next((()=>a))}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return go(e,t)}_r(e,t){const n=io(e);let r,a=ze.ae;return n.Z({index:bt},((e,n)=>{let[i,s]=e,{path:o,sequenceNumber:c}=n;0===i?(a!==ze.ae&&t(new le(Ke(r)),a),a=c,r=o):a=ze.ae})).next((()=>{a!==ze.ae&&t(new le(Ke(r)),a)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function go(e,t){return io(e).put(function(e,t){return{targetId:0,path:He(e.path),sequenceNumber:t}}(t,e.currentSequenceNumber))}class mo{constructor(){this.changes=new ea((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ar.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?Te.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class vo{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return xo(e).put(n)}removeEntry(e,t,n){return xo(e).delete(function(e,t){const n=e.path.toArray();return[n.slice(0,n.length-2),n[n.length-2],Ji(t),n[n.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next((n=>(n.byteSize+=t,this.ur(e,n))))}getEntry(e,t){let n=ar.newInvalidDocument(t);return xo(e).Z({index:ct,range:IDBKeyRange.only(Eo(t))},((e,r)=>{n=this.cr(t,r)})).next((()=>n))}lr(e,t){let n={size:0,document:ar.newInvalidDocument(t)};return xo(e).Z({index:ct,range:IDBKeyRange.only(Eo(t))},((e,r)=>{n={document:this.cr(t,r),size:Ys(r)}})).next((()=>n))}getEntries(e,t){let n=na();return this.hr(e,t,((e,t)=>{const r=this.cr(e,t);n=n.insert(e,r)})).next((()=>n))}Pr(e,t){let n=na(),r=new rn(le.comparator);return this.hr(e,t,((e,t)=>{const a=this.cr(e,t);n=n.insert(e,a),r=r.insert(e,Ys(t))})).next((()=>({documents:n,Tr:r})))}hr(e,t,n){if(t.isEmpty())return Te.resolve();let r=new on(So);t.forEach((e=>r=r.add(e)));const a=IDBKeyRange.bound(Eo(r.first()),Eo(r.last())),i=r.getIterator();let s=i.getNext();return xo(e).Z({index:ct,range:a},((e,t,r)=>{const a=le.fromSegments([...t.prefixPath,t.collectionGroup,t.documentId]);for(;s&&So(s,a)<0;)n(s,null),s=i.getNext();s&&s.isEqual(a)&&(n(s,t),s=i.hasNext()?i.getNext():null),s?r.W(Eo(s)):r.done()})).next((()=>{for(;s;)n(s,null),s=i.hasNext()?i.getNext():null}))}getDocumentsMatchingQuery(e,t,n,r,a){const i=t.path,s=[i.popLast().toArray(),i.lastSegment(),Ji(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],o=[i.popLast().toArray(),i.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return xo(e).G(IDBKeyRange.bound(s,o,!0)).next((e=>{null==a||a.incrementDocumentReadCount(e.length);let n=na();for(const a of e){const e=this.cr(le.fromSegments(a.prefixPath.concat(a.collectionGroup,a.documentId)),a);e.isFoundDocument()&&(Qr(t,e)||r.has(e.key))&&(n=n.insert(e.key,e))}return n}))}getAllFromCollectionGroup(e,t,n,r){let a=na();const i=To(t,n),s=To(t,ye.max());return xo(e).Z({index:ut,range:IDBKeyRange.bound(i,s,!0)},((e,t,n)=>{const i=this.cr(le.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);a=a.insert(i.key,i),a.size===r&&n.done()})).next((()=>a))}newChangeBuffer(e){return new bo(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((e=>e.byteSize))}getMetadata(e){return wo(e).get(ft).next((e=>(O(!!e),e)))}ur(e,t){return wo(e).put(ft,t)}cr(e,t){if(t){const e=function(e,t){let n;if(t.document)n=Pi(e.Tt,t.document,!!t.hasCommittedMutations);else if(t.noDocument){const e=le.fromSegments(t.noDocument.path),r=es(t.noDocument.readTime);n=ar.newNoDocument(e,r),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return R();{const e=le.fromSegments(t.unknownDocument.path),r=es(t.unknownDocument.version);n=ar.newUnknownDocument(e,r)}}return t.readTime&&n.setReadTime(function(e){const t=new ne(e[0],e[1]);return re.fromTimestamp(t)}(t.readTime)),n}(this.serializer,t);if(!e.isNoDocument()||!e.version.isEqual(re.min()))return e}return ar.newInvalidDocument(e)}}function yo(e){return new vo(e)}class bo extends mo{constructor(e,t){super(),this.Ir=e,this.trackRemovals=t,this.Er=new ea((e=>e.toString()),((e,t)=>e.isEqual(t)))}applyChanges(e){const t=[];let n=0,r=new on(((e,t)=>q(e.canonicalString(),t.canonicalString())));return this.changes.forEach(((a,i)=>{const s=this.Er.get(a);if(t.push(this.Ir.removeEntry(e,a,s.readTime)),i.isValidDocument()){const o=Xi(this.Ir.serializer,i);r=r.add(a.path.popLast());const c=Ys(o);n+=c-s.size,t.push(this.Ir.addEntry(e,a,o))}else if(n-=s.size,this.trackRemovals){const n=Xi(this.Ir.serializer,i.convertToNoDocument(re.min()));t.push(this.Ir.addEntry(e,a,n))}})),r.forEach((n=>{t.push(this.Ir.indexManager.addToCollectionParentIndex(e,n))})),t.push(this.Ir.updateMetadata(e,n)),Te.waitFor(t)}getFromCache(e,t){return this.Ir.lr(e,t).next((e=>(this.Er.set(t,{size:e.size,readTime:e.document.readTime}),e.document)))}getAllFromCache(e,t){return this.Ir.Pr(e,t).next((e=>{let{documents:t,Tr:n}=e;return n.forEach(((e,n)=>{this.Er.set(e,{size:n,readTime:t.get(e).readTime})})),t}))}}function wo(e){return Zt(e,ht)}function xo(e){return Zt(e,st)}function Eo(e){const t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function To(e,t){const n=t.documentKey.path.toArray();return[e,Ji(t.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function So(e,t){const n=e.path.toArray(),r=t.path.toArray();let a=0;for(let i=0;i<n.length-2&&i<r.length-2;++i)if(a=q(n[i],r[i]),a)return a;return a=q(n.length,r.length),a||(a=q(n[n.length-2],r[r.length-2]),a||q(n[n.length-1],r[r.length-1]))}class Io{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class ko{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(n=r,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(null!==n&&Ma(n.mutation,e,un.empty(),ne.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,da()).next((()=>t))))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:da();const r=sa();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,n).next((e=>{let t=aa();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const n=sa();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,da())))}populateOverlays(e,t,n){const r=[];return n.forEach((e=>{t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,r){let a=na();const i=ca(),s=ca();return t.forEach(((e,t)=>{const s=n.get(t.key);r.has(t.key)&&(void 0===s||s.mutation instanceof Ua)?a=a.insert(t.key,t):void 0!==s?(i.set(t.key,s.mutation.getFieldMask()),Ma(s.mutation,t,s.mutation.getFieldMask(),ne.now())):i.set(t.key,un.empty())})),this.recalculateAndSaveOverlays(e,a).next((e=>(e.forEach(((e,t)=>i.set(e,t))),t.forEach(((e,t)=>{var n;return s.set(e,new Io(t,null!==(n=i.get(e))&&void 0!==n?n:null))})),s)))}recalculateAndSaveOverlays(e,t){const n=ca();let r=new rn(((e,t)=>e-t)),a=da();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const a of e)a.keys().forEach((e=>{const i=t.get(e);if(null===i)return;let s=n.get(e)||un.empty();s=a.applyToLocalView(i,s),n.set(e,s);const o=(r.get(a.batchId)||da()).add(e);r=r.insert(a.batchId,o)}))})).next((()=>{const i=[],s=r.getReverseIterator();for(;s.hasNext();){const r=s.getNext(),o=r.key,c=r.value,l=oa();c.forEach((e=>{if(!a.has(e)){const r=Pa(t.get(e),n.get(e));null!==r&&l.set(e,r),a=a.add(e)}})),i.push(this.documentOverlayCache.saveOverlays(e,o,l))}return Te.waitFor(i)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return le.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Br(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((a=>{const i=r-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-a.size):Te.resolve(sa());let s=ue,o=a;return i.next((t=>Te.forEach(t,((t,n)=>(s<n.largestBatchId&&(s=n.largestBatchId),a.get(t)?Te.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{o=o.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,a))).next((()=>this.computeViews(e,o,t,da()))).next((e=>({batchId:s,changes:ia(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new le(t)).next((e=>{let t=aa();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const a=t.collectionGroup;let i=aa();return this.indexManager.getCollectionParents(e,a).next((s=>Te.forEach(s,(s=>{const o=function(e,t){return new Fr(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,s.child(a));return this.getDocumentsMatchingCollectionQuery(e,o,n,r).next((e=>{e.forEach(((e,t)=>{i=i.insert(e,t)}))}))})).next((()=>i))))}getDocumentsMatchingCollectionQuery(e,t,n,r){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((i=>(a=i,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,a,r)))).next((e=>{a.forEach(((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,ar.newInvalidDocument(r)))}));let n=aa();return e.forEach(((e,r)=>{const i=a.get(e);void 0!==i&&Ma(i.mutation,r,un.empty(),ne.now()),Qr(t,r)&&(n=n.insert(e,r))})),n}))}}class Co{constructor(e){this.serializer=e,this.dr=new Map,this.Ar=new Map}getBundleMetadata(e,t){return Te.resolve(this.dr.get(t))}saveBundleMetadata(e,t){return this.dr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:Ti(e.createTime)}}(t)),Te.resolve()}getNamedQuery(e,t){return Te.resolve(this.Ar.get(t))}saveNamedQuery(e,t){return this.Ar.set(t.name,function(e){return{name:e.name,query:as(e.bundledQuery),readTime:Ti(e.readTime)}}(t)),Te.resolve()}}class _o{constructor(){this.overlays=new rn(le.comparator),this.Rr=new Map}getOverlay(e,t){return Te.resolve(this.overlays.get(t))}getOverlays(e,t){const n=sa();return Te.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,r)=>{this.Et(e,t,r)})),Te.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.Rr.get(n);return void 0!==r&&(r.forEach((e=>this.overlays=this.overlays.remove(e))),this.Rr.delete(n)),Te.resolve()}getOverlaysForCollection(e,t,n){const r=sa(),a=t.length+1,i=new le(t.child("")),s=this.overlays.getIteratorFrom(i);for(;s.hasNext();){const e=s.getNext().value,i=e.getKey();if(!t.isPrefixOf(i.path))break;i.path.length===a&&e.largestBatchId>n&&r.set(e.getKey(),e)}return Te.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let a=new rn(((e,t)=>e-t));const i=this.overlays.getIterator();for(;i.hasNext();){const e=i.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=a.get(e.largestBatchId);null===t&&(t=sa(),a=a.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const s=sa(),o=a.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach(((e,t)=>s.set(e,t))),!(s.size()>=r)););return Te.resolve(s)}Et(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.Rr.get(r.largestBatchId).delete(n.key);this.Rr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new qa(t,n));let a=this.Rr.get(t);void 0===a&&(a=da(),this.Rr.set(t,a)),this.Rr.set(t,a.add(n.key))}}class Ao{constructor(){this.sessionToken=hn.EMPTY_BYTE_STRING}getSessionToken(e){return Te.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Te.resolve()}}class No{constructor(){this.Vr=new on(Ro.mr),this.gr=new on(Ro.pr)}isEmpty(){return this.Vr.isEmpty()}addReference(e,t){const n=new Ro(e,t);this.Vr=this.Vr.add(n),this.gr=this.gr.add(n)}yr(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.wr(new Ro(e,t))}Sr(e,t){e.forEach((e=>this.removeReference(e,t)))}br(e){const t=new le(new se([])),n=new Ro(t,e),r=new Ro(t,e+1),a=[];return this.gr.forEachInRange([n,r],(e=>{this.wr(e),a.push(e.key)})),a}Dr(){this.Vr.forEach((e=>this.wr(e)))}wr(e){this.Vr=this.Vr.delete(e),this.gr=this.gr.delete(e)}vr(e){const t=new le(new se([])),n=new Ro(t,e),r=new Ro(t,e+1);let a=da();return this.gr.forEachInRange([n,r],(e=>{a=a.add(e.key)})),a}containsKey(e){const t=new Ro(e,0),n=this.Vr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class Ro{constructor(e,t){this.key=e,this.Cr=t}static mr(e,t){return le.comparator(e.key,t.key)||q(e.Cr,t.Cr)}static pr(e,t){return q(e.Cr,t.Cr)||le.comparator(e.key,t.key)}}class Oo{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Fr=1,this.Mr=new on(Ro.mr)}checkEmpty(e){return Te.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const a=this.Fr;this.Fr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const i=new Wa(a,t,n,r);this.mutationQueue.push(i);for(const s of r)this.Mr=this.Mr.add(new Ro(s.key,a)),this.indexManager.addToCollectionParentIndex(e,s.key.path.popLast());return Te.resolve(i)}lookupMutationBatch(e,t){return Te.resolve(this.Or(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.Nr(n),a=r<0?0:r;return Te.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return Te.resolve(0===this.mutationQueue.length?je:this.Fr-1)}getAllMutationBatches(e){return Te.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Ro(t,0),r=new Ro(t,Number.POSITIVE_INFINITY),a=[];return this.Mr.forEachInRange([n,r],(e=>{const t=this.Or(e.Cr);a.push(t)})),Te.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new on(q);return t.forEach((e=>{const t=new Ro(e,0),r=new Ro(e,Number.POSITIVE_INFINITY);this.Mr.forEachInRange([t,r],(e=>{n=n.add(e.Cr)}))})),Te.resolve(this.Br(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let a=n;le.isDocumentKey(a)||(a=a.child(""));const i=new Ro(new le(a),0);let s=new on(q);return this.Mr.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(s=s.add(e.Cr)),!0)}),i),Te.resolve(this.Br(s))}Br(e){const t=[];return e.forEach((e=>{const n=this.Or(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){O(0===this.Lr(t.batchId,"removed")),this.mutationQueue.shift();let n=this.Mr;return Te.forEach(t.mutations,(r=>{const a=new Ro(r.key,t.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Mr=n}))}qn(e){}containsKey(e,t){const n=new Ro(t,0),r=this.Mr.firstAfterOrEqual(n);return Te.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Te.resolve()}Lr(e,t){return this.Nr(e)}Nr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Or(e){const t=this.Nr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Do{constructor(e){this.kr=e,this.docs=new rn(le.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),a=r?r.size:0,i=this.kr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:i}),this.size+=i-a,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return Te.resolve(n?n.document.mutableCopy():ar.newInvalidDocument(t))}getEntries(e,t){let n=na();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():ar.newInvalidDocument(e))})),Te.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let a=na();const i=t.path,s=new le(i.child("__id-9223372036854775808__")),o=this.docs.getIteratorFrom(s);for(;o.hasNext();){const{key:e,value:{document:s}}=o.getNext();if(!i.isPrefixOf(e.path))break;e.path.length>i.length+1||be(ve(s),n)<=0||(r.has(s.key)||Qr(t,s))&&(a=a.insert(s.key,s.mutableCopy()))}return Te.resolve(a)}getAllFromCollectionGroup(e,t,n,r){R()}qr(e,t){return Te.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new Po(this)}getSize(e){return Te.resolve(this.size)}}class Po extends mo{constructor(e){super(),this.Ir=e}applyChanges(e){const t=[];return this.changes.forEach(((n,r)=>{r.isValidDocument()?t.push(this.Ir.addEntry(e,r)):this.Ir.removeEntry(n)})),Te.waitFor(t)}getFromCache(e,t){return this.Ir.getEntry(e,t)}getAllFromCache(e,t){return this.Ir.getEntries(e,t)}}class Lo{constructor(e){this.persistence=e,this.Qr=new ea((e=>Rr(e)),Or),this.lastRemoteSnapshotVersion=re.min(),this.highestTargetId=0,this.$r=0,this.Ur=new No,this.targetCount=0,this.Kr=to.Un()}forEachTarget(e,t){return this.Qr.forEach(((e,n)=>t(n))),Te.resolve()}getLastRemoteSnapshotVersion(e){return Te.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Te.resolve(this.$r)}allocateTargetId(e){return this.highestTargetId=this.Kr.next(),Te.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.$r&&(this.$r=t),Te.resolve()}zn(e){this.Qr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Kr=new to(t),this.highestTargetId=t),e.sequenceNumber>this.$r&&(this.$r=e.sequenceNumber)}addTargetData(e,t){return this.zn(t),this.targetCount+=1,Te.resolve()}updateTargetData(e,t){return this.zn(t),Te.resolve()}removeTargetData(e,t){return this.Qr.delete(t.target),this.Ur.br(t.targetId),this.targetCount-=1,Te.resolve()}removeTargets(e,t,n){let r=0;const a=[];return this.Qr.forEach(((i,s)=>{s.sequenceNumber<=t&&null===n.get(s.targetId)&&(this.Qr.delete(i),a.push(this.removeMatchingKeysForTargetId(e,s.targetId)),r++)})),Te.waitFor(a).next((()=>r))}getTargetCount(e){return Te.resolve(this.targetCount)}getTargetData(e,t){const n=this.Qr.get(t)||null;return Te.resolve(n)}addMatchingKeys(e,t,n){return this.Ur.yr(t,n),Te.resolve()}removeMatchingKeys(e,t,n){this.Ur.Sr(t,n);const r=this.persistence.referenceDelegate,a=[];return r&&t.forEach((t=>{a.push(r.markPotentiallyOrphaned(e,t))})),Te.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this.Ur.br(t),Te.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Ur.vr(t);return Te.resolve(n)}containsKey(e,t){return Te.resolve(this.Ur.containsKey(t))}}class Mo{constructor(e,t){this.Wr={},this.overlays={},this.Gr=new ze(0),this.zr=!1,this.zr=!0,this.jr=new Ao,this.referenceDelegate=e(this),this.Hr=new Lo(this),this.indexManager=new Ls,this.remoteDocumentCache=function(e){return new Do(e)}((e=>this.referenceDelegate.Jr(e))),this.serializer=new Qi(t),this.Yr=new Co(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.zr=!1,Promise.resolve()}get started(){return this.zr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new _o,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.Wr[e.toKey()];return n||(n=new Oo(t,this.referenceDelegate),this.Wr[e.toKey()]=n),n}getGlobalsCache(){return this.jr}getTargetCache(){return this.Hr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Yr}runTransaction(e,t,n){C("MemoryPersistence","Starting transaction:",e);const r=new Fo(this.Gr.next());return this.referenceDelegate.Zr(),n(r).next((e=>this.referenceDelegate.Xr(r).next((()=>e)))).toPromise().then((e=>(r.raiseOnCommittedEvent(),e)))}ei(e,t){return Te.or(Object.values(this.Wr).map((n=>()=>n.containsKey(e,t))))}}class Fo extends xe{constructor(e){super(),this.currentSequenceNumber=e}}class zo{constructor(e){this.persistence=e,this.ti=new No,this.ni=null}static ri(e){return new zo(e)}get ii(){if(this.ni)return this.ni;throw R()}addReference(e,t,n){return this.ti.addReference(n,t),this.ii.delete(n.toString()),Te.resolve()}removeReference(e,t,n){return this.ti.removeReference(n,t),this.ii.add(n.toString()),Te.resolve()}markPotentiallyOrphaned(e,t){return this.ii.add(t.toString()),Te.resolve()}removeTarget(e,t){this.ti.br(t.targetId).forEach((e=>this.ii.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.ii.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}Zr(){this.ni=new Set}Xr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Te.forEach(this.ii,(n=>{const r=le.fromPath(n);return this.si(e,r).next((e=>{e||t.removeEntry(r,re.min())}))})).next((()=>(this.ni=null,t.apply(e))))}updateLimboDocument(e,t){return this.si(e,t).next((e=>{e?this.ii.delete(t.toString()):this.ii.add(t.toString())}))}Jr(e){return 0}si(e,t){return Te.or([()=>Te.resolve(this.ti.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.ei(e,t)])}}class jo{constructor(e,t){this.persistence=e,this.oi=new ea((e=>He(e.path)),((e,t)=>e.isEqual(t))),this.garbageCollector=fo(this,t)}static ri(e,t){return new jo(e,t)}Zr(){}Xr(e){return Te.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}nr(e){const t=this.sr(e);return this.persistence.getTargetCache().getTargetCount(e).next((e=>t.next((t=>e+t))))}sr(e){let t=0;return this.rr(e,(e=>{t++})).next((()=>t))}rr(e,t){return Te.forEach(this.oi,((n,r)=>this.ar(e,n,r).next((e=>e?Te.resolve():t(r)))))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const r=this.persistence.getRemoteDocumentCache(),a=r.newChangeBuffer();return r.qr(e,(r=>this.ar(e,r,t).next((e=>{e||(n++,a.removeEntry(r,re.min()))})))).next((()=>a.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,t){return this.oi.set(t,e.currentSequenceNumber),Te.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.oi.set(n,e.currentSequenceNumber),Te.resolve()}removeReference(e,t,n){return this.oi.set(n,e.currentSequenceNumber),Te.resolve()}updateLimboDocument(e,t){return this.oi.set(t,e.currentSequenceNumber),Te.resolve()}Jr(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Bn(e.data.value)),t}ar(e,t,n){return Te.or([()=>this.persistence.ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const e=this.oi.get(t);return Te.resolve(void 0!==e&&e>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Uo{constructor(e){this.serializer=e}B(e,t,n,r){const a=new Ie("createOrUpgrade",t);n<1&&r>=1&&(function(e){e.createObjectStore(Ye)}(e),function(e){e.createObjectStore(Xe,{keyPath:"userId"});e.createObjectStore(Je,{keyPath:Ze,autoIncrement:!0}).createIndex(et,tt,{unique:!0}),e.createObjectStore(it)}(e),Bo(e),function(e){e.createObjectStore(qe)}(e));let i=Te.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore(vt),e.deleteObjectStore(pt),e.deleteObjectStore(Et)}(e),Bo(e)),i=i.next((()=>function(e){const t=e.store(Et),n={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:re.min().toTimestamp(),targetCount:0};return t.put(xt,n)}(a)))),n<4&&r>=4&&(0!==n&&(i=i.next((()=>function(e,t){return t.store(Je).G().next((n=>{e.deleteObjectStore(Je),e.createObjectStore(Je,{keyPath:Ze,autoIncrement:!0}).createIndex(et,tt,{unique:!0});const r=t.store(Je),a=n.map((e=>r.put(e)));return Te.waitFor(a)}))}(e,a)))),i=i.next((()=>{!function(e){e.createObjectStore(It,{keyPath:"clientId"})}(e)}))),n<5&&r>=5&&(i=i.next((()=>this._i(a)))),n<6&&r>=6&&(i=i.next((()=>(function(e){e.createObjectStore(ht)}(e),this.ai(a))))),n<7&&r>=7&&(i=i.next((()=>this.ui(a)))),n<8&&r>=8&&(i=i.next((()=>this.ci(e,a)))),n<9&&r>=9&&(i=i.next((()=>{!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e)}))),n<10&&r>=10&&(i=i.next((()=>this.li(a)))),n<11&&r>=11&&(i=i.next((()=>{!function(e){e.createObjectStore(kt,{keyPath:"bundleId"})}(e),function(e){e.createObjectStore(Ct,{keyPath:"name"})}(e)}))),n<12&&r>=12&&(i=i.next((()=>{!function(e){const t=e.createObjectStore(zt,{keyPath:jt});t.createIndex(Ut,Bt,{unique:!1}),t.createIndex(Vt,$t,{unique:!1})}(e)}))),n<13&&r>=13&&(i=i.next((()=>function(e){const t=e.createObjectStore(st,{keyPath:ot});t.createIndex(ct,lt),t.createIndex(ut,dt)}(e))).next((()=>this.hi(e,a))).next((()=>e.deleteObjectStore(qe)))),n<14&&r>=14&&(i=i.next((()=>this.Pi(e,a)))),n<15&&r>=15&&(i=i.next((()=>function(e){e.createObjectStore(_t,{keyPath:"indexId",autoIncrement:!0}).createIndex(At,"collectionGroup",{unique:!1});e.createObjectStore(Nt,{keyPath:Rt}).createIndex(Ot,Dt,{unique:!1});e.createObjectStore(Pt,{keyPath:Lt}).createIndex(Mt,Ft,{unique:!1})}(e)))),n<16&&r>=16&&(i=i.next((()=>{t.objectStore(Nt).clear()})).next((()=>{t.objectStore(Pt).clear()}))),n<17&&r>=17&&(i=i.next((()=>{!function(e){e.createObjectStore(Ht,{keyPath:"name"})}(e)}))),i}ai(e){let t=0;return e.store(qe).Z(((e,n)=>{t+=Ys(n)})).next((()=>{const n={byteSize:t};return e.store(ht).put(ft,n)}))}_i(e){const t=e.store(Xe),n=e.store(Je);return t.G().next((t=>Te.forEach(t,(t=>{const r=IDBKeyRange.bound([t.userId,je],[t.userId,t.lastAcknowledgedBatchId]);return n.G(et,r).next((n=>Te.forEach(n,(n=>{O(n.userId===t.userId);const r=ts(this.serializer,n);return qs(e,t.userId,r).next((()=>{}))}))))}))))}ui(e){const t=e.store(vt),n=e.store(qe);return e.store(Et).get(xt).next((e=>{const r=[];return n.Z(((n,a)=>{const i=new se(n),s=function(e){return[0,He(e)]}(i);r.push(t.get(s).next((n=>n?Te.resolve():(n=>t.put({targetId:0,path:He(n),sequenceNumber:e.highestListenSequenceNumber}))(i))))})).next((()=>Te.waitFor(r)))}))}ci(e,t){e.createObjectStore(Tt,{keyPath:St});const n=t.store(Tt),r=new Ms,a=e=>{if(r.add(e)){const t=e.lastSegment(),r=e.popLast();return n.put({collectionId:t,parent:He(r)})}};return t.store(qe).Z({Y:!0},((e,t)=>{const n=new se(e);return a(n.popLast())})).next((()=>t.store(it).Z({Y:!0},((e,t)=>{let[n,r,i]=e;const s=Ke(r);return a(s.popLast())}))))}li(e){const t=e.store(pt);return t.Z(((e,n)=>{const r=ns(n),a=rs(this.serializer,r);return t.put(a)}))}hi(e,t){const n=t.store(qe),r=[];return n.Z(((e,n)=>{const a=t.store(st),i=function(e){return e.document?new le(se.fromString(e.document.name).popFirst(5)):e.noDocument?le.fromSegments(e.noDocument.path):e.unknownDocument?le.fromSegments(e.unknownDocument.path):R()}(n).path.toArray(),s={prefixPath:i.slice(0,i.length-2),collectionGroup:i[i.length-2],documentId:i[i.length-1],readTime:n.readTime||[0,0],unknownDocument:n.unknownDocument,noDocument:n.noDocument,document:n.document,hasCommittedMutations:!!n.hasCommittedMutations};r.push(a.put(s))})).next((()=>Te.waitFor(r)))}Pi(e,t){const n=t.store(Je),r=yo(this.serializer),a=new Mo(zo.ri,this.serializer.Tt);return n.G().next((e=>{const n=new Map;return e.forEach((e=>{var t;let r=null!==(t=n.get(e.userId))&&void 0!==t?t:da();ts(this.serializer,e).keys().forEach((e=>r=r.add(e))),n.set(e.userId,r)})),Te.forEach(n,((e,n)=>{const i=new T(n),s=ds.It(this.serializer,i),o=a.getIndexManager(i),c=Qs.It(i,this.serializer,o,a.referenceDelegate);return new ko(r,c,s,o).recalculateAndSaveOverlaysForDocumentKeys(new Jt(t,ze.ae),e).next()}))}))}}function Bo(e){e.createObjectStore(vt,{keyPath:yt}).createIndex(bt,wt,{unique:!0}),e.createObjectStore(pt,{keyPath:"targetId"}).createIndex(gt,mt,{unique:!0}),e.createObjectStore(Et)}const Vo="IndexedDbPersistence",$o=18e5,Ho=5e3,Go="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Wo="main";class Ko{constructor(e,t,n,r,a,i,s,o,c,l){let u=arguments.length>10&&void 0!==arguments[10]?arguments[10]:17;if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.Ti=a,this.window=i,this.document=s,this.Ii=c,this.Ei=l,this.di=u,this.Gr=null,this.zr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ai=null,this.inForeground=!1,this.Ri=null,this.Vi=null,this.mi=Number.NEGATIVE_INFINITY,this.fi=e=>Promise.resolve(),!Ko.D())throw new L(P.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new po(this,r),this.gi=t+Wo,this.serializer=new Qi(o),this.pi=new ke(this.gi,this.di,new Uo(this.serializer)),this.jr=new fs,this.Hr=new no(this.referenceDelegate,this.serializer),this.remoteDocumentCache=yo(this.serializer),this.Yr=new cs,this.window&&this.window.localStorage?this.yi=this.window.localStorage:(this.yi=null,!1===l&&_(Vo,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new L(P.FAILED_PRECONDITION,Go);return this.Si(),this.bi(),this.Di(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Hr.getHighestSequenceNumber(e)))})).then((e=>{this.Gr=new ze(e,this.Ii)})).then((()=>{this.zr=!0})).catch((e=>(this.pi&&this.pi.close(),Promise.reject(e))))}Ci(e){return this.fi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.pi.k((async t=>{null===t.newVersion&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Ti.enqueueAndForget((async()=>{this.started&&await this.wi()})))}wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Yo(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Fi(e).next((e=>{e||(this.isPrimary=!1,this.Ti.enqueueRetryable((()=>this.fi(!1))))}))})).next((()=>this.Mi(e))).next((t=>this.isPrimary&&!t?this.xi(e).next((()=>!1)):!!t&&this.Oi(e).next((()=>!0)))))).catch((e=>{if(Ne(e))return C(Vo,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return C(Vo,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Ti.enqueueRetryable((()=>this.fi(e))),this.isPrimary=e}))}Fi(e){return qo(e).get(Qe).next((e=>Te.resolve(this.Ni(e))))}Bi(e){return Yo(e).delete(this.clientId)}async Li(){if(this.isPrimary&&!this.ki(this.mi,$o)){this.mi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(e=>{const t=Zt(e,It);return t.G().next((e=>{const n=this.qi(e,$o),r=e.filter((e=>-1===n.indexOf(e)));return Te.forEach(r,(e=>t.delete(e.clientId))).next((()=>r))}))})).catch((()=>[]));if(this.yi)for(const t of e)this.yi.removeItem(this.Qi(t.clientId))}}Di(){this.Vi=this.Ti.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.wi().then((()=>this.Li())).then((()=>this.Di()))))}Ni(e){return!!e&&e.ownerId===this.clientId}Mi(e){return this.Ei?Te.resolve(!0):qo(e).get(Qe).next((t=>{if(null!==t&&this.ki(t.leaseTimestampMs,Ho)&&!this.$i(t.ownerId)){if(this.Ni(t)&&this.networkEnabled)return!0;if(!this.Ni(t)){if(!t.allowTabSynchronization)throw new L(P.FAILED_PRECONDITION,Go);return!1}}return!(!this.networkEnabled||!this.inForeground)||Yo(e).G().next((e=>void 0===this.qi(e,Ho).find((e=>{if(this.clientId!==e.clientId){const t=!this.networkEnabled&&e.networkEnabled,n=!this.inForeground&&e.inForeground,r=this.networkEnabled===e.networkEnabled;if(t||n&&r)return!0}return!1}))))})).next((e=>(this.isPrimary!==e&&C(Vo,`Client ${e?"is":"is not"} eligible for a primary lease.`),e)))}async shutdown(){this.zr=!1,this.Ui(),this.Vi&&(this.Vi.cancel(),this.Vi=null),this.Ki(),this.Wi(),await this.pi.runTransaction("shutdown","readwrite",[Ye,It],(e=>{const t=new Jt(e,ze.ae);return this.xi(t).next((()=>this.Bi(t)))})),this.pi.close(),this.Gi()}qi(e,t){return e.filter((e=>this.ki(e.updateTimeMs,t)&&!this.$i(e.clientId)))}zi(){return this.runTransaction("getActiveClients","readonly",(e=>Yo(e).G().next((e=>this.qi(e,$o).map((e=>e.clientId))))))}get started(){return this.zr}getGlobalsCache(){return this.jr}getMutationQueue(e,t){return Qs.It(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Hr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new js(e,this.serializer.Tt.databaseId)}getDocumentOverlayCache(e){return ds.It(this.serializer,e)}getBundleCache(){return this.Yr}runTransaction(e,t,n){C(Vo,"Starting transaction:",e);const r="readonly"===t?"readonly":"readwrite",a=function(e){return 17===e?Xt:16===e?Qt:15===e?Yt:14===e?qt:13===e?Kt:12===e?Wt:11===e?Gt:void R()}(this.di);let i;return this.pi.runTransaction(e,r,a,(r=>(i=new Jt(r,this.Gr?this.Gr.next():ze.ae),"readwrite-primary"===t?this.Fi(i).next((e=>!!e||this.Mi(i))).next((t=>{if(!t)throw _(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ti.enqueueRetryable((()=>this.fi(!1))),new L(P.FAILED_PRECONDITION,we);return n(i)})).next((e=>this.Oi(i).next((()=>e)))):this.ji(i).next((()=>n(i)))))).then((e=>(i.raiseOnCommittedEvent(),e)))}ji(e){return qo(e).get(Qe).next((e=>{if(null!==e&&this.ki(e.leaseTimestampMs,Ho)&&!this.$i(e.ownerId)&&!this.Ni(e)&&!(this.Ei||this.allowTabSynchronization&&e.allowTabSynchronization))throw new L(P.FAILED_PRECONDITION,Go)}))}Oi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return qo(e).put(Qe,t)}static D(){return ke.D()}xi(e){const t=qo(e);return t.get(Qe).next((e=>this.Ni(e)?(C(Vo,"Releasing primary lease."),t.delete(Qe)):Te.resolve()))}ki(e,t){const n=Date.now();return!(e<n-t)&&(!(e>n)||(_(`Detected an update time that is in the future: ${e} > ${n}`),!1))}Si(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ri=()=>{this.Ti.enqueueAndForget((()=>(this.inForeground="visible"===this.document.visibilityState,this.wi())))},this.document.addEventListener("visibilitychange",this.Ri),this.inForeground="visible"===this.document.visibilityState)}Ki(){this.Ri&&(this.document.removeEventListener("visibilitychange",this.Ri),this.Ri=null)}bi(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Ai=()=>{this.Ui();const e=/(?:Version|Mobile)\/1[456]/;(0,c.nr)()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Ti.enterRestrictedMode(!0),this.Ti.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Ai))}Wi(){this.Ai&&(this.window.removeEventListener("pagehide",this.Ai),this.Ai=null)}$i(e){var t;try{const n=null!==(null===(t=this.yi)||void 0===t?void 0:t.getItem(this.Qi(e)));return C(Vo,`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(e){return _(Vo,"Failed to get zombied client id.",e),!1}}Ui(){if(this.yi)try{this.yi.setItem(this.Qi(this.clientId),String(Date.now()))}catch(e){_("Failed to set zombie client id.",e)}}Gi(){if(this.yi)try{this.yi.removeItem(this.Qi(this.clientId))}catch(e){}}Qi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function qo(e){return Zt(e,Ye)}function Yo(e){return Zt(e,It)}function Qo(e,t){let n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}class Xo{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Hi=n,this.Ji=r}static Yi(e,t){let n=da(),r=da();for(const a of t.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:r=r.add(a.doc.key)}return new Xo(e,t.fromCache,n,r)}}class Jo{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class Zo{constructor(){this.Zi=!1,this.Xi=!1,this.es=100,this.ts=(0,c.nr)()?8:Ce((0,c.ZQ)())>0?6:4}initialize(e,t){this.ns=e,this.indexManager=t,this.Zi=!0}getDocumentsMatchingQuery(e,t,n,r){const a={result:null};return this.rs(e,t).next((e=>{a.result=e})).next((()=>{if(!a.result)return this.ss(e,t,r,n).next((e=>{a.result=e}))})).next((()=>{if(a.result)return;const n=new Jo;return this._s(e,t,n).next((r=>{if(a.result=r,this.Xi)return this.us(e,t,n,r.size)}))})).next((()=>a.result))}us(e,t,n,r){return n.documentReadCount<this.es?(k()<=o.$b.DEBUG&&C("QueryEngine","SDK will not create cache indexes for query:",Yr(t),"since it only creates cache indexes for collection contains","more than or equal to",this.es,"documents"),Te.resolve()):(k()<=o.$b.DEBUG&&C("QueryEngine","Query:",Yr(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.ts*r?(k()<=o.$b.DEBUG&&C("QueryEngine","The SDK decides to create cache indexes for query:",Yr(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,$r(t))):Te.resolve())}rs(e,t){if(Ur(t))return Te.resolve(null);let n=$r(t);return this.indexManager.getIndexType(e,n).next((r=>0===r?null:(null!==t.limit&&1===r&&(t=Wr(t,null,"F"),n=$r(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((r=>{const a=da(...r);return this.ns.getDocuments(e,a).next((r=>this.indexManager.getMinOffset(e,n).next((n=>{const i=this.cs(t,r);return this.ls(t,i,a,n.readTime)?this.rs(e,Wr(t,null,"F")):this.hs(e,i,t,n)}))))})))))}ss(e,t,n,r){return Ur(t)||r.isEqual(re.min())?Te.resolve(null):this.ns.getDocuments(e,n).next((a=>{const i=this.cs(t,a);return this.ls(t,i,n,r)?Te.resolve(null):(k()<=o.$b.DEBUG&&C("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Yr(t)),this.hs(e,i,t,me(r,ue)).next((e=>e)))}))}cs(e,t){let n=new on(Jr(e));return t.forEach(((t,r)=>{Qr(e,r)&&(n=n.add(r))})),n}ls(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const a="F"===e.limitType?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(r)>0)}_s(e,t,n){return k()<=o.$b.DEBUG&&C("QueryEngine","Using full collection scan to execute query:",Yr(t)),this.ns.getDocumentsMatchingQuery(e,t,ye.min(),n)}hs(e,t,n,r){return this.ns.getDocumentsMatchingQuery(e,n,r).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}const ec="LocalStore",tc=3e8;class nc{constructor(e,t,n,r){this.persistence=e,this.Ps=t,this.serializer=r,this.Ts=new rn(q),this.Is=new ea((e=>Rr(e)),Or),this.Es=new Map,this.ds=e.getRemoteDocumentCache(),this.Hr=e.getTargetCache(),this.Yr=e.getBundleCache(),this.As(n)}As(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ko(this.ds,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ds.setIndexManager(this.indexManager),this.Ps.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ts)))}}function rc(e,t,n,r){return new nc(e,t,n,r)}async function ac(e,t){const n=D(e);return await n.persistence.runTransaction("Handle user change","readonly",(e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next((a=>(r=a,n.As(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{const a=[],i=[];let s=da();for(const e of r){a.push(e.batchId);for(const t of e.mutations)s=s.add(t.key)}for(const e of t){i.push(e.batchId);for(const t of e.mutations)s=s.add(t.key)}return n.localDocuments.getDocuments(e,s).next((e=>({Rs:e,removedBatchIds:a,addedBatchIds:i})))}))}))}function ic(e){const t=D(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Hr.getLastRemoteSnapshotVersion(e)))}function sc(e,t,n){let r=da(),a=da();return n.forEach((e=>r=r.add(e))),t.getEntries(e,r).next((e=>{let r=na();return n.forEach(((n,i)=>{const s=e.get(n);i.isFoundDocument()!==s.isFoundDocument()&&(a=a.add(n)),i.isNoDocument()&&i.version.isEqual(re.min())?(t.removeEntry(n,i.readTime),r=r.insert(n,i)):!s.isValidDocument()||i.version.compareTo(s.version)>0||0===i.version.compareTo(s.version)&&s.hasPendingWrites?(t.addEntry(i),r=r.insert(n,i)):C(ec,"Ignoring outdated watch update for ",n,". Current version:",s.version," Watch version:",i.version)})),{Vs:r,fs:a}}))}function oc(e,t){const n=D(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=je),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}function cc(e,t){const n=D(e);return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let r;return n.Hr.getTargetData(e,t).next((a=>a?(r=a,Te.resolve(r)):n.Hr.allocateTargetId(e).next((a=>(r=new Yi(t,a,"TargetPurposeListen",e.currentSequenceNumber),n.Hr.addTargetData(e,r).next((()=>r)))))))})).then((e=>{const r=n.Ts.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ts=n.Ts.insert(e.targetId,e),n.Is.set(t,e.targetId)),e}))}async function lc(e,t,n){const r=D(e),a=r.Ts.get(t),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,(e=>r.persistence.referenceDelegate.removeTarget(e,a)))}catch(e){if(!Ne(e))throw e;C(ec,`Failed to update sequence numbers for target ${t}: ${e}`)}r.Ts=r.Ts.remove(t),r.Is.delete(a.target)}function uc(e,t,n){const r=D(e);let a=re.min(),i=da();return r.persistence.runTransaction("Execute query","readwrite",(e=>function(e,t,n){const r=D(e),a=r.Is.get(n);return void 0!==a?Te.resolve(r.Ts.get(a)):r.Hr.getTargetData(t,n)}(r,e,$r(t)).next((t=>{if(t)return a=t.lastLimboFreeSnapshotVersion,r.Hr.getMatchingKeysForTargetId(e,t.targetId).next((e=>{i=e}))})).next((()=>r.Ps.getDocumentsMatchingQuery(e,t,n?a:re.min(),n?i:da()))).next((e=>(dc(r,Xr(t),e),{documents:e,gs:i})))))}function dc(e,t,n){let r=e.Es.get(t)||re.min();n.forEach(((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.Es.set(t,r)}class hc{constructor(){this.activeTargetIds=fa()}Ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}vs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}bs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class fc{constructor(){this.ho=new hc,this.Po={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.ho.Ds(e),this.Po[e]||"not-current"}updateQueryState(e,t,n){this.Po[e]=t}removeLocalQueryTarget(e){this.ho.vs(e)}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){delete this.Po[e]}getAllActiveQueryTargets(){return this.ho.activeTargetIds}isActiveQueryTarget(e){return this.ho.activeTargetIds.has(e)}start(){return this.ho=new hc,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class pc{To(e){}shutdown(){}}const gc="ConnectivityMonitor";class mc{constructor(){this.Io=()=>this.Eo(),this.Ao=()=>this.Ro(),this.Vo=[],this.mo()}To(e){this.Vo.push(e)}shutdown(){window.removeEventListener("online",this.Io),window.removeEventListener("offline",this.Ao)}mo(){window.addEventListener("online",this.Io),window.addEventListener("offline",this.Ao)}Eo(){C(gc,"Network connectivity changed: AVAILABLE");for(const e of this.Vo)e(0)}Ro(){C(gc,"Network connectivity changed: UNAVAILABLE");for(const e of this.Vo)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let vc=null;function yc(){return null===vc?vc=268435456+Math.round(2147483648*Math.random()):vc++,"0x"+vc.toString(16)}const bc="RestConnection",wc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class xc{get fo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.po=t+"://"+e.host,this.yo=`projects/${n}/databases/${r}`,this.wo=this.databaseId.database===In?`project_id=${n}`:`project_id=${n}&database_id=${r}`}So(e,t,n,r,a){const i=yc(),s=this.bo(e,t.toUriEncodedString());C(bc,`Sending RPC '${e}' ${i}:`,s,n);const o={"google-cloud-resource-prefix":this.yo,"x-goog-request-params":this.wo};return this.Do(o,r,a),this.vo(e,s,o,n).then((t=>(C(bc,`Received RPC '${e}' ${i}: `,t),t)),(t=>{throw A(bc,`RPC '${e}' ${i} failed with error: `,t,"url: ",s,"request:",n),t}))}Co(e,t,n,r,a,i){return this.So(e,t,n,r,a)}Do(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+S,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}bo(e,t){const n=wc[e];return`${this.po}/v1/${t}:${n}`}terminate(){}}class Ec{constructor(e){this.Fo=e.Fo,this.Mo=e.Mo}xo(e){this.Oo=e}No(e){this.Bo=e}Lo(e){this.ko=e}onMessage(e){this.qo=e}close(){this.Mo()}send(e){this.Fo(e)}Qo(){this.Oo()}$o(){this.Bo()}Uo(e){this.ko(e)}Ko(e){this.qo(e)}}const Tc="WebChannelConnection";class Sc extends xc{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}vo(e,t,n,r){const a=yc();return new Promise(((i,s)=>{const o=new d;o.setWithCredentials(!0),o.listenOnce(f.COMPLETE,(()=>{try{switch(o.getLastErrorCode()){case p.NO_ERROR:const t=o.getResponseJson();C(Tc,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(t)),i(t);break;case p.TIMEOUT:C(Tc,`RPC '${e}' ${a} timed out`),s(new L(P.DEADLINE_EXCEEDED,"Request time out"));break;case p.HTTP_ERROR:const n=o.getStatus();if(C(Tc,`RPC '${e}' ${a} failed with status:`,n,"response text:",o.getResponseText()),n>0){let e=o.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(P).indexOf(t)>=0?t:P.UNKNOWN}(t.status);s(new L(e,t.message))}else s(new L(P.UNKNOWN,"Server responded with status "+o.getStatus()))}else s(new L(P.UNAVAILABLE,"Connection failed."));break;default:R()}}finally{C(Tc,`RPC '${e}' ${a} completed.`)}}));const c=JSON.stringify(r);C(Tc,`RPC '${e}' ${a} sending request:`,r),o.send(t,"POST",c,n,15)}))}Wo(e,t,n){const r=yc(),a=[this.po,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=y(),s=v(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;void 0!==c&&(o.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(o.useFetchStreams=!0),this.Do(o.initMessageHeaders,t,n),o.encodeInitMessageHeaders=!0;const l=a.join("");C(Tc,`Creating RPC '${e}' stream ${r}: ${l}`,o);const u=i.createWebChannel(l,o);let d=!1,f=!1;const p=new Ec({Fo:t=>{f?C(Tc,`Not sending because RPC '${e}' stream ${r} is closed:`,t):(d||(C(Tc,`Opening RPC '${e}' stream ${r} transport.`),u.open(),d=!0),C(Tc,`RPC '${e}' stream ${r} sending:`,t),u.send(t))},Mo:()=>u.close()}),b=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return b(u,h.EventType.OPEN,(()=>{f||(C(Tc,`RPC '${e}' stream ${r} transport opened.`),p.Qo())})),b(u,h.EventType.CLOSE,(()=>{f||(f=!0,C(Tc,`RPC '${e}' stream ${r} transport closed`),p.Uo())})),b(u,h.EventType.ERROR,(t=>{f||(f=!0,A(Tc,`RPC '${e}' stream ${r} transport errored:`,t),p.Uo(new L(P.UNAVAILABLE,"The operation could not be completed")))})),b(u,h.EventType.MESSAGE,(t=>{var n;if(!f){const a=t.data[0];O(!!a);const i=a,s=(null==i?void 0:i.error)||(null===(n=i[0])||void 0===n?void 0:n.error);if(s){C(Tc,`RPC '${e}' stream ${r} received error:`,s);const t=s.status;let n=function(e){const t=Qa[e];if(void 0!==t)return Za(t)}(t),a=s.message;void 0===n&&(n=P.INTERNAL,a="Unknown error status: "+t+" with message "+s.message),f=!0,p.Uo(new L(n,a)),u.close()}else C(Tc,`RPC '${e}' stream ${r} received:`,a),p.Ko(a)}})),b(s,m.STAT_EVENT,(t=>{t.stat===g.PROXY?C(Tc,`RPC '${e}' stream ${r} detected buffering proxy`):t.stat===g.NOPROXY&&C(Tc,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{p.$o()}),0),p}}function Ic(){return"undefined"!=typeof window?window:null}function kc(){return"undefined"!=typeof document?document:null}function Cc(e){return new yi(e,!0)}class _c{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.Ti=e,this.timerId=t,this.Go=n,this.zo=r,this.jo=a,this.Ho=0,this.Jo=null,this.Yo=Date.now(),this.reset()}reset(){this.Ho=0}Zo(){this.Ho=this.jo}Xo(e){this.cancel();const t=Math.floor(this.Ho+this.e_()),n=Math.max(0,Date.now()-this.Yo),r=Math.max(0,t-n);r>0&&C("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Ho} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Jo=this.Ti.enqueueAfterDelay(this.timerId,r,(()=>(this.Yo=Date.now(),e()))),this.Ho*=this.zo,this.Ho<this.Go&&(this.Ho=this.Go),this.Ho>this.jo&&(this.Ho=this.jo)}t_(){null!==this.Jo&&(this.Jo.skipDelay(),this.Jo=null)}cancel(){null!==this.Jo&&(this.Jo.cancel(),this.Jo=null)}e_(){return(Math.random()-.5)*this.Ho}}const Ac="PersistentStream";class Nc{constructor(e,t,n,r,a,i,s,o){this.Ti=e,this.n_=n,this.r_=r,this.connection=a,this.authCredentialsProvider=i,this.appCheckCredentialsProvider=s,this.listener=o,this.state=0,this.i_=0,this.s_=null,this.o_=null,this.stream=null,this.__=0,this.a_=new _c(e,t)}u_(){return 1===this.state||5===this.state||this.c_()}c_(){return 2===this.state||3===this.state}start(){this.__=0,4!==this.state?this.auth():this.l_()}async stop(){this.u_()&&await this.close(0)}h_(){this.state=0,this.a_.reset()}P_(){this.c_()&&null===this.s_&&(this.s_=this.Ti.enqueueAfterDelay(this.n_,6e4,(()=>this.T_())))}I_(e){this.E_(),this.stream.send(e)}async T_(){if(this.c_())return this.close(0)}E_(){this.s_&&(this.s_.cancel(),this.s_=null)}d_(){this.o_&&(this.o_.cancel(),this.o_=null)}async close(e,t){this.E_(),this.d_(),this.a_.cancel(),this.i_++,4!==e?this.a_.reset():t&&t.code===P.RESOURCE_EXHAUSTED?(_(t.toString()),_("Using maximum backoff delay to prevent overloading the backend."),this.a_.Zo()):t&&t.code===P.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.A_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Lo(t)}A_(){}auth(){this.state=1;const e=this.R_(this.i_),t=this.i_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((e=>{let[n,r]=e;this.i_===t&&this.V_(n,r)}),(t=>{e((()=>{const e=new L(P.UNKNOWN,"Fetching auth token failed: "+t.message);return this.m_(e)}))}))}V_(e,t){const n=this.R_(this.i_);this.stream=this.f_(e,t),this.stream.xo((()=>{n((()=>this.listener.xo()))})),this.stream.No((()=>{n((()=>(this.state=2,this.o_=this.Ti.enqueueAfterDelay(this.r_,1e4,(()=>(this.c_()&&(this.state=3),Promise.resolve()))),this.listener.No())))})),this.stream.Lo((e=>{n((()=>this.m_(e)))})),this.stream.onMessage((e=>{n((()=>1==++this.__?this.g_(e):this.onNext(e)))}))}l_(){this.state=5,this.a_.Xo((async()=>{this.state=0,this.start()}))}m_(e){return C(Ac,`close with error: ${e}`),this.stream=null,this.close(4,e)}R_(e){return t=>{this.Ti.enqueueAndForget((()=>this.i_===e?t():(C(Ac,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Rc extends Nc{constructor(e,t,n,r,a,i){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,i),this.serializer=a}f_(e,t){return this.connection.Wo("Listen",e,t)}g_(e){return this.onNext(e)}onNext(e){this.a_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:R()}(t.targetChange.targetChangeType||"NO_CHANGE"),a=t.targetChange.targetIds||[],i=function(e,t){return e.useProto3Json?(O(void 0===t||"string"==typeof t),hn.fromBase64String(t||"")):(O(void 0===t||t instanceof Buffer||t instanceof Uint8Array),hn.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),s=t.targetChange.cause,o=s&&function(e){const t=void 0===e.code?P.UNKNOWN:Za(e.code);return new L(t,e.message||"")}(s);n=new ui(r,a,i,o||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const a=_i(e,r.document.name),i=Ti(r.document.updateTime),s=r.document.createTime?Ti(r.document.createTime):re.min(),o=new nr({mapValue:{fields:r.document.fields}}),c=ar.newFoundDocument(a,i,s,o),l=r.targetIds||[],u=r.removedTargetIds||[];n=new ci(l,u,c.key,c)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const a=_i(e,r.document),i=r.readTime?Ti(r.readTime):re.min(),s=ar.newNoDocument(a,i),o=r.removedTargetIds||[];n=new ci([],o,s.key,s)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const a=_i(e,r.document),i=r.removedTargetIds||[];n=new ci([],i,a,null)}else{if(!("filter"in t))return R();{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:a}=e,i=new Ya(r,a),s=e.targetId;n=new li(s,i)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return re.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?re.min():t.readTime?Ti(t.readTime):re.min()}(e);return this.listener.p_(t,n)}y_(e){const t={};t.database=Ri(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=Dr(r)?{documents:Fi(e,r)}:{query:zi(e,r).ht},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=xi(e,t.resumeToken);const r=bi(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(re.min())>0){n.readTime=wi(e,t.snapshotVersion.toTimestamp());const r=bi(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return R()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.I_(t)}w_(e){const t={};t.database=Ri(this.serializer),t.removeTarget=e,this.I_(t)}}class Oc extends Nc{constructor(e,t,n,r,a,i){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,i),this.serializer=a}get S_(){return this.__>0}start(){this.lastStreamToken=void 0,super.start()}A_(){this.S_&&this.b_([])}f_(e,t){return this.connection.Wo("Write",e,t)}g_(e){return O(!!e.streamToken),this.lastStreamToken=e.streamToken,O(!e.writeResults||0===e.writeResults.length),this.listener.D_()}onNext(e){O(!!e.streamToken),this.lastStreamToken=e.streamToken,this.a_.reset();const t=function(e,t){return e&&e.length>0?(O(void 0!==t),e.map((e=>function(e,t){let n=e.updateTime?Ti(e.updateTime):Ti(t);return n.isEqual(re.min())&&(n=Ti(t)),new Na(n,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),n=Ti(e.commitTime);return this.listener.v_(n,t)}C_(){const e={};e.database=Ri(this.serializer),this.I_(e)}b_(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>Li(this.serializer,e)))};this.I_(t)}}class Dc{}class Pc extends Dc{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.F_=!1}M_(){if(this.F_)throw new L(P.FAILED_PRECONDITION,"The client has already been terminated.")}So(e,t,n,r){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((a=>{let[i,s]=a;return this.connection.So(e,Ii(t,n),r,i,s)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new L(P.UNKNOWN,e.toString())}))}Co(e,t,n,r,a){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((i=>{let[s,o]=i;return this.connection.Co(e,Ii(t,n),r,s,o,a)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new L(P.UNKNOWN,e.toString())}))}terminate(){this.F_=!0,this.connection.terminate()}}class Lc{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.x_=0,this.O_=null,this.N_=!0}B_(){0===this.x_&&(this.L_("Unknown"),this.O_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.O_=null,this.k_("Backend didn't respond within 10 seconds."),this.L_("Offline"),Promise.resolve()))))}q_(e){"Online"===this.state?this.L_("Unknown"):(this.x_++,this.x_>=1&&(this.Q_(),this.k_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.L_("Offline")))}set(e){this.Q_(),this.x_=0,"Online"===e&&(this.N_=!1),this.L_(e)}L_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}k_(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.N_?(_(t),this.N_=!1):C("OnlineStateTracker",t)}Q_(){null!==this.O_&&(this.O_.cancel(),this.O_=null)}}const Mc="RemoteStore";class Fc{constructor(e,t,n,r,a){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.U_=[],this.K_=new Map,this.W_=new Set,this.G_=[],this.z_=a,this.z_.To((e=>{n.enqueueAndForget((async()=>{Wc(this)&&(C(Mc,"Restarting streams for network reachability change."),await async function(e){const t=D(e);t.W_.add(4),await jc(t),t.j_.set("Unknown"),t.W_.delete(4),await zc(t)}(this))}))})),this.j_=new Lc(n,r)}}async function zc(e){if(Wc(e))for(const t of e.G_)await t(!0)}async function jc(e){for(const t of e.G_)await t(!1)}function Uc(e,t){const n=D(e);n.K_.has(t.targetId)||(n.K_.set(t.targetId,t),Gc(n)?Hc(n):dl(n).c_()&&Vc(n,t))}function Bc(e,t){const n=D(e),r=dl(n);n.K_.delete(t),r.c_()&&$c(n,t),0===n.K_.size&&(r.c_()?r.P_():Wc(n)&&n.j_.set("Unknown"))}function Vc(e,t){if(e.H_.Ne(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(re.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}dl(e).y_(t)}function $c(e,t){e.H_.Ne(t),dl(e).w_(t)}function Hc(e){e.H_=new hi({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),lt:t=>e.K_.get(t)||null,it:()=>e.datastore.serializer.databaseId}),dl(e).start(),e.j_.B_()}function Gc(e){return Wc(e)&&!dl(e).u_()&&e.K_.size>0}function Wc(e){return 0===D(e).W_.size}function Kc(e){e.H_=void 0}async function qc(e){e.j_.set("Online")}async function Yc(e){e.K_.forEach(((t,n)=>{Vc(e,t)}))}async function Qc(e,t){Kc(e),Gc(e)?(e.j_.q_(t),Hc(e)):e.j_.set("Unknown")}async function Xc(e,t,n){if(e.j_.set("Online"),t instanceof ui&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.K_.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.K_.delete(r),e.H_.removeTarget(r))}(e,t)}catch(n){C(Mc,"Failed to remove targets %s: %s ",t.targetIds.join(","),n),await Jc(e,n)}else if(t instanceof ci?e.H_.We(t):t instanceof li?e.H_.Ze(t):e.H_.je(t),!n.isEqual(re.min()))try{const t=await ic(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.H_.ot(t);return n.targetChanges.forEach(((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const a=e.K_.get(r);a&&e.K_.set(r,a.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach(((t,n)=>{const r=e.K_.get(t);if(!r)return;e.K_.set(t,r.withResumeToken(hn.EMPTY_BYTE_STRING,r.snapshotVersion)),$c(e,t);const a=new Yi(r.target,t,n,r.sequenceNumber);Vc(e,a)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){C(Mc,"Failed to raise snapshot:",t),await Jc(e,t)}}async function Jc(e,t,n){if(!Ne(t))throw t;e.W_.add(1),await jc(e),e.j_.set("Offline"),n||(n=()=>ic(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{C(Mc,"Retrying IndexedDB access"),await n(),e.W_.delete(1),await zc(e)}))}function Zc(e,t){return t().catch((n=>Jc(e,n,t)))}async function el(e){const t=D(e),n=hl(t);let r=t.U_.length>0?t.U_[t.U_.length-1].batchId:je;for(;tl(t);)try{const e=await oc(t.localStore,r);if(null===e){0===t.U_.length&&n.P_();break}r=e.batchId,nl(t,e)}catch(e){await Jc(t,e)}rl(t)&&al(t)}function tl(e){return Wc(e)&&e.U_.length<10}function nl(e,t){e.U_.push(t);const n=hl(e);n.c_()&&n.S_&&n.b_(t.mutations)}function rl(e){return Wc(e)&&!hl(e).u_()&&e.U_.length>0}function al(e){hl(e).start()}async function il(e){hl(e).C_()}async function sl(e){const t=hl(e);for(const n of e.U_)t.b_(n.mutations)}async function ol(e,t,n){const r=e.U_.shift(),a=Ka.from(r,t,n);await Zc(e,(()=>e.remoteSyncer.applySuccessfulWrite(a))),await el(e)}async function cl(e,t){t&&hl(e).S_&&await async function(e,t){if(function(e){return Ja(e)&&e!==P.ABORTED}(t.code)){const n=e.U_.shift();hl(e).h_(),await Zc(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await el(e)}}(e,t),rl(e)&&al(e)}async function ll(e,t){const n=D(e);n.asyncQueue.verifyOperationInProgress(),C(Mc,"RemoteStore received new credentials");const r=Wc(n);n.W_.add(3),await jc(n),r&&n.j_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.W_.delete(3),await zc(n)}async function ul(e,t){const n=D(e);t?(n.W_.delete(2),await zc(n)):t||(n.W_.add(2),await jc(n),n.j_.set("Unknown"))}function dl(e){return e.J_||(e.J_=function(e,t,n){const r=D(e);return r.M_(),new Rc(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{xo:qc.bind(null,e),No:Yc.bind(null,e),Lo:Qc.bind(null,e),p_:Xc.bind(null,e)}),e.G_.push((async t=>{t?(e.J_.h_(),Gc(e)?Hc(e):e.j_.set("Unknown")):(await e.J_.stop(),Kc(e))}))),e.J_}function hl(e){return e.Y_||(e.Y_=function(e,t,n){const r=D(e);return r.M_(),new Oc(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{xo:()=>Promise.resolve(),No:il.bind(null,e),Lo:cl.bind(null,e),D_:sl.bind(null,e),v_:ol.bind(null,e)}),e.G_.push((async t=>{t?(e.Y_.h_(),await el(e)):(await e.Y_.stop(),e.U_.length>0&&(C(Mc,`Stopping write stream with ${e.U_.length} pending writes`),e.U_=[]))}))),e.Y_}class fl{constructor(e,t,n,r,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=a,this.deferred=new M,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,a){const i=Date.now()+n,s=new fl(e,t,i,r,a);return s.start(n),s}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new L(P.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function pl(e,t){if(_("AsyncQueue",`${t}: ${e}`),Ne(e))return new L(P.UNAVAILABLE,`${t}: ${e}`);throw e}class gl{static emptySet(e){return new gl(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||le.comparator(t.key,n.key):(e,t)=>le.comparator(e.key,t.key),this.keyedMap=aa(),this.sortedSet=new rn(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof gl))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new gl;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class ml{constructor(){this.Z_=new rn(le.comparator)}track(e){const t=e.doc.key,n=this.Z_.get(t);n?0!==e.type&&3===n.type?this.Z_=this.Z_.insert(t,e):3===e.type&&1!==n.type?this.Z_=this.Z_.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Z_=this.Z_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Z_=this.Z_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Z_=this.Z_.remove(t):1===e.type&&2===n.type?this.Z_=this.Z_.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Z_=this.Z_.insert(t,{type:2,doc:e.doc}):R():this.Z_=this.Z_.insert(t,e)}X_(){const e=[];return this.Z_.inorderTraversal(((t,n)=>{e.push(n)})),e}}class vl{constructor(e,t,n,r,a,i,s,o,c){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=a,this.fromCache=i,this.syncStateChanged=s,this.excludesMetadataChanges=o,this.hasCachedResults=c}static fromInitialDocuments(e,t,n,r,a){const i=[];return t.forEach((e=>{i.push({type:0,doc:e})})),new vl(e,t,gl.emptySet(t),i,n,r,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Kr(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class yl{constructor(){this.ea=void 0,this.ta=[]}na(){return this.ta.some((e=>e.ra()))}}class bl{constructor(){this.queries=wl(),this.onlineState="Unknown",this.ia=new Set}terminate(){!function(e,t){const n=D(e),r=n.queries;n.queries=wl(),r.forEach(((e,n)=>{for(const r of n.ta)r.onError(t)}))}(this,new L(P.ABORTED,"Firestore shutting down"))}}function wl(){return new ea((e=>qr(e)),Kr)}async function xl(e,t){const n=D(e);let r=3;const a=t.query;let i=n.queries.get(a);i?!i.na()&&t.ra()&&(r=2):(i=new yl,r=t.ra()?0:1);try{switch(r){case 0:i.ea=await n.onListen(a,!0);break;case 1:i.ea=await n.onListen(a,!1);break;case 2:await n.onFirstRemoteStoreListen(a)}}catch(e){const n=pl(e,`Initialization of query '${Yr(t.query)}' failed`);return void t.onError(n)}n.queries.set(a,i),i.ta.push(t),t.sa(n.onlineState),i.ea&&t.oa(i.ea)&&Il(n)}async function El(e,t){const n=D(e),r=t.query;let a=3;const i=n.queries.get(r);if(i){const e=i.ta.indexOf(t);e>=0&&(i.ta.splice(e,1),0===i.ta.length?a=t.ra()?0:1:!i.na()&&t.ra()&&(a=2))}switch(a){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Tl(e,t){const n=D(e);let r=!1;for(const a of t){const e=a.query,t=n.queries.get(e);if(t){for(const e of t.ta)e.oa(a)&&(r=!0);t.ea=a}}r&&Il(n)}function Sl(e,t,n){const r=D(e),a=r.queries.get(t);if(a)for(const i of a.ta)i.onError(n);r.queries.delete(t)}function Il(e){e.ia.forEach((e=>{e.next()}))}var kl,Cl;(Cl=kl||(kl={}))._a="default",Cl.Cache="cache";class _l{constructor(e,t,n){this.query=e,this.aa=t,this.ua=!1,this.ca=null,this.onlineState="Unknown",this.options=n||{}}oa(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new vl(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.ua?this.la(e)&&(this.aa.next(e),t=!0):this.ha(e,this.onlineState)&&(this.Pa(e),t=!0),this.ca=e,t}onError(e){this.aa.error(e)}sa(e){this.onlineState=e;let t=!1;return this.ca&&!this.ua&&this.ha(this.ca,e)&&(this.Pa(this.ca),t=!0),t}ha(e,t){if(!e.fromCache)return!0;if(!this.ra())return!0;const n="Offline"!==t;return(!this.options.Ta||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}la(e){if(e.docChanges.length>0)return!0;const t=this.ca&&this.ca.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}Pa(e){e=vl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ua=!0,this.aa.next(e)}ra(){return this.options.source!==kl.Cache}}class Al{constructor(e){this.key=e}}class Nl{constructor(e){this.key=e}}class Rl{constructor(e,t){this.query=e,this.fa=t,this.ga=null,this.hasCachedResults=!1,this.current=!1,this.pa=da(),this.mutatedKeys=da(),this.ya=Jr(e),this.wa=new gl(this.ya)}get Sa(){return this.fa}ba(e,t){const n=t?t.Da:new ml,r=t?t.wa:this.wa;let a=t?t.mutatedKeys:this.mutatedKeys,i=r,s=!1;const o="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,c="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((e,t)=>{const l=r.get(e),u=Qr(this.query,t)?t:null,d=!!l&&this.mutatedKeys.has(l.key),h=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;l&&u?l.data.isEqual(u.data)?d!==h&&(n.track({type:3,doc:u}),f=!0):this.va(l,u)||(n.track({type:2,doc:u}),f=!0,(o&&this.ya(u,o)>0||c&&this.ya(u,c)<0)&&(s=!0)):!l&&u?(n.track({type:0,doc:u}),f=!0):l&&!u&&(n.track({type:1,doc:l}),f=!0,(o||c)&&(s=!0)),f&&(u?(i=i.add(u),a=h?a.add(e):a.delete(e)):(i=i.delete(e),a=a.delete(e)))})),null!==this.query.limit)for(;i.size>this.query.limit;){const e="F"===this.query.limitType?i.last():i.first();i=i.delete(e.key),a=a.delete(e.key),n.track({type:1,doc:e})}return{wa:i,Da:n,ls:s,mutatedKeys:a}}va(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const a=this.wa;this.wa=e.wa,this.mutatedKeys=e.mutatedKeys;const i=e.Da.X_();i.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return R()}};return n(e)-n(t)}(e.type,t.type)||this.ya(e.doc,t.doc))),this.Ca(n),r=null!=r&&r;const s=t&&!r?this.Fa():[],o=0===this.pa.size&&this.current&&!r?1:0,c=o!==this.ga;return this.ga=o,0!==i.length||c?{snapshot:new vl(this.query,e.wa,a,i,e.mutatedKeys,0===o,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),Ma:s}:{Ma:s}}sa(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({wa:this.wa,Da:new ml,mutatedKeys:this.mutatedKeys,ls:!1},!1)):{Ma:[]}}xa(e){return!this.fa.has(e)&&!!this.wa.has(e)&&!this.wa.get(e).hasLocalMutations}Ca(e){e&&(e.addedDocuments.forEach((e=>this.fa=this.fa.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.fa=this.fa.delete(e))),this.current=e.current)}Fa(){if(!this.current)return[];const e=this.pa;this.pa=da(),this.wa.forEach((e=>{this.xa(e.key)&&(this.pa=this.pa.add(e.key))}));const t=[];return e.forEach((e=>{this.pa.has(e)||t.push(new Nl(e))})),this.pa.forEach((n=>{e.has(n)||t.push(new Al(n))})),t}Oa(e){this.fa=e.gs,this.pa=da();const t=this.ba(e.documents);return this.applyChanges(t,!0)}Na(){return vl.fromInitialDocuments(this.query,this.wa,this.mutatedKeys,0===this.ga,this.hasCachedResults)}}const Ol="SyncEngine";class Dl{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Pl{constructor(e){this.key=e,this.Ba=!1}}class Ll{constructor(e,t,n,r,a,i){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=a,this.maxConcurrentLimboResolutions=i,this.La={},this.ka=new ea((e=>qr(e)),Kr),this.qa=new Map,this.Qa=new Set,this.$a=new rn(le.comparator),this.Ua=new Map,this.Ka=new No,this.Wa={},this.Ga=new Map,this.za=to.Kn(),this.onlineState="Unknown",this.ja=void 0}get isPrimaryClient(){return!0===this.ja}}async function Ml(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=ru(e);let a;const i=r.ka.get(t);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),a=i.view.Na()):a=await zl(r,t,n,!0),a}async function Fl(e,t){const n=ru(e);await zl(n,t,!0,!1)}async function zl(e,t,n,r){const a=await cc(e.localStore,$r(t)),i=a.targetId,s=e.sharedClientState.addLocalQueryTarget(i,n);let o;return r&&(o=await jl(e,t,i,"current"===s,a.resumeToken)),e.isPrimaryClient&&n&&Uc(e.remoteStore,a),o}async function jl(e,t,n,r,a){e.Ha=(t,n,r)=>async function(e,t,n,r){let a=t.view.ba(n);a.ls&&(a=await uc(e.localStore,t.query,!1).then((e=>{let{documents:n}=e;return t.view.ba(n,a)})));const i=r&&r.targetChanges.get(t.targetId),s=r&&null!=r.targetMismatches.get(t.targetId),o=t.view.applyChanges(a,e.isPrimaryClient,i,s);return Xl(e,t.targetId,o.Ma),o.snapshot}(e,t,n,r);const i=await uc(e.localStore,t,!0),s=new Rl(t,i.gs),o=s.ba(i.documents),c=oi.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,a),l=s.applyChanges(o,e.isPrimaryClient,c);Xl(e,n,l.Ma);const u=new Dl(t,n,s);return e.ka.set(t,u),e.qa.has(n)?e.qa.get(n).push(t):e.qa.set(n,[t]),l.snapshot}async function Ul(e,t,n){const r=D(e),a=r.ka.get(t),i=r.qa.get(a.targetId);if(i.length>1)return r.qa.set(a.targetId,i.filter((e=>!Kr(e,t)))),void r.ka.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(a.targetId),r.sharedClientState.isActiveQueryTarget(a.targetId)||await lc(r.localStore,a.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(a.targetId),n&&Bc(r.remoteStore,a.targetId),Yl(r,a.targetId)})).catch(Ee)):(Yl(r,a.targetId),await lc(r.localStore,a.targetId,!0))}async function Bl(e,t){const n=D(e),r=n.ka.get(t),a=n.qa.get(r.targetId);n.isPrimaryClient&&1===a.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Bc(n.remoteStore,r.targetId))}async function Vl(e,t){const n=D(e);try{const e=await function(e,t){const n=D(e),r=t.snapshotVersion;let a=n.Ts;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const i=n.ds.newChangeBuffer({trackRemovals:!0});a=n.Ts;const s=[];t.targetChanges.forEach(((i,o)=>{const c=a.get(o);if(!c)return;s.push(n.Hr.removeMatchingKeys(e,i.removedDocuments,o).next((()=>n.Hr.addMatchingKeys(e,i.addedDocuments,o))));let l=c.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(o)?l=l.withResumeToken(hn.EMPTY_BYTE_STRING,re.min()).withLastLimboFreeSnapshotVersion(re.min()):i.resumeToken.approximateByteSize()>0&&(l=l.withResumeToken(i.resumeToken,r)),a=a.insert(o,l),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=tc||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(c,l,i)&&s.push(n.Hr.updateTargetData(e,l))}));let o=na(),c=da();if(t.documentUpdates.forEach((r=>{t.resolvedLimboDocuments.has(r)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),s.push(sc(e,i,t.documentUpdates).next((e=>{o=e.Vs,c=e.fs}))),!r.isEqual(re.min())){const t=n.Hr.getLastRemoteSnapshotVersion(e).next((t=>n.Hr.setTargetsMetadata(e,e.currentSequenceNumber,r)));s.push(t)}return Te.waitFor(s).next((()=>i.apply(e))).next((()=>n.localDocuments.getLocalViewOfDocuments(e,o,c))).next((()=>o))})).then((e=>(n.Ts=a,e)))}(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const r=n.Ua.get(t);r&&(O(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.Ba=!0:e.modifiedDocuments.size>0?O(r.Ba):e.removedDocuments.size>0&&(O(r.Ba),r.Ba=!1))})),await eu(n,e,t)}catch(e){await Ee(e)}}function $l(e,t,n){const r=D(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.ka.forEach(((n,r)=>{const a=r.view.sa(t);a.snapshot&&e.push(a.snapshot)})),function(e,t){const n=D(e);n.onlineState=t;let r=!1;n.queries.forEach(((e,n)=>{for(const a of n.ta)a.sa(t)&&(r=!0)})),r&&Il(n)}(r.eventManager,t),e.length&&r.La.p_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function Hl(e,t,n){const r=D(e);r.sharedClientState.updateQueryState(t,"rejected",n);const a=r.Ua.get(t),i=a&&a.key;if(i){let e=new rn(le.comparator);e=e.insert(i,ar.newNoDocument(i,re.min()));const n=da().add(i),a=new si(re.min(),new Map,new rn(q),e,n);await Vl(r,a),r.$a=r.$a.remove(i),r.Ua.delete(t),Zl(r)}else await lc(r.localStore,t,!1).then((()=>Yl(r,t,n))).catch(Ee)}async function Gl(e,t){const n=D(e),r=t.batch.batchId;try{const e=await function(e,t){const n=D(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const r=t.batch.keys(),a=n.ds.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const a=n.batch,i=a.keys();let s=Te.resolve();return i.forEach((e=>{s=s.next((()=>r.getEntry(t,e))).next((t=>{const i=n.docVersions.get(e);O(null!==i),t.version.compareTo(i)<0&&(a.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),s.next((()=>e.mutationQueue.removeMutationBatch(t,a)))}(n,e,t,a).next((()=>a.apply(e))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=da();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t)))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(n.localStore,t);ql(n,r,null),Kl(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await eu(n,e)}catch(e){await Ee(e)}}async function Wl(e,t,n){const r=D(e);try{const e=await function(e,t){const n=D(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next((t=>(O(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(r.localStore,t);ql(r,t,n),Kl(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await eu(r,e)}catch(n){await Ee(n)}}function Kl(e,t){(e.Ga.get(t)||[]).forEach((e=>{e.resolve()})),e.Ga.delete(t)}function ql(e,t,n){const r=D(e);let a=r.Wa[r.currentUser.toKey()];if(a){const e=a.get(t);e&&(n?e.reject(n):e.resolve(),a=a.remove(t)),r.Wa[r.currentUser.toKey()]=a}}function Yl(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.qa.get(t))e.ka.delete(r),n&&e.La.Ja(r,n);e.qa.delete(t),e.isPrimaryClient&&e.Ka.br(t).forEach((t=>{e.Ka.containsKey(t)||Ql(e,t)}))}function Ql(e,t){e.Qa.delete(t.path.canonicalString());const n=e.$a.get(t);null!==n&&(Bc(e.remoteStore,n),e.$a=e.$a.remove(t),e.Ua.delete(n),Zl(e))}function Xl(e,t,n){for(const r of n)r instanceof Al?(e.Ka.addReference(r.key,t),Jl(e,r)):r instanceof Nl?(C(Ol,"Document no longer in limbo: "+r.key),e.Ka.removeReference(r.key,t),e.Ka.containsKey(r.key)||Ql(e,r.key)):R()}function Jl(e,t){const n=t.key,r=n.path.canonicalString();e.$a.get(n)||e.Qa.has(r)||(C(Ol,"New document in limbo: "+n),e.Qa.add(r),Zl(e))}function Zl(e){for(;e.Qa.size>0&&e.$a.size<e.maxConcurrentLimboResolutions;){const t=e.Qa.values().next().value;e.Qa.delete(t);const n=new le(se.fromString(t)),r=e.za.next();e.Ua.set(r,new Pl(n)),e.$a=e.$a.insert(n,r),Uc(e.remoteStore,new Yi($r(jr(n.path)),r,"TargetPurposeLimboResolution",ze.ae))}}async function eu(e,t,n){const r=D(e),a=[],i=[],s=[];r.ka.isEmpty()||(r.ka.forEach(((e,o)=>{s.push(r.Ha(o,t,n).then((e=>{var t;if((e||n)&&r.isPrimaryClient){const a=e?!e.fromCache:null===(t=null==n?void 0:n.targetChanges.get(o.targetId))||void 0===t?void 0:t.current;r.sharedClientState.updateQueryState(o.targetId,a?"current":"not-current")}if(e){a.push(e);const t=Xo.Yi(o.targetId,e);i.push(t)}})))})),await Promise.all(s),r.La.p_(a),await async function(e,t){const n=D(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>Te.forEach(t,(t=>Te.forEach(t.Hi,(r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r))).next((()=>Te.forEach(t.Ji,(r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))))))}catch(e){if(!Ne(e))throw e;C(ec,"Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.Ts.get(e),r=t.snapshotVersion,a=t.withLastLimboFreeSnapshotVersion(r);n.Ts=n.Ts.insert(e,a)}}}(r.localStore,i))}async function tu(e,t){const n=D(e);if(!n.currentUser.isEqual(t)){C(Ol,"User change. New user:",t.toKey());const e=await ac(n.localStore,t);n.currentUser=t,function(e,t){e.Ga.forEach((e=>{e.forEach((e=>{e.reject(new L(P.CANCELLED,t))}))})),e.Ga.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await eu(n,e.Rs)}}function nu(e,t){const n=D(e),r=n.Ua.get(t);if(r&&r.Ba)return da().add(r.key);{let e=da();const r=n.qa.get(t);if(!r)return e;for(const t of r){const r=n.ka.get(t);e=e.unionWith(r.view.Sa)}return e}}function ru(e){const t=D(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Vl.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=nu.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Hl.bind(null,t),t.La.p_=Tl.bind(null,t.eventManager),t.La.Ja=Sl.bind(null,t.eventManager),t}function au(e){const t=D(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Gl.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Wl.bind(null,t),t}class iu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Cc(e.databaseInfo.databaseId),this.sharedClientState=this.Za(e),this.persistence=this.Xa(e),await this.persistence.start(),this.localStore=this.eu(e),this.gcScheduler=this.tu(e,this.localStore),this.indexBackfillerScheduler=this.nu(e,this.localStore)}tu(e,t){return null}nu(e,t){return null}eu(e){return rc(this.persistence,new Zo,e.initialUser,this.serializer)}Xa(e){return new Mo(zo.ri,this.serializer)}Za(e){return new fc}async terminate(){var e,t;null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(t=this.indexBackfillerScheduler)||void 0===t||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}iu.provider={build:()=>new iu};class su extends iu{constructor(e){super(),this.cacheSizeBytes=e}tu(e,t){O(this.persistence.referenceDelegate instanceof jo);const n=this.persistence.referenceDelegate.garbageCollector;return new uo(n,e.asyncQueue,t)}Xa(e){const t=void 0!==this.cacheSizeBytes?Ks.withCacheSize(this.cacheSizeBytes):Ks.DEFAULT;return new Mo((e=>jo.ri(e,t)),this.serializer)}}class ou extends iu{constructor(e,t,n){super(),this.ru=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.ru.initialize(this,e),await au(this.ru.syncEngine),await el(this.ru.remoteStore),await this.persistence.Ci((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}eu(e){return rc(this.persistence,new Zo,e.initialUser,this.serializer)}tu(e,t){const n=this.persistence.referenceDelegate.garbageCollector;return new uo(n,e.asyncQueue,t)}nu(e,t){const n=new Fe(t,this.persistence);return new Me(e.asyncQueue,n)}Xa(e){const t=Qo(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?Ks.withCacheSize(this.cacheSizeBytes):Ks.DEFAULT;return new Ko(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,Ic(),kc(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Za(e){return new fc}}class cu{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>$l(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=tu.bind(null,this.syncEngine),await ul(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new bl}createDatastore(e){const t=Cc(e.databaseInfo.databaseId),n=function(e){return new Sc(e)}(e.databaseInfo);return function(e,t,n,r){return new Pc(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,a){return new Fc(e,t,n,r,a)}(this.localStore,this.datastore,e.asyncQueue,(e=>$l(this.syncEngine,e,0)),mc.D()?new mc:new pc)}createSyncEngine(e,t){return function(e,t,n,r,a,i,s){const o=new Ll(e,t,n,r,a,i);return s&&(o.ja=!0),o}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=D(e);C(Mc,"RemoteStore shutting down."),t.W_.add(5),await jc(t),t.z_.shutdown(),t.j_.set("Unknown")}(this.remoteStore),null===(e=this.datastore)||void 0===e||e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}cu.provider={build:()=>new cu};class lu{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.iu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.iu(this.observer.error,e):_("Uncaught Error in snapshot listener:",e.toString()))}su(){this.muted=!0}iu(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const uu="FirestoreClient";class du{constructor(e,t,n,r,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=T.UNAUTHENTICATED,this.clientId=K.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,(async e=>{C(uu,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(C(uu,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new M;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=pl(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function hu(e,t){e.asyncQueue.verifyOperationInProgress(),C(uu,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener((async e=>{r.isEqual(e)||(await ac(t.localStore,e),r=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function fu(e,t){e.asyncQueue.verifyOperationInProgress();const n=await pu(e);C(uu,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener((e=>ll(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>ll(t.remoteStore,n))),e._onlineComponents=t}async function pu(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){C(uu,"Using user provided OfflineComponentProvider");try{await hu(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(e){return"FirebaseError"===e.name?e.code===P.FAILED_PRECONDITION||e.code===P.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;A("Error using user provided cache. Falling back to memory cache: "+n),await hu(e,new iu)}}else C(uu,"Using default OfflineComponentProvider"),await hu(e,new su(void 0));return e._offlineComponents}async function gu(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(C(uu,"Using user provided OnlineComponentProvider"),await fu(e,e._uninitializedComponentsProvider._online)):(C(uu,"Using default OnlineComponentProvider"),await fu(e,new cu))),e._onlineComponents}function mu(e){return gu(e).then((e=>e.syncEngine))}async function vu(e){const t=await gu(e),n=t.eventManager;return n.onListen=Ml.bind(null,t.syncEngine),n.onUnlisten=Ul.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=Fl.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=Bl.bind(null,t.syncEngine),n}function yu(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new M;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,a){const i=new lu({next:n=>{i.su(),t.enqueueAndForget((()=>El(e,s))),n.fromCache&&"server"===r.source?a.reject(new L(P.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):a.resolve(n)},error:e=>a.reject(e)}),s=new _l(n,i,{includeMetadataChanges:!0,Ta:!0});return xl(e,s)}(await vu(e),e.asyncQueue,t,n,r))),r.promise}function bu(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const wu=new Map;function xu(e,t,n){if(!n)throw new L(P.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function Eu(e){if(!le.isDocumentKey(e))throw new L(P.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function Tu(e){if(le.isDocumentKey(e))throw new L(P.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function Su(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":R()}function Iu(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new L(P.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Su(e);throw new L(P.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function ku(e,t){if(t<=0)throw new L(P.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}const Cu="firestore.googleapis.com",_u=!0;class Au{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new L(P.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Cu,this.ssl=_u}else this.host=e.host,this.ssl=null!==(t=e.ssl)&&void 0!==t?t:_u;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=Ws;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<oo)throw new L(P.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new L(P.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=bu(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new L(P.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new L(P.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new L(P.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Nu{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Au({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new L(P.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new L(P.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Au(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new z;switch(e.type){case"firstParty":return new V(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new L(P.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=wu.get(e);t&&(C("ComponentProvider","Removing Datastore"),wu.delete(e),t.terminate())}(this),Promise.resolve()}}class Ru{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Ru(this.firestore,e,this._query)}}class Ou{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Du(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ou(this.firestore,e,this._key)}}class Du extends Ru{constructor(e,t,n){super(e,t,jr(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ou(this.firestore,null,new le(e))}withConverter(e){return new Du(this.firestore,e,this._path)}}function Pu(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];if(e=(0,c.Ku)(e),xu("collection","path",t),e instanceof Nu){const n=se.fromString(t,...r);return Tu(n),new Du(e,null,n)}{if(!(e instanceof Ou||e instanceof Du))throw new L(P.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(se.fromString(t,...r));return Tu(n),new Du(e.firestore,null,n)}}function Lu(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];if(e=(0,c.Ku)(e),1===arguments.length&&(t=K.newId()),xu("doc","path",t),e instanceof Nu){const n=se.fromString(t,...r);return Eu(n),new Ou(e,null,new le(n))}{if(!(e instanceof Ou||e instanceof Du))throw new L(P.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(se.fromString(t,...r));return Eu(n),new Ou(e.firestore,e instanceof Du?e.converter:null,new le(n))}}const Mu="AsyncQueue";class Fu{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Vu=[],this.mu=!1,this.fu=[],this.gu=null,this.pu=!1,this.yu=!1,this.wu=[],this.a_=new _c(this,"async_queue_retry"),this.Su=()=>{const e=kc();e&&C(Mu,"Visibility state changed to "+e.visibilityState),this.a_.t_()},this.bu=e;const t=kc();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Su)}get isShuttingDown(){return this.mu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Du(),this.vu(e)}enterRestrictedMode(e){if(!this.mu){this.mu=!0,this.yu=e||!1;const t=kc();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Su)}}enqueue(e){if(this.Du(),this.mu)return new Promise((()=>{}));const t=new M;return this.vu((()=>this.mu&&this.yu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Vu.push(e),this.Cu())))}async Cu(){if(0!==this.Vu.length){try{await this.Vu[0](),this.Vu.shift(),this.a_.reset()}catch(e){if(!Ne(e))throw e;C(Mu,"Operation failed with retryable error: "+e)}this.Vu.length>0&&this.a_.Xo((()=>this.Cu()))}}vu(e){const t=this.bu.then((()=>(this.pu=!0,e().catch((e=>{this.gu=e,this.pu=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw _("INTERNAL UNHANDLED ERROR: ",t),e})).then((e=>(this.pu=!1,e))))));return this.bu=t,t}enqueueAfterDelay(e,t,n){this.Du(),this.wu.indexOf(e)>-1&&(t=0);const r=fl.createAndSchedule(this,e,t,n,(e=>this.Fu(e)));return this.fu.push(r),r}Du(){this.gu&&R()}verifyOperationInProgress(){}async Mu(){let e;do{e=this.bu,await e}while(e!==this.bu)}xu(e){for(const t of this.fu)if(t.timerId===e)return!0;return!1}Ou(e){return this.Mu().then((()=>{this.fu.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.fu)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Mu()}))}Nu(e){this.wu.push(e)}Fu(e){const t=this.fu.indexOf(e);this.fu.splice(t,1)}}function zu(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const r of t)if(r in n&&"function"==typeof n[r])return!0;return!1}(e,["next","error","complete"])}class ju extends Nu{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new Fu,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Fu(e),this._firestoreClient=void 0,await e}}}function Uu(e,t){const n="object"==typeof e?e:(0,i.Sx)(),r="string"==typeof e?e:t||In,a=(0,i.j6)(n,"firestore").getImmediate({identifier:r});if(!a._initialized){const e=(0,c.yU)("firestore");e&&function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var a;const i=(e=Iu(e,Nu))._getSettings(),s=Object.assign(Object.assign({},i),{emulatorOptions:e._getEmulatorOptions()}),o=`${t}:${n}`;i.host!==Cu&&i.host!==o&&A("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l=Object.assign(Object.assign({},i),{host:o,ssl:!1,emulatorOptions:r});if(!(0,c.bD)(l,s)&&(e._setSettings(l),r.mockUserToken)){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=T.MOCK_USER;else{t=(0,c.Fy)(r.mockUserToken,null===(a=e._app)||void 0===a?void 0:a.options.projectId);const i=r.mockUserToken.sub||r.mockUserToken.user_id;if(!i)throw new L(P.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new T(i)}e._authCredentials=new j(new F(t,n))}}(a,...e)}return a}function Bu(e){if(e._terminated)throw new L(P.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||Vu(e),e._firestoreClient}function Vu(e){var t,n,r;const a=e._freezeSettings(),i=function(e,t,n,r){return new Sn(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,bu(r.experimentalLongPollingOptions),r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,a);e._componentsProvider||(null===(n=a.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=a.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),e._firestoreClient=new du(e._authCredentials,e._appCheckCredentials,e._queue,i,e._componentsProvider&&function(e){const t=null==e?void 0:e._online.build();return{_offline:null==e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}function $u(e,t){A("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=e._freezeSettings();return Hu(e,cu.provider,{build:e=>new ou(e,n.cacheSizeBytes,null==t?void 0:t.forceOwnership)}),Promise.resolve()}function Hu(e,t,n){if((e=Iu(e,ju))._firestoreClient||e._terminated)throw new L(P.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(e._componentsProvider||e._getSettings().localCache)throw new L(P.FAILED_PRECONDITION,"SDK cache is already specified.");e._componentsProvider={_online:t,_offline:n},Vu(e)}class Gu{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Gu(hn.fromBase64String(e))}catch(e){throw new L(P.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new Gu(hn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Wu{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;++r)if(0===t[r].length)throw new L(P.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ce(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Ku{constructor(e){this._methodName=e}}class qu{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new L(P.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new L(P.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return q(this._lat,e._lat)||q(this._long,e._long)}}class Yu{constructor(e){this._values=(e||[]).map((e=>e))}toArray(){return this._values.map((e=>e))}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}}const Qu=/^__.*__$/;class Xu{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new Ua(e,this.data,this.fieldMask,t,this.fieldTransforms):new ja(e,this.data,t,this.fieldTransforms)}}class Ju{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Ua(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Zu(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw R()}}class ed{constructor(e,t,n,r,a,i){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===a&&this.Bu(),this.fieldTransforms=a||[],this.fieldMask=i||[]}get path(){return this.settings.path}get Lu(){return this.settings.Lu}ku(e){return new ed(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}qu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ku({path:n,Qu:!1});return r.$u(e),r}Uu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ku({path:n,Qu:!1});return r.Bu(),r}Ku(e){return this.ku({path:void 0,Qu:!0})}Wu(e){return md(e,this.settings.methodName,this.settings.Gu||!1,this.path,this.settings.zu)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}Bu(){if(this.path)for(let e=0;e<this.path.length;e++)this.$u(this.path.get(e))}$u(e){if(0===e.length)throw this.Wu("Document fields must not be empty");if(Zu(this.Lu)&&Qu.test(e))throw this.Wu('Document fields cannot begin and end with "__"')}}class td{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Cc(e)}ju(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new ed({Lu:e,methodName:t,zu:n,path:ce.emptyPath(),Qu:!1,Gu:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function nd(e){const t=e._freezeSettings(),n=Cc(e._databaseId);return new td(e._databaseId,!!t.ignoreUndefinedProperties,n)}function rd(e,t,n,r,a){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const s=e.ju(i.merge||i.mergeFields?2:0,t,n,a);hd("Data must be an object, but it was:",s,r);const o=ud(r,s);let c,l;if(i.merge)c=new un(s.fieldMask),l=s.fieldTransforms;else if(i.mergeFields){const e=[];for(const r of i.mergeFields){const a=fd(t,r,n);if(!s.contains(a))throw new L(P.INVALID_ARGUMENT,`Field '${a}' is specified in your field mask but missing from your input data.`);vd(e,a)||e.push(a)}c=new un(e),l=s.fieldTransforms.filter((e=>c.covers(e.field)))}else c=null,l=s.fieldTransforms;return new Xu(new nr(o),c,l)}class ad extends Ku{_toFieldTransform(e){if(2!==e.Lu)throw 1===e.Lu?e.Wu(`${this._methodName}() can only appear at the top level of your update data`):e.Wu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof ad}}class id extends Ku{_toFieldTransform(e){return new Aa(e.path,new xa)}isEqual(e){return e instanceof id}}function sd(e,t,n,r){const a=e.ju(1,t,n);hd("Data must be an object, but it was:",a,r);const i=[],s=nr.empty();tn(r,((e,r)=>{const o=gd(t,e,n);r=(0,c.Ku)(r);const l=a.Uu(o);if(r instanceof ad)i.push(o);else{const e=ld(r,l);null!=e&&(i.push(o),s.set(o,e))}}));const o=new un(i);return new Ju(s,o,a.fieldTransforms)}function od(e,t,n,r,a,i){const s=e.ju(1,t,n),o=[fd(t,r,n)],l=[a];if(i.length%2!=0)throw new L(P.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let c=0;c<i.length;c+=2)o.push(fd(t,i[c])),l.push(i[c+1]);const u=[],d=nr.empty();for(let f=o.length-1;f>=0;--f)if(!vd(u,o[f])){const e=o[f];let t=l[f];t=(0,c.Ku)(t);const n=s.Uu(e);if(t instanceof ad)u.push(e);else{const r=ld(t,n);null!=r&&(u.push(e),d.set(e,r))}}const h=new un(u);return new Ju(d,h,s.fieldTransforms)}function cd(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return ld(n,e.ju(r?4:3,t))}function ld(e,t){if(dd(e=(0,c.Ku)(e)))return hd("Unsupported field value:",t,e),ud(e,t);if(e instanceof Ku)return function(e,t){if(!Zu(t.Lu))throw t.Wu(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.Wu(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.Qu&&4!==t.Lu)throw t.Wu("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const a of e){let e=ld(a,t.Ku(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=(0,c.Ku)(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return ma(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=ne.fromDate(e);return{timestampValue:wi(t.serializer,n)}}if(e instanceof ne){const n=new ne(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:wi(t.serializer,n)}}if(e instanceof qu)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Gu)return{bytesValue:xi(t.serializer,e._byteString)};if(e instanceof Ou){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Wu(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Si(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof Yu)return function(e,t){return{mapValue:{fields:{[Cn]:{stringValue:Nn},[Rn]:{arrayValue:{values:e.toArray().map((e=>{if("number"!=typeof e)throw t.Wu("VectorValues must only contain numeric values.");return pa(t.serializer,e)}))}}}}}}(e,t);throw t.Wu(`Unsupported field value: ${Su(e)}`)}(e,t)}function ud(e,t){const n={};return nn(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):tn(e,((e,r)=>{const a=ld(r,t.qu(e));null!=a&&(n[e]=a)})),{mapValue:{fields:n}}}function dd(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof ne||e instanceof qu||e instanceof Gu||e instanceof Ou||e instanceof Ku||e instanceof Yu)}function hd(e,t,n){if(!dd(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const r=Su(n);throw"an object"===r?t.Wu(e+" a custom object"):t.Wu(e+" "+r)}}function fd(e,t,n){if((t=(0,c.Ku)(t))instanceof Wu)return t._internalPath;if("string"==typeof t)return gd(e,t);throw md("Field path arguments must be of type string or ",e,!1,void 0,n)}const pd=new RegExp("[~\\*/\\[\\]]");function gd(e,t,n){if(t.search(pd)>=0)throw md(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new Wu(...t.split("."))._internalPath}catch(r){throw md(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function md(e,t,n,r,a){const i=r&&!r.isEmpty(),s=void 0!==a;let o=`Function ${t}() called with invalid data`;n&&(o+=" (via `toFirestore()`)"),o+=". ";let c="";return(i||s)&&(c+=" (found",i&&(c+=` in field ${r}`),s&&(c+=` in document ${a}`),c+=")"),new L(P.INVALID_ARGUMENT,o+e+c)}function vd(e,t){return e.some((e=>e.isEqual(t)))}class yd{constructor(e,t,n,r,a){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Ou(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new bd(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(wd("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class bd extends yd{data(){return super.data()}}function wd(e,t){return"string"==typeof t?gd(e,t):t instanceof Wu?t._internalPath:t._delegate._internalPath}function xd(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new L(P.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Ed{}class Td extends Ed{}function Sd(e,t){let n=[];for(var r=arguments.length,a=new Array(r>2?r-2:0),i=2;i<r;i++)a[i-2]=arguments[i];t instanceof Ed&&n.push(t),n=n.concat(a),function(e){const t=e.filter((e=>e instanceof Cd)).length,n=e.filter((e=>e instanceof Id)).length;if(t>1||t>0&&n>0)throw new L(P.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const s of n)e=s._apply(e);return e}class Id extends Td{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new Id(e,t,n)}_apply(e){const t=this._parse(e);return Od(e._query,t),new Ru(e.firestore,e.converter,Gr(e._query,t))}_parse(e){const t=nd(e.firestore),n=function(e,t,n,r,a,i,s){let o;if(a.isKeyField()){if("array-contains"===i||"array-contains-any"===i)throw new L(P.INVALID_ARGUMENT,`Invalid Query. You can't perform '${i}' queries on documentId().`);if("in"===i||"not-in"===i){Rd(s,i);const t=[];for(const n of s)t.push(Nd(r,e,n));o={arrayValue:{values:t}}}else o=Nd(r,e,s)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Rd(s,i),o=cd(n,t,s,"in"===i||"not-in"===i);return dr.create(a,i,o)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}function kd(e,t,n){const r=t,a=wd("where",e);return Id._create(a,r,n)}class Cd extends Ed{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Cd(e,t)}_parse(e){const t=this._queryConstraints.map((t=>t._parse(e))).filter((e=>e.getFilters().length>0));return 1===t.length?t[0]:hr.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const a of r)Od(n,a),n=Gr(n,a)}(e._query,t),new Ru(e.firestore,e.converter,Gr(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class _d extends Td{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new _d(e,t,n)}_apply(e){return new Ru(e.firestore,e.converter,Wr(e._query,this._limit,this._limitType))}}function Ad(e){return ku("limit",e),_d._create("limit",e,"F")}function Nd(e,t,n){if("string"==typeof(n=(0,c.Ku)(n))){if(""===n)throw new L(P.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Br(t)&&-1!==n.indexOf("/"))throw new L(P.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(se.fromString(n));if(!le.isDocumentKey(r))throw new L(P.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Vn(e,new le(r))}if(n instanceof Ou)return Vn(e,n._key);throw new L(P.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Su(n)}.`)}function Rd(e,t){if(!Array.isArray(e)||0===e.length)throw new L(P.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function Od(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new L(P.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new L(P.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}class Dd{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(Dn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return gn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(mn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw R()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return tn(e,((e,r)=>{n[e]=this.convertValue(r,t)})),n}convertVectorValue(e){var t,n,r;const a=null===(r=null===(n=null===(t=e.fields)||void 0===t?void 0:t[Rn].arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.map((e=>gn(e.doubleValue)));return new Yu(a)}convertGeoPoint(e){return new qu(gn(e.latitude),gn(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=En(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Tn(e));default:return null}}convertTimestamp(e){const t=pn(e);return new ne(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=se.fromString(e);O(qi(n));const r=new kn(n.get(1),n.get(3)),a=new le(n.popFirst(5));return r.isEqual(t)||_(`Document ${a} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}function Pd(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class Ld{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Md extends yd{constructor(e,t,n,r,a,i){super(e,t,n,r,i),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new Fd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(wd("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class Fd extends Md{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class zd{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Ld(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new Fd(this._firestore,this._userDataWriter,n.key,n,new Ld(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new L(P.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>{const r=new Fd(e._firestore,e._userDataWriter,n.doc.key,n.doc,new Ld(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const r=new Fd(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Ld(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let a=-1,i=-1;return 0!==t.type&&(a=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),i=n.indexOf(t.doc.key)),{type:jd(t.type),doc:r,oldIndex:a,newIndex:i}}))}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function jd(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return R()}}class Ud extends Dd{constructor(e){super(),this.firestore=e}convertBytes(e){return new Gu(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ou(this.firestore,null,t)}}function Bd(e){e=Iu(e,Ru);const t=Iu(e.firestore,ju),n=Bu(t),r=new Ud(t);return xd(e._query),yu(n,e._query).then((n=>new zd(t,r,e,n)))}function Vd(e,t,n){e=Iu(e,Ou);const r=Iu(e.firestore,ju),a=Pd(e.converter,t,n);return Kd(r,[rd(nd(r),"setDoc",e._key,a,null!==e.converter,n).toMutation(e._key,Ra.none())])}function $d(e,t,n){e=Iu(e,Ou);const r=Iu(e.firestore,ju),a=nd(r);let i;for(var s=arguments.length,o=new Array(s>3?s-3:0),l=3;l<s;l++)o[l-3]=arguments[l];return i="string"==typeof(t=(0,c.Ku)(t))||t instanceof Wu?od(a,"updateDoc",e._key,t,n,o):sd(a,"updateDoc",e._key,t),Kd(r,[i.toMutation(e._key,Ra.exists(!0))])}function Hd(e){return Kd(Iu(e.firestore,ju),[new Ha(e._key,Ra.none())])}function Gd(e,t){const n=Iu(e.firestore,ju),r=Lu(e),a=Pd(e.converter,t);return Kd(n,[rd(nd(e.firestore),"addDoc",r._key,a,null!==e.converter,{}).toMutation(r._key,Ra.exists(!1))]).then((()=>r))}function Wd(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a,i,s;e=(0,c.Ku)(e);let o={includeMetadataChanges:!1,source:"default"},l=0;"object"!=typeof n[l]||zu(n[l])||(o=n[l],l++);const u={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(zu(n[l])){const e=n[l];n[l]=null===(a=e.next)||void 0===a?void 0:a.bind(e),n[l+1]=null===(i=e.error)||void 0===i?void 0:i.bind(e),n[l+2]=null===(s=e.complete)||void 0===s?void 0:s.bind(e)}let d,h,f;if(e instanceof Ou)h=Iu(e.firestore,ju),f=jr(e._key.path),d={next:t=>{n[l]&&n[l](qd(h,e,t))},error:n[l+1],complete:n[l+2]};else{const t=Iu(e,Ru);h=Iu(t.firestore,ju),f=t._query;const r=new Ud(h);d={next:e=>{n[l]&&n[l](new zd(h,r,t,e))},error:n[l+1],complete:n[l+2]},xd(e._query)}return function(e,t,n,r){const a=new lu(r),i=new _l(t,a,n);return e.asyncQueue.enqueueAndForget((async()=>xl(await vu(e),i))),()=>{a.su(),e.asyncQueue.enqueueAndForget((async()=>El(await vu(e),i)))}}(Bu(h),f,u,d)}function Kd(e,t){return function(e,t){const n=new M;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){const r=au(e);try{const e=await function(e,t){const n=D(e),r=ne.now(),a=t.reduce(((e,t)=>e.add(t.key)),da());let i,s;return n.persistence.runTransaction("Locally write mutations","readwrite",(e=>{let o=na(),c=da();return n.ds.getEntries(e,a).next((e=>{o=e,o.forEach(((e,t)=>{t.isValidDocument()||(c=c.add(e))}))})).next((()=>n.localDocuments.getOverlayedDocuments(e,o))).next((a=>{i=a;const s=[];for(const e of t){const t=Fa(e,i.get(e.key).overlayedDocument);null!=t&&s.push(new Ua(e.key,t,rr(t.value.mapValue),Ra.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,s,t)})).next((t=>{s=t;const r=t.applyToLocalDocumentSet(i,c);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)}))})).then((()=>({batchId:s.batchId,changes:ia(i)})))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Wa[e.currentUser.toKey()];r||(r=new rn(q)),r=r.insert(t,n),e.Wa[e.currentUser.toKey()]=r}(r,e.batchId,n),await eu(r,e.changes),await el(r.remoteStore)}catch(e){const t=pl(e,"Failed to persist write");n.reject(t)}}(await mu(e),t,n))),n.promise}(Bu(e),t)}function qd(e,t,n){const r=n.docs.get(t._key),a=new Ud(e);return new Md(e,a,t._key,r,new Ld(n.hasPendingWrites,n.fromCache),t.converter)}class Yd{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=nd(e)}set(e,t,n){this._verifyNotCommitted();const r=Qd(e,this._firestore),a=Pd(r.converter,t,n),i=rd(this._dataReader,"WriteBatch.set",r._key,a,null!==r.converter,n);return this._mutations.push(i.toMutation(r._key,Ra.none())),this}update(e,t,n){this._verifyNotCommitted();const r=Qd(e,this._firestore);let a;for(var i=arguments.length,s=new Array(i>3?i-3:0),o=3;o<i;o++)s[o-3]=arguments[o];return a="string"==typeof(t=(0,c.Ku)(t))||t instanceof Wu?od(this._dataReader,"WriteBatch.update",r._key,t,n,s):sd(this._dataReader,"WriteBatch.update",r._key,t),this._mutations.push(a.toMutation(r._key,Ra.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Qd(e,this._firestore);return this._mutations=this._mutations.concat(new Ha(t._key,Ra.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new L(P.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Qd(e,t){if((e=(0,c.Ku)(e)).firestore!==t)throw new L(P.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}function Xd(){return new id("serverTimestamp")}function Jd(e){return Bu(e=Iu(e,ju)),new Yd(e,(t=>Kd(e,t)))}new WeakMap;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){S=e}(i.MF),(0,i.om)(new s.uA("firestore",((e,n)=>{let{instanceIdentifier:r,options:a}=n;const i=e.getProvider("app").getImmediate(),s=new ju(new U(e.getProvider("auth-internal")),new H(i,e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new L(P.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new kn(e.options.projectId,t)}(i,r),i);return a=Object.assign({useFetchStreams:t},a),s._setSettings(a),s}),"PUBLIC").setMultipleInstances(!0)),(0,i.KO)(x,E,e),(0,i.KO)(x,E,"esm2017")}()},496:(e,t,n)=>{n.d(t,{El:()=>c,Ge:()=>o,Kc:()=>i,procesarSolicitud:()=>s});var r=n(472),a=n(213);const i=async(e,t,n,i)=>{try{if(!e||!e.length)return i&&i("No hay solicitudes pendientes para procesar"),{success:!0,message:"No hay solicitudes pendientes para procesar"};i&&i("Iniciando procesamiento de solicitudes...");const o=[...e],c=t.map((e=>({orden:e.order,centroActual:e.id,estaAsignada:!0,docId:e.docId,timestamp:e.timestamp||0,centro:e.centro,localidad:e.localidad,municipio:e.municipio}))),l=[...o,...c].sort(((e,t)=>Number(e.orden)-Number(t.orden)));i&&i(`Procesando ${l.length} solicitudes por prioridad...`);const u=n.map((e=>({...e,asignadas:0,asignacionesPorOrden:[]}))),d=u.reduce(((e,t)=>(e[t.id]=t,e)),{});i&&i("Eliminando asignaciones existentes para recalcular...");for(const e of t)e.docId&&await(0,r.kd)((0,r.H9)(a.db,"asignaciones",e.docId));for(const e of u)e.docId&&await(0,r.mZ)((0,r.H9)(a.db,"centros",e.docId),{asignadas:0});let h=0,f=0;const p=[],g=new Set,m=[],v=[];for(const e of l){if(g.has(e.orden))continue;i&&i(`Procesando solicitud/asignaci\xf3n #${e.orden} (procesadas: ${g.size})`);let t=!1,n=null;if(e.estaAsignada&&e.centroActual){const i=d[e.centroActual];if(i&&i.asignadas<i.plazas){i.asignadas++,i.asignacionesPorOrden.push(e.orden);const s={order:e.orden,id:i.id,localidad:i.localidad||e.localidad||"",centro:i.centro||e.centro||"",municipio:i.municipio||e.municipio||"",timestamp:Date.now(),mantenida:!0};Object.keys(s).forEach((e=>{void 0===s[e]&&(console.warn(`Campo ${e} indefinido en asignaci\xf3n. Estableciendo valor por defecto.`),s[e]="timestamp"===e||"order"===e?0:"")})),console.log("Documento de asignaci\xf3n normalizado en procesarSolicitudes:",s);const o=(0,r.H9)((0,r.rJ)(a.db,"asignaciones"));await(0,r.BN)(o,s),p.push({...s,docId:o.id}),t=!0,n=i,v.push({tipo:"MANTENIDA",orden:e.orden,centroId:i.id,centro:i.centro,mensaje:`Asignaci\xf3n mantenida en ${i.centro}`})}}if(!t){const i=e.centrosIds||(e.estaAsignada?[e.centroActual]:[]),s=i.length>0?i.map((e=>d[e])).filter(Boolean):u.sort(((e,t)=>e.asignadas/e.plazas-t.asignadas/t.plazas));for(const o of s){if(o.asignadas<o.plazas){o.asignadas++,o.asignacionesPorOrden.push(e.orden);const i={order:e.orden,id:o.id,localidad:o.localidad||e.localidad||"",centro:o.centro||e.centro||"",municipio:o.municipio||e.municipio||"",timestamp:Date.now()};Object.keys(i).forEach((e=>{void 0===i[e]&&(console.warn(`Campo ${e} indefinido en asignaci\xf3n. Estableciendo valor por defecto.`),i[e]="timestamp"===e||"order"===e?0:"")})),console.log("Documento de asignaci\xf3n normalizado en procesarSolicitudes:",i);const s=(0,r.H9)((0,r.rJ)(a.db,"asignaciones"));await(0,r.BN)(s,i),p.push({...i,docId:s.id}),h++,t=!0,n=o,!e.estaAsignada&&e.docId&&m.push(e.docId),v.push({tipo:e.estaAsignada?"REASIGNADA":"ASIGNADA",orden:e.orden,centroId:o.id,centro:o.centro,mensaje:e.estaAsignada?`Reasignada de ${e.centro||"centro anterior"} a ${o.centro}`:`Asignada a ${o.centro}`});break}if(o.asignacionesPorOrden.length>0){const i=o.asignacionesPorOrden,s=Math.max(...i);if(Number(s)>Number(e.orden)){console.log(`Posible desplazamiento: Orden ${e.orden} tiene mayor prioridad que ${s} en ${o.centro}`);const i=p.find((e=>e.order==s&&e.id===o.id));if(i){l.find((e=>e.orden==s));const c=u.filter((e=>e.id!==o.id&&e.asignadas<e.plazas));if(c.length>0){const l=c[0];o.asignacionesPorOrden=o.asignacionesPorOrden.filter((e=>e!=s)),o.asignacionesPorOrden.push(e.orden);const u={order:e.orden,id:o.id,localidad:o.localidad||e.localidad||"",centro:o.centro||e.centro||"",municipio:o.municipio||e.municipio||"",timestamp:Date.now(),priorizado:!0};Object.keys(u).forEach((e=>{void 0===u[e]&&(console.warn(`Campo ${e} indefinido en asignaci\xf3n. Estableciendo valor por defecto.`),u[e]="timestamp"===e||"order"===e?0:"")})),console.log("Documento de asignaci\xf3n normalizado en procesarSolicitudes:",u);const d=(0,r.H9)((0,r.rJ)(a.db,"asignaciones"));await(0,r.BN)(d,u),p.push({...u,docId:d.id}),l.asignadas++,l.asignacionesPorOrden.push(s);const h={order:s,id:l.id,localidad:l.localidad,centro:l.centro,municipio:l.municipio,timestamp:Date.now(),desplazada:!0,centroAnterior:o.centro},g=(0,r.H9)((0,r.rJ)(a.db,"asignaciones"));await(0,r.BN)(g,h),i.docId&&await(0,r.kd)((0,r.H9)(a.db,"asignaciones",i.docId));const y=p.findIndex((e=>e.order==s&&e.id===o.id));y>=0&&p.splice(y,1),p.push({...h,docId:g.id}),t=!0,n=o,f++,!e.estaAsignada&&e.docId&&m.push(e.docId),v.push({tipo:"PRIORIZADA",orden:e.orden,centroId:o.id,centro:o.centro,mensaje:`Priorizada en ${o.centro}, desplazando a orden ${s}`}),v.push({tipo:"DESPLAZADA",orden:s,centroId:l.id,centro:l.centro,centroAnterior:o.centro,mensaje:`Desplazada de ${o.centro} a ${l.centro} por orden ${e.orden} de mayor prioridad`});break}}}}}}g.add(e.orden),t||(v.push({tipo:"NO_ASIGNABLE",orden:e.orden,mensaje:"No hay plazas disponibles en ninguno de los centros solicitados"}),!e.estaAsignada&&e.docId&&m.push(e.docId))}i&&i(`Registrando ${v.length} operaciones en el historial...`);for(const e of v)try{const t=(0,r.H9)((0,r.rJ)(a.db,"historialSolicitudes")),n={orden:e.orden||0,estado:e.tipo||"DESCONOCIDO",fechaHistorico:(new Date).toISOString(),timestamp:Date.now(),mensaje:e.mensaje||""};void 0!==e.centroId&&(n.centroId=e.centroId),void 0!==e.centro&&(n.centroAsignado=e.centro),void 0!==e.centroAnterior&&(n.centroAnterior=e.centroAnterior),Object.keys(n).forEach((e=>{void 0===n[e]&&(console.warn(`Campo ${e} indefinido en historialData. Estableciendo valor por defecto.`),n[e]="timestamp"===e||"orden"===e?0:"")})),console.log("Guardando registro de historial:",n),await(0,r.BN)(t,n)}catch(s){console.error(`Error al registrar historial para orden ${e.orden}:`,s)}if(m.length>0){i&&i(`Eliminando ${m.length} solicitudes procesadas...`);let e=0;for(const t of m)try{await(0,r.kd)((0,r.H9)(a.db,"solicitudesPendientes",t)),e++}catch(s){console.error(`Error al eliminar solicitud ${t}:`,s)}i&&i(`Se eliminaron ${e} solicitudes pendientes ya procesadas.`)}i&&i("Actualizando contadores en los centros...");for(const e of u)e.docId&&await(0,r.mZ)((0,r.H9)(a.db,"centros",e.docId),{asignadas:e.asignadas});return i&&i(`Procesamiento completado. ${h} nuevas asignaciones, ${f} reasignaciones.`),{success:!0,nuevasAsignaciones:p,eliminadas:m.length,asignacionesNuevas:h,reasignaciones:f,message:`Asignaciones procesadas por prioridad. ${h} nuevas, ${f} reasignaciones.`}}catch(s){return console.error("Error en procesarSolicitudes:",s),i&&i("Error: "+s.message),{success:!1,message:s.message}}},s=async(e,t,n)=>{try{if(console.log("Procesando solicitud individual:",e),!e||!e.centrosIds||!Array.isArray(e.centrosIds))return{success:!1,message:"La solicitud no tiene formato correcto"};if(0===e.centrosIds.length)return{success:!1,message:"La solicitud no tiene centros seleccionados",noAsignable:!0};let a=null,i=null;for(const n of e.centrosIds){const e=t.find((e=>e.id===n));if(e){if(console.log(`Verificando centro ${e.nombre||e.centro}: ${e.plazasDisponibles} plazas disponibles`),e.plazasDisponibles>0){a=e,i=n;break}}else console.log(`Centro no encontrado: ${n}`)}if(!a){if(1===e.centrosIds.length){const a=e.centrosIds[0],i=t.find((e=>e.id===a));if(i){console.log(`Creando asignaci\xf3n especial para solicitud ${e.orden} en centro ${i.nombre||i.centro} que est\xe1 completo`);const t=(0,r.wP)(n),s=i.nombre||i.centro||i.nombreCentro||`Centro ${a}`,o={numeroOrden:e.orden||0,centerId:a,nombreCentro:s,timestamp:Date.now(),fechaAsignacion:(new Date).toISOString(),municipio:i.municipio||"",localidad:i.localidad||"",estadoAsignacion:"NO_ASIGNABLE",mensajeEstado:"No hay plazas disponibles en el \xfanico centro seleccionado",historial:[{accion:"asignaci\xf3n especial",timestamp:Date.now(),detalles:`No se pudo asignar al centro ${s} por falta de plazas disponibles`}]};Object.keys(o).forEach((e=>{void 0===o[e]&&(console.warn(`Campo ${e} indefinido en nuevaAsignacion especial. Estableciendo valor por defecto.`),o[e]="historial"===e?[]:"timestamp"===e||"numeroOrden"===e?0:"")})),o.historial&&Array.isArray(o.historial)&&(o.historial=o.historial.map((e=>{if(!e)return{accion:"",timestamp:Date.now(),detalles:""};const t={...e};return Object.keys(t).forEach((e=>{void 0===t[e]&&(t[e]="timestamp"===e?Date.now():"")})),t}))),console.log("Documento de asignaci\xf3n especial normalizado:",o);const c=(0,r.H9)((0,r.rJ)(n,"asignaciones"));t.set(c,o);const l=(0,r.H9)((0,r.rJ)(n,"historialSolicitudes"));return t.set(l,{orden:e.orden||0,estado:"NO_ASIGNABLE",mensaje:`No hay plazas disponibles en el \xfanico centro seleccionado (${s})`,fechaHistorico:(new Date).toISOString(),timestamp:Date.now(),centroAnterior:a}),await t.commit(),{success:!0,noAsignable:!0,casoEspecial:!0,message:"Se cre\xf3 una asignaci\xf3n especial porque el \xfanico centro seleccionado est\xe1 completo",centroAsignado:i,centroId:a,asignacionId:c.id}}}return{success:!1,message:"No hay plazas disponibles en los centros seleccionados",noAsignable:!0}}const s=(0,r.wP)(n),o=a.nombre||a.centro||a.nombreCentro||`Centro ${i}`,c={numeroOrden:e.orden||0,centerId:i,nombreCentro:o,timestamp:Date.now(),fechaAsignacion:(new Date).toISOString(),municipio:a.municipio||"",localidad:a.localidad||"",historial:[{accion:"asignaci\xf3n inicial",timestamp:Date.now(),detalles:`Asignado a ${o}`}]};Object.keys(c).forEach((e=>{void 0===c[e]&&(console.warn(`Campo ${e} indefinido en nuevaAsignacion. Estableciendo valor por defecto.`),c[e]="historial"===e?[]:"timestamp"===e||"numeroOrden"===e?0:"")})),c.historial&&Array.isArray(c.historial)&&(c.historial=c.historial.map((e=>{if(!e)return{accion:"",timestamp:Date.now(),detalles:""};const t={...e};return Object.keys(t).forEach((e=>{void 0===t[e]&&(t[e]="timestamp"===e?Date.now():"")})),t}))),console.log("Documento de asignaci\xf3n normalizado:",c);const l=(0,r.H9)((0,r.rJ)(n,"asignaciones"));s.set(l,c);const u=(0,r.H9)(n,"centros",i);return s.update(u,{plazasOcupadas:(a.plazasOcupadas||0)+1}),await s.commit(),console.log(`Asignaci\xf3n creada exitosamente para solicitud ${e.orden} en centro ${a.nombre}`),{success:!0,centroAsignado:a,centroId:i,asignacionId:l.id}}catch(a){return console.error("Error al procesar solicitud individual:",a),{success:!1,message:`Error al procesar: ${a.message}`}}},o=async(e,t,n)=>{try{for(const t of e)if(t.docId)try{await(0,r.mZ)((0,r.H9)(n,"centros",t.docId),{asignadas:0})}catch(a){console.error(`Error al resetear contador para ${t.centro}:`,a)}const i={};for(const e of t){const t=e.centroId||e.id;t&&(i[t]=(i[t]||0)+1)}let s=0,o=0;for(const t of e){const e=t.id;if(e&&i[e]&&t.docId)try{await(0,r.mZ)((0,r.H9)(n,"centros",t.docId),{asignadas:i[e]}),s++}catch(a){console.error(`Error al actualizar contador para ${t.centro}:`,a),o++}}return{success:!0,actualizados:s,errores:o,message:`Contadores reiniciados. ${s} centros actualizados.`}}catch(a){return console.error("Error al resetear contadores:",a),{success:!1,error:a.message,message:"Error al resetear contadores: "+a.message}}},c=async(e,t,n)=>{try{if(!Array.isArray(e))return console.error("Error: centros debe ser un array",e),{success:!1,message:"Lista de centros inv\xe1lida",error:"centros debe ser un array"};if(!Array.isArray(t))return console.error("Error: asignaciones debe ser un array",t),{success:!1,message:"Lista de asignaciones inv\xe1lida",error:"asignaciones debe ser un array"};if(!n)return console.error("Error: no se proporcion\xf3 la referencia a la base de datos"),{success:!1,message:"Referencia a la base de datos no proporcionada",error:"db es requerido"};console.log("Verificando centros con exceso de asignaciones...");const i=e.filter((e=>e&&"object"===typeof e&&!isNaN(e.asignadas)&&!isNaN(e.plazas)));if(0===i.length)return console.log("No hay centros v\xe1lidos para verificar"),{success:!0,message:"No hay centros v\xe1lidos para verificar",corregidos:0};const s=i.filter((e=>e.asignadas>e.plazas));if(0===s.length)return console.log("No se encontraron centros con exceso de asignaciones"),{success:!0,message:"No hay centros con exceso",corregidos:0};console.log(`Centros con exceso: ${s.length}`);const o=i.filter((e=>e.asignadas<e.plazas));let c=0,l=0,u=0;for(const e of s){if(!e.centro||!e.id){console.warn("Centro inv\xe1lido:",e);continue}console.log(`Centro ${e.centro}: ${e.asignadas} asignadas, ${e.plazas} plazas`);const i=t.filter((t=>t&&t.id===e.id));if(!i.length){console.warn(`No se encontraron asignaciones para ${e.centro}`);continue}i.sort(((e,t)=>(Number(e.order)||0)-(Number(t.order)||0)));if(e.asignadas-e.plazas<=0)continue;const s=i.slice(e.plazas);console.log(`Procesando ${s.length} asignaciones excedentes en ${e.centro}`);for(const t of s)try{let i=!1;const s=o.filter((t=>t.id!==e.id));if(s.length>0){const a=[...s].sort(((e,t)=>e.asignadas/e.plazas-t.asignadas/t.plazas))[0];if(a&&a.asignadas<a.plazas){const s=(0,r.H9)((0,r.rJ)(n,"asignaciones")),o={order:t.order,id:a.id,localidad:a.localidad,centro:a.centro,municipio:a.municipio,timestamp:Date.now(),reasignado:!0,centroOriginal:e.centro};await(0,r.BN)(s,o),await(0,r.mZ)((0,r.H9)(n,"centros",a.docId),{asignadas:a.asignadas+1});const c=(0,r.H9)((0,r.rJ)(n,"historialSolicitudes")),u={orden:t.order,centroIdOriginal:t.id,centroIdNuevo:a.id,estado:"REASIGNADO",mensaje:`Reasignaci\xf3n de ${e.centro} a ${a.centro} por exceso de plazas`,centroOriginal:t.centro||e.centro,centroAsignado:a.centro,localidad:a.localidad,municipio:a.municipio,fechaHistorico:(new Date).toISOString(),timestamp:Date.now()};await(0,r.BN)(c,u),a.asignadas++,i=!0,l++,console.log(`Asignaci\xf3n ${t.order} reasignada de ${e.centro} a ${a.centro}`)}}if(!i)try{const a=(0,r.H9)((0,r.rJ)(n,"historialSolicitudes")),i={orden:t.order,centroId:t.id,estado:"EXCESO_NO_REASIGNABLE",mensaje:`Centro ${e.centro} con exceso de plazas. Se mantiene la asignaci\xf3n actual.`,centroAsignado:t.centro||e.centro,localidad:t.localidad||e.localidad,municipio:t.municipio||e.municipio,fechaHistorico:(new Date).toISOString(),timestamp:Date.now()};await(0,r.BN)(a,i),console.log(`Asignaci\xf3n ${t.order} en exceso en ${e.centro}, pero se mantiene sin convertir a solicitud pendiente`),c++}catch(a){console.error(`Error al registrar en historial para orden ${t.order}:`,a)}t.docId?(await(0,r.kd)((0,r.H9)(n,"asignaciones",t.docId)),c++,console.log(`Asignaci\xf3n ${t.docId} eliminada`)):console.warn(`Asignaci\xf3n sin docId para orden ${t.order}`)}catch(a){console.error(`Error al corregir asignaci\xf3n para orden ${t.order}:`,a)}if(e.docId)try{await(0,r.mZ)((0,r.H9)(n,"centros",e.docId),{asignadas:e.plazas}),console.log(`Contador actualizado para ${e.centro}: ${e.plazas}`)}catch(a){console.error(`Error al actualizar contador para ${e.centro}:`,a)}else console.warn(`Centro ${e.centro} sin docId, no se actualiz\xf3 contador`)}return{success:!0,message:`Se corrigieron ${c} asignaciones excedentes (${l} reasignadas, ${u} recuperadas)`,corregidos:c,reasignados:l,recuperados:u}}catch(a){return console.error("Error en verificaci\xf3n y correcci\xf3n:",a),{success:!1,error:a.message,message:"Error en verificaci\xf3n: "+a.message}}}},529:(e,t,n)=>{n.d(t,{cY:()=>p,FA:()=>C,g:()=>k,dM:()=>I,u:()=>o,Uj:()=>s,p9:()=>V,Fy:()=>g,tD:()=>L,bD:()=>N,hp:()=>P,T9:()=>h,Tj:()=>u,yU:()=>d,XA:()=>f,Ku:()=>$,ZQ:()=>m,sr:()=>b,c1:()=>y,Im:()=>A,lT:()=>x,zW:()=>T,jZ:()=>v,lV:()=>w,nr:()=>E,Am:()=>O,I9:()=>D,eX:()=>S});const r=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let a=e.charCodeAt(r);a<128?t[n++]=a:a<2048?(t[n++]=a>>6|192,t[n++]=63&a|128):55296===(64512&a)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(a=65536+((1023&a)<<10)+(1023&e.charCodeAt(++r)),t[n++]=a>>18|240,t[n++]=a>>12&63|128,t[n++]=a>>6&63|128,t[n++]=63&a|128):(t[n++]=a>>12|224,t[n++]=a>>6&63|128,t[n++]=63&a|128)}return t},a={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let a=0;a<e.length;a+=3){const t=e[a],i=a+1<e.length,s=i?e[a+1]:0,o=a+2<e.length,c=o?e[a+2]:0,l=t>>2,u=(3&t)<<4|s>>4;let d=(15&s)<<2|c>>6,h=63&c;o||(h=64,i||(d=64)),r.push(n[l],n[u],n[d],n[h])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(r(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const a=e[n++];if(a<128)t[r++]=String.fromCharCode(a);else if(a>191&&a<224){const i=e[n++];t[r++]=String.fromCharCode((31&a)<<6|63&i)}else if(a>239&&a<365){const i=((7&a)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(i>>10)),t[r++]=String.fromCharCode(56320+(1023&i))}else{const i=e[n++],s=e[n++];t[r++]=String.fromCharCode((15&a)<<12|(63&i)<<6|63&s)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let a=0;a<e.length;){const t=n[e.charAt(a++)],s=a<e.length?n[e.charAt(a)]:0;++a;const o=a<e.length?n[e.charAt(a)]:64;++a;const c=a<e.length?n[e.charAt(a)]:64;if(++a,null==t||null==s||null==o||null==c)throw new i;const l=t<<2|s>>4;if(r.push(l),64!==o){const e=s<<4&240|o>>2;if(r.push(e),64!==c){const e=o<<6&192|c;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class i extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const s=function(e){return function(e){const t=r(e);return a.encodeByteArray(t,!0)}(e).replace(/\./g,"")},o=function(e){try{return a.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};const c=()=>function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,l=()=>{try{return c()||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"/asignacion-plazas",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_FIREBASE_API_KEY:"AIzaSyDo7X1BLIW1hNYQpJLZcDws_L4aGHJWXOQ",REACT_APP_FIREBASE_AUTH_DOMAIN:"asignacion-plazas.firebaseapp.com",REACT_APP_FIREBASE_PROJECT_ID:"asignacion-plazas",REACT_APP_FIREBASE_STORAGE_BUCKET:"asignacion-plazas.firebasestorage.app",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"525955676079",REACT_APP_FIREBASE_APP_ID:"1:525955676079:web:a7e0b00391e75c902fe15a",REACT_APP_FIREBASE_MEASUREMENT_ID:"G-E0DLWYPVKP"}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const t=e&&o(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},u=e=>{var t,n;return null===(n=null===(t=l())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},d=e=>{const t=u(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]},h=()=>{var e;return null===(e=l())||void 0===e?void 0:e.config},f=e=>{var t;return null===(t=l())||void 0===t?void 0:t[`_${e}`]};class p{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function g(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,a=e.sub||e.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const i=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},e);return[s(JSON.stringify({alg:"none",type:"JWT"})),s(JSON.stringify(i)),""].join(".")}function m(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function v(){return"undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(m())}function y(){return"undefined"!==typeof navigator&&"Cloudflare-Workers"===navigator.userAgent}function b(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}function w(){return"object"===typeof navigator&&"ReactNative"===navigator.product}function x(){const e=m();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function E(){return!function(){var e;const t=null===(e=l())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(r){return!1}}()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function T(){try{return"object"===typeof indexedDB}catch(e){return!1}}function S(){return new Promise(((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(r);a.onsuccess=()=>{a.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},a.onupgradeneeded=()=>{n=!1},a.onerror=()=>{var e;t((null===(e=a.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}}))}function I(){return!("undefined"===typeof navigator||!navigator.cookieEnabled)}class k extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,k.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,C.prototype.create)}}class C{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n=`${this.service}/${e}`,r=this.errors[e],a=r?function(e,t){return e.replace(_,((e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`}))}(r,t):"Error",i=`${this.serviceName}: ${a} (${n}).`;return new k(n,i,t)}}const _=/\{\$([^}]+)}/g;function A(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function N(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const a of n){if(!r.includes(a))return!1;const n=e[a],i=t[a];if(R(n)&&R(i)){if(!N(n,i))return!1}else if(n!==i)return!1}for(const a of r)if(!n.includes(a))return!1;return!0}function R(e){return null!==e&&"object"===typeof e}function O(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function D(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}})),t}function P(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}function L(e,t){const n=new M(e,t);return n.subscribe.bind(n)}class M{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!==typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"===typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=F),void 0===r.error&&(r.error=F),void 0===r.complete&&(r.complete=F);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}})),this.observers.push(r),a}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){"undefined"!==typeof console&&console.error&&console.error(n)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function F(){}const z=1e3,j=2,U=144e5,B=.5;function V(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:j;const n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:z)*Math.pow(t,e),r=Math.round(B*n*(Math.random()-.5)*2);return Math.min(U,n+r)}function $(e){return e&&e._delegate?e._delegate:e}},579:(e,t,n)=>{e.exports=n(153)},730:(e,t,n)=>{var r=n(43),a=n(853);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,o={};function c(e,t){l(e,t),l(e+"Capture",t)}function l(e,t){for(o[e]=t,e=0;e<t.length;e++)s.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function g(e,t,n,r,a,i,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=s}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){m[e]=new g(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];m[t]=new g(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){m[e]=new g(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){m[e]=new g(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){m[e]=new g(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){m[e]=new g(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){m[e]=new g(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){m[e]=new g(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){m[e]=new g(e,5,!1,e.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,r){var a=m.hasOwnProperty(t)?m[t]:null;(null!==a?0!==a.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,a,r)&&(n=null),r||null===a?function(e){return!!d.call(p,e)||!d.call(f,e)&&(h.test(e)?p[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=null===n?3!==a.type&&"":n:(t=a.attributeName,r=a.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(a=a.type)||4===a&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(v,y);m[t]=new g(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(v,y);m[t]=new g(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(v,y);m[t]=new g(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!1,!1)})),m.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!0,!0)}));var w=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,x=Symbol.for("react.element"),E=Symbol.for("react.portal"),T=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),I=Symbol.for("react.profiler"),k=Symbol.for("react.provider"),C=Symbol.for("react.context"),_=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),N=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),O=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var D=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var P=Symbol.iterator;function L(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=P&&e[P]||e["@@iterator"])?e:null}var M,F=Object.assign;function z(e){if(void 0===M)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);M=t&&t[1]||""}return"\n"+M+e}var j=!1;function U(e,t){if(!e||j)return"";j=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var r=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){r=l}e.call(t.prototype)}else{try{throw Error()}catch(l){r=l}e()}}catch(l){if(l&&r&&"string"===typeof l.stack){for(var a=l.stack.split("\n"),i=r.stack.split("\n"),s=a.length-1,o=i.length-1;1<=s&&0<=o&&a[s]!==i[o];)o--;for(;1<=s&&0<=o;s--,o--)if(a[s]!==i[o]){if(1!==s||1!==o)do{if(s--,0>--o||a[s]!==i[o]){var c="\n"+a[s].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}}while(1<=s&&0<=o);break}}}finally{j=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?z(e):""}function B(e){switch(e.tag){case 5:return z(e.type);case 16:return z("Lazy");case 13:return z("Suspense");case 19:return z("SuspenseList");case 0:case 2:case 15:return e=U(e.type,!1);case 11:return e=U(e.type.render,!1);case 1:return e=U(e.type,!0);default:return""}}function V(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case T:return"Fragment";case E:return"Portal";case I:return"Profiler";case S:return"StrictMode";case A:return"Suspense";case N:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case C:return(e.displayName||"Context")+".Consumer";case k:return(e._context.displayName||"Context")+".Provider";case _:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case R:return null!==(t=e.displayName||null)?t:V(e.type)||"Memo";case O:t=e._payload,e=e._init;try{return V(e(t))}catch(n){}}return null}function $(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(t);case 8:return t===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function H(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function G(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function W(e){e._valueTracker||(e._valueTracker=function(e){var t=G(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var a=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=G(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function q(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var n=t.checked;return F({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Q(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=H(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function X(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function J(e,t){X(e,t);var n=H(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,H(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&q(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+H(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(i(91));return F({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ae(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(i(92));if(te(n)){if(1<n.length)throw Error(i(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:H(n)}}function ie(e,t){var n=H(t.value),r=H(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function se(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ce(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var le,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((le=le||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=le.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function ge(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function me(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),a=ge(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}Object.keys(fe).forEach((function(e){pe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]}))}));var ve=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(i(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(i(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(i(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var we=null;function xe(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ee=null,Te=null,Se=null;function Ie(e){if(e=ba(e)){if("function"!==typeof Ee)throw Error(i(280));var t=e.stateNode;t&&(t=xa(t),Ee(e.stateNode,e.type,t))}}function ke(e){Te?Se?Se.push(e):Se=[e]:Te=e}function Ce(){if(Te){var e=Te,t=Se;if(Se=Te=null,Ie(e),t)for(e=0;e<t.length;e++)Ie(t[e])}}function _e(e,t){return e(t)}function Ae(){}var Ne=!1;function Re(e,t,n){if(Ne)return e(t,n);Ne=!0;try{return _e(e,t,n)}finally{Ne=!1,(null!==Te||null!==Se)&&(Ae(),Ce())}}function Oe(e,t){var n=e.stateNode;if(null===n)return null;var r=xa(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(i(231,t,typeof n));return n}var De=!1;if(u)try{var Pe={};Object.defineProperty(Pe,"passive",{get:function(){De=!0}}),window.addEventListener("test",Pe,Pe),window.removeEventListener("test",Pe,Pe)}catch(ue){De=!1}function Le(e,t,n,r,a,i,s,o,c){var l=Array.prototype.slice.call(arguments,3);try{t.apply(n,l)}catch(u){this.onError(u)}}var Me=!1,Fe=null,ze=!1,je=null,Ue={onError:function(e){Me=!0,Fe=e}};function Be(e,t,n,r,a,i,s,o,c){Me=!1,Fe=null,Le.apply(Ue,arguments)}function Ve(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function $e(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function He(e){if(Ve(e)!==e)throw Error(i(188))}function Ge(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ve(e)))throw Error(i(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var s=a.alternate;if(null===s){if(null!==(r=a.return)){n=r;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===n)return He(a),e;if(s===r)return He(a),t;s=s.sibling}throw Error(i(188))}if(n.return!==r.return)n=a,r=s;else{for(var o=!1,c=a.child;c;){if(c===n){o=!0,n=a,r=s;break}if(c===r){o=!0,r=a,n=s;break}c=c.sibling}if(!o){for(c=s.child;c;){if(c===n){o=!0,n=s,r=a;break}if(c===r){o=!0,r=s,n=a;break}c=c.sibling}if(!o)throw Error(i(189))}}if(n.alternate!==r)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?e:t}(e))?We(e):null}function We(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=We(e);if(null!==t)return t;e=e.sibling}return null}var Ke=a.unstable_scheduleCallback,qe=a.unstable_cancelCallback,Ye=a.unstable_shouldYield,Qe=a.unstable_requestPaint,Xe=a.unstable_now,Je=a.unstable_getCurrentPriorityLevel,Ze=a.unstable_ImmediatePriority,et=a.unstable_UserBlockingPriority,tt=a.unstable_NormalPriority,nt=a.unstable_LowPriority,rt=a.unstable_IdlePriority,at=null,it=null;var st=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/ct|0)|0},ot=Math.log,ct=Math.LN2;var lt=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,a=e.suspendedLanes,i=e.pingedLanes,s=268435455&n;if(0!==s){var o=s&~a;0!==o?r=dt(o):0!==(i&=s)&&(r=dt(i))}else 0!==(s=n&~a)?r=dt(s):0!==i&&(r=dt(i));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&a)&&((a=r&-r)>=(i=t&-t)||16===a&&0!==(4194240&i)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)a=1<<(n=31-st(t)),r|=e[n],t&=~a;return r}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function gt(){var e=lt;return 0===(4194240&(lt<<=1))&&(lt=64),e}function mt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-st(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-st(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var bt=0;function wt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var xt,Et,Tt,St,It,kt=!1,Ct=[],_t=null,At=null,Nt=null,Rt=new Map,Ot=new Map,Dt=[],Pt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Lt(e,t){switch(e){case"focusin":case"focusout":_t=null;break;case"dragenter":case"dragleave":At=null;break;case"mouseover":case"mouseout":Nt=null;break;case"pointerover":case"pointerout":Rt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ot.delete(t.pointerId)}}function Mt(e,t,n,r,a,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},null!==t&&(null!==(t=ba(t))&&Et(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Ft(e){var t=ya(e.target);if(null!==t){var n=Ve(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=$e(n)))return e.blockedOn=t,void It(e.priority,(function(){Tt(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function zt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ba(n))&&Et(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);we=r,n.target.dispatchEvent(r),we=null,t.shift()}return!0}function jt(e,t,n){zt(e)&&n.delete(t)}function Ut(){kt=!1,null!==_t&&zt(_t)&&(_t=null),null!==At&&zt(At)&&(At=null),null!==Nt&&zt(Nt)&&(Nt=null),Rt.forEach(jt),Ot.forEach(jt)}function Bt(e,t){e.blockedOn===t&&(e.blockedOn=null,kt||(kt=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Ut)))}function Vt(e){function t(t){return Bt(t,e)}if(0<Ct.length){Bt(Ct[0],e);for(var n=1;n<Ct.length;n++){var r=Ct[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==_t&&Bt(_t,e),null!==At&&Bt(At,e),null!==Nt&&Bt(Nt,e),Rt.forEach(t),Ot.forEach(t),n=0;n<Dt.length;n++)(r=Dt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Dt.length&&null===(n=Dt[0]).blockedOn;)Ft(n),null===n.blockedOn&&Dt.shift()}var $t=w.ReactCurrentBatchConfig,Ht=!0;function Gt(e,t,n,r){var a=bt,i=$t.transition;$t.transition=null;try{bt=1,Kt(e,t,n,r)}finally{bt=a,$t.transition=i}}function Wt(e,t,n,r){var a=bt,i=$t.transition;$t.transition=null;try{bt=4,Kt(e,t,n,r)}finally{bt=a,$t.transition=i}}function Kt(e,t,n,r){if(Ht){var a=Yt(e,t,n,r);if(null===a)Hr(e,t,r,qt,n),Lt(e,r);else if(function(e,t,n,r,a){switch(t){case"focusin":return _t=Mt(_t,e,t,n,r,a),!0;case"dragenter":return At=Mt(At,e,t,n,r,a),!0;case"mouseover":return Nt=Mt(Nt,e,t,n,r,a),!0;case"pointerover":var i=a.pointerId;return Rt.set(i,Mt(Rt.get(i)||null,e,t,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,Ot.set(i,Mt(Ot.get(i)||null,e,t,n,r,a)),!0}return!1}(a,e,t,n,r))r.stopPropagation();else if(Lt(e,r),4&t&&-1<Pt.indexOf(e)){for(;null!==a;){var i=ba(a);if(null!==i&&xt(i),null===(i=Yt(e,t,n,r))&&Hr(e,t,r,qt,n),i===a)break;a=i}null!==a&&r.stopPropagation()}else Hr(e,t,r,null,n)}}var qt=null;function Yt(e,t,n,r){if(qt=null,null!==(e=ya(e=xe(r))))if(null===(t=Ve(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=$e(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return qt=e,null}function Qt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Xt=null,Jt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Jt,r=n.length,a="value"in Xt?Xt.value:Xt.textContent,i=a.length;for(e=0;e<r&&n[e]===a[e];e++);var s=r-e;for(t=1;t<=s&&n[r-t]===a[i-t];t++);return Zt=a.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function an(e){function t(t,n,r,a,i){for(var s in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(a):a[s]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return F(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var sn,on,cn,ln={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=an(ln),dn=F({},ln,{view:0,detail:0}),hn=an(dn),fn=F({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:In,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==cn&&(cn&&"mousemove"===e.type?(sn=e.screenX-cn.screenX,on=e.screenY-cn.screenY):on=sn=0,cn=e),sn)},movementY:function(e){return"movementY"in e?e.movementY:on}}),pn=an(fn),gn=an(F({},fn,{dataTransfer:0})),mn=an(F({},dn,{relatedTarget:0})),vn=an(F({},ln,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=F({},ln,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=an(yn),wn=an(F({},ln,{data:0})),xn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},En={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Tn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Tn[e])&&!!t[e]}function In(){return Sn}var kn=F({},dn,{key:function(e){if(e.key){var t=xn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?En[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:In,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Cn=an(kn),_n=an(F({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),An=an(F({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:In})),Nn=an(F({},ln,{propertyName:0,elapsedTime:0,pseudoElement:0})),Rn=F({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),On=an(Rn),Dn=[9,13,27,32],Pn=u&&"CompositionEvent"in window,Ln=null;u&&"documentMode"in document&&(Ln=document.documentMode);var Mn=u&&"TextEvent"in window&&!Ln,Fn=u&&(!Pn||Ln&&8<Ln&&11>=Ln),zn=String.fromCharCode(32),jn=!1;function Un(e,t){switch(e){case"keyup":return-1!==Dn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Vn=!1;var $n={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!$n[e.type]:"textarea"===t}function Gn(e,t,n,r){ke(r),0<(t=Wr(t,"onChange")).length&&(n=new un("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Wn=null,Kn=null;function qn(e){zr(e,0)}function Yn(e){if(K(wa(e)))return e}function Qn(e,t){if("change"===e)return t}var Xn=!1;if(u){var Jn;if(u){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}Jn=Zn}else Jn=!1;Xn=Jn&&(!document.documentMode||9<document.documentMode)}function tr(){Wn&&(Wn.detachEvent("onpropertychange",nr),Kn=Wn=null)}function nr(e){if("value"===e.propertyName&&Yn(Kn)){var t=[];Gn(t,Kn,e,xe(e)),Re(qn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Kn=n,(Wn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ar(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Yn(Kn)}function ir(e,t){if("click"===e)return Yn(t)}function sr(e,t){if("input"===e||"change"===e)return Yn(t)}var or="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function cr(e,t){if(or(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!d.call(t,a)||!or(e[a],t[a]))return!1}return!0}function lr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ur(e,t){var n,r=lr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=lr(r)}}function dr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=q();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=q((e=t.contentWindow).document)}return t}function fr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&dr(n.ownerDocument.documentElement,n)){if(null!==r&&fr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var a=n.textContent.length,i=Math.min(r.start,a);r=void 0===r.end?i:Math.min(r.end,a),!e.extend&&i>r&&(a=r,r=i,i=a),a=ur(n,i);var s=ur(n,r);a&&s&&(1!==e.rangeCount||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&((t=t.createRange()).setStart(a.node,a.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var gr=u&&"documentMode"in document&&11>=document.documentMode,mr=null,vr=null,yr=null,br=!1;function wr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==mr||mr!==q(r)||("selectionStart"in(r=mr)&&fr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&cr(yr,r)||(yr=r,0<(r=Wr(vr,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=mr)))}function xr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Er={animationend:xr("Animation","AnimationEnd"),animationiteration:xr("Animation","AnimationIteration"),animationstart:xr("Animation","AnimationStart"),transitionend:xr("Transition","TransitionEnd")},Tr={},Sr={};function Ir(e){if(Tr[e])return Tr[e];if(!Er[e])return e;var t,n=Er[e];for(t in n)if(n.hasOwnProperty(t)&&t in Sr)return Tr[e]=n[t];return e}u&&(Sr=document.createElement("div").style,"AnimationEvent"in window||(delete Er.animationend.animation,delete Er.animationiteration.animation,delete Er.animationstart.animation),"TransitionEvent"in window||delete Er.transitionend.transition);var kr=Ir("animationend"),Cr=Ir("animationiteration"),_r=Ir("animationstart"),Ar=Ir("transitionend"),Nr=new Map,Rr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Or(e,t){Nr.set(e,t),c(t,[e])}for(var Dr=0;Dr<Rr.length;Dr++){var Pr=Rr[Dr];Or(Pr.toLowerCase(),"on"+(Pr[0].toUpperCase()+Pr.slice(1)))}Or(kr,"onAnimationEnd"),Or(Cr,"onAnimationIteration"),Or(_r,"onAnimationStart"),Or("dblclick","onDoubleClick"),Or("focusin","onFocus"),Or("focusout","onBlur"),Or(Ar,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),c("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),c("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),c("onBeforeInput",["compositionend","keypress","textInput","paste"]),c("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Mr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Lr));function Fr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,a,s,o,c,l){if(Be.apply(this,arguments),Me){if(!Me)throw Error(i(198));var u=Fe;Me=!1,Fe=null,ze||(ze=!0,je=u)}}(r,t,void 0,e),e.currentTarget=null}function zr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var s=r.length-1;0<=s;s--){var o=r[s],c=o.instance,l=o.currentTarget;if(o=o.listener,c!==i&&a.isPropagationStopped())break e;Fr(a,o,l),i=c}else for(s=0;s<r.length;s++){if(c=(o=r[s]).instance,l=o.currentTarget,o=o.listener,c!==i&&a.isPropagationStopped())break e;Fr(a,o,l),i=c}}}if(ze)throw e=je,ze=!1,je=null,e}function jr(e,t){var n=t[ga];void 0===n&&(n=t[ga]=new Set);var r=e+"__bubble";n.has(r)||($r(t,e,2,!1),n.add(r))}function Ur(e,t,n){var r=0;t&&(r|=4),$r(n,e,r,t)}var Br="_reactListening"+Math.random().toString(36).slice(2);function Vr(e){if(!e[Br]){e[Br]=!0,s.forEach((function(t){"selectionchange"!==t&&(Mr.has(t)||Ur(t,!1,e),Ur(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Br]||(t[Br]=!0,Ur("selectionchange",!1,t))}}function $r(e,t,n,r){switch(Qt(t)){case 1:var a=Gt;break;case 4:a=Wt;break;default:a=Kt}n=a.bind(null,t,n,e),a=void 0,!De||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Hr(e,t,n,r,a){var i=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var s=r.tag;if(3===s||4===s){var o=r.stateNode.containerInfo;if(o===a||8===o.nodeType&&o.parentNode===a)break;if(4===s)for(s=r.return;null!==s;){var c=s.tag;if((3===c||4===c)&&((c=s.stateNode.containerInfo)===a||8===c.nodeType&&c.parentNode===a))return;s=s.return}for(;null!==o;){if(null===(s=ya(o)))return;if(5===(c=s.tag)||6===c){r=i=s;continue e}o=o.parentNode}}r=r.return}Re((function(){var r=i,a=xe(n),s=[];e:{var o=Nr.get(e);if(void 0!==o){var c=un,l=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":c=Cn;break;case"focusin":l="focus",c=mn;break;case"focusout":l="blur",c=mn;break;case"beforeblur":case"afterblur":c=mn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=gn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=An;break;case kr:case Cr:case _r:c=vn;break;case Ar:c=Nn;break;case"scroll":c=hn;break;case"wheel":c=On;break;case"copy":case"cut":case"paste":c=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=_n}var u=0!==(4&t),d=!u&&"scroll"===e,h=u?null!==o?o+"Capture":null:o;u=[];for(var f,p=r;null!==p;){var g=(f=p).stateNode;if(5===f.tag&&null!==g&&(f=g,null!==h&&(null!=(g=Oe(p,h))&&u.push(Gr(p,g,f)))),d)break;p=p.return}0<u.length&&(o=new c(o,l,null,n,a),s.push({event:o,listeners:u}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===we||!(l=n.relatedTarget||n.fromElement)||!ya(l)&&!l[pa])&&(c||o)&&(o=a.window===a?a:(o=a.ownerDocument)?o.defaultView||o.parentWindow:window,c?(c=r,null!==(l=(l=n.relatedTarget||n.toElement)?ya(l):null)&&(l!==(d=Ve(l))||5!==l.tag&&6!==l.tag)&&(l=null)):(c=null,l=r),c!==l)){if(u=pn,g="onMouseLeave",h="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=_n,g="onPointerLeave",h="onPointerEnter",p="pointer"),d=null==c?o:wa(c),f=null==l?o:wa(l),(o=new u(g,p+"leave",c,n,a)).target=d,o.relatedTarget=f,g=null,ya(a)===r&&((u=new u(h,p+"enter",l,n,a)).target=f,u.relatedTarget=d,g=u),d=g,c&&l)e:{for(h=l,p=0,f=u=c;f;f=Kr(f))p++;for(f=0,g=h;g;g=Kr(g))f++;for(;0<p-f;)u=Kr(u),p--;for(;0<f-p;)h=Kr(h),f--;for(;p--;){if(u===h||null!==h&&u===h.alternate)break e;u=Kr(u),h=Kr(h)}u=null}else u=null;null!==c&&qr(s,o,c,u,!1),null!==l&&null!==d&&qr(s,d,l,u,!0)}if("select"===(c=(o=r?wa(r):window).nodeName&&o.nodeName.toLowerCase())||"input"===c&&"file"===o.type)var m=Qn;else if(Hn(o))if(Xn)m=sr;else{m=ar;var v=rr}else(c=o.nodeName)&&"input"===c.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(m=ir);switch(m&&(m=m(e,r))?Gn(s,m,n,a):(v&&v(e,o,r),"focusout"===e&&(v=o._wrapperState)&&v.controlled&&"number"===o.type&&ee(o,"number",o.value)),v=r?wa(r):window,e){case"focusin":(Hn(v)||"true"===v.contentEditable)&&(mr=v,vr=r,yr=null);break;case"focusout":yr=vr=mr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,wr(s,n,a);break;case"selectionchange":if(gr)break;case"keydown":case"keyup":wr(s,n,a)}var y;if(Pn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Vn?Un(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Fn&&"ko"!==n.locale&&(Vn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Vn&&(y=en()):(Jt="value"in(Xt=a)?Xt.value:Xt.textContent,Vn=!0)),0<(v=Wr(r,b)).length&&(b=new wn(b,e,null,n,a),s.push({event:b,listeners:v}),y?b.data=y:null!==(y=Bn(n))&&(b.data=y))),(y=Mn?function(e,t){switch(e){case"compositionend":return Bn(t);case"keypress":return 32!==t.which?null:(jn=!0,zn);case"textInput":return(e=t.data)===zn&&jn?null:e;default:return null}}(e,n):function(e,t){if(Vn)return"compositionend"===e||!Pn&&Un(e,t)?(e=en(),Zt=Jt=Xt=null,Vn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Fn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Wr(r,"onBeforeInput")).length&&(a=new wn("onBeforeInput","beforeinput",null,n,a),s.push({event:a,listeners:r}),a.data=y))}zr(s,t)}))}function Gr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Wr(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,i=a.stateNode;5===a.tag&&null!==i&&(a=i,null!=(i=Oe(e,n))&&r.unshift(Gr(e,i,a)),null!=(i=Oe(e,t))&&r.push(Gr(e,i,a))),e=e.return}return r}function Kr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function qr(e,t,n,r,a){for(var i=t._reactName,s=[];null!==n&&n!==r;){var o=n,c=o.alternate,l=o.stateNode;if(null!==c&&c===r)break;5===o.tag&&null!==l&&(o=l,a?null!=(c=Oe(n,i))&&s.unshift(Gr(n,c,o)):a||null!=(c=Oe(n,i))&&s.push(Gr(n,c,o))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var Yr=/\r\n?/g,Qr=/\u0000|\uFFFD/g;function Xr(e){return("string"===typeof e?e:""+e).replace(Yr,"\n").replace(Qr,"")}function Jr(e,t,n){if(t=Xr(t),Xr(e)!==t&&n)throw Error(i(425))}function Zr(){}var ea=null,ta=null;function na(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ra="function"===typeof setTimeout?setTimeout:void 0,aa="function"===typeof clearTimeout?clearTimeout:void 0,ia="function"===typeof Promise?Promise:void 0,sa="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ia?function(e){return ia.resolve(null).then(e).catch(oa)}:ra;function oa(e){setTimeout((function(){throw e}))}function ca(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)){if(0===r)return e.removeChild(a),void Vt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=a}while(n);Vt(t)}function la(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ua(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var da=Math.random().toString(36).slice(2),ha="__reactFiber$"+da,fa="__reactProps$"+da,pa="__reactContainer$"+da,ga="__reactEvents$"+da,ma="__reactListeners$"+da,va="__reactHandles$"+da;function ya(e){var t=e[ha];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pa]||n[ha]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ua(e);null!==e;){if(n=e[ha])return n;e=ua(e)}return t}n=(e=n).parentNode}return null}function ba(e){return!(e=e[ha]||e[pa])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function wa(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(i(33))}function xa(e){return e[fa]||null}var Ea=[],Ta=-1;function Sa(e){return{current:e}}function Ia(e){0>Ta||(e.current=Ea[Ta],Ea[Ta]=null,Ta--)}function ka(e,t){Ta++,Ea[Ta]=e.current,e.current=t}var Ca={},_a=Sa(Ca),Aa=Sa(!1),Na=Ca;function Ra(e,t){var n=e.type.contextTypes;if(!n)return Ca;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a,i={};for(a in n)i[a]=t[a];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Oa(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Da(){Ia(Aa),Ia(_a)}function Pa(e,t,n){if(_a.current!==Ca)throw Error(i(168));ka(_a,t),ka(Aa,n)}function La(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var a in r=r.getChildContext())if(!(a in t))throw Error(i(108,$(e)||"Unknown",a));return F({},n,r)}function Ma(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ca,Na=_a.current,ka(_a,e),ka(Aa,Aa.current),!0}function Fa(e,t,n){var r=e.stateNode;if(!r)throw Error(i(169));n?(e=La(e,t,Na),r.__reactInternalMemoizedMergedChildContext=e,Ia(Aa),Ia(_a),ka(_a,e)):Ia(Aa),ka(Aa,n)}var za=null,ja=!1,Ua=!1;function Ba(e){null===za?za=[e]:za.push(e)}function Va(){if(!Ua&&null!==za){Ua=!0;var e=0,t=bt;try{var n=za;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}za=null,ja=!1}catch(a){throw null!==za&&(za=za.slice(e+1)),Ke(Ze,Va),a}finally{bt=t,Ua=!1}}return null}var $a=[],Ha=0,Ga=null,Wa=0,Ka=[],qa=0,Ya=null,Qa=1,Xa="";function Ja(e,t){$a[Ha++]=Wa,$a[Ha++]=Ga,Ga=e,Wa=t}function Za(e,t,n){Ka[qa++]=Qa,Ka[qa++]=Xa,Ka[qa++]=Ya,Ya=e;var r=Qa;e=Xa;var a=32-st(r)-1;r&=~(1<<a),n+=1;var i=32-st(t)+a;if(30<i){var s=a-a%5;i=(r&(1<<s)-1).toString(32),r>>=s,a-=s,Qa=1<<32-st(t)+a|n<<a|r,Xa=i+e}else Qa=1<<i|n<<a|r,Xa=e}function ei(e){null!==e.return&&(Ja(e,1),Za(e,1,0))}function ti(e){for(;e===Ga;)Ga=$a[--Ha],$a[Ha]=null,Wa=$a[--Ha],$a[Ha]=null;for(;e===Ya;)Ya=Ka[--qa],Ka[qa]=null,Xa=Ka[--qa],Ka[qa]=null,Qa=Ka[--qa],Ka[qa]=null}var ni=null,ri=null,ai=!1,ii=null;function si(e,t){var n=Rl(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function oi(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ni=e,ri=la(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ni=e,ri=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Ya?{id:Qa,overflow:Xa}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Rl(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ni=e,ri=null,!0);default:return!1}}function ci(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function li(e){if(ai){var t=ri;if(t){var n=t;if(!oi(e,t)){if(ci(e))throw Error(i(418));t=la(n.nextSibling);var r=ni;t&&oi(e,t)?si(r,n):(e.flags=-4097&e.flags|2,ai=!1,ni=e)}}else{if(ci(e))throw Error(i(418));e.flags=-4097&e.flags|2,ai=!1,ni=e}}}function ui(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ni=e}function di(e){if(e!==ni)return!1;if(!ai)return ui(e),ai=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!na(e.type,e.memoizedProps)),t&&(t=ri)){if(ci(e))throw hi(),Error(i(418));for(;t;)si(e,t),t=la(t.nextSibling)}if(ui(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ri=la(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ri=null}}else ri=ni?la(e.stateNode.nextSibling):null;return!0}function hi(){for(var e=ri;e;)e=la(e.nextSibling)}function fi(){ri=ni=null,ai=!1}function pi(e){null===ii?ii=[e]:ii.push(e)}var gi=w.ReactCurrentBatchConfig;function mi(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(i(309));var r=n.stateNode}if(!r)throw Error(i(147,e));var a=r,s=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===s?t.ref:(t=function(e){var t=a.refs;null===e?delete t[s]:t[s]=e},t._stringRef=s,t)}if("string"!==typeof e)throw Error(i(284));if(!n._owner)throw Error(i(290,e))}return e}function vi(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function yi(e){return(0,e._init)(e._payload)}function bi(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Dl(e,t)).index=0,e.sibling=null,e}function s(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function c(e,t,n,r){return null===t||6!==t.tag?((t=Fl(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function l(e,t,n,r){var i=n.type;return i===T?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===O&&yi(i)===t.type)?((r=a(t,n.props)).ref=mi(e,t,n),r.return=e,r):((r=Pl(n.type,n.key,n.props,null,e.mode,r)).ref=mi(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=zl(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function d(e,t,n,r,i){return null===t||7!==t.tag?((t=Ll(n,e.mode,r,i)).return=e,t):((t=a(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Fl(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case x:return(n=Pl(t.type,t.key,t.props,null,e.mode,n)).ref=mi(e,null,t),n.return=e,n;case E:return(t=zl(t,e.mode,n)).return=e,t;case O:return h(e,(0,t._init)(t._payload),n)}if(te(t)||L(t))return(t=Ll(t,e.mode,n,null)).return=e,t;vi(e,t)}return null}function f(e,t,n,r){var a=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==a?null:c(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case x:return n.key===a?l(e,t,n,r):null;case E:return n.key===a?u(e,t,n,r):null;case O:return f(e,t,(a=n._init)(n._payload),r)}if(te(n)||L(n))return null!==a?null:d(e,t,n,r,null);vi(e,n)}return null}function p(e,t,n,r,a){if("string"===typeof r&&""!==r||"number"===typeof r)return c(t,e=e.get(n)||null,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case x:return l(t,e=e.get(null===r.key?n:r.key)||null,r,a);case E:return u(t,e=e.get(null===r.key?n:r.key)||null,r,a);case O:return p(e,t,n,(0,r._init)(r._payload),a)}if(te(r)||L(r))return d(t,e=e.get(n)||null,r,a,null);vi(t,r)}return null}function g(a,i,o,c){for(var l=null,u=null,d=i,g=i=0,m=null;null!==d&&g<o.length;g++){d.index>g?(m=d,d=null):m=d.sibling;var v=f(a,d,o[g],c);if(null===v){null===d&&(d=m);break}e&&d&&null===v.alternate&&t(a,d),i=s(v,i,g),null===u?l=v:u.sibling=v,u=v,d=m}if(g===o.length)return n(a,d),ai&&Ja(a,g),l;if(null===d){for(;g<o.length;g++)null!==(d=h(a,o[g],c))&&(i=s(d,i,g),null===u?l=d:u.sibling=d,u=d);return ai&&Ja(a,g),l}for(d=r(a,d);g<o.length;g++)null!==(m=p(d,a,g,o[g],c))&&(e&&null!==m.alternate&&d.delete(null===m.key?g:m.key),i=s(m,i,g),null===u?l=m:u.sibling=m,u=m);return e&&d.forEach((function(e){return t(a,e)})),ai&&Ja(a,g),l}function m(a,o,c,l){var u=L(c);if("function"!==typeof u)throw Error(i(150));if(null==(c=u.call(c)))throw Error(i(151));for(var d=u=null,g=o,m=o=0,v=null,y=c.next();null!==g&&!y.done;m++,y=c.next()){g.index>m?(v=g,g=null):v=g.sibling;var b=f(a,g,y.value,l);if(null===b){null===g&&(g=v);break}e&&g&&null===b.alternate&&t(a,g),o=s(b,o,m),null===d?u=b:d.sibling=b,d=b,g=v}if(y.done)return n(a,g),ai&&Ja(a,m),u;if(null===g){for(;!y.done;m++,y=c.next())null!==(y=h(a,y.value,l))&&(o=s(y,o,m),null===d?u=y:d.sibling=y,d=y);return ai&&Ja(a,m),u}for(g=r(a,g);!y.done;m++,y=c.next())null!==(y=p(g,a,m,y.value,l))&&(e&&null!==y.alternate&&g.delete(null===y.key?m:y.key),o=s(y,o,m),null===d?u=y:d.sibling=y,d=y);return e&&g.forEach((function(e){return t(a,e)})),ai&&Ja(a,m),u}return function e(r,i,s,c){if("object"===typeof s&&null!==s&&s.type===T&&null===s.key&&(s=s.props.children),"object"===typeof s&&null!==s){switch(s.$$typeof){case x:e:{for(var l=s.key,u=i;null!==u;){if(u.key===l){if((l=s.type)===T){if(7===u.tag){n(r,u.sibling),(i=a(u,s.props.children)).return=r,r=i;break e}}else if(u.elementType===l||"object"===typeof l&&null!==l&&l.$$typeof===O&&yi(l)===u.type){n(r,u.sibling),(i=a(u,s.props)).ref=mi(r,u,s),i.return=r,r=i;break e}n(r,u);break}t(r,u),u=u.sibling}s.type===T?((i=Ll(s.props.children,r.mode,c,s.key)).return=r,r=i):((c=Pl(s.type,s.key,s.props,null,r.mode,c)).ref=mi(r,i,s),c.return=r,r=c)}return o(r);case E:e:{for(u=s.key;null!==i;){if(i.key===u){if(4===i.tag&&i.stateNode.containerInfo===s.containerInfo&&i.stateNode.implementation===s.implementation){n(r,i.sibling),(i=a(i,s.children||[])).return=r,r=i;break e}n(r,i);break}t(r,i),i=i.sibling}(i=zl(s,r.mode,c)).return=r,r=i}return o(r);case O:return e(r,i,(u=s._init)(s._payload),c)}if(te(s))return g(r,i,s,c);if(L(s))return m(r,i,s,c);vi(r,s)}return"string"===typeof s&&""!==s||"number"===typeof s?(s=""+s,null!==i&&6===i.tag?(n(r,i.sibling),(i=a(i,s)).return=r,r=i):(n(r,i),(i=Fl(s,r.mode,c)).return=r,r=i),o(r)):n(r,i)}}var wi=bi(!0),xi=bi(!1),Ei=Sa(null),Ti=null,Si=null,Ii=null;function ki(){Ii=Si=Ti=null}function Ci(e){var t=Ei.current;Ia(Ei),e._currentValue=t}function _i(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ai(e,t){Ti=e,Ii=Si=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(bo=!0),e.firstContext=null)}function Ni(e){var t=e._currentValue;if(Ii!==e)if(e={context:e,memoizedValue:t,next:null},null===Si){if(null===Ti)throw Error(i(308));Si=e,Ti.dependencies={lanes:0,firstContext:e}}else Si=Si.next=e;return t}var Ri=null;function Oi(e){null===Ri?Ri=[e]:Ri.push(e)}function Di(e,t,n,r){var a=t.interleaved;return null===a?(n.next=n,Oi(t)):(n.next=a.next,a.next=n),t.interleaved=n,Pi(e,r)}function Pi(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Li=!1;function Mi(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Fi(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function zi(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ji(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&_c)){var a=r.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),r.pending=t,Pi(e,n)}return null===(a=r.interleaved)?(t.next=t,Oi(r)):(t.next=a.next,a.next=t),r.interleaved=t,Pi(e,n)}function Ui(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Bi(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?a=i=s:i=i.next=s,n=n.next}while(null!==n);null===i?a=i=t:i=i.next=t}else a=i=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Vi(e,t,n,r){var a=e.updateQueue;Li=!1;var i=a.firstBaseUpdate,s=a.lastBaseUpdate,o=a.shared.pending;if(null!==o){a.shared.pending=null;var c=o,l=c.next;c.next=null,null===s?i=l:s.next=l,s=c;var u=e.alternate;null!==u&&((o=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===o?u.firstBaseUpdate=l:o.next=l,u.lastBaseUpdate=c))}if(null!==i){var d=a.baseState;for(s=0,u=l=c=null,o=i;;){var h=o.lane,f=o.eventTime;if((r&h)===h){null!==u&&(u=u.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var p=e,g=o;switch(h=t,f=n,g.tag){case 1:if("function"===typeof(p=g.payload)){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(h="function"===typeof(p=g.payload)?p.call(f,d,h):p)||void 0===h)break e;d=F({},d,h);break e;case 2:Li=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(h=a.effects)?a.effects=[o]:h.push(o))}else f={eventTime:f,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===u?(l=u=f,c=d):u=u.next=f,s|=h;if(null===(o=o.next)){if(null===(o=a.shared.pending))break;o=(h=o).next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}if(null===u&&(c=d),a.baseState=c,a.firstBaseUpdate=l,a.lastBaseUpdate=u,null!==(t=a.shared.interleaved)){a=t;do{s|=a.lane,a=a.next}while(a!==t)}else null===i&&(a.shared.lanes=0);Mc|=s,e.lanes=s,e.memoizedState=d}}function $i(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(null!==a){if(r.callback=null,r=n,"function"!==typeof a)throw Error(i(191,a));a.call(r)}}}var Hi={},Gi=Sa(Hi),Wi=Sa(Hi),Ki=Sa(Hi);function qi(e){if(e===Hi)throw Error(i(174));return e}function Yi(e,t){switch(ka(Ki,t),ka(Wi,e),ka(Gi,Hi),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ce(null,"");break;default:t=ce(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ia(Gi),ka(Gi,t)}function Qi(){Ia(Gi),Ia(Wi),Ia(Ki)}function Xi(e){qi(Ki.current);var t=qi(Gi.current),n=ce(t,e.type);t!==n&&(ka(Wi,e),ka(Gi,n))}function Ji(e){Wi.current===e&&(Ia(Gi),Ia(Wi))}var Zi=Sa(0);function es(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ts=[];function ns(){for(var e=0;e<ts.length;e++)ts[e]._workInProgressVersionPrimary=null;ts.length=0}var rs=w.ReactCurrentDispatcher,as=w.ReactCurrentBatchConfig,is=0,ss=null,os=null,cs=null,ls=!1,us=!1,ds=0,hs=0;function fs(){throw Error(i(321))}function ps(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!or(e[n],t[n]))return!1;return!0}function gs(e,t,n,r,a,s){if(is=s,ss=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,rs.current=null===e||null===e.memoizedState?Js:Zs,e=n(r,a),us){s=0;do{if(us=!1,ds=0,25<=s)throw Error(i(301));s+=1,cs=os=null,t.updateQueue=null,rs.current=eo,e=n(r,a)}while(us)}if(rs.current=Xs,t=null!==os&&null!==os.next,is=0,cs=os=ss=null,ls=!1,t)throw Error(i(300));return e}function ms(){var e=0!==ds;return ds=0,e}function vs(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===cs?ss.memoizedState=cs=e:cs=cs.next=e,cs}function ys(){if(null===os){var e=ss.alternate;e=null!==e?e.memoizedState:null}else e=os.next;var t=null===cs?ss.memoizedState:cs.next;if(null!==t)cs=t,os=e;else{if(null===e)throw Error(i(310));e={memoizedState:(os=e).memoizedState,baseState:os.baseState,baseQueue:os.baseQueue,queue:os.queue,next:null},null===cs?ss.memoizedState=cs=e:cs=cs.next=e}return cs}function bs(e,t){return"function"===typeof t?t(e):t}function ws(e){var t=ys(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=os,a=r.baseQueue,s=n.pending;if(null!==s){if(null!==a){var o=a.next;a.next=s.next,s.next=o}r.baseQueue=a=s,n.pending=null}if(null!==a){s=a.next,r=r.baseState;var c=o=null,l=null,u=s;do{var d=u.lane;if((is&d)===d)null!==l&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===l?(c=l=h,o=r):l=l.next=h,ss.lanes|=d,Mc|=d}u=u.next}while(null!==u&&u!==s);null===l?o=r:l.next=c,or(r,t.memoizedState)||(bo=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=l,n.lastRenderedState=r}if(null!==(e=n.interleaved)){a=e;do{s=a.lane,ss.lanes|=s,Mc|=s,a=a.next}while(a!==e)}else null===a&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function xs(e){var t=ys(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,s=t.memoizedState;if(null!==a){n.pending=null;var o=a=a.next;do{s=e(s,o.action),o=o.next}while(o!==a);or(s,t.memoizedState)||(bo=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function Es(){}function Ts(e,t){var n=ss,r=ys(),a=t(),s=!or(r.memoizedState,a);if(s&&(r.memoizedState=a,bo=!0),r=r.queue,Ls(ks.bind(null,n,r,e),[e]),r.getSnapshot!==t||s||null!==cs&&1&cs.memoizedState.tag){if(n.flags|=2048,Ns(9,Is.bind(null,n,r,a,t),void 0,null),null===Ac)throw Error(i(349));0!==(30&is)||Ss(n,t,a)}return a}function Ss(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=ss.updateQueue)?(t={lastEffect:null,stores:null},ss.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Is(e,t,n,r){t.value=n,t.getSnapshot=r,Cs(t)&&_s(e)}function ks(e,t,n){return n((function(){Cs(t)&&_s(e)}))}function Cs(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!or(e,n)}catch(r){return!0}}function _s(e){var t=Pi(e,1);null!==t&&nl(t,e,1,-1)}function As(e){var t=vs();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bs,lastRenderedState:e},t.queue=e,e=e.dispatch=Ks.bind(null,ss,e),[t.memoizedState,e]}function Ns(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=ss.updateQueue)?(t={lastEffect:null,stores:null},ss.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Rs(){return ys().memoizedState}function Os(e,t,n,r){var a=vs();ss.flags|=e,a.memoizedState=Ns(1|t,n,void 0,void 0===r?null:r)}function Ds(e,t,n,r){var a=ys();r=void 0===r?null:r;var i=void 0;if(null!==os){var s=os.memoizedState;if(i=s.destroy,null!==r&&ps(r,s.deps))return void(a.memoizedState=Ns(t,n,i,r))}ss.flags|=e,a.memoizedState=Ns(1|t,n,i,r)}function Ps(e,t){return Os(8390656,8,e,t)}function Ls(e,t){return Ds(2048,8,e,t)}function Ms(e,t){return Ds(4,2,e,t)}function Fs(e,t){return Ds(4,4,e,t)}function zs(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function js(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ds(4,4,zs.bind(null,t,e),n)}function Us(){}function Bs(e,t){var n=ys();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ps(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Vs(e,t){var n=ys();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ps(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function $s(e,t,n){return 0===(21&is)?(e.baseState&&(e.baseState=!1,bo=!0),e.memoizedState=n):(or(n,t)||(n=gt(),ss.lanes|=n,Mc|=n,e.baseState=!0),t)}function Hs(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=as.transition;as.transition={};try{e(!1),t()}finally{bt=n,as.transition=r}}function Gs(){return ys().memoizedState}function Ws(e,t,n){var r=tl(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},qs(e))Ys(t,n);else if(null!==(n=Di(e,t,n,r))){nl(n,e,r,el()),Qs(n,t,r)}}function Ks(e,t,n){var r=tl(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(qs(e))Ys(t,a);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var s=t.lastRenderedState,o=i(s,n);if(a.hasEagerState=!0,a.eagerState=o,or(o,s)){var c=t.interleaved;return null===c?(a.next=a,Oi(t)):(a.next=c.next,c.next=a),void(t.interleaved=a)}}catch(l){}null!==(n=Di(e,t,a,r))&&(nl(n,e,r,a=el()),Qs(n,t,r))}}function qs(e){var t=e.alternate;return e===ss||null!==t&&t===ss}function Ys(e,t){us=ls=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Qs(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var Xs={readContext:Ni,useCallback:fs,useContext:fs,useEffect:fs,useImperativeHandle:fs,useInsertionEffect:fs,useLayoutEffect:fs,useMemo:fs,useReducer:fs,useRef:fs,useState:fs,useDebugValue:fs,useDeferredValue:fs,useTransition:fs,useMutableSource:fs,useSyncExternalStore:fs,useId:fs,unstable_isNewReconciler:!1},Js={readContext:Ni,useCallback:function(e,t){return vs().memoizedState=[e,void 0===t?null:t],e},useContext:Ni,useEffect:Ps,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Os(4194308,4,zs.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Os(4194308,4,e,t)},useInsertionEffect:function(e,t){return Os(4,2,e,t)},useMemo:function(e,t){var n=vs();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=vs();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Ws.bind(null,ss,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},vs().memoizedState=e},useState:As,useDebugValue:Us,useDeferredValue:function(e){return vs().memoizedState=e},useTransition:function(){var e=As(!1),t=e[0];return e=Hs.bind(null,e[1]),vs().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=ss,a=vs();if(ai){if(void 0===n)throw Error(i(407));n=n()}else{if(n=t(),null===Ac)throw Error(i(349));0!==(30&is)||Ss(r,t,n)}a.memoizedState=n;var s={value:n,getSnapshot:t};return a.queue=s,Ps(ks.bind(null,r,s,e),[e]),r.flags|=2048,Ns(9,Is.bind(null,r,s,n,t),void 0,null),n},useId:function(){var e=vs(),t=Ac.identifierPrefix;if(ai){var n=Xa;t=":"+t+"R"+(n=(Qa&~(1<<32-st(Qa)-1)).toString(32)+n),0<(n=ds++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=hs++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Zs={readContext:Ni,useCallback:Bs,useContext:Ni,useEffect:Ls,useImperativeHandle:js,useInsertionEffect:Ms,useLayoutEffect:Fs,useMemo:Vs,useReducer:ws,useRef:Rs,useState:function(){return ws(bs)},useDebugValue:Us,useDeferredValue:function(e){return $s(ys(),os.memoizedState,e)},useTransition:function(){return[ws(bs)[0],ys().memoizedState]},useMutableSource:Es,useSyncExternalStore:Ts,useId:Gs,unstable_isNewReconciler:!1},eo={readContext:Ni,useCallback:Bs,useContext:Ni,useEffect:Ls,useImperativeHandle:js,useInsertionEffect:Ms,useLayoutEffect:Fs,useMemo:Vs,useReducer:xs,useRef:Rs,useState:function(){return xs(bs)},useDebugValue:Us,useDeferredValue:function(e){var t=ys();return null===os?t.memoizedState=e:$s(t,os.memoizedState,e)},useTransition:function(){return[xs(bs)[0],ys().memoizedState]},useMutableSource:Es,useSyncExternalStore:Ts,useId:Gs,unstable_isNewReconciler:!1};function to(e,t){if(e&&e.defaultProps){for(var n in t=F({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function no(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:F({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var ro={isMounted:function(e){return!!(e=e._reactInternals)&&Ve(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=el(),a=tl(e),i=zi(r,a);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=ji(e,i,a))&&(nl(t,e,a,r),Ui(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=el(),a=tl(e),i=zi(r,a);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=ji(e,i,a))&&(nl(t,e,a,r),Ui(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=el(),r=tl(e),a=zi(n,r);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),null!==(t=ji(e,a,r))&&(nl(t,e,r,n),Ui(t,e,r))}};function ao(e,t,n,r,a,i,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,s):!t.prototype||!t.prototype.isPureReactComponent||(!cr(n,r)||!cr(a,i))}function io(e,t,n){var r=!1,a=Ca,i=t.contextType;return"object"===typeof i&&null!==i?i=Ni(i):(a=Oa(t)?Na:_a.current,i=(r=null!==(r=t.contextTypes)&&void 0!==r)?Ra(e,a):Ca),t=new t(n,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ro,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function so(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ro.enqueueReplaceState(t,t.state,null)}function oo(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs={},Mi(e);var i=t.contextType;"object"===typeof i&&null!==i?a.context=Ni(i):(i=Oa(t)?Na:_a.current,a.context=Ra(e,i)),a.state=e.memoizedState,"function"===typeof(i=t.getDerivedStateFromProps)&&(no(e,t,i,n),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&ro.enqueueReplaceState(a,a.state,null),Vi(e,n,a,r),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4194308)}function co(e,t){try{var n="",r=t;do{n+=B(r),r=r.return}while(r);var a=n}catch(i){a="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:a,digest:null}}function lo(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function uo(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var ho="function"===typeof WeakMap?WeakMap:Map;function fo(e,t,n){(n=zi(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Hc||(Hc=!0,Gc=r),uo(0,t)},n}function po(e,t,n){(n=zi(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){uo(0,t)}}var i=e.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(n.callback=function(){uo(0,t),"function"!==typeof r&&(null===Wc?Wc=new Set([this]):Wc.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function go(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new ho;var a=new Set;r.set(t,a)}else void 0===(a=r.get(t))&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=Il.bind(null,e,t,n),t.then(e,e))}function mo(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function vo(e,t,n,r,a){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=zi(-1,1)).tag=2,ji(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=a,e)}var yo=w.ReactCurrentOwner,bo=!1;function wo(e,t,n,r){t.child=null===e?xi(t,null,n,r):wi(t,e.child,n,r)}function xo(e,t,n,r,a){n=n.render;var i=t.ref;return Ai(t,a),r=gs(e,t,n,r,i,a),n=ms(),null===e||bo?(ai&&n&&ei(t),t.flags|=1,wo(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Ho(e,t,a))}function Eo(e,t,n,r,a){if(null===e){var i=n.type;return"function"!==typeof i||Ol(i)||void 0!==i.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Pl(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,To(e,t,i,r,a))}if(i=e.child,0===(e.lanes&a)){var s=i.memoizedProps;if((n=null!==(n=n.compare)?n:cr)(s,r)&&e.ref===t.ref)return Ho(e,t,a)}return t.flags|=1,(e=Dl(i,r)).ref=t.ref,e.return=t,t.child=e}function To(e,t,n,r,a){if(null!==e){var i=e.memoizedProps;if(cr(i,r)&&e.ref===t.ref){if(bo=!1,t.pendingProps=r=i,0===(e.lanes&a))return t.lanes=e.lanes,Ho(e,t,a);0!==(131072&e.flags)&&(bo=!0)}}return ko(e,t,n,r,a)}function So(e,t,n){var r=t.pendingProps,a=r.children,i=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ka(Dc,Oc),Oc|=n;else{if(0===(1073741824&n))return e=null!==i?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ka(Dc,Oc),Oc|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==i?i.baseLanes:n,ka(Dc,Oc),Oc|=r}else null!==i?(r=i.baseLanes|n,t.memoizedState=null):r=n,ka(Dc,Oc),Oc|=r;return wo(e,t,a,n),t.child}function Io(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function ko(e,t,n,r,a){var i=Oa(n)?Na:_a.current;return i=Ra(t,i),Ai(t,a),n=gs(e,t,n,r,i,a),r=ms(),null===e||bo?(ai&&r&&ei(t),t.flags|=1,wo(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Ho(e,t,a))}function Co(e,t,n,r,a){if(Oa(n)){var i=!0;Ma(t)}else i=!1;if(Ai(t,a),null===t.stateNode)$o(e,t),io(t,n,r),oo(t,n,r,a),r=!0;else if(null===e){var s=t.stateNode,o=t.memoizedProps;s.props=o;var c=s.context,l=n.contextType;"object"===typeof l&&null!==l?l=Ni(l):l=Ra(t,l=Oa(n)?Na:_a.current);var u=n.getDerivedStateFromProps,d="function"===typeof u||"function"===typeof s.getSnapshotBeforeUpdate;d||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o!==r||c!==l)&&so(t,s,r,l),Li=!1;var h=t.memoizedState;s.state=h,Vi(t,r,s,a),c=t.memoizedState,o!==r||h!==c||Aa.current||Li?("function"===typeof u&&(no(t,n,u,r),c=t.memoizedState),(o=Li||ao(t,n,o,r,h,c,l))?(d||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),s.props=r,s.state=c,s.context=l,r=o):("function"===typeof s.componentDidMount&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,Fi(e,t),o=t.memoizedProps,l=t.type===t.elementType?o:to(t.type,o),s.props=l,d=t.pendingProps,h=s.context,"object"===typeof(c=n.contextType)&&null!==c?c=Ni(c):c=Ra(t,c=Oa(n)?Na:_a.current);var f=n.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o!==d||h!==c)&&so(t,s,r,c),Li=!1,h=t.memoizedState,s.state=h,Vi(t,r,s,a);var p=t.memoizedState;o!==d||h!==p||Aa.current||Li?("function"===typeof f&&(no(t,n,f,r),p=t.memoizedState),(l=Li||ao(t,n,l,r,h,p,c)||!1)?(u||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(r,p,c),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,p,c)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),s.props=r,s.state=p,s.context=c,r=l):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return _o(e,t,n,r,i,a)}function _o(e,t,n,r,a,i){Io(e,t);var s=0!==(128&t.flags);if(!r&&!s)return a&&Fa(t,n,!1),Ho(e,t,i);r=t.stateNode,yo.current=t;var o=s&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&s?(t.child=wi(t,e.child,null,i),t.child=wi(t,null,o,i)):wo(e,t,o,i),t.memoizedState=r.state,a&&Fa(t,n,!0),t.child}function Ao(e){var t=e.stateNode;t.pendingContext?Pa(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Pa(0,t.context,!1),Yi(e,t.containerInfo)}function No(e,t,n,r,a){return fi(),pi(a),t.flags|=256,wo(e,t,n,r),t.child}var Ro,Oo,Do,Po,Lo={dehydrated:null,treeContext:null,retryLane:0};function Mo(e){return{baseLanes:e,cachePool:null,transitions:null}}function Fo(e,t,n){var r,a=t.pendingProps,s=Zi.current,o=!1,c=0!==(128&t.flags);if((r=c)||(r=(null===e||null!==e.memoizedState)&&0!==(2&s)),r?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),ka(Zi,1&s),null===e)return li(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(c=a.children,e=a.fallback,o?(a=t.mode,o=t.child,c={mode:"hidden",children:c},0===(1&a)&&null!==o?(o.childLanes=0,o.pendingProps=c):o=Ml(c,a,0,null),e=Ll(e,a,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Mo(n),t.memoizedState=Lo,e):zo(t,c));if(null!==(s=e.memoizedState)&&null!==(r=s.dehydrated))return function(e,t,n,r,a,s,o){if(n)return 256&t.flags?(t.flags&=-257,jo(e,t,o,r=lo(Error(i(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(s=r.fallback,a=t.mode,r=Ml({mode:"visible",children:r.children},a,0,null),(s=Ll(s,a,o,null)).flags|=2,r.return=t,s.return=t,r.sibling=s,t.child=r,0!==(1&t.mode)&&wi(t,e.child,null,o),t.child.memoizedState=Mo(o),t.memoizedState=Lo,s);if(0===(1&t.mode))return jo(e,t,o,null);if("$!"===a.data){if(r=a.nextSibling&&a.nextSibling.dataset)var c=r.dgst;return r=c,jo(e,t,o,r=lo(s=Error(i(419)),r,void 0))}if(c=0!==(o&e.childLanes),bo||c){if(null!==(r=Ac)){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(a=0!==(a&(r.suspendedLanes|o))?0:a)&&a!==s.retryLane&&(s.retryLane=a,Pi(e,a),nl(r,e,a,-1))}return gl(),jo(e,t,o,r=lo(Error(i(421))))}return"$?"===a.data?(t.flags|=128,t.child=e.child,t=Cl.bind(null,e),a._reactRetry=t,null):(e=s.treeContext,ri=la(a.nextSibling),ni=t,ai=!0,ii=null,null!==e&&(Ka[qa++]=Qa,Ka[qa++]=Xa,Ka[qa++]=Ya,Qa=e.id,Xa=e.overflow,Ya=t),t=zo(t,r.children),t.flags|=4096,t)}(e,t,c,a,r,s,n);if(o){o=a.fallback,c=t.mode,r=(s=e.child).sibling;var l={mode:"hidden",children:a.children};return 0===(1&c)&&t.child!==s?((a=t.child).childLanes=0,a.pendingProps=l,t.deletions=null):(a=Dl(s,l)).subtreeFlags=14680064&s.subtreeFlags,null!==r?o=Dl(r,o):(o=Ll(o,c,n,null)).flags|=2,o.return=t,a.return=t,a.sibling=o,t.child=a,a=o,o=t.child,c=null===(c=e.child.memoizedState)?Mo(n):{baseLanes:c.baseLanes|n,cachePool:null,transitions:c.transitions},o.memoizedState=c,o.childLanes=e.childLanes&~n,t.memoizedState=Lo,a}return e=(o=e.child).sibling,a=Dl(o,{mode:"visible",children:a.children}),0===(1&t.mode)&&(a.lanes=n),a.return=t,a.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=a,t.memoizedState=null,a}function zo(e,t){return(t=Ml({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function jo(e,t,n,r){return null!==r&&pi(r),wi(t,e.child,null,n),(e=zo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Uo(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),_i(e.return,t,n)}function Bo(e,t,n,r,a){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function Vo(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;if(wo(e,t,r.children,n),0!==(2&(r=Zi.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Uo(e,n,t);else if(19===e.tag)Uo(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(ka(Zi,r),0===(1&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===es(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),Bo(t,!1,a,n,i);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===es(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}Bo(t,!0,n,null,i);break;case"together":Bo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function $o(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ho(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Mc|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(n=Dl(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Dl(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Go(e,t){if(!ai)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Wo(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=14680064&a.subtreeFlags,r|=14680064&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Ko(e,t,n){var r=t.pendingProps;switch(ti(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Wo(t),null;case 1:case 17:return Oa(t.type)&&Da(),Wo(t),null;case 3:return r=t.stateNode,Qi(),Ia(Aa),Ia(_a),ns(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(di(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ii&&(sl(ii),ii=null))),Oo(e,t),Wo(t),null;case 5:Ji(t);var a=qi(Ki.current);if(n=t.type,null!==e&&null!=t.stateNode)Do(e,t,n,r,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(i(166));return Wo(t),null}if(e=qi(Gi.current),di(t)){r=t.stateNode,n=t.type;var s=t.memoizedProps;switch(r[ha]=t,r[fa]=s,e=0!==(1&t.mode),n){case"dialog":jr("cancel",r),jr("close",r);break;case"iframe":case"object":case"embed":jr("load",r);break;case"video":case"audio":for(a=0;a<Lr.length;a++)jr(Lr[a],r);break;case"source":jr("error",r);break;case"img":case"image":case"link":jr("error",r),jr("load",r);break;case"details":jr("toggle",r);break;case"input":Q(r,s),jr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},jr("invalid",r);break;case"textarea":ae(r,s),jr("invalid",r)}for(var c in ye(n,s),a=null,s)if(s.hasOwnProperty(c)){var l=s[c];"children"===c?"string"===typeof l?r.textContent!==l&&(!0!==s.suppressHydrationWarning&&Jr(r.textContent,l,e),a=["children",l]):"number"===typeof l&&r.textContent!==""+l&&(!0!==s.suppressHydrationWarning&&Jr(r.textContent,l,e),a=["children",""+l]):o.hasOwnProperty(c)&&null!=l&&"onScroll"===c&&jr("scroll",r)}switch(n){case"input":W(r),Z(r,s,!0);break;case"textarea":W(r),se(r);break;case"select":case"option":break;default:"function"===typeof s.onClick&&(r.onclick=Zr)}r=a,t.updateQueue=r,null!==r&&(t.flags|=4)}else{c=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=c.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=c.createElement(n,{is:r.is}):(e=c.createElement(n),"select"===n&&(c=e,r.multiple?c.multiple=!0:r.size&&(c.size=r.size))):e=c.createElementNS(e,n),e[ha]=t,e[fa]=r,Ro(e,t,!1,!1),t.stateNode=e;e:{switch(c=be(n,r),n){case"dialog":jr("cancel",e),jr("close",e),a=r;break;case"iframe":case"object":case"embed":jr("load",e),a=r;break;case"video":case"audio":for(a=0;a<Lr.length;a++)jr(Lr[a],e);a=r;break;case"source":jr("error",e),a=r;break;case"img":case"image":case"link":jr("error",e),jr("load",e),a=r;break;case"details":jr("toggle",e),a=r;break;case"input":Q(e,r),a=Y(e,r),jr("invalid",e);break;case"option":default:a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=F({},r,{value:void 0}),jr("invalid",e);break;case"textarea":ae(e,r),a=re(e,r),jr("invalid",e)}for(s in ye(n,a),l=a)if(l.hasOwnProperty(s)){var u=l[s];"style"===s?me(e,u):"dangerouslySetInnerHTML"===s?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===s?"string"===typeof u?("textarea"!==n||""!==u)&&he(e,u):"number"===typeof u&&he(e,""+u):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(o.hasOwnProperty(s)?null!=u&&"onScroll"===s&&jr("scroll",e):null!=u&&b(e,s,u,c))}switch(n){case"input":W(e),Z(e,r,!1);break;case"textarea":W(e),se(e);break;case"option":null!=r.value&&e.setAttribute("value",""+H(r.value));break;case"select":e.multiple=!!r.multiple,null!=(s=r.value)?ne(e,!!r.multiple,s,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Wo(t),null;case 6:if(e&&null!=t.stateNode)Po(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(i(166));if(n=qi(Ki.current),qi(Gi.current),di(t)){if(r=t.stateNode,n=t.memoizedProps,r[ha]=t,(s=r.nodeValue!==n)&&null!==(e=ni))switch(e.tag){case 3:Jr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Jr(r.nodeValue,n,0!==(1&e.mode))}s&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[ha]=t,t.stateNode=r}return Wo(t),null;case 13:if(Ia(Zi),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ai&&null!==ri&&0!==(1&t.mode)&&0===(128&t.flags))hi(),fi(),t.flags|=98560,s=!1;else if(s=di(t),null!==r&&null!==r.dehydrated){if(null===e){if(!s)throw Error(i(318));if(!(s=null!==(s=t.memoizedState)?s.dehydrated:null))throw Error(i(317));s[ha]=t}else fi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Wo(t),s=!1}else null!==ii&&(sl(ii),ii=null),s=!0;if(!s)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Zi.current)?0===Pc&&(Pc=3):gl())),null!==t.updateQueue&&(t.flags|=4),Wo(t),null);case 4:return Qi(),Oo(e,t),null===e&&Vr(t.stateNode.containerInfo),Wo(t),null;case 10:return Ci(t.type._context),Wo(t),null;case 19:if(Ia(Zi),null===(s=t.memoizedState))return Wo(t),null;if(r=0!==(128&t.flags),null===(c=s.rendering))if(r)Go(s,!1);else{if(0!==Pc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(c=es(e))){for(t.flags|=128,Go(s,!1),null!==(r=c.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(s=n).flags&=14680066,null===(c=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=c.childLanes,s.lanes=c.lanes,s.child=c.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=c.memoizedProps,s.memoizedState=c.memoizedState,s.updateQueue=c.updateQueue,s.type=c.type,e=c.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return ka(Zi,1&Zi.current|2),t.child}e=e.sibling}null!==s.tail&&Xe()>Vc&&(t.flags|=128,r=!0,Go(s,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=es(c))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Go(s,!0),null===s.tail&&"hidden"===s.tailMode&&!c.alternate&&!ai)return Wo(t),null}else 2*Xe()-s.renderingStartTime>Vc&&1073741824!==n&&(t.flags|=128,r=!0,Go(s,!1),t.lanes=4194304);s.isBackwards?(c.sibling=t.child,t.child=c):(null!==(n=s.last)?n.sibling=c:t.child=c,s.last=c)}return null!==s.tail?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Xe(),t.sibling=null,n=Zi.current,ka(Zi,r?1&n|2:1&n),t):(Wo(t),null);case 22:case 23:return dl(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Oc)&&(Wo(t),6&t.subtreeFlags&&(t.flags|=8192)):Wo(t),null;case 24:case 25:return null}throw Error(i(156,t.tag))}function qo(e,t){switch(ti(t),t.tag){case 1:return Oa(t.type)&&Da(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Qi(),Ia(Aa),Ia(_a),ns(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Ji(t),null;case 13:if(Ia(Zi),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));fi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ia(Zi),null;case 4:return Qi(),null;case 10:return Ci(t.type._context),null;case 22:case 23:return dl(),null;default:return null}}Ro=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Oo=function(){},Do=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,qi(Gi.current);var i,s=null;switch(n){case"input":a=Y(e,a),r=Y(e,r),s=[];break;case"select":a=F({},a,{value:void 0}),r=F({},r,{value:void 0}),s=[];break;case"textarea":a=re(e,a),r=re(e,r),s=[];break;default:"function"!==typeof a.onClick&&"function"===typeof r.onClick&&(e.onclick=Zr)}for(u in ye(n,r),n=null,a)if(!r.hasOwnProperty(u)&&a.hasOwnProperty(u)&&null!=a[u])if("style"===u){var c=a[u];for(i in c)c.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(o.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(c=null!=a?a[u]:void 0,r.hasOwnProperty(u)&&l!==c&&(null!=l||null!=c))if("style"===u)if(c){for(i in c)!c.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in l)l.hasOwnProperty(i)&&c[i]!==l[i]&&(n||(n={}),n[i]=l[i])}else n||(s||(s=[]),s.push(u,n)),n=l;else"dangerouslySetInnerHTML"===u?(l=l?l.__html:void 0,c=c?c.__html:void 0,null!=l&&c!==l&&(s=s||[]).push(u,l)):"children"===u?"string"!==typeof l&&"number"!==typeof l||(s=s||[]).push(u,""+l):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(o.hasOwnProperty(u)?(null!=l&&"onScroll"===u&&jr("scroll",e),s||c===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(t.updateQueue=u)&&(t.flags|=4)}},Po=function(e,t,n,r){n!==r&&(t.flags|=4)};var Yo=!1,Qo=!1,Xo="function"===typeof WeakSet?WeakSet:Set,Jo=null;function Zo(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Sl(e,t,r)}else n.current=null}function ec(e,t,n){try{n()}catch(r){Sl(e,t,r)}}var tc=!1;function nc(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var a=r=r.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,void 0!==i&&ec(t,n,i)}a=a.next}while(a!==r)}}function rc(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function ac(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function ic(e){var t=e.alternate;null!==t&&(e.alternate=null,ic(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[ha],delete t[fa],delete t[ga],delete t[ma],delete t[va])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function sc(e){return 5===e.tag||3===e.tag||4===e.tag}function oc(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||sc(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cc(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(cc(e,t,n),e=e.sibling;null!==e;)cc(e,t,n),e=e.sibling}function lc(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(lc(e,t,n),e=e.sibling;null!==e;)lc(e,t,n),e=e.sibling}var uc=null,dc=!1;function hc(e,t,n){for(n=n.child;null!==n;)fc(e,t,n),n=n.sibling}function fc(e,t,n){if(it&&"function"===typeof it.onCommitFiberUnmount)try{it.onCommitFiberUnmount(at,n)}catch(o){}switch(n.tag){case 5:Qo||Zo(n,t);case 6:var r=uc,a=dc;uc=null,hc(e,t,n),dc=a,null!==(uc=r)&&(dc?(e=uc,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):uc.removeChild(n.stateNode));break;case 18:null!==uc&&(dc?(e=uc,n=n.stateNode,8===e.nodeType?ca(e.parentNode,n):1===e.nodeType&&ca(e,n),Vt(e)):ca(uc,n.stateNode));break;case 4:r=uc,a=dc,uc=n.stateNode.containerInfo,dc=!0,hc(e,t,n),uc=r,dc=a;break;case 0:case 11:case 14:case 15:if(!Qo&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){a=r=r.next;do{var i=a,s=i.destroy;i=i.tag,void 0!==s&&(0!==(2&i)||0!==(4&i))&&ec(n,t,s),a=a.next}while(a!==r)}hc(e,t,n);break;case 1:if(!Qo&&(Zo(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){Sl(n,t,o)}hc(e,t,n);break;case 21:hc(e,t,n);break;case 22:1&n.mode?(Qo=(r=Qo)||null!==n.memoizedState,hc(e,t,n),Qo=r):hc(e,t,n);break;default:hc(e,t,n)}}function pc(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Xo),t.forEach((function(t){var r=_l.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function gc(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var a=n[r];try{var s=e,o=t,c=o;e:for(;null!==c;){switch(c.tag){case 5:uc=c.stateNode,dc=!1;break e;case 3:case 4:uc=c.stateNode.containerInfo,dc=!0;break e}c=c.return}if(null===uc)throw Error(i(160));fc(s,o,a),uc=null,dc=!1;var l=a.alternate;null!==l&&(l.return=null),a.return=null}catch(u){Sl(a,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)mc(t,e),t=t.sibling}function mc(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gc(t,e),vc(e),4&r){try{nc(3,e,e.return),rc(3,e)}catch(m){Sl(e,e.return,m)}try{nc(5,e,e.return)}catch(m){Sl(e,e.return,m)}}break;case 1:gc(t,e),vc(e),512&r&&null!==n&&Zo(n,n.return);break;case 5:if(gc(t,e),vc(e),512&r&&null!==n&&Zo(n,n.return),32&e.flags){var a=e.stateNode;try{he(a,"")}catch(m){Sl(e,e.return,m)}}if(4&r&&null!=(a=e.stateNode)){var s=e.memoizedProps,o=null!==n?n.memoizedProps:s,c=e.type,l=e.updateQueue;if(e.updateQueue=null,null!==l)try{"input"===c&&"radio"===s.type&&null!=s.name&&X(a,s),be(c,o);var u=be(c,s);for(o=0;o<l.length;o+=2){var d=l[o],h=l[o+1];"style"===d?me(a,h):"dangerouslySetInnerHTML"===d?de(a,h):"children"===d?he(a,h):b(a,d,h,u)}switch(c){case"input":J(a,s);break;case"textarea":ie(a,s);break;case"select":var f=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var p=s.value;null!=p?ne(a,!!s.multiple,p,!1):f!==!!s.multiple&&(null!=s.defaultValue?ne(a,!!s.multiple,s.defaultValue,!0):ne(a,!!s.multiple,s.multiple?[]:"",!1))}a[fa]=s}catch(m){Sl(e,e.return,m)}}break;case 6:if(gc(t,e),vc(e),4&r){if(null===e.stateNode)throw Error(i(162));a=e.stateNode,s=e.memoizedProps;try{a.nodeValue=s}catch(m){Sl(e,e.return,m)}}break;case 3:if(gc(t,e),vc(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Vt(t.containerInfo)}catch(m){Sl(e,e.return,m)}break;case 4:default:gc(t,e),vc(e);break;case 13:gc(t,e),vc(e),8192&(a=e.child).flags&&(s=null!==a.memoizedState,a.stateNode.isHidden=s,!s||null!==a.alternate&&null!==a.alternate.memoizedState||(Bc=Xe())),4&r&&pc(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Qo=(u=Qo)||d,gc(t,e),Qo=u):gc(t,e),vc(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&0!==(1&e.mode))for(Jo=e,d=e.child;null!==d;){for(h=Jo=d;null!==Jo;){switch(p=(f=Jo).child,f.tag){case 0:case 11:case 14:case 15:nc(4,f,f.return);break;case 1:Zo(f,f.return);var g=f.stateNode;if("function"===typeof g.componentWillUnmount){r=f,n=f.return;try{t=r,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(m){Sl(r,n,m)}}break;case 5:Zo(f,f.return);break;case 22:if(null!==f.memoizedState){xc(h);continue}}null!==p?(p.return=f,Jo=p):xc(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{a=h.stateNode,u?"function"===typeof(s=a.style).setProperty?s.setProperty("display","none","important"):s.display="none":(c=h.stateNode,o=void 0!==(l=h.memoizedProps.style)&&null!==l&&l.hasOwnProperty("display")?l.display:null,c.style.display=ge("display",o))}catch(m){Sl(e,e.return,m)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(m){Sl(e,e.return,m)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:gc(t,e),vc(e),4&r&&pc(e);case 21:}}function vc(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(sc(n)){var r=n;break e}n=n.return}throw Error(i(160))}switch(r.tag){case 5:var a=r.stateNode;32&r.flags&&(he(a,""),r.flags&=-33),lc(e,oc(e),a);break;case 3:case 4:var s=r.stateNode.containerInfo;cc(e,oc(e),s);break;default:throw Error(i(161))}}catch(o){Sl(e,e.return,o)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yc(e,t,n){Jo=e,bc(e,t,n)}function bc(e,t,n){for(var r=0!==(1&e.mode);null!==Jo;){var a=Jo,i=a.child;if(22===a.tag&&r){var s=null!==a.memoizedState||Yo;if(!s){var o=a.alternate,c=null!==o&&null!==o.memoizedState||Qo;o=Yo;var l=Qo;if(Yo=s,(Qo=c)&&!l)for(Jo=a;null!==Jo;)c=(s=Jo).child,22===s.tag&&null!==s.memoizedState?Ec(a):null!==c?(c.return=s,Jo=c):Ec(a);for(;null!==i;)Jo=i,bc(i,t,n),i=i.sibling;Jo=a,Yo=o,Qo=l}wc(e)}else 0!==(8772&a.subtreeFlags)&&null!==i?(i.return=a,Jo=i):wc(e)}}function wc(e){for(;null!==Jo;){var t=Jo;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Qo||rc(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Qo)if(null===n)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:to(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&$i(t,s,r);break;case 3:var o=t.updateQueue;if(null!==o){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}$i(t,o,n)}break;case 5:var c=t.stateNode;if(null===n&&4&t.flags){n=c;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&Vt(h)}}}break;default:throw Error(i(163))}Qo||512&t.flags&&ac(t)}catch(f){Sl(t,t.return,f)}}if(t===e){Jo=null;break}if(null!==(n=t.sibling)){n.return=t.return,Jo=n;break}Jo=t.return}}function xc(e){for(;null!==Jo;){var t=Jo;if(t===e){Jo=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Jo=n;break}Jo=t.return}}function Ec(e){for(;null!==Jo;){var t=Jo;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rc(4,t)}catch(c){Sl(t,n,c)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var a=t.return;try{r.componentDidMount()}catch(c){Sl(t,a,c)}}var i=t.return;try{ac(t)}catch(c){Sl(t,i,c)}break;case 5:var s=t.return;try{ac(t)}catch(c){Sl(t,s,c)}}}catch(c){Sl(t,t.return,c)}if(t===e){Jo=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Jo=o;break}Jo=t.return}}var Tc,Sc=Math.ceil,Ic=w.ReactCurrentDispatcher,kc=w.ReactCurrentOwner,Cc=w.ReactCurrentBatchConfig,_c=0,Ac=null,Nc=null,Rc=0,Oc=0,Dc=Sa(0),Pc=0,Lc=null,Mc=0,Fc=0,zc=0,jc=null,Uc=null,Bc=0,Vc=1/0,$c=null,Hc=!1,Gc=null,Wc=null,Kc=!1,qc=null,Yc=0,Qc=0,Xc=null,Jc=-1,Zc=0;function el(){return 0!==(6&_c)?Xe():-1!==Jc?Jc:Jc=Xe()}function tl(e){return 0===(1&e.mode)?1:0!==(2&_c)&&0!==Rc?Rc&-Rc:null!==gi.transition?(0===Zc&&(Zc=gt()),Zc):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Qt(e.type)}function nl(e,t,n,r){if(50<Qc)throw Qc=0,Xc=null,Error(i(185));vt(e,n,r),0!==(2&_c)&&e===Ac||(e===Ac&&(0===(2&_c)&&(Fc|=n),4===Pc&&ol(e,Rc)),rl(e,r),1===n&&0===_c&&0===(1&t.mode)&&(Vc=Xe()+500,ja&&Va()))}function rl(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var s=31-st(i),o=1<<s,c=a[s];-1===c?0!==(o&n)&&0===(o&r)||(a[s]=ft(o,t)):c<=t&&(e.expiredLanes|=o),i&=~o}}(e,t);var r=ht(e,e===Ac?Rc:0);if(0===r)null!==n&&qe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&qe(n),1===t)0===e.tag?function(e){ja=!0,Ba(e)}(cl.bind(null,e)):Ba(cl.bind(null,e)),sa((function(){0===(6&_c)&&Va()})),n=null;else{switch(wt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Al(n,al.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function al(e,t){if(Jc=-1,Zc=0,0!==(6&_c))throw Error(i(327));var n=e.callbackNode;if(El()&&e.callbackNode!==n)return null;var r=ht(e,e===Ac?Rc:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=ml(e,r);else{t=r;var a=_c;_c|=2;var s=pl();for(Ac===e&&Rc===t||($c=null,Vc=Xe()+500,hl(e,t));;)try{yl();break}catch(c){fl(e,c)}ki(),Ic.current=s,_c=a,null!==Nc?t=0:(Ac=null,Rc=0,t=Pc)}if(0!==t){if(2===t&&(0!==(a=pt(e))&&(r=a,t=il(e,a))),1===t)throw n=Lc,hl(e,0),ol(e,r),rl(e,Xe()),n;if(6===t)ol(e,r);else{if(a=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!or(i(),a))return!1}catch(o){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(a)&&(2===(t=ml(e,r))&&(0!==(s=pt(e))&&(r=s,t=il(e,s))),1===t))throw n=Lc,hl(e,0),ol(e,r),rl(e,Xe()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(i(345));case 2:case 5:xl(e,Uc,$c);break;case 3:if(ol(e,r),(130023424&r)===r&&10<(t=Bc+500-Xe())){if(0!==ht(e,0))break;if(((a=e.suspendedLanes)&r)!==r){el(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=ra(xl.bind(null,e,Uc,$c),t);break}xl(e,Uc,$c);break;case 4:if(ol(e,r),(4194240&r)===r)break;for(t=e.eventTimes,a=-1;0<r;){var o=31-st(r);s=1<<o,(o=t[o])>a&&(a=o),r&=~s}if(r=a,10<(r=(120>(r=Xe()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Sc(r/1960))-r)){e.timeoutHandle=ra(xl.bind(null,e,Uc,$c),r);break}xl(e,Uc,$c);break;default:throw Error(i(329))}}}return rl(e,Xe()),e.callbackNode===n?al.bind(null,e):null}function il(e,t){var n=jc;return e.current.memoizedState.isDehydrated&&(hl(e,t).flags|=256),2!==(e=ml(e,t))&&(t=Uc,Uc=n,null!==t&&sl(t)),e}function sl(e){null===Uc?Uc=e:Uc.push.apply(Uc,e)}function ol(e,t){for(t&=~zc,t&=~Fc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-st(t),r=1<<n;e[n]=-1,t&=~r}}function cl(e){if(0!==(6&_c))throw Error(i(327));El();var t=ht(e,0);if(0===(1&t))return rl(e,Xe()),null;var n=ml(e,t);if(0!==e.tag&&2===n){var r=pt(e);0!==r&&(t=r,n=il(e,r))}if(1===n)throw n=Lc,hl(e,0),ol(e,t),rl(e,Xe()),n;if(6===n)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,xl(e,Uc,$c),rl(e,Xe()),null}function ll(e,t){var n=_c;_c|=1;try{return e(t)}finally{0===(_c=n)&&(Vc=Xe()+500,ja&&Va())}}function ul(e){null!==qc&&0===qc.tag&&0===(6&_c)&&El();var t=_c;_c|=1;var n=Cc.transition,r=bt;try{if(Cc.transition=null,bt=1,e)return e()}finally{bt=r,Cc.transition=n,0===(6&(_c=t))&&Va()}}function dl(){Oc=Dc.current,Ia(Dc)}function hl(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,aa(n)),null!==Nc)for(n=Nc.return;null!==n;){var r=n;switch(ti(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Da();break;case 3:Qi(),Ia(Aa),Ia(_a),ns();break;case 5:Ji(r);break;case 4:Qi();break;case 13:case 19:Ia(Zi);break;case 10:Ci(r.type._context);break;case 22:case 23:dl()}n=n.return}if(Ac=e,Nc=e=Dl(e.current,null),Rc=Oc=t,Pc=0,Lc=null,zc=Fc=Mc=0,Uc=jc=null,null!==Ri){for(t=0;t<Ri.length;t++)if(null!==(r=(n=Ri[t]).interleaved)){n.interleaved=null;var a=r.next,i=n.pending;if(null!==i){var s=i.next;i.next=a,r.next=s}n.pending=r}Ri=null}return e}function fl(e,t){for(;;){var n=Nc;try{if(ki(),rs.current=Xs,ls){for(var r=ss.memoizedState;null!==r;){var a=r.queue;null!==a&&(a.pending=null),r=r.next}ls=!1}if(is=0,cs=os=ss=null,us=!1,ds=0,kc.current=null,null===n||null===n.return){Pc=1,Lc=t,Nc=null;break}e:{var s=e,o=n.return,c=n,l=t;if(t=Rc,c.flags|=32768,null!==l&&"object"===typeof l&&"function"===typeof l.then){var u=l,d=c,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=mo(o);if(null!==p){p.flags&=-257,vo(p,o,c,0,t),1&p.mode&&go(s,u,t),l=u;var g=(t=p).updateQueue;if(null===g){var m=new Set;m.add(l),t.updateQueue=m}else g.add(l);break e}if(0===(1&t)){go(s,u,t),gl();break e}l=Error(i(426))}else if(ai&&1&c.mode){var v=mo(o);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),vo(v,o,c,0,t),pi(co(l,c));break e}}s=l=co(l,c),4!==Pc&&(Pc=2),null===jc?jc=[s]:jc.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t,Bi(s,fo(0,l,t));break e;case 1:c=l;var y=s.type,b=s.stateNode;if(0===(128&s.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Wc||!Wc.has(b)))){s.flags|=65536,t&=-t,s.lanes|=t,Bi(s,po(s,c,t));break e}}s=s.return}while(null!==s)}wl(n)}catch(w){t=w,Nc===n&&null!==n&&(Nc=n=n.return);continue}break}}function pl(){var e=Ic.current;return Ic.current=Xs,null===e?Xs:e}function gl(){0!==Pc&&3!==Pc&&2!==Pc||(Pc=4),null===Ac||0===(268435455&Mc)&&0===(268435455&Fc)||ol(Ac,Rc)}function ml(e,t){var n=_c;_c|=2;var r=pl();for(Ac===e&&Rc===t||($c=null,hl(e,t));;)try{vl();break}catch(a){fl(e,a)}if(ki(),_c=n,Ic.current=r,null!==Nc)throw Error(i(261));return Ac=null,Rc=0,Pc}function vl(){for(;null!==Nc;)bl(Nc)}function yl(){for(;null!==Nc&&!Ye();)bl(Nc)}function bl(e){var t=Tc(e.alternate,e,Oc);e.memoizedProps=e.pendingProps,null===t?wl(e):Nc=t,kc.current=null}function wl(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ko(n,t,Oc)))return void(Nc=n)}else{if(null!==(n=qo(n,t)))return n.flags&=32767,void(Nc=n);if(null===e)return Pc=6,void(Nc=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Nc=t);Nc=t=e}while(null!==t);0===Pc&&(Pc=5)}function xl(e,t,n){var r=bt,a=Cc.transition;try{Cc.transition=null,bt=1,function(e,t,n,r){do{El()}while(null!==qc);if(0!==(6&_c))throw Error(i(327));n=e.finishedWork;var a=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-st(n),i=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~i}}(e,s),e===Ac&&(Nc=Ac=null,Rc=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Kc||(Kc=!0,Al(tt,(function(){return El(),null}))),s=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||s){s=Cc.transition,Cc.transition=null;var o=bt;bt=1;var c=_c;_c|=4,kc.current=null,function(e,t){if(ea=Ht,fr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var a=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch(x){n=null;break e}var o=0,c=-1,l=-1,u=0,d=0,h=e,f=null;t:for(;;){for(var p;h!==n||0!==a&&3!==h.nodeType||(c=o+a),h!==s||0!==r&&3!==h.nodeType||(l=o+r),3===h.nodeType&&(o+=h.nodeValue.length),null!==(p=h.firstChild);)f=h,h=p;for(;;){if(h===e)break t;if(f===n&&++u===a&&(c=o),f===s&&++d===r&&(l=o),null!==(p=h.nextSibling))break;f=(h=f).parentNode}h=p}n=-1===c||-1===l?null:{start:c,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(ta={focusedElem:e,selectionRange:n},Ht=!1,Jo=t;null!==Jo;)if(e=(t=Jo).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Jo=e;else for(;null!==Jo;){t=Jo;try{var g=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==g){var m=g.memoizedProps,v=g.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?m:to(t.type,m),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=t.stateNode.containerInfo;1===w.nodeType?w.textContent="":9===w.nodeType&&w.documentElement&&w.removeChild(w.documentElement);break;default:throw Error(i(163))}}catch(x){Sl(t,t.return,x)}if(null!==(e=t.sibling)){e.return=t.return,Jo=e;break}Jo=t.return}g=tc,tc=!1}(e,n),mc(n,e),pr(ta),Ht=!!ea,ta=ea=null,e.current=n,yc(n,e,a),Qe(),_c=c,bt=o,Cc.transition=s}else e.current=n;if(Kc&&(Kc=!1,qc=e,Yc=a),s=e.pendingLanes,0===s&&(Wc=null),function(e){if(it&&"function"===typeof it.onCommitFiberRoot)try{it.onCommitFiberRoot(at,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),rl(e,Xe()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(Hc)throw Hc=!1,e=Gc,Gc=null,e;0!==(1&Yc)&&0!==e.tag&&El(),s=e.pendingLanes,0!==(1&s)?e===Xc?Qc++:(Qc=0,Xc=e):Qc=0,Va()}(e,t,n,r)}finally{Cc.transition=a,bt=r}return null}function El(){if(null!==qc){var e=wt(Yc),t=Cc.transition,n=bt;try{if(Cc.transition=null,bt=16>e?16:e,null===qc)var r=!1;else{if(e=qc,qc=null,Yc=0,0!==(6&_c))throw Error(i(331));var a=_c;for(_c|=4,Jo=e.current;null!==Jo;){var s=Jo,o=s.child;if(0!==(16&Jo.flags)){var c=s.deletions;if(null!==c){for(var l=0;l<c.length;l++){var u=c[l];for(Jo=u;null!==Jo;){var d=Jo;switch(d.tag){case 0:case 11:case 15:nc(8,d,s)}var h=d.child;if(null!==h)h.return=d,Jo=h;else for(;null!==Jo;){var f=(d=Jo).sibling,p=d.return;if(ic(d),d===u){Jo=null;break}if(null!==f){f.return=p,Jo=f;break}Jo=p}}}var g=s.alternate;if(null!==g){var m=g.child;if(null!==m){g.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(null!==m)}}Jo=s}}if(0!==(2064&s.subtreeFlags)&&null!==o)o.return=s,Jo=o;else e:for(;null!==Jo;){if(0!==(2048&(s=Jo).flags))switch(s.tag){case 0:case 11:case 15:nc(9,s,s.return)}var y=s.sibling;if(null!==y){y.return=s.return,Jo=y;break e}Jo=s.return}}var b=e.current;for(Jo=b;null!==Jo;){var w=(o=Jo).child;if(0!==(2064&o.subtreeFlags)&&null!==w)w.return=o,Jo=w;else e:for(o=b;null!==Jo;){if(0!==(2048&(c=Jo).flags))try{switch(c.tag){case 0:case 11:case 15:rc(9,c)}}catch(E){Sl(c,c.return,E)}if(c===o){Jo=null;break e}var x=c.sibling;if(null!==x){x.return=c.return,Jo=x;break e}Jo=c.return}}if(_c=a,Va(),it&&"function"===typeof it.onPostCommitFiberRoot)try{it.onPostCommitFiberRoot(at,e)}catch(E){}r=!0}return r}finally{bt=n,Cc.transition=t}}return!1}function Tl(e,t,n){e=ji(e,t=fo(0,t=co(n,t),1),1),t=el(),null!==e&&(vt(e,1,t),rl(e,t))}function Sl(e,t,n){if(3===e.tag)Tl(e,e,n);else for(;null!==t;){if(3===t.tag){Tl(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Wc||!Wc.has(r))){t=ji(t,e=po(t,e=co(n,e),1),1),e=el(),null!==t&&(vt(t,1,e),rl(t,e));break}}t=t.return}}function Il(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=el(),e.pingedLanes|=e.suspendedLanes&n,Ac===e&&(Rc&n)===n&&(4===Pc||3===Pc&&(130023424&Rc)===Rc&&500>Xe()-Bc?hl(e,0):zc|=n),rl(e,t)}function kl(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=el();null!==(e=Pi(e,t))&&(vt(e,t,n),rl(e,n))}function Cl(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),kl(e,n)}function _l(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;null!==a&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(i(314))}null!==r&&r.delete(t),kl(e,n)}function Al(e,t){return Ke(e,t)}function Nl(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rl(e,t,n,r){return new Nl(e,t,n,r)}function Ol(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Dl(e,t){var n=e.alternate;return null===n?((n=Rl(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Pl(e,t,n,r,a,s){var o=2;if(r=e,"function"===typeof e)Ol(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case T:return Ll(n.children,a,s,t);case S:o=8,a|=8;break;case I:return(e=Rl(12,n,t,2|a)).elementType=I,e.lanes=s,e;case A:return(e=Rl(13,n,t,a)).elementType=A,e.lanes=s,e;case N:return(e=Rl(19,n,t,a)).elementType=N,e.lanes=s,e;case D:return Ml(n,a,s,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case k:o=10;break e;case C:o=9;break e;case _:o=11;break e;case R:o=14;break e;case O:o=16,r=null;break e}throw Error(i(130,null==e?e:typeof e,""))}return(t=Rl(o,n,t,a)).elementType=e,t.type=r,t.lanes=s,t}function Ll(e,t,n,r){return(e=Rl(7,e,r,t)).lanes=n,e}function Ml(e,t,n,r){return(e=Rl(22,e,r,t)).elementType=D,e.lanes=n,e.stateNode={isHidden:!1},e}function Fl(e,t,n){return(e=Rl(6,e,null,t)).lanes=n,e}function zl(e,t,n){return(t=Rl(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function jl(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mt(0),this.expirationTimes=mt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mt(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Ul(e,t,n,r,a,i,s,o,c){return e=new jl(e,t,n,o,c),1===t?(t=1,!0===i&&(t|=8)):t=0,i=Rl(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Mi(i),e}function Bl(e){if(!e)return Ca;e:{if(Ve(e=e._reactInternals)!==e||1!==e.tag)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Oa(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(i(171))}if(1===e.tag){var n=e.type;if(Oa(n))return La(e,n,t)}return t}function Vl(e,t,n,r,a,i,s,o,c){return(e=Ul(n,r,!0,e,0,i,0,o,c)).context=Bl(null),n=e.current,(i=zi(r=el(),a=tl(n))).callback=void 0!==t&&null!==t?t:null,ji(n,i,a),e.current.lanes=a,vt(e,a,r),rl(e,r),e}function $l(e,t,n,r){var a=t.current,i=el(),s=tl(a);return n=Bl(n),null===t.context?t.context=n:t.pendingContext=n,(t=zi(i,s)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=ji(a,t,s))&&(nl(e,a,s,i),Ui(e,a,s)),s}function Hl(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Gl(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Wl(e,t){Gl(e,t),(e=e.alternate)&&Gl(e,t)}Tc=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Aa.current)bo=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return bo=!1,function(e,t,n){switch(t.tag){case 3:Ao(t),fi();break;case 5:Xi(t);break;case 1:Oa(t.type)&&Ma(t);break;case 4:Yi(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;ka(Ei,r._currentValue),r._currentValue=a;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(ka(Zi,1&Zi.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Fo(e,t,n):(ka(Zi,1&Zi.current),null!==(e=Ho(e,t,n))?e.sibling:null);ka(Zi,1&Zi.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Vo(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),ka(Zi,Zi.current),r)break;return null;case 22:case 23:return t.lanes=0,So(e,t,n)}return Ho(e,t,n)}(e,t,n);bo=0!==(131072&e.flags)}else bo=!1,ai&&0!==(1048576&t.flags)&&Za(t,Wa,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;$o(e,t),e=t.pendingProps;var a=Ra(t,_a.current);Ai(t,n),a=gs(null,t,r,e,a,n);var s=ms();return t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Oa(r)?(s=!0,Ma(t)):s=!1,t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,Mi(t),a.updater=ro,t.stateNode=a,a._reactInternals=t,oo(t,r,e,n),t=_o(null,t,r,!0,s,n)):(t.tag=0,ai&&s&&ei(t),wo(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch($o(e,t),e=t.pendingProps,r=(a=r._init)(r._payload),t.type=r,a=t.tag=function(e){if("function"===typeof e)return Ol(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===_)return 11;if(e===R)return 14}return 2}(r),e=to(r,e),a){case 0:t=ko(null,t,r,e,n);break e;case 1:t=Co(null,t,r,e,n);break e;case 11:t=xo(null,t,r,e,n);break e;case 14:t=Eo(null,t,r,to(r.type,e),n);break e}throw Error(i(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,ko(e,t,r,a=t.elementType===r?a:to(r,a),n);case 1:return r=t.type,a=t.pendingProps,Co(e,t,r,a=t.elementType===r?a:to(r,a),n);case 3:e:{if(Ao(t),null===e)throw Error(i(387));r=t.pendingProps,a=(s=t.memoizedState).element,Fi(e,t),Vi(t,r,null,n);var o=t.memoizedState;if(r=o.element,s.isDehydrated){if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=No(e,t,r,n,a=co(Error(i(423)),t));break e}if(r!==a){t=No(e,t,r,n,a=co(Error(i(424)),t));break e}for(ri=la(t.stateNode.containerInfo.firstChild),ni=t,ai=!0,ii=null,n=xi(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fi(),r===a){t=Ho(e,t,n);break e}wo(e,t,r,n)}t=t.child}return t;case 5:return Xi(t),null===e&&li(t),r=t.type,a=t.pendingProps,s=null!==e?e.memoizedProps:null,o=a.children,na(r,a)?o=null:null!==s&&na(r,s)&&(t.flags|=32),Io(e,t),wo(e,t,o,n),t.child;case 6:return null===e&&li(t),null;case 13:return Fo(e,t,n);case 4:return Yi(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=wi(t,null,r,n):wo(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,xo(e,t,r,a=t.elementType===r?a:to(r,a),n);case 7:return wo(e,t,t.pendingProps,n),t.child;case 8:case 12:return wo(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,s=t.memoizedProps,o=a.value,ka(Ei,r._currentValue),r._currentValue=o,null!==s)if(or(s.value,o)){if(s.children===a.children&&!Aa.current){t=Ho(e,t,n);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var c=s.dependencies;if(null!==c){o=s.child;for(var l=c.firstContext;null!==l;){if(l.context===r){if(1===s.tag){(l=zi(-1,n&-n)).tag=2;var u=s.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),_i(s.return,n,t),c.lanes|=n;break}l=l.next}}else if(10===s.tag)o=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(o=s.return))throw Error(i(341));o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),_i(o,n,t),o=s.sibling}else o=s.child;if(null!==o)o.return=s;else for(o=s;null!==o;){if(o===t){o=null;break}if(null!==(s=o.sibling)){s.return=o.return,o=s;break}o=o.return}s=o}wo(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,Ai(t,n),r=r(a=Ni(a)),t.flags|=1,wo(e,t,r,n),t.child;case 14:return a=to(r=t.type,t.pendingProps),Eo(e,t,r,a=to(r.type,a),n);case 15:return To(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:to(r,a),$o(e,t),t.tag=1,Oa(r)?(e=!0,Ma(t)):e=!1,Ai(t,n),io(t,r,a),oo(t,r,a,n),_o(null,t,r,!0,e,n);case 19:return Vo(e,t,n);case 22:return So(e,t,n)}throw Error(i(156,t.tag))};var Kl="function"===typeof reportError?reportError:function(e){console.error(e)};function ql(e){this._internalRoot=e}function Yl(e){this._internalRoot=e}function Ql(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Xl(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Jl(){}function Zl(e,t,n,r,a){var i=n._reactRootContainer;if(i){var s=i;if("function"===typeof a){var o=a;a=function(){var e=Hl(s);o.call(e)}}$l(t,s,e,a)}else s=function(e,t,n,r,a){if(a){if("function"===typeof r){var i=r;r=function(){var e=Hl(s);i.call(e)}}var s=Vl(t,r,e,0,null,!1,0,"",Jl);return e._reactRootContainer=s,e[pa]=s.current,Vr(8===e.nodeType?e.parentNode:e),ul(),s}for(;a=e.lastChild;)e.removeChild(a);if("function"===typeof r){var o=r;r=function(){var e=Hl(c);o.call(e)}}var c=Ul(e,0,!1,null,0,!1,0,"",Jl);return e._reactRootContainer=c,e[pa]=c.current,Vr(8===e.nodeType?e.parentNode:e),ul((function(){$l(t,c,n,r)})),c}(n,t,e,a,r);return Hl(s)}Yl.prototype.render=ql.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));$l(e,t,null,null)},Yl.prototype.unmount=ql.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;ul((function(){$l(null,e,null,null)})),t[pa]=null}},Yl.prototype.unstable_scheduleHydration=function(e){if(e){var t=St();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Dt.length&&0!==t&&t<Dt[n].priority;n++);Dt.splice(n,0,e),0===n&&Ft(e)}},xt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(yt(t,1|n),rl(t,Xe()),0===(6&_c)&&(Vc=Xe()+500,Va()))}break;case 13:ul((function(){var t=Pi(e,1);if(null!==t){var n=el();nl(t,e,1,n)}})),Wl(e,1)}},Et=function(e){if(13===e.tag){var t=Pi(e,134217728);if(null!==t)nl(t,e,134217728,el());Wl(e,134217728)}},Tt=function(e){if(13===e.tag){var t=tl(e),n=Pi(e,t);if(null!==n)nl(n,e,t,el());Wl(e,t)}},St=function(){return bt},It=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},Ee=function(e,t,n){switch(t){case"input":if(J(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=xa(r);if(!a)throw Error(i(90));K(r),J(r,a)}}}break;case"textarea":ie(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},_e=ll,Ae=ul;var eu={usingClientEntryPoint:!1,Events:[ba,wa,xa,ke,Ce,ll]},tu={findFiberByHostInstance:ya,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nu={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ge(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ru=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ru.isDisabled&&ru.supportsFiber)try{at=ru.inject(nu),it=ru}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Ql(t))throw Error(i(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:E,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Ql(e))throw Error(i(299));var n=!1,r="",a=Kl;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(a=t.onRecoverableError)),t=Ul(e,1,!1,null,0,n,0,r,a),e[pa]=t.current,Vr(8===e.nodeType?e.parentNode:e),new ql(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=null===(e=Ge(t))?null:e.stateNode},t.flushSync=function(e){return ul(e)},t.hydrate=function(e,t,n){if(!Xl(t))throw Error(i(200));return Zl(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Ql(e))throw Error(i(405));var r=null!=n&&n.hydratedSources||null,a=!1,s="",o=Kl;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(a=!0),void 0!==n.identifierPrefix&&(s=n.identifierPrefix),void 0!==n.onRecoverableError&&(o=n.onRecoverableError)),t=Vl(t,null,e,1,null!=n?n:null,a,0,s,o),e[pa]=t.current,Vr(e),r)for(e=0;e<r.length;e++)a=(a=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new Yl(t)},t.render=function(e,t,n){if(!Xl(t))throw Error(i(200));return Zl(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Xl(e))throw Error(i(40));return!!e._reactRootContainer&&(ul((function(){Zl(null,null,e,!1,(function(){e._reactRootContainer=null,e[pa]=null}))})),!0)},t.unstable_batchedUpdates=ll,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Xl(n))throw Error(i(200));if(null==e||void 0===e._reactInternals)throw Error(i(38));return Zl(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},799:(e,t,n)=>{n.d(t,{P2:()=>m});const r=(e,t)=>t.some((t=>e instanceof t));let a,i;const s=new WeakMap,o=new WeakMap,c=new WeakMap,l=new WeakMap,u=new WeakMap;let d={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return o.get(e);if("objectStoreNames"===t)return e.objectStoreNames||c.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return p(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function h(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(i||(i=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(g(this),n),p(s.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return p(e.apply(g(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];const i=e.call(g(this),t,...r);return c.set(i,t.sort?t.sort():[t]),p(i)}}function f(e){return"function"===typeof e?h(e):(e instanceof IDBTransaction&&function(e){if(o.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",a),e.removeEventListener("error",i),e.removeEventListener("abort",i)},a=()=>{t(),r()},i=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",a),e.addEventListener("error",i),e.addEventListener("abort",i)}));o.set(e,t)}(e),r(e,a||(a=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,d):e)}function p(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",a),e.removeEventListener("error",i)},a=()=>{t(p(e.result)),r()},i=()=>{n(e.error),r()};e.addEventListener("success",a),e.addEventListener("error",i)}));return t.then((t=>{t instanceof IDBCursor&&s.set(t,e)})).catch((()=>{})),u.set(t,e),t}(e);if(l.has(e))return l.get(e);const t=f(e);return t!==e&&(l.set(e,t),u.set(t,e)),t}const g=e=>u.get(e);function m(e,t){let{blocked:n,upgrade:r,blocking:a,terminated:i}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const s=indexedDB.open(e,t),o=p(s);return r&&s.addEventListener("upgradeneeded",(e=>{r(p(s.result),e.oldVersion,e.newVersion,p(s.transaction),e)})),n&&s.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),o.then((e=>{i&&e.addEventListener("close",(()=>i())),a&&e.addEventListener("versionchange",(e=>a(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),o}const v=["get","getKey","getAll","getAllKeys","count"],y=["put","add","delete","clear"],b=new Map;function w(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(b.get(t))return b.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,a=y.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!a&&!v.includes(n))return;const i=async function(e){const t=this.transaction(e,a?"readwrite":"readonly");let i=t.store;for(var s=arguments.length,o=new Array(s>1?s-1:0),c=1;c<s;c++)o[c-1]=arguments[c];return r&&(i=i.index(o.shift())),(await Promise.all([i[n](...o),a&&t.done]))[0]};return b.set(t,i),i}d=(e=>({...e,get:(t,n,r)=>w(t,n)||e.get(t,n,r),has:(t,n)=>!!w(t,n)||e.has(t,n)}))(d)},812:(e,t,n)=>{n.d(t,{h1:()=>o,uA:()=>a});var r=n(529);class a{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const i="[DEFAULT]";class s{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new r.cY;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(n){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(a){if(r)return null;throw a}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:i})}catch(t){}for(const[e,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:r});n.resolve(e)}catch(t){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[a,i]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(a)&&i.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),a=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;a.add(e),this.onInitCallbacks.set(r,a);const i=this.instances.get(r);return i&&e(i,r),()=>{a.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const a of n)try{a(e,t)}catch(r){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(a=t,a===i?void 0:a),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch(s){}var a;return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i;return this.component?this.component.multipleInstances?e:i:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class o{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new s(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}},853:(e,t,n)=>{e.exports=n(234)},950:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.m=e,n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,r)=>(n.f[r](e,t),t)),[])),n.u=e=>"static/js/"+e+".4b8be825.chunk.js",n.miniCssF=e=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="asignacion-plazas:";n.l=(r,a,i,s)=>{if(e[r])e[r].push(a);else{var o,c;if(void 0!==i)for(var l=document.getElementsByTagName("script"),u=0;u<l.length;u++){var d=l[u];if(d.getAttribute("src")==r||d.getAttribute("data-webpack")==t+i){o=d;break}}o||(c=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,n.nc&&o.setAttribute("nonce",n.nc),o.setAttribute("data-webpack",t+i),o.src=r),e[r]=[a];var h=(t,n)=>{o.onerror=o.onload=null,clearTimeout(f);var a=e[r];if(delete e[r],o.parentNode&&o.parentNode.removeChild(o),a&&a.forEach((e=>e(n))),t)return t(n)},f=setTimeout(h.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=h.bind(null,o.onerror),o.onload=h.bind(null,o.onload),c&&document.head.appendChild(o)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/asignacion-plazas/",(()=>{var e={792:0};n.f.j=(t,r)=>{var a=n.o(e,t)?e[t]:void 0;if(0!==a)if(a)r.push(a[2]);else{var i=new Promise(((n,r)=>a=e[t]=[n,r]));r.push(a[2]=i);var s=n.p+n.u(t),o=new Error;n.l(s,(r=>{if(n.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=r&&("load"===r.type?"missing":r.type),s=r&&r.target&&r.target.src;o.message="Loading chunk "+t+" failed.\n("+i+": "+s+")",o.name="ChunkLoadError",o.type=i,o.request=s,a[1](o)}}),"chunk-"+t,t)}};var t=(t,r)=>{var a,i,s=r[0],o=r[1],c=r[2],l=0;if(s.some((t=>0!==e[t]))){for(a in o)n.o(o,a)&&(n.m[a]=o[a]);if(c)c(n)}for(t&&t(r);l<s.length;l++)i=s[l],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0},r=self.webpackChunkasignacion_plazas=self.webpackChunkasignacion_plazas||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var r=n(43),a=n(391),i=n(472),s=n(213),o=n(496),c=n(579);const l=e=>{let{assignments:t=[],availablePlazas:n=[]}=e;const[a,i]=(0,r.useState)(""),[s,o]=(0,r.useState)("TODOS"),[l,u]=(0,r.useState)(""),[d,h]=(0,r.useState)(1),[f]=(0,r.useState)(10),[p,g]=(0,r.useState)({key:"order",direction:"asc"}),m=(0,r.useMemo)((()=>e=>e&&Array.isArray(e)?[...e].sort(((e,t)=>{if(!e||!t)return 0;let n,r;return"order"===p.key?(n=void 0!==e.numeroOrden?e.numeroOrden:e.order,r=void 0!==t.numeroOrden?t.numeroOrden:t.order):"centro"===p.key?(n=e.nombreCentro||e.centro||"",r=t.nombreCentro||t.centro||""):(n=e[p.key],r=t[p.key]),"order"===p.key&&(n=Number(n)||0,r=Number(r)||0),n<r?"asc"===p.direction?-1:1:n>r?"asc"===p.direction?1:-1:0})):[]),[p]),v=(0,r.useMemo)((()=>{if(!Array.isArray(t))return[];let e=t;if(a){const t=a.toLowerCase();e=e.filter((e=>{var n;if(!e)return!1;return[null===(n=e.numeroOrden||e.order)||void 0===n?void 0:n.toString(),e.nombreCentro||e.centro,e.localidad,e.municipio].filter(Boolean).some((e=>e.toLowerCase().includes(t)))}))}return"TODOS"!==s&&(e=e.filter((e=>e&&e.estado===s))),m(e)}),[t,a,s,m]),y=(0,r.useMemo)((()=>({total:v.length,centros:[...new Set(v.map((e=>e.nombreCentro||e.centro)))].length,reasignados:v.filter((e=>e.reasignado)).length,noAsignables:v.filter((e=>"NO_ASIGNABLE"===e.estadoAsignacion)).length})),[v]),b=((0,r.useMemo)((()=>["TODOS",...new Set(v.filter((e=>e.estado)).map((e=>e.estado)))]),[v]),Math.ceil(v.length/f)),w=d*f,x=w-f,E=v.slice(x,w);(0,r.useEffect)((()=>{if(!Array.isArray(t))return u("Error: Los datos de asignaciones no son v\xe1lidos"),void console.error("Dashboard: assignments debe ser un array");const e=t.filter((e=>!e||"object"!==typeof e||!e.numeroOrden&&!e.order||!e.nombreCentro&&!e.centro||!e.timestamp));e.length>0&&console.warn("Algunas asignaciones tienen estructura inv\xe1lida:",e),u("")}),[t]);const T=e=>{if(!e)return"Fecha no disponible";try{return new Date(e).toLocaleString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch(l){return console.error("Error al formatear fecha:",l),"Fecha inv\xe1lida"}};if(l)return(0,c.jsx)("div",{style:{textAlign:"center",padding:"20px",backgroundColor:"#fff3cd",borderRadius:"8px",color:"#856404",margin:"20px 0"},children:(0,c.jsx)("p",{children:l})});if(!t.length)return(0,c.jsxs)("div",{style:{textAlign:"center",padding:"40px 20px",backgroundColor:"#f5f7fa",borderRadius:"8px",color:"#5c6c7c"},children:[(0,c.jsx)("div",{style:{fontSize:"36px",marginBottom:"15px"},children:"\ud83d\udccb"}),(0,c.jsx)("div",{style:{fontSize:"18px",fontWeight:"bold",marginBottom:"10px"},children:"No hay asignaciones realizadas"}),(0,c.jsx)("div",{style:{fontSize:"14px"},children:"Las asignaciones aparecer\xe1n aqu\xed una vez procesadas las solicitudes"})]});const S=e=>{e<1||e>b||h(e)},I=e=>{g((t=>({key:e,direction:t.key===e&&"asc"===t.direction?"desc":"asc"})))},k={container:{position:"relative",padding:"20px",backgroundColor:"#f4f6f9",borderRadius:"8px",boxShadow:"0 4px 8px rgba(0,0,0,0.1)"},infoContainer:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px",flexWrap:"wrap",gap:"15px"},statsContainer:{display:"flex",gap:"15px",flexWrap:"wrap"},statCard:{backgroundColor:"#ffffff",borderRadius:"6px",padding:"15px",minWidth:"140px",boxShadow:"0 2px 5px rgba(0,0,0,0.06)",flex:1},statValue:{fontSize:"24px",fontWeight:"bold",color:"#2d3748",marginBottom:"5px"},statLabel:{fontSize:"13px",color:"#718096"},searchBar:{display:"flex",gap:"10px",marginBottom:"20px"},input:{flex:"1",padding:"10px 12px",borderRadius:"6px",border:"1px solid #e2e8f0",fontSize:"14px"},select:{padding:"10px 12px",borderRadius:"6px",border:"1px solid #e2e8f0",fontSize:"14px",backgroundColor:"#fff"},tableContainer:{overflowX:"auto",backgroundColor:"#ffffff",borderRadius:"8px",boxShadow:"0 2px 5px rgba(0,0,0,0.05)"},table:{width:"100%",borderCollapse:"collapse",fontSize:"14px"},tableHeader:{backgroundColor:"#f8fafc",color:"#4a5568",textAlign:"left",padding:"12px 15px",fontWeight:"bold",borderBottom:"2px solid #e2e8f0",cursor:"pointer",transition:"background-color 0.2s",position:"sticky",top:0},tableCell:{padding:"12px 15px",borderBottom:"1px solid #e2e8f0",color:"#2d3748",whiteSpace:"nowrap"},pagination:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"15px 0",fontSize:"14px"},pageButton:{padding:"6px 12px",margin:"0 4px",backgroundColor:"#f1f5f9",border:"none",borderRadius:"4px",cursor:"pointer",transition:"background-color 0.2s",fontSize:"13px"},activePageButton:{backgroundColor:"#3182ce",color:"#ffffff"},textCenter:{textAlign:"center"},badge:{display:"inline-block",padding:"3px 8px",borderRadius:"12px",fontSize:"12px",fontWeight:"bold",textAlign:"center"},badgePrimary:{backgroundColor:"#ebf5ff",color:"#3182ce"},badgeSuccess:{backgroundColor:"#e6fffa",color:"#38b2ac"},badgeWarning:{backgroundColor:"#fffaf0",color:"#dd6b20"},badgeReasignado:{backgroundColor:"#fef0f5",color:"#d53f8c",border:"1px dashed #d53f8c"},infoRow:{marginBottom:"15px",backgroundColor:"#f8fafc",borderRadius:"6px",padding:"10px 15px",fontSize:"14px",color:"#4a5568",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},orderContainer:{display:"flex",alignItems:"center",gap:"8px"},orderBadge:{color:"#000",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"16px",fontWeight:"bold"},sortIcon:{marginLeft:"4px",display:"inline-block",fontSize:"10px"},leyendaContainer:{marginTop:"20px",padding:"15px",backgroundColor:"#ffffff",borderRadius:"8px",boxShadow:"0 2px 5px rgba(0,0,0,0.05)",fontSize:"13px"},leyendaTitle:{fontSize:"14px",fontWeight:"bold",marginBottom:"10px"},leyendaItems:{display:"flex",flexWrap:"wrap",gap:"15px"},leyendaItem:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"}};return(0,c.jsxs)("div",{style:k.container,children:[(0,c.jsx)("div",{style:k.infoContainer,children:(0,c.jsxs)("div",{style:k.statsContainer,children:[(0,c.jsxs)("div",{style:k.statCard,children:[(0,c.jsx)("div",{style:k.statValue,children:y.total}),(0,c.jsx)("div",{style:k.statLabel,children:"Asignaciones totales"})]}),(0,c.jsxs)("div",{style:k.statCard,children:[(0,c.jsx)("div",{style:k.statValue,children:y.centros}),(0,c.jsx)("div",{style:k.statLabel,children:"Centros con asignaciones"})]}),(0,c.jsxs)("div",{style:k.statCard,children:[(0,c.jsx)("div",{style:k.statValue,children:y.reasignados}),(0,c.jsx)("div",{style:k.statLabel,children:"Reasignaciones"})]}),y.noAsignables>0&&(0,c.jsxs)("div",{style:{...k.statCard,backgroundColor:"#fff5f5",borderLeft:"3px solid #e53e3e"},children:[(0,c.jsx)("div",{style:{...k.statValue,color:"#e53e3e"},children:y.noAsignables}),(0,c.jsx)("div",{style:k.statLabel,children:"No asignables"})]})]})}),(()=>{const e=t.reduce(((e,t)=>{if(!t)return e;const n=t.centerId||t.id;return n?(e[n]||(e[n]={id:n,centro:t.nombreCentro||t.centro||"Centro desconocido",count:0,plazas:0}),e[n].count++,e):e}),{});for(const t in e){const r=n.find((e=>e.id===t));r&&(e[t].plazas=r.plazas||0)}const r=Object.values(e).filter((e=>e.count>e.plazas&&e.plazas>0));return r.length>0?(0,c.jsxs)("div",{style:{backgroundColor:"#fff5f5",borderLeft:"4px solid #e53e3e",borderRadius:"4px",padding:"12px 15px",marginBottom:"20px",fontSize:"14px",color:"#742a2a",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[(0,c.jsx)("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"16px"},children:"\u26a0\ufe0f Se detectaron centros con exceso de asignaciones"}),(0,c.jsx)("div",{style:{marginBottom:"10px"},children:"Los siguientes centros tienen m\xe1s asignaciones que plazas disponibles:"}),(0,c.jsx)("ul",{style:{margin:"10px 0",paddingLeft:"25px"},children:r.map((e=>(0,c.jsxs)("li",{style:{marginBottom:"5px"},children:[(0,c.jsxs)("strong",{children:[e.centro,":"]})," ",e.count," asignaciones para ",e.plazas," plazas"]},e.id)))}),(0,c.jsx)("div",{style:{marginTop:"10px",fontSize:"13px"},children:"Se recomienda ejecutar la verificaci\xf3n y correcci\xf3n autom\xe1tica de asignaciones."})]}):null})(),(0,c.jsx)("div",{style:k.searchBar,children:(0,c.jsx)("input",{type:"text",placeholder:"Buscar por n\xba de orden, centro, localidad...",value:a,onChange:e=>{i(e.target.value),h(1)},style:k.input})}),(0,c.jsx)("div",{style:k.tableContainer,children:(0,c.jsxs)("table",{style:k.table,children:[(0,c.jsx)("thead",{children:(0,c.jsxs)("tr",{children:[(0,c.jsx)("th",{style:k.tableHeader,onClick:()=>I("order"),children:(0,c.jsxs)("div",{style:k.orderContainer,children:["N\xba Orden",(0,c.jsx)("span",{style:k.sortIcon,children:"order"===p.key&&("asc"===p.direction?"\u25b2":"\u25bc")})]})}),(0,c.jsxs)("th",{style:k.tableHeader,onClick:()=>I("centro"),children:["Centro",(0,c.jsx)("span",{style:k.sortIcon,children:"centro"===p.key&&("asc"===p.direction?"\u25b2":"\u25bc")})]}),(0,c.jsxs)("th",{style:k.tableHeader,onClick:()=>I("localidad"),children:["Ubicaci\xf3n",(0,c.jsx)("span",{style:{fontSize:"12px",fontWeight:"normal",display:"block"},children:"Localidad / Municipio"}),(0,c.jsx)("span",{style:k.sortIcon,children:"localidad"===p.key&&("asc"===p.direction?"\u25b2":"\u25bc")})]}),(0,c.jsxs)("th",{style:k.tableHeader,onClick:()=>I("timestamp"),children:["Fecha",(0,c.jsx)("span",{style:k.sortIcon,children:"timestamp"===p.key&&("asc"===p.direction?"\u25b2":"\u25bc")})]})]})}),(0,c.jsxs)("tbody",{children:[E.map(((e,t)=>(0,c.jsxs)("tr",{style:"NO_ASIGNABLE"===e.estadoAsignacion?{backgroundColor:"#fff1f0"}:e.reasignado?{backgroundColor:"#fff9fb"}:{},children:[(0,c.jsx)("td",{style:k.tableCell,children:(0,c.jsx)("div",{style:k.orderContainer,children:(0,c.jsx)("div",{style:k.orderBadge,children:e.numeroOrden||e.order})})}),(0,c.jsx)("td",{style:k.tableCell,children:(0,c.jsxs)("div",{children:[(0,c.jsx)("strong",{children:e.nombreCentro||e.centerName||e.centro}),e.reasignado&&(0,c.jsxs)("div",{style:{fontSize:"12px",color:"#d53f8c",marginTop:"4px"},children:["Reasignado de: ",e.centroOriginal||e.centroPrevio]}),"NO_ASIGNABLE"===e.estadoAsignacion&&(0,c.jsxs)("div",{style:{fontSize:"12px",color:"#e53e3e",marginTop:"4px",backgroundColor:"#fff5f5",padding:"3px 6px",borderRadius:"4px",display:"inline-block"},children:[(0,c.jsx)("span",{style:{marginRight:"4px"},children:"\u26a0\ufe0f"}),"No asignable: Plaza ocupada"]})]})}),(0,c.jsx)("td",{style:k.tableCell,children:(0,c.jsxs)("div",{children:[e.localidad&&(0,c.jsx)("div",{style:{fontWeight:"medium"},children:e.localidad}),e.municipio&&e.municipio!==e.localidad&&(0,c.jsxs)("div",{style:{color:"#4a5568",fontSize:"13px",marginTop:e.localidad?"3px":"0",display:"flex",alignItems:"center"},children:[(0,c.jsx)("span",{style:{marginRight:"4px"},children:"\ud83d\udccd"}),e.municipio]}),!e.localidad&&!e.municipio&&(0,c.jsx)("span",{style:{color:"#a0aec0",fontStyle:"italic"}}),"NO_ASIGNABLE"===e.estadoAsignacion&&(0,c.jsx)("div",{style:{marginTop:"5px",fontSize:"11px",color:"#718096",fontStyle:"italic"},children:e.mensajeEstado||"No hay plazas disponibles en el \xfanico centro seleccionado"})]})}),(0,c.jsx)("td",{style:k.tableCell,children:T(e.timestamp)})]},e.docId||t))),0===E.length&&(0,c.jsx)("tr",{children:(0,c.jsx)("td",{colSpan:"5",style:{...k.tableCell,textAlign:"center",padding:"30px 15px"},children:"No se encontraron asignaciones que coincidan con los filtros."})})]})]})}),b>1&&(0,c.jsxs)("div",{style:k.pagination,children:[(0,c.jsxs)("div",{children:["Mostrando ",x+1,"-",Math.min(w,v.length)," de ",v.length]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("button",{style:k.pageButton,onClick:()=>S(1),disabled:1===d,children:"\xab"}),(0,c.jsx)("button",{style:k.pageButton,onClick:()=>S(d-1),disabled:1===d,children:"\u2039"}),Array.from({length:Math.min(5,b)},((e,t)=>{let n;return n=b<=5||d<=3?t+1:d>=b-2?b-4+t:d-2+t,(0,c.jsx)("button",{style:{...k.pageButton,...d===n?k.activePageButton:{}},onClick:()=>S(n),children:n},n)})),(0,c.jsx)("button",{style:k.pageButton,onClick:()=>S(d+1),disabled:d===b,children:"\u203a"}),(0,c.jsx)("button",{style:k.pageButton,onClick:()=>S(b),disabled:d===b,children:"\xbb"})]})]}),(0,c.jsxs)("div",{style:k.leyendaContainer,children:[(0,c.jsx)("div",{style:k.leyendaTitle,children:"Leyenda de asignaciones"}),(0,c.jsxs)("div",{style:k.leyendaItems,children:[(0,c.jsxs)("div",{style:k.leyendaItem,children:[(0,c.jsx)("div",{style:{width:"16px",height:"16px",backgroundColor:"#fff",border:"1px solid #eee",borderRadius:"3px"}}),(0,c.jsx)("span",{children:"Asignaci\xf3n normal"})]}),(0,c.jsxs)("div",{style:k.leyendaItem,children:[(0,c.jsx)("div",{style:{width:"16px",height:"16px",backgroundColor:"#fff9fb",border:"1px solid #fdd6e7",borderRadius:"3px"}}),(0,c.jsx)("span",{children:"Reasignaci\xf3n"})]}),(0,c.jsxs)("div",{style:k.leyendaItem,children:[(0,c.jsx)("div",{style:{width:"16px",height:"16px",backgroundColor:"#fff1f0",border:"1px solid #fcc2bd",borderRadius:"3px"}}),(0,c.jsx)("span",{children:"No asignable (plaza ocupada)"})]})]}),y.noAsignables>0&&(0,c.jsxs)("div",{style:{marginTop:"15px",padding:"10px 15px",backgroundColor:"#fff5f5",borderRadius:"5px",fontSize:"13px",color:"#742a2a",borderLeft:"3px solid #e53e3e"},children:[(0,c.jsx)("strong",{children:'Informaci\xf3n sobre asignaciones "No asignables":'}),(0,c.jsx)("p",{style:{margin:"8px 0"},children:"Estas asignaciones se crean cuando una solicitud solo tiene un centro como opci\xf3n y ese centro ya tiene todas sus plazas ocupadas por solicitudes con mayor prioridad (n\xfamero de orden menor)."}),(0,c.jsx)("p",{style:{margin:"8px 0"},children:"En estos casos, el sistema registra la asignaci\xf3n de forma especial para mantener el seguimiento."})]})]})]})},u=e=>{let{availablePlazas:t=[],assignments:n=[],searchTerm:a="",setSearchTerm:i,orderNumber:s,setOrderNumber:o,centrosSeleccionados:l=[],setCentrosSeleccionados:u,handleOrderSubmit:d,isProcessing:h=!1}=e;const[f,p]=(0,r.useState)(""),[g,m]=(0,r.useState)(1),[v,y]=(0,r.useState)(10),[b,w]=(0,r.useState)("undefined"!==typeof window?window.innerWidth:1200),[x,E]=(0,r.useState)(null),[T,S]=(0,r.useState)(""),[I,k]=(0,r.useState)(""),[C,_]=(0,r.useState)(""),[A,N]=(0,r.useState)(null);(0,r.useEffect)((()=>{i&&o&&u&&d||console.error("PlazasDisponibles: Faltan funciones de callback requeridas")}),[i,o,u,d]),(0,r.useEffect)((()=>{const e=()=>{w(window.innerWidth)};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]);const R=b<768,O=e=>{const n=new Set;return t.forEach((t=>{t[e]&&n.add(t[e])})),Array.from(n).sort()},D=O("asi"),P=O("departamento"),L=O("municipio"),M=[...t.filter((e=>{if(a){const t=a.toLowerCase();if(!(e.centro&&e.centro.toLowerCase().includes(t)||e.nombre&&e.nombre.toLowerCase().includes(t)||e.nombreCentro&&e.nombreCentro.toLowerCase().includes(t)||e.localidad&&e.localidad.toLowerCase().includes(t)||e.municipio&&e.municipio.toLowerCase().includes(t)||e.codigo&&e.codigo.toLowerCase().includes(t)||e.asi&&e.asi.toLowerCase().includes(t)||e.departamento&&e.departamento.toLowerCase().includes(t)))return!1}return(!T||e.asi===T)&&(!I||e.departamento===I)&&(!C||e.municipio===C)}))].sort(((e,t)=>{var n;const r=e.plazas-(e.asignadas||0),a=t.plazas-(t.asignadas||0);return 0===a&&r>0?-1:0===r&&a>0?1:r!==a?a-r:(null===(n=e.centro)||void 0===n?void 0:n.localeCompare(t.centro||""))||0})),F=Math.ceil(M.length/v),z=g*v,j=z-v,U=M.slice(j,z),B=t.reduce(((e,t)=>e+(t.plazas||0)),0),V=(t.reduce(((e,t)=>e+(t.asignadas||0)),0),()=>{E(null)}),$=e=>{try{const t=e.target.value;if(!t)return void console.error("ID de centro inv\xe1lido:",e.target.value);e.target.checked?l.includes(t)||u((e=>[...e,t])):u((e=>e.filter((e=>e!==t))))}catch(f){console.error("Error al seleccionar centro:",f)}};return(0,c.jsxs)("div",{className:"plazas-container",children:[A&&(0,c.jsx)("div",{className:`submit-message ${A.type}`,style:{padding:"10px 15px",margin:"10px 0",borderRadius:"4px",backgroundColor:"success"===A.type?"#d4edda":"#f8d7da",color:"success"===A.type?"#155724":"#721c24",border:"1px solid "+("success"===A.type?"#c3e6cb":"#f5c6cb")},children:A.message}),(0,c.jsxs)("div",{style:{marginBottom:"25px",padding:"20px",backgroundColor:"#f8f9fa",borderRadius:"8px",border:"1px solid #e9ecef",boxShadow:"0 2px 8px rgba(0,0,0,0.05)"},children:[(0,c.jsx)("h3",{style:{fontSize:"18px",color:"#343a40",marginTop:0,marginBottom:"15px",borderBottom:"2px solid #e9ecef",paddingBottom:"10px"},children:"Solicitar una plaza"}),(0,c.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),p(""),!s)return void p("Por favor ingrese un n\xfamero de orden");if(!l.length)return void p("Por favor seleccione al menos un centro");l.filter((e=>{const n=t.find((t=>t.id===e));return!n||n.plazas<=n.asignadas})).length>0?p("Algunos centros seleccionados ya no tienen plazas disponibles"):d(s,l)},children:[(0,c.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,c.jsx)("label",{htmlFor:"orderNumber",style:{display:"block",marginBottom:"8px",fontWeight:"bold",color:"#495057"},children:"N\xfamero de Orden:"}),(0,c.jsx)("input",{type:"number",id:"orderNumber",value:s,onChange:e=>{const t=e.target.value;if(p(""),""===t)return void o("");const n=Number(t);isNaN(n)?p("Por favor ingrese un n\xfamero v\xe1lido"):n<1?p("El n\xfamero de orden debe ser mayor a 0"):Number.isInteger(n)?o(n):p("El n\xfamero de orden debe ser un n\xfamero entero")},style:{width:"100%",padding:"12px 15px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"16px",boxShadow:"inset 0 1px 3px rgba(0,0,0,0.05)"},required:!0,placeholder:"Introduce tu n\xfamero de orden"})]}),(0,c.jsxs)("div",{style:{padding:"12px 15px",backgroundColor:"#e6f7ff",border:"1px solid #91d5ff",borderRadius:"6px",marginBottom:"15px",fontSize:"14px",color:"#1890ff",display:"flex",alignItems:"flex-start",gap:"10px"},children:[(0,c.jsx)("span",{style:{fontSize:"18px"},children:"\u2139\ufe0f"}),(0,c.jsxs)("div",{children:[(0,c.jsx)("strong",{children:"Informaci\xf3n importante:"})," Puedes solicitar plazas aunque aparezcan como completas. El sistema asignar\xe1 las plazas priorizando por n\xfamero de orden (menor n\xfamero = mayor prioridad), incluso si la plaza ya est\xe1 asignada a alguien con un n\xfamero de orden mayor."]})]}),(0,c.jsxs)("div",{style:{padding:"10px 15px",backgroundColor:"#e9f5fe",borderRadius:"6px",marginBottom:"20px",fontSize:"14px",borderLeft:"4px solid #3498db"},children:[(0,c.jsx)("strong",{children:"Importante:"})," Selecciona tus centros por orden de preferencia. El primer centro que selecciones ser\xe1 tu primera opci\xf3n."]}),l.length>0&&(0,c.jsxs)("div",{style:{marginBottom:"20px",padding:"15px",backgroundColor:"#e8f5e9",borderRadius:"6px",border:"1px solid #c8e6c9"},children:[(0,c.jsx)("strong",{style:{color:"#2E7D32"},children:"Centros seleccionados en orden de preferencia:"}),(0,c.jsx)("ol",{style:{paddingLeft:"25px",marginTop:"10px",marginBottom:"0",color:"#333"},children:l.map(((e,n)=>{const r=t.find((t=>t.id===e));return r?(0,c.jsxs)("li",{style:{marginBottom:"8px"},children:[(0,c.jsx)("strong",{children:r.nombre||r.nombreCentro||r.centro}),r.localidad&&(0,c.jsxs)("span",{style:{color:"#555",marginLeft:"5px"},children:["- ",r.localidad]}),r.municipio&&r.municipio!==r.localidad&&(0,c.jsxs)("span",{style:{marginLeft:"5px",color:"#4a5568",fontSize:"13px"},children:[(0,c.jsx)("span",{style:{marginRight:"4px"},children:"\ud83d\udccd"}),r.municipio]}),0===n&&(0,c.jsx)("span",{style:{display:"inline-block",marginLeft:"8px",fontSize:"12px",color:"#d35400",backgroundColor:"#fff3cd",padding:"1px 5px",borderRadius:"10px",fontWeight:"bold"},children:"1\xaa opci\xf3n"})]},e):null}))}),(0,c.jsx)("div",{style:{marginTop:"10px",textAlign:"right"},children:(0,c.jsx)("button",{type:"button",onClick:()=>u([]),style:{padding:"6px 12px",backgroundColor:"#f8d7da",color:"#721c24",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"13px"},children:"Limpiar selecci\xf3n"})})]}),(0,c.jsx)("div",{style:{textAlign:"center"},children:(0,c.jsx)("button",{type:"submit",disabled:h||0===l.length,style:{padding:"12px 25px",backgroundImage:h?"linear-gradient(to right, #cccccc, #dddddd)":"linear-gradient(to right, #3498db, #2980b9)",color:"white",border:"none",borderRadius:"6px",cursor:h||0===l.length?"not-allowed":"pointer",display:"inline-flex",alignItems:"center",justifyContent:"center",fontSize:"16px",fontWeight:"500",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:h?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("span",{style:{display:"inline-block",width:"18px",height:"18px",border:"3px solid rgba(255,255,255,0.3)",borderRadius:"50%",borderTopColor:"white",animation:"spin 1s linear infinite",marginRight:"10px"}}),"Procesando..."]}):(0,c.jsx)(c.Fragment,{children:"Solicitar Plaza"})})})]})]}),(0,c.jsxs)("div",{className:"search-container",children:[(0,c.jsx)("input",{type:"text",className:"search-box",placeholder:"Buscar por centro, municipio o c\xf3digo...",value:a,onChange:e=>{i(e.target.value),m(1)}}),a&&(0,c.jsx)("button",{className:"clear-search",onClick:()=>i(""),children:"\xd7"})]}),(0,c.jsxs)("div",{className:"filters-container",children:[(0,c.jsxs)("select",{className:"filter-select",value:T,onChange:e=>{S(e.target.value),m(1)},children:[(0,c.jsx)("option",{value:"",children:"Todos los ASI"}),D.map((e=>(0,c.jsx)("option",{value:e,children:e},e)))]}),(0,c.jsxs)("select",{className:"filter-select",value:I,onChange:e=>{k(e.target.value),m(1)},children:[(0,c.jsx)("option",{value:"",children:"Todos los departamentos"}),P.map((e=>(0,c.jsx)("option",{value:e,children:e},e)))]}),(0,c.jsxs)("select",{className:"filter-select",value:C,onChange:e=>{_(e.target.value),m(1)},children:[(0,c.jsx)("option",{value:"",children:"Todos los municipios"}),L.map((e=>(0,c.jsx)("option",{value:e,children:e},e)))]}),(0,c.jsxs)("select",{className:"filter-select",value:v,onChange:e=>{y(Number(e.target.value)),m(1)},children:[(0,c.jsx)("option",{value:10,children:"10 por p\xe1gina"}),(0,c.jsx)("option",{value:25,children:"25 por p\xe1gina"}),(0,c.jsx)("option",{value:50,children:"50 por p\xe1gina"}),(0,c.jsx)("option",{value:100,children:"100 por p\xe1gina"})]})]}),(0,c.jsxs)("div",{className:"results-info",children:[(0,c.jsxs)("span",{children:["Mostrando ",U.length," de ",M.length," centros"]}),(0,c.jsxs)("span",{children:["Total plazas: ",B]})]}),(0,c.jsx)("div",{className:"plazas-grid",children:0===M.length?(0,c.jsxs)("div",{className:"empty-state",children:[(0,c.jsx)("div",{className:"empty-icon",children:"\ud83d\udd0d"}),(0,c.jsx)("p",{children:"No se encontraron plazas con los criterios seleccionados."}),(0,c.jsx)("button",{className:"reset-filters",onClick:()=>{i(""),m(1)},children:"Limpiar filtros"})]}):(0,c.jsxs)("table",{className:"tabla-plazas",children:[(0,c.jsx)("thead",{children:(0,c.jsxs)("tr",{children:[(0,c.jsx)("th",{style:{width:"60px"}}),(0,c.jsx)("th",{children:"C\xf3digo"}),(0,c.jsx)("th",{className:"centro-column",children:"Centro"}),(0,c.jsx)("th",{children:"Ubicaci\xf3n"}),(0,c.jsx)("th",{children:"Plazas"}),b<768&&(0,c.jsx)("th",{style:{width:"40px"},children:"Info"})]})}),(0,c.jsx)("tbody",{children:U.map(((e,t)=>{const n=Math.max(0,e.plazas-(e.asignadas||0));let r=t%2===0?"white":"#f9f9f9";l.includes(e.id)?r="#e6f7ff":0===n?r="#ffe6e6":n<=2&&(r="#fff3cd");const a=e.docId||`plaza-${e.id}-${t}`;return(0,c.jsxs)("tr",{style:{backgroundColor:r,transition:"background-color 0.2s ease"},onClick:()=>{var t;R&&((t=e.id)?u((e=>e.includes(t)?(console.log(`Quitando centro ${t} de la selecci\xf3n`),e.filter((e=>e!==t))):e.length>=5?(p("No se pueden seleccionar m\xe1s de 5 centros"),e):(console.log(`Agregando centro ${t} a la selecci\xf3n`),[...e,t]))):console.error("ID de centro inv\xe1lido"))},children:[(0,c.jsx)("td",{children:(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px",justifyContent:"center"},children:[(0,c.jsx)("input",{type:"checkbox",id:`plaza-${e.id}`,value:e.id,onChange:$,checked:l.includes(e.id),style:{width:"20px",height:"20px",cursor:"pointer"}}),l.includes(e.id)&&(0,c.jsx)("span",{style:{backgroundImage:"linear-gradient(135deg, #1976D2, #2196F3)",color:"white",borderRadius:"50%",width:"28px",height:"28px",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",fontSize:"14px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:l.indexOf(e.id)+1})]})}),(0,c.jsx)("td",{children:e.codigo}),(0,c.jsx)("td",{className:"centro-column",title:e.nombre||e.nombreCentro||e.centro,children:e.nombre||e.nombreCentro||e.centro}),(0,c.jsx)("td",{children:(0,c.jsxs)("div",{children:[e.localidad&&(0,c.jsx)("div",{style:{fontWeight:"medium"},children:e.localidad}),e.municipio&&e.municipio!==e.localidad&&(0,c.jsxs)("div",{style:{color:"#4a5568",fontSize:"13px",marginTop:e.localidad?"3px":"0",display:"flex",alignItems:"center"},children:[(0,c.jsx)("span",{style:{marginRight:"4px"},children:"\ud83d\udccd"}),e.municipio]}),!e.localidad&&!e.municipio&&(0,c.jsx)("span",{style:{color:"#a0aec0",fontStyle:"italic"}})]})}),(0,c.jsx)("td",{children:e.plazas}),b<768&&(0,c.jsx)("td",{children:(0,c.jsx)("button",{className:"info-button",onClick:t=>{t.stopPropagation(),(e=>{E({...e,disponibles:e.plazas-(e.asignadas||0)})})(e)},children:"\u2139\ufe0f"})})]},a)}))})]})}),M.length>0&&(0,c.jsxs)("div",{className:"pagination",children:[(0,c.jsx)("button",{className:"pagination-button",onClick:()=>m(1),disabled:1===g,children:"\xab\xab"}),(0,c.jsx)("button",{className:"pagination-button",onClick:()=>m((e=>Math.max(1,e-1))),disabled:1===g,children:"\xab"}),(F<=5?Array.from({length:F},((e,t)=>t+1)):g<=3?[1,2,3,4,5]:g>=F-2?[F-4,F-3,F-2,F-1,F]:[g-2,g-1,g,g+1,g+2]).map((e=>(0,c.jsx)("button",{className:"pagination-button "+(g===e?"active":""),onClick:()=>m(e),children:e},e))),(0,c.jsx)("button",{className:"pagination-button",onClick:()=>m((e=>Math.min(F,e+1))),disabled:g===F,children:"\xbb"}),(0,c.jsx)("button",{className:"pagination-button",onClick:()=>m(F),disabled:g===F,children:"\xbb\xbb"})]}),x&&(0,c.jsx)("div",{className:"info-modal",children:(0,c.jsxs)("div",{className:"info-content",children:[(0,c.jsx)("h3",{children:"Informaci\xf3n del centro"}),(0,c.jsxs)("p",{children:[(0,c.jsx)("strong",{children:"Centro:"})," ",x.nombre||x.nombreCentro||x.centro]}),(0,c.jsxs)("p",{children:[(0,c.jsx)("strong",{children:"C\xf3digo:"})," ",x.codigo]}),(0,c.jsxs)("p",{children:[(0,c.jsx)("strong",{children:"Municipio:"})," ",x.municipio]}),(0,c.jsxs)("p",{children:[(0,c.jsx)("strong",{children:"Departamento:"})," ",x.departamento]}),(0,c.jsxs)("p",{children:[(0,c.jsx)("strong",{children:"ASI:"})," ",x.asi]}),(0,c.jsxs)("p",{children:[(0,c.jsx)("strong",{children:"Plazas disponibles:"})," ",x.disponibles]}),(0,c.jsxs)("div",{className:"modal-footer",children:[(0,c.jsx)("button",{className:"close-button",onClick:V,children:"Cerrar"}),(0,c.jsx)("button",{className:"select-button",onClick:()=>{$({target:{value:x.id,checked:!l.includes(x.id)}}),V()},children:"Seleccionar"})]})]})}),(0,c.jsx)("style",{children:"\n        .plazas-container {\n          background-color: white;\n          border-radius: 8px;\n          box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);\n          padding: 20px;\n          height: 100%;\n          display: flex;\n          flex-direction: column;\n          overflow: hidden;\n          max-width: 100%;\n          box-sizing: border-box;\n        }\n        \n        .search-container {\n          position: relative;\n          margin-bottom: 15px;\n          width: 100%;\n          max-width: 100%;\n          box-sizing: border-box;\n        }\n        \n        .search-box {\n          width: 100%;\n          padding: 14px 16px;\n          border: 2px solid #ddd;\n          border-radius: 6px;\n          font-size: 16px;\n          transition: border-color 0.3s;\n          box-sizing: border-box;\n          overflow: hidden;\n          text-overflow: ellipsis;\n        }\n        \n        .search-box:focus {\n          border-color: #1976d2;\n          outline: none;\n          box-shadow: 0 0 0 3px rgba(25, 118, 210, 0.2);\n        }\n        \n        .clear-search {\n          position: absolute;\n          right: 10px;\n          top: 50%;\n          transform: translateY(-50%);\n          background: none;\n          border: none;\n          font-size: 24px;\n          cursor: pointer;\n          color: #999;\n          padding: 5px;\n          line-height: 1;\n          z-index: 5;\n        }\n        \n        .clear-search:hover {\n          color: #333;\n        }\n        \n        .filters-container {\n          display: flex;\n          flex-wrap: wrap;\n          gap: 10px;\n          margin-bottom: 15px;\n          max-width: 100%;\n          box-sizing: border-box;\n        }\n        \n        .filter-select {\n          padding: 10px;\n          border: 1px solid #ddd;\n          border-radius: 4px;\n          min-width: 150px;\n          flex: 1 1 auto;\n          box-sizing: border-box;\n          max-width: 100%;\n        }\n        \n        @media (max-width: 768px) {\n          .filters-container {\n            flex-direction: column;\n            gap: 8px;\n          }\n          \n          .filter-select {\n            width: 100%;\n            min-width: auto;\n          }\n          \n          .search-box {\n            padding: 12px 14px;\n            font-size: 14px;\n          }\n          \n          .clear-search {\n            right: 5px;\n            font-size: 20px;\n          }\n        }\n        \n        .results-info {\n          display: flex;\n          justify-content: space-between;\n          margin-bottom: 10px;\n          font-size: 14px;\n          color: #555;\n          font-weight: 500;\n          flex-wrap: wrap;\n          width: 100%;\n          box-sizing: border-box;\n        }\n        \n        .plazas-grid {\n          overflow-y: auto;\n          height: 100%;\n          border: 1px solid #eee;\n          border-radius: 4px;\n          margin-bottom: 15px;\n          -webkit-overflow-scrolling: touch;\n        }\n        \n        .tabla-plazas {\n          width: 100%;\n          border-collapse: collapse;\n          table-layout: fixed;\n        }\n        \n        .tabla-plazas th {\n          background-color: #f5f5f5;\n          position: sticky;\n          top: 0;\n          padding: 12px 10px;\n          text-align: left;\n          border-bottom: 2px solid #ddd;\n          z-index: 10;\n          font-weight: 600;\n        }\n        \n        .tabla-plazas td {\n          padding: 12px 10px;\n          border-bottom: 1px solid #eee;\n          word-break: break-word;\n        }\n        \n        .centro-column {\n          max-width: 300px;\n          white-space: nowrap;\n          overflow: hidden;\n          text-overflow: ellipsis;\n        }\n        \n        .tabla-plazas tr:hover {\n          background-color: #f9f9f9;\n        }\n        \n        .selected-row {\n          background-color: #e3f2fd;\n        }\n        \n        .selected-row:hover {\n          background-color: #bbdefb;\n        }\n        \n        .empty-state {\n          display: flex;\n          flex-direction: column;\n          align-items: center;\n          justify-content: center;\n          padding: 40px 0;\n          text-align: center;\n          color: #757575;\n        }\n        \n        .empty-icon {\n          font-size: 48px;\n          margin-bottom: 20px;\n        }\n        \n        .reset-filters {\n          margin-top: 15px;\n          padding: 8px 16px;\n          background-color: #1976d2;\n          color: white;\n          border: none;\n          border-radius: 4px;\n          cursor: pointer;\n        }\n        \n        .pagination {\n          display: flex;\n          justify-content: center;\n          gap: 5px;\n          margin-top: 15px;\n          flex-wrap: wrap;\n        }\n        \n        .pagination-button {\n          padding: 8px 12px;\n          border: 1px solid #ddd;\n          background-color: white;\n          border-radius: 4px;\n          cursor: pointer;\n          transition: all 0.2s;\n        }\n        \n        .pagination-button.active {\n          background-color: #1976d2;\n          color: white;\n          border-color: #1976d2;\n        }\n        \n        .pagination-button:hover:not(:disabled) {\n          background-color: #f0f0f0;\n          border-color: #bbb;\n        }\n        \n        .pagination-button:disabled {\n          cursor: not-allowed;\n          opacity: 0.5;\n        }\n        \n        .info-button {\n          background: none;\n          border: none;\n          cursor: pointer;\n          font-size: 18px;\n          padding: 2px;\n        }\n        \n        .info-modal {\n          position: fixed;\n          top: 0;\n          left: 0;\n          right: 0;\n          bottom: 0;\n          background-color: rgba(0, 0, 0, 0.5);\n          display: flex;\n          justify-content: center;\n          align-items: center;\n          z-index: 1000;\n        }\n        \n        .info-content {\n          background-color: white;\n          border-radius: 8px;\n          padding: 20px;\n          width: 90%;\n          max-width: 500px;\n          max-height: 80vh;\n          overflow-y: auto;\n          box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);\n        }\n        \n        .info-content h3 {\n          margin-top: 0;\n          color: #1a237e;\n          border-bottom: 1px solid #eee;\n          padding-bottom: 10px;\n        }\n        \n        .modal-footer {\n          display: flex;\n          justify-content: flex-end;\n          gap: 10px;\n          margin-top: 20px;\n          border-top: 1px solid #eee;\n          padding-top: 15px;\n        }\n        \n        .close-button, .select-button {\n          padding: 8px 16px;\n          border-radius: 4px;\n          border: none;\n          cursor: pointer;\n        }\n        \n        .close-button {\n          background-color: #f5f5f5;\n          color: #333;\n        }\n        \n        .select-button {\n          background-color: #1976d2;\n          color: white;\n        }\n        \n        /* Dise\xf1o responsive */\n        @media (max-width: 768px) {\n          .plazas-container {\n            padding: 15px 10px;\n          }\n          \n          .filters-container {\n            flex-direction: column;\n            gap: 8px;\n          }\n          \n          .filter-select {\n            width: 100%;\n          }\n          \n          .tabla-plazas th, .tabla-plazas td {\n            padding: 10px 5px;\n            font-size: 13px;\n          }\n          \n          .tabla-plazas th:nth-child(1) {\n            width: 65px;\n          }\n          \n          .tabla-plazas th:nth-child(2) {\n            width: 60px;\n          }\n          \n          .tabla-plazas th:nth-child(4) {\n            width: 80px;\n          }\n          \n          .tabla-plazas th:nth-child(5) {\n            width: 45px;\n          }\n          \n          .centro-column {\n            max-width: 100px;\n          }\n          \n          .pagination-button {\n            padding: 6px 10px;\n            font-size: 13px;\n          }\n          \n          h2 {\n            font-size: 20px;\n            margin-top: 0;\n          }\n          \n          form > div {\n            margin-bottom: 10px !important;\n          }\n          \n          .search-box {\n            padding: 10px 12px;\n            font-size: 14px;\n          }\n        }\n        \n        /* Animaciones */\n        @keyframes spin {\n          0% { transform: rotate(0deg); }\n          100% { transform: rotate(360deg); }\n        }\n      "})]})},d=e=>{let{solicitudes:t=[],assignments:n=[],availablePlazas:a=[]}=e;const[i,s]=(0,r.useState)(1),[o,l]=(0,r.useState)(10),[u,d]=(0,r.useState)(""),[h,f]=(0,r.useState)(""),[p,g]=(0,r.useState)("undefined"!==typeof window?window.innerWidth:1200),[m,v]=(0,r.useState)({key:"orden",direction:"asc"});if((0,r.useEffect)((()=>Array.isArray(t)?Array.isArray(n)?Array.isArray(a)?void f(""):(f("Error: Las plazas disponibles no son v\xe1lidas"),void console.error("SolicitudesPendientes: availablePlazas debe ser un array")):(f("Error: Las asignaciones no son v\xe1lidas"),void console.error("SolicitudesPendientes: assignments debe ser un array")):(f("Error: Las solicitudes no son v\xe1lidas"),void console.error("SolicitudesPendientes: solicitudes debe ser un array"))),[t,n,a]),(0,r.useEffect)((()=>{const e=()=>{g(window.innerWidth)};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),h)return(0,c.jsx)("div",{style:{textAlign:"center",padding:"20px",backgroundColor:"#fff3cd",borderRadius:"8px",color:"#856404",margin:"20px 0"},children:(0,c.jsx)("p",{children:h})});const y=p<768,b=(w=(Array.isArray(t)?t:[]).filter((e=>!!e&&(void 0===e.orden||null===e.orden?(console.warn("Solicitud sin n\xfamero de orden:",e),!1):!(!Array.isArray(e.centrosIds)&&!Array.isArray(e.centrosSeleccionados))||(console.warn("Solicitud sin centros seleccionados:",e),!1)))).filter((e=>{var t;return[null===(t=e.orden)||void 0===t?void 0:t.toString(),...(e.centrosIds||e.centrosSeleccionados||[]).map((e=>{const t=a.find((t=>t.id===e));return t?[t.nombre||t.nombreCentro||t.centro,t.localidad,t.municipio]:[]})).flat()].filter(Boolean).some((e=>e.toLowerCase().includes(u.toLowerCase())))})))&&Array.isArray(w)?[...w].sort(((e,t)=>{if(!e||!t)return 0;let n=e[m.key],r=t[m.key];return"orden"===m.key&&(n=Number(n)||0,r=Number(r)||0),n<r?"asc"===m.direction?-1:1:n>r?"asc"===m.direction?1:-1:0})):[];var w;const x=Math.ceil(b.length/o),E=i*o,T=E-o,S=b.slice(T,E),I=e=>{e<1||e>x||s(e)};return t.length?(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:{marginBottom:"15px",fontSize:"14px",padding:"12px 15px",backgroundColor:"#fff7f0",borderRadius:"6px",borderLeft:"4px solid #d35400",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:["A continuaci\xf3n se muestran las solicitudes pendientes con sus preferencias de centros en orden.",(0,c.jsx)("p",{style:{color:"#d35400",fontWeight:"bold",marginTop:"8px",marginBottom:"0"},children:"\u26a0\ufe0f Las solicitudes se procesan por orden de prioridad (n\xfamero de orden menor = mayor prioridad)"})]}),(0,c.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,c.jsxs)("div",{style:{marginBottom:"10px",position:"relative"},children:[(0,c.jsx)("input",{type:"text",placeholder:"Buscar por n\xfamero de orden o centro...",value:u,onChange:e=>{d(e.target.value),s(1)},style:{padding:"12px 15px",paddingLeft:"40px",border:"1px solid #ddd",borderRadius:"6px",width:"100%",fontSize:"16px",boxShadow:"inset 0 1px 3px rgba(0,0,0,0.05)"}}),(0,c.jsx)("div",{style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",color:"#666",fontSize:"18px"},children:"\ud83d\udd0d"})]}),(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"10px"},children:[(0,c.jsxs)("div",{style:{marginBottom:"10px",fontSize:"14px",color:"#666"},children:["Mostrando ",(0,c.jsxs)("strong",{children:[b.length>0?T+1:0,"-",Math.min(E,b.length)]})," de ",(0,c.jsx)("strong",{children:b.length})," solicitudes",u&&` (filtradas de ${t.length})`]}),(0,c.jsx)("div",{children:(0,c.jsxs)("select",{value:o,onChange:e=>{l(Number(e.target.value)),s(1)},style:{padding:"8px 12px",border:"1px solid #ddd",borderRadius:"6px",backgroundColor:"white",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:[(0,c.jsx)("option",{value:10,children:"10 por p\xe1gina"}),(0,c.jsx)("option",{value:25,children:"25 por p\xe1gina"}),(0,c.jsx)("option",{value:50,children:"50 por p\xe1gina"}),(0,c.jsx)("option",{value:b.length,children:"Ver todas"})]})})]})]}),y&&(0,c.jsx)("div",{style:{marginBottom:"15px",fontSize:"13px",color:"#666",textAlign:"center",backgroundColor:"#fff3cd",padding:"8px",borderRadius:"4px"},children:"\u2190 Desliza para ver la tabla completa \u2192"}),(0,c.jsx)("div",{style:{overflowX:"auto",border:"1px solid #e1e8f0",borderRadius:"6px",WebkitOverflowScrolling:"touch"},children:(0,c.jsxs)("table",{className:"responsive-table",style:{width:"100%",borderCollapse:"collapse",minWidth:y?"768px":"auto"},children:[(0,c.jsx)("thead",{children:(0,c.jsxs)("tr",{style:{backgroundImage:"linear-gradient(to right, #fef5ec, #fde4ce)",position:"sticky",top:0,zIndex:5},children:[(0,c.jsx)("th",{style:{border:"1px solid #ddd",padding:"12px 15px",textAlign:"left",color:"#d35400"},children:"N\xba Orden"}),(0,c.jsx)("th",{style:{border:"1px solid #ddd",padding:"12px 15px",textAlign:"left",color:"#d35400"},children:"Fecha/Hora"}),(0,c.jsx)("th",{style:{border:"1px solid #ddd",padding:"12px 15px",textAlign:"left",color:"#d35400"},children:"Centros Seleccionados (en orden de preferencia)"}),(0,c.jsx)("th",{style:{border:"1px solid #ddd",padding:"12px 15px",textAlign:"center",color:"#d35400"},children:"Estado"})]})}),(0,c.jsxs)("tbody",{children:[S.map(((e,t)=>{const r=new Date(e.timestamp),i=`${r.toLocaleDateString()} ${r.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`,s=n.some((t=>t.order===e.orden)),o=n.find((t=>t.order===e.orden)),l=s?"#e8f5e9":t%2===0?"white":"#fef9f4";return(0,c.jsxs)("tr",{style:{backgroundColor:l,opacity:s?.8:1,transition:"background-color 0.2s ease"},children:[(0,c.jsxs)("td",{style:{border:"1px solid #ddd",padding:"12px 15px",fontWeight:"bold",backgroundColor:e.orden<=50?"#fff3cd":"inherit"},children:[e.orden,e.orden<=50&&(0,c.jsx)("span",{style:{display:"inline-block",marginLeft:"8px",fontSize:"12px",color:"#856404",backgroundColor:"#fff3cd",padding:"2px 6px",borderRadius:"12px",boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},children:"Alta prioridad"})]}),(0,c.jsx)("td",{style:{border:"1px solid #ddd",padding:"12px 15px"},children:i}),(0,c.jsx)("td",{style:{border:"1px solid #ddd",padding:"12px 15px"},children:(0,c.jsx)("ol",{style:{margin:"0",paddingLeft:"20px"},children:Array.isArray((null===e||void 0===e?void 0:e.centrosIds)||(null===e||void 0===e?void 0:e.centrosSeleccionados))?((null===e||void 0===e?void 0:e.centrosIds)||(null===e||void 0===e?void 0:e.centrosSeleccionados)||[]).map(((e,t)=>{const n=e&&a&&Array.isArray(a)?a.find((t=>t&&t.id===e)):null,r=o&&o.id===e;return(0,c.jsx)("li",{style:{marginBottom:"8px",backgroundColor:r?"#f1f8e9":"transparent",padding:r?"4px 8px":"0",borderRadius:r?"4px":"0",border:r?"1px solid #c8e6c9":"none"},children:n?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("strong",{style:{color:0===t?"#d35400":"inherit"},children:n.nombre||n.nombreCentro||n.centro}),(0,c.jsxs)("div",{className:"centro-localidad",children:[n.localidad&&`- ${n.localidad}`,n.municipio&&n.municipio!==n.localidad&&(0,c.jsxs)("span",{style:{marginLeft:"5px",color:"#4a5568",fontSize:"13px"},children:[(0,c.jsx)("span",{style:{marginRight:"4px"},children:"\ud83d\udccd"}),n.municipio]})]}),0===t&&(0,c.jsx)("span",{style:{display:"inline-block",marginLeft:"8px",fontSize:"12px",color:"#d35400",backgroundColor:"#fff3cd",padding:"1px 5px",borderRadius:"10px",fontWeight:"bold"},children:"1\xaa opci\xf3n"}),n.plazas&&void 0!==n.asignadas&&n.plazas-n.asignadas<=0&&!r&&(0,c.jsx)("span",{style:{color:"#e74c3c",marginLeft:"10px",fontSize:"12px",fontWeight:"bold",backgroundColor:"#ffebee",padding:"1px 6px",borderRadius:"10px"},children:"Completo"}),r&&(0,c.jsx)("span",{style:{color:"#2E7D32",marginLeft:"10px",fontSize:"12px",fontWeight:"bold",backgroundColor:"#e8f5e9",padding:"1px 6px",borderRadius:"10px"},children:"\u2713 Asignado"})]}):(0,c.jsx)("span",{style:{color:"#999"},children:e})},t)})):(0,c.jsx)("li",{children:"No hay centros seleccionados"})})}),(0,c.jsx)("td",{style:{border:"1px solid #ddd",padding:"12px 15px",textAlign:"center"},children:s?(0,c.jsx)("div",{style:{backgroundColor:"#e8f5e9",color:"#2E7D32",padding:"8px 12px",borderRadius:"6px",fontSize:"14px",fontWeight:"bold",border:"1px solid #c8e6c9",display:"inline-block"},children:"\u2713 Asignado"}):(0,c.jsx)("div",{style:{backgroundColor:"#fff7e6",color:"#f39c12",padding:"8px 12px",borderRadius:"6px",fontSize:"14px",fontWeight:"bold",border:"1px solid #ffeeba",display:"inline-block"},children:"Pendiente"})})]},t)})),0===S.length&&(0,c.jsx)("tr",{children:(0,c.jsx)("td",{colSpan:"4",style:{textAlign:"center",padding:"30px",color:"#666"},children:u?`No se encontraron solicitudes que coincidan con "${u}"`:"No hay solicitudes pendientes para mostrar"})})]})]})}),b.length>o&&(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"center",marginTop:"20px",gap:"5px",flexWrap:"wrap"},children:[(0,c.jsx)("button",{onClick:()=>I(i-1),disabled:1===i,style:{padding:"8px 12px",backgroundColor:1===i?"#f1f1f1":"white",border:"1px solid #ddd",borderRadius:"4px",cursor:1===i?"not-allowed":"pointer"},children:"\xab Anterior"}),Array.from({length:Math.min(5,x)},((e,t)=>{let n;return n=x<=5||i<=3?t+1:i>=x-2?x-4+t:i-2+t,(0,c.jsx)("button",{onClick:()=>I(n),style:{padding:"8px 12px",backgroundColor:i===n?"#e67e22":"white",color:i===n?"white":"#333",border:"1px solid #ddd",borderRadius:"4px",cursor:"pointer"},children:n},n)})),(0,c.jsx)("button",{onClick:()=>I(i+1),disabled:i===x,style:{padding:"8px 12px",backgroundColor:i===x?"#f1f1f1":"white",border:"1px solid #ddd",borderRadius:"4px",cursor:i===x?"not-allowed":"pointer"},children:"Siguiente \xbb"})]})]}):(0,c.jsxs)("div",{style:{textAlign:"center",padding:"40px 20px",backgroundColor:"#f5f7fa",borderRadius:"8px",color:"#5c6c7c"},children:[(0,c.jsx)("div",{style:{fontSize:"36px",marginBottom:"15px"},children:"\ud83d\udcdd"}),(0,c.jsx)("div",{style:{fontSize:"18px",fontWeight:"bold",marginBottom:"10px"},children:"No hay solicitudes pendientes"}),(0,c.jsx)("div",{style:{fontSize:"14px"},children:'Las solicitudes aparecer\xe1n aqu\xed cuando se env\xeden desde la pesta\xf1a "Plazas Disponibles"'})]})};const h=function(){return(0,c.jsx)("footer",{style:{marginTop:"60px",padding:"20px 15px",borderTop:"1px solid #ddd",backgroundColor:"#f8f9fa",textAlign:"center",color:"#333",fontSize:"14px",width:"100%",position:"relative",display:"block"},children:(0,c.jsxs)("div",{style:{maxWidth:"1280px",margin:"0 auto"},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"15px"},children:[(0,c.jsxs)("p",{style:{margin:"10px 0"},children:["Realizado por ",(0,c.jsx)("a",{href:"https://ag-marketing.es",target:"_blank",rel:"noopener noreferrer",style:{color:"#18539E",textDecoration:"none",fontWeight:"bold"},children:"AG-Marketing"})]}),(0,c.jsx)("img",{src:"/asignacion-plazas/AG_LOGO.png",alt:"AG-Marketing",style:{width:"120px",height:"auto",objectFit:"contain",maxHeight:"50px"}})]}),(0,c.jsxs)("p",{style:{margin:"10px 0"},children:["\xa9 ",(new Date).getFullYear()," - Todos los derechos reservados"]})]})})};var f={version:"0.18.5"},p=1200,g=1252,m=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],v={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},y=function(e){-1!=m.indexOf(e)&&(g=v[0]=e)};var b=function(e){p=e,y(e)};function w(){b(1200),y(1252)}function x(e){for(var t=[],n=0,r=e.length;n<r;++n)t[n]=e.charCodeAt(n);return t}function E(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n+1)+(e.charCodeAt(2*n)<<8));return t.join("")}var T,S=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1);return 255==t&&254==n?function(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n)+(e.charCodeAt(2*n+1)<<8));return t.join("")}(e.slice(2)):254==t&&255==n?E(e.slice(2)):65279==t?e.slice(1):e},I=function(e){return String.fromCharCode(e)},k=function(e){return String.fromCharCode(e)};var C="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function _(e){for(var t="",n=0,r=0,a=0,i=0,s=0,o=0,c=0,l=0;l<e.length;)i=(n=e.charCodeAt(l++))>>2,s=(3&n)<<4|(r=e.charCodeAt(l++))>>4,o=(15&r)<<2|(a=e.charCodeAt(l++))>>6,c=63&a,isNaN(r)?o=c=64:isNaN(a)&&(c=64),t+=C.charAt(i)+C.charAt(s)+C.charAt(o)+C.charAt(c);return t}function A(e){var t="",n=0,r=0,a=0,i=0,s=0,o=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)n=C.indexOf(e.charAt(c++))<<2|(i=C.indexOf(e.charAt(c++)))>>4,t+=String.fromCharCode(n),r=(15&i)<<4|(s=C.indexOf(e.charAt(c++)))>>2,64!==s&&(t+=String.fromCharCode(r)),a=(3&s)<<6|(o=C.indexOf(e.charAt(c++))),64!==o&&(t+=String.fromCharCode(a));return t}var N=function(){return"undefined"!==typeof Buffer&&"undefined"!==typeof process&&"undefined"!==typeof process.versions&&!!process.versions.node}(),R=function(){if("undefined"!==typeof Buffer){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch(t){e=!0}return e?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function O(e){return N?Buffer.alloc?Buffer.alloc(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}function D(e){return N?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}var P=function(e){return N?R(e,"binary"):e.split("").map((function(e){return 255&e.charCodeAt(0)}))};function L(e){if(Array.isArray(e))return e.map((function(e){return String.fromCharCode(e)})).join("");for(var t=[],n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function M(e){if("undefined"==typeof ArrayBuffer)throw new Error("Unsupported");if(e instanceof ArrayBuffer)return M(new Uint8Array(e));for(var t=new Array(e.length),n=0;n<e.length;++n)t[n]=e[n];return t}var F=N?function(e){return Buffer.concat(e.map((function(e){return Buffer.isBuffer(e)?e:R(e)})))}:function(e){if("undefined"!==typeof Uint8Array){var t=0,n=0;for(t=0;t<e.length;++t)n+=e[t].length;var r=new Uint8Array(n),a=0;for(t=0,n=0;t<e.length;n+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)r.set(e[t],n);else{if("string"==typeof e[t])throw"wtf";r.set(new Uint8Array(e[t]),n)}return r}return[].concat.apply([],e.map((function(e){return Array.isArray(e)?e:[].slice.call(e)})))};var z=/\u0000/g,j=/[\u0001-\u0006]/g;function U(e){for(var t="",n=e.length-1;n>=0;)t+=e.charAt(n--);return t}function B(e,t){var n=""+e;return n.length>=t?n:Xe("0",t-n.length)+n}function V(e,t){var n=""+e;return n.length>=t?n:Xe(" ",t-n.length)+n}function H(e,t){var n=""+e;return n.length>=t?n:n+Xe(" ",t-n.length)}var G=Math.pow(2,32);function W(e,t){return e>G||e<-G?function(e,t){var n=""+Math.round(e);return n.length>=t?n:Xe("0",t-n.length)+n}(e,t):function(e,t){var n=""+e;return n.length>=t?n:Xe("0",t-n.length)+n}(Math.round(e),t)}function K(e,t){return t=t||0,e.length>=7+t&&103===(32|e.charCodeAt(t))&&101===(32|e.charCodeAt(t+1))&&110===(32|e.charCodeAt(t+2))&&101===(32|e.charCodeAt(t+3))&&114===(32|e.charCodeAt(t+4))&&97===(32|e.charCodeAt(t+5))&&108===(32|e.charCodeAt(t+6))}var q=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Y=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];var Q={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "'},X={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},J={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Z(e,t,n){for(var r=e<0?-1:1,a=e*r,i=0,s=1,o=0,c=1,l=0,u=0,d=Math.floor(a);l<t&&(o=(d=Math.floor(a))*s+i,u=d*l+c,!(a-d<5e-8));)a=1/(a-d),i=s,s=o,c=l,l=u;if(u>t&&(l>t?(u=c,o=i):(u=l,o=s)),!n)return[0,r*o,u];var h=Math.floor(r*o/u);return[h,r*o-h*u,u]}function ee(e,t,n){if(e>2958465||e<0)return null;var r=0|e,a=Math.floor(86400*(e-r)),i=0,s=[],o={D:r,T:a,u:86400*(e-r)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(r+=1462),o.u>.9999&&(o.u=0,86400==++a&&(o.T=a=0,++r,++o.D)),60===r)s=n?[1317,10,29]:[1900,2,29],i=3;else if(0===r)s=n?[1317,8,29]:[1900,1,0],i=6;else{r>60&&--r;var c=new Date(1900,0,1);c.setDate(c.getDate()+r-1),s=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),r<60&&(i=(i+6)%7),n&&(i=function(e,t){t[0]-=581;var n=e.getDay();e<60&&(n=(n+6)%7);return n}(c,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=i,o}var te=new Date(1899,11,31,0,0,0),ne=te.getTime(),re=new Date(1900,2,1,0,0,0);function ae(e,t){var n=e.getTime();return t?n-=1262304e5:e>=re&&(n+=864e5),(n-(ne+6e4*(e.getTimezoneOffset()-te.getTimezoneOffset())))/864e5}function ie(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function se(e){var t,n=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return t=n>=-4&&n<=-1?e.toPrecision(10+n):Math.abs(n)<=9?function(e){var t=e<0?12:11,n=ie(e.toFixed(12));return n.length<=t||(n=e.toPrecision(10)).length<=t?n:e.toExponential(5)}(e):10===n?e.toFixed(10).substr(0,12):function(e){var t=ie(e.toFixed(11));return t.length>(e<0?12:11)||"0"===t||"-0"===t?e.toPrecision(6):t}(e),ie(function(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(t.toUpperCase()))}function oe(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):se(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return _e(14,ae(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function ce(e,t,n,r){var a,i="",s=0,o=0,c=n.y,l=0;switch(e){case 98:c=n.y+543;case 121:switch(t.length){case 1:case 2:a=c%100,l=2;break;default:a=c%1e4,l=4}break;case 109:switch(t.length){case 1:case 2:a=n.m,l=t.length;break;case 3:return Y[n.m-1][1];case 5:return Y[n.m-1][0];default:return Y[n.m-1][2]}break;case 100:switch(t.length){case 1:case 2:a=n.d,l=t.length;break;case 3:return q[n.q][0];default:return q[n.q][1]}break;case 104:switch(t.length){case 1:case 2:a=1+(n.H+11)%12,l=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:a=n.H,l=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:a=n.M,l=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==n.u||"s"!=t&&"ss"!=t?(o=r>=2?3===r?1e3:100:1===r?10:1,(s=Math.round(o*(n.S+n.u)))>=60*o&&(s=0),"s"===t?0===s?"0":""+s/o:(i=B(s,2+r),"ss"===t?i.substr(0,2):"."+i.substr(2,t.length-1))):B(n.S,t.length);case 90:switch(t){case"[h]":case"[hh]":a=24*n.D+n.H;break;case"[m]":case"[mm]":a=60*(24*n.D+n.H)+n.M;break;case"[s]":case"[ss]":a=60*(60*(24*n.D+n.H)+n.M)+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+t}l=3===t.length?1:2;break;case 101:a=c,l=1}return l>0?B(a,l):""}function le(e){if(e.length<=3)return e;for(var t=e.length%3,n=e.substr(0,t);t!=e.length;t+=3)n+=(n.length>0?",":"")+e.substr(t,3);return n}var ue=/%/g;function de(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+de(e,-t);var a=e.indexOf(".");-1===a&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),-1===(n=(t/Math.pow(10,i)).toPrecision(r+1+(a+i)%a)).indexOf("e")){var s=Math.floor(Math.log(t)*Math.LOG10E);for(-1===n.indexOf(".")?n=n.charAt(0)+"."+n.substr(1)+"E+"+(s-n.length+i):n+="E+"+(s-i);"0."===n.substr(0,2);)n=(n=n.charAt(0)+n.substr(2,a)+"."+n.substr(2+a)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,n,r){return t+n+r.substr(0,(a+i)%a)+"."+r.substr(i)+"E"}))}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var he=/# (\?+)( ?)\/( ?)(\d+)/;var fe=/^#*0*\.([0#]+)/,pe=/\).*[0#]/,ge=/\(###\) ###\\?-####/;function me(e){for(var t,n="",r=0;r!=e.length;++r)switch(t=e.charCodeAt(r)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(t)}return n}function ve(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n}function ye(e,t){var n=e-Math.floor(e),r=Math.pow(10,t);return t<(""+Math.round(n*r)).length?0:Math.round(n*r)}function be(e,t,n){if(40===e.charCodeAt(0)&&!t.match(pe)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?be("n",r,n):"("+be("n",r,-n)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,n){for(var r=t.length-1;44===t.charCodeAt(r-1);)--r;return Ee(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}(e,t,n);if(-1!==t.indexOf("%"))return function(e,t,n){var r=t.replace(ue,""),a=t.length-r.length;return Ee(e,r,n*Math.pow(10,2*a))+Xe("%",a)}(e,t,n);if(-1!==t.indexOf("E"))return de(t,n);if(36===t.charCodeAt(0))return"$"+be(e,t.substr(" "==t.charAt(1)?2:1),n);var a,i,s,o,c=Math.abs(n),l=n<0?"-":"";if(t.match(/^00+$/))return l+W(c,t.length);if(t.match(/^[#?]+$/))return"0"===(a=W(n,0))&&(a=""),a.length>t.length?a:me(t.substr(0,t.length-a.length))+a;if(i=t.match(he))return function(e,t,n){var r=parseInt(e[4],10),a=Math.round(t*r),i=Math.floor(a/r),s=a-i*r,o=r;return n+(0===i?"":""+i)+" "+(0===s?Xe(" ",e[1].length+1+e[4].length):V(s,e[1].length)+e[2]+"/"+e[3]+B(o,e[4].length))}(i,c,l);if(t.match(/^#+0+$/))return l+W(c,t.length-t.indexOf("0"));if(i=t.match(fe))return a=ve(n,i[1].length).replace(/^([^\.]+)$/,"$1."+me(i[1])).replace(/\.$/,"."+me(i[1])).replace(/\.(\d*)$/,(function(e,t){return"."+t+Xe("0",me(i[1]).length-t.length)})),-1!==t.indexOf("0.")?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return l+ve(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return l+le(W(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+be(e,t,-n):le(""+(Math.floor(n)+function(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(n,i[1].length)))+"."+B(ye(n,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return be(e,t.replace(/^#,#*,/,""),n);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=U(be(e,t.replace(/[\\-]/g,""),n)),s=0,U(U(t.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return s<a.length?a.charAt(s++):"0"===e?"0":""})));if(t.match(ge))return"("+(a=be(e,"##########",n)).substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=Z(c,Math.pow(10,s)-1,!1),a=""+l," "==(u=Ee("n",i[1],o[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),a+=u+i[2]+"/"+i[3],(u=H(o[2],s)).length<i[4].length&&(u=me(i[4].substr(i[4].length-u.length))+u),a+=u;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),l+((o=Z(c,Math.pow(10,s)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?V(o[1],s)+i[2]+"/"+i[3]+H(o[2],s):Xe(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=W(n,0),t.length<=a.length?a:me(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+n.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var d=t.indexOf(".")-s,h=t.length-a.length-d;return me(t.substr(0,d)+a+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return s=ye(n,i[1].length),n<0?"-"+be(e,t,-n):le(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?B(0,3-e.length):"")+e}))+"."+B(s,i[1].length);switch(t){case"###,##0.00":return be(e,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var f=le(W(c,0));return"0"!==f?l+f:"";case"###,###.00":return be(e,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return be(e,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function we(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+we(e,-t);var a=e.indexOf(".");-1===a&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),!(n=(t/Math.pow(10,i)).toPrecision(r+1+(a+i)%a)).match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);-1===n.indexOf(".")?n=n.charAt(0)+"."+n.substr(1)+"E+"+(s-n.length+i):n+="E+"+(s-i),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,n,r){return t+n+r.substr(0,(a+i)%a)+"."+r.substr(i)+"E"}))}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function xe(e,t,n){if(40===e.charCodeAt(0)&&!t.match(pe)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?xe("n",r,n):"("+xe("n",r,-n)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,n){for(var r=t.length-1;44===t.charCodeAt(r-1);)--r;return Ee(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}(e,t,n);if(-1!==t.indexOf("%"))return function(e,t,n){var r=t.replace(ue,""),a=t.length-r.length;return Ee(e,r,n*Math.pow(10,2*a))+Xe("%",a)}(e,t,n);if(-1!==t.indexOf("E"))return we(t,n);if(36===t.charCodeAt(0))return"$"+xe(e,t.substr(" "==t.charAt(1)?2:1),n);var a,i,s,o,c=Math.abs(n),l=n<0?"-":"";if(t.match(/^00+$/))return l+B(c,t.length);if(t.match(/^[#?]+$/))return a=""+n,0===n&&(a=""),a.length>t.length?a:me(t.substr(0,t.length-a.length))+a;if(i=t.match(he))return function(e,t,n){return n+(0===t?"":""+t)+Xe(" ",e[1].length+2+e[4].length)}(i,c,l);if(t.match(/^#+0+$/))return l+B(c,t.length-t.indexOf("0"));if(i=t.match(fe))return a=(a=(""+n).replace(/^([^\.]+)$/,"$1."+me(i[1])).replace(/\.$/,"."+me(i[1]))).replace(/\.(\d*)$/,(function(e,t){return"."+t+Xe("0",me(i[1]).length-t.length)})),-1!==t.indexOf("0.")?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return l+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return l+le(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+xe(e,t,-n):le(""+n)+"."+Xe("0",i[1].length);if(i=t.match(/^#,#*,#0/))return xe(e,t.replace(/^#,#*,/,""),n);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=U(xe(e,t.replace(/[\\-]/g,""),n)),s=0,U(U(t.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return s<a.length?a.charAt(s++):"0"===e?"0":""})));if(t.match(ge))return"("+(a=xe(e,"##########",n)).substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=Z(c,Math.pow(10,s)-1,!1),a=""+l," "==(u=Ee("n",i[1],o[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),a+=u+i[2]+"/"+i[3],(u=H(o[2],s)).length<i[4].length&&(u=me(i[4].substr(i[4].length-u.length))+u),a+=u;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),l+((o=Z(c,Math.pow(10,s)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?V(o[1],s)+i[2]+"/"+i[3]+H(o[2],s):Xe(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+n,t.length<=a.length?a:me(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+n.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var d=t.indexOf(".")-s,h=t.length-a.length-d;return me(t.substr(0,d)+a+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return n<0?"-"+xe(e,t,-n):le(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?B(0,3-e.length):"")+e}))+"."+B(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var f=le(""+c);return"0"!==f?l+f:"";default:if(t.match(/\.[0#?]*$/))return xe(e,t.slice(0,t.lastIndexOf(".")),n)+me(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Ee(e,t,n){return(0|n)===n?xe(e,t,n):be(e,t,n)}var Te=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Se(e){for(var t=0,n="",r="";t<e.length;)switch(n=e.charAt(t)){case"G":K(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4e0a":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;if("\u4e0a\u5348/\u4e0b\u5348"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(r=n;"]"!==e.charAt(t++)&&t<e.length;)r+=e.charAt(t);if(r.match(Te))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(n=e.charAt(++t))>-1||"\\"==n&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===n;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;default:++t}return!1}var Ie=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function ke(e,t){if(null==t)return!1;var n=parseFloat(t[2]);switch(t[1]){case"=":if(e==n)return!0;break;case">":if(e>n)return!0;break;case"<":if(e<n)return!0;break;case"<>":if(e!=n)return!0;break;case">=":if(e>=n)return!0;break;case"<=":if(e<=n)return!0}return!1}function Ce(e,t){var n=function(e){for(var t=[],n=!1,r=0,a=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:n=!n;break;case 95:case 42:case 92:++r;break;case 59:t[t.length]=e.substr(a,r-a),a=r+1}if(t[t.length]=e.substr(a),!0===n)throw new Error("Format |"+e+"| unterminated string ");return t}(e),r=n.length,a=n[r-1].indexOf("@");if(r<4&&a>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if("number"!==typeof t)return[4,4===n.length||a>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=a>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=a>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=a>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"]}var i=t>0?n[0]:t<0?n[1]:n[2];if(-1===n[0].indexOf("[")&&-1===n[1].indexOf("["))return[r,i];if(null!=n[0].match(/\[[=<>]/)||null!=n[1].match(/\[[=<>]/)){var s=n[0].match(Ie),o=n[1].match(Ie);return ke(t,s)?[r,n[0]]:ke(t,o)?[r,n[1]]:[r,n[null!=s&&null!=o?2:1]]}return[r,i]}function _e(e,t,n){null==n&&(n={});var r="";switch(typeof e){case"string":r="m/d/yy"==e&&n.dateNF?n.dateNF:e;break;case"number":null==(r=14==e&&n.dateNF?n.dateNF:(null!=n.table?n.table:Q)[e])&&(r=n.table&&n.table[X[e]]||Q[X[e]]),null==r&&(r=J[e]||"General")}if(K(r,0))return oe(t,n);t instanceof Date&&(t=ae(t,n.date1904));var a=Ce(r,t);if(K(a[1]))return oe(t,n);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return function(e,t,n,r){for(var a,i,s,o=[],c="",l=0,u="",d="t",h="H";l<e.length;)switch(u=e.charAt(l)){case"G":if(!K(e,l))throw new Error("unrecognized character "+u+" in "+e);o[o.length]={t:"G",v:"General"},l+=7;break;case'"':for(c="";34!==(s=e.charCodeAt(++l))&&l<e.length;)c+=String.fromCharCode(s);o[o.length]={t:"t",v:c},++l;break;case"\\":var f=e.charAt(++l),p="("===f||")"===f?f:"t";o[o.length]={t:p,v:f},++l;break;case"_":o[o.length]={t:"t",v:" "},l+=2;break;case"@":o[o.length]={t:"T",v:t},++l;break;case"B":case"b":if("1"===e.charAt(l+1)||"2"===e.charAt(l+1)){if(null==a&&null==(a=ee(t,n,"2"===e.charAt(l+1))))return"";o[o.length]={t:"X",v:e.substr(l,2)},d=u,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==a&&null==(a=ee(t,n)))return"";for(c=u;++l<e.length&&e.charAt(l).toLowerCase()===u;)c+=u;"m"===u&&"h"===d.toLowerCase()&&(u="M"),"h"===u&&(u=h),o[o.length]={t:u,v:c},d=u;break;case"A":case"a":case"\u4e0a":var g={t:u,v:u};if(null==a&&(a=ee(t,n)),"A/P"===e.substr(l,3).toUpperCase()?(null!=a&&(g.v=a.H>=12?"P":"A"),g.t="T",h="h",l+=3):"AM/PM"===e.substr(l,5).toUpperCase()?(null!=a&&(g.v=a.H>=12?"PM":"AM"),g.t="T",l+=5,h="h"):"\u4e0a\u5348/\u4e0b\u5348"===e.substr(l,5).toUpperCase()?(null!=a&&(g.v=a.H>=12?"\u4e0b\u5348":"\u4e0a\u5348"),g.t="T",l+=5,h="h"):(g.t="t",++l),null==a&&"T"===g.t)return"";o[o.length]=g,d=u;break;case"[":for(c=u;"]"!==e.charAt(l++)&&l<e.length;)c+=e.charAt(l);if("]"!==c.slice(-1))throw'unterminated "[" block: |'+c+"|";if(c.match(Te)){if(null==a&&null==(a=ee(t,n)))return"";o[o.length]={t:"Z",v:c.toLowerCase()},d=c.charAt(1)}else c.indexOf("$")>-1&&(c=(c.match(/\$([^-\[\]]*)/)||[])[1]||"$",Se(e)||(o[o.length]={t:"t",v:c}));break;case".":if(null!=a){for(c=u;++l<e.length&&"0"===(u=e.charAt(l));)c+=u;o[o.length]={t:"s",v:c};break}case"0":case"#":for(c=u;++l<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(l))>-1;)c+=u;o[o.length]={t:"n",v:c};break;case"?":for(c=u;e.charAt(++l)===u;)c+=u;o[o.length]={t:u,v:c},d=u;break;case"*":++l," "!=e.charAt(l)&&"*"!=e.charAt(l)||++l;break;case"(":case")":o[o.length]={t:1===r?"t":u,v:u},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(c=u;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)c+=e.charAt(l);o[o.length]={t:"D",v:c};break;case" ":o[o.length]={t:u,v:u},++l;break;case"$":o[o.length]={t:"t",v:"$"},++l;break;default:if(-1===",$-+/():!^&'~{}<>=\u20acacfijklopqrtuvwxzP".indexOf(u))throw new Error("unrecognized character "+u+" in "+e);o[o.length]={t:"t",v:u},++l}var m,v=0,y=0;for(l=o.length-1,d="t";l>=0;--l)switch(o[l].t){case"h":case"H":o[l].t=h,d="h",v<1&&(v=1);break;case"s":(m=o[l].v.match(/\.0+$/))&&(y=Math.max(y,m[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":d=o[l].t;break;case"m":"s"===d&&(o[l].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&o[l].v.match(/[Hh]/)&&(v=1),v<2&&o[l].v.match(/[Mm]/)&&(v=2),v<3&&o[l].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:a.u>=.5&&(a.u=0,++a.S),a.S>=60&&(a.S=0,++a.M),a.M>=60&&(a.M=0,++a.H);break;case 2:a.u>=.5&&(a.u=0,++a.S),a.S>=60&&(a.S=0,++a.M)}var b,w="";for(l=0;l<o.length;++l)switch(o[l].t){case"t":case"T":case" ":case"D":break;case"X":o[l].v="",o[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":o[l].v=ce(o[l].t.charCodeAt(0),o[l].v,a,y),o[l].t="t";break;case"n":case"?":for(b=l+1;null!=o[b]&&("?"===(u=o[b].t)||"D"===u||(" "===u||"t"===u)&&null!=o[b+1]&&("?"===o[b+1].t||"t"===o[b+1].t&&"/"===o[b+1].v)||"("===o[l].t&&(" "===u||"n"===u||")"===u)||"t"===u&&("/"===o[b].v||" "===o[b].v&&null!=o[b+1]&&"?"==o[b+1].t));)o[l].v+=o[b].v,o[b]={v:"",t:";"},++b;w+=o[l].v,l=b-1;break;case"G":o[l].t="t",o[l].v=oe(t,n)}var x,E,T="";if(w.length>0){40==w.charCodeAt(0)?(x=t<0&&45===w.charCodeAt(0)?-t:t,E=Ee("n",w,x)):(E=Ee("n",w,x=t<0&&r>1?-t:t),x<0&&o[0]&&"t"==o[0].t&&(E=E.substr(1),o[0].v="-"+o[0].v)),b=E.length-1;var S=o.length;for(l=0;l<o.length;++l)if(null!=o[l]&&"t"!=o[l].t&&o[l].v.indexOf(".")>-1){S=l;break}var I=o.length;if(S===o.length&&-1===E.indexOf("E")){for(l=o.length-1;l>=0;--l)null!=o[l]&&-1!=="n?".indexOf(o[l].t)&&(b>=o[l].v.length-1?(b-=o[l].v.length,o[l].v=E.substr(b+1,o[l].v.length)):b<0?o[l].v="":(o[l].v=E.substr(0,b+1),b=-1),o[l].t="t",I=l);b>=0&&I<o.length&&(o[I].v=E.substr(0,b+1)+o[I].v)}else if(S!==o.length&&-1===E.indexOf("E")){for(b=E.indexOf(".")-1,l=S;l>=0;--l)if(null!=o[l]&&-1!=="n?".indexOf(o[l].t)){for(i=o[l].v.indexOf(".")>-1&&l===S?o[l].v.indexOf(".")-1:o[l].v.length-1,T=o[l].v.substr(i+1);i>=0;--i)b>=0&&("0"===o[l].v.charAt(i)||"#"===o[l].v.charAt(i))&&(T=E.charAt(b--)+T);o[l].v=T,o[l].t="t",I=l}for(b>=0&&I<o.length&&(o[I].v=E.substr(0,b+1)+o[I].v),b=E.indexOf(".")+1,l=S;l<o.length;++l)if(null!=o[l]&&(-1!=="n?(".indexOf(o[l].t)||l===S)){for(i=o[l].v.indexOf(".")>-1&&l===S?o[l].v.indexOf(".")+1:0,T=o[l].v.substr(0,i);i<o[l].v.length;++i)b<E.length&&(T+=E.charAt(b++));o[l].v=T,o[l].t="t",I=l}}}for(l=0;l<o.length;++l)null!=o[l]&&"n?".indexOf(o[l].t)>-1&&(x=r>1&&t<0&&l>0&&"-"===o[l-1].v?-t:t,o[l].v=Ee(o[l].t,o[l].v,x),o[l].t="t");var k="";for(l=0;l!==o.length;++l)null!=o[l]&&(k+=o[l].v);return k}(a[1],t,n,a[0])}function Ae(e,t){if("number"!=typeof t){t=+t||-1;for(var n=0;n<392;++n)if(void 0!=Q[n]){if(Q[n]==e){t=n;break}}else t<0&&(t=n);t<0&&(t=391)}return Q[t]=e,t}function Ne(){var e;e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "',Q=e}var Re={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Oe=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;var De=function(){var e={};e.version="1.2.0";var t=function(){for(var e=0,t=new Array(256),n=0;256!=n;++n)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=n)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[n]=e;return"undefined"!==typeof Int32Array?new Int32Array(t):t}();var n=function(e){var t=0,n=0,r=0,a="undefined"!==typeof Int32Array?new Int32Array(4096):new Array(4096);for(r=0;256!=r;++r)a[r]=e[r];for(r=0;256!=r;++r)for(n=e[r],t=256+r;t<4096;t+=256)n=a[t]=n>>>8^e[255&n];var i=[];for(r=1;16!=r;++r)i[r-1]="undefined"!==typeof Int32Array?a.subarray(256*r,256*r+256):a.slice(256*r,256*r+256);return i}(t),r=n[0],a=n[1],i=n[2],s=n[3],o=n[4],c=n[5],l=n[6],u=n[7],d=n[8],h=n[9],f=n[10],p=n[11],g=n[12],m=n[13],v=n[14];return e.table=t,e.bstr=function(e,n){for(var r=~n,a=0,i=e.length;a<i;)r=r>>>8^t[255&(r^e.charCodeAt(a++))];return~r},e.buf=function(e,n){for(var y=~n,b=e.length-15,w=0;w<b;)y=v[e[w++]^255&y]^m[e[w++]^y>>8&255]^g[e[w++]^y>>16&255]^p[e[w++]^y>>>24]^f[e[w++]]^h[e[w++]]^d[e[w++]]^u[e[w++]]^l[e[w++]]^c[e[w++]]^o[e[w++]]^s[e[w++]]^i[e[w++]]^a[e[w++]]^r[e[w++]]^t[e[w++]];for(b+=15;w<b;)y=y>>>8^t[255&(y^e[w++])];return~y},e.str=function(e,n){for(var r=~n,a=0,i=e.length,s=0,o=0;a<i;)(s=e.charCodeAt(a++))<128?r=r>>>8^t[255&(r^s)]:s<2048?r=(r=r>>>8^t[255&(r^(192|s>>6&31))])>>>8^t[255&(r^(128|63&s))]:s>=55296&&s<57344?(s=64+(1023&s),o=1023&e.charCodeAt(a++),r=(r=(r=(r=r>>>8^t[255&(r^(240|s>>8&7))])>>>8^t[255&(r^(128|s>>2&63))])>>>8^t[255&(r^(128|o>>6&15|(3&s)<<4))])>>>8^t[255&(r^(128|63&o))]):r=(r=(r=r>>>8^t[255&(r^(224|s>>12&15))])>>>8^t[255&(r^(128|s>>6&63))])>>>8^t[255&(r^(128|63&s))];return~r},e}(),Pe=function(){var e,t={};function n(e){if("/"==e.charAt(e.length-1))return-1===e.slice(0,-1).indexOf("/")?e:n(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(0,t+1)}function r(e){if("/"==e.charAt(e.length-1))return r(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(t+1)}function a(e,t){"string"===typeof t&&(t=new Date(t));var n=t.getHours();n=(n=n<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e.write_shift(2,n);var r=t.getFullYear()-1980;r=(r=r<<4|t.getMonth()+1)<<5|t.getDate(),e.write_shift(2,r)}function i(e){An(e,0);for(var t={},n=0;e.l<=e.length-4;){var r=e.read_shift(2),a=e.read_shift(2),i=e.l+a,s={};if(21589===r)1&(n=e.read_shift(1))&&(s.mtime=e.read_shift(4)),a>5&&(2&n&&(s.atime=e.read_shift(4)),4&n&&(s.ctime=e.read_shift(4))),s.mtime&&(s.mt=new Date(1e3*s.mtime));e.l=i,t[r]=s}return t}function s(){return e||(e={})}function o(e,t){if(80==e[0]&&75==e[1])return fe(e,t);if(109==(32|e[0])&&105==(32|e[1]))return function(e,t){if("mime-version:"!=E(e.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var n=t&&t.root||"",r=(N&&Buffer.isBuffer(e)?e.toString("binary"):E(e)).split("\r\n"),a=0,i="";for(a=0;a<r.length;++a)if(i=r[a],/^Content-Location:/i.test(i)&&(i=i.slice(i.indexOf("file")),n||(n=i.slice(0,i.lastIndexOf("/")+1)),i.slice(0,n.length)!=n))for(;n.length>0&&(n=(n=n.slice(0,n.length-1)).slice(0,n.lastIndexOf("/")+1),i.slice(0,n.length)!=n););var s=(r[1]||"").match(/boundary="(.*?)"/);if(!s)throw new Error("MAD cannot find boundary");var o="--"+(s[1]||""),c=[],l=[],u={FileIndex:c,FullPaths:l};h(u);var d,f=0;for(a=0;a<r.length;++a){var p=r[a];p!==o&&p!==o+"--"||(f++&&be(u,r.slice(d,a),n),d=a)}return u}(e,t);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var n,r,a,i,s,o,f=512,p=[],g=e.slice(0,512);An(g,0);var m=function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(y,"Header Signature: "),e.l+=16;var t=e.read_shift(2,"u");return[e.read_shift(2,"u"),t]}(g);switch(n=m[0]){case 3:f=512;break;case 4:f=4096;break;case 0:if(0==m[1])return fe(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+n)}512!==f&&An(g=e.slice(0,f),28);var b=e.slice(0,f);!function(e,t){var n=9;switch(e.l+=2,n=e.read_shift(2)){case 9:if(3!=t)throw new Error("Sector Shift: Expected 9 saw "+n);break;case 12:if(4!=t)throw new Error("Sector Shift: Expected 12 saw "+n);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+n)}e.chk("0600","Mini Sector Shift: "),e.chk("000000000000","Reserved: ")}(g,n);var w=g.read_shift(4,"i");if(3===n&&0!==w)throw new Error("# Directory Sectors: Expected 0 saw "+w);g.l+=4,i=g.read_shift(4,"i"),g.l+=4,g.chk("00100000","Mini Stream Cutoff Size: "),s=g.read_shift(4,"i"),r=g.read_shift(4,"i"),o=g.read_shift(4,"i"),a=g.read_shift(4,"i");for(var x=-1,T=0;T<109&&!((x=g.read_shift(4,"i"))<0);++T)p[T]=x;var S=function(e,t){for(var n=Math.ceil(e.length/t)-1,r=[],a=1;a<n;++a)r[a-1]=e.slice(a*t,(a+1)*t);return r[n-1]=e.slice(n*t),r}(e,f);l(o,a,S,f,p);var I=function(e,t,n,r){var a=e.length,i=[],s=[],o=[],c=[],l=r-1,u=0,d=0,h=0,f=0;for(u=0;u<a;++u)if(o=[],(h=u+t)>=a&&(h-=a),!s[h]){c=[];var p=[];for(d=h;d>=0;){p[d]=!0,s[d]=!0,o[o.length]=d,c.push(e[d]);var g=n[Math.floor(4*d/r)];if(r<4+(f=4*d&l))throw new Error("FAT boundary crossed: "+d+" 4 "+r);if(!e[g])break;if(p[d=xn(e[g],f)])break}i[h]={nodes:o,data:Yt([c])}}return i}(S,i,p,f);I[i].name="!Directory",r>0&&s!==v&&(I[s].name="!MiniFAT"),I[p[0]].name="!FAT",I.fat_addrs=p,I.ssz=f;var k=[],C=[],_=[];!function(e,t,n,r,a,i,s,o){for(var l,h=0,f=r.length?2:0,p=t[e].data,g=0,m=0;g<p.length;g+=128){var y=p.slice(g,g+128);An(y,64),m=y.read_shift(2),l=Xt(y,0,m-f),r.push(l);var b={name:l,type:y.read_shift(1),color:y.read_shift(1),L:y.read_shift(4,"i"),R:y.read_shift(4,"i"),C:y.read_shift(4,"i"),clsid:y.read_shift(16),state:y.read_shift(4,"i"),start:0,size:0};0!==y.read_shift(2)+y.read_shift(2)+y.read_shift(2)+y.read_shift(2)&&(b.ct=d(y,y.l-8)),0!==y.read_shift(2)+y.read_shift(2)+y.read_shift(2)+y.read_shift(2)&&(b.mt=d(y,y.l-8)),b.start=y.read_shift(4,"i"),b.size=y.read_shift(4,"i"),b.size<0&&b.start<0&&(b.size=b.type=0,b.start=v,b.name=""),5===b.type?(h=b.start,a>0&&h!==v&&(t[h].name="!StreamData")):b.size>=4096?(b.storage="fat",void 0===t[b.start]&&(t[b.start]=u(n,b.start,t.fat_addrs,t.ssz)),t[b.start].name=b.name,b.content=t[b.start].data.slice(0,b.size)):(b.storage="minifat",b.size<0?b.size=0:h!==v&&b.start!==v&&t[h]&&(b.content=c(b,t[h].data,(t[o]||{}).data))),b.content&&An(b.content,0),i[l]=b,s.push(b)}}(i,I,S,k,r,{},C,s),function(e,t,n){for(var r=0,a=0,i=0,s=0,o=0,c=n.length,l=[],u=[];r<c;++r)l[r]=u[r]=r,t[r]=n[r];for(;o<u.length;++o)a=e[r=u[o]].L,i=e[r].R,s=e[r].C,l[r]===r&&(-1!==a&&l[a]!==a&&(l[r]=l[a]),-1!==i&&l[i]!==i&&(l[r]=l[i])),-1!==s&&(l[s]=r),-1!==a&&r!=l[r]&&(l[a]=l[r],u.lastIndexOf(a)<o&&u.push(a)),-1!==i&&r!=l[r]&&(l[i]=l[r],u.lastIndexOf(i)<o&&u.push(i));for(r=1;r<c;++r)l[r]===r&&(-1!==i&&l[i]!==i?l[r]=l[i]:-1!==a&&l[a]!==a&&(l[r]=l[a]));for(r=1;r<c;++r)if(0!==e[r].type){if((o=r)!=l[o])do{o=l[o],t[r]=t[o]+"/"+t[r]}while(0!==o&&-1!==l[o]&&o!=l[o]);l[r]=-1}for(t[0]+="/",r=1;r<c;++r)2!==e[r].type&&(t[r]+="/")}(C,_,k),k.shift();var A={FileIndex:C,FullPaths:_};return t&&t.raw&&(A.raw={header:b,sectors:S}),A}function c(e,t,n){for(var r=e.start,a=e.size,i=[],s=r;n&&a>0&&s>=0;)i.push(t.slice(s*m,s*m+m)),a-=m,s=xn(n,4*s);return 0===i.length?Rn(0):F(i).slice(0,e.size)}function l(e,t,n,r,a){var i=v;if(e===v){if(0!==t)throw new Error("DIFAT chain shorter than expected")}else if(-1!==e){var s=n[e],o=(r>>>2)-1;if(!s)return;for(var c=0;c<o&&(i=xn(s,4*c))!==v;++c)a.push(i);l(xn(s,r-4),t-1,n,r,a)}}function u(e,t,n,r,a){var i=[],s=[];a||(a=[]);var o=r-1,c=0,l=0;for(c=t;c>=0;){a[c]=!0,i[i.length]=c,s.push(e[c]);var u=n[Math.floor(4*c/r)];if(r<4+(l=4*c&o))throw new Error("FAT boundary crossed: "+c+" 4 "+r);if(!e[u])break;c=xn(e[u],l)}return{nodes:i,data:Yt([s])}}function d(e,t){return new Date(1e3*(wn(e,t+4)/1e7*Math.pow(2,32)+wn(e,t)/1e7-11644473600))}function h(e,t){var n=t||{},r=n.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=r+"/",e.FileIndex[0]={name:r,type:5}),n.CLSID&&(e.FileIndex[0].clsid=n.CLSID),function(e){var t="\x01Sh33tJ5";if(Pe.find(e,"/"+t))return;var n=Rn(4);n[0]=55,n[1]=n[3]=50,n[2]=54,e.FileIndex.push({name:t,type:2,content:n,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+t),f(e)}(e)}function f(e,t){h(e);for(var a=!1,i=!1,s=e.FullPaths.length-1;s>=0;--s){var o=e.FileIndex[s];switch(o.type){case 0:i?a=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:i=!0,isNaN(o.R*o.L*o.C)&&(a=!0),o.R>-1&&o.L>-1&&o.R==o.L&&(a=!0);break;default:a=!0}}if(a||t){var c=new Date(1987,1,19),l=0,u=Object.create?Object.create(null):{},d=[];for(s=0;s<e.FullPaths.length;++s)u[e.FullPaths[s]]=!0,0!==e.FileIndex[s].type&&d.push([e.FullPaths[s],e.FileIndex[s]]);for(s=0;s<d.length;++s){var f=n(d[s][0]);(i=u[f])||(d.push([f,{name:r(f).replace("/",""),type:1,clsid:w,ct:c,mt:c,content:null}]),u[f]=!0)}for(d.sort((function(e,t){return function(e,t){for(var n=e.split("/"),r=t.split("/"),a=0,i=0,s=Math.min(n.length,r.length);a<s;++a){if(i=n[a].length-r[a].length)return i;if(n[a]!=r[a])return n[a]<r[a]?-1:1}return n.length-r.length}(e[0],t[0])})),e.FullPaths=[],e.FileIndex=[],s=0;s<d.length;++s)e.FullPaths[s]=d[s][0],e.FileIndex[s]=d[s][1];for(s=0;s<d.length;++s){var p=e.FileIndex[s],g=e.FullPaths[s];if(p.name=r(g).replace("/",""),p.L=p.R=p.C=-(p.color=1),p.size=p.content?p.content.length:0,p.start=0,p.clsid=p.clsid||w,0===s)p.C=d.length>1?1:-1,p.size=0,p.type=5;else if("/"==g.slice(-1)){for(l=s+1;l<d.length&&n(e.FullPaths[l])!=g;++l);for(p.C=l>=d.length?-1:l,l=s+1;l<d.length&&n(e.FullPaths[l])!=n(g);++l);p.R=l>=d.length?-1:l,p.type=1}else n(e.FullPaths[s+1]||"")==n(g)&&(p.R=s+1),p.type=2}}}function p(e,t){var n=t||{};if("mad"==n.fileType)return function(e,t){for(var n=t||{},r=n.boundary||"SheetJS",a=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(r="------="+r).slice(2)+'"',"","",""],i=e.FullPaths[0],s=i,o=e.FileIndex[0],c=1;c<e.FullPaths.length;++c)if(s=e.FullPaths[c].slice(i.length),(o=e.FileIndex[c]).size&&o.content&&"\x01Sh33tJ5"!=s){s=s.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,(function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"})).replace(/[\u0080-\uFFFF]/g,(function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"}));for(var l=o.content,u=N&&Buffer.isBuffer(l)?l.toString("binary"):E(l),d=0,h=Math.min(1024,u.length),f=0,p=0;p<=h;++p)(f=u.charCodeAt(p))>=32&&f<128&&++d;var g=d>=4*h/5;a.push(r),a.push("Content-Location: "+(n.root||"file:///C:/SheetJS/")+s),a.push("Content-Transfer-Encoding: "+(g?"quoted-printable":"base64")),a.push("Content-Type: "+me(o,s)),a.push(""),a.push(g?ye(u):ve(u))}return a.push(r+"--\r\n"),a.join("\r\n")}(e,n);if(f(e),"zip"===n.fileType)return function(e,t){var n=t||{},r=[],i=[],s=Rn(1),o=n.compression?8:0,c=0;0;var l=0,u=0,d=0,h=0,f=e.FullPaths[0],p=f,g=e.FileIndex[0],m=[],v=0;for(l=1;l<e.FullPaths.length;++l)if(p=e.FullPaths[l].slice(f.length),(g=e.FileIndex[l]).size&&g.content&&"\x01Sh33tJ5"!=p){var y=d,b=Rn(p.length);for(u=0;u<p.length;++u)b.write_shift(1,127&p.charCodeAt(u));b=b.slice(0,b.l),m[h]=De.buf(g.content,0);var w=g.content;8==o&&(w=T(w)),(s=Rn(30)).write_shift(4,67324752),s.write_shift(2,20),s.write_shift(2,c),s.write_shift(2,o),g.mt?a(s,g.mt):s.write_shift(4,0),s.write_shift(-4,8&c?0:m[h]),s.write_shift(4,8&c?0:w.length),s.write_shift(4,8&c?0:g.content.length),s.write_shift(2,b.length),s.write_shift(2,0),d+=s.length,r.push(s),d+=b.length,r.push(b),d+=w.length,r.push(w),8&c&&((s=Rn(12)).write_shift(-4,m[h]),s.write_shift(4,w.length),s.write_shift(4,g.content.length),d+=s.l,r.push(s)),(s=Rn(46)).write_shift(4,33639248),s.write_shift(2,0),s.write_shift(2,20),s.write_shift(2,c),s.write_shift(2,o),s.write_shift(4,0),s.write_shift(-4,m[h]),s.write_shift(4,w.length),s.write_shift(4,g.content.length),s.write_shift(2,b.length),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(4,0),s.write_shift(4,y),v+=s.l,i.push(s),v+=b.length,i.push(b),++h}return s=Rn(22),s.write_shift(4,101010256),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,h),s.write_shift(2,h),s.write_shift(4,v),s.write_shift(4,d),s.write_shift(2,0),F([F(r),F(i),s])}(e,n);var r=function(e){for(var t=0,n=0,r=0;r<e.FileIndex.length;++r){var a=e.FileIndex[r];if(a.content){var i=a.content.length;i>0&&(i<4096?t+=i+63>>6:n+=i+511>>9)}}for(var s=e.FullPaths.length+3>>2,o=t+127>>7,c=(t+7>>3)+n+s+o,l=c+127>>7,u=l<=109?0:Math.ceil((l-109)/127);c+l+u+127>>7>l;)u=++l<=109?0:Math.ceil((l-109)/127);var d=[1,u,l,o,s,n,t,0];return e.FileIndex[0].size=t<<6,d[7]=(e.FileIndex[0].start=d[0]+d[1]+d[2]+d[3]+d[4]+d[5])+(d[6]+7>>3),d}(e),i=Rn(r[7]<<9),s=0,o=0;for(s=0;s<8;++s)i.write_shift(1,b[s]);for(s=0;s<8;++s)i.write_shift(2,0);for(i.write_shift(2,62),i.write_shift(2,3),i.write_shift(2,65534),i.write_shift(2,9),i.write_shift(2,6),s=0;s<3;++s)i.write_shift(2,0);for(i.write_shift(4,0),i.write_shift(4,r[2]),i.write_shift(4,r[0]+r[1]+r[2]+r[3]-1),i.write_shift(4,0),i.write_shift(4,4096),i.write_shift(4,r[3]?r[0]+r[1]+r[2]-1:v),i.write_shift(4,r[3]),i.write_shift(-4,r[1]?r[0]-1:v),i.write_shift(4,r[1]),s=0;s<109;++s)i.write_shift(-4,s<r[2]?r[1]+s:-1);if(r[1])for(o=0;o<r[1];++o){for(;s<236+127*o;++s)i.write_shift(-4,s<r[2]?r[1]+s:-1);i.write_shift(-4,o===r[1]-1?v:o+1)}var c=function(e){for(o+=e;s<o-1;++s)i.write_shift(-4,s+1);e&&(++s,i.write_shift(-4,v))};for(o=s=0,o+=r[1];s<o;++s)i.write_shift(-4,x.DIFSECT);for(o+=r[2];s<o;++s)i.write_shift(-4,x.FATSECT);c(r[3]),c(r[4]);for(var l=0,u=0,d=e.FileIndex[0];l<e.FileIndex.length;++l)(d=e.FileIndex[l]).content&&((u=d.content.length)<4096||(d.start=o,c(u+511>>9)));for(c(r[6]+7>>3);511&i.l;)i.write_shift(-4,x.ENDOFCHAIN);for(o=s=0,l=0;l<e.FileIndex.length;++l)(d=e.FileIndex[l]).content&&(!(u=d.content.length)||u>=4096||(d.start=o,c(u+63>>6)));for(;511&i.l;)i.write_shift(-4,x.ENDOFCHAIN);for(s=0;s<r[4]<<2;++s){var h=e.FullPaths[s];if(h&&0!==h.length){d=e.FileIndex[s],0===s&&(d.start=d.size?d.start-1:v);var p=0===s&&n.root||d.name;if(u=2*(p.length+1),i.write_shift(64,p,"utf16le"),i.write_shift(2,u),i.write_shift(1,d.type),i.write_shift(1,d.color),i.write_shift(-4,d.L),i.write_shift(-4,d.R),i.write_shift(-4,d.C),d.clsid)i.write_shift(16,d.clsid,"hex");else for(l=0;l<4;++l)i.write_shift(4,0);i.write_shift(4,d.state||0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,d.start),i.write_shift(4,d.size),i.write_shift(4,0)}else{for(l=0;l<17;++l)i.write_shift(4,0);for(l=0;l<3;++l)i.write_shift(4,-1);for(l=0;l<12;++l)i.write_shift(4,0)}}for(s=1;s<e.FileIndex.length;++s)if((d=e.FileIndex[s]).size>=4096)if(i.l=d.start+1<<9,N&&Buffer.isBuffer(d.content))d.content.copy(i,i.l,0,d.size),i.l+=d.size+511&-512;else{for(l=0;l<d.size;++l)i.write_shift(1,d.content[l]);for(;511&l;++l)i.write_shift(1,0)}for(s=1;s<e.FileIndex.length;++s)if((d=e.FileIndex[s]).size>0&&d.size<4096)if(N&&Buffer.isBuffer(d.content))d.content.copy(i,i.l,0,d.size),i.l+=d.size+63&-64;else{for(l=0;l<d.size;++l)i.write_shift(1,d.content[l]);for(;63&l;++l)i.write_shift(1,0)}if(N)i.l=i.length;else for(;i.l<i.length;)i.write_shift(1,0);return i}t.version="1.2.1";var g,m=64,v=-2,y="d0cf11e0a1b11ae1",b=[208,207,17,224,161,177,26,225],w="00000000000000000000000000000000",x={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:v,FREESECT:-1,HEADER_SIGNATURE:y,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:w,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function E(e){for(var t=new Array(e.length),n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function T(e){return g?g.deflateRawSync(e):ae(e)}var S=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],I=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],k=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function C(e){var t=139536&(e<<1|e<<11)|558144&(e<<5|e<<15);return 255&(t>>16|t>>8|t)}for(var L="undefined"!==typeof Uint8Array,M=L?new Uint8Array(256):[],U=0;U<256;++U)M[U]=C(U);function B(e,t){var n=M[255&e];return t<=8?n>>>8-t:(n=n<<8|M[e>>8&255],t<=16?n>>>16-t:(n=n<<8|M[e>>16&255])>>>24-t)}function V(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=6?0:e[r+1]<<8))>>>n&3}function $(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=5?0:e[r+1]<<8))>>>n&7}function H(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=3?0:e[r+1]<<8))>>>n&31}function G(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=1?0:e[r+1]<<8))>>>n&127}function W(e,t,n){var r=7&t,a=t>>>3,i=(1<<n)-1,s=e[a]>>>r;return n<8-r?s&i:(s|=e[a+1]<<8-r,n<16-r?s&i:(s|=e[a+2]<<16-r,n<24-r?s&i:(s|=e[a+3]<<24-r)&i))}function K(e,t,n){var r=7&t,a=t>>>3;return r<=5?e[a]|=(7&n)<<r:(e[a]|=n<<r&255,e[a+1]=(7&n)>>8-r),t+3}function q(e,t,n){return n=(1&n)<<(7&t),e[t>>>3]|=n,t+1}function Y(e,t,n){var r=t>>>3;return n<<=7&t,e[r]|=255&n,n>>>=8,e[r+1]=n,t+8}function Q(e,t,n){var r=t>>>3;return n<<=7&t,e[r]|=255&n,n>>>=8,e[r+1]=255&n,e[r+2]=n>>>8,t+16}function X(e,t){var n=e.length,r=2*n>t?2*n:t+5,a=0;if(n>=t)return e;if(N){var i=D(r);if(e.copy)e.copy(i);else for(;a<e.length;++a)i[a]=e[a];return i}if(L){var s=new Uint8Array(r);if(s.set)s.set(e);else for(;a<n;++a)s[a]=e[a];return s}return e.length=r,e}function J(e){for(var t=new Array(e),n=0;n<e;++n)t[n]=0;return t}function Z(e,t,n){var r=1,a=0,i=0,s=0,o=0,c=e.length,l=L?new Uint16Array(32):J(32);for(i=0;i<32;++i)l[i]=0;for(i=c;i<n;++i)e[i]=0;c=e.length;var u=L?new Uint16Array(c):J(c);for(i=0;i<c;++i)l[a=e[i]]++,r<a&&(r=a),u[i]=0;for(l[0]=0,i=1;i<=r;++i)l[i+16]=o=o+l[i-1]<<1;for(i=0;i<c;++i)0!=(o=e[i])&&(u[i]=l[o+16]++);var d=0;for(i=0;i<c;++i)if(0!=(d=e[i]))for(o=B(u[i],r)>>r-d,s=(1<<r+4-d)-1;s>=0;--s)t[o|s<<d]=15&d|i<<4;return r}var ee=L?new Uint16Array(512):J(512),te=L?new Uint16Array(32):J(32);if(!L){for(var ne=0;ne<512;++ne)ee[ne]=0;for(ne=0;ne<32;++ne)te[ne]=0}!function(){for(var e=[],t=0;t<32;t++)e.push(5);Z(e,te,32);var n=[];for(t=0;t<=143;t++)n.push(8);for(;t<=255;t++)n.push(9);for(;t<=279;t++)n.push(7);for(;t<=287;t++)n.push(8);Z(n,ee,288)}();var re=function(){for(var e=L?new Uint8Array(32768):[],t=0,n=0;t<k.length-1;++t)for(;n<k[t+1];++n)e[n]=t;for(;n<32768;++n)e[n]=29;var r=L?new Uint8Array(259):[];for(t=0,n=0;t<I.length-1;++t)for(;n<I[t+1];++n)r[n]=t;return function(t,n){return t.length<8?function(e,t){for(var n=0;n<e.length;){var r=Math.min(65535,e.length-n),a=n+r==e.length;for(t.write_shift(1,+a),t.write_shift(2,r),t.write_shift(2,65535&~r);r-- >0;)t[t.l++]=e[n++]}return t.l}(t,n):function(t,n){for(var a=0,i=0,s=L?new Uint16Array(32768):[];i<t.length;){var o=Math.min(65535,t.length-i);if(o<10){for(7&(a=K(n,a,+!(i+o!=t.length)))&&(a+=8-(7&a)),n.l=a/8|0,n.write_shift(2,o),n.write_shift(2,65535&~o);o-- >0;)n[n.l++]=t[i++];a=8*n.l}else{a=K(n,a,+!(i+o!=t.length)+2);for(var c=0;o-- >0;){var l=t[i],u=-1,d=0;if((u=s[c=32767&(c<<5^l)])&&((u|=-32768&i)>i&&(u-=32768),u<i))for(;t[u+d]==t[i+d]&&d<250;)++d;if(d>2){(l=r[d])<=22?a=Y(n,a,M[l+1]>>1)-1:(Y(n,a,3),Y(n,a+=5,M[l-23]>>5),a+=3);var h=l<8?0:l-4>>2;h>0&&(Q(n,a,d-I[l]),a+=h),l=e[i-u],a=Y(n,a,M[l]>>3),a-=3;var f=l<4?0:l-2>>1;f>0&&(Q(n,a,i-u-k[l]),a+=f);for(var p=0;p<d;++p)s[c]=32767&i,c=32767&(c<<5^t[i]),++i;o-=d-1}else l<=143?l+=48:a=q(n,a,1),a=Y(n,a,M[l]),s[c]=32767&i,++i}a=Y(n,a,0)-1}}return n.l=(a+7)/8|0,n.l}(t,n)}}();function ae(e){var t=Rn(50+Math.floor(1.1*e.length)),n=re(e,t);return t.slice(0,n)}var ie=L?new Uint16Array(32768):J(32768),se=L?new Uint16Array(32768):J(32768),oe=L?new Uint16Array(128):J(128),ce=1,le=1;function ue(e,t){var n=H(e,t)+257,r=H(e,t+=5)+1,a=function(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=4?0:e[r+1]<<8))>>>n&15}(e,t+=5)+4;t+=4;for(var i=0,s=L?new Uint8Array(19):J(19),o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],c=1,l=L?new Uint8Array(8):J(8),u=L?new Uint8Array(8):J(8),d=s.length,h=0;h<a;++h)s[S[h]]=i=$(e,t),c<i&&(c=i),l[i]++,t+=3;var f=0;for(l[0]=0,h=1;h<=c;++h)u[h]=f=f+l[h-1]<<1;for(h=0;h<d;++h)0!=(f=s[h])&&(o[h]=u[f]++);var p=0;for(h=0;h<d;++h)if(0!=(p=s[h])){f=M[o[h]]>>8-p;for(var g=(1<<7-p)-1;g>=0;--g)oe[f|g<<p]=7&p|h<<3}var m=[];for(c=1;m.length<n+r;)switch(t+=7&(f=oe[G(e,t)]),f>>>=3){case 16:for(i=3+V(e,t),t+=2,f=m[m.length-1];i-- >0;)m.push(f);break;case 17:for(i=3+$(e,t),t+=3;i-- >0;)m.push(0);break;case 18:for(i=11+G(e,t),t+=7;i-- >0;)m.push(0);break;default:m.push(f),c<f&&(c=f)}var v=m.slice(0,n),y=m.slice(n);for(h=n;h<286;++h)v[h]=0;for(h=r;h<30;++h)y[h]=0;return ce=Z(v,ie,286),le=Z(y,se,30),t}function de(e,t){var n=function(e,t){if(3==e[0]&&!(3&e[1]))return[O(t),2];for(var n=0,r=0,a=D(t||1<<18),i=0,s=a.length>>>0,o=0,c=0;0==(1&r);)if(r=$(e,n),n+=3,r>>>1!=0)for(r>>1==1?(o=9,c=5):(n=ue(e,n),o=ce,c=le);;){!t&&s<i+32767&&(s=(a=X(a,i+32767)).length);var l=W(e,n,o),u=r>>>1==1?ee[l]:ie[l];if(n+=15&u,0===((u>>>=4)>>>8&255))a[i++]=u;else{if(256==u)break;var d=(u-=257)<8?0:u-4>>2;d>5&&(d=0);var h=i+I[u];d>0&&(h+=W(e,n,d),n+=d),l=W(e,n,c),n+=15&(u=r>>>1==1?te[l]:se[l]);var f=(u>>>=4)<4?0:u-2>>1,p=k[u];for(f>0&&(p+=W(e,n,f),n+=f),!t&&s<h&&(s=(a=X(a,h+100)).length);i<h;)a[i]=a[i-p],++i}}else{7&n&&(n+=8-(7&n));var g=e[n>>>3]|e[1+(n>>>3)]<<8;if(n+=32,g>0)for(!t&&s<i+g&&(s=(a=X(a,i+g)).length);g-- >0;)a[i++]=e[n>>>3],n+=8}return t?[a,n+7>>>3]:[a.slice(0,i),n+7>>>3]}(e.slice(e.l||0),t);return e.l+=n[1],n[0]}function he(e,t){if(!e)throw new Error(t);"undefined"!==typeof console&&console.error(t)}function fe(e,t){var n=e;An(n,0);var r={FileIndex:[],FullPaths:[]};h(r,{root:t.root});for(var a=n.length-4;(80!=n[a]||75!=n[a+1]||5!=n[a+2]||6!=n[a+3])&&a>=0;)--a;n.l=a+4,n.l+=4;var s=n.read_shift(2);n.l+=6;var o=n.read_shift(4);for(n.l=o,a=0;a<s;++a){n.l+=20;var c=n.read_shift(4),l=n.read_shift(4),u=n.read_shift(2),d=n.read_shift(2),f=n.read_shift(2);n.l+=8;var p=n.read_shift(4),g=i(n.slice(n.l+u,n.l+u+d));n.l+=u+d+f;var m=n.l;n.l=p+4,pe(n,c,l,r,g),n.l=m}return r}function pe(e,t,n,r,a){e.l+=2;var s=e.read_shift(2),o=e.read_shift(2),c=function(e){var t=65535&e.read_shift(2),n=65535&e.read_shift(2),r=new Date,a=31&n,i=15&(n>>>=5);n>>>=4,r.setMilliseconds(0),r.setFullYear(n+1980),r.setMonth(i-1),r.setDate(a);var s=31&t,o=63&(t>>>=5);return t>>>=6,r.setHours(t),r.setMinutes(o),r.setSeconds(s<<1),r}(e);if(8257&s)throw new Error("Unsupported ZIP encryption");e.read_shift(4);for(var l=e.read_shift(4),u=e.read_shift(4),d=e.read_shift(2),h=e.read_shift(2),f="",p=0;p<d;++p)f+=String.fromCharCode(e[e.l++]);if(h){var m=i(e.slice(e.l,e.l+h));(m[21589]||{}).mt&&(c=m[21589].mt),((a||{})[21589]||{}).mt&&(c=a[21589].mt)}e.l+=h;var v=e.slice(e.l,e.l+l);switch(o){case 8:v=function(e,t){if(!g)return de(e,t);var n=new(0,g.InflateRaw),r=n._processChunk(e.slice(e.l),n._finishFlushFlag);return e.l+=n.bytesRead,r}(e,u);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+o)}var y=!1;8&s&&(134695760==e.read_shift(4)&&(e.read_shift(4),y=!0),l=e.read_shift(4),u=e.read_shift(4)),l!=t&&he(y,"Bad compressed size: "+t+" != "+l),u!=n&&he(y,"Bad uncompressed size: "+n+" != "+u),we(r,f,v,{unsafe:!0,mt:c})}var ge={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function me(e,t){if(e.ctype)return e.ctype;var n=e.name||"",r=n.match(/\.([^\.]+)$/);return r&&ge[r[1]]||t&&(r=(n=t).match(/[\.\\]([^\.\\])+$/))&&ge[r[1]]?ge[r[1]]:"application/octet-stream"}function ve(e){for(var t=_(e),n=[],r=0;r<t.length;r+=76)n.push(t.slice(r,r+76));return n.join("\r\n")+"\r\n"}function ye(e){var t=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,(function(e){var t=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==t.length?"0"+t:t)}));"\n"==(t=t.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(t="=0D"+t.slice(1));for(var n=[],r=(t=t.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),a=0;a<r.length;++a){var i=r[a];if(0!=i.length)for(var s=0;s<i.length;){var o=76,c=i.slice(s,s+o);"="==c.charAt(o-1)?o--:"="==c.charAt(o-2)?o-=2:"="==c.charAt(o-3)&&(o-=3),c=i.slice(s,s+o),(s+=o)<i.length&&(c+="="),n.push(c)}else n.push("")}return n.join("\r\n")}function be(e,t,n){for(var r,a="",i="",s="",o=0;o<10;++o){var c=t[o];if(!c||c.match(/^\s*$/))break;var l=c.match(/^(.*?):\s*([^\s].*)$/);if(l)switch(l[1].toLowerCase()){case"content-location":a=l[2].trim();break;case"content-type":s=l[2].trim();break;case"content-transfer-encoding":i=l[2].trim()}}switch(++o,i.toLowerCase()){case"base64":r=P(A(t.slice(o).join("")));break;case"quoted-printable":r=function(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n];n<=e.length&&"="==r.charAt(r.length-1);)r=r.slice(0,r.length-1)+e[++n];t.push(r)}for(var a=0;a<t.length;++a)t[a]=t[a].replace(/[=][0-9A-Fa-f]{2}/g,(function(e){return String.fromCharCode(parseInt(e.slice(1),16))}));return P(t.join("\r\n"))}(t.slice(o));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+i)}var u=we(e,a.slice(n.length),r,{unsafe:!0});s&&(u.ctype=s)}function we(e,t,n,a){var i=a&&a.unsafe;i||h(e);var s=!i&&Pe.find(e,t);if(!s){var o=e.FullPaths[0];t.slice(0,o.length)==o?o=t:("/"!=o.slice(-1)&&(o+="/"),o=(o+t).replace("//","/")),s={name:r(t),type:2},e.FileIndex.push(s),e.FullPaths.push(o),i||Pe.utils.cfb_gc(e)}return s.content=n,s.size=n?n.length:0,a&&(a.CLSID&&(s.clsid=a.CLSID),a.mt&&(s.mt=a.mt),a.ct&&(s.ct=a.ct)),s}return t.find=function(e,t){var n=e.FullPaths.map((function(e){return e.toUpperCase()})),r=n.map((function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]})),a=!1;47===t.charCodeAt(0)?(a=!0,t=n[0].slice(0,-1)+t):a=-1!==t.indexOf("/");var i=t.toUpperCase(),s=!0===a?n.indexOf(i):r.indexOf(i);if(-1!==s)return e.FileIndex[s];var o=!i.match(j);for(i=i.replace(z,""),o&&(i=i.replace(j,"!")),s=0;s<n.length;++s){if((o?n[s].replace(j,"!"):n[s]).replace(z,"")==i)return e.FileIndex[s];if((o?r[s].replace(j,"!"):r[s]).replace(z,"")==i)return e.FileIndex[s]}return null},t.read=function(t,n){var r=n&&n.type;switch(r||N&&Buffer.isBuffer(t)&&(r="buffer"),r||"base64"){case"file":return function(t,n){return s(),o(e.readFileSync(t),n)}(t,n);case"base64":return o(P(A(t)),n);case"binary":return o(P(t),n)}return o(t,n)},t.parse=o,t.write=function(t,n){var r=p(t,n);switch(n&&n.type||"buffer"){case"file":return s(),e.writeFileSync(n.filename,r),r;case"binary":return"string"==typeof r?r:E(r);case"base64":return _("string"==typeof r?r:E(r));case"buffer":if(N)return Buffer.isBuffer(r)?r:R(r);case"array":return"string"==typeof r?P(r):r}return r},t.writeFile=function(t,n,r){s();var a=p(t,r);e.writeFileSync(n,a)},t.utils={cfb_new:function(e){var t={};return h(t,e),t},cfb_add:we,cfb_del:function(e,t){h(e);var n=Pe.find(e,t);if(n)for(var r=0;r<e.FileIndex.length;++r)if(e.FileIndex[r]==n)return e.FileIndex.splice(r,1),e.FullPaths.splice(r,1),!0;return!1},cfb_mov:function(e,t,n){h(e);var a=Pe.find(e,t);if(a)for(var i=0;i<e.FileIndex.length;++i)if(e.FileIndex[i]==a)return e.FileIndex[i].name=r(n),e.FullPaths[i]=n,!0;return!1},cfb_gc:function(e){f(e,!0)},ReadShift:Tn,CheckField:_n,prep_blob:An,bconcat:F,use_zlib:function(e){try{var t=new(0,e.InflateRaw);if(t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag),!t.bytesRead)throw new Error("zlib does not expose bytesRead");g=e}catch(n){console.error("cannot use native zlib: "+(n.message||n))}},_deflateRaw:ae,_inflateRaw:de,consts:x},t}();let Le;function Me(e){for(var t=Object.keys(e),n=[],r=0;r<t.length;++r)Object.prototype.hasOwnProperty.call(e,t[r])&&n.push(t[r]);return n}function Fe(e){for(var t=[],n=Me(e),r=0;r!==n.length;++r)t[e[n[r]]]=n[r];return t}var ze=new Date(1899,11,30,0,0,0);function je(e,t){var n=e.getTime();return t&&(n-=1263168e5),(n-(ze.getTime()+6e4*(e.getTimezoneOffset()-ze.getTimezoneOffset())))/864e5}var Ue=new Date,Be=ze.getTime()+6e4*(Ue.getTimezoneOffset()-ze.getTimezoneOffset()),Ve=Ue.getTimezoneOffset();function $e(e){var t=new Date;return t.setTime(24*e*60*60*1e3+Be),t.getTimezoneOffset()!==Ve&&t.setTime(t.getTime()+6e4*(t.getTimezoneOffset()-Ve)),t}function He(e){var t=0,n=0,r=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(n=1,i>3&&(r=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":n*=24;case"H":n*=60;case"M":if(!r)throw new Error("Unsupported ISO Duration Field: M");n*=60}t+=n*parseInt(a[i],10)}return t}var Ge=new Date("2017-02-19T19:06:09.000Z"),We=isNaN(Ge.getFullYear())?new Date("2/19/17"):Ge,Ke=2017==We.getFullYear();function qe(e,t){var n=new Date(e);if(Ke)return t>0?n.setTime(n.getTime()+60*n.getTimezoneOffset()*1e3):t<0&&n.setTime(n.getTime()-60*n.getTimezoneOffset()*1e3),n;if(e instanceof Date)return e;if(1917==We.getFullYear()&&!isNaN(n.getFullYear())){var r=n.getFullYear();return e.indexOf(""+r)>-1||n.setFullYear(n.getFullYear()+100),n}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-60*i.getTimezoneOffset()*1e3)),i}function Ye(e,t){if(N&&Buffer.isBuffer(e)){if(t){if(255==e[0]&&254==e[1])return Pt(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return Pt(E(e.slice(2).toString("binary")))}return e.toString("binary")}if("undefined"!==typeof TextDecoder)try{if(t){if(255==e[0]&&254==e[1])return Pt(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return Pt(new TextDecoder("utf-16be").decode(e.slice(2)))}var n={"\u20ac":"\x80","\u201a":"\x82","\u0192":"\x83","\u201e":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02c6":"\x88","\u2030":"\x89","\u0160":"\x8a","\u2039":"\x8b","\u0152":"\x8c","\u017d":"\x8e","\u2018":"\x91","\u2019":"\x92","\u201c":"\x93","\u201d":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02dc":"\x98","\u2122":"\x99","\u0161":"\x9a","\u203a":"\x9b","\u0153":"\x9c","\u017e":"\x9e","\u0178":"\x9f"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[\u20ac\u201a\u0192\u201e\u2026\u2020\u2021\u02c6\u2030\u0160\u2039\u0152\u017d\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u02dc\u2122\u0161\u203a\u0153\u017e\u0178]/g,(function(e){return n[e]||e}))}catch(i){}for(var r=[],a=0;a!=e.length;++a)r.push(String.fromCharCode(e[a]));return r.join("")}function Qe(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=Qe(e[n]));return t}function Xe(e,t){for(var n="";n.length<t;)n+=e;return n}function Je(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var n=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,(function(){return n*=100,""}));return isNaN(t=Number(r))?(r=r.replace(/[(](.*)[)]/,(function(e,t){return n=-n,t})),isNaN(t=Number(r))?t:t/n):t/n}var Ze=["january","february","march","april","may","june","july","august","september","october","november","december"];function et(e){var t=new Date(e),n=new Date(NaN),r=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return n;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==Ze.indexOf(s))return n}else if(s.match(/[a-z]/))return n;return r<0||r>8099?n:(a>0||i>1)&&101!=r?t:e.match(/[^-0-9:,\/\\]/)?n:t}var tt=function(){var e=5=="abacaba".split(/(:?b)/i).length;return function(t,n,r){if(e||"string"==typeof n)return t.split(n);for(var a=t.split(n),i=[a[0]],s=1;s<a.length;++s)i.push(r),i.push(a[s]);return i}}();function nt(e){return e?e.content&&e.type?Ye(e.content,!0):e.data?S(e.data):e.asNodeBuffer&&N?S(e.asNodeBuffer().toString("binary")):e.asBinary?S(e.asBinary()):e._data&&e._data.getContent?S(Ye(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function rt(e){if(!e)return null;if(e.data)return x(e.data);if(e.asNodeBuffer&&N)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return"string"==typeof t?x(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function at(e,t){for(var n=e.FullPaths||Me(e.files),r=t.toLowerCase().replace(/[\/]/g,"\\"),a=r.replace(/\\/g,"/"),i=0;i<n.length;++i){var s=n[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==s||a==s)return e.files?e.files[n[i]]:e.FileIndex[i]}return null}function it(e,t){var n=at(e,t);if(null==n)throw new Error("Cannot find file "+t+" in zip");return n}function st(e,t,n){if(!n)return(r=it(e,t))&&".bin"===r.name.slice(-4)?rt(r):nt(r);var r;if(!t)return null;try{return st(e,t)}catch(a){return null}}function ot(e,t,n){if(!n)return nt(it(e,t));if(!t)return null;try{return ot(e,t)}catch(r){return null}}function ct(e,t,n){if(!n)return rt(it(e,t));if(!t)return null;try{return ct(e,t)}catch(r){return null}}function lt(e){for(var t=e.FullPaths||Me(e.files),n=[],r=0;r<t.length;++r)"/"!=t[r].slice(-1)&&n.push(t[r].replace(/^Root Entry[\/]/,""));return n.sort()}function ut(e,t,n){if(e.FullPaths){var r;if("string"==typeof n)return r=N?R(n):function(e){for(var t=[],n=0,r=e.length+250,a=O(e.length+255),i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)a[n++]=s;else if(s<2048)a[n++]=192|s>>6&31,a[n++]=128|63&s;else if(s>=55296&&s<57344){s=64+(1023&s);var o=1023&e.charCodeAt(++i);a[n++]=240|s>>8&7,a[n++]=128|s>>2&63,a[n++]=128|o>>6&15|(3&s)<<4,a[n++]=128|63&o}else a[n++]=224|s>>12&15,a[n++]=128|s>>6&63,a[n++]=128|63&s;n>r&&(t.push(a.slice(0,n)),n=0,a=O(65535),r=65530)}return t.push(a.slice(0,n)),F(t)}(n),Pe.utils.cfb_add(e,t,r);Pe.utils.cfb_add(e,t,n)}else e.file(t,n)}function dt(e,t){switch(t.type){case"base64":return Pe.read(e,{type:"base64"});case"binary":return Pe.read(e,{type:"binary"});case"buffer":case"array":return Pe.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function ht(e,t){if("/"==e.charAt(0))return e.slice(1);var n=t.split("/");"/"!=t.slice(-1)&&n.pop();for(var r=e.split("/");0!==r.length;){var a=r.shift();".."===a?n.pop():"."!==a&&n.push(a)}return n.join("/")}var ft='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',pt=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,gt=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm,mt=ft.match(gt)?gt:/<[^>]*>/g,vt=/<\w*:/,yt=/<(\/?)\w+:/;function bt(e,t,n){for(var r={},a=0,i=0;a!==e.length&&(32!==(i=e.charCodeAt(a))&&10!==i&&13!==i);++a);if(t||(r[0]=e.slice(0,a)),a===e.length)return r;var s=e.match(pt),o=0,c="",l=0,u="",d="",h=1;if(s)for(l=0;l!=s.length;++l){for(d=s[l],i=0;i!=d.length&&61!==d.charCodeAt(i);++i);for(u=d.slice(0,i).trim();32==d.charCodeAt(i+1);)++i;for(h=34==(a=d.charCodeAt(i+1))||39==a?1:0,c=d.slice(i+1+h,d.length-h),o=0;o!=u.length&&58!==u.charCodeAt(o);++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),r[u]=c,n||(r[u.toLowerCase()]=c);else{var f=(5===o&&"xmlns"===u.slice(0,5)?"xmlns":"")+u.slice(o+1);if(r[f]&&"ext"==u.slice(o-3,o))continue;r[f]=c,n||(r[f.toLowerCase()]=c)}}return r}function wt(e){return e.replace(yt,"<$1")}var xt={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Et=Fe(xt),Tt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,t=/_x([\da-fA-F]{4})_/gi;return function n(r){var a=r+"",i=a.indexOf("<![CDATA[");if(-1==i)return a.replace(e,(function(e,t){return xt[e]||String.fromCharCode(parseInt(t,e.indexOf("x")>-1?16:10))||e})).replace(t,(function(e,t){return String.fromCharCode(parseInt(t,16))}));var s=a.indexOf("]]>");return n(a.slice(0,i))+a.slice(i+9,s)+n(a.slice(s+3))}}(),St=/[&<>'"]/g;var It=/[\u0000-\u001f]/g;function kt(e){return(e+"").replace(St,(function(e){return Et[e]})).replace(/\n/g,"<br/>").replace(It,(function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"}))}var Ct=function(){var e=/&#(\d+);/g;function t(e,t){return String.fromCharCode(parseInt(t,10))}return function(n){return n.replace(e,t)}}();function _t(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function At(e){for(var t="",n=0,r=0,a=0,i=0,s=0,o=0;n<e.length;)(r=e.charCodeAt(n++))<128?t+=String.fromCharCode(r):(a=e.charCodeAt(n++),r>191&&r<224?(s=(31&r)<<6,s|=63&a,t+=String.fromCharCode(s)):(i=e.charCodeAt(n++),r<240?t+=String.fromCharCode((15&r)<<12|(63&a)<<6|63&i):(o=((7&r)<<18|(63&a)<<12|(63&i)<<6|63&(s=e.charCodeAt(n++)))-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(1023&o)))));return t}function Nt(e){var t,n,r,a=O(2*e.length),i=1,s=0,o=0;for(n=0;n<e.length;n+=i)i=1,(r=e.charCodeAt(n))<128?t=r:r<224?(t=64*(31&r)+(63&e.charCodeAt(n+1)),i=2):r<240?(t=4096*(15&r)+64*(63&e.charCodeAt(n+1))+(63&e.charCodeAt(n+2)),i=3):(i=4,t=262144*(7&r)+4096*(63&e.charCodeAt(n+1))+64*(63&e.charCodeAt(n+2))+(63&e.charCodeAt(n+3)),o=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==o&&(a[s++]=255&o,a[s++]=o>>>8,o=0),a[s++]=t%256,a[s++]=t>>>8;return a.slice(0,s).toString("ucs2")}function Rt(e){return R(e,"binary").toString("utf8")}var Ot="foo bar baz\xe2\x98\x83\xf0\x9f\x8d\xa3",Dt=N&&(Rt(Ot)==At(Ot)&&Rt||Nt(Ot)==At(Ot)&&Nt)||At,Pt=N?function(e){return R(e,"utf8").toString("binary")}:function(e){for(var t=[],n=0,r=0,a=0;n<e.length;)switch(r=e.charCodeAt(n++),!0){case r<128:t.push(String.fromCharCode(r));break;case r<2048:t.push(String.fromCharCode(192+(r>>6))),t.push(String.fromCharCode(128+(63&r)));break;case r>=55296&&r<57344:r-=55296,a=e.charCodeAt(n++)-56320+(r<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(63&a)));break;default:t.push(String.fromCharCode(224+(r>>12))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(63&r)))}return t.join("")},Lt=function(){var e={};return function(t,n){var r=t+"|"+(n||"");return e[r]?e[r]:e[r]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",n||"")}}(),Mt=function(){var e=[["nbsp"," "],["middot","\xb7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map((function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]}));return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),r=0;r<e.length;++r)n=n.replace(e[r][0],e[r][1]);return n}}(),Ft=function(){var e={};return function(t){return void 0!==e[t]?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),zt=/<\/?(?:vt:)?variant>/g,jt=/<(?:vt:)([^>]*)>([\s\S]*)</;function Ut(e,t){var n=bt(e),r=e.match(Ft(n.baseType))||[],a=[];if(r.length!=n.size){if(t.WTF)throw new Error("unexpected vector length "+r.length+" != "+n.size);return a}return r.forEach((function(e){var t=e.replace(zt,"").match(jt);t&&a.push({v:Dt(t[2]),t:t[1]})})),a}var Bt=/(^\s|\s$|\n)/;function Vt(e){return Me(e).map((function(t){return" "+t+'="'+e[t]+'"'})).join("")}function $t(e,t,n){return"<"+e+(null!=n?Vt(n):"")+(null!=t?(t.match(Bt)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Ht(e){if(N&&Buffer.isBuffer(e))return e.toString("utf8");if("string"===typeof e)return e;if("undefined"!==typeof Uint8Array&&e instanceof Uint8Array)return Dt(L(M(e)));throw new Error("Bad input format: expected Buffer or string")}var Gt=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm,Wt="http://schemas.openxmlformats.org/package/2006/content-types",Kt=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];var qt=function(e){for(var t=[],n=0;n<e[0].length;++n)if(e[0][n])for(var r=0,a=e[0][n].length;r<a;r+=10240)t.push.apply(t,e[0][n].slice(r,r+10240));return t},Yt=N?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map((function(e){return Buffer.isBuffer(e)?e:R(e)}))):qt(e)}:qt,Qt=function(e,t,n){for(var r=[],a=t;a<n;a+=2)r.push(String.fromCharCode(yn(e,a)));return r.join("").replace(z,"")},Xt=N?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf16le",t,n).replace(z,""):Qt(e,t,n)}:Qt,Jt=function(e,t,n){for(var r=[],a=t;a<t+n;++a)r.push(("0"+e[a].toString(16)).slice(-2));return r.join("")},Zt=N?function(e,t,n){return Buffer.isBuffer(e)?e.toString("hex",t,t+n):Jt(e,t,n)}:Jt,en=function(e,t,n){for(var r=[],a=t;a<n;a++)r.push(String.fromCharCode(vn(e,a)));return r.join("")},tn=N?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf8",t,n):en(e,t,n)}:en,nn=function(e,t){var n=wn(e,t);return n>0?tn(e,t+4,t+4+n-1):""},rn=nn,an=function(e,t){var n=wn(e,t);return n>0?tn(e,t+4,t+4+n-1):""},sn=an,on=function(e,t){var n=2*wn(e,t);return n>0?tn(e,t+4,t+4+n-1):""},cn=on,ln=function(e,t){var n=wn(e,t);return n>0?Xt(e,t+4,t+4+n):""},un=ln,dn=function(e,t){var n=wn(e,t);return n>0?tn(e,t+4,t+4+n):""},hn=dn,fn=function(e,t){return function(e,t){for(var n=1-2*(e[t+7]>>>7),r=((127&e[t+7])<<4)+(e[t+6]>>>4&15),a=15&e[t+6],i=5;i>=0;--i)a=256*a+e[t+i];return 2047==r?0==a?n*(1/0):NaN:(0==r?r=-1022:(r-=1023,a+=Math.pow(2,52)),n*Math.pow(2,r-52)*a)}(e,t)},pn=fn,gn=function(e){return Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array};function mn(){Xt=function(e,t,n){return T.utils.decode(1200,e.slice(t,n)).replace(z,"")},tn=function(e,t,n){return T.utils.decode(65001,e.slice(t,n))},rn=function(e,t){var n=wn(e,t);return n>0?T.utils.decode(g,e.slice(t+4,t+4+n-1)):""},sn=function(e,t){var n=wn(e,t);return n>0?T.utils.decode(p,e.slice(t+4,t+4+n-1)):""},cn=function(e,t){var n=2*wn(e,t);return n>0?T.utils.decode(1200,e.slice(t+4,t+4+n-1)):""},un=function(e,t){var n=wn(e,t);return n>0?T.utils.decode(1200,e.slice(t+4,t+4+n)):""},hn=function(e,t){var n=wn(e,t);return n>0?T.utils.decode(65001,e.slice(t+4,t+4+n)):""}}N&&(rn=function(e,t){if(!Buffer.isBuffer(e))return nn(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},sn=function(e,t){if(!Buffer.isBuffer(e))return an(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},cn=function(e,t){if(!Buffer.isBuffer(e))return on(e,t);var n=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n-1)},un=function(e,t){if(!Buffer.isBuffer(e))return ln(e,t);var n=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n)},hn=function(e,t){if(!Buffer.isBuffer(e))return dn(e,t);var n=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+n)},pn=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):fn(e,t)},gn=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array}),"undefined"!==typeof T&&mn();var vn=function(e,t){return e[t]},yn=function(e,t){return 256*e[t+1]+e[t]},bn=function(e,t){var n=256*e[t+1]+e[t];return n<32768?n:-1*(65535-n+1)},wn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},xn=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},En=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Tn(e,t){var n,r,a,i,s,o,c="",l=[];switch(t){case"dbcs":if(o=this.l,N&&Buffer.isBuffer(this))c=this.slice(this.l,this.l+2*e).toString("utf16le");else for(s=0;s<e;++s)c+=String.fromCharCode(yn(this,o)),o+=2;e*=2;break;case"utf8":c=tn(this,this.l,this.l+e);break;case"utf16le":e*=2,c=Xt(this,this.l,this.l+e);break;case"wstr":if("undefined"===typeof T)return Tn.call(this,e,"dbcs");c=T.utils.decode(p,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":c=rn(this,this.l),e=4+wn(this,this.l);break;case"lpstr-cp":c=sn(this,this.l),e=4+wn(this,this.l);break;case"lpwstr":c=cn(this,this.l),e=4+2*wn(this,this.l);break;case"lpp4":e=4+wn(this,this.l),c=un(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+wn(this,this.l),c=hn(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,c="";0!==(a=vn(this,this.l+e++));)l.push(I(a));c=l.join("");break;case"_wstr":for(e=0,c="";0!==(a=yn(this,this.l+e));)l.push(I(a)),e+=2;e+=2,c=l.join("");break;case"dbcs-cont":for(c="",o=this.l,s=0;s<e;++s){if(this.lens&&-1!==this.lens.indexOf(o))return a=vn(this,o),this.l=o+1,i=Tn.call(this,e-s,a?"dbcs-cont":"sbcs-cont"),l.join("")+i;l.push(I(yn(this,o))),o+=2}c=l.join(""),e*=2;break;case"cpstr":if("undefined"!==typeof T){c=T.utils.decode(p,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(c="",o=this.l,s=0;s!=e;++s){if(this.lens&&-1!==this.lens.indexOf(o))return a=vn(this,o),this.l=o+1,i=Tn.call(this,e-s,a?"dbcs-cont":"sbcs-cont"),l.join("")+i;l.push(I(vn(this,o))),o+=1}c=l.join("");break;default:switch(e){case 1:return n=vn(this,this.l),this.l++,n;case 2:return n=("i"===t?bn:yn)(this,this.l),this.l+=2,n;case 4:case-4:return"i"===t||0===(128&this[this.l+3])?(n=(e>0?xn:En)(this,this.l),this.l+=4,n):(r=wn(this,this.l),this.l+=4,r);case 8:case-8:if("f"===t)return r=8==e?pn(this,this.l):pn([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,r;e=8;case 16:c=Zt(this,this.l,e)}}return this.l+=e,c}var Sn=function(e,t,n){e[n]=255&t,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24&255},In=function(e,t,n){e[n]=255&t,e[n+1]=t>>8&255,e[n+2]=t>>16&255,e[n+3]=t>>24&255},kn=function(e,t,n){e[n]=255&t,e[n+1]=t>>>8&255};function Cn(e,t,n){var r=0,a=0;if("dbcs"===n){for(a=0;a!=t.length;++a)kn(this,t.charCodeAt(a),this.l+2*a);r=2*t.length}else if("sbcs"===n){if("undefined"!==typeof T&&874==g)for(a=0;a!=t.length;++a){var i=T.utils.encode(g,t.charAt(a));this[this.l+a]=i[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=255&t.charCodeAt(a);r=t.length}else{if("hex"===n){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}if("utf16le"===n){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var o=t.charCodeAt(a);this[this.l++]=255&o,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}switch(e){case 1:r=1,this[this.l]=255&t;break;case 2:r=2,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t;break;case 3:r=3,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t,t>>>=8,this[this.l+2]=255&t;break;case 4:r=4,Sn(this,t,this.l);break;case 8:if(r=8,"f"===n){!function(e,t,n){var r=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,s=r?-t:t;isFinite(s)?0==s?a=i=0:(a=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var o=0;o<=5;++o,i/=256)e[n+o]=255&i;e[n+6]=(15&a)<<4|15&i,e[n+7]=a>>4|r}(this,t,this.l);break}case 16:break;case-4:r=4,In(this,t,this.l)}}return this.l+=r,this}function _n(e,t){var n=Zt(this,this.l,e.length>>1);if(n!==e)throw new Error(t+"Expected "+e+" saw "+n);this.l+=e.length>>1}function An(e,t){e.l=t,e.read_shift=Tn,e.chk=_n,e.write_shift=Cn}function Nn(e,t){e.l+=t}function Rn(e){var t=O(e);return An(t,0),t}function On(e,t,n){if(e){var r,a,i;An(e,e.l||0);for(var s=e.length,o=0,c=0;e.l<s;){128&(o=e.read_shift(1))&&(o=(127&o)+((127&e.read_shift(1))<<7));var l=Bo[o]||Bo[65535];for(i=127&(r=e.read_shift(1)),a=1;a<4&&128&r;++a)i+=(127&(r=e.read_shift(1)))<<7*a;c=e.l+i;var u=l.f&&l.f(e,i,n);if(e.l=c,t(u,l,o))return}}}function Dn(){var e=[],t=N?256:2048,n=function(e){var t=Rn(e);return An(t,0),t},r=n(t),a=function(){r&&(r.length>r.l&&((r=r.slice(0,r.l)).l=r.length),r.length>0&&e.push(r),r=null)},i=function(e){return r&&e<r.length-r.l?r:(a(),r=n(Math.max(e+1,t)))};return{next:i,push:function(e){a(),null==(r=e).l&&(r.l=r.length),i(t)},end:function(){return a(),F(e)},_bufs:e}}function Pn(e,t,n){var r=Qe(e);if(t.s?(r.cRel&&(r.c+=t.s.c),r.rRel&&(r.r+=t.s.r)):(r.cRel&&(r.c+=t.c),r.rRel&&(r.r+=t.r)),!n||n.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function Ln(e,t,n){var r=Qe(e);return r.s=Pn(r.s,t.s,n),r.e=Pn(r.e,t.s,n),r}function Mn(e,t){if(e.cRel&&e.c<0)for(e=Qe(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Qe(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var n=$n(e);return e.cRel||null==e.cRel||(n=n.replace(/^([A-Z])/,"$$$1")),e.rRel||null==e.rRel||(n=function(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(n)),n}function Fn(e,t){return 0!=e.s.r||e.s.rRel||e.e.r!=(t.biff>=12?1048575:t.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(t.biff>=12?16383:255)||e.e.cRel?Mn(e.s,t.biff)+":"+Mn(e.e,t.biff):(e.s.rRel?"":"$")+jn(e.s.r)+":"+(e.e.rRel?"":"$")+jn(e.e.r):(e.s.cRel?"":"$")+Bn(e.s.c)+":"+(e.e.cRel?"":"$")+Bn(e.e.c)}function zn(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function jn(e){return""+(e+1)}function Un(e){for(var t=e.replace(/^\$([A-Z])/,"$1"),n=0,r=0;r!==t.length;++r)n=26*n+t.charCodeAt(r)-64;return n-1}function Bn(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Vn(e){for(var t=0,n=0,r=0;r<e.length;++r){var a=e.charCodeAt(r);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(n=26*n+(a-64))}return{c:n-1,r:t-1}}function $n(e){for(var t=e.c+1,n="";t;t=(t-1)/26|0)n=String.fromCharCode((t-1)%26+65)+n;return n+(e.r+1)}function Hn(e){var t=e.indexOf(":");return-1==t?{s:Vn(e),e:Vn(e)}:{s:Vn(e.slice(0,t)),e:Vn(e.slice(t+1))}}function Gn(e,t){return"undefined"===typeof t||"number"===typeof t?Gn(e.s,e.e):("string"!==typeof e&&(e=$n(e)),"string"!==typeof t&&(t=$n(t)),e==t?e:e+":"+t)}function Wn(e){var t={s:{c:0,r:0},e:{c:0,r:0}},n=0,r=0,a=0,i=e.length;for(n=0;r<i&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)n=26*n+a;for(t.s.c=--n,n=0;r<i&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)n=10*n+a;if(t.s.r=--n,r===i||10!=a)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++r,n=0;r!=i&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)n=26*n+a;for(t.e.c=--n,n=0;r!=i&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)n=10*n+a;return t.e.r=--n,t}function Kn(e,t){var n="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=_e(e.z,n?je(t):t)}catch(r){}try{return e.w=_e((e.XF||{}).numFmtId||(n?14:0),n?je(t):t)}catch(r){return""+t}}function qn(e,t,n){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&n&&n.dateNF&&(e.z=n.dateNF),"e"==e.t?xr[e.v]||e.v:Kn(e,void 0==t?e.v:t))}function Yn(e,t){var n=t&&t.sheet?t.sheet:"Sheet1",r={};return r[n]=e,{SheetNames:[n],Sheets:r}}function Qn(e,t,n){var r=n||{},a=e?Array.isArray(e):r.dense;var i=e||(a?[]:{}),s=0,o=0;if(i&&null!=r.origin){if("number"==typeof r.origin)s=r.origin;else{var c="string"==typeof r.origin?Vn(r.origin):r.origin;s=c.r,o=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var l={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=Wn(i["!ref"]);l.s.c=u.s.c,l.s.r=u.s.r,l.e.c=Math.max(l.e.c,u.e.c),l.e.r=Math.max(l.e.r,u.e.r),-1==s&&(l.e.r=s=u.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[d].length;++h)if("undefined"!==typeof t[d][h]){var f={v:t[d][h]},p=s+d,g=o+h;if(l.s.r>p&&(l.s.r=p),l.s.c>g&&(l.s.c=g),l.e.r<p&&(l.e.r=p),l.e.c<g&&(l.e.c=g),!t[d][h]||"object"!==typeof t[d][h]||Array.isArray(t[d][h])||t[d][h]instanceof Date)if(Array.isArray(f.v)&&(f.f=t[d][h][1],f.v=f.v[0]),null===f.v)if(f.f)f.t="n";else if(r.nullError)f.t="e",f.v=0;else{if(!r.sheetStubs)continue;f.t="z"}else"number"===typeof f.v?f.t="n":"boolean"===typeof f.v?f.t="b":f.v instanceof Date?(f.z=r.dateNF||Q[14],r.cellDates?(f.t="d",f.w=_e(f.z,je(f.v))):(f.t="n",f.v=je(f.v),f.w=_e(f.z,f.v))):f.t="s";else f=t[d][h];if(a)i[p]||(i[p]=[]),i[p][g]&&i[p][g].z&&(f.z=i[p][g].z),i[p][g]=f;else{var m=$n({c:g,r:p});i[m]&&i[m].z&&(f.z=i[m].z),i[m]=f}}}return l.s.c<1e7&&(i["!ref"]=Gn(l)),i}function Xn(e,t){return Qn(null,e,t)}function Jn(e){var t=e.read_shift(4);return 0===t?"":e.read_shift(t,"dbcs")}function Zn(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function er(e,t){var n=e.l,r=e.read_shift(1),a=Jn(e),i=[],s={t:a,h:a};if(0!==(1&r)){for(var o=e.read_shift(4),c=0;c!=o;++c)i.push(Zn(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=n+t,s}var tr=er;function nr(e){var t=e.read_shift(4),n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:n}}function rr(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var ar=Jn;function ir(e){var t=e.read_shift(4);return 0===t||4294967295===t?"":e.read_shift(t,"dbcs")}var sr=Jn,or=ir;function cr(e){var t=e.slice(e.l,e.l+4),n=1&t[0],r=2&t[0];e.l+=4;var a=0===r?pn([0,0,0,0,252&t[0],t[1],t[2],t[3]],0):xn(t,0)>>2;return n?a/100:a}function lr(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var ur=lr;function dr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function hr(e,t){var n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,1==t?"lpstr":"lpwstr")}var fr=80,pr=[fr,81],gr={1:{n:"CodePage",t:2},2:{n:"Category",t:fr},3:{n:"PresentationFormat",t:fr},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:fr},15:{n:"Company",t:fr},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:fr},27:{n:"ContentStatus",t:fr},28:{n:"Language",t:fr},29:{n:"Version",t:fr},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},mr={1:{n:"CodePage",t:2},2:{n:"Title",t:fr},3:{n:"Subject",t:fr},4:{n:"Author",t:fr},5:{n:"Keywords",t:fr},6:{n:"Comments",t:fr},7:{n:"Template",t:fr},8:{n:"LastAuthor",t:fr},9:{n:"RevNumber",t:fr},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:fr},19:{n:"DocSecurity",t:3},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},vr={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},yr=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function br(e){return e.map((function(e){return[e>>16&255,e>>8&255,255&e]}))}var wr=Qe(br([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),xr={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Er={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Tr={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};var Sr={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Ir(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function kr(e,t){var n={"!id":{}};if(!e)return n;"/"!==t.charAt(0)&&(t="/"+t);var r={};return(e.match(mt)||[]).forEach((function(e){var a=bt(e);if("<Relationship"===a[0]){var i={};i.Type=a.Type,i.Target=a.Target,i.Id=a.Id,a.TargetMode&&(i.TargetMode=a.TargetMode);var s="External"===a.TargetMode?a.Target:ht(a.Target,t);n[s]=i,r[a.Id]=i}})),n["!id"]=r,n}var Cr=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],_r=function(){for(var e=new Array(Cr.length),t=0;t<Cr.length;++t){var n=Cr[t],r="(?:"+n[0].slice(0,n[0].indexOf(":"))+":)"+n[0].slice(n[0].indexOf(":")+1);e[t]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return e}();function Ar(e){var t={};e=Dt(e);for(var n=0;n<Cr.length;++n){var r=Cr[n],a=e.match(_r[n]);null!=a&&a.length>0&&(t[r[1]]=Tt(a[1])),"date"===r[2]&&t[r[1]]&&(t[r[1]]=qe(t[r[1]]))}return t}var Nr=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function Rr(e,t,n,r){var a=[];if("string"==typeof e)a=Ut(e,r);else for(var i=0;i<e.length;++i)a=a.concat(e[i].map((function(e){return{v:e}})));var s="string"==typeof t?Ut(t,r).map((function(e){return e.v})):t,o=0,c=0;if(s.length>0)for(var l=0;l!==a.length;l+=2){switch(c=+a[l+1].v,a[l].v){case"Worksheets":case"\u5de5\u4f5c\u8868":case"\u041b\u0438\u0441\u0442\u044b":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30ef\u30fc\u30af\u30b7\u30fc\u30c8":case"\u05d2\u05dc\u05d9\u05d5\u05e0\u05d5\u05ea \u05e2\u05d1\u05d5\u05d3\u05d4":case"Arbeitsbl\xe4tter":case"\xc7al\u0131\u015fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xe1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xe1lculo":case"Werkbladen":n.Worksheets=c,n.SheetNames=s.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"\u540d\u524d\u4ed8\u304d\u4e00\u89a7":case"Benannte Bereiche":case"Navngivne omr\xe5der":n.NamedRanges=c,n.DefinedNames=s.slice(o,o+c);break;case"Charts":case"Diagramme":n.Chartsheets=c,n.ChartNames=s.slice(o,o+c)}o+=c}}var Or=/<[^>]+>[^<]*/g;var Dr,Pr={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function Lr(e,t,n){Dr||(Dr=Fe(Pr)),e[t=Dr[t]||t]=n}function Mr(e){var t=e.read_shift(4),n=e.read_shift(4);return new Date(1e3*(n/1e7*Math.pow(2,32)+t/1e7-11644473600)).toISOString().replace(/\.000/,"")}function Fr(e,t,n){var r=e.l,a=e.read_shift(0,"lpstr-cp");if(n)for(;e.l-r&3;)++e.l;return a}function zr(e,t,n){var r=e.read_shift(0,"lpwstr");return n&&(e.l+=4-(r.length+1&3)&3),r}function jr(e,t,n){return 31===t?zr(e):Fr(e,0,n)}function Ur(e,t,n){return jr(e,t,!1===n?0:4)}function Br(e){var t=e.l,n=Hr(e,81);return 0==e[e.l]&&0==e[e.l+1]&&e.l-t&2&&(e.l+=2),[n,Hr(e,3)]}function Vr(e,t){for(var n=e.read_shift(4),r={},a=0;a!=n;++a){var i=e.read_shift(4),s=e.read_shift(4);r[i]=e.read_shift(s,1200===t?"utf16le":"utf8").replace(z,"").replace(j,"!"),1200===t&&s%2&&(e.l+=2)}return 3&e.l&&(e.l=e.l>>3<<2),r}function $r(e){var t=e.read_shift(4),n=e.slice(e.l,e.l+t);return e.l+=t,(3&t)>0&&(e.l+=4-(3&t)&3),n}function Hr(e,t,n){var r,a=e.read_shift(2),i=n||{};if(e.l+=2,12!==t&&a!==t&&-1===pr.indexOf(t)&&(4126!=(65534&t)||4126!=(65534&a)))throw new Error("Expected type "+t+" saw "+a);switch(12===t?a:t){case 2:return r=e.read_shift(2,"i"),i.raw||(e.l+=2),r;case 3:return r=e.read_shift(4,"i");case 11:return 0!==e.read_shift(4);case 19:return r=e.read_shift(4);case 30:return Fr(e,0,4).replace(z,"");case 31:return zr(e);case 64:return Mr(e);case 65:return $r(e);case 71:return function(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}(e);case 80:return Ur(e,a,!i.raw).replace(z,"");case 81:return function(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return jr(e,t,0)}(e,a).replace(z,"");case 4108:return function(e){for(var t=e.read_shift(4),n=[],r=0;r<t/2;++r)n.push(Br(e));return n}(e);case 4126:case 4127:return 4127==a?function(e){for(var t=e.read_shift(4),n=[],r=0;r!=t;++r){var a=e.l;n[r]=e.read_shift(0,"lpwstr").replace(z,""),e.l-a&2&&(e.l+=2)}return n}(e):function(e){for(var t=e.read_shift(4),n=[],r=0;r!=t;++r)n[r]=e.read_shift(0,"lpstr-cp").replace(z,"");return n}(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function Gr(e,t){var n=e.l,r=e.read_shift(4),a=e.read_shift(4),i=[],s=0,o=0,c=-1,l={};for(s=0;s!=a;++s){var u=e.read_shift(4),d=e.read_shift(4);i[s]=[u,d+n]}i.sort((function(e,t){return e[1]-t[1]}));var h={};for(s=0;s!=a;++s){if(e.l!==i[s][1]){var f=!0;if(s>0&&t)switch(t[i[s-1][0]].t){case 2:e.l+2===i[s][1]&&(e.l+=2,f=!1);break;case 80:case 4108:e.l<=i[s][1]&&(e.l=i[s][1],f=!1)}if((!t||0==s)&&e.l<=i[s][1]&&(f=!1,e.l=i[s][1]),f)throw new Error("Read Error: Expected address "+i[s][1]+" at "+e.l+" :"+s)}if(t){var p=t[i[s][0]];if(h[p.n]=Hr(e,p.t,{raw:!0}),"version"===p.p&&(h[p.n]=String(h[p.n]>>16)+"."+("0000"+String(65535&h[p.n])).slice(-4)),"CodePage"==p.n)switch(h[p.n]){case 0:h[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:b(o=h[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[p.n])}}else if(1===i[s][0]){if(o=h.CodePage=Hr(e,2),b(o),-1!==c){var g=e.l;e.l=i[c][1],l=Vr(e,o),e.l=g}}else if(0===i[s][0]){if(0===o){c=s,e.l=i[s+1][1];continue}l=Vr(e,o)}else{var m,v=l[i[s][0]];switch(e[e.l]){case 65:e.l+=4,m=$r(e);break;case 30:case 31:e.l+=4,m=Ur(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,m=e.read_shift(4,"i");break;case 19:e.l+=4,m=e.read_shift(4);break;case 5:e.l+=4,m=e.read_shift(8,"f");break;case 11:e.l+=4,m=qr(e,4);break;case 64:e.l+=4,m=qe(Mr(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[v]=m}}return e.l=n+r,h}function Wr(e,t,n){var r=e.content;if(!r)return{};An(r,0);var a,i,s,o,c=0;r.chk("feff","Byte Order: "),r.read_shift(2);var l=r.read_shift(4),u=r.read_shift(16);if(u!==Pe.utils.consts.HEADER_CLSID&&u!==n)throw new Error("Bad PropertySet CLSID "+u);if(1!==(a=r.read_shift(4))&&2!==a)throw new Error("Unrecognized #Sets: "+a);if(i=r.read_shift(16),o=r.read_shift(4),1===a&&o!==r.l)throw new Error("Length mismatch: "+o+" !== "+r.l);2===a&&(s=r.read_shift(16),c=r.read_shift(4));var d,h=Gr(r,t),f={SystemIdentifier:l};for(var p in h)f[p]=h[p];if(f.FMTID=i,1===a)return f;if(c-r.l==2&&(r.l+=2),r.l!==c)throw new Error("Length mismatch 2: "+r.l+" !== "+c);try{d=Gr(r,null)}catch(g){}for(p in d)f[p]=d[p];return f.FMTID=[i,s],f}function Kr(e,t){return e.read_shift(t),null}function qr(e,t){return 1===e.read_shift(t)}function Yr(e){return e.read_shift(2,"u")}function Qr(e,t){return function(e,t,n){for(var r=[],a=e.l+t;e.l<a;)r.push(n(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return r}(e,t,Yr)}function Xr(e,t,n){var r=e.read_shift(n&&n.biff>=12?2:1),a="sbcs-cont",i=p;(n&&n.biff>=8&&(p=1200),n&&8!=n.biff)?12==n.biff&&(a="wstr"):e.read_shift(1)&&(a="dbcs-cont");n.biff>=2&&n.biff<=5&&(a="cpstr");var s=r?e.read_shift(r,a):"";return p=i,s}function Jr(e){var t=p;p=1200;var n,r=e.read_shift(2),a=e.read_shift(1),i=4&a,s=8&a,o=1+(1&a),c=0,l={};s&&(c=e.read_shift(2)),i&&(n=e.read_shift(4));var u=2==o?"dbcs-cont":"sbcs-cont",d=0===r?"":e.read_shift(r,u);return s&&(e.l+=4*c),i&&(e.l+=n),l.t=d,s||(l.raw="<t>"+l.t+"</t>",l.r=l.t),p=t,l}function Zr(e,t,n){if(n){if(n.biff>=2&&n.biff<=5)return e.read_shift(t,"cpstr");if(n.biff>=12)return e.read_shift(t,"dbcs-cont")}return 0===e.read_shift(1)?e.read_shift(t,"sbcs-cont"):e.read_shift(t,"dbcs-cont")}function ea(e,t,n){var r=e.read_shift(n&&2==n.biff?1:2);return 0===r?(e.l++,""):Zr(e,r,n)}function ta(e,t,n){if(n.biff>5)return ea(e,0,n);var r=e.read_shift(1);return 0===r?(e.l++,""):e.read_shift(r,n.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function na(e,t){var n=e.read_shift(16);switch(n){case"e0c9ea79f9bace118c8200aa004ba90b":return function(e){var t=e.read_shift(4),n=e.l,r=!1;t>24&&(e.l+=t-24,"795881f43b1d7f48af2c825dc4852763"===e.read_shift(16)&&(r=!0),e.l=n);var a=e.read_shift((r?t-24:t)>>1,"utf16le").replace(z,"");return r&&(e.l+=24),a}(e);case"0303000000000000c000000000000046":return function(e){for(var t=e.read_shift(2),n="";t-- >0;)n+="../";var r=e.read_shift(0,"lpstr-ansi");if(e.l+=2,57005!=e.read_shift(2))throw new Error("Bad FileMoniker");if(0===e.read_shift(4))return n+r.replace(/\\/g,"/");var a=e.read_shift(4);if(3!=e.read_shift(2))throw new Error("Bad FileMoniker");return n+e.read_shift(a>>1,"utf16le").replace(z,"")}(e);default:throw new Error("Unsupported Moniker "+n)}}function ra(e){var t=e.read_shift(4);return t>0?e.read_shift(t,"utf16le").replace(z,""):""}function aa(e){return[e.read_shift(1),e.read_shift(1),e.read_shift(1),e.read_shift(1)]}function ia(e,t){var n=aa(e);return n[3]=0,n}function sa(e){return{r:e.read_shift(2),c:e.read_shift(2),ixfe:e.read_shift(2)}}function oa(e,t,n){var r=n.biff>8?4:2;return[e.read_shift(r),e.read_shift(r,"i"),e.read_shift(r,"i")]}function ca(e){return[e.read_shift(2),cr(e)]}function la(e){var t=e.read_shift(2),n=e.read_shift(2);return{s:{c:e.read_shift(2),r:t},e:{c:e.read_shift(2),r:n}}}function ua(e){var t=e.read_shift(2),n=e.read_shift(2);return{s:{c:e.read_shift(1),r:t},e:{c:e.read_shift(1),r:n}}}var da=ua;function ha(e){e.l+=4;var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2);return e.l+=12,[n,t,r]}function fa(e){e.l+=2,e.l+=e.read_shift(2)}var pa={0:fa,4:fa,5:fa,6:fa,7:function(e){return e.l+=4,e.cf=e.read_shift(2),{}},8:fa,9:fa,10:fa,11:fa,12:fa,13:function(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t},14:fa,15:fa,16:fa,17:fa,18:fa,19:fa,20:fa,21:ha};function ga(e,t){var n={BIFFVer:0,dt:0};switch(n.BIFFVer=e.read_shift(2),(t-=2)>=2&&(n.dt=e.read_shift(2),e.l-=2),n.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+n.BIFFVer)}return e.read_shift(t),n}function ma(e,t,n){var r=0;n&&2==n.biff||(r=e.read_shift(2));var a=e.read_shift(2);return n&&2==n.biff&&(r=1-(a>>15),a&=32767),[{Unsynced:1&r,DyZero:(2&r)>>1,ExAsc:(4&r)>>2,ExDsc:(8&r)>>3},a]}var va=ta;function ya(e,t,n){var r=e.l+t,a=8!=n.biff&&n.biff?2:4,i=e.read_shift(a),s=e.read_shift(a),o=e.read_shift(2),c=e.read_shift(2);return e.l=r,{s:{r:i,c:o},e:{r:s,c:c}}}function ba(e,t,n){var r=sa(e);2!=n.biff&&9!=t||++e.l;var a=function(e){var t=e.read_shift(1);return 1===e.read_shift(1)?t:1===t}(e);return r.val=a,r.t=!0===a||!1===a?"b":"e",r}var wa=function(e,t,n){return 0===t?"":ta(e,0,n)};function xa(e,t,n){var r,a=e.read_shift(2),i={fBuiltIn:1&a,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return 14849===n.sbcch&&(r=function(e,t,n){e.l+=4,t-=4;var r=e.l+t,a=Xr(e,0,n),i=e.read_shift(2);if(i!==(r-=e.l))throw new Error("Malformed AddinUdf: padding = "+r+" != "+i);return e.l+=i,a}(e,t-2,n)),i.body=r||e.read_shift(t-2),"string"===typeof r&&(i.Name=r),i}var Ea=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Ta(e,t,n){var r=e.l+t,a=e.read_shift(2),i=e.read_shift(1),s=e.read_shift(1),o=e.read_shift(n&&2==n.biff?1:2),c=0;(!n||n.biff>=5)&&(5!=n.biff&&(e.l+=2),c=e.read_shift(2),5==n.biff&&(e.l+=2),e.l+=4);var l=Zr(e,s,n);32&a&&(l=Ea[l.charCodeAt(0)]);var u=r-e.l;n&&2==n.biff&&--u;var d=r!=e.l&&0!==o&&u>0?function(e,t,n,r){var a,i=e.l+t,s=ds(e,r,n);i!==e.l&&(a=us(e,i-e.l,s,n));return[s,a]}(e,u,n,o):[];return{chKey:i,Name:l,itab:c,rgce:d}}function Sa(e,t,n){if(n.biff<8)return function(e,t,n){3==e[e.l+1]&&e[e.l]++;var r=Xr(e,0,n);return 3==r.charCodeAt(0)?r.slice(1):r}(e,0,n);for(var r=[],a=e.l+t,i=e.read_shift(n.biff>8?4:2);0!==i--;)r.push(oa(e,n.biff,n));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return r}function Ia(e,t,n){var r=da(e,6);switch(n.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[r,vs(e,t,n)]}var ka={8:function(e,t){var n=e.l+t;e.l+=10;var r=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=n,{fmt:r}}};function Ca(e,t,n){if(!n.cellStyles)return Nn(e,t);var r=n&&n.biff>=12?4:2,a=e.read_shift(r),i=e.read_shift(r),s=e.read_shift(r),o=e.read_shift(r),c=e.read_shift(2);2==r&&(e.l+=2);var l={s:a,e:i,w:s,ixfe:o,flags:c};return(n.biff>=5||!n.biff)&&(l.level=c>>8&7),l}var _a=sa,Aa=Qr,Na=ea;var Ra=[2,3,48,49,131,139,140,245],Oa=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Fe({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(t,n){var r=n||{};r.dateNF||(r.dateNF="yyyymmdd");var a=Xn(function(t,n){var r=[],a=O(1);switch(n.type){case"base64":a=P(A(t));break;case"binary":a=P(t);break;case"buffer":case"array":a=t}An(a,0);var i=a.read_shift(1),s=!!(136&i),o=!1,c=!1;switch(i){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:o=!0,s=!0;break;case 140:c=!0;break;default:throw new Error("DBF Unsupported Version: "+i.toString(16))}var l=0,u=521;2==i&&(l=a.read_shift(2)),a.l+=3,2!=i&&(l=a.read_shift(4)),l>1048576&&(l=1e6),2!=i&&(u=a.read_shift(2));var d=a.read_shift(2),h=n.codepage||1252;2!=i&&(a.l+=16,a.read_shift(1),0!==a[a.l]&&(h=e[a[a.l]]),a.l+=1,a.l+=2),c&&(a.l+=36);for(var f=[],p={},g=Math.min(a.length,2==i?521:u-10-(o?264:0)),m=c?32:11;a.l<g&&13!=a[a.l];)switch((p={}).name=T.utils.decode(h,a.slice(a.l,a.l+m)).replace(/[\u0000\r\n].*$/g,""),a.l+=m,p.type=String.fromCharCode(a.read_shift(1)),2==i||c||(p.offset=a.read_shift(4)),p.len=a.read_shift(1),2==i&&(p.offset=a.read_shift(2)),p.dec=a.read_shift(1),p.name.length&&f.push(p),2!=i&&(a.l+=c?13:14),p.type){case"B":o&&8==p.len||!n.WTF||console.log("Skipping "+p.name+":"+p.type);break;case"G":case"P":n.WTF&&console.log("Skipping "+p.name+":"+p.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+p.type)}if(13!==a[a.l]&&(a.l=u-1),13!==a.read_shift(1))throw new Error("DBF Terminator not found "+a.l+" "+a[a.l]);a.l=u;var v=0,y=0;for(r[0]=[],y=0;y!=f.length;++y)r[0][y]=f[y].name;for(;l-- >0;)if(42!==a[a.l])for(++a.l,r[++v]=[],y=0,y=0;y!=f.length;++y){var b=a.slice(a.l,a.l+f[y].len);a.l+=f[y].len,An(b,0);var w=T.utils.decode(h,b);switch(f[y].type){case"C":w.trim().length&&(r[v][y]=w.replace(/\s+$/,""));break;case"D":8===w.length?r[v][y]=new Date(+w.slice(0,4),+w.slice(4,6)-1,+w.slice(6,8)):r[v][y]=w;break;case"F":r[v][y]=parseFloat(w.trim());break;case"+":case"I":r[v][y]=c?2147483648^b.read_shift(-4,"i"):b.read_shift(4,"i");break;case"L":switch(w.trim().toUpperCase()){case"Y":case"T":r[v][y]=!0;break;case"N":case"F":r[v][y]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+w+"|")}break;case"M":if(!s)throw new Error("DBF Unexpected MEMO for type "+i.toString(16));r[v][y]="##MEMO##"+(c?parseInt(w.trim(),10):b.read_shift(4));break;case"N":(w=w.replace(/\u0000/g,"").trim())&&"."!=w&&(r[v][y]=+w||0);break;case"@":r[v][y]=new Date(b.read_shift(-8,"f")-621356832e5);break;case"T":r[v][y]=new Date(864e5*(b.read_shift(4)-2440588)+b.read_shift(4));break;case"Y":r[v][y]=b.read_shift(4,"i")/1e4+b.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":r[v][y]=-b.read_shift(-8,"f");break;case"B":if(o&&8==f[y].len){r[v][y]=b.read_shift(8,"f");break}case"G":case"P":b.l+=f[y].len;break;case"0":if("_NullFlags"===f[y].name)break;default:throw new Error("DBF Unsupported data type "+f[y].type)}}else a.l+=d;if(2!=i&&a.l<a.length&&26!=a[a.l++])throw new Error("DBF EOF Marker missing "+(a.l-1)+" of "+a.length+" "+a[a.l-1].toString(16));return n&&n.sheetRows&&(r=r.slice(0,n.sheetRows)),n.DBF=f,r}(t,r),r);return a["!cols"]=r.DBF.map((function(e){return{wch:e.len,DBF:e}})),delete r.DBF,a}var r={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function(e,t){try{return Yn(n(e,t),t)}catch(r){if(t&&t.WTF)throw r}return{SheetNames:[],Sheets:{}}},to_sheet:n,from_sheet:function(e,n){var a=n||{};if(+a.codepage>=0&&b(+a.codepage),"string"==a.type)throw new Error("Cannot write DBF to JS string");var i=Dn(),s=Pc(e,{header:1,raw:!0,cellDates:!0}),o=s[0],c=s.slice(1),l=e["!cols"]||[],u=0,d=0,h=0,f=1;for(u=0;u<o.length;++u)if(((l[u]||{}).DBF||{}).name)o[u]=l[u].DBF.name,++h;else if(null!=o[u]){if(++h,"number"===typeof o[u]&&(o[u]=o[u].toString(10)),"string"!==typeof o[u])throw new Error("DBF Invalid column name "+o[u]+" |"+typeof o[u]+"|");if(o.indexOf(o[u])!==u)for(d=0;d<1024;++d)if(-1==o.indexOf(o[u]+"_"+d)){o[u]+="_"+d;break}}var p=Wn(e["!ref"]),m=[],v=[],y=[];for(u=0;u<=p.e.c-p.s.c;++u){var w="",x="",E=0,T=[];for(d=0;d<c.length;++d)null!=c[d][u]&&T.push(c[d][u]);if(0!=T.length&&null!=o[u]){for(d=0;d<T.length;++d){switch(typeof T[d]){case"number":x="B";break;case"string":default:x="C";break;case"boolean":x="L";break;case"object":x=T[d]instanceof Date?"D":"C"}E=Math.max(E,String(T[d]).length),w=w&&w!=x?"C":x}E>250&&(E=250),"C"==(x=((l[u]||{}).DBF||{}).type)&&l[u].DBF.len>E&&(E=l[u].DBF.len),"B"==w&&"N"==x&&(w="N",y[u]=l[u].DBF.dec,E=l[u].DBF.len),v[u]="C"==w||"N"==x?E:r[w]||0,f+=v[u],m[u]=w}else m[u]="?"}var S=i.next(32);for(S.write_shift(4,318902576),S.write_shift(4,c.length),S.write_shift(2,296+32*h),S.write_shift(2,f),u=0;u<4;++u)S.write_shift(4,0);for(S.write_shift(4,(+t[g]||3)<<8),u=0,d=0;u<o.length;++u)if(null!=o[u]){var I=i.next(32),k=(o[u].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);I.write_shift(1,k,"sbcs"),I.write_shift(1,"?"==m[u]?"C":m[u],"sbcs"),I.write_shift(4,d),I.write_shift(1,v[u]||r[m[u]]||0),I.write_shift(1,y[u]||0),I.write_shift(1,2),I.write_shift(4,0),I.write_shift(1,0),I.write_shift(4,0),I.write_shift(4,0),d+=v[u]||r[m[u]]||0}var C=i.next(264);for(C.write_shift(4,13),u=0;u<65;++u)C.write_shift(4,0);for(u=0;u<c.length;++u){var _=i.next(f);for(_.write_shift(1,0),d=0;d<o.length;++d)if(null!=o[d])switch(m[d]){case"L":_.write_shift(1,null==c[u][d]?63:c[u][d]?84:70);break;case"B":_.write_shift(8,c[u][d]||0,"f");break;case"N":var A="0";for("number"==typeof c[u][d]&&(A=c[u][d].toFixed(y[d]||0)),h=0;h<v[d]-A.length;++h)_.write_shift(1,32);_.write_shift(1,A,"sbcs");break;case"D":c[u][d]?(_.write_shift(4,("0000"+c[u][d].getFullYear()).slice(-4),"sbcs"),_.write_shift(2,("00"+(c[u][d].getMonth()+1)).slice(-2),"sbcs"),_.write_shift(2,("00"+c[u][d].getDate()).slice(-2),"sbcs")):_.write_shift(8,"00000000","sbcs");break;case"C":var N=String(null!=c[u][d]?c[u][d]:"").slice(0,v[d]);for(_.write_shift(1,N,"sbcs"),h=0;h<v[d]-N.length;++h)_.write_shift(1,32)}}return i.next(1).write_shift(1,26),i.end()}}}(),Da=function(){var e={AA:"\xc0",BA:"\xc1",CA:"\xc2",DA:195,HA:"\xc4",JA:197,AE:"\xc8",BE:"\xc9",CE:"\xca",HE:"\xcb",AI:"\xcc",BI:"\xcd",CI:"\xce",HI:"\xcf",AO:"\xd2",BO:"\xd3",CO:"\xd4",DO:213,HO:"\xd6",AU:"\xd9",BU:"\xda",CU:"\xdb",HU:"\xdc",Aa:"\xe0",Ba:"\xe1",Ca:"\xe2",Da:227,Ha:"\xe4",Ja:229,Ae:"\xe8",Be:"\xe9",Ce:"\xea",He:"\xeb",Ai:"\xec",Bi:"\xed",Ci:"\xee",Hi:"\xef",Ao:"\xf2",Bo:"\xf3",Co:"\xf4",Do:245,Ho:"\xf6",Au:"\xf9",Bu:"\xfa",Cu:"\xfb",Hu:"\xfc",KC:"\xc7",Kc:"\xe7",q:"\xe6",z:"\u0153",a:"\xc6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1bN("+Me(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(t,n){var r=e[n];return"number"==typeof r?k(r):r},r=function(e,t,n){var r=t.charCodeAt(0)-32<<4|n.charCodeAt(0)-48;return 59==r?e:k(r)};function a(e,a){var i,s=e.split(/[\n\r]+/),o=-1,c=-1,l=0,u=0,d=[],h=[],f=null,p={},g=[],m=[],v=[],y=0;for(+a.codepage>=0&&b(+a.codepage);l!==s.length;++l){y=0;var w,x=s[l].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(t,n),E=x.replace(/;;/g,"\0").split(";").map((function(e){return e.replace(/\u0000/g,";")})),S=E[0];if(x.length>0)switch(S){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==E[1].charAt(0)&&h.push(x.slice(3).replace(/;;/g,";"));break;case"C":var I=!1,k=!1,C=!1,_=!1,A=-1,N=-1;for(u=1;u<E.length;++u)switch(E[u].charAt(0)){case"A":case"G":break;case"X":c=parseInt(E[u].slice(1))-1,k=!0;break;case"Y":for(o=parseInt(E[u].slice(1))-1,k||(c=0),i=d.length;i<=o;++i)d[i]=[];break;case"K":'"'===(w=E[u].slice(1)).charAt(0)?w=w.slice(1,w.length-1):"TRUE"===w?w=!0:"FALSE"===w?w=!1:isNaN(Je(w))?isNaN(et(w).getDate())||(w=qe(w)):(w=Je(w),null!==f&&Se(f)&&(w=$e(w))),"undefined"!==typeof T&&"string"==typeof w&&"string"!=(a||{}).type&&(a||{}).codepage&&(w=T.utils.decode(a.codepage,w)),I=!0;break;case"E":_=!0;var R=ji(E[u].slice(1),{r:o,c:c});d[o][c]=[d[o][c],R];break;case"S":C=!0,d[o][c]=[d[o][c],"S5S"];break;case"R":A=parseInt(E[u].slice(1))-1;break;case"C":N=parseInt(E[u].slice(1))-1;break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+x)}if(I&&(d[o][c]&&2==d[o][c].length?d[o][c][0]=w:d[o][c]=w,f=null),C){if(_)throw new Error("SYLK shared formula cannot have own formula");var O=A>-1&&d[A][N];if(!O||!O[1])throw new Error("SYLK shared formula cannot find base");d[o][c][1]=Vi(O[1],{r:o-A,c:c-N})}break;case"F":var D=0;for(u=1;u<E.length;++u)switch(E[u].charAt(0)){case"X":c=parseInt(E[u].slice(1))-1,++D;break;case"Y":for(o=parseInt(E[u].slice(1))-1,i=d.length;i<=o;++i)d[i]=[];break;case"M":y=parseInt(E[u].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":f=h[parseInt(E[u].slice(1))];break;case"W":for(v=E[u].slice(1).split(" "),i=parseInt(v[0],10);i<=parseInt(v[1],10);++i)y=parseInt(v[2],10),m[i-1]=0===y?{hidden:!0}:{wch:y},gi(m[i-1]);break;case"C":m[c=parseInt(E[u].slice(1))-1]||(m[c]={});break;case"R":g[o=parseInt(E[u].slice(1))-1]||(g[o]={}),y>0?(g[o].hpt=y,g[o].hpx=yi(y)):0===y&&(g[o].hidden=!0);break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+x)}D<1&&(f=null);break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+x)}}return g.length>0&&(p["!rows"]=g),m.length>0&&(p["!cols"]=m),a&&a.sheetRows&&(d=d.slice(0,a.sheetRows)),[d,p]}function i(e,t){var n=function(e,t){switch(t.type){case"base64":return a(A(e),t);case"binary":return a(e,t);case"buffer":return a(N&&Buffer.isBuffer(e)?e.toString("binary"):L(e),t);case"array":return a(Ye(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),r=n[0],i=n[1],s=Xn(r,t);return Me(i).forEach((function(e){s[e]=i[e]})),s}function s(e,t,n,r){var a="C;Y"+(n+1)+";X"+(r+1)+";K";switch(e.t){case"n":a+=e.v||0,e.f&&!e.F&&(a+=";E"+Bi(e.f,{r:n,c:r}));break;case"b":a+=e.v?"TRUE":"FALSE";break;case"e":a+=e.w||e.v;break;case"d":a+='"'+(e.w||e.v)+'"';break;case"s":a+='"'+e.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return a}return e["|"]=254,{to_workbook:function(e,t){return Yn(i(e,t),t)},to_sheet:i,from_sheet:function(e,t){var n,r,a=["ID;PWXL;N;E"],i=[],o=Wn(e["!ref"]),c=Array.isArray(e),l="\r\n";a.push("P;PGeneral"),a.push("F;P0;DG0G8;M255"),e["!cols"]&&(r=a,e["!cols"].forEach((function(e,t){var n="F;W"+(t+1)+" "+(t+1)+" ";e.hidden?n+="0":("number"!=typeof e.width||e.wpx||(e.wpx=ui(e.width)),"number"!=typeof e.wpx||e.wch||(e.wch=di(e.wpx)),"number"==typeof e.wch&&(n+=Math.round(e.wch)))," "!=n.charAt(n.length-1)&&r.push(n)}))),e["!rows"]&&function(e,t){t.forEach((function(t,n){var r="F;";t.hidden?r+="M0;":t.hpt?r+="M"+20*t.hpt+";":t.hpx&&(r+="M"+20*vi(t.hpx)+";"),r.length>2&&e.push(r+"R"+(n+1))}))}(a,e["!rows"]),a.push("B;Y"+(o.e.r-o.s.r+1)+";X"+(o.e.c-o.s.c+1)+";D"+[o.s.c,o.s.r,o.e.c,o.e.r].join(" "));for(var u=o.s.r;u<=o.e.r;++u)for(var d=o.s.c;d<=o.e.c;++d){var h=$n({r:u,c:d});(n=c?(e[u]||[])[d]:e[h])&&(null!=n.v||n.f&&!n.F)&&i.push(s(n,0,u,d))}return a.join(l)+l+i.join(l)+l+"E"+l}}}(),Pa=function(){function e(e,t){for(var n=e.split("\n"),r=-1,a=-1,i=0,s=[];i!==n.length;++i)if("BOT"!==n[i].trim()){if(!(r<0)){for(var o=n[i].trim().split(","),c=o[0],l=o[1],u=n[++i]||"";1&(u.match(/["]/g)||[]).length&&i<n.length-1;)u+="\n"+n[++i];switch(u=u.trim(),+c){case-1:if("BOT"===u){s[++r]=[],a=0;continue}if("EOD"!==u)throw new Error("Unrecognized DIF special command "+u);break;case 0:"TRUE"===u?s[r][a]=!0:"FALSE"===u?s[r][a]=!1:isNaN(Je(l))?isNaN(et(l).getDate())?s[r][a]=l:s[r][a]=qe(l):s[r][a]=Je(l),++a;break;case 1:(u=(u=u.slice(1,u.length-1)).replace(/""/g,'"'))&&u.match(/^=".*"$/)&&(u=u.slice(2,-1)),s[r][a++]=""!==u?u:null}if("EOD"===u)break}}else s[++r]=[],a=0;return t&&t.sheetRows&&(s=s.slice(0,t.sheetRows)),s}function t(t,n){return Xn(function(t,n){switch(n.type){case"base64":return e(A(t),n);case"binary":return e(t,n);case"buffer":return e(N&&Buffer.isBuffer(t)?t.toString("binary"):L(t),n);case"array":return e(Ye(t),n)}throw new Error("Unrecognized type "+n.type)}(t,n),n)}return{to_workbook:function(e,n){return Yn(t(e,n),n)},to_sheet:t,from_sheet:function(){var e=function(e,t,n,r,a){e.push(t),e.push(n+","+r),e.push('"'+a.replace(/"/g,'""')+'"')},t=function(e,t,n,r){e.push(t+","+n),e.push(1==t?'"'+r.replace(/"/g,'""')+'"':r)};return function(n){var r,a=[],i=Wn(n["!ref"]),s=Array.isArray(n);e(a,"TABLE",0,1,"sheetjs"),e(a,"VECTORS",0,i.e.r-i.s.r+1,""),e(a,"TUPLES",0,i.e.c-i.s.c+1,""),e(a,"DATA",0,0,"");for(var o=i.s.r;o<=i.e.r;++o){t(a,-1,0,"BOT");for(var c=i.s.c;c<=i.e.c;++c){var l=$n({r:o,c:c});if(r=s?(n[o]||[])[c]:n[l])switch(r.t){case"n":var u=r.w;u||null==r.v||(u=r.v),null==u?r.f&&!r.F?t(a,1,0,"="+r.f):t(a,1,0,""):t(a,0,u,"V");break;case"b":t(a,0,r.v?1:0,r.v?"TRUE":"FALSE");break;case"s":t(a,1,0,isNaN(r.v)?r.v:'="'+r.v+'"');break;case"d":r.w||(r.w=_e(r.z||Q[14],je(qe(r.v)))),t(a,0,r.w,"V");break;default:t(a,1,0,"")}else t(a,1,0,"")}}t(a,-1,0,"EOD");return a.join("\r\n")}}()}}(),La=function(){function e(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(e,t){return Xn(function(e,t){for(var n=e.split("\n"),r=-1,a=-1,i=0,s=[];i!==n.length;++i){var o=n[i].trim().split(":");if("cell"===o[0]){var c=Vn(o[1]);if(s.length<=c.r)for(r=s.length;r<=c.r;++r)s[r]||(s[r]=[]);switch(r=c.r,a=c.c,o[2]){case"t":s[r][a]=o[3].replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n");break;case"v":s[r][a]=+o[3];break;case"vtf":var l=o[o.length-1];case"vtc":"nl"===o[3]?s[r][a]=!!+o[4]:s[r][a]=+o[4],"vtf"==o[2]&&(s[r][a]=[s[r][a],l])}}}return t&&t.sheetRows&&(s=s.slice(0,t.sheetRows)),s}(e,t),t)}var n=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),r=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",a=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),i="--SocialCalcSpreadsheetControlSave--";function s(t){if(!t||!t["!ref"])return"";for(var n,r=[],a=[],i="",s=Hn(t["!ref"]),o=Array.isArray(t),c=s.s.r;c<=s.e.r;++c)for(var l=s.s.c;l<=s.e.c;++l)if(i=$n({r:c,c:l}),(n=o?(t[c]||[])[l]:t[i])&&null!=n.v&&"z"!==n.t){switch(a=["cell",i,"t"],n.t){case"s":case"str":a.push(e(n.v));break;case"n":n.f?(a[2]="vtf",a[3]="n",a[4]=n.v,a[5]=e(n.f)):(a[2]="v",a[3]=n.v);break;case"b":a[2]="vt"+(n.f?"f":"c"),a[3]="nl",a[4]=n.v?"1":"0",a[5]=e(n.f||(n.v?"TRUE":"FALSE"));break;case"d":var u=je(qe(n.v));a[2]="vtc",a[3]="nd",a[4]=""+u,a[5]=n.w||_e(n.z||Q[14],u);break;case"e":continue}r.push(a.join(":"))}return r.push("sheet:c:"+(s.e.c-s.s.c+1)+":r:"+(s.e.r-s.s.r+1)+":tvf:1"),r.push("valueformat:1:text-wiki"),r.join("\n")}return{to_workbook:function(e,n){return Yn(t(e,n),n)},to_sheet:t,from_sheet:function(e){return[n,r,a,r,s(e),i].join("\n")}}}(),Ma=function(){function e(e,t,n,r,a){a.raw?t[n][r]=e:""===e||("TRUE"===e?t[n][r]=!0:"FALSE"===e?t[n][r]=!1:isNaN(Je(e))?isNaN(et(e).getDate())?t[n][r]=e:t[n][r]=qe(e):t[n][r]=Je(e))}var t={44:",",9:"\t",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function r(e){for(var r={},a=!1,i=0,s=0;i<e.length;++i)34==(s=e.charCodeAt(i))?a=!a:!a&&s in t&&(r[s]=(r[s]||0)+1);for(i in s=[],r)Object.prototype.hasOwnProperty.call(r,i)&&s.push([r[i],i]);if(!s.length)for(i in r=n)Object.prototype.hasOwnProperty.call(r,i)&&s.push([r[i],i]);return s.sort((function(e,t){return e[0]-t[0]||n[e[1]]-n[t[1]]})),t[s.pop()[1]]||44}function a(e,t){var n=t||{},a="";var i=n.dense?[]:{},s={s:{c:0,r:0},e:{c:0,r:0}};"sep="==e.slice(0,4)?13==e.charCodeAt(5)&&10==e.charCodeAt(6)?(a=e.charAt(4),e=e.slice(7)):13==e.charCodeAt(5)||10==e.charCodeAt(5)?(a=e.charAt(4),e=e.slice(6)):a=r(e.slice(0,1024)):a=n&&n.FS?n.FS:r(e.slice(0,1024));var o=0,c=0,l=0,u=0,d=0,h=a.charCodeAt(0),f=!1,p=0,g=e.charCodeAt(0);e=e.replace(/\r\n/gm,"\n");var m=null!=n.dateNF?function(e){var t="number"==typeof e?Q[e]:e;return t=t.replace(Oe,"(\\d+)"),new RegExp("^"+t+"$")}(n.dateNF):null;function v(){var t=e.slice(u,d),r={};if('"'==t.charAt(0)&&'"'==t.charAt(t.length-1)&&(t=t.slice(1,-1).replace(/""/g,'"')),0===t.length)r.t="z";else if(n.raw)r.t="s",r.v=t;else if(0===t.trim().length)r.t="s",r.v=t;else if(61==t.charCodeAt(0))34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(r.t="s",r.v=t.slice(2,-1).replace(/""/g,'"')):1!=t.length?(r.t="n",r.f=t.slice(1)):(r.t="s",r.v=t);else if("TRUE"==t)r.t="b",r.v=!0;else if("FALSE"==t)r.t="b",r.v=!1;else if(isNaN(l=Je(t)))if(!isNaN(et(t).getDate())||m&&t.match(m)){r.z=n.dateNF||Q[14];var a=0;m&&t.match(m)&&(t=function(e,t,n){var r=-1,a=-1,i=-1,s=-1,o=-1,c=-1;(t.match(Oe)||[]).forEach((function(e,t){var l=parseInt(n[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":r=l;break;case"d":i=l;break;case"h":s=l;break;case"s":c=l;break;case"m":s>=0?o=l:a=l}})),c>=0&&-1==o&&a>=0&&(o=a,a=-1);var l=(""+(r>=0?r:(new Date).getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);7==l.length&&(l="0"+l),8==l.length&&(l="20"+l);var u=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return-1==s&&-1==o&&-1==c?l:-1==r&&-1==a&&-1==i?u:l+"T"+u}(0,n.dateNF,t.match(m)||[]),a=1),n.cellDates?(r.t="d",r.v=qe(t,a)):(r.t="n",r.v=je(qe(t,a))),!1!==n.cellText&&(r.w=_e(r.z,r.v instanceof Date?je(r.v):r.v)),n.cellNF||delete r.z}else r.t="s",r.v=t;else r.t="n",!1!==n.cellText&&(r.w=t),r.v=l;if("z"==r.t||(n.dense?(i[o]||(i[o]=[]),i[o][c]=r):i[$n({c:c,r:o})]=r),u=d+1,g=e.charCodeAt(u),s.e.c<c&&(s.e.c=c),s.e.r<o&&(s.e.r=o),p==h)++c;else if(c=0,++o,n.sheetRows&&n.sheetRows<=o)return!0}e:for(;d<e.length;++d)switch(p=e.charCodeAt(d)){case 34:34===g&&(f=!f);break;case h:case 10:case 13:if(!f&&v())break e}return d-u>0&&v(),i["!ref"]=Gn(s),i}function i(t,n){return n&&n.PRN?n.FS||"sep="==t.slice(0,4)||t.indexOf("\t")>=0||t.indexOf(",")>=0||t.indexOf(";")>=0?a(t,n):Xn(function(t,n){var r=n||{},a=[];if(!t||0===t.length)return a;for(var i=t.split(/[\r\n]/),s=i.length-1;s>=0&&0===i[s].length;)--s;for(var o=10,c=0,l=0;l<=s;++l)-1==(c=i[l].indexOf(" "))?c=i[l].length:c++,o=Math.max(o,c);for(l=0;l<=s;++l){a[l]=[];var u=0;for(e(i[l].slice(0,o).trim(),a,l,u,r),u=1;u<=(i[l].length-o)/10+1;++u)e(i[l].slice(o+10*(u-1),o+10*u).trim(),a,l,u,r)}return r.sheetRows&&(a=a.slice(0,r.sheetRows)),a}(t,n),n):a(t,n)}function s(e,t){var n="",r="string"==t.type?[0,0,0,0]:Ac(e,t);switch(t.type){case"base64":n=A(e);break;case"binary":case"string":n=e;break;case"buffer":n=65001==t.codepage?e.toString("utf8"):t.codepage&&"undefined"!==typeof T?T.utils.decode(t.codepage,e):N&&Buffer.isBuffer(e)?e.toString("binary"):L(e);break;case"array":n=Ye(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==r[0]&&187==r[1]&&191==r[2]?n=Dt(n.slice(3)):"string"!=t.type&&"buffer"!=t.type&&65001==t.codepage?n=Dt(n):"binary"==t.type&&"undefined"!==typeof T&&t.codepage&&(n=T.utils.decode(t.codepage,T.utils.encode(28591,n))),"socialcalc:version:"==n.slice(0,19)?La.to_sheet("string"==t.type?n:Dt(n),t):i(n,t)}return{to_workbook:function(e,t){return Yn(s(e,t),t)},to_sheet:s,from_sheet:function(e){for(var t,n=[],r=Wn(e["!ref"]),a=Array.isArray(e),i=r.s.r;i<=r.e.r;++i){for(var s=[],o=r.s.c;o<=r.e.c;++o){var c=$n({r:i,c:o});if((t=a?(e[i]||[])[o]:e[c])&&null!=t.v){for(var l=(t.w||(qn(t),t.w)||"").slice(0,10);l.length<10;)l+=" ";s.push(l+(0===o?" ":""))}else s.push("          ")}n.push(s.join(""))}return n.join("\n")}}}();var Fa=function(){function e(e,t,n){if(e){An(e,e.l||0);for(var r=n.Enum||v;e.l<e.length;){var a=e.read_shift(2),i=r[a]||r[65535],s=e.read_shift(2),o=e.l+s,c=i.f&&i.f(e,s,n);if(e.l=o,t(c,i,a))return}}}function t(t,n){if(!t)return t;var r=n||{};var a=r.dense?[]:{},i="Sheet1",s="",o=0,c={},l=[],u=[],d={s:{r:0,c:0},e:{r:0,c:0}},h=r.sheetRows||0;if(0==t[2]&&(8==t[3]||9==t[3])&&t.length>=16&&5==t[14]&&108===t[15])throw new Error("Unsupported Works 3 for Mac file");if(2==t[2])r.Enum=v,e(t,(function(e,t,n){switch(n){case 0:r.vers=e,e>=4096&&(r.qpro=!0);break;case 6:d=e;break;case 204:e&&(s=e);break;case 222:s=e;break;case 15:case 51:r.qpro||(e[1].v=e[1].v.slice(1));case 13:case 14:case 16:14==n&&112==(112&e[2])&&(15&e[2])>1&&(15&e[2])<15&&(e[1].z=r.dateNF||Q[14],r.cellDates&&(e[1].t="d",e[1].v=$e(e[1].v))),r.qpro&&e[3]>o&&(a["!ref"]=Gn(d),c[i]=a,l.push(i),a=r.dense?[]:{},d={s:{r:0,c:0},e:{r:0,c:0}},o=e[3],i=s||"Sheet"+(o+1),s="");var u=r.dense?(a[e[0].r]||[])[e[0].c]:a[$n(e[0])];if(u){u.t=e[1].t,u.v=e[1].v,null!=e[1].z&&(u.z=e[1].z),null!=e[1].f&&(u.f=e[1].f);break}r.dense?(a[e[0].r]||(a[e[0].r]=[]),a[e[0].r][e[0].c]=e[1]):a[$n(e[0])]=e[1]}}),r);else{if(26!=t[2]&&14!=t[2])throw new Error("Unrecognized LOTUS BOF "+t[2]);r.Enum=y,14==t[2]&&(r.qpro=!0,t.l=0),e(t,(function(e,t,n){switch(n){case 204:i=e;break;case 22:e[1].v=e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(e[3]>o&&(a["!ref"]=Gn(d),c[i]=a,l.push(i),a=r.dense?[]:{},d={s:{r:0,c:0},e:{r:0,c:0}},o=e[3],i="Sheet"+(o+1)),h>0&&e[0].r>=h)break;r.dense?(a[e[0].r]||(a[e[0].r]=[]),a[e[0].r][e[0].c]=e[1]):a[$n(e[0])]=e[1],d.e.c<e[0].c&&(d.e.c=e[0].c),d.e.r<e[0].r&&(d.e.r=e[0].r);break;case 27:e[14e3]&&(u[e[14e3][0]]=e[14e3][1]);break;case 1537:u[e[0]]=e[1],e[0]==o&&(i=e[1])}}),r)}if(a["!ref"]=Gn(d),c[s||i]=a,l.push(s||i),!u.length)return{SheetNames:l,Sheets:c};for(var f={},p=[],g=0;g<u.length;++g)c[l[g]]?(p.push(u[g]||l[g]),f[u[g]]=c[u[g]]||c[l[g]]):(p.push(u[g]),f[u[g]]={"!ref":"A1"});return{SheetNames:p,Sheets:f}}function n(e,t,n){var r=[{c:0,r:0},{t:"n",v:0},0,0];return n.qpro&&20768!=n.vers?(r[0].c=e.read_shift(1),r[3]=e.read_shift(1),r[0].r=e.read_shift(2),e.l+=2):(r[2]=e.read_shift(1),r[0].c=e.read_shift(2),r[0].r=e.read_shift(2)),r}function r(e,t,r){var a=e.l+t,i=n(e,0,r);if(i[1].t="s",20768==r.vers){e.l++;var s=e.read_shift(1);return i[1].v=e.read_shift(s,"utf8"),i}return r.qpro&&e.l++,i[1].v=e.read_shift(a-e.l,"cstr"),i}function a(e,t,n){var r=Rn(7+n.length);r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(1,39);for(var a=0;a<r.length;++a){var i=n.charCodeAt(a);r.write_shift(1,i>=128?95:i)}return r.write_shift(1,0),r}function i(e,t,n){var r=Rn(7);return r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(2,n,"i"),r}function s(e,t,n){var r=Rn(13);return r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(8,n,"f"),r}function o(e,t,n){var r=32768&t;return t=(r?e:0)+((t&=-32769)>=8192?t-16384:t),(r?"":"$")+(n?Bn(t):jn(t))}var c={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},l=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function u(e){var t=[{c:0,r:0},{t:"n",v:0},0];return t[0].r=e.read_shift(2),t[3]=e[e.l++],t[0].c=e[e.l++],t}function d(e,t,n,r){var a=Rn(6+r.length);a.write_shift(2,e),a.write_shift(1,n),a.write_shift(1,t),a.write_shift(1,39);for(var i=0;i<r.length;++i){var s=r.charCodeAt(i);a.write_shift(1,s>=128?95:s)}return a.write_shift(1,0),a}function h(e,t){var n=u(e),r=e.read_shift(4),a=e.read_shift(4),i=e.read_shift(2);if(65535==i)return 0===r&&3221225472===a?(n[1].t="e",n[1].v=15):0===r&&3489660928===a?(n[1].t="e",n[1].v=42):n[1].v=0,n;var s=32768&i;return i=(32767&i)-16446,n[1].v=(1-2*s)*(a*Math.pow(2,i+32)+r*Math.pow(2,i)),n}function f(e,t,n,r){var a=Rn(14);if(a.write_shift(2,e),a.write_shift(1,n),a.write_shift(1,t),0==r)return a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,65535),a;var i,s=0,o=0,c=0;return r<0&&(s=1,r=-r),o=0|Math.log2(r),0==(2147483648&(c=(r/=Math.pow(2,o-31))>>>0))&&(++o,c=(r/=2)>>>0),r-=c,c|=2147483648,c>>>=0,i=(r*=Math.pow(2,32))>>>0,a.write_shift(4,i),a.write_shift(4,c),o+=16383+(s?32768:0),a.write_shift(2,o),a}function p(e,t){var n=u(e),r=e.read_shift(8,"f");return n[1].v=r,n}function g(e,t){return 0==e[e.l+t-1]?e.read_shift(t,"cstr"):""}function m(e,t){var n=Rn(5+e.length);n.write_shift(2,14e3),n.write_shift(2,t);for(var r=0;r<e.length;++r){var a=e.charCodeAt(r);n[n.l++]=a>127?95:a}return n[n.l++]=0,n}var v={0:{n:"BOF",f:Yr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e,t,n){var r={s:{c:0,r:0},e:{c:0,r:0}};return 8==t&&n.qpro?(r.s.c=e.read_shift(1),e.l++,r.s.r=e.read_shift(2),r.e.c=e.read_shift(1),e.l++,r.e.r=e.read_shift(2),r):(r.s.c=e.read_shift(2),r.s.r=e.read_shift(2),12==t&&n.qpro&&(e.l+=2),r.e.c=e.read_shift(2),r.e.r=e.read_shift(2),12==t&&n.qpro&&(e.l+=2),65535==r.s.c&&(r.s.c=r.e.c=r.s.r=r.e.r=0),r)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,t,r){var a=n(e,0,r);return a[1].v=e.read_shift(2,"i"),a}},14:{n:"NUMBER",f:function(e,t,r){var a=n(e,0,r);return a[1].v=e.read_shift(8,"f"),a}},15:{n:"LABEL",f:r},16:{n:"FORMULA",f:function(e,t,r){var a=e.l+t,i=n(e,0,r);if(i[1].v=e.read_shift(8,"f"),r.qpro)e.l=a;else{var s=e.read_shift(2);!function(e,t){An(e,0);var n=[],r=0,a="",i="",s="",u="";for(;e.l<e.length;){var d=e[e.l++];switch(d){case 0:n.push(e.read_shift(8,"f"));break;case 1:i=o(t[0].c,e.read_shift(2),!0),a=o(t[0].r,e.read_shift(2),!1),n.push(i+a);break;case 2:var h=o(t[0].c,e.read_shift(2),!0),f=o(t[0].r,e.read_shift(2),!1);i=o(t[0].c,e.read_shift(2),!0),a=o(t[0].r,e.read_shift(2),!1),n.push(h+f+":"+i+a);break;case 3:if(e.l<e.length)return void console.error("WK1 premature formula end");break;case 4:n.push("("+n.pop()+")");break;case 5:n.push(e.read_shift(2));break;case 6:for(var p="";d=e[e.l++];)p+=String.fromCharCode(d);n.push('"'+p.replace(/"/g,'""')+'"');break;case 8:n.push("-"+n.pop());break;case 23:n.push("+"+n.pop());break;case 22:n.push("NOT("+n.pop()+")");break;case 20:case 21:u=n.pop(),s=n.pop(),n.push(["AND","OR"][d-20]+"("+s+","+u+")");break;default:if(d<32&&l[d])u=n.pop(),s=n.pop(),n.push(s+l[d]+u);else{if(!c[d])return d<=7?console.error("WK1 invalid opcode "+d.toString(16)):d<=24?console.error("WK1 unsupported op "+d.toString(16)):d<=30?console.error("WK1 invalid opcode "+d.toString(16)):d<=115?console.error("WK1 unsupported function opcode "+d.toString(16)):console.error("WK1 unrecognized opcode "+d.toString(16));if(69==(r=c[d][1])&&(r=e[e.l++]),r>n.length)return void console.error("WK1 bad formula parse 0x"+d.toString(16)+":|"+n.join("|")+"|");var g=n.slice(-r);n.length-=r,n.push(c[d][0]+"("+g.join(",")+")")}}}1==n.length?t[1].f=""+n[0]:console.error("WK1 bad formula parse |"+n.join("|")+"|")}(e.slice(e.l,e.l+s),i),e.l+=s}return i}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:r},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:g},222:{n:"SHEETNAMELP",f:function(e,t){var n=e[e.l++];n>t-1&&(n=t-1);for(var r="";r.length<n;)r+=String.fromCharCode(e[e.l++]);return r}},65535:{n:""}},y={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(e,t){var n=u(e);return n[1].t="s",n[1].v=e.read_shift(t-4,"cstr"),n}},23:{n:"NUMBER17",f:h},24:{n:"NUMBER18",f:function(e,t){var n=u(e);n[1].v=e.read_shift(2);var r=n[1].v>>1;if(1&n[1].v)switch(7&r){case 0:r=5e3*(r>>3);break;case 1:r=500*(r>>3);break;case 2:r=(r>>3)/20;break;case 3:r=(r>>3)/200;break;case 4:r=(r>>3)/2e3;break;case 5:r=(r>>3)/2e4;break;case 6:r=(r>>3)/16;break;case 7:r=(r>>3)/64}return n[1].v=r,n}},25:{n:"FORMULA19",f:function(e,t){var n=h(e);return e.l+=t-14,n}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(e,t){for(var n={},r=e.l+t;e.l<r;){var a=e.read_shift(2);if(14e3==a){for(n[a]=[0,""],n[a][0]=e.read_shift(2);e[e.l];)n[a][1]+=String.fromCharCode(e[e.l]),e.l++;e.l++}}return n}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(e,t){var n=u(e),r=e.read_shift(4);return n[1].v=r>>6,n}},38:{n:"??"},39:{n:"NUMBER27",f:p},40:{n:"FORMULA28",f:function(e,t){var n=p(e);return e.l+=t-10,n}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:g},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(e,t,n){if(n.qpro&&!(t<21)){var r=e.read_shift(1);return e.l+=17,e.l+=1,e.l+=2,[r,e.read_shift(t-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function(e,t){var n=t||{};if(+n.codepage>=0&&b(+n.codepage),"string"==n.type)throw new Error("Cannot write WK1 to JS string");var r=Dn(),o=Wn(e["!ref"]),c=Array.isArray(e),l=[];$o(r,0,function(e){var t=Rn(2);return t.write_shift(2,e),t}(1030)),$o(r,6,function(e){var t=Rn(8);return t.write_shift(2,e.s.c),t.write_shift(2,e.s.r),t.write_shift(2,e.e.c),t.write_shift(2,e.e.r),t}(o));for(var u=Math.min(o.e.r,8191),d=o.s.r;d<=u;++d)for(var h=jn(d),f=o.s.c;f<=o.e.c;++f){d===o.s.r&&(l[f]=Bn(f));var p=l[f]+h,g=c?(e[d]||[])[f]:e[p];if(g&&"z"!=g.t)if("n"==g.t)(0|g.v)==g.v&&g.v>=-32768&&g.v<=32767?$o(r,13,i(d,f,g.v)):$o(r,14,s(d,f,g.v));else $o(r,15,a(d,f,qn(g).slice(0,239)))}return $o(r,1),r.end()},book_to_wk3:function(e,t){var n=t||{};if(+n.codepage>=0&&b(+n.codepage),"string"==n.type)throw new Error("Cannot write WK3 to JS string");var r=Dn();$o(r,0,function(e){var t=Rn(26);t.write_shift(2,4096),t.write_shift(2,4),t.write_shift(4,0);for(var n=0,r=0,a=0,i=0;i<e.SheetNames.length;++i){var s=e.SheetNames[i],o=e.Sheets[s];if(o&&o["!ref"]){++a;var c=Hn(o["!ref"]);n<c.e.r&&(n=c.e.r),r<c.e.c&&(r=c.e.c)}}n>8191&&(n=8191);return t.write_shift(2,n),t.write_shift(1,a),t.write_shift(1,r),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,1),t.write_shift(1,2),t.write_shift(4,0),t.write_shift(4,0),t}(e));for(var a=0,i=0;a<e.SheetNames.length;++a)(e.Sheets[e.SheetNames[a]]||{})["!ref"]&&$o(r,27,m(e.SheetNames[a],i++));var s=0;for(a=0;a<e.SheetNames.length;++a){var o=e.Sheets[e.SheetNames[a]];if(o&&o["!ref"]){for(var c=Wn(o["!ref"]),l=Array.isArray(o),u=[],h=Math.min(c.e.r,8191),p=c.s.r;p<=h;++p)for(var g=jn(p),v=c.s.c;v<=c.e.c;++v){p===c.s.r&&(u[v]=Bn(v));var y=u[v]+g,w=l?(o[p]||[])[v]:o[y];if(w&&"z"!=w.t)if("n"==w.t)$o(r,23,f(p,v,s,w.v));else $o(r,22,d(p,v,s,qn(w).slice(0,239)))}++s}}return $o(r,1),r.end()},to_workbook:function(e,n){switch(n.type){case"base64":return t(P(A(e)),n);case"binary":return t(P(e),n);case"buffer":case"array":return t(e,n)}throw"Unsupported type "+n.type}}}();var za=function(){var e=Lt("t"),t=Lt("rPr");function n(n){var r=n.match(e);if(!r)return{t:"s",v:""};var a={t:"s",v:Tt(r[1])},i=n.match(t);return i&&(a.s=function(e){var t={},n=e.match(mt),r=0,a=!1;if(n)for(;r!=n.length;++r){var i=bt(n[r]);switch(i[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if("1"==i.val)break;t.cp=v[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting"}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if("0"==i.val)break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if("0"==i.val)break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":case"<scheme>":case"<scheme/>":case"</scheme>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(47!==i[0].charCodeAt(1)&&!a)throw new Error("Unrecognized rich format "+i[0])}}return t}(i[1])),a}var r=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(e){return e.replace(r,"").split(a).map(n).filter((function(e){return e.v}))}}(),ja=function(){var e=/(\r\n|\n)/g;function t(t){var n=[[],t.v,[]];return t.v?(t.s&&function(e,t,n){var r=[];e.u&&r.push("text-decoration: underline;"),e.uval&&r.push("text-underline-style:"+e.uval+";"),e.sz&&r.push("font-size:"+e.sz+"pt;"),e.outline&&r.push("text-effect: outline;"),e.shadow&&r.push("text-shadow: auto;"),t.push('<span style="'+r.join("")+'">'),e.b&&(t.push("<b>"),n.push("</b>")),e.i&&(t.push("<i>"),n.push("</i>")),e.strike&&(t.push("<s>"),n.push("</s>"));var a=e.valign||"";"superscript"==a||"super"==a?a="sup":"subscript"==a&&(a="sub"),""!=a&&(t.push("<"+a+">"),n.push("</"+a+">")),n.push("</span>")}(t.s,n[0],n[2]),n[0].join("")+n[1].replace(e,"<br/>")+n[2].join("")):""}return function(e){return e.map(t).join("")}}(),Ua=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Ba=/<(?:\w+:)?r>/,Va=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function $a(e,t){var n=!t||t.cellHTML,r={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=Tt(Dt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=Dt(e),n&&(r.h=kt(r.t))):e.match(Ba)&&(r.r=Dt(e),r.t=Tt(Dt((e.replace(Va,"").match(Ua)||[]).join("").replace(mt,""))),n&&(r.h=ja(za(r.r)))),r):{t:""}}var Ha=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Ga=/<(?:\w+:)?(?:si|sstItem)>/g,Wa=/<\/(?:\w+:)?(?:si|sstItem)>/;function Ka(e){if("undefined"!==typeof T)return T.utils.encode(g,e);for(var t=[],n=e.split(""),r=0;r<n.length;++r)t[r]=n[r].charCodeAt(0);return t}function qa(e,t){var n={};return n.Major=e.read_shift(2),n.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),n}function Ya(e){for(var t=e.read_shift(4),n=e.l+t-4,r={},a=e.read_shift(4),i=[];a-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(r.name=e.read_shift(0,"lpp4"),r.comps=i,e.l!=n)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+n);return r}function Qa(e){var t=function(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=qa(e,4),t.U=qa(e,4),t.W=qa(e,4),t}(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),4!=e.read_shift(4))throw new Error("Bad !Primary record");return t}function Xa(e,t){var n=e.l+t,r={};r.Flags=63&e.read_shift(4),e.l+=4,r.AlgID=e.read_shift(4);var a=!1;switch(r.AlgID){case 26126:case 26127:case 26128:a=36==r.Flags;break;case 26625:a=4==r.Flags;break;case 0:a=16==r.Flags||4==r.Flags||36==r.Flags;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=e.read_shift(4),r.KeySize=e.read_shift(4),r.ProviderType=e.read_shift(4),e.l+=8,r.CSPName=e.read_shift(n-e.l>>1,"utf16le"),e.l=n,r}function Ja(e,t){var n={},r=e.l+t;return e.l+=4,n.Salt=e.slice(e.l,e.l+16),e.l+=16,n.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),n.VerifierHash=e.slice(e.l,r),e.l=r,n}function Za(e){if(36!=(63&e.read_shift(4)))throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4);return{t:"Std",h:Xa(e,t),v:Ja(e,e.length-e.l)}}function ei(){throw new Error("File is password-protected: ECMA-376 Extensible")}function ti(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var n=e.read_shift(e.length-e.l,"utf8"),r={};return n.replace(mt,(function(e){var n=bt(e);switch(wt(n[0])){case"<?xml":case"<encryption":case"</encryption>":case"</keyEncryptors>":case"</keyEncryptor>":break;case"<keyData":t.forEach((function(e){r[e]=n[e]}));break;case"<dataIntegrity":r.encryptedHmacKey=n.encryptedHmacKey,r.encryptedHmacValue=n.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"<keyEncryptor":r.uri=n.uri;break;case"<encryptedKey":r.encs.push(n);break;default:throw n[0]}})),r}function ni(e){var t,n,r=0,a=Ka(e),i=a.length+1;for((t=O(i))[0]=a.length,n=1;n!=i;++n)t[n]=a[n-1];for(n=i-1;n>=0;--n)r=((0===(16384&r)?0:1)|r<<1&32767)^t[n];return 52811^r}var ri=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],n=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(e,t){return 255&((n=e^t)/2|128*n);var n};return function(a){for(var i,s,o,c=Ka(a),l=function(e){for(var r=t[e.length-1],a=104,i=e.length-1;i>=0;--i)for(var s=e[i],o=0;7!=o;++o)64&s&&(r^=n[a]),s*=2,--a;return r}(c),u=c.length,d=O(16),h=0;16!=h;++h)d[h]=0;for(1===(1&u)&&(i=l>>8,d[u]=r(e[0],i),--u,i=255&l,s=c[c.length-1],d[u]=r(s,i));u>0;)i=l>>8,d[--u]=r(c[u],i),i=255&l,d[--u]=r(c[u],i);for(u=15,o=15-c.length;o>0;)i=l>>8,d[u]=r(e[o],i),--o,i=255&l,d[--u]=r(c[u],i),--u,--o;return d}}(),ai=function(e){var t=0,n=ri(e);return function(e){var r=function(e,t,n,r,a){var i,s;for(a||(a=t),r||(r=ri(e)),i=0;i!=t.length;++i)s=t[i],s=255&((s^=r[n])>>5|s<<3),a[i]=s,++n;return[a,n,r]}("",e,t,n);return t=r[1],r[0]}};function ii(e,t,n){var r=n||{};return r.Info=e.read_shift(2),e.l-=2,1===r.Info?r.Data=function(e){var t={},n=t.EncryptionVersionInfo=qa(e,4);if(1!=n.Major||1!=n.Minor)throw"unrecognized version code "+n.Major+" : "+n.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}(e):r.Data=function(e,t){var n={},r=n.EncryptionVersionInfo=qa(e,4);if(t-=4,2!=r.Minor)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);n.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,n.EncryptionHeader=Xa(e,a),t-=a,n.EncryptionVerifier=Ja(e,t),n}(e,t),r}var si=function(){function e(e,n){switch(n.type){case"base64":return t(A(e),n);case"binary":return t(e,n);case"buffer":return t(N&&Buffer.isBuffer(e)?e.toString("binary"):L(e),n);case"array":return t(Ye(e),n)}throw new Error("Unrecognized type "+n.type)}function t(e,t){var n=(t||{}).dense?[]:{},r=e.match(/\\trowd.*?\\row\b/g);if(!r.length)throw new Error("RTF missing table");var a={s:{c:0,r:0},e:{c:0,r:r.length-1}};return r.forEach((function(e,t){Array.isArray(n)&&(n[t]=[]);for(var r,i=/\\\w+\b/g,s=0,o=-1;r=i.exec(e);){if("\\cell"===r[0]){var c=e.slice(s,i.lastIndex-r[0].length);if(" "==c[0]&&(c=c.slice(1)),++o,c.length){var l={v:c,t:"s"};Array.isArray(n)?n[t][o]=l:n[$n({r:t,c:o})]=l}}s=i.lastIndex}o>a.e.c&&(a.e.c=o)})),n["!ref"]=Gn(a),n}return{to_workbook:function(t,n){return Yn(e(t,n),n)},to_sheet:e,from_sheet:function(e){for(var t,n=["{\\rtf1\\ansi"],r=Wn(e["!ref"]),a=Array.isArray(e),i=r.s.r;i<=r.e.r;++i){n.push("\\trowd\\trautofit1");for(var s=r.s.c;s<=r.e.c;++s)n.push("\\cellx"+(s+1));for(n.push("\\pard\\intbl"),s=r.s.c;s<=r.e.c;++s){var o=$n({r:i,c:s});(t=a?(e[i]||[])[s]:e[o])&&(null!=t.v||t.f&&!t.F)&&(n.push(" "+(t.w||(qn(t),t.w))),n.push("\\cell"))}n.push("\\pard\\intbl\\row")}return n.join("")+"}"}}}();function oi(e){for(var t=0,n=1;3!=t;++t)n=256*n+(e[t]>255?255:e[t]<0?0:e[t]);return n.toString(16).toUpperCase().slice(1)}function ci(e,t){if(0===t)return e;var n=function(e){var t=e[0]/255,n=e[1]/255,r=e[2]/255,a=Math.max(t,n,r),i=Math.min(t,n,r),s=a-i;if(0===s)return[0,0,t];var o,c=0,l=a+i;switch(o=s/(l>1?2-l:l),a){case t:c=((n-r)/s+6)%6;break;case n:c=(r-t)/s+2;break;case r:c=(t-n)/s+4}return[c/6,o,l/2]}(function(e){var t=e.slice("#"===e[0]?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}(e));return n[2]=t<0?n[2]*(1+t):1-(1-n[2])*(1-t),oi(function(e){var t,n=e[0],r=e[1],a=e[2],i=2*r*(a<.5?a:1-a),s=a-i/2,o=[s,s,s],c=6*n;if(0!==r)switch(0|c){case 0:case 6:t=i*c,o[0]+=i,o[1]+=t;break;case 1:t=i*(2-c),o[0]+=t,o[1]+=i;break;case 2:t=i*(c-2),o[1]+=i,o[2]+=t;break;case 3:t=i*(4-c),o[1]+=t,o[2]+=i;break;case 4:t=i*(c-4),o[2]+=i,o[0]+=t;break;case 5:t=i*(6-c),o[2]+=t,o[0]+=i}for(var l=0;3!=l;++l)o[l]=Math.round(255*o[l]);return o}(n))}var li=6;function ui(e){return Math.floor((e+Math.round(128/li)/256)*li)}function di(e){return Math.floor((e-5)/li*100+.5)/100}function hi(e){return Math.round((e*li+5)/li*256)/256}function fi(e){return hi(di(ui(e)))}function pi(e){var t=Math.abs(e-fi(e)),n=li;if(t>.005)for(li=1;li<15;++li)Math.abs(e-fi(e))<=t&&(t=Math.abs(e-fi(e)),n=li);li=n}function gi(e){e.width?(e.wpx=ui(e.width),e.wch=di(e.wpx),e.MDW=li):e.wpx?(e.wch=di(e.wpx),e.width=hi(e.wch),e.MDW=li):"number"==typeof e.wch&&(e.width=hi(e.wch),e.wpx=ui(e.width),e.MDW=li),e.customWidth&&delete e.customWidth}var mi=96;function vi(e){return 96*e/mi}function yi(e){return e*mi/96}var bi={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};var wi=["numFmtId","fillId","fontId","borderId","xfId"],xi=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];var Ei=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,r=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(i,s,o){var c,l={};return i?((c=(i=i.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(e))&&function(e,t,n){t.NumberFmt=[];for(var r=Me(Q),a=0;a<r.length;++a)t.NumberFmt[r[a]]=Q[r[a]];var i=e[0].match(mt);if(i)for(a=0;a<i.length;++a){var s=bt(i[a]);switch(wt(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":case"</numFmt>":break;case"<numFmt":var o=Tt(Dt(s.formatCode)),c=parseInt(s.numFmtId,10);if(t.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&null!=t.NumberFmt[c];--c);t.NumberFmt[c]=o}Ae(o,c)}break;default:if(n.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}(c,l,o),(c=i.match(r))&&function(e,t,n,r){t.Fonts=[];var a={},i=!1;(e[0].match(mt)||[]).forEach((function(e){var s=bt(e);switch(wt(s[0])){case"<fonts":case"<fonts>":case"</fonts>":case"<font":case"<font>":case"<name/>":case"</name>":case"<sz/>":case"</sz>":case"<vertAlign/>":case"</vertAlign>":case"<family/>":case"</family>":case"<scheme/>":case"</scheme>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":s.val&&(a.name=Dt(s.val));break;case"<b":a.bold=s.val?_t(s.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=s.val?_t(s.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(s.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=s.val?_t(s.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=s.val?_t(s.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=s.val?_t(s.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=s.val?_t(s.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=s.val?_t(s.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":s.val&&(a.sz=+s.val);break;case"<vertAlign":s.val&&(a.vertAlign=s.val);break;case"<family":s.val&&(a.family=parseInt(s.val,10));break;case"<scheme":s.val&&(a.scheme=s.val);break;case"<charset":if("1"==s.val)break;s.codepage=v[parseInt(s.val,10)];break;case"<color":if(a.color||(a.color={}),s.auto&&(a.color.auto=_t(s.auto)),s.rgb)a.color.rgb=s.rgb.slice(-6);else if(s.indexed){a.color.index=parseInt(s.indexed,10);var o=wr[a.color.index];81==a.color.index&&(o=wr[1]),o||(o=wr[1]),a.color.rgb=o[0].toString(16)+o[1].toString(16)+o[2].toString(16)}else s.theme&&(a.color.theme=parseInt(s.theme,10),s.tint&&(a.color.tint=parseFloat(s.tint)),s.theme&&n.themeElements&&n.themeElements.clrScheme&&(a.color.rgb=ci(n.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<AlternateContent":case"<ext":i=!0;break;case"</AlternateContent>":case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+s[0]+" in fonts")}}))}(c,l,s,o),(c=i.match(n))&&function(e,t,n,r){t.Fills=[];var a={},i=!1;(e[0].match(mt)||[]).forEach((function(e){var n=bt(e);switch(wt(n[0])){case"<fills":case"<fills>":case"</fills>":case"</fill>":case"<gradientFill>":case"<patternFill/>":case"</patternFill>":case"<bgColor/>":case"</bgColor>":case"<fgColor/>":case"</fgColor>":case"<stop":case"<stop/>":case"</stop>":case"<color":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":n.patternType&&(a.patternType=n.patternType);break;case"<bgColor":a.bgColor||(a.bgColor={}),n.indexed&&(a.bgColor.indexed=parseInt(n.indexed,10)),n.theme&&(a.bgColor.theme=parseInt(n.theme,10)),n.tint&&(a.bgColor.tint=parseFloat(n.tint)),n.rgb&&(a.bgColor.rgb=n.rgb.slice(-6));break;case"<fgColor":a.fgColor||(a.fgColor={}),n.theme&&(a.fgColor.theme=parseInt(n.theme,10)),n.tint&&(a.fgColor.tint=parseFloat(n.tint)),null!=n.rgb&&(a.fgColor.rgb=n.rgb.slice(-6));break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+n[0]+" in fills")}}))}(c,l,0,o),(c=i.match(a))&&function(e,t,n,r){t.Borders=[];var a={},i=!1;(e[0].match(mt)||[]).forEach((function(e){var n=bt(e);switch(wt(n[0])){case"<borders":case"<borders>":case"</borders>":case"</border>":case"<left/>":case"<left":case"<left>":case"</left>":case"<right/>":case"<right":case"<right>":case"</right>":case"<top/>":case"<top":case"<top>":case"</top>":case"<bottom/>":case"<bottom":case"<bottom>":case"</bottom>":case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":case"<start":case"<start>":case"<start/>":case"</start>":case"<end":case"<end>":case"<end/>":case"</end>":case"<color":case"<color>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<border":case"<border>":case"<border/>":a={},n.diagonalUp&&(a.diagonalUp=_t(n.diagonalUp)),n.diagonalDown&&(a.diagonalDown=_t(n.diagonalDown)),t.Borders.push(a);break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+n[0]+" in borders")}}))}(c,l,0,o),(c=i.match(t))&&function(e,t,n){var r;t.CellXf=[];var a=!1;(e[0].match(mt)||[]).forEach((function(e){var i=bt(e),s=0;switch(wt(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":case"</xf>":case"</alignment>":case"<protection":case"</protection>":case"<protection/>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<xf":case"<xf/>":for(delete(r=i)[0],s=0;s<wi.length;++s)r[wi[s]]&&(r[wi[s]]=parseInt(r[wi[s]],10));for(s=0;s<xi.length;++s)r[xi[s]]&&(r[xi[s]]=_t(r[xi[s]]));if(t.NumberFmt&&r.numFmtId>392)for(s=392;s>60;--s)if(t.NumberFmt[r.numFmtId]==t.NumberFmt[s]){r.numFmtId=s;break}t.CellXf.push(r);break;case"<alignment":case"<alignment/>":var o={};i.vertical&&(o.vertical=i.vertical),i.horizontal&&(o.horizontal=i.horizontal),null!=i.textRotation&&(o.textRotation=i.textRotation),i.indent&&(o.indent=i.indent),i.wrapText&&(o.wrapText=_t(i.wrapText)),r.alignment=o;break;case"<AlternateContent":case"<ext":a=!0;break;case"</AlternateContent>":case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+i[0]+" in cellXfs")}}))}(c,l,o),l):l}}();var Ti=Nn;var Si=Nn;var Ii=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function ki(e,t,n){t.themeElements.clrScheme=[];var r={};(e[0].match(mt)||[]).forEach((function(e){var a=bt(e);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=a.val;break;case"<a:sysClr":r.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===a[0].charAt(1)?(t.themeElements.clrScheme[Ii.indexOf(a[0])]=r,r={}):r.name=a[0].slice(3,a[0].length-1);break;default:if(n&&n.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}}))}function Ci(){}function _i(){}var Ai=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Ni=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Ri=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;var Oi=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Di(e,t){var n;e&&0!==e.length||(e=Pi());var r={};if(!(n=e.match(Oi)))throw new Error("themeElements not found in theme");return function(e,t,n){var r;t.themeElements={},[["clrScheme",Ai,ki],["fontScheme",Ni,Ci],["fmtScheme",Ri,_i]].forEach((function(a){if(!(r=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](r,t,n)}))}(n[0],r,t),r.raw=e,r}function Pi(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;var n=[ft];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',n[n.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',n[n.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',n[n.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',n[n.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',n[n.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',n[n.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function Li(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:case 4:e.l+=4;break;case 1:t.xclrValue=function(e,t){return Nn(e,t)}(e,4);break;case 2:t.xclrValue=aa(e);break;case 3:t.xclrValue=function(e){return e.read_shift(4)}(e)}return e.l+=8,t}function Mi(e){var t=e.read_shift(2),n=e.read_shift(2)-4,r=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=Li(e);break;case 6:r[1]=function(e,t){return Nn(e,t)}(e,n);break;case 14:case 15:r[1]=e.read_shift(1===n?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+n)}return r}function Fi(e,t,n,r){var a,i=Array.isArray(e);t.forEach((function(t){var s=Vn(t.ref);if(i?(e[s.r]||(e[s.r]=[]),a=e[s.r][s.c]):a=e[t.ref],!a){a={t:"z"},i?e[s.r][s.c]=a:e[t.ref]=a;var o=Wn(e["!ref"]||"BDWGO1000001:A1");o.s.r>s.r&&(o.s.r=s.r),o.e.r<s.r&&(o.e.r=s.r),o.s.c>s.c&&(o.s.c=s.c),o.e.c<s.c&&(o.e.c=s.c);var c=Gn(o);c!==e["!ref"]&&(e["!ref"]=c)}a.c||(a.c=[]);var l={a:t.author,t:t.t,r:t.r,T:n};t.h&&(l.h=t.h);for(var u=a.c.length-1;u>=0;--u){if(!n&&a.c[u].T)return;n&&!a.c[u].T&&a.c.splice(u,1)}if(n&&r)for(u=0;u<r.length;++u)if(l.a==r[u].id){l.a=r[u].name||l.a;break}a.c.push(l)}))}var zi=Jn;var ji=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function n(e,n,r,a){var i=!1,s=!1;0==r.length?s=!0:"["==r.charAt(0)&&(s=!0,r=r.slice(1,-1)),0==a.length?i=!0:"["==a.charAt(0)&&(i=!0,a=a.slice(1,-1));var o=r.length>0?0|parseInt(r,10):0,c=a.length>0?0|parseInt(a,10):0;return i?c+=t.c:--c,s?o+=t.r:--o,n+(i?"":"$")+Bn(c)+(s?"":"$")+jn(o)}return function(r,a){return t=a,r.replace(e,n)}}(),Ui=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Bi=function(){return function(e,t){return e.replace(Ui,(function(e,n,r,a,i,s){var o=Un(a)-(r?0:t.c),c=zn(s)-(i?0:t.r);return n+"R"+(0==c?"":i?c+1:"["+c+"]")+"C"+(0==o?"":r?o+1:"["+o+"]")}))}}();function Vi(e,t){return e.replace(Ui,(function(e,n,r,a,i,s){return n+("$"==r?r+a:Bn(Un(a)+t.c))+("$"==i?i+s:jn(zn(s)+t.r))}))}function $i(e,t,n){var r=Hn(t).s,a=Vn(n);return Vi(e,{r:a.r-r.r,c:a.c-r.c})}function Hi(e){return e.replace(/_xlfn\./g,"")}function Gi(e){e.l+=1}function Wi(e,t){var n=e.read_shift(1==t?1:2);return[16383&n,n>>14&1,n>>15&1]}function Ki(e,t,n){var r=2;if(n){if(n.biff>=2&&n.biff<=5)return qi(e);12==n.biff&&(r=4)}var a=e.read_shift(r),i=e.read_shift(r),s=Wi(e,2),o=Wi(e,2);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function qi(e){var t=Wi(e,2),n=Wi(e,2),r=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:r,cRel:t[1],rRel:t[2]},e:{r:n[0],c:a,cRel:n[1],rRel:n[2]}}}function Yi(e,t,n){if(n&&n.biff>=2&&n.biff<=5)return function(e){var t=Wi(e,2),n=e.read_shift(1);return{r:t[0],c:n,cRel:t[1],rRel:t[2]}}(e);var r=e.read_shift(n&&12==n.biff?4:2),a=Wi(e,2);return{r:r,c:a[0],cRel:a[1],rRel:a[2]}}function Qi(e){var t=e.read_shift(2),n=e.read_shift(2);return{r:t,c:255&n,fQuoted:!!(16384&n),cRel:n>>15,rRel:n>>15}}function Xi(e){var t=1&e[e.l+1];return e.l+=4,[t,1]}function Ji(e){return[e.read_shift(1),e.read_shift(1)]}function Zi(e,t){var n=[e.read_shift(1)];if(12==t)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2}switch(n[0]){case 4:n[1]=qr(e,1)?"TRUE":"FALSE",12!=t&&(e.l+=7);break;case 37:case 16:n[1]=xr[e[e.l]],e.l+=12==t?4:8;break;case 0:e.l+=8;break;case 1:n[1]=dr(e);break;case 2:n[1]=ta(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function es(e,t,n){for(var r=e.read_shift(12==n.biff?4:2),a=[],i=0;i!=r;++i)a.push((12==n.biff?ur:la)(e,8));return a}function ts(e,t,n){var r=0,a=0;12==n.biff?(r=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),r=1+e.read_shift(2)),n.biff>=2&&n.biff<8&&(--r,0==--a&&(a=256));for(var i=0,s=[];i!=r&&(s[i]=[]);++i)for(var o=0;o!=a;++o)s[i][o]=Zi(e,n.biff);return s}function ns(e,t,n){return e.l+=2,[Qi(e)]}function rs(e){return e.l+=6,[]}function as(e){return e.l+=2,[Yr(e),1&e.read_shift(2)]}var is=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];var ss={1:{n:"PtgExp",f:function(e,t,n){return e.l++,n&&12==n.biff?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(n&&2==n.biff?1:2)]}},2:{n:"PtgTbl",f:Nn},3:{n:"PtgAdd",f:Gi},4:{n:"PtgSub",f:Gi},5:{n:"PtgMul",f:Gi},6:{n:"PtgDiv",f:Gi},7:{n:"PtgPower",f:Gi},8:{n:"PtgConcat",f:Gi},9:{n:"PtgLt",f:Gi},10:{n:"PtgLe",f:Gi},11:{n:"PtgEq",f:Gi},12:{n:"PtgGe",f:Gi},13:{n:"PtgGt",f:Gi},14:{n:"PtgNe",f:Gi},15:{n:"PtgIsect",f:Gi},16:{n:"PtgUnion",f:Gi},17:{n:"PtgRange",f:Gi},18:{n:"PtgUplus",f:Gi},19:{n:"PtgUminus",f:Gi},20:{n:"PtgPercent",f:Gi},21:{n:"PtgParen",f:Gi},22:{n:"PtgMissArg",f:Gi},23:{n:"PtgStr",f:function(e,t,n){return e.l++,Xr(e,0,n)}},26:{n:"PtgSheet",f:function(e,t,n){return e.l+=5,e.l+=2,e.l+=2==n.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(e,t,n){return e.l+=2==n.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(e){return e.l++,xr[e.read_shift(1)]}},29:{n:"PtgBool",f:function(e){return e.l++,0!==e.read_shift(1)}},30:{n:"PtgInt",f:function(e){return e.l++,e.read_shift(2)}},31:{n:"PtgNum",f:function(e){return e.l++,dr(e)}},32:{n:"PtgArray",f:function(e,t,n){var r=(96&e[e.l++])>>5;return e.l+=2==n.biff?6:12==n.biff?14:7,[r]}},33:{n:"PtgFunc",f:function(e,t,n){var r=(96&e[e.l])>>5;e.l+=1;var a=e.read_shift(n&&n.biff<=3?1:2);return[Cs[a],ks[a],r]}},34:{n:"PtgFuncVar",f:function(e,t,n){var r=e[e.l++],a=e.read_shift(1),i=n&&n.biff<=3?[88==r?-1:0,e.read_shift(1)]:function(e){return[e[e.l+1]>>7,32767&e.read_shift(2)]}(e);return[a,(0===i[0]?ks:Is)[i[1]]]}},35:{n:"PtgName",f:function(e,t,n){var r=e.read_shift(1)>>>5&3,a=!n||n.biff>=8?4:2,i=e.read_shift(a);switch(n.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[r,0,i]}},36:{n:"PtgRef",f:function(e,t,n){var r=(96&e[e.l])>>5;return e.l+=1,[r,Yi(e,0,n)]}},37:{n:"PtgArea",f:function(e,t,n){return[(96&e[e.l++])>>5,Ki(e,n.biff>=2&&n.biff,n)]}},38:{n:"PtgMemArea",f:function(e,t,n){var r=e.read_shift(1)>>>5&3;return e.l+=n&&2==n.biff?3:4,[r,e.read_shift(n&&2==n.biff?1:2)]}},39:{n:"PtgMemErr",f:Nn},40:{n:"PtgMemNoMem",f:Nn},41:{n:"PtgMemFunc",f:function(e,t,n){return[e.read_shift(1)>>>5&3,e.read_shift(n&&2==n.biff?1:2)]}},42:{n:"PtgRefErr",f:function(e,t,n){var r=e.read_shift(1)>>>5&3;return e.l+=4,n.biff<8&&e.l--,12==n.biff&&(e.l+=2),[r]}},43:{n:"PtgAreaErr",f:function(e,t,n){var r=(96&e[e.l++])>>5;return e.l+=n&&n.biff>8?12:n.biff<8?6:8,[r]}},44:{n:"PtgRefN",f:function(e,t,n){var r=(96&e[e.l])>>5;e.l+=1;var a=function(e,t,n){var r=n&&n.biff?n.biff:8;if(r>=2&&r<=5)return function(e){var t=e.read_shift(2),n=e.read_shift(1),r=(32768&t)>>15,a=(16384&t)>>14;return t&=16383,1==r&&t>=8192&&(t-=16384),1==a&&n>=128&&(n-=256),{r:t,c:n,cRel:a,rRel:r}}(e);var a=e.read_shift(r>=12?4:2),i=e.read_shift(2),s=(16384&i)>>14,o=(32768&i)>>15;if(i&=16383,1==o)for(;a>524287;)a-=1048576;if(1==s)for(;i>8191;)i-=16384;return{r:a,c:i,cRel:s,rRel:o}}(e,0,n);return[r,a]}},45:{n:"PtgAreaN",f:function(e,t,n){var r=(96&e[e.l++])>>5,a=function(e,t,n){if(n.biff<8)return qi(e);var r=e.read_shift(12==n.biff?4:2),a=e.read_shift(12==n.biff?4:2),i=Wi(e,2),s=Wi(e,2);return{s:{r:r,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}(e,0,n);return[r,a]}},46:{n:"PtgMemAreaN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},57:{n:"PtgNameX",f:function(e,t,n){return 5==n.biff?function(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[t,n,r]}(e):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}},58:{n:"PtgRef3d",f:function(e,t,n){var r=(96&e[e.l])>>5;e.l+=1;var a=e.read_shift(2);return n&&5==n.biff&&(e.l+=12),[r,a,Yi(e,0,n)]}},59:{n:"PtgArea3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,a=e.read_shift(2,"i");if(n)switch(n.biff){case 5:e.l+=12;break;case 12:0}return[r,a,Ki(e,0,n)]}},60:{n:"PtgRefErr3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,a=e.read_shift(2),i=4;if(n)switch(n.biff){case 5:i=15;break;case 12:i=6}return e.l+=i,[r,a]}},61:{n:"PtgAreaErr3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,a=e.read_shift(2),i=8;if(n)switch(n.biff){case 5:e.l+=12,i=6;break;case 12:i=12}return e.l+=i,[r,a]}},255:{}},os={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},cs={1:{n:"PtgElfLel",f:as},2:{n:"PtgElfRw",f:ns},3:{n:"PtgElfCol",f:ns},6:{n:"PtgElfRwV",f:ns},7:{n:"PtgElfColV",f:ns},10:{n:"PtgElfRadical",f:ns},11:{n:"PtgElfRadicalS",f:rs},13:{n:"PtgElfColS",f:rs},15:{n:"PtgElfColSV",f:rs},16:{n:"PtgElfRadicalLel",f:as},25:{n:"PtgList",f:function(e){e.l+=2;var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2);return{ixti:t,coltype:3&n,rt:is[n>>2&31],idx:r,c:a,C:i}}},29:{n:"PtgSxName",f:function(e){return e.l+=2,[e.read_shift(4)]}},255:{}},ls={0:{n:"PtgAttrNoop",f:function(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=n&&2==n.biff?3:4,[r]}},2:{n:"PtgAttrIf",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e.read_shift(n&&2==n.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(e,t,n){e.l+=2;for(var r=e.read_shift(n&&2==n.biff?1:2),a=[],i=0;i<=r;++i)a.push(e.read_shift(n&&2==n.biff?1:2));return a}},8:{n:"PtgAttrGoto",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e.read_shift(n&&2==n.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(e,t,n){e.l+=n&&2==n.biff?3:4}},32:{n:"PtgAttrBaxcel",f:Xi},33:{n:"PtgAttrBaxcel",f:Xi},64:{n:"PtgAttrSpace",f:function(e){return e.read_shift(2),Ji(e)}},65:{n:"PtgAttrSpaceSemi",f:function(e){return e.read_shift(2),Ji(e)}},128:{n:"PtgAttrIfError",f:function(e){var t=255&e[e.l+1]?1:0;return e.l+=2,[t,e.read_shift(2)]}},255:{}};function us(e,t,n,r){if(r.biff<8)return Nn(e,t);for(var a=e.l+t,i=[],s=0;s!==n.length;++s)switch(n[s][0]){case"PtgArray":n[s][1]=ts(e,0,r),i.push(n[s][1]);break;case"PtgMemArea":n[s][2]=es(e,n[s][1],r),i.push(n[s][2]);break;case"PtgExp":r&&12==r.biff&&(n[s][1][1]=e.read_shift(4),i.push(n[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[s][0]}return 0!==(t=a-e.l)&&i.push(Nn(e,t)),i}function ds(e,t,n){for(var r,a,i=e.l+t,s=[];i!=e.l;)t=i-e.l,a=e[e.l],r=ss[a]||ss[os[a]],24!==a&&25!==a||(r=(24===a?cs:ls)[e[e.l+1]]),r&&r.f?s.push([r.n,r.f(e,t,n)]):Nn(e,t);return s}function hs(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n],a=[],i=0;i<r.length;++i){var s=r[i];if(s)if(2===s[0])a.push('"'+s[1].replace(/"/g,'""')+'"');else a.push(s[1]);else a.push("")}t.push(a.join(","))}return t.join(";")}var fs={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function ps(e,t,n){if(!e)return"SH33TJSERR0";if(n.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[t];if(n.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),0==t?"":e.XTI[t-1];if(!r)return"SH33TJSERR1";var a="";if(n.biff>8)switch(e[r[0]][0]){case 357:return a=-1==r[1]?"#REF":e.SheetNames[r[1]],r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 358:return null!=n.SID?e.SheetNames[n.SID]:"SH33TJSSAME"+e[r[0]][0];default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return a=-1==r[1]?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map((function(e){return e.Name})).join(";;");default:return e[r[0]][0][3]?(a=-1==r[1]?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?a:a+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function gs(e,t,n){var r=ps(e,t,n);return"#REF"==r?r:function(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}(r,n)}function ms(e,t,n,r,a){var i,s,o,c,l=a&&a.biff||8,u={s:{c:0,r:0},e:{c:0,r:0}},d=[],h=0,f=0,p="";if(!e[0]||!e[0][0])return"";for(var g=-1,m="",v=0,y=e[0].length;v<y;++v){var b=e[0][v];switch(b[0]){case"PtgUminus":d.push("-"+d.pop());break;case"PtgUplus":d.push("+"+d.pop());break;case"PtgPercent":d.push(d.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(i=d.pop(),s=d.pop(),g>=0){switch(e[0][g][1][0]){case 0:m=Xe(" ",e[0][g][1][1]);break;case 1:m=Xe("\r",e[0][g][1][1]);break;default:if(m="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}s+=m,g=-1}d.push(s+fs[b[0]]+i);break;case"PtgIsect":i=d.pop(),s=d.pop(),d.push(s+" "+i);break;case"PtgUnion":i=d.pop(),s=d.pop(),d.push(s+","+i);break;case"PtgRange":i=d.pop(),s=d.pop(),d.push(s+":"+i);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":o=Pn(b[1][1],u,a),d.push(Mn(o,l));break;case"PtgRefN":o=n?Pn(b[1][1],n,a):b[1][1],d.push(Mn(o,l));break;case"PtgRef3d":h=b[1][1],o=Pn(b[1][2],u,a);p=gs(r,h,a);d.push(p+"!"+Mn(o,l));break;case"PtgFunc":case"PtgFuncVar":var w=b[1][0],x=b[1][1];w||(w=0);var E=0==(w&=127)?[]:d.slice(-w);d.length-=w,"User"===x&&(x=E.shift()),d.push(x+"("+E.join(",")+")");break;case"PtgBool":d.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":d.push(b[1]);break;case"PtgNum":d.push(String(b[1]));break;case"PtgStr":d.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":c=Ln(b[1][1],n?{s:n}:u,a),d.push(Fn(c,a));break;case"PtgArea":c=Ln(b[1][1],u,a),d.push(Fn(c,a));break;case"PtgArea3d":h=b[1][1],c=b[1][2],p=gs(r,h,a),d.push(p+"!"+Fn(c,a));break;case"PtgAttrSum":d.push("SUM("+d.pop()+")");break;case"PtgName":f=b[1][2];var T=(r.names||[])[f-1]||(r[0]||[])[f],S=T?T.Name:"SH33TJSNAME"+String(f);S&&"_xlfn."==S.slice(0,6)&&!a.xlfn&&(S=S.slice(6)),d.push(S);break;case"PtgNameX":var I,k=b[1][1];if(f=b[1][2],!(a.biff<=5)){var C="";if(14849==((r[k]||[])[0]||[])[0]||(1025==((r[k]||[])[0]||[])[0]?r[k][f]&&r[k][f].itab>0&&(C=r.SheetNames[r[k][f].itab-1]+"!"):C=r.SheetNames[f-1]+"!"),r[k]&&r[k][f])C+=r[k][f].Name;else if(r[0]&&r[0][f])C+=r[0][f].Name;else{var _=(ps(r,k,a)||"").split(";;");_[f-1]?C=_[f-1]:C+="SH33TJSERRX"}d.push(C);break}k<0&&(k=-k),r[k]&&(I=r[k][f]),I||(I={Name:"SH33TJSERRY"}),d.push(I.Name);break;case"PtgParen":var A="(",N=")";if(g>=0){switch(m="",e[0][g][1][0]){case 2:A=Xe(" ",e[0][g][1][1])+A;break;case 3:A=Xe("\r",e[0][g][1][1])+A;break;case 4:N=Xe(" ",e[0][g][1][1])+N;break;case 5:N=Xe("\r",e[0][g][1][1])+N;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}d.push(A+d.pop()+N);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":d.push("#REF!");break;case"PtgExp":o={c:b[1][1],r:b[1][0]};var R={c:n.c,r:n.r};if(r.sharedf[$n(o)]){var O=r.sharedf[$n(o)];d.push(ms(O,u,R,r,a))}else{var D=!1;for(i=0;i!=r.arrayf.length;++i)if(s=r.arrayf[i],!(o.c<s[0].s.c||o.c>s[0].e.c)&&!(o.r<s[0].s.r||o.r>s[0].e.r)){d.push(ms(s[1],u,R,r,a)),D=!0;break}D||d.push(b[1])}break;case"PtgArray":d.push("{"+hs(b[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=v;break;case"PtgMissArg":d.push("");break;case"PtgList":d.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(b))}if(3!=a.biff&&g>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][v][0])){var P=!0;switch((b=e[0][g])[1][0]){case 4:P=!1;case 0:m=Xe(" ",b[1][1]);break;case 5:P=!1;case 1:m=Xe("\r",b[1][1]);break;default:if(m="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}d.push((P?m:"")+d.pop()+(P?"":m)),g=-1}}if(d.length>1&&a.WTF)throw new Error("bad formula stack");return d[0]}function vs(e,t,n){var r,a=e.l+t,i=2==n.biff?1:2,s=e.read_shift(i);if(65535==s)return[[],Nn(e,t-2)];var o=ds(e,s,n);return t!==s+i&&(r=us(e,t-s-i,o,n)),e.l=a,[o,r]}function ys(e,t,n){var r,a=e.l+t,i=e.read_shift(2),s=ds(e,i,n);return 65535==i?[[],Nn(e,t-2)]:(t!==i+2&&(r=us(e,a-i-2,s,n)),[s,r])}function bs(e,t,n){var r=e.l+t,a=sa(e);2==n.biff&&++e.l;var i=function(e){var t;if(65535!==yn(e,e.l+6))return[dr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=1===e[e.l+2],e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}(e),s=e.read_shift(1);2!=n.biff&&(e.read_shift(1),n.biff>=5&&e.read_shift(4));var o=function(e,t,n){var r,a=e.l+t,i=2==n.biff?1:2,s=e.read_shift(i);if(65535==s)return[[],Nn(e,t-2)];var o=ds(e,s,n);return t!==s+i&&(r=us(e,t-s-i,o,n)),e.l=a,[o,r]}(e,r-e.l,n);return{cell:a,val:i[0],formula:o,shared:s>>3&1,tt:i[1]}}function ws(e,t,n){var r=e.read_shift(4),a=ds(e,r,n),i=e.read_shift(4);return[a,i>0?us(e,i,a,n):null]}var xs=ws,Es=ws,Ts=ws,Ss=ws,Is={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},ks={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Cs={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function _s(e){return"of:"==e.slice(0,3)&&(e=e.slice(3)),61==e.charCodeAt(0)&&61==(e=e.slice(1)).charCodeAt(0)&&(e=e.slice(1)),(e=(e=(e=e.replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,(function(e,t){return t.replace(/\./g,"")}))).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function As(e){var t=e.split(":");return[t[0].split(".")[0],t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var Ns={},Rs={};function Os(e,t){if(e){var n=[.7,.7,.75,.75,.3,.3];"xlml"==t&&(n=[1,1,1,1,.5,.5]),null==e.left&&(e.left=n[0]),null==e.right&&(e.right=n[1]),null==e.top&&(e.top=n[2]),null==e.bottom&&(e.bottom=n[3]),null==e.header&&(e.header=n[4]),null==e.footer&&(e.footer=n[5])}}function Ds(e,t,n,r,a,i){try{r.cellNF&&(e.z=Q[t])}catch(o){if(r.WTF)throw o}if("z"!==e.t||r.cellStyles){if("d"===e.t&&"string"===typeof e.v&&(e.v=qe(e.v)),(!r||!1!==r.cellText)&&"z"!==e.t)try{if(null==Q[t]&&Ae(Re[t]||"General",t),"e"===e.t)e.w=e.w||xr[e.v];else if(0===t)if("n"===e.t)(0|e.v)===e.v?e.w=e.v.toString(10):e.w=se(e.v);else if("d"===e.t){var s=je(e.v);e.w=(0|s)===s?s.toString(10):se(s)}else{if(void 0===e.v)return"";e.w=oe(e.v,Rs)}else"d"===e.t?e.w=_e(t,je(e.v),Rs):e.w=_e(t,e.v,Rs)}catch(o){if(r.WTF)throw o}if(r.cellStyles&&null!=n)try{e.s=i.Fills[n],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=ci(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),r.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=ci(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),r.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(r.WTF&&i.Fills)throw o}}}var Ps=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Ls=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Ms=/<(?:\w:)?hyperlink [^>]*>/gm,Fs=/"(\w*:\w*)"/,zs=/<(?:\w:)?col\b[^>]*[\/]?>/g,js=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Us=/<(?:\w:)?pageMargins[^>]*\/>/g,Bs=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Vs=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,$s=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Hs(e,t,n,r,a,i,s){if(!e)return e;r||(r={"!id":{}});var o=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},l="",u="",d=e.match(Ls);d?(l=e.slice(0,d.index),u=e.slice(d.index+d[0].length)):l=u=e;var h=l.match(Bs);h?Gs(h[0],o,a,n):(h=l.match(Vs))&&function(e,t,n,r,a){Gs(e.slice(0,e.indexOf(">")),n,r,a)}(h[0],h[1],o,a,n);var f=(l.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(f>0){var p=l.slice(f,f+50).match(Fs);p&&function(e,t){var n=Wn(t);n.s.r<=n.e.r&&n.s.c<=n.e.c&&n.s.r>=0&&n.s.c>=0&&(e["!ref"]=Gn(n))}(o,p[1])}var g=l.match($s);g&&g[1]&&function(e,t){t.Views||(t.Views=[{}]);(e.match(Ws)||[]).forEach((function(e,n){var r=bt(e);t.Views[n]||(t.Views[n]={}),+r.zoomScale&&(t.Views[n].zoom=+r.zoomScale),_t(r.rightToLeft)&&(t.Views[n].RTL=!0)}))}(g[1],a);var m=[];if(t.cellStyles){var v=l.match(zs);v&&function(e,t){for(var n=!1,r=0;r!=t.length;++r){var a=bt(t[r],!0);a.hidden&&(a.hidden=_t(a.hidden));var i=parseInt(a.min,10)-1,s=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!n&&a.width&&(n=!0,pi(a.width)),gi(a);i<=s;)e[i++]=Qe(a)}}(m,v)}d&&Ks(d[1],o,t,c,i,s);var y=u.match(js);y&&(o["!autofilter"]=function(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}(y[0]));var b=[],w=u.match(Ps);if(w)for(f=0;f!=w.length;++f)b[f]=Wn(w[f].slice(w[f].indexOf('"')+1));var x=u.match(Ms);x&&function(e,t,n){for(var r=Array.isArray(e),a=0;a!=t.length;++a){var i=bt(Dt(t[a]),!0);if(!i.ref)return;var s=((n||{})["!id"]||[])[i.id];s?(i.Target=s.Target,i.location&&(i.Target+="#"+Tt(i.location))):(i.Target="#"+Tt(i.location),s={Target:i.Target,TargetMode:"Internal"}),i.Rel=s,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=Wn(i.ref),c=o.s.r;c<=o.e.r;++c)for(var l=o.s.c;l<=o.e.c;++l){var u=$n({c:l,r:c});r?(e[c]||(e[c]=[]),e[c][l]||(e[c][l]={t:"z",v:void 0}),e[c][l].l=i):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=i)}}}(o,x,r);var E=u.match(Us);if(E&&(o["!margins"]=function(e){var t={};return["left","right","top","bottom","header","footer"].forEach((function(n){e[n]&&(t[n]=parseFloat(e[n]))})),t}(bt(E[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=Gn(c)),t.sheetRows>0&&o["!ref"]){var T=Wn(o["!ref"]);t.sheetRows<=+T.e.r&&(T.e.r=t.sheetRows-1,T.e.r>c.e.r&&(T.e.r=c.e.r),T.e.r<T.s.r&&(T.s.r=T.e.r),T.e.c>c.e.c&&(T.e.c=c.e.c),T.e.c<T.s.c&&(T.s.c=T.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Gn(T))}return m.length>0&&(o["!cols"]=m),b.length>0&&(o["!merges"]=b),o}function Gs(e,t,n,r){var a=bt(e);n.Sheets[r]||(n.Sheets[r]={}),a.codeName&&(n.Sheets[r].CodeName=Tt(Dt(a.codeName)))}var Ws=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;var Ks=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,n=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=Lt("v"),s=Lt("f");return function(o,c,l,u,d,h){for(var f,p,g,m,v,y=0,b="",w=[],x=[],E=0,T=0,S=0,I="",k=0,C=0,_=0,A=0,N=Array.isArray(h.CellXf),R=[],O=[],D=Array.isArray(c),P=[],L={},M=!1,F=!!l.sheetStubs,z=o.split(t),j=0,U=z.length;j!=U;++j){var B=(b=z[j].trim()).length;if(0!==B){var V=0;e:for(y=0;y<B;++y)switch(b[y]){case">":if("/"!=b[y-1]){++y;break e}if(l&&l.cellStyles){if(k=null!=(p=bt(b.slice(V,y),!0)).r?parseInt(p.r,10):k+1,C=-1,l.sheetRows&&l.sheetRows<k)continue;L={},M=!1,p.ht&&(M=!0,L.hpt=parseFloat(p.ht),L.hpx=yi(L.hpt)),"1"==p.hidden&&(M=!0,L.hidden=!0),null!=p.outlineLevel&&(M=!0,L.level=+p.outlineLevel),M&&(P[k-1]=L)}break;case"<":V=y}if(V>=y)break;if(k=null!=(p=bt(b.slice(V,y),!0)).r?parseInt(p.r,10):k+1,C=-1,!(l.sheetRows&&l.sheetRows<k)){u.s.r>k-1&&(u.s.r=k-1),u.e.r<k-1&&(u.e.r=k-1),l&&l.cellStyles&&(L={},M=!1,p.ht&&(M=!0,L.hpt=parseFloat(p.ht),L.hpx=yi(L.hpt)),"1"==p.hidden&&(M=!0,L.hidden=!0),null!=p.outlineLevel&&(M=!0,L.level=+p.outlineLevel),M&&(P[k-1]=L)),w=b.slice(y).split(e);for(var $=0;$!=w.length&&"<"==w[$].trim().charAt(0);++$);for(w=w.slice($),y=0;y!=w.length;++y)if(0!==(b=w[y].trim()).length){if(x=b.match(n),E=y,T=0,S=0,b="<c "+("<"==b.slice(0,1)?">":"")+b,null!=x&&2===x.length){for(E=0,I=x[1],T=0;T!=I.length&&!((S=I.charCodeAt(T)-64)<1||S>26);++T)E=26*E+S;C=--E}else++C;for(T=0;T!=b.length&&62!==b.charCodeAt(T);++T);if(++T,(p=bt(b.slice(0,T),!0)).r||(p.r=$n({r:k-1,c:C})),f={t:""},null!=(x=(I=b.slice(T)).match(i))&&""!==x[1]&&(f.v=Tt(x[1])),l.cellFormula){if(null!=(x=I.match(s))&&""!==x[1]){if(f.f=Tt(Dt(x[1])).replace(/\r\n/g,"\n"),l.xlfn||(f.f=Hi(f.f)),x[0].indexOf('t="array"')>-1)f.F=(I.match(a)||[])[1],f.F.indexOf(":")>-1&&R.push([Wn(f.F),f.F]);else if(x[0].indexOf('t="shared"')>-1){m=bt(x[0]);var H=Tt(Dt(x[1]));l.xlfn||(H=Hi(H)),O[parseInt(m.si,10)]=[m,H,p.r]}}else(x=I.match(/<f[^>]*\/>/))&&O[(m=bt(x[0])).si]&&(f.f=$i(O[m.si][1],O[m.si][2],p.r));var G=Vn(p.r);for(T=0;T<R.length;++T)G.r>=R[T][0].s.r&&G.r<=R[T][0].e.r&&G.c>=R[T][0].s.c&&G.c<=R[T][0].e.c&&(f.F=R[T][1])}if(null==p.t&&void 0===f.v)if(f.f||f.F)f.v=0,f.t="n";else{if(!F)continue;f.t="z"}else f.t=p.t||"n";switch(u.s.c>C&&(u.s.c=C),u.e.c<C&&(u.e.c=C),f.t){case"n":if(""==f.v||null==f.v){if(!F)continue;f.t="z"}else f.v=parseFloat(f.v);break;case"s":if("undefined"==typeof f.v){if(!F)continue;f.t="z"}else g=Ns[parseInt(f.v,10)],f.v=g.t,f.r=g.r,l.cellHTML&&(f.h=g.h);break;case"str":f.t="s",f.v=null!=f.v?Dt(f.v):"",l.cellHTML&&(f.h=kt(f.v));break;case"inlineStr":x=I.match(r),f.t="s",null!=x&&(g=$a(x[1]))?(f.v=g.t,l.cellHTML&&(f.h=g.h)):f.v="";break;case"b":f.v=_t(f.v);break;case"d":l.cellDates?f.v=qe(f.v,1):(f.v=je(qe(f.v,1)),f.t="n");break;case"e":l&&!1===l.cellText||(f.w=f.v),f.v=Er[f.v]}if(_=A=0,v=null,N&&void 0!==p.s&&null!=(v=h.CellXf[p.s])&&(null!=v.numFmtId&&(_=v.numFmtId),l.cellStyles&&null!=v.fillId&&(A=v.fillId)),Ds(f,_,A,l,d,h),l.cellDates&&N&&"n"==f.t&&Se(Q[_])&&(f.t="d",f.v=$e(f.v)),p.cm&&l.xlmeta){var W=(l.xlmeta.Cell||[])[+p.cm-1];W&&"XLDAPR"==W.type&&(f.D=!0)}if(D){var K=Vn(p.r);c[K.r]||(c[K.r]=[]),c[K.r][K.c]=f}else c[p.r]=f}}}}P.length>0&&(c["!rows"]=P)}}();var qs=ur;function Ys(e){return[rr(e),dr(e),"n"]}var Qs=ur;var Xs=["left","right","top","bottom","header","footer"];function Js(e,t,n,r,a,i){var s=i||{"!type":"chart"};if(!e)return i;var o=0,c=0,l="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach((function(e){var t=function(e){var t,n=[],r=e.match(/^<c:numCache>/);(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach((function(e){var t=e.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);t&&(n[+t[1]]=r?+t[2]:t[2])}));var a=Tt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach((function(e){t=e.replace(/<.*?>/g,"")})),[n,a,t]}(e);u.s.r=u.s.c=0,u.e.c=o,l=Bn(o),t[0].forEach((function(e,n){s[l+jn(n)]={t:"n",v:e,z:t[1]},c=n})),u.e.r<c&&(u.e.r=c),++o})),o>0&&(s["!ref"]=Gn(u)),s}var Zs=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],eo=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],to=[],no=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function ro(e,t){for(var n=0;n!=e.length;++n)for(var r=e[n],a=0;a!=t.length;++a){var i=t[a];if(null==r[i[0]])r[i[0]]=i[1];else switch(i[2]){case"bool":"string"==typeof r[i[0]]&&(r[i[0]]=_t(r[i[0]]));break;case"int":"string"==typeof r[i[0]]&&(r[i[0]]=parseInt(r[i[0]],10))}}}function ao(e,t){for(var n=0;n!=t.length;++n){var r=t[n];if(null==e[r[0]])e[r[0]]=r[1];else switch(r[2]){case"bool":"string"==typeof e[r[0]]&&(e[r[0]]=_t(e[r[0]]));break;case"int":"string"==typeof e[r[0]]&&(e[r[0]]=parseInt(e[r[0]],10))}}}function io(e){ao(e.WBProps,Zs),ao(e.CalcPr,no),ro(e.WBView,eo),ro(e.Sheets,to),Rs.date1904=_t(e.WBProps.date1904)}var so="][*?/\\".split("");function oo(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var n=!0;return so.forEach((function(r){if(-1!=e.indexOf(r)){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");n=!1}})),n}var co=/<\w+:workbook/;function lo(e,t){var n={};return e.read_shift(4),n.ArchID=e.read_shift(4),e.l+=t-8,n}function uo(e,t,n){return".bin"===t.slice(-4)?function(e,t){var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],a=!1;t||(t={}),t.biff=12;var i=[],s=[[]];return s.SheetNames=[],s.XTI=[],Bo[16]={n:"BrtFRTArchID$",f:lo},On(e,(function(e,o,c){switch(c){case 156:s.SheetNames.push(e.name),n.Sheets.push(e);break;case 153:n.WBProps=e;break;case 39:null!=e.Sheet&&(t.SID=e.Sheet),e.Ref=ms(e.Ptg,0,null,s,t),delete t.SID,delete e.Ptg,i.push(e);break;case 1036:case 361:case 2071:case 158:case 143:case 664:case 353:case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:case 16:break;case 357:case 358:case 355:case 667:s[0].length?s.push([c,e]):s[0]=[c,e],s[s.length-1].XTI=[];break;case 362:0===s.length&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(e),s.XTI=s.XTI.concat(e);break;case 35:case 37:r.push(c),a=!0;break;case 36:case 38:r.pop(),a=!1;break;default:if(o.T);else if(!a||t.WTF&&37!=r[r.length-1]&&35!=r[r.length-1])throw new Error("Unexpected record 0x"+c.toString(16))}}),t),io(n),n.Names=i,n.supbooks=s,n}(e,n):function(e,t){if(!e)throw new Error("Could not find file");var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,a="xmlns",i={},s=0;if(e.replace(mt,(function(o,c){var l=bt(o);switch(wt(l[0])){case"<?xml":case"</workbook>":case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":case"<bookViews":case"<bookViews>":case"</bookViews>":case"</workbookView>":case"<sheets":case"<sheets>":case"</sheets>":case"</sheet>":case"<functionGroups":case"<functionGroups/>":case"<functionGroup":case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":case"<definedName/>":case"</calcPr>":case"<oleSize":case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":case"<customWorkbookView":case"</customWorkbookView>":case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":case"<smartTagPr":case"<smartTagPr/>":case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":case"<webPublishing":case"<webPublishing/>":case"<fileRecoveryPr":case"<fileRecoveryPr/>":case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":case"<ArchID":case"<revisionPtr":break;case"<workbook":o.match(co)&&(a="xmlns"+o.match(/<(\w+):/)[1]),n.xmlns=l[a];break;case"<fileVersion":delete l[0],n.AppVersion=l;break;case"<workbookPr":case"<workbookPr/>":Zs.forEach((function(e){if(null!=l[e[0]])switch(e[2]){case"bool":n.WBProps[e[0]]=_t(l[e[0]]);break;case"int":n.WBProps[e[0]]=parseInt(l[e[0]],10);break;default:n.WBProps[e[0]]=l[e[0]]}})),l.codeName&&(n.WBProps.CodeName=Dt(l.codeName));break;case"<workbookView":case"<workbookView/>":delete l[0],n.WBView.push(l);break;case"<sheet":switch(l.state){case"hidden":l.Hidden=1;break;case"veryHidden":l.Hidden=2;break;default:l.Hidden=0}delete l.state,l.name=Tt(Dt(l.name)),delete l[0],n.Sheets.push(l);break;case"<definedNames>":case"<definedNames":case"<ext":case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</definedNames>":case"</ext>":case"</AlternateContent>":r=!1;break;case"<definedName":(i={}).Name=Dt(l.name),l.comment&&(i.Comment=l.comment),l.localSheetId&&(i.Sheet=+l.localSheetId),_t(l.hidden||"0")&&(i.Hidden=!0),s=c+o.length;break;case"</definedName>":i.Ref=Tt(Dt(e.slice(s,c))),n.Names.push(i);break;case"<calcPr":case"<calcPr/>":delete l[0],n.CalcPr=l;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+l[0]+" in workbook")}return o})),-1===Kt.indexOf(n.xmlns))throw new Error("Unknown Namespace: "+n.xmlns);return io(n),n}(e,n)}function ho(e,t,n,r,a,i,s,o){return".bin"===t.slice(-4)?function(e,t,n,r,a,i,s){if(!e)return e;var o=t||{};r||(r={"!id":{}});var c,l,u,d,h,f,p,g,m,v,y=o.dense?[]:{},b={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=[],x=!1,E=!1,T=[];o.biff=12,o["!row"]=0;var S=0,I=!1,k=[],C={},_=o.supbooks||a.supbooks||[[]];if(_.sharedf=C,_.arrayf=k,_.SheetNames=a.SheetNames||a.Sheets.map((function(e){return e.name})),!o.supbooks&&(o.supbooks=_,a.Names))for(var A=0;A<a.Names.length;++A)_[0][A+1]=a.Names[A];var N,R,O=[],D=[],P=!1;if(Bo[16]={n:"BrtShortReal",f:Ys},On(e,(function(e,t,A){if(!E)switch(A){case 148:c=e;break;case 0:l=e,o.sheetRows&&o.sheetRows<=l.r&&(E=!0),m=jn(h=l.r),o["!row"]=l.r,(e.hidden||e.hpt||null!=e.level)&&(e.hpt&&(e.hpx=yi(e.hpt)),D[e.r]=e);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(u={t:e[2]},e[2]){case"n":u.v=e[1];break;case"s":g=Ns[e[1]],u.v=g.t,u.r=g.r;break;case"b":u.v=!!e[1];break;case"e":u.v=e[1],!1!==o.cellText&&(u.w=xr[u.v]);break;case"str":u.t="s",u.v=e[1];break;case"is":u.t="s",u.v=e[1].t}if((d=s.CellXf[e[0].iStyleRef])&&Ds(u,d.numFmtId,null,o,i,s),f=-1==e[0].c?f+1:e[0].c,o.dense?(y[h]||(y[h]=[]),y[h][f]=u):y[Bn(f)+m]=u,o.cellFormula){for(I=!1,S=0;S<k.length;++S){var L=k[S];l.r>=L[0].s.r&&l.r<=L[0].e.r&&f>=L[0].s.c&&f<=L[0].e.c&&(u.F=Gn(L[0]),I=!0)}!I&&e.length>3&&(u.f=e[3])}if(b.s.r>l.r&&(b.s.r=l.r),b.s.c>f&&(b.s.c=f),b.e.r<l.r&&(b.e.r=l.r),b.e.c<f&&(b.e.c=f),o.cellDates&&d&&"n"==u.t&&Se(Q[d.numFmtId])){var M=ee(u.v);M&&(u.t="d",u.v=new Date(M.y,M.m-1,M.d,M.H,M.M,M.S,M.u))}N&&("XLDAPR"==N.type&&(u.D=!0),N=void 0),R&&(R=void 0);break;case 1:case 12:if(!o.sheetStubs||x)break;u={t:"z",v:void 0},f=-1==e[0].c?f+1:e[0].c,o.dense?(y[h]||(y[h]=[]),y[h][f]=u):y[Bn(f)+m]=u,b.s.r>l.r&&(b.s.r=l.r),b.s.c>f&&(b.s.c=f),b.e.r<l.r&&(b.e.r=l.r),b.e.c<f&&(b.e.c=f),N&&("XLDAPR"==N.type&&(u.D=!0),N=void 0),R&&(R=void 0);break;case 176:T.push(e);break;case 49:N=((o.xlmeta||{}).Cell||[])[e-1];break;case 494:var F=r["!id"][e.relId];for(F?(e.Target=F.Target,e.loc&&(e.Target+="#"+e.loc),e.Rel=F):""==e.relId&&(e.Target="#"+e.loc),h=e.rfx.s.r;h<=e.rfx.e.r;++h)for(f=e.rfx.s.c;f<=e.rfx.e.c;++f)o.dense?(y[h]||(y[h]=[]),y[h][f]||(y[h][f]={t:"z",v:void 0}),y[h][f].l=e):(p=$n({c:f,r:h}),y[p]||(y[p]={t:"z",v:void 0}),y[p].l=e);break;case 426:if(!o.cellFormula)break;k.push(e),(v=o.dense?y[h][f]:y[Bn(f)+m]).f=ms(e[1],0,{r:l.r,c:f},_,o),v.F=Gn(e[0]);break;case 427:if(!o.cellFormula)break;C[$n(e[0].s)]=e[1],(v=o.dense?y[h][f]:y[Bn(f)+m]).f=ms(e[1],0,{r:l.r,c:f},_,o);break;case 60:if(!o.cellStyles)break;for(;e.e>=e.s;)O[e.e--]={width:e.w/256,hidden:!!(1&e.flags),level:e.level},P||(P=!0,pi(e.w/256)),gi(O[e.e+1]);break;case 161:y["!autofilter"]={ref:Gn(e)};break;case 476:y["!margins"]=e;break;case 147:a.Sheets[n]||(a.Sheets[n]={}),e.name&&(a.Sheets[n].CodeName=e.name),(e.above||e.left)&&(y["!outline"]={above:e.above,left:e.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),e.RTL&&(a.Views[0].RTL=!0);break;case 485:case 64:case 1053:case 151:case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:x=!0;break;case 36:x=!1;break;case 37:w.push(A),x=!0;break;case 38:w.pop(),x=!1;break;default:if(t.T);else if(!x||o.WTF)throw new Error("Unexpected record 0x"+A.toString(16))}}),o),delete o.supbooks,delete o["!row"],!y["!ref"]&&(b.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(y["!ref"]=Gn(c||b)),o.sheetRows&&y["!ref"]){var L=Wn(y["!ref"]);o.sheetRows<=+L.e.r&&(L.e.r=o.sheetRows-1,L.e.r>b.e.r&&(L.e.r=b.e.r),L.e.r<L.s.r&&(L.s.r=L.e.r),L.e.c>b.e.c&&(L.e.c=b.e.c),L.e.c<L.s.c&&(L.s.c=L.e.c),y["!fullref"]=y["!ref"],y["!ref"]=Gn(L))}return T.length>0&&(y["!merges"]=T),O.length>0&&(y["!cols"]=O),D.length>0&&(y["!rows"]=D),y}(e,r,n,a,i,s,o):Hs(e,r,n,a,i,s,o)}function fo(e,t,n,r,a,i,s,o){return".bin"===t.slice(-4)?function(e,t,n,r,a){if(!e)return e;r||(r={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s=[],o=!1;return On(e,(function(e,r,c){switch(c){case 550:i["!rel"]=e;break;case 651:a.Sheets[n]||(a.Sheets[n]={}),e.name&&(a.Sheets[n].CodeName=e.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(c);break;case 38:s.pop();break;default:if(r.T>0)s.push(c);else if(r.T<0)s.pop();else if(!o||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),t),r["!id"][i["!rel"]]&&(i["!drawel"]=r["!id"][i["!rel"]]),i}(e,r,n,a,i):function(e,t,n,r,a){if(!e)return e;r||(r={"!id":{}});var i,s={"!type":"chart","!drawel":null,"!rel":""},o=e.match(Bs);return o&&Gs(o[0],0,a,n),(i=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=i[1]),r["!id"][s["!rel"]]&&(s["!drawel"]=r["!id"][s["!rel"]]),s}(e,0,n,a,i)}function po(e,t,n,r){return".bin"===t.slice(-4)?function(e,t,n){var r={NumberFmt:[]};for(var a in Q)r.NumberFmt[a]=Q[a];r.CellXf=[],r.Fonts=[];var i=[],s=!1;return On(e,(function(e,a,o){switch(o){case 44:r.NumberFmt[e[0]]=e[1],Ae(e[1],e[0]);break;case 43:r.Fonts.push(e),null!=e.color.theme&&t&&t.themeElements&&t.themeElements.clrScheme&&(e.color.rgb=ci(t.themeElements.clrScheme[e.color.theme].rgb,e.color.tint||0));break;case 1025:case 45:case 46:case 48:case 507:case 572:case 475:case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 47:617==i[i.length-1]&&r.CellXf.push(e);break;case 35:s=!0;break;case 36:s=!1;break;case 37:i.push(o),s=!0;break;case 38:i.pop(),s=!1;break;default:if(a.T>0)i.push(o);else if(a.T<0)i.pop();else if(!s||n.WTF&&37!=i[i.length-1])throw new Error("Unexpected record 0x"+o.toString(16))}})),r}(e,n,r):Ei(e,n,r)}function go(e,t,n){return".bin"===t.slice(-4)?function(e,t){var n=[],r=!1;return On(e,(function(e,a,i){switch(i){case 159:n.Count=e[0],n.Unique=e[1];break;case 19:n.push(e);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(a.T,!r||t.WTF)throw new Error("Unexpected record 0x"+i.toString(16))}})),n}(e,n):function(e,t){var n=[],r="";if(!e)return n;var a=e.match(Ha);if(a){r=a[2].replace(Ga,"").split(Wa);for(var i=0;i!=r.length;++i){var s=$a(r[i].trim(),t);null!=s&&(n[n.length]=s)}a=bt(a[1]),n.Count=a.count,n.Unique=a.uniqueCount}return n}(e,n)}function mo(e,t,n){return".bin"===t.slice(-4)?function(e,t){var n=[],r=[],a={},i=!1;return On(e,(function(e,s,o){switch(o){case 632:r.push(e);break;case 635:a=e;break;case 637:a.t=e.t,a.h=e.h,a.r=e.r;break;case 636:if(a.author=r[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,n.push(a);break;case 3072:case 37:case 38:break;case 35:i=!0;break;case 36:i=!1;break;default:if(s.T);else if(!i||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}})),n}(e,n):function(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var n=[],r=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach((function(e){if(""!==e&&""!==e.trim()){var t=e.match(/<(?:\w+:)?author[^>]*>(.*)/);t&&n.push(t[1])}}));var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach((function(e){if(""!==e&&""!==e.trim()){var a=e.match(/<(?:\w+:)?comment[^>]*>/);if(a){var i=bt(a[0]),s={author:i.authorId&&n[i.authorId]||"sheetjsghost",ref:i.ref,guid:i.guid},o=Vn(i.ref);if(!(t.sheetRows&&t.sheetRows<=o.r)){var c=e.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),l=!!c&&!!c[1]&&$a(c[1])||{r:"",t:"",h:""};s.r=l.r,"<t></t>"==l.r&&(l.t=l.h=""),s.t=(l.t||"").replace(/\r\n/g,"\n").replace(/\r/g,"\n"),t.cellHTML&&(s.h=l.h),r.push(s)}}}})),r}(e,n)}function vo(e,t,n){return".bin"===t.slice(-4)?function(e){var t=[];return On(e,(function(e,n,r){if(63===r)t.push(e);else if(!n.T)throw new Error("Unexpected record 0x"+r.toString(16))})),t}(e):function(e){var t=[];if(!e)return t;var n=1;return(e.match(mt)||[]).forEach((function(e){var r=bt(e);switch(r[0]){case"<?xml":case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete r[0],r.i?n=r.i:r.i=n,t.push(r)}})),t}(e)}function yo(e,t,n,r){if(".bin"===n.slice(-4))return function(e,t,n,r){if(!e)return e;var a=r||{},i=!1;On(e,(function(e,t,n){switch(n){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(t.T);else if(!i||a.WTF)throw new Error("Unexpected record 0x"+n.toString(16))}}),a)}(e,0,0,r)}function bo(e,t,n){return".bin"===t.slice(-4)?function(e,t,n){var r={Types:[],Cell:[],Value:[]},a=n||{},i=[],s=!1,o=2;return On(e,(function(e,t,n){switch(n){case 335:r.Types.push({name:e.name});break;case 51:e.forEach((function(e){1==o?r.Cell.push({type:r.Types[e[0]-1].name,index:e[1]}):0==o&&r.Value.push({type:r.Types[e[0]-1].name,index:e[1]})}));break;case 337:o=e?1:0;break;case 338:o=2;break;case 35:i.push(n),s=!0;break;case 36:i.pop(),s=!1;break;default:if(t.T);else if(!s||a.WTF&&35!=i[i.length-1])throw new Error("Unexpected record 0x"+n.toString(16))}})),r}(e,0,n):function(e,t,n){var r={Types:[],Cell:[],Value:[]};if(!e)return r;var a,i=!1,s=2;return e.replace(mt,(function(e){var t=bt(e);switch(wt(t[0])){case"<?xml":case"<metadata":case"</metadata>":case"<metadataTypes":case"</metadataTypes>":case"</metadataType>":case"</futureMetadata>":case"<bk>":case"</bk>":case"</rc>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<metadataType":r.Types.push({name:t.name});break;case"<futureMetadata":for(var o=0;o<r.Types.length;++o)r.Types[o].name==t.name&&(a=r.Types[o]);break;case"<rc":1==s?r.Cell.push({type:r.Types[t.t-1].name,index:+t.v}):0==s&&r.Value.push({type:r.Types[t.t-1].name,index:+t.v});break;case"<cellMetadata":s=1;break;case"</cellMetadata>":case"</valueMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+t.i);break;default:if(!i&&n.WTF)throw new Error("unrecognized "+t[0]+" in metadata")}return e})),r}(e,0,n)}var wo,xo=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Eo=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function To(e,t){var n=e.split(/\s+/),r=[];if(t||(r[0]=n[0]),1===n.length)return r;var a,i,s,o=e.match(xo);if(o)for(s=0;s!=o.length;++s)-1===(i=(a=o[s].match(Eo))[1].indexOf(":"))?r[a[1]]=a[2].slice(1,a[2].length-1):r["xmlns:"===a[1].slice(0,6)?"xmlns"+a[1].slice(6):a[1].slice(i+1)]=a[2].slice(1,a[2].length-1);return r}function So(e){var t={};if(1===e.split(/\s+/).length)return t;var n,r,a,i=e.match(xo);if(i)for(a=0;a!=i.length;++a)-1===(r=(n=i[a].match(Eo))[1].indexOf(":"))?t[n[1]]=n[2].slice(1,n[2].length-1):t["xmlns:"===n[1].slice(0,6)?"xmlns"+n[1].slice(6):n[1].slice(r+1)]=n[2].slice(1,n[2].length-1);return t}function Io(e,t,n,r){var a=r;switch((n[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=_t(r);break;case"i2":case"int":a=parseInt(r,10);break;case"r4":case"float":a=parseFloat(r);break;case"date":case"dateTime.tz":a=qe(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+n[0])}e[Tt(t)]=a}function ko(e,t,n){if("z"!==e.t){if(!n||!1!==n.cellText)try{"e"===e.t?e.w=e.w||xr[e.v]:"General"===t?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=se(e.v):e.w=oe(e.v):e.w=function(e,t){var n=wo[e]||Tt(e);return"General"===n?oe(t):_e(n,t)}(t||"General",e.v)}catch(i){if(n.WTF)throw i}try{var r=wo[t]||t||"General";if(n.cellNF&&(e.z=r),n.cellDates&&"n"==e.t&&Se(r)){var a=ee(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(n.WTF)throw i}}}function Co(e,t,n){if(n.cellStyles&&t.Interior){var r=t.Interior;r.Pattern&&(r.patternType=bi[r.Pattern]||r.Pattern)}e[t.ID]=t}function _o(e,t,n,r,a,i,s,o,c,l){var u="General",d=r.StyleID,h={};l=l||{};var f=[],p=0;for(void 0===d&&o&&(d=o.StyleID),void 0===d&&s&&(d=s.StyleID);void 0!==i[d]&&(i[d].nf&&(u=i[d].nf),i[d].Interior&&f.push(i[d].Interior),i[d].Parent);)d=i[d].Parent;switch(n.Type){case"Boolean":r.t="b",r.v=_t(e);break;case"String":r.t="s",r.r=Ct(Tt(e)),r.v=e.indexOf("<")>-1?Tt(t||e).replace(/<.*?>/g,""):r.r;break;case"DateTime":"Z"!=e.slice(-1)&&(e+="Z"),r.v=(qe(e)-new Date(Date.UTC(1899,11,30)))/864e5,r.v!==r.v?r.v=Tt(e):r.v<60&&(r.v=r.v-1),u&&"General"!=u||(u="yyyy-mm-dd");case"Number":void 0===r.v&&(r.v=+e),r.t||(r.t="n");break;case"Error":r.t="e",r.v=Er[e],!1!==l.cellText&&(r.w=e);break;default:""==e&&""==t?r.t="z":(r.t="s",r.v=Ct(t||e))}if(ko(r,u,l),!1!==l.cellFormula)if(r.Formula){var g=Tt(r.Formula);61==g.charCodeAt(0)&&(g=g.slice(1)),r.f=ji(g,a),delete r.Formula,"RC"==r.ArrayRange?r.F=ji("RC:RC",a):r.ArrayRange&&(r.F=ji(r.ArrayRange,a),c.push([Wn(r.F),r.F]))}else for(p=0;p<c.length;++p)a.r>=c[p][0].s.r&&a.r<=c[p][0].e.r&&a.c>=c[p][0].s.c&&a.c<=c[p][0].e.c&&(r.F=c[p][1]);l.cellStyles&&(f.forEach((function(e){!h.patternType&&e.patternType&&(h.patternType=e.patternType)})),r.s=h),void 0!==r.StyleID&&(r.ixfe=r.StyleID)}function Ao(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),e.v=e.w=e.ixfe=void 0}function No(e,t){var n=t||{};Ne();var r=S(Ht(e));"binary"!=n.type&&"array"!=n.type&&"base64"!=n.type||(r="undefined"!==typeof T?T.utils.decode(65001,x(r)):Dt(r));var a,i=r.slice(0,1024).toLowerCase(),s=!1;if((1023&(i=i.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&i.indexOf(","),1023&i.indexOf(";"))){var o=Qe(n);return o.type="string",Ma.to_workbook(r,o)}if(-1==i.indexOf("<?xml")&&["html","table","head","meta","script","style","div"].forEach((function(e){i.indexOf("<"+e)>=0&&(s=!0)})),s)return function(e,t){var n=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!n||0==n.length)throw new Error("Invalid HTML: could not find <table>");if(1==n.length)return Yn(Ho(n[0],t),t);var r={SheetNames:[],Sheets:{}};return n.forEach((function(e,n){Vc(r,Ho(e,t),"Sheet"+(n+1))})),r}(r,n);wo={"General Number":"General","General Date":Q[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Q[15],"Short Date":Q[14],"Long Time":Q[19],"Medium Time":Q[18],"Short Time":Q[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Q[2],Standard:Q[4],Percent:Q[10],Scientific:Q[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,l=[];var u,d={},h=[],f=n.dense?[]:{},p="",g={},m={},v=To('<Data ss:Type="String">'),y=0,b=0,w=0,E={s:{r:2e6,c:2e6},e:{r:0,c:0}},I={},k={},C="",_=0,A=[],N={},R={},O=0,D=[],P=[],L={},M=[],F=!1,z=[],j=[],U={},B=0,V=0,$={Sheets:[],WBProps:{date1904:!1}},H={};Gt.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/gm,"");for(var G="";a=Gt.exec(r);)switch(a[3]=(G=a[3]).toLowerCase()){case"data":if("data"==G){if("/"===a[1]){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else"/"!==a[0].charAt(a[0].length-2)&&l.push([a[3],!0]);break}if(l[l.length-1][1])break;"/"===a[1]?_o(r.slice(y,a.index),C,v,"comment"==l[l.length-1][0]?L:g,{c:b,r:w},I,M[b],m,z,n):(C="",v=To(a[0]),y=a.index+a[0].length);break;case"cell":if("/"===a[1])if(P.length>0&&(g.c=P),(!n.sheetRows||n.sheetRows>w)&&void 0!==g.v&&(n.dense?(f[w]||(f[w]=[]),f[w][b]=g):f[Bn(b)+jn(w)]=g),g.HRef&&(g.l={Target:Tt(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(B=b+(0|parseInt(g.MergeAcross,10)),V=w+(0|parseInt(g.MergeDown,10)),A.push({s:{c:b,r:w},e:{c:B,r:V}})),n.sheetStubs)if(g.MergeAcross||g.MergeDown){for(var W=b;W<=B;++W)for(var K=w;K<=V;++K)(W>b||K>w)&&(n.dense?(f[K]||(f[K]=[]),f[K][W]={t:"z"}):f[Bn(W)+jn(K)]={t:"z"});b=B+1}else++b;else g.MergeAcross?b=B+1:++b;else(g=So(a[0])).Index&&(b=+g.Index-1),b<E.s.c&&(E.s.c=b),b>E.e.c&&(E.e.c=b),"/>"===a[0].slice(-2)&&++b,P=[];break;case"row":"/"===a[1]||"/>"===a[0].slice(-2)?(w<E.s.r&&(E.s.r=w),w>E.e.r&&(E.e.r=w),"/>"===a[0].slice(-2)&&(m=To(a[0])).Index&&(w=+m.Index-1),b=0,++w):((m=To(a[0])).Index&&(w=+m.Index-1),U={},("0"==m.AutoFitHeight||m.Height)&&(U.hpx=parseInt(m.Height,10),U.hpt=vi(U.hpx),j[w]=U),"1"==m.Hidden&&(U.hidden=!0,j[w]=U));break;case"worksheet":if("/"===a[1]){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"));h.push(p),E.s.r<=E.e.r&&E.s.c<=E.e.c&&(f["!ref"]=Gn(E),n.sheetRows&&n.sheetRows<=E.e.r&&(f["!fullref"]=f["!ref"],E.e.r=n.sheetRows-1,f["!ref"]=Gn(E))),A.length&&(f["!merges"]=A),M.length>0&&(f["!cols"]=M),j.length>0&&(f["!rows"]=j),d[p]=f}else E={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=b=0,l.push([a[3],!1]),c=To(a[0]),p=Tt(c.Name),f=n.dense?[]:{},A=[],z=[],j=[],H={name:p,Hidden:0},$.Sheets.push(H);break;case"table":if("/"===a[1]){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else{if("/>"==a[0].slice(-2))break;l.push([a[3],!1]),M=[],F=!1}break;case"style":"/"===a[1]?Co(I,k,n):k=To(a[0]);break;case"numberformat":k.nf=Tt(To(a[0]).Format||"General"),wo[k.nf]&&(k.nf=wo[k.nf]);for(var q=0;392!=q&&Q[q]!=k.nf;++q);if(392==q)for(q=57;392!=q;++q)if(null==Q[q]){Ae(k.nf,q);break}break;case"column":if("table"!==l[l.length-1][0])break;if((u=To(a[0])).Hidden&&(u.hidden=!0,delete u.Hidden),u.Width&&(u.wpx=parseInt(u.Width,10)),!F&&u.wpx>10){F=!0,li=6;for(var Y=0;Y<M.length;++Y)M[Y]&&gi(M[Y])}F&&gi(u),M[u.Index-1||M.length]=u;for(var X=0;X<+u.Span;++X)M[M.length]=Qe(u);break;case"namedrange":if("/"===a[1])break;$.Names||($.Names=[]);var J=bt(a[0]),Z={Name:J.Name,Ref:ji(J.RefersTo.slice(1),{r:0,c:0})};$.Sheets.length>0&&(Z.Sheet=$.Sheets.length-1),$.Names.push(Z);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":case"protection":case"paragraphs":case"name":case"pixelsperinch":case"null":break;case"font":if("/>"===a[0].slice(-2))break;"/"===a[1]?C+=r.slice(_,a.index):_=a.index+a[0].length;break;case"interior":if(!n.cellStyles)break;k.Interior=To(a[0]);break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if("/>"===a[0].slice(-2))break;"/"===a[1]?Lr(N,G,r.slice(O,a.index)):O=a.index+a[0].length;break;case"styles":case"workbook":if("/"===a[1]){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else l.push([a[3],!1]);break;case"comment":if("/"===a[1]){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"));Ao(L),P.push(L)}else l.push([a[3],!1]),L={a:(c=To(a[0])).Author};break;case"autofilter":if("/"===a[1]){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else if("/"!==a[0].charAt(a[0].length-2)){var ee=To(a[0]);f["!autofilter"]={ref:ji(ee.Range).replace(/\$/g,"")},l.push([a[3],!0])}break;case"datavalidation":if("/"===a[1]){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else"/"!==a[0].charAt(a[0].length-2)&&l.push([a[3],!0]);break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if("/"===a[1]){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else"/"!==a[0].charAt(a[0].length-2)&&l.push([a[3],!0]);break;default:if(0==l.length&&"document"==a[3])return rc(r,n);if(0==l.length&&"uof"==a[3])return rc(r,n);var te=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(a[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:te=!1}break;case"componentoptions":switch(a[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:te=!1}break;case"excelworkbook":switch(a[3]){case"date1904":$.WBProps.date1904=!0;break;case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:te=!1}break;case"workbookoptions":switch(a[3]){case"owcversion":case"height":case"width":break;default:te=!1}break;case"worksheetoptions":switch(a[3]){case"visible":if("/>"===a[0].slice(-2));else if("/"===a[1])switch(r.slice(O,a.index)){case"SheetHidden":H.Hidden=1;break;case"SheetVeryHidden":H.Hidden=2}else O=a.index+a[0].length;break;case"header":f["!margins"]||Os(f["!margins"]={},"xlml"),isNaN(+bt(a[0]).Margin)||(f["!margins"].header=+bt(a[0]).Margin);break;case"footer":f["!margins"]||Os(f["!margins"]={},"xlml"),isNaN(+bt(a[0]).Margin)||(f["!margins"].footer=+bt(a[0]).Margin);break;case"pagemargins":var ne=bt(a[0]);f["!margins"]||Os(f["!margins"]={},"xlml"),isNaN(+ne.Top)||(f["!margins"].top=+ne.Top),isNaN(+ne.Left)||(f["!margins"].left=+ne.Left),isNaN(+ne.Right)||(f["!margins"].right=+ne.Right),isNaN(+ne.Bottom)||(f["!margins"].bottom=+ne.Bottom);break;case"displayrighttoleft":$.Views||($.Views=[]),$.Views[0]||($.Views[0]={}),$.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;default:te=!1}break;case"pivottable":case"pivotcache":switch(a[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:te=!1}break;case"pagebreaks":switch(a[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:te=!1}break;case"autofilter":switch(a[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:te=!1}break;case"querytable":switch(a[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:te=!1}break;case"datavalidation":switch(a[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:te=!1}break;case"sorting":case"conditionalformatting":switch(a[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:te=!1}break;case"mapinfo":case"schema":case"data":switch(a[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:te=!1}break;case"smarttags":break;default:te=!1}if(te)break;if(a[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+a[3]+"|"+l.join("|");if("customdocumentproperties"===l[l.length-1][0]){if("/>"===a[0].slice(-2))break;"/"===a[1]?Io(R,G,D,r.slice(O,a.index)):(D=a,O=a.index+a[0].length);break}if(n.WTF)throw"Unrecognized tag: "+a[3]+"|"+l.join("|")}var re={};return n.bookSheets||n.bookProps||(re.Sheets=d),re.SheetNames=h,re.Workbook=$,re.SSF=Qe(Q),re.Props=N,re.Custprops=R,re}function Ro(e,t){switch(Sc(t=t||{}),t.type||"base64"){case"base64":return No(A(e),t);case"binary":case"buffer":case"file":return No(e,t);case"array":return No(L(e),t)}}function Oo(e){var t={},n=e.content;if(n.l=28,t.AnsiUserType=n.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=function(e){return hr(e,1)}(n),n.length-n.l<=4)return t;var r=n.read_shift(4);return 0==r||r>40?t:(n.l-=4,t.Reserved1=n.read_shift(0,"lpstr-ansi"),n.length-n.l<=4||1907505652!==(r=n.read_shift(4))?t:(t.UnicodeClipboardFormat=function(e){return hr(e,2)}(n),0==(r=n.read_shift(4))||r>40?t:(n.l-=4,void(t.Reserved2=n.read_shift(0,"lpwstr")))))}var Do=[60,1084,2066,2165,2175];function Po(e,t,n,r,a){var i=r,s=[],o=n.slice(n.l,n.l+i);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:a.enc.insitu(o)}s.push(o),n.l+=i;for(var c=yn(n,n.l),l=Vo[c],u=0;null!=l&&Do.indexOf(c)>-1;)i=yn(n,n.l+2),u=n.l+4,2066==c?u+=4:2165!=c&&2175!=c||(u+=12),o=n.slice(u,n.l+4+i),s.push(o),n.l+=4+i,l=Vo[c=yn(n,n.l)];var d=F(s);An(d,0);var h=0;d.lens=[];for(var f=0;f<s.length;++f)d.lens.push(h),h+=s[f].length;if(d.length<r)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+d.length+" < "+r;return t.f(d,d.length,a)}function Lo(e,t,n){if("z"!==e.t&&e.XF){var r=0;try{r=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Q[r])}catch(i){if(t.WTF)throw i}if(!t||!1!==t.cellText)try{"e"===e.t?e.w=e.w||xr[e.v]:0===r||"General"==r?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=se(e.v):e.w=oe(e.v):e.w=_e(r,e.v,{date1904:!!n,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&r&&"n"==e.t&&Se(Q[r]||String(r))){var a=ee(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function Mo(e,t,n){return{v:e,ixfe:t,t:n}}function Fo(e,t){var n={opts:{}},r={};var a,i,s,o,c,l,u,d,h=t.dense?[]:{},f={},p={},g=null,m=[],v="",y={},w="",x={},E=[],T=[],S=[],I={Sheets:[],WBProps:{date1904:!1},Views:[{}]},k={},C=function(e){return e<8?wr[e]:e<64&&S[e-8]||wr[e]},_=function(e,t,n){if(!(z>1)&&!(n.sheetRows&&e.r>=n.sheetRows)){if(n.cellStyles&&t.XF&&t.XF.data&&function(e,t,n){var r,a=t.XF.data;a&&a.patternType&&n&&n.cellStyles&&(t.s={},t.s.patternType=a.patternType,(r=oi(C(a.icvFore)))&&(t.s.fgColor={rgb:r}),(r=oi(C(a.icvBack)))&&(t.s.bgColor={rgb:r}))}(0,t,n),delete t.ixfe,delete t.XF,a=e,w=$n(e),p&&p.s&&p.e||(p={s:{r:0,c:0},e:{r:0,c:0}}),e.r<p.s.r&&(p.s.r=e.r),e.c<p.s.c&&(p.s.c=e.c),e.r+1>p.e.r&&(p.e.r=e.r+1),e.c+1>p.e.c&&(p.e.c=e.c+1),n.cellFormula&&t.f)for(var r=0;r<E.length;++r)if(!(E[r][0].s.c>e.c||E[r][0].s.r>e.r)&&!(E[r][0].e.c<e.c||E[r][0].e.r<e.r)){t.F=Gn(E[r][0]),E[r][0].s.c==e.c&&E[r][0].s.r==e.r||delete t.f,t.f&&(t.f=""+ms(E[r][1],0,e,L,A));break}n.dense?(h[e.r]||(h[e.r]=[]),h[e.r][e.c]=t):h[w]=t}},A={enc:!1,sbcch:0,snames:[],sharedf:x,arrayf:E,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(A.password=t.password);var N=[],R=[],O=[],D=[],P=!1,L=[];L.SheetNames=A.snames,L.sharedf=A.sharedf,L.arrayf=A.arrayf,L.names=[],L.XTI=[];var M,F=0,z=0,j=0,U=[],B=[];A.codepage=1200,b(1200);for(var V=!1;e.l<e.length-1;){var $=e.l,H=e.read_shift(2);if(0===H&&10===F)break;var G=e.l===e.length?0:e.read_shift(2),W=Vo[H];if(W&&W.f){if(t.bookSheets&&133===F&&133!==H)break;if(F=H,2===W.r||12==W.r){var K=e.read_shift(2);if(G-=2,!A.enc&&K!==H&&((255&K)<<8|K>>8)!==H)throw new Error("rt mismatch: "+K+"!="+H);12==W.r&&(e.l+=10,G-=10)}var q={};if(q=10===H?W.f(e,G,A):Po(H,W,e,G,A),0==z&&-1===[9,521,1033,2057].indexOf(F))continue;switch(H){case 34:n.opts.Date1904=I.WBProps.date1904=q;break;case 134:n.opts.WriteProtect=!0;break;case 47:if(A.enc||(e.l=0),A.enc=q,!t.password)throw new Error("File is password-protected");if(null==q.valid)throw new Error("Encryption scheme unsupported");if(!q.valid)throw new Error("Password is incorrect");break;case 92:A.lastuser=q;break;case 66:var Y=Number(q);switch(Y){case 21010:Y=1200;break;case 32768:Y=1e4;break;case 32769:Y=1252}b(A.codepage=Y),V=!0;break;case 317:A.rrtabid=q;break;case 25:A.winlocked=q;break;case 439:n.opts.RefreshAll=q;break;case 12:n.opts.CalcCount=q;break;case 16:n.opts.CalcDelta=q;break;case 17:n.opts.CalcIter=q;break;case 13:n.opts.CalcMode=q;break;case 14:n.opts.CalcPrecision=q;break;case 95:n.opts.CalcSaveRecalc=q;break;case 15:A.CalcRefMode=q;break;case 2211:n.opts.FullCalc=q;break;case 129:q.fDialog&&(h["!type"]="dialog"),q.fBelow||((h["!outline"]||(h["!outline"]={})).above=!0),q.fRight||((h["!outline"]||(h["!outline"]={})).left=!0);break;case 224:T.push(q);break;case 430:L.push([q]),L[L.length-1].XTI=[];break;case 35:case 547:L[L.length-1].push(q);break;case 24:case 536:M={Name:q.Name,Ref:ms(q.rgce,0,null,L,A)},q.itab>0&&(M.Sheet=q.itab-1),L.names.push(M),L[0]||(L[0]=[],L[0].XTI=[]),L[L.length-1].push(q),"_xlnm._FilterDatabase"==q.Name&&q.itab>0&&q.rgce&&q.rgce[0]&&q.rgce[0][0]&&"PtgArea3d"==q.rgce[0][0][0]&&(B[q.itab-1]={ref:Gn(q.rgce[0][0][1][2])});break;case 22:A.ExternCount=q;break;case 23:0==L.length&&(L[0]=[],L[0].XTI=[]),L[L.length-1].XTI=L[L.length-1].XTI.concat(q),L.XTI=L.XTI.concat(q);break;case 2196:if(A.biff<8)break;null!=M&&(M.Comment=q[1]);break;case 18:h["!protect"]=q;break;case 19:0!==q&&A.WTF&&console.error("Password verifier: "+q);break;case 133:f[q.pos]=q,A.snames.push(q.name);break;case 10:if(--z)break;if(p.e){if(p.e.r>0&&p.e.c>0){if(p.e.r--,p.e.c--,h["!ref"]=Gn(p),t.sheetRows&&t.sheetRows<=p.e.r){var X=p.e.r;p.e.r=t.sheetRows-1,h["!fullref"]=h["!ref"],h["!ref"]=Gn(p),p.e.r=X}p.e.r++,p.e.c++}N.length>0&&(h["!merges"]=N),R.length>0&&(h["!objects"]=R),O.length>0&&(h["!cols"]=O),D.length>0&&(h["!rows"]=D),I.Sheets.push(k)}""===v?y=h:r[v]=h,h=t.dense?[]:{};break;case 9:case 521:case 1033:case 2057:if(8===A.biff&&(A.biff={9:2,521:3,1033:4}[H]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[q.BIFFVer]||8),A.biffguess=0==q.BIFFVer,0==q.BIFFVer&&4096==q.dt&&(A.biff=5,V=!0,b(A.codepage=28591)),8==A.biff&&0==q.BIFFVer&&16==q.dt&&(A.biff=2),z++)break;if(h=t.dense?[]:{},A.biff<8&&!V&&(V=!0,b(A.codepage=t.codepage||1252)),A.biff<5||0==q.BIFFVer&&4096==q.dt){""===v&&(v="Sheet1"),p={s:{r:0,c:0},e:{r:0,c:0}};var J={pos:e.l-G,name:v};f[J.pos]=J,A.snames.push(v)}else v=(f[$]||{name:""}).name;32==q.dt&&(h["!type"]="chart"),64==q.dt&&(h["!type"]="macro"),N=[],R=[],A.arrayf=E=[],O=[],D=[],P=!1,k={Hidden:(f[$]||{hs:0}).hs,name:v};break;case 515:case 3:case 2:"chart"==h["!type"]&&(t.dense?(h[q.r]||[])[q.c]:h[$n({c:q.c,r:q.r})])&&++q.c,l={ixfe:q.ixfe,XF:T[q.ixfe]||{},v:q.val,t:"n"},j>0&&(l.z=U[l.ixfe>>8&63]),Lo(l,t,n.opts.Date1904),_({c:q.c,r:q.r},l,t);break;case 5:case 517:l={ixfe:q.ixfe,XF:T[q.ixfe],v:q.val,t:q.t},j>0&&(l.z=U[l.ixfe>>8&63]),Lo(l,t,n.opts.Date1904),_({c:q.c,r:q.r},l,t);break;case 638:l={ixfe:q.ixfe,XF:T[q.ixfe],v:q.rknum,t:"n"},j>0&&(l.z=U[l.ixfe>>8&63]),Lo(l,t,n.opts.Date1904),_({c:q.c,r:q.r},l,t);break;case 189:for(var Z=q.c;Z<=q.C;++Z){var ee=q.rkrec[Z-q.c][0];l={ixfe:ee,XF:T[ee],v:q.rkrec[Z-q.c][1],t:"n"},j>0&&(l.z=U[l.ixfe>>8&63]),Lo(l,t,n.opts.Date1904),_({c:Z,r:q.r},l,t)}break;case 6:case 518:case 1030:if("String"==q.val){g=q;break}if((l=Mo(q.val,q.cell.ixfe,q.tt)).XF=T[l.ixfe],t.cellFormula){var te=q.formula;if(te&&te[0]&&te[0][0]&&"PtgExp"==te[0][0][0]){var ne=te[0][0][1][0],re=te[0][0][1][1],ae=$n({r:ne,c:re});x[ae]?l.f=""+ms(q.formula,0,q.cell,L,A):l.F=((t.dense?(h[ne]||[])[re]:h[ae])||{}).F}else l.f=""+ms(q.formula,0,q.cell,L,A)}j>0&&(l.z=U[l.ixfe>>8&63]),Lo(l,t,n.opts.Date1904),_(q.cell,l,t),g=q;break;case 7:case 519:if(!g)throw new Error("String record expects Formula");g.val=q,(l=Mo(q,g.cell.ixfe,"s")).XF=T[l.ixfe],t.cellFormula&&(l.f=""+ms(g.formula,0,g.cell,L,A)),j>0&&(l.z=U[l.ixfe>>8&63]),Lo(l,t,n.opts.Date1904),_(g.cell,l,t),g=null;break;case 33:case 545:E.push(q);var ie=$n(q[0].s);if(i=t.dense?(h[q[0].s.r]||[])[q[0].s.c]:h[ie],t.cellFormula&&i){if(!g)break;if(!ie||!i)break;i.f=""+ms(q[1],0,q[0],L,A),i.F=Gn(q[0])}break;case 1212:if(!t.cellFormula)break;if(w){if(!g)break;x[$n(g.cell)]=q[0],((i=t.dense?(h[g.cell.r]||[])[g.cell.c]:h[$n(g.cell)])||{}).f=""+ms(q[0],0,a,L,A)}break;case 253:l=Mo(m[q.isst].t,q.ixfe,"s"),m[q.isst].h&&(l.h=m[q.isst].h),l.XF=T[l.ixfe],j>0&&(l.z=U[l.ixfe>>8&63]),Lo(l,t,n.opts.Date1904),_({c:q.c,r:q.r},l,t);break;case 513:t.sheetStubs&&(l={ixfe:q.ixfe,XF:T[q.ixfe],t:"z"},j>0&&(l.z=U[l.ixfe>>8&63]),Lo(l,t,n.opts.Date1904),_({c:q.c,r:q.r},l,t));break;case 190:if(t.sheetStubs)for(var se=q.c;se<=q.C;++se){var oe=q.ixfe[se-q.c];l={ixfe:oe,XF:T[oe],t:"z"},j>0&&(l.z=U[l.ixfe>>8&63]),Lo(l,t,n.opts.Date1904),_({c:se,r:q.r},l,t)}break;case 214:case 516:case 4:(l=Mo(q.val,q.ixfe,"s")).XF=T[l.ixfe],j>0&&(l.z=U[l.ixfe>>8&63]),Lo(l,t,n.opts.Date1904),_({c:q.c,r:q.r},l,t);break;case 0:case 512:1===z&&(p=q);break;case 252:m=q;break;case 1054:if(4==A.biff){U[j++]=q[1];for(var ce=0;ce<j+163&&Q[ce]!=q[1];++ce);ce>=163&&Ae(q[1],j+163)}else Ae(q[1],q[0]);break;case 30:U[j++]=q;for(var le=0;le<j+163&&Q[le]!=q;++le);le>=163&&Ae(q,j+163);break;case 229:N=N.concat(q);break;case 93:R[q.cmo[0]]=A.lastobj=q;break;case 438:A.lastobj.TxO=q;break;case 127:A.lastobj.ImData=q;break;case 440:for(c=q[0].s.r;c<=q[0].e.r;++c)for(o=q[0].s.c;o<=q[0].e.c;++o)(i=t.dense?(h[c]||[])[o]:h[$n({c:o,r:c})])&&(i.l=q[1]);break;case 2048:for(c=q[0].s.r;c<=q[0].e.r;++c)for(o=q[0].s.c;o<=q[0].e.c;++o)(i=t.dense?(h[c]||[])[o]:h[$n({c:o,r:c})])&&i.l&&(i.l.Tooltip=q[1]);break;case 28:if(A.biff<=5&&A.biff>=2)break;i=t.dense?(h[q[0].r]||[])[q[0].c]:h[$n(q[0])];var ue=R[q[2]];i||(t.dense?(h[q[0].r]||(h[q[0].r]=[]),i=h[q[0].r][q[0].c]={t:"z"}):i=h[$n(q[0])]={t:"z"},p.e.r=Math.max(p.e.r,q[0].r),p.s.r=Math.min(p.s.r,q[0].r),p.e.c=Math.max(p.e.c,q[0].c),p.s.c=Math.min(p.s.c,q[0].c)),i.c||(i.c=[]),s={a:q[1],t:ue.TxO.t},i.c.push(s);break;case 2173:T[q.ixfe],q.ext.forEach((function(e){e[0]}));break;case 125:if(!A.cellStyles)break;for(;q.e>=q.s;)O[q.e--]={width:q.w/256,level:q.level||0,hidden:!!(1&q.flags)},P||(P=!0,pi(q.w/256)),gi(O[q.e+1]);break;case 520:var de={};null!=q.level&&(D[q.r]=de,de.level=q.level),q.hidden&&(D[q.r]=de,de.hidden=!0),q.hpt&&(D[q.r]=de,de.hpt=q.hpt,de.hpx=yi(q.hpt));break;case 38:case 39:case 40:case 41:h["!margins"]||Os(h["!margins"]={}),h["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[H]]=q;break;case 161:h["!margins"]||Os(h["!margins"]={}),h["!margins"].header=q.header,h["!margins"].footer=q.footer;break;case 574:q.RTL&&(I.Views[0].RTL=!0);break;case 146:S=q;break;case 2198:d=q;break;case 140:u=q;break;case 442:v?k.CodeName=q||k.name:I.WBProps.CodeName=q||"ThisWorkbook"}}else W||console.error("Missing Info for XLS Record 0x"+H.toString(16)),e.l+=G}return n.SheetNames=Me(f).sort((function(e,t){return Number(e)-Number(t)})).map((function(e){return f[e].name})),t.bookSheets||(n.Sheets=r),!n.SheetNames.length&&y["!ref"]?(n.SheetNames.push("Sheet1"),n.Sheets&&(n.Sheets.Sheet1=y)):n.Preamble=y,n.Sheets&&B.forEach((function(e,t){n.Sheets[n.SheetNames[t]]["!autofilter"]=e})),n.Strings=m,n.SSF=Qe(Q),A.enc&&(n.Encryption=A.enc),d&&(n.Themes=d),n.Metadata={},void 0!==u&&(n.Metadata.Country=u),L.names.length>0&&(I.Names=L.names),n.Workbook=I,n}var zo="e0859ff2f94f6810ab9108002b27b3d9",jo="02d5cdd59c2e1b10939708002b2cf9ae";function Uo(e,t){var n,r,a,i;if(t||(t={}),Sc(t),w(),t.codepage&&y(t.codepage),e.FullPaths){if(Pe.find(e,"/encryption"))throw new Error("File is password-protected");n=Pe.find(e,"!CompObj"),r=Pe.find(e,"/Workbook")||Pe.find(e,"/Book")}else{switch(t.type){case"base64":e=P(A(e));break;case"binary":e=P(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e))}An(e,0),r={content:e}}if(n&&Oo(n),t.bookProps&&!t.bookSheets)a={};else{var s=N?"buffer":"array";if(r&&r.content)a=Fo(r.content,t);else if((i=Pe.find(e,"PerfectOffice_MAIN"))&&i.content)a=Fa.to_workbook(i.content,(t.type=s,t));else{if(!(i=Pe.find(e,"NativeContent_MAIN"))||!i.content)throw(i=Pe.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");a=Fa.to_workbook(i.content,(t.type=s,t))}t.bookVBA&&e.FullPaths&&Pe.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=function(e){var t=Pe.utils.cfb_new({root:"R"});return e.FullPaths.forEach((function(n,r){if("/"!==n.slice(-1)&&n.match(/_VBA_PROJECT_CUR/)){var a=n.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Pe.utils.cfb_add(t,a,e.FileIndex[r].content)}})),Pe.write(t)}(e))}var o={};return e.FullPaths&&function(e,t,n){var r=Pe.find(e,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var a=Wr(r,gr,jo);for(var i in a)t[i]=a[i]}catch(l){if(n.WTF)throw l}var s=Pe.find(e,"/!SummaryInformation");if(s&&s.size>0)try{var o=Wr(s,mr,zo);for(var c in o)null==t[c]&&(t[c]=o[c])}catch(l){if(n.WTF)throw l}t.HeadingPairs&&t.TitlesOfParts&&(Rr(t.HeadingPairs,t.TitlesOfParts,t,n),delete t.HeadingPairs,delete t.TitlesOfParts)}(e,o,t),a.Props=a.Custprops=o,t.bookFiles&&(a.cfb=e),a}var Bo={0:{f:function(e,t){var n={},r=e.l+t;n.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=r,7&i&&(n.level=7&i),16&i&&(n.hidden=!0),32&i&&(n.hpt=a/20),n}},1:{f:function(e){return[nr(e)]}},2:{f:function(e){return[nr(e),cr(e),"n"]}},3:{f:function(e){return[nr(e),e.read_shift(1),"e"]}},4:{f:function(e){return[nr(e),e.read_shift(1),"b"]}},5:{f:function(e){return[nr(e),dr(e),"n"]}},6:{f:function(e){return[nr(e),Jn(e),"str"]}},7:{f:function(e){return[nr(e),e.read_shift(4),"s"]}},8:{f:function(e,t,n){var r=e.l+t,a=nr(e);a.r=n["!row"];var i=[a,Jn(e),"str"];if(n.cellFormula){e.l+=2;var s=Es(e,r-e.l,n);i[3]=ms(s,0,a,n.supbooks,n)}else e.l=r;return i}},9:{f:function(e,t,n){var r=e.l+t,a=nr(e);a.r=n["!row"];var i=[a,dr(e),"n"];if(n.cellFormula){e.l+=2;var s=Es(e,r-e.l,n);i[3]=ms(s,0,a,n.supbooks,n)}else e.l=r;return i}},10:{f:function(e,t,n){var r=e.l+t,a=nr(e);a.r=n["!row"];var i=[a,e.read_shift(1),"b"];if(n.cellFormula){e.l+=2;var s=Es(e,r-e.l,n);i[3]=ms(s,0,a,n.supbooks,n)}else e.l=r;return i}},11:{f:function(e,t,n){var r=e.l+t,a=nr(e);a.r=n["!row"];var i=[a,e.read_shift(1),"e"];if(n.cellFormula){e.l+=2;var s=Es(e,r-e.l,n);i[3]=ms(s,0,a,n.supbooks,n)}else e.l=r;return i}},12:{f:function(e){return[rr(e)]}},13:{f:function(e){return[rr(e),cr(e),"n"]}},14:{f:function(e){return[rr(e),e.read_shift(1),"e"]}},15:{f:function(e){return[rr(e),e.read_shift(1),"b"]}},16:{f:Ys},17:{f:function(e){return[rr(e),Jn(e),"str"]}},18:{f:function(e){return[rr(e),e.read_shift(4),"s"]}},19:{f:er},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(e,t,n){var r=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=sr(e),s=Ts(e,0,n),o=ir(e);e.l=r;var c={Name:i,Ptg:s};return a<268435455&&(c.Sheet=a),o&&(c.Comment=o),c}},40:{},42:{},43:{f:function(e,t,n){var r={};r.sz=e.read_shift(2)/20;var a=function(e){var t=e.read_shift(1);return e.l++,{fBold:1&t,fItalic:2&t,fUnderline:4&t,fStrikeout:8&t,fOutline:16&t,fShadow:32&t,fCondense:64&t,fExtend:128&t}}(e);switch(a.fItalic&&(r.italic=1),a.fCondense&&(r.condense=1),a.fExtend&&(r.extend=1),a.fShadow&&(r.shadow=1),a.fOutline&&(r.outline=1),a.fStrikeout&&(r.strike=1),700===e.read_shift(2)&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript"}var i=e.read_shift(1);0!=i&&(r.underline=i);var s=e.read_shift(1);s>0&&(r.family=s);var o=e.read_shift(1);switch(o>0&&(r.charset=o),e.l++,r.color=function(e){var t={},n=e.read_shift(1)>>>1,r=e.read_shift(1),a=e.read_shift(2,"i"),i=e.read_shift(1),s=e.read_shift(1),o=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=r;var c=wr[r];c&&(t.rgb=oi(c));break;case 2:t.rgb=oi([i,s,o]);break;case 3:t.theme=r}return 0!=a&&(t.tint=a>0?a/32767:a/32768),t}(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor"}return r.name=Jn(e),r}},44:{f:function(e,t){return[e.read_shift(2),Jn(e)]}},45:{f:Ti},46:{f:Si},47:{f:function(e,t){var n=e.l+t,r=e.read_shift(2),a=e.read_shift(2);return e.l=n,{ixfe:r,numFmtId:a}}},48:{},49:{f:function(e){return e.read_shift(4,"i")}},50:{},51:{f:function(e){for(var t=[],n=e.read_shift(4);n-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Ca},62:{f:function(e){return[nr(e),er(e),"is"]}},63:{f:function(e){var t={};t.i=e.read_shift(4);var n={};n.r=e.read_shift(4),n.c=e.read_shift(4),t.r=$n(n);var r=e.read_shift(1);return 2&r&&(t.l="1"),8&r&&(t.a="1"),t}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Nn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(e){var t=e.read_shift(2);return e.l+=28,{RTL:32&t}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(e,t){var n={},r=e[e.l];return++e.l,n.above=!(64&r),n.left=!(128&r),e.l+=18,n.name=ar(e,t-19),n}},148:{f:qs,p:16},151:{f:function(){}},152:{},153:{f:function(e,t){var n={},r=e.read_shift(4);n.defaultThemeVersion=e.read_shift(4);var a=t>8?Jn(e):"";return a.length>0&&(n.CodeName=a),n.autoCompressPictures=!!(65536&r),n.backupFile=!!(64&r),n.checkCompatibility=!!(4096&r),n.date1904=!!(1&r),n.filterPrivacy=!!(8&r),n.hidePivotFieldList=!!(1024&r),n.promptedSolutions=!!(16&r),n.publishItems=!!(2048&r),n.refreshAllConnections=!!(262144&r),n.saveExternalLinkValues=!!(128&r),n.showBorderUnselectedTables=!!(4&r),n.showInkAnnotation=!!(32&r),n.showObjects=["all","placeholders","none"][r>>13&3],n.showPivotChartFilter=!!(32768&r),n.updateLinks=["userSet","never","always"][r>>8&3],n}},154:{},155:{},156:{f:function(e,t){var n={};return n.Hidden=e.read_shift(4),n.iTabID=e.read_shift(4),n.strRelID=or(e,t-8),n.name=Jn(e),n}},157:{},158:{},159:{T:1,f:function(e){return[e.read_shift(4),e.read_shift(4)]}},160:{T:-1},161:{T:1,f:ur},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Qs},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Jn(e)}}},336:{T:-1},337:{f:function(e){return e.l+=4,0!=e.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:or},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Sa},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(e,t,n){var r=e.l+t,a=lr(e),i=e.read_shift(1),s=[a];if(s[2]=i,n.cellFormula){var o=xs(e,r-e.l,n);s[1]=o}else e.l=r;return s}},427:{f:function(e,t,n){var r=e.l+t,a=[ur(e,16)];if(n.cellFormula){var i=Ss(e,r-e.l,n);a[1]=i,e.l=r}else e.l=r;return a}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(e){var t={};return Xs.forEach((function(n){t[n]=dr(e)})),t}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(e,t){var n=e.l+t,r=ur(e,16),a=ir(e),i=Jn(e),s=Jn(e),o=Jn(e);e.l=n;var c={rfx:r,relId:a,loc:i,display:o};return s&&(c.Tooltip=s),c}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:or},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:zi},633:{T:1},634:{T:-1},635:{T:1,f:function(e){var t={};t.iauthor=e.read_shift(4);var n=ur(e,16);return t.rfx=n.s,t.ref=$n(n.s),e.l+=16,t}},636:{T:-1},637:{f:tr},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(e,t){return e.l+=10,{name:Jn(e)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Vo={6:{f:bs},10:{f:Kr},12:{f:Yr},13:{f:Yr},14:{f:qr},15:{f:qr},16:{f:dr},17:{f:qr},18:{f:qr},19:{f:Yr},20:{f:wa},21:{f:wa},23:{f:Sa},24:{f:Ta},25:{f:qr},26:{},27:{},28:{f:function(e,t,n){return function(e,t,n){if(!(n.biff<8)){var r=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=ta(e,0,n);return n.biff<8&&e.read_shift(1),[{r:r,c:a},o,s,i]}}(e,0,n)}},29:{},34:{f:qr},35:{f:xa},38:{f:dr},39:{f:dr},40:{f:dr},41:{f:dr},42:{f:qr},43:{f:qr},47:{f:function(e,t,n){var r={Type:n.biff>=8?e.read_shift(2):0};return r.Type?ii(e,t-2,r):function(e,t,n,r){var a={key:Yr(e),verificationBytes:Yr(e)};n.password&&(a.verifier=ni(n.password)),r.valid=a.verificationBytes===a.verifier,r.valid&&(r.insitu=ai(n.password))}(e,n.biff,n,r),r}},49:{f:function(e,t,n){var r={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(n&&n.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10}return r.name=Xr(e,0,n),r}},51:{f:Yr},60:{},61:{f:function(e){return{Pos:[e.read_shift(2),e.read_shift(2)],Dim:[e.read_shift(2),e.read_shift(2)],Flags:e.read_shift(2),CurTab:e.read_shift(2),FirstTab:e.read_shift(2),Selected:e.read_shift(2),TabRatio:e.read_shift(2)}}},64:{f:qr},65:{f:function(){}},66:{f:Yr},77:{},80:{},81:{},82:{},85:{f:Yr},89:{},90:{},91:{},92:{f:function(e,t,n){if(n.enc)return e.l+=t,"";var r=e.l,a=ta(e,0,n);return e.read_shift(t+r-e.l),a}},93:{f:function(e,t,n){if(n&&n.biff<8)return function(e,t,n){e.l+=4;var r=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var s=[];return s.push((ka[r]||Nn)(e,t,n)),{cmo:[a,r,i],ft:s}}(e,t,n);var r=ha(e),a=function(e,t){for(var n=e.l+t,r=[];e.l<n;){var a=e.read_shift(2);e.l-=2;try{r.push(pa[a](e,n-e.l))}catch(i){return e.l=n,r}}return e.l!=n&&(e.l=n),r}(e,t-22,r[1]);return{cmo:r,ft:a}}},94:{},95:{f:qr},96:{},97:{},99:{f:qr},125:{f:Ca},128:{f:function(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(0!==t[0]&&t[0]--,0!==t[1]&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}},129:{f:function(e,t,n){var r=n&&8==n.biff||2==t?e.read_shift(2):(e.l+=t,0);return{fDialog:16&r,fBelow:64&r,fRight:128&r}}},130:{f:Yr},131:{f:qr},132:{f:qr},133:{f:function(e,t,n){var r=e.read_shift(4),a=3&e.read_shift(1),i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule"}var s=Xr(e,0,n);return 0===s.length&&(s="Sheet1"),{pos:r,hs:a,dt:i,name:s}}},134:{},140:{f:function(e){var t,n=[0,0];return t=e.read_shift(2),n[0]=vr[t]||t,t=e.read_shift(2),n[1]=vr[t]||t,n}},141:{f:Yr},144:{},146:{f:function(e){for(var t=e.read_shift(2),n=[];t-- >0;)n.push(ia(e));return n}},151:{},152:{},153:{},154:{},155:{},156:{f:Yr},157:{},158:{},160:{f:Aa},161:{f:function(e,t){var n={};return t<32||(e.l+=16,n.header=dr(e),n.footer=dr(e),e.l+=2),n}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function(e,t){for(var n=e.l+t-2,r=e.read_shift(2),a=e.read_shift(2),i=[];e.l<n;)i.push(ca(e));if(e.l!==n)throw new Error("MulRK read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulRK length mismatch");return{r:r,c:a,C:s,rkrec:i}}},190:{f:function(e,t){for(var n=e.l+t-2,r=e.read_shift(2),a=e.read_shift(2),i=[];e.l<n;)i.push(e.read_shift(2));if(e.l!==n)throw new Error("MulBlank read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulBlank length mismatch");return{r:r,c:a,C:s,ixfe:i}}},193:{f:Kr},197:{},198:{},199:{},200:{},201:{},202:{f:qr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Yr},220:{},221:{f:qr},222:{},224:{f:function(e,t,n){var r={};return r.ifnt=e.read_shift(2),r.numFmtId=e.read_shift(2),r.flags=e.read_shift(2),r.fStyle=r.flags>>2&1,r.data=function(e,t,n,r){var a={},i=e.read_shift(4),s=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return a.patternType=yr[o>>26],r.cellStyles?(a.alc=7&i,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=15&s,a.dgRight=s>>4&15,a.dgTop=s>>8&15,a.dgBottom=s>>12&15,a.icvLeft=s>>16&127,a.icvRight=s>>23&127,a.grbitDiag=s>>30&3,a.icvTop=127&o,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=127&c,a.icvBack=c>>7&127,a.fsxButton=c>>14&1,a):a}(e,0,r.fStyle,n),r}},225:{f:function(e,t){return 0===t||e.read_shift(2),1200}},226:{f:Kr},227:{},229:{f:function(e,t){for(var n=[],r=e.read_shift(2);r--;)n.push(la(e));return n}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function(e,t){for(var n=e.l+t,r=e.read_shift(4),a=e.read_shift(4),i=[],s=0;s!=a&&e.l<n;++s)i.push(Jr(e));return i.Count=r,i.Unique=a,i}},253:{f:function(e){var t=sa(e);return t.isst=e.read_shift(4),t}},255:{f:function(e,t){var n={};return n.dsst=e.read_shift(2),e.l+=t-2,n}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Qr},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:qr},353:{f:Kr},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function(e,t,n){var r=e.l+t,a=e.read_shift(2),i=e.read_shift(2);if(n.sbcch=i,1025==i||14849==i)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var s=Zr(e,i),o=[];r>e.l;)o.push(ea(e));return[i,a,s,o]}},431:{f:qr},432:{},433:{},434:{},437:{},438:{f:function(e,t,n){var r=e.l,a="";try{e.l+=4;var i=(n.lastobj||{cmo:[0,0]}).cmo[1];-1==[0,5,7,11,12,14].indexOf(i)?e.l+=6:function(e){var t=e.read_shift(1);e.l++;var n=e.read_shift(2);return e.l+=2,[t,n]}(e);var s=e.read_shift(2);e.read_shift(2),Yr(e);var o=e.read_shift(2);e.l+=o;for(var c=1;c<e.lens.length-1;++c){if(e.l-r!=e.lens[c])throw new Error("TxO: bad continue record");var l=e[e.l];if((a+=Zr(e,e.lens[c+1]-e.lens[c]-1)).length>=(l?s:2*s))break}if(a.length!==s&&a.length!==2*s)throw new Error("cchText: "+s+" != "+a.length);return e.l=r+t,{t:a}}catch(u){return e.l=r+t,{t:a}}}},439:{f:qr},440:{f:function(e,t){var n=la(e);e.l+=16;var r=function(e,t){var n=e.l+t,r=e.read_shift(4);if(2!==r)throw new Error("Unrecognized streamVersion: "+r);var a=e.read_shift(2);e.l+=2;var i,s,o,c,l,u,d="";16&a&&(i=ra(e,e.l)),128&a&&(s=ra(e,e.l)),257===(257&a)&&(o=ra(e,e.l)),1===(257&a)&&(c=na(e,e.l)),8&a&&(d=ra(e,e.l)),32&a&&(l=e.read_shift(16)),64&a&&(u=Mr(e)),e.l=n;var h=s||o||c||"";h&&d&&(h+="#"+d),h||(h="#"+d),2&a&&"/"==h.charAt(0)&&"/"!=h.charAt(1)&&(h="file://"+h);var f={Target:h};return l&&(f.guid=l),u&&(f.time=u),i&&(f.Tooltip=i),f}(e,t-24);return[n,r]}},441:{},442:{f:ea},443:{},444:{f:Yr},445:{},446:{},448:{f:Kr},449:{f:function(e){return e.read_shift(2),e.read_shift(4)},r:2},450:{f:Kr},512:{f:ya},513:{f:_a},515:{f:function(e,t,n){n.biffguess&&2==n.biff&&(n.biff=5);var r=sa(e),a=dr(e);return r.val=a,r}},516:{f:function(e,t,n){n.biffguess&&2==n.biff&&(n.biff=5),e.l;var r=sa(e);2==n.biff&&e.l++;var a=ea(e,e.l,n);return r.val=a,r}},517:{f:ba},519:{f:Na},520:{f:function(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var n=e.read_shift(2);e.l+=4;var r=e.read_shift(1);return e.l+=3,7&r&&(t.level=7&r),32&r&&(t.hidden=!0),64&r&&(t.hpt=n/20),t}},523:{},545:{f:Ia},549:{f:ma},566:{},574:{f:function(e,t,n){return n&&n.biff>=2&&n.biff<5?{}:{RTL:64&e.read_shift(2)}}},638:{f:function(e){var t=e.read_shift(2),n=e.read_shift(2),r=ca(e);return{r:t,c:n,ixfe:r[0],rknum:r[1]}}},659:{},1048:{},1054:{f:function(e,t,n){return[e.read_shift(2),ta(e,0,n)]}},1084:{},1212:{f:function(e,t,n){var r=ua(e);e.l++;var a=e.read_shift(1);return[ys(e,t-=8,n),a,r]}},2048:{f:function(e,t){e.read_shift(2);var n=la(e),r=e.read_shift((t-10)/2,"dbcs-cont");return[n,r=r.replace(z,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:ga},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Kr},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t},r:12},2173:{f:function(e,t){e.l,e.l+=2;var n=e.read_shift(2);e.l+=2;for(var r=e.read_shift(2),a=[];r-- >0;)a.push(Mi(e,e.l));return{ixfe:n,ext:a}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:qr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function(e,t,n){if(!(n.biff<8)){var r=e.read_shift(2),a=e.read_shift(2);return[Zr(e,r,n),Zr(e,a,n)]}e.l+=t},r:12},2197:{},2198:{f:function(e,t,n){var r=e.l+t;if(124226!==e.read_shift(4))if(n.cellStyles){var a,i=e.slice(e.l);e.l=r;try{a=dt(i,{type:"array"})}catch(o){return}var s=ot(a,"theme/theme/theme1.xml",!0);if(s)return Di(s,n)}else e.l=r},r:12},2199:{},2200:{},2201:{},2202:{f:function(e){return[0!==e.read_shift(4),0!==e.read_shift(4),e.read_shift(4)]},r:12},2203:{f:Kr},2204:{},2205:{},2206:{},2207:{},2211:{f:function(e){var t=function(e){var t=e.read_shift(2),n=e.read_shift(2);return e.l+=8,{type:t,flags:n}}(e);if(2211!=t.type)throw new Error("Invalid Future Record "+t.type);return 0!==e.read_shift(4)}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Yr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function(e,t,n){var r={area:!1};if(5!=n.biff)return e.l+=t,r;var a=e.read_shift(1);return e.l+=3,16&a&&(r.area=!0),r}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function(e){for(var t=e.read_shift(2),n=[];t-- >0;)n.push(ia(e));return n}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:ya},1:{},2:{f:function(e){var t=sa(e);++e.l;var n=e.read_shift(2);return t.t="n",t.val=n,t}},3:{f:function(e){var t=sa(e);++e.l;var n=dr(e);return t.t="n",t.val=n,t}},4:{f:function(e,t,n){n.biffguess&&5==n.biff&&(n.biff=2);var r=sa(e);++e.l;var a=ta(e,0,n);return r.t="str",r.val=a,r}},5:{f:ba},7:{f:function(e){var t=e.read_shift(1);return 0===t?(e.l++,""):e.read_shift(t,"sbcs-cont")}},8:{},9:{f:ga},11:{},22:{f:Yr},30:{f:va},31:{},32:{},33:{f:Ia},36:{},37:{f:ma},50:{f:function(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}},62:{},52:{},67:{},68:{f:Yr},69:{},86:{},126:{},127:{f:function(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(4),a={fmt:t,env:n,len:r,data:e.slice(e.l,e.l+r)};return e.l+=r,a}},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function(e,t,n){var r=e.l+t,a=sa(e),i=e.read_shift(2),s=Zr(e,i,n);return e.l=r,a.t="str",a.val=s,a}},223:{},234:{},354:{},421:{},518:{f:bs},521:{f:ga},536:{f:Ta},547:{f:xa},561:{},579:{},1030:{f:bs},1033:{f:ga},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function $o(e,t,n,r){var a=t;if(!isNaN(a)){var i=r||(n||[]).length||0,s=e.next(4);s.write_shift(2,a),s.write_shift(2,i),i>0&&gn(n)&&e.push(n)}}function Ho(e,t){var n=t||{};var r=n.dense?[]:{},a=(e=e.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),s=a.index,o=i&&i.index||e.length,c=tt(e.slice(s,o),/(:?<tr[^>]*>)/i,"<tr>"),l=-1,u=0,d=0,h=0,f={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(s=0;s<c.length;++s){var g=c[s].trim(),m=g.slice(0,3).toLowerCase();if("<tr"!=m){if("<td"==m||"<th"==m){var v=g.split(/<\/t[dh]>/i);for(o=0;o<v.length;++o){var y=v[o].trim();if(y.match(/<t[dh]/i)){for(var b=y,w=0;"<"==b.charAt(0)&&(w=b.indexOf(">"))>-1;)b=b.slice(w+1);for(var x=0;x<p.length;++x){var E=p[x];E.s.c==u&&E.s.r<l&&l<=E.e.r&&(u=E.e.c+1,x=-1)}var T=bt(y.slice(0,y.indexOf(">")));h=T.colspan?+T.colspan:1,((d=+T.rowspan)>1||h>1)&&p.push({s:{r:l,c:u},e:{r:l+(d||1)-1,c:u+h-1}});var S=T.t||T["data-t"]||"";if(b.length)if(b=Mt(b),f.s.r>l&&(f.s.r=l),f.e.r<l&&(f.e.r=l),f.s.c>u&&(f.s.c=u),f.e.c<u&&(f.e.c=u),b.length){var I={t:"s",v:b};n.raw||!b.trim().length||"s"==S||("TRUE"===b?I={t:"b",v:!0}:"FALSE"===b?I={t:"b",v:!1}:isNaN(Je(b))?isNaN(et(b).getDate())||(I={t:"d",v:qe(b)},n.cellDates||(I={t:"n",v:je(I.v)}),I.z=n.dateNF||Q[14]):I={t:"n",v:Je(b)}),n.dense?(r[l]||(r[l]=[]),r[l][u]=I):r[$n({r:l,c:u})]=I,u+=h}else u+=h;else u+=h}}}}else{if(++l,n.sheetRows&&n.sheetRows<=l){--l;break}u=0}}return r["!ref"]=Gn(f),p.length&&(r["!merges"]=p),r}function Go(e,t,n,r){for(var a=e["!merges"]||[],i=[],s=t.s.c;s<=t.e.c;++s){for(var o=0,c=0,l=0;l<a.length;++l)if(!(a[l].s.r>n||a[l].s.c>s)&&!(a[l].e.r<n||a[l].e.c<s)){if(a[l].s.r<n||a[l].s.c<s){o=-1;break}o=a[l].e.r-a[l].s.r+1,c=a[l].e.c-a[l].s.c+1;break}if(!(o<0)){var u=$n({r:n,c:s}),d=r.dense?(e[n]||[])[s]:e[u],h=d&&null!=d.v&&(d.h||kt(d.w||(qn(d),d.w)||""))||"",f={};o>1&&(f.rowspan=o),c>1&&(f.colspan=c),r.editable?h='<span contenteditable="true">'+h+"</span>":d&&(f["data-t"]=d&&d.t||"z",null!=d.v&&(f["data-v"]=d.v),null!=d.z&&(f["data-z"]=d.z),d.l&&"#"!=(d.l.Target||"#").charAt(0)&&(h='<a href="'+d.l.Target+'">'+h+"</a>")),f.id=(r.id||"sjs")+"-"+u,i.push($t("td",h,f))}}return"<tr>"+i.join("")+"</tr>"}var Wo='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Ko="</body></html>";function qo(e,t,n){return[].join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function Yo(e,t){var n=t||{},r=null!=n.header?n.header:Wo,a=null!=n.footer?n.footer:Ko,i=[r],s=Hn(e["!ref"]);n.dense=Array.isArray(e),i.push(qo(0,0,n));for(var o=s.s.r;o<=s.e.r;++o)i.push(Go(e,s,o,n));return i.push("</table>"+a),i.join("")}function Qo(e,t,n){var r=n||{};var a=0,i=0;if(null!=r.origin)if("number"==typeof r.origin)a=r.origin;else{var s="string"==typeof r.origin?Vn(r.origin):r.origin;a=s.r,i=s.c}var o=t.getElementsByTagName("tr"),c=Math.min(r.sheetRows||1e7,o.length),l={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var u=Hn(e["!ref"]);l.s.r=Math.min(l.s.r,u.s.r),l.s.c=Math.min(l.s.c,u.s.c),l.e.r=Math.max(l.e.r,u.e.r),l.e.c=Math.max(l.e.c,u.e.c),-1==a&&(l.e.r=a=u.e.r+1)}var d=[],h=0,f=e["!rows"]||(e["!rows"]=[]),p=0,g=0,m=0,v=0,y=0,b=0;for(e["!cols"]||(e["!cols"]=[]);p<o.length&&g<c;++p){var w=o[p];if(Jo(w)){if(r.display)continue;f[g]={hidden:!0}}var x=w.children;for(m=v=0;m<x.length;++m){var E=x[m];if(!r.display||!Jo(E)){var T=E.hasAttribute("data-v")?E.getAttribute("data-v"):E.hasAttribute("v")?E.getAttribute("v"):Mt(E.innerHTML),S=E.getAttribute("data-z")||E.getAttribute("z");for(h=0;h<d.length;++h){var I=d[h];I.s.c==v+i&&I.s.r<g+a&&g+a<=I.e.r&&(v=I.e.c+1-i,h=-1)}b=+E.getAttribute("colspan")||1,((y=+E.getAttribute("rowspan")||1)>1||b>1)&&d.push({s:{r:g+a,c:v+i},e:{r:g+a+(y||1)-1,c:v+i+(b||1)-1}});var k={t:"s",v:T},C=E.getAttribute("data-t")||E.getAttribute("t")||"";null!=T&&(0==T.length?k.t=C||"z":r.raw||0==T.trim().length||"s"==C||("TRUE"===T?k={t:"b",v:!0}:"FALSE"===T?k={t:"b",v:!1}:isNaN(Je(T))?isNaN(et(T).getDate())||(k={t:"d",v:qe(T)},r.cellDates||(k={t:"n",v:je(k.v)}),k.z=r.dateNF||Q[14]):k={t:"n",v:Je(T)})),void 0===k.z&&null!=S&&(k.z=S);var _="",A=E.getElementsByTagName("A");if(A&&A.length)for(var N=0;N<A.length&&(!A[N].hasAttribute("href")||"#"==(_=A[N].getAttribute("href")).charAt(0));++N);_&&"#"!=_.charAt(0)&&(k.l={Target:_}),r.dense?(e[g+a]||(e[g+a]=[]),e[g+a][v+i]=k):e[$n({c:v+i,r:g+a})]=k,l.e.c<v+i&&(l.e.c=v+i),v+=b}}++g}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),l.e.r=Math.max(l.e.r,g-1+a),e["!ref"]=Gn(l),g>=c&&(e["!fullref"]=Gn((l.e.r=o.length-p+g-1+a,l))),e}function Xo(e,t){return Qo((t||{}).dense?[]:{},e,t)}function Jo(e){var t="",n=function(e){return e.ownerDocument.defaultView&&"function"===typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"===typeof getComputedStyle?getComputedStyle:null}(e);return n&&(t=n(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),"none"===t}function Zo(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,(function(e,t){return Array(parseInt(t,10)+1).join(" ")})).replace(/<text:tab[^>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n");return[Tt(t.replace(/<[^>]*>/g,""))]}var ec={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function tc(e,t){var n=t||{};var r,a,i,s,o,c,l=Ht(e),u=[],d={name:""},h="",f=0,p={},g=[],m=n.dense?[]:{},v={value:""},y="",b=0,w=[],x=-1,E=-1,T={s:{r:1e6,c:1e7},e:{r:0,c:0}},S=0,I={},k=[],C={},_=[],A=1,N=1,R=[],O={Names:[]},D={},P=["",""],L=[],M={},F="",z=0,j=!1,U=!1,B=0;for(Gt.lastIndex=0,l=l.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");o=Gt.exec(l);)switch(o[3]=o[3].replace(/_.*$/,"")){case"table":case"\u5de5\u4f5c\u8868":"/"===o[1]?(T.e.c>=T.s.c&&T.e.r>=T.s.r?m["!ref"]=Gn(T):m["!ref"]="A1:A1",n.sheetRows>0&&n.sheetRows<=T.e.r&&(m["!fullref"]=m["!ref"],T.e.r=n.sheetRows-1,m["!ref"]=Gn(T)),k.length&&(m["!merges"]=k),_.length&&(m["!rows"]=_),i.name=i["\u540d\u79f0"]||i.name,"undefined"!==typeof JSON&&JSON.stringify(i),g.push(i.name),p[i.name]=m,U=!1):"/"!==o[0].charAt(o[0].length-2)&&(i=bt(o[0],!1),x=E=-1,T.s.r=T.s.c=1e7,T.e.r=T.e.c=0,m=n.dense?[]:{},k=[],_=[],U=!0);break;case"table-row-group":"/"===o[1]?--S:++S;break;case"table-row":case"\u884c":if("/"===o[1]){x+=A,A=1;break}if((s=bt(o[0],!1))["\u884c\u53f7"]?x=s["\u884c\u53f7"]-1:-1==x&&(x=0),(A=+s["number-rows-repeated"]||1)<10)for(B=0;B<A;++B)S>0&&(_[x+B]={level:S});E=-1;break;case"covered-table-cell":"/"!==o[1]&&++E,n.sheetStubs&&(n.dense?(m[x]||(m[x]=[]),m[x][E]={t:"z"}):m[$n({r:x,c:E})]={t:"z"}),y="",w=[];break;case"table-cell":case"\u6570\u636e":if("/"===o[0].charAt(o[0].length-2))++E,v=bt(o[0],!1),N=parseInt(v["number-columns-repeated"]||"1",10),c={t:"z",v:null},v.formula&&0!=n.cellFormula&&(c.f=_s(Tt(v.formula))),"string"==(v["\u6570\u636e\u7c7b\u578b"]||v["value-type"])&&(c.t="s",c.v=Tt(v["string-value"]||""),n.dense?(m[x]||(m[x]=[]),m[x][E]=c):m[$n({r:x,c:E})]=c),E+=N-1;else if("/"!==o[1]){y="",b=0,w=[],N=1;var V=A?x+A-1:x;if(++E>T.e.c&&(T.e.c=E),E<T.s.c&&(T.s.c=E),x<T.s.r&&(T.s.r=x),V>T.e.r&&(T.e.r=V),L=[],M={},c={t:(v=bt(o[0],!1))["\u6570\u636e\u7c7b\u578b"]||v["value-type"],v:null},n.cellFormula)if(v.formula&&(v.formula=Tt(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(C={s:{r:x,c:E},e:{r:x+(parseInt(v["number-matrix-rows-spanned"],10)||0)-1,c:E+(parseInt(v["number-matrix-columns-spanned"],10)||0)-1}},c.F=Gn(C),R.push([C,c.F])),v.formula)c.f=_s(v.formula);else for(B=0;B<R.length;++B)x>=R[B][0].s.r&&x<=R[B][0].e.r&&E>=R[B][0].s.c&&E<=R[B][0].e.c&&(c.F=R[B][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(C={s:{r:x,c:E},e:{r:x+(parseInt(v["number-rows-spanned"],10)||0)-1,c:E+(parseInt(v["number-columns-spanned"],10)||0)-1}},k.push(C)),v["number-columns-repeated"]&&(N=parseInt(v["number-columns-repeated"],10)),c.t){case"boolean":c.t="b",c.v=_t(v["boolean-value"]);break;case"float":case"percentage":case"currency":c.t="n",c.v=parseFloat(v.value);break;case"date":c.t="d",c.v=qe(v["date-value"]),n.cellDates||(c.t="n",c.v=je(c.v)),c.z="m/d/yy";break;case"time":c.t="n",c.v=He(v["time-value"])/86400,n.cellDates&&(c.t="d",c.v=$e(c.v)),c.z="HH:MM:SS";break;case"number":c.t="n",c.v=parseFloat(v["\u6570\u636e\u6570\u503c"]);break;default:if("string"!==c.t&&"text"!==c.t&&c.t)throw new Error("Unsupported value type "+c.t);c.t="s",null!=v["string-value"]&&(y=Tt(v["string-value"]),w=[])}}else{if(j=!1,"s"===c.t&&(c.v=y||"",w.length&&(c.R=w),j=0==b),D.Target&&(c.l=D),L.length>0&&(c.c=L,L=[]),y&&!1!==n.cellText&&(c.w=y),j&&(c.t="z",delete c.v),(!j||n.sheetStubs)&&!(n.sheetRows&&n.sheetRows<=x))for(var $=0;$<A;++$){if(N=parseInt(v["number-columns-repeated"]||"1",10),n.dense)for(m[x+$]||(m[x+$]=[]),m[x+$][E]=0==$?c:Qe(c);--N>0;)m[x+$][E+N]=Qe(c);else for(m[$n({r:x+$,c:E})]=c;--N>0;)m[$n({r:x+$,c:E+N})]=Qe(c);T.e.c<=E&&(T.e.c=E)}E+=(N=parseInt(v["number-columns-repeated"]||"1",10))-1,N=0,c={},y="",w=[]}D={};break;case"document":case"document-content":case"\u7535\u5b50\u8868\u683c\u6587\u6863":case"spreadsheet":case"\u4e3b\u4f53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if("/"===o[1]){if((r=u.pop())[0]!==o[3])throw"Bad state: "+r}else"/"!==o[0].charAt(o[0].length-2)&&u.push([o[3],!0]);break;case"annotation":if("/"===o[1]){if((r=u.pop())[0]!==o[3])throw"Bad state: "+r;M.t=y,w.length&&(M.R=w),M.a=F,L.push(M)}else"/"!==o[0].charAt(o[0].length-2)&&u.push([o[3],!1]);F="",z=0,y="",b=0,w=[];break;case"creator":"/"===o[1]?F=l.slice(z,o.index):z=o.index+o[0].length;break;case"meta":case"\u5143\u6570\u636e":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===o[1]){if((r=u.pop())[0]!==o[3])throw"Bad state: "+r}else"/"!==o[0].charAt(o[0].length-2)&&u.push([o[3],!1]);y="",b=0,w=[];break;case"scientific-number":case"currency-symbol":case"currency-style":case"script":case"libraries":case"automatic-styles":case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":case"fraction":case"boolean-style":case"boolean":case"text-style":case"text-content":case"text-properties":case"embedded-text":case"body":case"\u7535\u5b50\u8868\u683c":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":case"s":case"date":case"object":case"title":case"\u6807\u9898":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if("/"===o[1]){if(I[d.name]=h,(r=u.pop())[0]!==o[3])throw"Bad state: "+r}else"/"!==o[0].charAt(o[0].length-2)&&(h="",d=bt(o[0],!1),u.push([o[3],!0]));break;case"number":case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(u[u.length-1][0]){case"time-style":case"date-style":a=bt(o[0],!1),h+=ec[o[3]]["long"===a.style?1:0]}break;case"text":if("/>"===o[0].slice(-2))break;if("/"===o[1])switch(u[u.length-1][0]){case"number-style":case"date-style":case"time-style":h+=l.slice(f,o.index)}else f=o.index+o[0].length;break;case"named-range":P=As((a=bt(o[0],!1))["cell-range-address"]);var H={Name:a.name,Ref:P[0]+"!"+P[1]};U&&(H.Sheet=g.length),O.Names.push(H);break;case"p":case"\u6587\u672c\u4e32":if(["master-styles"].indexOf(u[u.length-1][0])>-1)break;if("/"!==o[1]||v&&v["string-value"])bt(o[0],!1),b=o.index+o[0].length;else{var G=Zo(l.slice(b,o.index));y=(y.length>0?y+"\n":"")+G[0]}break;case"database-range":if("/"===o[1])break;try{p[(P=As(bt(o[0])["target-range-address"]))[0]]["!autofilter"]={ref:P[1]}}catch(K){}break;case"a":if("/"!==o[1]){if(!(D=bt(o[0],!1)).href)break;D.Target=Tt(D.href),delete D.href,"#"==D.Target.charAt(0)&&D.Target.indexOf(".")>-1?(P=As(D.Target.slice(1)),D.Target="#"+P[0]+"!"+P[1]):D.Target.match(/^\.\.[\\\/]/)&&(D.Target=D.Target.slice(3))}break;default:switch(o[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5b57:":break;default:if(n.WTF)throw new Error(o)}}var W={Sheets:p,SheetNames:g,Workbook:O};return n.bookSheets&&delete W.Sheets,W}function nc(e,t){t=t||{},at(e,"META-INF/manifest.xml")&&function(e,t){for(var n,r,a=Ht(e);n=Gt.exec(a);)switch(n[3]){case"manifest":break;case"file-entry":if("/"==(r=bt(n[0],!1)).path&&"application/vnd.oasis.opendocument.spreadsheet"!==r.type)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}(st(e,"META-INF/manifest.xml"),t);var n=ot(e,"content.xml");if(!n)throw new Error("Missing content.xml in ODS / UOF file");var r=tc(Dt(n),t);return at(e,"meta.xml")&&(r.Props=Ar(st(e,"meta.xml"))),r}function rc(e,t){return tc(e,t)}function ac(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function ic(e){return"undefined"!=typeof TextDecoder?(new TextDecoder).decode(e):Dt(L(e))}function sc(e){var t=e.reduce((function(e,t){return e+t.length}),0),n=new Uint8Array(t),r=0;return e.forEach((function(e){n.set(e,r),r+=e.length})),n}function oc(e){return 16843009*((e=(858993459&(e-=e>>1&1431655765))+(e>>2&858993459))+(e>>4)&252645135)>>>24}function cc(e,t){var n=t?t[0]:0,r=127&e[n];e:if(e[n++]>=128){if(r|=(127&e[n])<<7,e[n++]<128)break e;if(r|=(127&e[n])<<14,e[n++]<128)break e;if(r|=(127&e[n])<<21,e[n++]<128)break e;if(r+=(127&e[n])*Math.pow(2,28),++n,e[n++]<128)break e;if(r+=(127&e[n])*Math.pow(2,35),++n,e[n++]<128)break e;if(r+=(127&e[n])*Math.pow(2,42),++n,e[n++]<128)break e}return t&&(t[0]=n),r}function lc(e){var t=0,n=127&e[t];e:if(e[t++]>=128){if(n|=(127&e[t])<<7,e[t++]<128)break e;if(n|=(127&e[t])<<14,e[t++]<128)break e;if(n|=(127&e[t])<<21,e[t++]<128)break e;n|=(127&e[t])<<28}return n}function uc(e){for(var t=[],n=[0];n[0]<e.length;){var r,a=n[0],i=cc(e,n),s=7&i,o=0;if(0==(i=Math.floor(i/8)))break;switch(s){case 0:for(var c=n[0];e[n[0]++]>=128;);r=e.slice(c,n[0]);break;case 5:o=4,r=e.slice(n[0],n[0]+o),n[0]+=o;break;case 1:o=8,r=e.slice(n[0],n[0]+o),n[0]+=o;break;case 2:o=cc(e,n),r=e.slice(n[0],n[0]+o),n[0]+=o;break;default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(a))}var l={data:r,type:s};null==t[i]?t[i]=[l]:t[i].push(l)}return t}function dc(e,t){return(null==e?void 0:e.map((function(e){return t(e.data)})))||[]}function hc(e){for(var t,n=[],r=[0];r[0]<e.length;){var a=cc(e,r),i=uc(e.slice(r[0],r[0]+a));r[0]+=a;var s={id:lc(i[1][0].data),messages:[]};i[2].forEach((function(t){var n=uc(t.data),a=lc(n[3][0].data);s.messages.push({meta:n,data:e.slice(r[0],r[0]+a)}),r[0]+=a})),(null==(t=i[3])?void 0:t[0])&&(s.merge=lc(i[3][0].data)>>>0>0),n.push(s)}return n}function fc(e,t){if(0!=e)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var n=[0],r=cc(t,n),a=[];n[0]<t.length;){var i=3&t[n[0]];if(0!=i){var s=0,o=0;if(1==i?(o=4+(t[n[0]]>>2&7),s=(224&t[n[0]++])<<3,s|=t[n[0]++]):(o=1+(t[n[0]++]>>2),2==i?(s=t[n[0]]|t[n[0]+1]<<8,n[0]+=2):(s=(t[n[0]]|t[n[0]+1]<<8|t[n[0]+2]<<16|t[n[0]+3]<<24)>>>0,n[0]+=4)),a=[sc(a)],0==s)throw new Error("Invalid offset 0");if(s>a[0].length)throw new Error("Invalid offset beyond length");if(o>=s)for(a.push(a[0].slice(-s)),o-=s;o>=a[a.length-1].length;)a.push(a[a.length-1]),o-=a[a.length-1].length;a.push(a[0].slice(-s,-s+o))}else{var c=t[n[0]++]>>2;if(c<60)++c;else{var l=c-59;c=t[n[0]],l>1&&(c|=t[n[0]+1]<<8),l>2&&(c|=t[n[0]+2]<<16),l>3&&(c|=t[n[0]+3]<<24),c>>>=0,c++,n[0]+=l}a.push(t.slice(n[0],n[0]+c)),n[0]+=c}}var u=sc(a);if(u.length!=r)throw new Error("Unexpected length: ".concat(u.length," != ").concat(r));return u}function pc(e){for(var t=[],n=0;n<e.length;){var r=e[n++],a=e[n]|e[n+1]<<8|e[n+2]<<16;n+=3,t.push(fc(r,e.slice(n,n+a))),n+=a}if(n!==e.length)throw new Error("data is not a valid framed stream!");return sc(t)}function gc(e,t,n){var r,a=ac(e),i=a.getUint32(8,!0),s=12,o=-1,c=-1,l=NaN,u=NaN,d=new Date(2001,0,1);switch(1&i&&(l=function(e,t){for(var n=(127&e[t+15])<<7|e[t+14]>>1,r=1&e[t+14],a=t+13;a>=t;--a)r=256*r+e[a];return(128&e[t+15]?-r:r)*Math.pow(10,n-6176)}(e,s),s+=16),2&i&&(u=a.getFloat64(s,!0),s+=8),4&i&&(d.setTime(d.getTime()+1e3*a.getFloat64(s,!0)),s+=8),8&i&&(c=a.getUint32(s,!0),s+=4),16&i&&(o=a.getUint32(s,!0),s+=4),e[1]){case 0:break;case 2:case 10:r={t:"n",v:l};break;case 3:r={t:"s",v:t[c]};break;case 5:r={t:"d",v:d};break;case 6:r={t:"b",v:u>0};break;case 7:r={t:"n",v:u/86400};break;case 8:r={t:"e",v:0};break;case 9:if(!(o>-1))throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&i," : ").concat(e.slice(0,4)));r={t:"s",v:n[o]};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&i," : ").concat(e.slice(0,4)))}return r}function mc(e,t,n){switch(e[0]){case 0:case 1:case 2:case 3:return function(e,t,n,r){var a,i=ac(e),s=i.getUint32(4,!0),o=(r>1?12:8)+4*oc(s&(r>1?3470:398)),c=-1,l=-1,u=NaN,d=new Date(2001,0,1);switch(512&s&&(c=i.getUint32(o,!0),o+=4),o+=4*oc(s&(r>1?12288:4096)),16&s&&(l=i.getUint32(o,!0),o+=4),32&s&&(u=i.getFloat64(o,!0),o+=8),64&s&&(d.setTime(d.getTime()+1e3*i.getFloat64(o,!0)),o+=8),e[2]){case 0:break;case 2:a={t:"n",v:u};break;case 3:a={t:"s",v:t[l]};break;case 5:a={t:"d",v:d};break;case 6:a={t:"b",v:u>0};break;case 7:a={t:"n",v:u/86400};break;case 8:a={t:"e",v:0};break;case 9:if(c>-1)a={t:"s",v:n[c]};else if(l>-1)a={t:"s",v:t[l]};else{if(isNaN(u))throw new Error("Unsupported cell type ".concat(e.slice(0,4)));a={t:"n",v:u}}break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return a}(e,t,n,e[0]);case 5:return gc(e,t,n);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function vc(e){return cc(uc(e)[1][0].data)}function yc(e,t){var n=uc(t.data),r=lc(n[1][0].data),a=n[3],i=[];return(a||[]).forEach((function(t){var n=uc(t.data),a=lc(n[1][0].data)>>>0;switch(r){case 1:i[a]=ic(n[3][0].data);break;case 8:var s=uc(e[vc(n[9][0].data)][0].data),o=e[vc(s[1][0].data)][0],c=lc(o.meta[1][0].data);if(2001!=c)throw new Error("2000 unexpected reference to ".concat(c));var l=uc(o.data);i[a]=l[3].map((function(e){return ic(e.data)})).join("")}})),i}function bc(e,t){var n,r=uc(t.data),a=(null==(n=null==r?void 0:r[7])?void 0:n[0])?lc(r[7][0].data)>>>0>0?1:0:-1,i=dc(r[5],(function(e){return function(e,t){var n,r,a,i,s,o,c,l,u,d,h,f,p,g,m,v,y=uc(e),b=lc(y[1][0].data)>>>0,w=lc(y[2][0].data)>>>0,x=(null==(r=null==(n=y[8])?void 0:n[0])?void 0:r.data)&&lc(y[8][0].data)>0||!1;if((null==(i=null==(a=y[7])?void 0:a[0])?void 0:i.data)&&0!=t)m=null==(o=null==(s=y[7])?void 0:s[0])?void 0:o.data,v=null==(l=null==(c=y[6])?void 0:c[0])?void 0:l.data;else{if(!(null==(d=null==(u=y[4])?void 0:u[0])?void 0:d.data)||1==t)throw"NUMBERS Tile missing ".concat(t," cell storage");m=null==(f=null==(h=y[4])?void 0:h[0])?void 0:f.data,v=null==(g=null==(p=y[3])?void 0:p[0])?void 0:g.data}for(var E=x?4:1,T=ac(m),S=[],I=0;I<m.length/2;++I){var k=T.getUint16(2*I,!0);k<65535&&S.push([I,k])}if(S.length!=w)throw"Expected ".concat(w," cells, found ").concat(S.length);var C=[];for(I=0;I<S.length-1;++I)C[S[I][0]]=v.subarray(S[I][1]*E,S[I+1][1]*E);return S.length>=1&&(C[S[S.length-1][0]]=v.subarray(S[S.length-1][1]*E)),{R:b,cells:C}}(e,a)}));return{nrows:lc(r[4][0].data)>>>0,data:i.reduce((function(e,t){return e[t.R]||(e[t.R]=[]),t.cells.forEach((function(n,r){if(e[t.R][r])throw new Error("Duplicate cell r=".concat(t.R," c=").concat(r));e[t.R][r]=n})),e}),[])}}function wc(e,t){var n={"!ref":"A1"},r=e[vc(uc(t.data)[2][0].data)],a=lc(r[0].meta[1][0].data);if(6001!=a)throw new Error("6000 unexpected reference to ".concat(a));return function(e,t,n){var r,a=uc(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(lc(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(lc(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));n["!ref"]=Gn(i);var s=uc(a[4][0].data),o=yc(e,e[vc(s[4][0].data)][0]),c=(null==(r=s[17])?void 0:r[0])?yc(e,e[vc(s[17][0].data)][0]):[],l=uc(s[3][0].data),u=0;l[1].forEach((function(t){var r=uc(t.data),a=e[vc(r[2][0].data)][0],i=lc(a.meta[1][0].data);if(6002!=i)throw new Error("6001 unexpected reference to ".concat(i));var s=bc(0,a);s.data.forEach((function(e,t){e.forEach((function(e,r){var a=$n({r:u+t,c:r}),i=mc(e,o,c);i&&(n[a]=i)}))})),u+=s.nrows}))}(e,r[0],n),n}function xc(e,t){var n={SheetNames:[],Sheets:{}};if(dc(uc(t.data)[1],vc).forEach((function(t){e[t].forEach((function(t){if(2==lc(t.meta[1][0].data)){var r=function(e,t){var n,r=uc(t.data),a={name:(null==(n=r[1])?void 0:n[0])?ic(r[1][0].data):"",sheets:[]};return dc(r[2],vc).forEach((function(t){e[t].forEach((function(t){6e3==lc(t.meta[1][0].data)&&a.sheets.push(wc(e,t))}))})),a}(e,t);r.sheets.forEach((function(e,t){Vc(n,e,0==t?r.name:r.name+"_"+t,!0)}))}}))})),0==n.SheetNames.length)throw new Error("Empty NUMBERS file");return n}function Ec(e){var t,n,r,a,i={},s=[];if(e.FullPaths.forEach((function(e){if(e.match(/\.iwpv2/))throw new Error("Unsupported password protection")})),e.FileIndex.forEach((function(e){if(e.name.match(/\.iwa$/)){var t,n;try{t=pc(e.content)}catch(r){return console.log("?? "+e.content.length+" "+(r.message||r))}try{n=hc(t)}catch(r){return console.log("## "+(r.message||r))}n.forEach((function(e){i[e.id]=e.messages,s.push(e.id)}))}})),!s.length)throw new Error("File has no messages");var o=(null==(a=null==(r=null==(n=null==(t=null==i?void 0:i[1])?void 0:t[0])?void 0:n.meta)?void 0:r[1])?void 0:a[0].data)&&1==lc(i[1][0].meta[1][0].data)&&i[1][0];if(o||s.forEach((function(e){i[e].forEach((function(e){if(1==lc(e.meta[1][0].data)>>>0){if(o)throw new Error("Document has multiple roots");o=e}}))})),!o)throw new Error("Cannot find Document root");return xc(i,o)}function Tc(e){return function(t){for(var n=0;n!=e.length;++n){var r=e[n];void 0===t[r[0]]&&(t[r[0]]=r[1]),"n"===r[2]&&(t[r[0]]=Number(t[r[0]]))}}}function Sc(e){Tc([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Ic(e,t,n,r,a,i,s,o,c,l,u,d){try{i[r]=kr(ot(e,n,!0),t);var h,f=st(e,t);switch(o){case"sheet":h=ho(f,t,a,c,i[r],l,u,d);break;case"chart":if(!(h=fo(f,t,a,c,i[r],l))||!h["!drawel"])break;var p=ht(h["!drawel"].Target,t),g=Ir(p),m=function(e,t){if(!e)return"??";var n=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][n].Target}(ot(e,p,!0),kr(ot(e,g,!0),p)),v=ht(m,p),y=Ir(v);h=Js(ot(e,v,!0),0,0,kr(ot(e,y,!0),v),0,h);break;case"macro":w=t,i[r],w.slice(-4),h={"!type":"macro"};break;case"dialog":h=function(e,t){return t.slice(-4),{"!type":"dialog"}}(0,t,0,0,i[r]);break;default:throw new Error("Unrecognized sheet type "+o)}s[r]=h;var b=[];i&&i[r]&&Me(i[r]).forEach((function(n){var a="";if(i[r][n].Type==Sr.CMNT){a=ht(i[r][n].Target,t);var s=mo(st(e,a,!0),a,c);if(!s||!s.length)return;Fi(h,s,!1)}i[r][n].Type==Sr.TCMNT&&(a=ht(i[r][n].Target,t),b=b.concat(function(e,t){var n=[],r=!1,a={},i=0;return e.replace(mt,(function(s,o){var c=bt(s);switch(wt(c[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<threadedComment":a={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":null!=a.t&&n.push(a);break;case"<text>":case"<text":i=o+s.length;break;case"</text>":a.t=e.slice(i,o).replace(/\r\n/g,"\n").replace(/\r/g,"\n");break;case"<mentions":case"<mentions>":case"<ext":r=!0;break;case"</mentions>":case"</ext>":r=!1;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return s})),n}(st(e,a,!0),c)))})),b&&b.length&&Fi(h,b,!0,c.people||[])}catch(x){if(c.WTF)throw x}var w}function kc(e){return"/"==e.charAt(0)?e.slice(1):e}function Cc(e,t){if(Ne(),Sc(t=t||{}),at(e,"META-INF/manifest.xml"))return nc(e,t);if(at(e,"objectdata.xml"))return nc(e,t);if(at(e,"Index/Document.iwa")){if("undefined"==typeof Uint8Array)throw new Error("NUMBERS file parsing requires Uint8Array support");if(e.FileIndex)return Ec(e);var n=Pe.utils.cfb_new();return lt(e).forEach((function(t){ut(n,t,ct(e,t))})),Ec(n)}if(!at(e,"[Content_Types].xml")){if(at(e,"index.xml.gz"))throw new Error("Unsupported NUMBERS 08 file");if(at(e,"index.xml"))throw new Error("Unsupported NUMBERS 09 file");throw new Error("Unsupported ZIP file")}var r,a,i=lt(e),s=function(e){var t={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};if(!e||!e.match)return t;var n={};if((e.match(mt)||[]).forEach((function(e){var r=bt(e);switch(r[0].replace(vt,"<")){case"<?xml":break;case"<Types":t.xmlns=r["xmlns"+(r[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":n[r.Extension]=r.ContentType;break;case"<Override":void 0!==t[Tr[r.ContentType]]&&t[Tr[r.ContentType]].push(r.PartName)}})),t.xmlns!==Wt)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=n,delete t.calcchains,t}(ot(e,"[Content_Types].xml")),o=!1;if(0===s.workbooks.length&&st(e,a="xl/workbook.xml",!0)&&s.workbooks.push(a),0===s.workbooks.length){if(!st(e,a="xl/workbook.bin",!0))throw new Error("Could not find workbook");s.workbooks.push(a),o=!0}"bin"==s.workbooks[0].slice(-3)&&(o=!0);var c={},l={};if(!t.bookSheets&&!t.bookProps){if(Ns=[],s.sst)try{Ns=go(st(e,kc(s.sst)),s.sst,t)}catch(N){if(t.WTF)throw N}t.cellStyles&&s.themes.length&&(c=function(e,t,n){return Di(e,n)}(ot(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(l=po(st(e,kc(s.style)),s.style,c,t))}s.links.map((function(n){try{kr(ot(e,Ir(kc(n))),n);return yo(st(e,kc(n)),0,n,t)}catch(N){}}));var u=uo(st(e,kc(s.workbooks[0])),s.workbooks[0],t),d={},h="";s.coreprops.length&&((h=st(e,kc(s.coreprops[0]),!0))&&(d=Ar(h)),0!==s.extprops.length&&(h=st(e,kc(s.extprops[0]),!0))&&function(e,t,n){var r={};t||(t={}),e=Dt(e),Nr.forEach((function(n){var a=(e.match(Lt(n[0]))||[])[1];switch(n[2]){case"string":a&&(t[n[1]]=Tt(a));break;case"bool":t[n[1]]="true"===a;break;case"raw":var i=e.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));i&&i.length>0&&(r[n[1]]=i[1])}})),r.HeadingPairs&&r.TitlesOfParts&&Rr(r.HeadingPairs,r.TitlesOfParts,t,n)}(h,d,t));var f={};t.bookSheets&&!t.bookProps||0!==s.custprops.length&&(h=ot(e,kc(s.custprops[0]),!0))&&(f=function(e,t){var n={},r="",a=e.match(Or);if(a)for(var i=0;i!=a.length;++i){var s=a[i],o=bt(s);switch(o[0]){case"<?xml":case"<Properties":break;case"<property":r=Tt(o.name);break;case"</property>":r=null;break;default:if(0===s.indexOf("<vt:")){var c=s.split(">"),l=c[0].slice(4),u=c[1];switch(l){case"lpstr":case"bstr":case"lpwstr":case"cy":case"error":n[r]=Tt(u);break;case"bool":n[r]=_t(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":n[r]=parseInt(u,10);break;case"r4":case"r8":case"decimal":n[r]=parseFloat(u);break;case"filetime":case"date":n[r]=qe(u);break;default:if("/"==l.slice(-1))break;t.WTF&&"undefined"!==typeof console&&console.warn("Unexpected",s,l,c)}}else if("</"===s.slice(0,2));else if(t.WTF)throw new Error(s)}}return n}(h,t));var p={};if((t.bookSheets||t.bookProps)&&(u.Sheets?r=u.Sheets.map((function(e){return e.name})):d.Worksheets&&d.SheetNames.length>0&&(r=d.SheetNames),t.bookProps&&(p.Props=d,p.Custprops=f),t.bookSheets&&"undefined"!==typeof r&&(p.SheetNames=r),t.bookSheets?p.SheetNames:t.bookProps))return p;r={};var g={};t.bookDeps&&s.calcchain&&(g=vo(st(e,kc(s.calcchain)),s.calcchain));var m,v,y=0,b={},w=u.Sheets;d.Worksheets=w.length,d.SheetNames=[];for(var x=0;x!=w.length;++x)d.SheetNames[x]=w[x].name;var E=o?"bin":"xml",T=s.workbooks[0].lastIndexOf("/"),S=(s.workbooks[0].slice(0,T+1)+"_rels/"+s.workbooks[0].slice(T+1)+".rels").replace(/^\//,"");at(e,S)||(S="xl/_rels/workbook."+E+".rels");var I=kr(ot(e,S,!0),S.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=bo(st(e,kc(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=function(e,t){var n=[],r=!1;return e.replace(mt,(function(e){var a=bt(e);switch(wt(a[0])){case"<?xml":case"<personList":case"</personList>":case"</person>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<person":n.push({name:a.displayname,id:a.id});break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return e})),n}(st(e,kc(s.people[0])),t)),I&&(I=function(e,t){if(!e)return 0;try{e=t.map((function(t){return t.id||(t.id=t.strRelID),[t.name,e["!id"][t.id].Target,(n=e["!id"][t.id].Type,Sr.WS.indexOf(n)>-1?"sheet":Sr.CS&&n==Sr.CS?"chart":Sr.DS&&n==Sr.DS?"dialog":Sr.MS&&n==Sr.MS?"macro":n&&n.length?n:"sheet")];var n}))}catch(N){return null}return e&&0!==e.length?e:null}(I,u.Sheets));var k=st(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=d.Worksheets;++y){var C="sheet";if(I&&I[y]?(m="xl/"+I[y][1].replace(/[\/]?xl\//,""),at(e,m)||(m=I[y][1]),at(e,m)||(m=S.replace(/_rels\/.*$/,"")+I[y][1]),C=I[y][2]):m=(m="xl/worksheets/sheet"+(y+1-k)+"."+E).replace(/sheet0\./,"sheet."),v=m.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&null!=t.sheets)switch(typeof t.sheets){case"number":if(y!=t.sheets)continue e;break;case"string":if(d.SheetNames[y].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var _=!1,A=0;A!=t.sheets.length;++A)"number"==typeof t.sheets[A]&&t.sheets[A]==y&&(_=1),"string"==typeof t.sheets[A]&&t.sheets[A].toLowerCase()==d.SheetNames[y].toLowerCase()&&(_=1);if(!_)continue e}}Ic(e,m,v,d.SheetNames[y],y,b,r,C,t,u,c,l)}return p={Directory:s,Workbook:u,Props:d,Custprops:f,Deps:g,Sheets:r,SheetNames:d.SheetNames,Strings:Ns,Styles:l,Themes:c,SSF:Qe(Q)},t&&t.bookFiles&&(e.files?(p.keys=i,p.files=e.files):(p.keys=[],p.files={},e.FullPaths.forEach((function(t,n){t=t.replace(/^Root Entry[\/]/,""),p.keys.push(t),p.files[t]=e.FileIndex[n]})))),t&&t.bookVBA&&(s.vba.length>0?p.vbaraw=st(e,kc(s.vba[0]),!0):s.defaults&&"application/vnd.ms-office.vbaProject"===s.defaults.bin&&(p.vbaraw=st(e,"xl/vbaProject.bin",!0))),p}function _c(e,t){var n=t||{},r="Workbook",a=Pe.find(e,r);try{if(r="/!DataSpaces/Version",!(a=Pe.find(e,r))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(function(e){var t={};t.id=e.read_shift(0,"lpp4"),t.R=qa(e,4),t.U=qa(e,4),t.W=qa(e,4)}(a.content),r="/!DataSpaces/DataSpaceMap",!(a=Pe.find(e,r))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var i=function(e){var t=[];e.l+=4;for(var n=e.read_shift(4);n-- >0;)t.push(Ya(e));return t}(a.content);if(1!==i.length||1!==i[0].comps.length||0!==i[0].comps[0].t||"StrongEncryptionDataSpace"!==i[0].name||"EncryptedPackage"!==i[0].comps[0].v)throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(a=Pe.find(e,r))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var s=function(e){var t=[];e.l+=4;for(var n=e.read_shift(4);n-- >0;)t.push(e.read_shift(0,"lpp4"));return t}(a.content);if(1!=s.length||"StrongEncryptionTransform"!=s[0])throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(a=Pe.find(e,r))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);Qa(a.content)}catch(c){}if(r="/EncryptionInfo",!(a=Pe.find(e,r))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var o=function(e){var t=qa(e);switch(t.Minor){case 2:return[t.Minor,Za(e)];case 3:return[t.Minor,ei()];case 4:return[t.Minor,ti(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}(a.content);if(r="/EncryptedPackage",!(a=Pe.find(e,r))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(4==o[0]&&"undefined"!==typeof decrypt_agile)return decrypt_agile(o[1],a.content,n.password||"",n);if(2==o[0]&&"undefined"!==typeof decrypt_std76)return decrypt_std76(o[1],a.content,n.password||"",n);throw new Error("File is password-protected")}function Ac(e,t){var n="";switch((t||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":n=A(e.slice(0,12));break;case"binary":n=e;break;default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function Nc(e,t){var n=0;e:for(;n<e.length;)switch(e.charCodeAt(n)){case 10:case 13:case 32:++n;break;case 60:return Ro(e.slice(n),t);default:break e}return Ma.to_workbook(e,t)}function Rc(e,t,n,r){return r?(n.type="string",Ma.to_workbook(e,n)):Ma.to_workbook(t,n)}function Oc(e,t){w();var n=t||{};if("undefined"!==typeof ArrayBuffer&&e instanceof ArrayBuffer)return Oc(new Uint8Array(e),((n=Qe(n)).type="array",n));"undefined"!==typeof Uint8Array&&e instanceof Uint8Array&&!n.type&&(n.type="undefined"!==typeof Deno?"buffer":"array");var r,a=e,i=!1;if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),Rs={},n.dateNF&&(Rs.dateNF=n.dateNF),n.type||(n.type=N&&Buffer.isBuffer(e)?"buffer":"base64"),"file"==n.type&&(n.type=N?"buffer":"binary",a=function(e){if("undefined"!==typeof Le)return Le.readFileSync(e);if("undefined"!==typeof Deno)return Deno.readFileSync(e);if("undefined"!==typeof $&&"undefined"!==typeof File&&"undefined"!==typeof Folder)try{var t=File(e);t.open("r"),t.encoding="binary";var n=t.read();return t.close(),n}catch(r){if(!r.message||!r.message.match(/onstruct/))throw r}throw new Error("Cannot access file "+e)}(e),"undefined"===typeof Uint8Array||N||(n.type="array")),"string"==n.type&&(i=!0,n.type="binary",n.codepage=65001,a=function(e){return e.match(/[^\x00-\x7F]/)?Pt(e):e}(e)),"array"==n.type&&"undefined"!==typeof Uint8Array&&e instanceof Uint8Array&&"undefined"!==typeof ArrayBuffer){var s=new ArrayBuffer(3),o=new Uint8Array(s);if(o.foo="bar",!o.foo)return(n=Qe(n)).type="array",Oc(M(a),n)}switch((r=Ac(a,n))[0]){case 208:if(207===r[1]&&17===r[2]&&224===r[3]&&161===r[4]&&177===r[5]&&26===r[6]&&225===r[7])return function(e,t){return Pe.find(e,"EncryptedPackage")?_c(e,t):Uo(e,t)}(Pe.read(a,n),n);break;case 9:if(r[1]<=8)return Uo(a,n);break;case 60:return Ro(a,n);case 73:if(73===r[1]&&42===r[2]&&0===r[3])throw new Error("TIFF Image File is not a spreadsheet");if(68===r[1])return function(e,t){var n=t||{},r=!!n.WTF;n.WTF=!0;try{var a=Da.to_workbook(e,n);return n.WTF=r,a}catch(i){if(n.WTF=r,!i.message.match(/SYLK bad record ID/)&&r)throw i;return Ma.to_workbook(e,t)}}(a,n);break;case 84:if(65===r[1]&&66===r[2]&&76===r[3])return Pa.to_workbook(a,n);break;case 80:return 75===r[1]&&r[2]<9&&r[3]<9?function(e,t){var n=e,r=t||{};return r.type||(r.type=N&&Buffer.isBuffer(e)?"buffer":"base64"),Cc(dt(n,r),r)}(a,n):Rc(e,a,n,i);case 239:return 60===r[3]?Ro(a,n):Rc(e,a,n,i);case 255:if(254===r[1])return function(e,t){var n=e;return"base64"==t.type&&(n=A(n)),n=T.utils.decode(1200,n.slice(2),"str"),t.type="binary",Nc(n,t)}(a,n);if(0===r[1]&&2===r[2]&&0===r[3])return Fa.to_workbook(a,n);break;case 0:if(0===r[1]){if(r[2]>=2&&0===r[3])return Fa.to_workbook(a,n);if(0===r[2]&&(8===r[3]||9===r[3]))return Fa.to_workbook(a,n)}break;case 3:case 131:case 139:case 140:return Oa.to_workbook(a,n);case 123:if(92===r[1]&&114===r[2]&&116===r[3])return si.to_workbook(a,n);break;case 10:case 13:case 32:return function(e,t){var n="",r=Ac(e,t);switch(t.type){case"base64":n=A(e);break;case"binary":n=e;break;case"buffer":n=e.toString("binary");break;case"array":n=Ye(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==r[0]&&187==r[1]&&191==r[2]&&(n=Dt(n)),t.type="binary",Nc(n,t)}(a,n);case 137:if(80===r[1]&&78===r[2]&&71===r[3])throw new Error("PNG Image File is not a spreadsheet")}return Ra.indexOf(r[0])>-1&&r[2]<=12&&r[3]<=31?Oa.to_workbook(a,n):Rc(e,a,n,i)}function Dc(e,t,n,r,a,i,s,o){var c=jn(n),l=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,h=1===a?[]:{};if(1!==a)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:n,enumerable:!1})}catch(m){h.__rowNum__=n}else h.__rowNum__=n;if(!s||e[n])for(var f=t.s.c;f<=t.e.c;++f){var p=s?e[n][f]:e[r[f]+c];if(void 0!==p&&void 0!==p.t){var g=p.v;switch(p.t){case"z":if(null==g)break;continue;case"e":g=0==g?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(null!=i[f]){if(null==g)if("e"==p.t&&null===g)h[i[f]]=null;else if(void 0!==l)h[i[f]]=l;else{if(!u||null!==g)continue;h[i[f]]=null}else h[i[f]]=u&&("n"!==p.t||"n"===p.t&&!1!==o.rawNumbers)?g:qn(p,g,o);null!=g&&(d=!1)}}else{if(void 0===l)continue;null!=i[f]&&(h[i[f]]=l)}}return{row:h,isempty:d}}function Pc(e,t){if(null==e||null==e["!ref"])return[];var n={t:"n",v:0},r=0,a=1,i=[],s=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},l=t||{},u=null!=l.range?l.range:e["!ref"];switch(1===l.header?r=1:"A"===l.header?r=2:Array.isArray(l.header)?r=3:null==l.header&&(r=0),typeof u){case"string":c=Wn(u);break;case"number":(c=Wn(e["!ref"])).s.r=u;break;default:c=u}r>0&&(a=0);var d=jn(c.s.r),h=[],f=[],p=0,g=0,m=Array.isArray(e),v=c.s.r,y=0,b={};m&&!e[v]&&(e[v]=[]);var w=l.skipHidden&&e["!cols"]||[],x=l.skipHidden&&e["!rows"]||[];for(y=c.s.c;y<=c.e.c;++y)if(!(w[y]||{}).hidden)switch(h[y]=Bn(y),n=m?e[v][y]:e[h[y]+d],r){case 1:i[y]=y-c.s.c;break;case 2:i[y]=h[y];break;case 3:i[y]=l.header[y-c.s.c];break;default:if(null==n&&(n={w:"__EMPTY",t:"s"}),o=s=qn(n,null,l),g=b[s]||0){do{o=s+"_"+g++}while(b[o]);b[s]=g,b[o]=1}else b[s]=1;i[y]=o}for(v=c.s.r+a;v<=c.e.r;++v)if(!(x[v]||{}).hidden){var E=Dc(e,c,v,h,r,i,m,l);(!1===E.isempty||(1===r?!1!==l.blankrows:l.blankrows))&&(f[p++]=E.row)}return f.length=p,f}var Lc=/"/g;function Mc(e,t,n,r,a,i,s,o){for(var c=!0,l=[],u="",d=jn(n),h=t.s.c;h<=t.e.c;++h)if(r[h]){var f=o.dense?(e[n]||[])[h]:e[r[h]+d];if(null==f)u="";else if(null!=f.v){c=!1,u=""+(o.rawNumbers&&"n"==f.t?f.v:qn(f,null,o));for(var p=0,g=0;p!==u.length;++p)if((g=u.charCodeAt(p))===a||g===i||34===g||o.forceQuotes){u='"'+u.replace(Lc,'""')+'"';break}"ID"==u&&(u='"ID"')}else null==f.f||f.F?u="":(c=!1,(u="="+f.f).indexOf(",")>=0&&(u='"'+u.replace(Lc,'""')+'"'));l.push(u)}return!1===o.blankrows&&c?null:l.join(s)}function Fc(e,t){var n=[],r=null==t?{}:t;if(null==e||null==e["!ref"])return"";var a=Wn(e["!ref"]),i=void 0!==r.FS?r.FS:",",s=i.charCodeAt(0),o=void 0!==r.RS?r.RS:"\n",c=o.charCodeAt(0),l=new RegExp(("|"==i?"\\|":i)+"+$"),u="",d=[];r.dense=Array.isArray(e);for(var h=r.skipHidden&&e["!cols"]||[],f=r.skipHidden&&e["!rows"]||[],p=a.s.c;p<=a.e.c;++p)(h[p]||{}).hidden||(d[p]=Bn(p));for(var g=0,m=a.s.r;m<=a.e.r;++m)(f[m]||{}).hidden||null!=(u=Mc(e,a,m,d,s,c,i,r))&&(r.strip&&(u=u.replace(l,"")),(u||!1!==r.blankrows)&&n.push((g++?o:"")+u));return delete r.dense,n.join("")}function zc(e,t){t||(t={}),t.FS="\t",t.RS="\n";var n=Fc(e,t);if("undefined"==typeof T||"string"==t.type)return n;var r=T.utils.encode(1200,n,"str");return String.fromCharCode(255)+String.fromCharCode(254)+r}function jc(e,t,n){var r,a=n||{},i=+!a.skipHeader,s=e||{},o=0,c=0;if(s&&null!=a.origin)if("number"==typeof a.origin)o=a.origin;else{var l="string"==typeof a.origin?Vn(a.origin):a.origin;o=l.r,c=l.c}var u={s:{c:0,r:0},e:{c:c,r:o+t.length-1+i}};if(s["!ref"]){var d=Wn(s["!ref"]);u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),-1==o&&(o=d.e.r+1,u.e.r=o+t.length-1+i)}else-1==o&&(o=0,u.e.r=t.length-1+i);var h=a.header||[],f=0;t.forEach((function(e,t){Me(e).forEach((function(n){-1==(f=h.indexOf(n))&&(h[f=h.length]=n);var l=e[n],u="z",d="",p=$n({c:c+f,r:o+t+i});r=Uc(s,p),!l||"object"!==typeof l||l instanceof Date?("number"==typeof l?u="n":"boolean"==typeof l?u="b":"string"==typeof l?u="s":l instanceof Date?(u="d",a.cellDates||(u="n",l=je(l)),d=a.dateNF||Q[14]):null===l&&a.nullError&&(u="e",l=0),r?(r.t=u,r.v=l,delete r.w,delete r.R,d&&(r.z=d)):s[p]=r={t:u,v:l},d&&(r.z=d)):s[p]=l}))})),u.e.c=Math.max(u.e.c,c+h.length-1);var p=jn(o);if(i)for(f=0;f<h.length;++f)s[Bn(f+c)+p]={t:"s",v:h[f]};return s["!ref"]=Gn(u),s}function Uc(e,t,n){if("string"==typeof t){if(Array.isArray(e)){var r=Vn(t);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return Uc(e,$n("number"!=typeof t?t:{r:t,c:n||0}))}function Bc(){return{SheetNames:[],Sheets:{}}}function Vc(e,t,n,r){var a=1;if(!n)for(;a<=65535&&-1!=e.SheetNames.indexOf(n="Sheet"+a);++a,n=void 0);if(!n||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(n)>=0){var i=n.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var s=i&&i[1]||n;for(++a;a<=65535&&-1!=e.SheetNames.indexOf(n=s+a);++a);}if(oo(n),e.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return e.SheetNames.push(n),e.Sheets[n]=t,n}function $c(e,t,n){return t?(e.l={Target:t},n&&(e.l.Tooltip=n)):delete e.l,e}var Hc={encode_col:Bn,encode_row:jn,encode_cell:$n,encode_range:Gn,decode_col:Un,decode_row:zn,split_cell:function(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:Vn,decode_range:Hn,format_cell:qn,sheet_add_aoa:Qn,sheet_add_json:jc,sheet_add_dom:Qo,aoa_to_sheet:Xn,json_to_sheet:function(e,t){return jc(null,e,t)},table_to_sheet:Xo,table_to_book:function(e,t){return Yn(Xo(e,t),t)},sheet_to_csv:Fc,sheet_to_txt:zc,sheet_to_json:Pc,sheet_to_html:Yo,sheet_to_formulae:function(e){var t,n="",r="";if(null==e||null==e["!ref"])return[];var a,i=Wn(e["!ref"]),s="",o=[],c=[],l=Array.isArray(e);for(a=i.s.c;a<=i.e.c;++a)o[a]=Bn(a);for(var u=i.s.r;u<=i.e.r;++u)for(s=jn(u),a=i.s.c;a<=i.e.c;++a)if(n=o[a]+s,r="",void 0!==(t=l?(e[u]||[])[a]:e[n])){if(null!=t.F){if(n=t.F,!t.f)continue;r=t.f,-1==n.indexOf(":")&&(n=n+":"+n)}if(null!=t.f)r=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)r=""+t.v;else if("b"==t.t)r=t.v?"TRUE":"FALSE";else if(void 0!==t.w)r="'"+t.w;else{if(void 0===t.v)continue;r="s"==t.t?"'"+t.v:""+t.v}}c[c.length]=n+"="+r}return c},sheet_to_row_object_array:Pc,sheet_get_cell:Uc,book_new:Bc,book_append_sheet:Vc,book_set_sheet_visibility:function(e,t,n){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=function(e,t){if("number"==typeof t){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"==typeof t){var n=e.SheetNames.indexOf(t);if(n>-1)return n;throw new Error("Cannot find sheet name |"+t+"|")}throw new Error("Cannot find sheet |"+t+"|")}(e,t);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}e.Workbook.Sheets[r].Hidden=n},cell_set_number_format:function(e,t){return e.z=t,e},cell_set_hyperlink:$c,cell_set_internal_link:function(e,t,n){return $c(e,"#"+t,n)},cell_add_comment:function(e,t,n){e.c||(e.c=[]),e.c.push({t:t,a:n||"SheetJS"})},sheet_set_array_formula:function(e,t,n,r){for(var a="string"!=typeof t?t:Wn(t),i="string"==typeof t?t:Gn(t),s=a.s.r;s<=a.e.r;++s)for(var o=a.s.c;o<=a.e.c;++o){var c=Uc(e,s,o);c.t="n",c.F=i,delete c.v,s==a.s.r&&o==a.s.c&&(c.f=n,r&&(c.D=!0))}return e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};f.version;const Gc=e=>{let{assignments:t=[],availablePlazas:a=[],solicitudes:s=[],procesarTodasLasSolicitudes:o,procesarSolicitudesPorMinuto:l,cargarDatosDesdeFirebase:u,eliminarSolicitudesDuplicadas:d,limpiarDuplicadosHistorial:h,db:f,loadingProcess:p,processingMessage:g,showNotification:m,lastProcessed:v,procesarSolicitudes:y}=e;const[b,w]=(0,r.useState)(!1),[x,E]=(0,r.useState)(!1),[T,S]=(0,r.useState)(""),[I,k]=(0,r.useState)(""),[C,_]=(0,r.useState)(""),[A,N]=(0,r.useState)(""),[R,O]=(0,r.useState)([]),[D,P]=(0,r.useState)(!1),[L,M]=(0,r.useState)({}),[F,z]=(0,r.useState)(!1),[j,U]=(0,r.useState)(!1),[B,V]=(0,r.useState)(null),[$,H]=(0,r.useState)([]),[G,W]=(0,r.useState)([]),[K,q]=(0,r.useState)(""),Y=(0,r.useMemo)((()=>{var e;const t=(null===K||void 0===K||null===(e=K.toLowerCase())||void 0===e?void 0:e.trim())||"";return t?$.filter((e=>e.nombre&&e.nombre.toLowerCase().includes(t)||e.centro&&e.centro.toLowerCase().includes(t)||e.codigo&&e.codigo.toLowerCase().includes(t)||e.municipio&&e.municipio.toLowerCase().includes(t)||e.localidad&&e.localidad.toLowerCase().includes(t))):$}),[$,K]);if(!b)return(0,c.jsxs)("div",{style:{maxWidth:"1280px",margin:"0 auto",padding:"20px",fontFamily:"Arial, sans-serif",display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",flexDirection:"column"},children:[(0,c.jsx)("h1",{style:{marginBottom:"30px",color:"#2c3e50"},children:"Panel de Administraci\xf3n"}),(0,c.jsxs)("div",{style:{backgroundColor:"white",padding:"30px",borderRadius:"10px",boxShadow:"0 4px 15px rgba(0,0,0,0.1)",width:"100%",maxWidth:"400px"},children:[(0,c.jsx)("h2",{style:{textAlign:"center",marginBottom:"25px"},children:"Autenticaci\xf3n Requerida"}),x&&(0,c.jsx)("div",{style:{backgroundColor:"#f8d7da",color:"#721c24",padding:"10px",borderRadius:"5px",marginBottom:"15px",textAlign:"center"},children:"Contrase\xf1a incorrecta. Int\xe9ntalo de nuevo."}),(0,c.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,c.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"bold"},children:"Contrase\xf1a de Administrador:"}),(0,c.jsx)("input",{type:"password",value:T,onChange:e=>S(e.target.value),style:{width:"100%",padding:"12px",border:"1px solid #ddd",borderRadius:"5px",fontSize:"16px"},placeholder:"Ingrese la contrase\xf1a",onKeyDown:e=>{"Enter"===e.key&&("SoyAdmin"===T?w(!0):E(!0))}})]}),(0,c.jsx)("button",{onClick:()=>{"SoyAdmin"===T?w(!0):E(!0)},style:{width:"100%",padding:"12px",backgroundColor:"#3498db",color:"white",border:"none",borderRadius:"5px",fontSize:"16px",fontWeight:"bold",cursor:"pointer"},children:"Acceder"}),(0,c.jsx)("div",{style:{marginTop:"20px",textAlign:"center"},children:(0,c.jsx)("a",{href:"/",style:{color:"#3498db",textDecoration:"none"},children:"Volver a la p\xe1gina principal"})})]})]});const Q=e=>{W((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e]))},X=(e,n)=>e||n?t.filter((t=>{const r=t.centerId||t.id||"",a=t.nombreCentro||t.centerName||t.centro||"";if(e&&r===e)return!0;if(n&&a.toLowerCase()===n.toLowerCase())return!0;try{if(n&&a){const e=a.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");if(e===n.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""))return!0}}catch(i){console.error("Error al comparar nombres normalizados:",i)}return!1})).length:0,J=async()=>{try{N("A\xf1adiendo centros seleccionados...");const e=R.filter(((e,t)=>L[t]));if(0===e.length)return m("No hay centros seleccionados para a\xf1adir","warning"),void N("");let t=(await(0,i.GG)((0,i.rJ)(f,"centros"))).size+1;const n=100;let r=0;for(let a=0;a<e.length;a+=n){const s=(0,i.wP)(f),o=e.slice(a,Math.min(a+n,e.length));for(const e of o){const n=(0,i.H9)((0,i.rJ)(f,"centros"));s.set(n,{id:(t++).toString(),codigo:e.codigo,centro:e.centro,nombre:e.centro,localidad:e.municipio,municipio:e.municipio,plazas:e.plazas,plazasTotal:e.plazas,asignadas:0,plazasOcupadas:0,plazasDisponibles:e.plazas,docId:n.id,timestamp:(0,i.O5)()}),r++}await s.commit(),N(`A\xf1adiendo centros: ${r}/${e.length}`)}await u(),m(`Se han a\xf1adido ${r} centros correctamente`,"success"),P(!1),O([]),M({}),N("")}catch(e){console.error("Error al a\xf1adir centros:",e),m(`Error al a\xf1adir centros: ${e.message}`,"error"),N("")}};return(0,c.jsxs)("div",{style:{maxWidth:"1280px",margin:"0 auto",padding:"20px",fontFamily:"Arial, sans-serif"},children:[(0,c.jsx)("style",{children:"\n          @keyframes spin {\n            0% { transform: rotate(0deg); }\n            100% { transform: rotate(360deg); }\n          }\n          \n          .processing-btn {\n            position: relative;\n            padding-left: 30px; /* Espacio para el spinner */\n            display: inline-flex;\n            align-items: center;\n          }\n          \n          .processing-indicator {\n            position: absolute;\n            left: 10px;\n            width: 15px;\n            height: 15px;\n            border: 2px solid rgba(255, 255, 255, 0.3);\n            border-radius: 50%;\n            border-top-color: white;\n            animation: spin 1s linear infinite;\n          }\n          \n          /* Estilos para el modal */\n          .modal-overlay {\n            position: fixed;\n            top: 0;\n            left: 0;\n            right: 0;\n            bottom: 0;\n            background-color: rgba(0, 0, 0, 0.5);\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            z-index: 1000;\n          }\n          \n          .modal-content {\n            background-color: white;\n            border-radius: 8px;\n            padding: 25px;\n            width: 90%;\n            max-width: 800px;\n            max-height: 90vh;\n            overflow-y: auto;\n            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);\n          }\n          \n          .modal-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            margin-bottom: 20px;\n          }\n          \n          .modal-close {\n            background: none;\n            border: none;\n            font-size: 24px;\n            cursor: pointer;\n            color: #666;\n          }\n          \n          .modal-body {\n            margin-bottom: 20px;\n          }\n          \n          .modal-footer {\n            display: flex;\n            justify-content: flex-end;\n            gap: 10px;\n          }\n          \n          .search-box {\n            width: 100%;\n            padding: 12px 15px;\n            border: 1px solid #ddd;\n            border-radius: 6px;\n            margin-bottom: 15px;\n            font-size: 16px;\n          }\n          \n          .centros-grid {\n            display: grid;\n            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));\n            gap: 15px;\n            margin-bottom: 20px;\n          }\n          \n          .centro-card {\n            border: 1px solid #eee;\n            border-radius: 6px;\n            padding: 15px;\n            cursor: pointer;\n            transition: all 0.2s;\n          }\n          \n          .centro-card:hover {\n            background-color: #f7f9fc;\n          }\n          \n          .centro-card.selected {\n            background-color: #e3f2fd;\n            border-color: #2196f3;\n          }\n          \n          .selected-centros {\n            margin-top: 20px;\n            border: 1px solid #e1e1e1;\n            border-radius: 6px;\n            padding: 15px;\n            background-color: #f9f9f9;\n          }\n          \n          .centro-selected-item {\n            display: flex;\n            align-items: center;\n            justify-content: space-between;\n            padding: 10px;\n            margin-bottom: 5px;\n            background-color: white;\n            border-radius: 4px;\n            border: 1px solid #eee;\n          }\n        "}),(0,c.jsx)("h2",{style:{marginBottom:"10px",color:"#333"},children:"Panel de Administraci\xf3n"}),(0,c.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"10px",padding:"20px",boxShadow:"0 2px 10px rgba(0,0,0,0.05)",marginBottom:"20px"},children:[(0,c.jsx)("h3",{style:{marginTop:0,color:"#2c3e50",marginBottom:"15px"},children:"Importaci\xf3n y Comparaci\xf3n de Centros"}),D?(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:{marginBottom:"15px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,c.jsxs)("h4",{style:{margin:0},children:["Centros Nuevos Encontrados: ",R.length]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("button",{onClick:()=>{const e={};R.forEach(((t,n)=>{e[n]=!0})),M(e)},style:{padding:"5px 10px",backgroundColor:"#2ecc71",color:"white",border:"none",borderRadius:"3px",cursor:"pointer",marginRight:"10px",fontSize:"12px"},children:"Seleccionar Todos"}),(0,c.jsx)("button",{onClick:()=>{const e={};R.forEach(((t,n)=>{e[n]=!1})),M(e)},style:{padding:"5px 10px",backgroundColor:"#e74c3c",color:"white",border:"none",borderRadius:"3px",cursor:"pointer",fontSize:"12px"},children:"Deseleccionar Todos"})]})]}),(0,c.jsx)("div",{style:{maxHeight:"400px",overflowY:"auto",border:"1px solid #eee",borderRadius:"5px",marginBottom:"15px"},children:(0,c.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,c.jsx)("thead",{children:(0,c.jsxs)("tr",{style:{backgroundColor:"#f8f9fa",position:"sticky",top:0},children:[(0,c.jsx)("th",{style:{padding:"10px",textAlign:"left",borderBottom:"1px solid #eee"},children:"Selec."}),(0,c.jsx)("th",{style:{padding:"10px",textAlign:"left",borderBottom:"1px solid #eee"},children:"C\xf3digo"}),(0,c.jsx)("th",{style:{padding:"10px",textAlign:"left",borderBottom:"1px solid #eee"},children:"Centro"}),(0,c.jsx)("th",{style:{padding:"10px",textAlign:"left",borderBottom:"1px solid #eee"},children:"Municipio"}),(0,c.jsx)("th",{style:{padding:"10px",textAlign:"left",borderBottom:"1px solid #eee"},children:"Plazas"})]})}),(0,c.jsx)("tbody",{children:R.map(((e,t)=>(0,c.jsxs)("tr",{style:{borderBottom:"1px solid #eee"},children:[(0,c.jsx)("td",{style:{padding:"8px"},children:(0,c.jsx)("input",{type:"checkbox",checked:L[t]||!1,onChange:()=>{M((e=>({...e,[t]:!e[t]})))}})}),(0,c.jsx)("td",{style:{padding:"8px"},children:e.codigo}),(0,c.jsx)("td",{style:{padding:"8px"},children:e.centro}),(0,c.jsx)("td",{style:{padding:"8px"},children:e.municipio}),(0,c.jsx)("td",{style:{padding:"8px"},children:e.plazas})]},t)))})]})}),(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("button",{onClick:()=>{P(!1),O([]),M({})},style:{padding:"10px 20px",backgroundColor:"#f1f1f1",color:"#333",border:"none",borderRadius:"5px",cursor:"pointer"},children:"Cancelar"}),(0,c.jsx)("button",{onClick:J,style:{padding:"10px 20px",backgroundColor:"#2ecc71",color:"white",border:"none",borderRadius:"5px",cursor:"pointer"},disabled:""!==A,children:A?(0,c.jsxs)("span",{className:"processing-btn",children:[(0,c.jsx)("span",{className:"processing-indicator"}),"Procesando..."]}):`A\xf1adir ${Object.values(L).filter(Boolean).length} centros seleccionados`})]})]}):(0,c.jsxs)("div",{children:[(0,c.jsx)("p",{style:{marginBottom:"20px"},children:"Selecciona un archivo Excel o CSV para comparar con los centros existentes y a\xf1adir los nuevos."}),(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"center",marginBottom:"10px"},children:[(0,c.jsx)("input",{type:"file",id:"fileInput",accept:".csv,.xlsx",style:{display:"none"},onChange:async e=>{if(e.target.files&&e.target.files.length>0){const t=e.target.files[0];await(async e=>{try{N("Analizando archivo...");const c=await(0,i.GG)((0,i.rJ)(f,"centros")),l={},u={};c.forEach((e=>{const t=e.data();if(t.codigo&&(l[t.codigo.toLowerCase()]={...t,docId:e.id}),t.centro){const n=t.centro.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");u[n]={...t,docId:e.id}}}));let d=[];if(e.name.toLowerCase().endsWith(".xlsx")){const a=Oc(await e.arrayBuffer(),{type:"array"}),i=a.Sheets[a.SheetNames[0]],s=Hc.sheet_to_json(i,{header:1});let o=-1;for(let e=0;e<Math.min(20,s.length);e++){const t=s[e];if(Array.isArray(t)&&t.some((e=>"string"===typeof e&&(e.toLowerCase().includes("codigo")||e.toLowerCase().includes("centro")||e.toLowerCase().includes("municipio")||e.toLowerCase().includes("cod")||e.toLowerCase().includes("cent"))))){o=e;break}}if(-1===o)throw new Error("No se encontr\xf3 una fila de encabezado v\xe1lida en el Excel. Prueba con otro archivo o formato.");const c=s[o];console.log("Encabezados encontrados:",c);const l=e=>{let t=c.findIndex((t=>"string"===typeof t&&e.some((e=>t.toUpperCase()===e.toUpperCase()))));return-1===t&&(t=c.findIndex((t=>"string"===typeof t&&e.some((e=>t.toUpperCase().includes(e.toUpperCase())))))),t},u=l(["CODIGO","C\xd3DIGO","COD","CODCENTRO","CODIGO_CENTRO"]),h=l(["CENTRO","CENT","NOMBRE","NOMBRE_CENTRO","NOMBRECENTRO","NOM_CENTRO"]),f=l(["MUNICIPIO","MUN","LOCALIDAD","LOCAL","CIUDAD"]),p=l(["PLAZAS","PLAZA","PLAZ","NUM_PLAZAS","PLAZAS_DISPONIBLES"]);if(console.log("\xcdndices de columnas:",{codigo:u,centro:h,municipio:f,plazas:p}),-1===u&&-1===h)throw new Error("No se encontraron las columnas necesarias (c\xf3digo o centro). Se necesita al menos una de estas columnas.");for(let e=o+1;e<s.length;e++){var t,n,r;const a=s[e];if(!Array.isArray(a))continue;const i=-1!==u&&u<a.length&&(null===(t=a[u])||void 0===t?void 0:t.toString().trim())||"",o=-1!==h&&h<a.length&&(null===(n=a[h])||void 0===n?void 0:n.toString().trim())||"",c=-1!==f&&f<a.length&&(null===(r=a[f])||void 0===r?void 0:r.toString().trim())||"";let l=1;if(-1!==p&&p<a.length&&void 0!==a[p]){const e=parseFloat(a[p]);!isNaN(e)&&e>0&&(l=e)}(i&&i.length>0||o&&o.length>0)&&d.push({codigo:i,centro:o||i,municipio:c,plazas:l})}}else{const t=(await e.text()).split("\n").map((e=>e.replace(/"/g,"").trim())).filter(Boolean);let n=";";const r=t[0];r&&(r.includes("\t")?(n="\t",console.log("Formato detectado: CSV con separador de tabulaciones")):r.includes(",")&&!r.includes(";")?(n=",",console.log("Formato detectado: CSV con separador de comas")):console.log("Formato detectado: CSV con separador de punto y coma"));let i=-1;for(let e=0;e<Math.min(20,t.length);e++){const n=t[e].toLowerCase();if(n.includes("codigo")||n.includes("centro")||n.includes("municipio")||n.includes("cod")||n.includes("cent")){i=e;break}}if(-1===i)throw new Error("No se encontr\xf3 una l\xednea de encabezado v\xe1lida en el CSV. Prueba con otro archivo o formato.");const c=t[i].split(n);console.log("Encabezados CSV encontrados:",c);const l=e=>{let t=c.findIndex((t=>"string"===typeof t&&e.some((e=>t.toUpperCase()===e.toUpperCase()))));return-1===t&&(t=c.findIndex((t=>"string"===typeof t&&e.some((e=>t.toUpperCase().includes(e.toUpperCase())))))),t},u=l(["CODIGO","C\xd3DIGO","COD","CODCENTRO","CODIGO_CENTRO"]),h=l(["CENTRO","CENT","NOMBRE","NOMBRE_CENTRO","NOMBRECENTRO","NOM_CENTRO"]),f=l(["MUNICIPIO","MUN","LOCALIDAD","LOCAL","CIUDAD"]),p=l(["PLAZAS","PLAZA","PLAZ","NUM_PLAZAS","PLAZAS_DISPONIBLES"]);if(console.log("\xcdndices de columnas CSV:",{codigo:u,centro:h,municipio:f,plazas:p}),-1===u&&-1===h)throw new Error("No se encontraron las columnas necesarias (c\xf3digo o centro). Se necesita al menos una de estas columnas.");for(let e=i+1;e<t.length;e++){var a,s,o;const r=t[e].split(n),i=-1!==u&&u<r.length&&(null===(a=r[u])||void 0===a?void 0:a.trim())||"",c=-1!==h&&h<r.length&&(null===(s=r[h])||void 0===s?void 0:s.trim())||"",l=-1!==f&&f<r.length&&(null===(o=r[f])||void 0===o?void 0:o.trim())||"";let g=1;if(-1!==p&&p<r.length&&void 0!==r[p]){const e=parseFloat(r[p]);!isNaN(e)&&e>0&&(g=e)}(i&&i.length>0||c&&c.length>0)&&d.push({codigo:i,centro:c||i,municipio:l,plazas:g})}}console.log(`Se encontraron ${d.length} centros en el archivo`);const h=d.filter((e=>{const t=e.codigo.toLowerCase(),n=e.centro.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return!l[t]&&!u[n]}));O(h);const p={};return h.forEach(((e,t)=>{p[t]=!0})),M(p),P(!0),N(""),{total:d.length,nuevos:h.length}}catch(c){return console.error("Error al comparar centros:",c),m(`Error al analizar archivo: ${c.message}`,"error"),N(""),null}})(t)}}}),(0,c.jsx)("button",{onClick:()=>document.getElementById("fileInput").click(),style:{padding:"10px 20px",backgroundColor:"#3498db",color:"white",border:"none",borderRadius:"5px",cursor:"pointer",fontSize:"14px"},children:"Seleccionar Archivo"})]})]})]}),(0,c.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"10px",padding:"20px",boxShadow:"0 2px 10px rgba(0,0,0,0.05)",marginBottom:"20px"},children:[(0,c.jsx)("h3",{style:{marginTop:0,color:"#2c3e50",marginBottom:"15px"},children:"Acciones Administrativas"}),(0,c.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:"10px",marginBottom:"20px"},children:[(0,c.jsxs)("button",{onClick:async()=>{await d(),await h(),m("Duplicados eliminados correctamente","success")},style:{padding:"15px 20px",backgroundColor:"#e74c3c",color:"white",border:"none",borderRadius:"5px",cursor:"pointer",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px"},disabled:p,children:[(0,c.jsx)("span",{children:"\ud83d\uddd1\ufe0f"})," Eliminar Duplicados"]}),(0,c.jsxs)("button",{onClick:()=>o({respetarAsignacionesExistentes:!1}),style:{padding:"15px 20px",backgroundColor:"#3498db",color:"white",border:"none",borderRadius:"5px",cursor:t.length>0?"pointer":"not-allowed",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",opacity:t.length>0?1:.6},disabled:0===t.length||p,children:[(0,c.jsx)("span",{children:"\ud83d\udd04"})," Reasignar Plazas por Orden"]}),(0,c.jsxs)("div",{className:"button-group",children:[(0,c.jsx)("button",{onClick:l,disabled:p||F,className:"admin-button",children:p?"Procesando...":"Procesar Siguiente Solicitud"}),(0,c.jsx)("button",{onClick:async()=>{try{z(!0),N("Sincronizando historial de solicitudes...");const t=(0,i.rJ)(f,"asignaciones"),n=await(0,i.GG)(t),r=new Set;n.forEach((e=>{const t=e.data();t&&t.order&&r.add(t.order)}));const a=(0,i.rJ)(f,"historialSolicitudes"),s=await(0,i.GG)(a),o=(0,i.rJ)(f,"solicitudesPendientes");let c=0,l=0;for(const u of s.docs){const t=u.data();if(t.orden&&!r.has(t.orden))try{const e={...t,estado:"PENDIENTE",fechaCreacion:(new Date).toISOString(),timestamp:Date.now(),intentosFallidos:0};delete e.centroAsignado,delete e.centroId,delete e.fechaHistorico,await(0,i.gS)(o,e),c++}catch(e){console.error(`Error al restaurar solicitud ${t.orden}:`,e),l++}}N(""),m(`Sincronizaci\xf3n completada. ${c} solicitudes restauradas a pendientes. ${l} errores.`,"success"),await u()}catch(e){console.error("Error en sincronizaci\xf3n:",e),m("Error al sincronizar historial: "+e.message,"error")}finally{z(!1)}},disabled:p||F,className:"admin-button",style:{backgroundColor:"#3498db",color:"white",padding:"10px 15px",border:"none",borderRadius:"5px",cursor:"pointer",marginLeft:"10px"},children:F?"Sincronizando...":"Sincronizar Historial"})]})]})]}),g&&(0,c.jsxs)("div",{style:{marginTop:"15px",padding:"15px",backgroundColor:"#f8f9fa",borderRadius:"5px",fontStyle:"italic",marginBottom:"20px",textAlign:"center",border:"1px solid #e9ecef",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("strong",{children:"Estado:"})," ",g||A]}),(0,c.jsx)("button",{onClick:async()=>{N("Recargando datos...");const e=await u();N(e?"Datos recargados correctamente":"Error al recargar datos"),setTimeout((()=>{N("")}),2e3)},style:{padding:"5px 10px",backgroundColor:"#3498db",color:"white",border:"none",borderRadius:"3px",cursor:"pointer",fontSize:"13px"},children:"\ud83d\udd04 Recargar datos"})]}),(0,c.jsxs)("div",{style:{backgroundColor:"white",padding:"20px",borderRadius:"10px",boxShadow:"0 2px 10px rgba(0,0,0,0.05)",marginBottom:"20px"},children:[(0,c.jsx)("h2",{children:"Asignaciones Actuales"}),(0,c.jsxs)("div",{style:{marginBottom:"15px",padding:"10px 15px",borderRadius:"5px",backgroundColor:"#e8f4f8",fontSize:"14px",border:"1px solid #c8e1e9",color:"#2980b9"},children:[(0,c.jsx)("strong",{children:"Informaci\xf3n:"}),' El bot\xf3n "Reasignar" convierte una asignaci\xf3n actual en una solicitud pendiente, permitiendo que se reasigne a otro centro si hay mejor opci\xf3n disponible.']}),(0,c.jsx)("div",{style:{marginBottom:"15px"},children:(0,c.jsx)("input",{type:"text",placeholder:"Buscar por n\xfamero de orden o centro...",value:I,onChange:e=>k(e.target.value),style:{width:"100%",padding:"10px",border:"1px solid #ddd",borderRadius:"5px",marginBottom:"10px"}})}),t.length>0?(0,c.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,c.jsx)("thead",{children:(0,c.jsxs)("tr",{style:{backgroundColor:"#f8f9fa"},children:[(0,c.jsx)("th",{style:{padding:"10px",textAlign:"left"},children:"Orden"}),(0,c.jsx)("th",{style:{padding:"10px",textAlign:"left"},children:"Centro Asignado"}),(0,c.jsx)("th",{style:{padding:"10px",textAlign:"left"},children:"Plazas Disponibles"}),(0,c.jsx)("th",{style:{padding:"10px",textAlign:"left"},children:"Acciones"})]})}),(0,c.jsx)("tbody",{children:t.sort(((e,t)=>{const n=e.numeroOrden||e.order||0,r=t.numeroOrden||t.order||0;return Number(n)-Number(r)})).filter((e=>{const t=I.toLowerCase(),n=(e.numeroOrden||e.order||"").toString(),r=e.nombreCentro||e.centerName||"";return n.includes(t)||r.toLowerCase().includes(t)})).map(((e,t)=>{const n=(e=>{if(!e)return console.warn("encontrarCentro: assignment es undefined o null"),{id:"desconocido",nombre:"Centro no disponible",plazas:0,asignadas:0,municipio:"",localidad:""};let t=null;try{if(e.centroAsociado?t=e.centroAsociado:e.centerId&&a&&Array.isArray(a)&&(t=a.find((t=>t&&t.id===e.centerId))),!t&&e.nombreCentro&&"Centro no encontrado"!==e.nombreCentro&&a&&Array.isArray(a)){const r=e.nombreCentro.toLowerCase();if(t=a.find((e=>e&&e.nombre&&e.nombre.toLowerCase()===r||e&&e.centro&&e.centro.toLowerCase()===r)),!t)try{const e=r.normalize("NFD").replace(/[\u0300-\u036f]/g,"");t=a.find((t=>!(!t||!t.nombre&&!t.centro)&&(t.nombre||t.centro||"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")===e))}catch(n){console.error("Error al normalizar nombre:",n)}}if(!t&&e.centerId&&"string"===typeof e.centerId&&(t=a.find((t=>t&&(t.codigo===e.centerId||t.codigoCentro===e.centerId)))),!t&&e.nombreCentro){const n=e.nombreCentro.toLowerCase();t=a.find((e=>{if(!e)return!1;const t=(e.nombre||e.centro||"").toLowerCase();return t.includes(n)||n.includes(t)}))}}catch(n){console.error("Error en la b\xfasqueda de centro:",n)}if(t)t.plazasTotal=t.plazasTotal||t.plazas||0,t.plazasOcupadas=t.plazasOcupadas||t.asignadas||0,t.plazasDisponibles=Math.max(0,t.plazasTotal-t.plazasOcupadas);else{const n=e.nombreCentro||e.centerName||e.centro||e.centre;t={id:e.centerId||"desconocido",nombre:n||"Centro no disponible",plazas:0,plazasTotal:0,asignadas:0,plazasOcupadas:0,plazasDisponibles:0,municipio:e.municipio||"",localidad:e.localidad||""}}return t})(e),r=X(n.id,n.nombre||n.centro),s=n.plazasTotal||n.plazas||0,o=(Math.max(0,s-r),Math.max(0,s-r+1));return(0,c.jsxs)("tr",{style:{borderBottom:"1px solid #eee"},children:[(0,c.jsx)("td",{style:{padding:"10px"},children:e.numeroOrden||e.order}),(0,c.jsx)("td",{style:{padding:"10px"},children:e.nombreCentro||e.centerName||n&&(n.nombre||n.centro)||e.centro||e.centre||e.centerId||"Centro sin nombre"}),(0,c.jsx)("td",{style:{padding:"10px"},children:(0,c.jsxs)("div",{style:{padding:"5px",borderRadius:"3px",border:"1px solid #e6f2ff"},children:[(0,c.jsxs)("div",{style:{display:"flex",fontSize:"13px",justifyContent:"center",gap:"5px"},children:[(0,c.jsx)("span",{style:{color:o>0?"#2ecc71":"#e74c3c",fontWeight:"bold"},children:o}),(0,c.jsx)("span",{children:"disponibles de"}),(0,c.jsx)("span",{children:s}),s>0&&(0,c.jsxs)("span",{style:{marginLeft:"5px",backgroundColor:o>0?"#e8f5e9":"#ffebee",padding:"0px 5px",borderRadius:"10px",fontSize:"12px"},children:[Math.round(o/s*100),"%"]})]}),(0,c.jsx)("div",{style:{fontSize:"11px",color:"#718096",marginTop:"3px",textAlign:"center"},children:r>1?`(${r} asignaciones totales)`:"(1 asignaci\xf3n)"}),n.municipio&&(0,c.jsxs)("div",{style:{fontSize:"12px",color:"#718096",marginTop:"3px",textAlign:"center"},children:[n.municipio,n.localidad&&n.localidad!==n.municipio&&` (${n.localidad})`]})]})}),(0,c.jsx)("td",{style:{padding:"10px"},children:(0,c.jsx)("button",{onClick:()=>(async e=>{try{if(!e)throw new Error("La asignaci\xf3n no puede ser nula");console.log("Datos de asignaci\xf3n recibida:",e);const t=e.numeroOrden||e.order||e.orden;if(!t)throw console.error("Propiedades disponibles en la asignaci\xf3n:",Object.keys(e)),new Error("No se encontr\xf3 el n\xfamero de orden en la asignaci\xf3n");const n=e.centro||e.nombreCentro||e.centerName||e.centre;if(!n)throw console.error("Propiedades disponibles en la asignaci\xf3n:",Object.keys(e)),new Error("No se encontr\xf3 el centro en la asignaci\xf3n");const r=(0,i.rJ)(f,"historialSolicitudes"),a=(0,i.P)(r,(0,i._M)("numeroOrden","==",t)),s=await(0,i.GG)(a);let o;s.empty?(console.log("No se encontr\xf3 la solicitud original en el historial, creando una nueva..."),o={numeroOrden:t,centros:[n],estado:"PENDIENTE",fechaCreacion:(new Date).toISOString(),timestamp:Date.now()}):o=s.docs[0].data();const c=(0,i.rJ)(f,"centros"),l=await(0,i.GG)(c),u=(0,i.rJ)(f,"asignaciones"),d=await(0,i.GG)(u),h=new Map;d.forEach((e=>{const n=e.data();n.centro&&n.numeroOrden!==t&&h.set(n.centro,!0)}));const p=l.docs.map((e=>({id:e.id,...e.data()}))).filter((e=>{const t=e.nombre||e.centro;return o.centros&&o.centros.includes(t)})),g=p.sort(((e,t)=>{const n=o.centros.indexOf(e.nombre||e.centro),r=o.centros.indexOf(t.nombre||t.centro);if(-1!==n&&-1!==r)return n-r;if(-1!==n)return-1;if(-1!==r)return 1;const a=(e.nombre||e.centro||"").toLowerCase(),i=(t.nombre||t.centro||"").toLowerCase();return a.localeCompare(i)}));V(e),H(g),W([]),q(""),U(!0)}catch(t){console.error("Error al preparar reasignaci\xf3n:",t),m(`Error al preparar reasignaci\xf3n: ${t.message}`,"error")}})(e),style:{padding:"5px 10px",backgroundColor:"#f39c12",color:"white",border:"none",borderRadius:"3px",cursor:"pointer"},disabled:p,children:"Reasignar"})})]},e.docId||e.id||`assignment-${t}`)}))})]}):(0,c.jsx)("p",{children:"No hay asignaciones."})]}),(0,c.jsxs)("div",{style:{backgroundColor:"white",padding:"20px",borderRadius:"10px",boxShadow:"0 2px 10px rgba(0,0,0,0.05)",marginBottom:"20px"},children:[(0,c.jsx)("h2",{children:"Solicitudes Pendientes"}),(0,c.jsx)("div",{style:{marginBottom:"15px"},children:(0,c.jsx)("input",{type:"text",placeholder:"Buscar por n\xfamero de orden...",value:C,onChange:e=>_(e.target.value),style:{width:"100%",padding:"10px",border:"1px solid #ddd",borderRadius:"5px",marginBottom:"10px"}})}),s.length>0?(0,c.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,c.jsx)("thead",{children:(0,c.jsxs)("tr",{style:{backgroundColor:"#f8f9fa"},children:[(0,c.jsx)("th",{style:{padding:"10px",textAlign:"left"},children:"Orden"}),(0,c.jsx)("th",{style:{padding:"10px",textAlign:"left"},children:"Centros Solicitados"}),(0,c.jsx)("th",{style:{padding:"10px",textAlign:"left"},children:"Plazas Disponibles"}),(0,c.jsx)("th",{style:{padding:"10px",textAlign:"left"},children:"Acciones"})]})}),(0,c.jsx)("tbody",{children:s.sort(((e,t)=>Number(e.orden)-Number(t.orden))).filter((e=>{const t=C.toLowerCase();return String(e.orden).includes(t)})).map((e=>(0,c.jsxs)("tr",{style:{borderBottom:"1px solid #eee"},children:[(0,c.jsx)("td",{style:{padding:"10px"},children:e.orden}),(0,c.jsx)("td",{style:{padding:"10px"},children:e.centrosIds.map(((t,n)=>{let r=a.find((e=>e.id===t));if(r||(r=a.find((e=>e.id===t))),!r&&"string"===typeof t&&t.length>5){const e=t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");r=a.find((t=>(t.nombre||t.centro||"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")===e))}if(!r&&"string"===typeof t&&t.length>5){const e=t.toLowerCase(),n=a.find((t=>t.nombre&&t.nombre.toLowerCase().includes(e)||t.centro&&t.centro.toLowerCase().includes(e)));n&&(r=n)}r||"string"!==typeof t||(r=a.find((e=>e.codigo===t||e.codigoCentro===t))),!r&&"string"===typeof t&&t.length>3&&(r=a.find((e=>{if(e.nombre){return e.nombre.split(" ").map((e=>e.charAt(0))).filter((e=>e.match(/[A-Z]/))).join("")===t.toUpperCase()}return!1}))),r||(r={id:t,nombre:`Centro ${t}`,centro:`Centro ${t}`,plazas:0,plazasTotal:0,asignadas:0,plazasDisponibles:0});const i=r.plazasTotal||r.plazas||0,s=(r.plazasOcupadas||r.asignadas,X(r.id,r.nombre||r.centro)),o=Math.max(0,i-s);return(0,c.jsxs)("div",{style:{marginBottom:n<e.centrosIds.length-1?"5px":"0",padding:"5px",backgroundColor:0===n?"#f2f9ff":"transparent",borderRadius:"3px",border:"1px solid #e6f2ff"},children:[(0,c.jsxs)("div",{style:{fontWeight:"bold",fontSize:"14px"},children:[r.nombre||r.centro||t||"Centro desconocido",!1]}),(0,c.jsxs)("div",{style:{display:"flex",marginTop:"3px",fontSize:"13px",justifyContent:"center",gap:"5px"},children:[(0,c.jsx)("span",{style:{color:o>0?"#2ecc71":"#e74c3c",fontWeight:"bold"},children:o}),(0,c.jsx)("span",{children:"disponibles de"}),(0,c.jsx)("span",{children:i}),i>0&&(0,c.jsxs)("span",{style:{marginLeft:"5px",backgroundColor:o>0?"#e8f5e9":"#ffebee",padding:"0px 5px",borderRadius:"10px",fontSize:"12px"},children:[Math.round(o/i*100),"%"]})]}),s>0&&(0,c.jsxs)("div",{style:{fontSize:"11px",color:"#718096",marginTop:"3px",textAlign:"center"},children:["(",s,1===s?" asignaci\xf3n actual":" asignaciones actuales",")"]})]},t)}))}),(0,c.jsx)("td",{style:{padding:"10px"},children:(0,c.jsx)("button",{onClick:async()=>{try{if(N(`Procesando solicitud ${e.orden||"desconocida"}...`),!e)throw new Error("La solicitud no existe");const r=e.orden||"",s=e.centrosIds||[];if(r||console.warn("Procesando solicitud sin n\xfamero de orden:",e),!Array.isArray(s)||0===s.length)throw new Error("La solicitud no tiene centros seleccionados");const o={...e,orden:r,centrosIds:s};console.log("Procesando solicitud normalizada:",o);const{procesarSolicitud:c}=await Promise.resolve().then(n.bind(n,496)),l=await c(o,a,f);if(console.log("Resultado procesamiento individual:",l),l.success&&e.docId)try{N("Eliminando solicitud procesada..."),await(0,i.kd)((0,i.H9)(f,"solicitudesPendientes",e.docId))}catch(t){console.error("Error al eliminar solicitud procesada:",t)}if(N("Actualizando datos..."),await u(),N(""),l.success)m(`Solicitud ${r} procesada correctamente`,"success");else{if(!l.noAsignable)throw new Error(l.message||"Error desconocido");m(`No se pudo asignar la solicitud: ${l.message}`,"warning")}}catch(t){console.error("Error al procesar solicitud:",t),N(""),m(`Error al procesar solicitud: ${t.message}`,"error")}},style:{padding:"5px 10px",backgroundColor:"#3498db",color:"white",border:"none",borderRadius:"3px",cursor:"pointer"},disabled:p||A,children:A&&A.includes(`Procesando solicitud ${e.orden||"desconocida"}`)?(0,c.jsxs)("span",{className:"processing-btn",children:[(0,c.jsx)("span",{className:"processing-indicator"}),"Procesando..."]}):"Procesar"})})]},e.docId)))})]}):(0,c.jsx)("p",{children:"No hay solicitudes pendientes."})]}),(0,c.jsx)("div",{style:{textAlign:"center",marginTop:"20px"},children:(0,c.jsx)("a",{href:"/",style:{padding:"10px 20px",backgroundColor:"#f8f9fa",color:"#333",textDecoration:"none",borderRadius:"5px",fontWeight:"bold"},children:"Volver a la p\xe1gina principal"})}),(0,c.jsxs)("div",{style:{marginTop:"20px",padding:"15px",backgroundColor:"#f8f9fa",borderRadius:"5px",textAlign:"center",fontSize:"14px",color:"#666"},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:[(0,c.jsx)("h3",{style:{margin:0,fontSize:"16px",color:"#2c3e50"},children:"Resumen de plazas"}),(0,c.jsx)("button",{onClick:async()=>{N("Recalculando plazas disponibles...");const e={};t.forEach((t=>{const n=t.centerId||t.id,r=t.nombreCentro||t.centerName||t.centro||"";if(n&&(e[n]=(e[n]||0)+1),r&&r.length>0){const t=a.find((e=>e.nombre&&e.nombre.toLowerCase()===r.toLowerCase()||e.centro&&e.centro.toLowerCase()===r.toLowerCase()));t&&t.id!==n&&(e[t.id]=(e[t.id]||0)+1);try{const t=r.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),i=a.find((e=>{if(!e||!e.nombre&&!e.centro)return!1;return(e.nombre||e.centro||"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")===t&&e.id!==n}));i&&(e[i.id]=(e[i.id]||0)+1)}catch(i){console.error("Error en normalizaci\xf3n:",i)}}})),console.log("Conteo de asignaciones por centro:",e),a.forEach((t=>{const n=X(t.id,t.nombre||t.centro),r=e[t.id]||0;n!==r&&(console.warn(`Discrepancia en conteo para centro ${t.nombre}: \n                    - Conteo mapa: ${r}\n                    - Conteo manual: ${n}`),e[t.id]=Math.max(n,r))}));const n=a.map((t=>{const n=t.plazasTotal||t.plazas||0,r=e[t.id]||0;return{...t,asignadas:r,plazasOcupadas:r,plazasDisponibles:Math.max(0,n-r)}}));try{const e=(0,i.wP)(f);for(const t of n)t.docId&&e.update((0,i.H9)(f,"centros",t.docId),{asignadas:t.asignadas,plazasOcupadas:t.plazasOcupadas,plazasDisponibles:t.plazasDisponibles});await e.commit(),N("Actualizando datos desde Firebase..."),await u(),N("Plazas disponibles actualizadas correctamente")}catch(r){console.error("Error al actualizar plazas en la BD:",r),N("Error al actualizar en la BD: "+r.message)}setTimeout((()=>N("")),2e3)},style:{padding:"5px 10px",backgroundColor:"#2ecc71",color:"white",border:"none",borderRadius:"3px",cursor:"pointer",fontSize:"13px"},children:"\ud83d\udd04 Recalcular plazas"})]}),(0,c.jsxs)("p",{children:["Plazas asignadas: ",t.length," / Plazas totales: ",a.reduce(((e,t)=>e+(t.plazasTotal||t.plazas||0)),0)," / Plazas disponibles: ",a.reduce(((e,t)=>{const n=t.plazasTotal||t.plazas||0,r=t.plazasOcupadas||t.asignadas||0;return e+Math.max(0,n-r)}),0)]}),(()=>{const e=a.reduce(((e,t)=>e+(t.plazasTotal||t.plazas||0)),0),n=t.length,r=e>0?Math.round(n/e*100):0;let i="#2ecc71";return r>75?i="#e74c3c":r>50?i="#f39c12":r>25&&(i="#3498db"),(0,c.jsx)("div",{style:{marginTop:"10px",marginBottom:"15px"},children:(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"10px"},children:[(0,c.jsx)("div",{style:{width:"70%",maxWidth:"500px"},children:(0,c.jsx)("div",{style:{width:"100%",height:"10px",backgroundColor:"#ecf0f1",borderRadius:"5px",overflow:"hidden"},children:(0,c.jsx)("div",{style:{width:`${r}%`,height:"100%",backgroundColor:i,transition:"width 0.5s ease"}})})}),(0,c.jsxs)("div",{style:{fontWeight:"bold",color:i},children:[r,"% ocupadas"]})]})})})(),(0,c.jsxs)("p",{children:["Centros disponibles: ",a.length]}),(0,c.jsxs)("p",{children:["\xdaltima actualizaci\xf3n: ",v&&"function"===typeof v.getTime?v.toLocaleString():"No disponible"]})]}),(0,c.jsx)("div",{style:{marginTop:"40px"},children:(0,c.jsx)("footer",{style:{padding:"20px 15px",borderTop:"1px solid #ddd",backgroundColor:"#f8f9fa",textAlign:"center",color:"#333",fontSize:"14px",width:"100%",position:"relative",display:"block"},children:(0,c.jsxs)("div",{style:{maxWidth:"1280px",margin:"0 auto"},children:[(0,c.jsxs)("p",{style:{margin:"10px 0"},children:["Realizado por ",(0,c.jsx)("a",{href:"https://ag-marketing.es",target:"_blank",rel:"noopener noreferrer",style:{color:"#18539E",textDecoration:"none",fontWeight:"bold"},children:"AG-Marketing"})]}),(0,c.jsxs)("p",{style:{margin:"10px 0"},children:["\xa9 ",(new Date).getFullYear()," - Todos los derechos reservados"]})]})})}),j&&(0,c.jsx)("div",{className:"modal-overlay",style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.7)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},children:(0,c.jsxs)("div",{className:"modal-content",style:{backgroundColor:"white",borderRadius:"8px",padding:"25px",width:"90%",maxWidth:"800px",maxHeight:"90vh",overflowY:"auto",boxShadow:"0 5px 15px rgba(0, 0, 0, 0.3)",position:"relative"},children:[(0,c.jsxs)("div",{className:"modal-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px",borderBottom:"1px solid #eee",paddingBottom:"15px"},children:[(0,c.jsx)("h3",{style:{margin:0,color:"#2c3e50"},children:"Reasignar Asignaci\xf3n"}),(0,c.jsx)("button",{className:"modal-close",onClick:()=>U(!1),style:{background:"none",border:"none",fontSize:"24px",cursor:"pointer",color:"#666",padding:"5px"},children:"\xd7"})]}),(0,c.jsxs)("div",{className:"modal-body",style:{marginBottom:"20px"},children:[B&&(0,c.jsxs)("div",{style:{marginBottom:"20px",padding:"15px",backgroundColor:"#f8f9fa",borderRadius:"5px",border:"1px solid #eee"},children:[(0,c.jsxs)("p",{style:{margin:"0 0 10px 0",fontWeight:"bold"},children:["Orden: ",(0,c.jsx)("span",{style:{fontWeight:"normal"},children:B.numeroOrden||B.order})]}),(0,c.jsxs)("p",{style:{margin:"0 0 10px 0",fontWeight:"bold"},children:["Centro actual: ",(0,c.jsx)("span",{style:{fontWeight:"normal"},children:B.nombreCentro||B.centerName||"Desconocido"})]}),(0,c.jsx)("div",{style:{backgroundColor:"#e3f2fd",padding:"10px 15px",borderRadius:"5px",marginTop:"10px"},children:(0,c.jsxs)("p",{style:{margin:"0",fontSize:"14px"},children:[(0,c.jsx)("strong",{children:"Instrucciones:"})," Seleccione los centros a los que desea reasignar esta plaza en orden de preferencia. El primer centro seleccionado tendr\xe1 la mayor prioridad."]})})]}),(0,c.jsx)("h4",{style:{marginTop:"0",marginBottom:"15px"},children:"Seleccione centros disponibles"}),(0,c.jsx)("input",{type:"text",className:"search-box",placeholder:"Buscar centro por nombre, c\xf3digo o municipio...",value:K,onChange:e=>q(e.target.value),style:{width:"100%",padding:"12px 15px",border:"1px solid #ddd",borderRadius:"6px",marginBottom:"15px",fontSize:"16px"}}),G.length>0&&(0,c.jsxs)("div",{className:"selected-centros",style:{marginBottom:"20px",border:"1px solid #e1e1e1",borderRadius:"6px",padding:"15px",backgroundColor:"#f9f9f9"},children:[(0,c.jsx)("h4",{style:{marginTop:"0",marginBottom:"10px"},children:"Centros seleccionados (orden de preferencia)"}),(0,c.jsx)("div",{style:{maxHeight:"200px",overflowY:"auto"},children:G.map(((e,t)=>{const n=$.find((t=>t.id===e));return n?(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"10px",marginBottom:"5px",backgroundColor:"white",borderRadius:"4px",border:"1px solid #eee"},children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("strong",{style:{display:"block"},children:n.nombre||n.centro}),(0,c.jsxs)("small",{children:[n.municipio,n.municipio!==n.localidad&&n.localidad&&` - ${n.localidad}`]})]}),(0,c.jsxs)("div",{style:{display:"flex",gap:"5px"},children:[(0,c.jsx)("button",{onClick:()=>(e=>{e<=0||W((t=>{const n=[...t];return[n[e],n[e-1]]=[n[e-1],n[e]],n}))})(t),disabled:0===t,style:{padding:"3px 8px",backgroundColor:0===t?"#f0f0f0":"#f1f8e9",border:"1px solid #ddd",borderRadius:"3px",cursor:0===t?"default":"pointer",color:0===t?"#aaa":"#333"},children:"\u2191"}),(0,c.jsx)("button",{onClick:()=>(e=>{W((t=>{if(e>=t.length-1)return t;const n=[...t];return[n[e],n[e+1]]=[n[e+1],n[e]],n}))})(t),disabled:t===G.length-1,style:{padding:"3px 8px",backgroundColor:t===G.length-1?"#f0f0f0":"#f1f8e9",border:"1px solid #ddd",borderRadius:"3px",cursor:t===G.length-1?"default":"pointer",color:t===G.length-1?"#aaa":"#333"},children:"\u2193"}),(0,c.jsx)("button",{onClick:()=>Q(e),style:{padding:"3px 8px",backgroundColor:"#ffebee",border:"1px solid #ffcdd2",borderRadius:"3px",cursor:"pointer"},children:"\u2715"})]})]},e):null}))})]}),(0,c.jsx)("div",{style:{maxHeight:"300px",overflowY:"auto",marginTop:"20px",border:"1px solid #eee",borderRadius:"5px",padding:"10px"},children:(0,c.jsx)("div",{className:"centros-grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(250px, 1fr))",gap:"15px"},children:Y.map((e=>{const t=G.includes(e.id);return(0,c.jsxs)("div",{className:"centro-card "+(t?"selected":""),onClick:()=>Q(e.id),style:{border:"1px solid #eee",borderRadius:"6px",padding:"15px",cursor:"pointer",transition:"all 0.2s",backgroundColor:t?"#e3f2fd":"white",borderColor:t?"#2196f3":"#eee"},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,c.jsx)("h4",{style:{margin:"0 0 5px 0",fontSize:"16px"},children:e.nombre||e.centro}),t&&(0,c.jsx)("span",{style:{backgroundColor:"#2196f3",color:"white",borderRadius:"50%",width:"24px",height:"24px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",fontWeight:"bold"},children:G.indexOf(e.id)+1})]}),(0,c.jsxs)("div",{style:{fontSize:"13px",color:"#666",marginBottom:"5px"},children:[(0,c.jsx)("strong",{children:"C\xf3digo:"})," ",e.codigo||"N/A"]}),(0,c.jsxs)("div",{style:{fontSize:"13px",color:"#666",marginBottom:"5px"},children:[(0,c.jsx)("strong",{children:"Municipio:"})," ",e.municipio||"N/A",e.municipio!==e.localidad&&e.localidad&&` (${e.localidad})`]}),(0,c.jsxs)("div",{style:{fontSize:"13px",color:"#666"},children:[(0,c.jsx)("strong",{children:"Plazas disponibles:"})," ",e.plazasDisponibles||e.plazas-e.asignadas||0]})]},e.id)}))})})]}),(0,c.jsxs)("div",{className:"modal-footer",style:{display:"flex",justifyContent:"flex-end",gap:"10px",borderTop:"1px solid #eee",paddingTop:"15px",marginTop:"20px"},children:[(0,c.jsx)("button",{onClick:()=>U(!1),style:{padding:"10px 20px",backgroundColor:"#f1f1f1",color:"#333",border:"none",borderRadius:"5px",cursor:"pointer"},children:"Cancelar"}),(0,c.jsx)("button",{onClick:async()=>{try{if(!B)return void m("Error: No hay asignaci\xf3n seleccionada","error");if(0===G.length)return void m("Por favor, seleccione al menos un centro","warning");N("Procesando reasignaci\xf3n...");const e=B.docId||B.id;if(!e)return console.warn("Advertencia: La asignaci\xf3n no tiene identificador v\xe1lido:",B),m("Error: La asignaci\xf3n no tiene un identificador v\xe1lido","error"),void N("");if(!B.order&&!B.numeroOrden)return m("Error: No se pudo obtener el n\xfamero de orden","error"),void N("");const t=B.numeroOrden||B.order,n={orden:t,centrosIds:G,timestamp:(0,i.O5)()};console.log("Nueva solicitud a crear:",n);const r=(0,i.wP)(f),a=(0,i.H9)((0,i.rJ)(f,"solicitudesPendientes"));r.set(a,n);const s=(0,i.H9)(f,"asignaciones",e);r.delete(s);const o=new Date,c={orden:t,estado:"REASIGNANDO",mensaje:"Reasignaci\xf3n manual desde el panel de administraci\xf3n",fechaHistorico:o.toISOString(),timestamp:o.getTime()};B.centerId?c.centroAnterior=B.centerId:B.centro&&"string"===typeof B.centro&&(c.centroAnterior=B.centro),console.log("Datos de historial a crear:",c);const l=(0,i.H9)((0,i.rJ)(f,"historialSolicitudes"));r.set(l,c),await r.commit(),U(!1),V(null),N(""),await u(),m(`Asignaci\xf3n para orden ${t} movida a solicitudes pendientes con nuevos centros`,"success")}catch(e){console.error("Error al reasignar:",e),N(""),m(`Error al reasignar: ${e.message}`,"error")}},disabled:0===G.length||""!==A,style:{padding:"10px 20px",backgroundColor:0===G.length?"#ccc":"#2196f3",color:"white",border:"none",borderRadius:"5px",cursor:0===G.length?"not-allowed":"pointer"},children:A?(0,c.jsxs)("span",{className:"processing-btn",children:[(0,c.jsx)("span",{className:"processing-indicator"}),"Procesando..."]}):"Confirmar Reasignaci\xf3n"})]})]})})]})};const Wc=function(){const[e,t]=(0,r.useState)([]),[n,a]=(0,r.useState)([]),[f,p]=(0,r.useState)([]),[g,m]=(0,r.useState)([]),[v,y]=(0,r.useState)(!1),[b,w]=(0,r.useState)(""),[x,E]=(0,r.useState)(!1),[T,S]=(0,r.useState)(new Date),[I,k]=(0,r.useState)(45),[C,_]=(0,r.useState)(!1),[A,N]=(0,r.useState)(!1),[R,O]=(0,r.useState)(!1),[D,P]=(0,r.useState)("Iniciando sistema y verificando datos..."),[L,M]=(0,r.useState)(10),[F,z]=(0,r.useState)(!1),[j,U]=(0,r.useState)(!1),[B,V]=(0,r.useState)(!1),[$,H]=(0,r.useState)(""),[G,W]=(0,r.useState)([]),[K,q]=(0,r.useState)(!1),[Y,Q]=(0,r.useState)(null),[X,J]=(0,r.useState)(""),[Z,ee]=(0,r.useState)(""),[te,ne]=(0,r.useState)(!1),[re,ae]=(0,r.useState)(""),[ie,se]=(0,r.useState)("success"),[oe,ce]=(0,r.useState)("asignaciones"),le=(0,r.useRef)(!1),ue=(0,r.useRef)(!1),de=(0,r.useRef)(!1),he=(0,r.useRef)(null),fe=((0,r.useRef)(0),(0,r.useRef)(null)),pe=(0,r.useRef)(0),ge=(0,r.useRef)(!1),[me,ve]=(0,r.useState)(!1),[ye,be]=(0,r.useState)({show:!1,message:"",type:""}),[we,xe]=(0,r.useState)(""),[Ee,Te]=(0,r.useState)(!1),[Se,Ie]=(0,r.useState)(""),[ke,Ce]=(0,r.useState)(!1),[_e,Ae]=(0,r.useState)(""),[Ne,Re]=(0,r.useState)("all"),[Oe,De]=(0,r.useState)({}),[Pe,Le]=(0,r.useState)({}),[Me,Fe]=(0,r.useState)({}),[ze,je]=(0,r.useState)({}),[Ue,Be]=(0,r.useState)({asignaciones:0,pendientes:0,centros:0,historial:0}),Ve=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";ae(e),se(t),ne(!0),"error"!==t&&setTimeout((()=>{ne(!1)}),5e3)},$e=async()=>{if(!C){_(!0),w("Reseteando y recalculando contadores de asignaciones...");try{await We();const t=await(0,o.Ge)(e,n,s.db);pe.current=Date.now(),await We(),t.success?Ve(`Contadores recalculados correctamente: ${t.actualizados} centros actualizados.`,"success"):Ve(`Error al recalcular contadores: ${t.message}`,"error")}catch(t){console.error("Error al resetear contadores:",t),Ve(`Error al resetear contadores: ${t.message}`,"error")}finally{_(!1),w("")}}},He=async e=>{try{let u=null;if(e&&e.target&&e.target.files&&e.target.files.length>0)u=e.target.files[0];else try{const e="/asignacion-plazas/plazas.csv",t=await fetch(e);if(t.ok){const e=await t.text();u=new Blob([e],{type:"text/csv"})}else{console.log("CSV no encontrado en la ubicaci\xf3n predeterminada, abriendo di\xe1logo de selecci\xf3n...");const e=document.createElement("input");e.type="file",e.accept=".csv,.xlsx";const t=new Promise((t=>{e.onchange=e=>t(e.target.files[0])}));e.click(),u=await t}}catch(l){console.error("Error al intentar cargar CSV autom\xe1ticamente:",l);const e=document.createElement("input");e.type="file",e.accept=".csv,.xlsx";const t=new Promise((t=>{e.onchange=e=>t(e.target.files[0])}));e.click(),u=await t}E(!0),w("Cargando y procesando archivo CSV...");try{w("Obteniendo centros existentes...");const e=await(0,i.GG)((0,i.rJ)(s.db,"centros")),l={},d={};let h;e.forEach((e=>{const t=e.data();if(t.codigo&&(l[t.codigo]={...t,docId:e.id}),t.centro){const n=t.centro.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");d[n]={...t,docId:e.id}}})),console.log(`Se encontraron ${e.size} centros existentes`);if((u.name?u.name.toLowerCase():"").endsWith(".xlsx"))throw w("Procesando archivo Excel..."),new Error("El procesamiento de archivos Excel no est\xe1 implementado a\xfan");if(w("Procesando archivo CSV..."),h=await u.text(),h.length<100)throw new Error("El archivo CSV parece estar vac\xedo o es demasiado peque\xf1o");const f=h.split("\n").map((e=>e.replace(/"/g,"").trim())).filter(Boolean);if(f.length<5)throw new Error("El archivo CSV no contiene suficientes l\xedneas de datos");let p=f.findIndex((e=>e.includes("A.S.I.;")));if(-1===p){const e=f.findIndex((e=>e.includes("ASI;")||e.includes("DEPARTAMENTO;")||e.includes("CODIGO;")));if(-1===e)throw new Error("No se encontr\xf3 una l\xednea de encabezado v\xe1lida en el CSV");p=e}if(f[p].split(";").length<5)throw new Error("El formato del encabezado no es v\xe1lido, faltan columnas necesarias");const g=new Set,m=new Set,v=[],y=[];let b=Object.keys(l).length+1,x=0,T=0,S=0;w("Analizando datos del CSV...");for(let i=p+1;i<f.length;i++){var t,n,r,a,o,c;const e=f[i].trim();if(!e)continue;if(e.includes("de 11")||e.includes("TOTAL ="))continue;const s=e.split(";");if(s.length<5){T++;continue}const u=(null===(t=s[0])||void 0===t?void 0:t.trim())||"",h=(null===(n=s[1])||void 0===n?void 0:n.trim())||"",p=(null===(r=s[2])||void 0===r?void 0:r.trim())||"",E=(null===(a=s[3])||void 0===a?void 0:a.trim())||"",I=(null===(o=s[4])||void 0===o?void 0:o.trim())||"";if(!p||p.length<2){console.warn(`L\xednea ${i+1}: C\xf3digo inv\xe1lido o ausente: "${p}"`),T++;continue}if(!E||E.length<2){console.warn(`L\xednea ${i+1}: Nombre de centro inv\xe1lido o ausente: "${E}"`),T++;continue}if(!I){console.warn(`L\xednea ${i+1}: Municipio ausente para centro: "${E}"`),T++;continue}const k=`${p}-${E}-${I}`.toLowerCase();if(g.has(k)){S++;continue}m.has(p)&&console.warn(`Posible duplicado con c\xf3digo ${p}: "${E}" en ${I}`),g.add(k),m.add(p);let C=1;if(s.length>5&&null!==(c=s[5])&&void 0!==c&&c.trim()){const e=s[5].trim(),t=parseInt(e);!isNaN(t)&&t>0?C=t:console.warn(`L\xednea ${i+1}: Valor de plazas inv\xe1lido: "${e}", usando 1 por defecto`)}else console.warn(`L\xednea ${i+1}: No se especific\xf3 n\xfamero de plazas para "${E}", usando 1 por defecto`);x+=C;const _=l[p],A=E.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),N=d[A];_?y.push({..._,asi:u||_.asi,departamento:h||_.departamento,centro:E||_.centro,localidad:I||_.localidad,municipio:I||_.municipio,plazas:C,asignadas:_.asignadas||0}):N?y.push({...N,asi:u||N.asi,departamento:h||N.departamento,codigo:p||N.codigo,localidad:I||N.localidad,municipio:I||N.municipio,plazas:C,asignadas:N.asignadas||0}):v.push({id:b++,asi:u,departamento:h,codigo:p,centro:E,localidad:I,municipio:I,plazas:C,asignadas:0}),(v.length+y.length)%100===0&&w(`Procesando CSV: ${v.length} nuevos, ${y.length} actualizados...`)}if(0===v.length+y.length)throw new Error("No se pudieron extraer centros v\xe1lidos del CSV");w(`Actualizando ${y.length} centros existentes...`);for(const t of y)t.docId&&await(0,i.mZ)((0,i.H9)(s.db,"centros",t.docId),{...t});w(`A\xf1adiendo ${v.length} nuevos centros a Firebase...`);const I=100;for(let t=0;t<v.length;t+=I){const e=v.slice(t,t+I);w(`A\xf1adiendo nuevos centros: ${t}/${v.length}`);for(const t of e){const e=(0,i.H9)((0,i.rJ)(s.db,"centros"));await(0,i.BN)(e,{...t,docId:e.id})}}return w("Datos cargados correctamente"),await We(),E(!1),Ve(`Se han actualizado ${y.length} centros y a\xf1adido ${v.length} nuevos centros correctamente`,"success"),!0}catch(l){return console.error("Error al cargar o procesar el CSV:",l),Ve(`Error en la importaci\xf3n: ${l.message}`,"error"),E(!1),!1}}catch(l){return console.error("Error al cargar datos desde CSV:",l),Ve(`Error al cargar datos desde CSV: ${l.message}`,"error"),E(!1),!1}},Ge=async e=>{try{w(`Limpiando colecci\xf3n ${e}...`);const t=await(0,i.GG)((0,i.rJ)(s.db,e));if(t.size>0)for(const n of t.docs)await(0,i.kd)((0,i.H9)(s.db,e,n.id));return!0}catch(t){throw console.error(`Error al limpiar colecci\xf3n ${e}:`,t),t}},We=async()=>{console.log("Iniciando carga de datos desde Firebase...");try{console.log("Verificando colecciones disponibles en Firebase..."),console.log("Intentando cargar centros...");let e=await(0,i.GG)((0,i.rJ)(s.db,"centros"));if(e.empty){console.warn("\u26a0\ufe0f No se encontraron centros en la colecci\xf3n 'centros'");const t=(0,i.rJ)(s.db,"centrosTrabajo");e=await(0,i.GG)(t),e.empty?console.error("\u274c No se encontraron centros en ninguna colecci\xf3n"):console.log("\u2705 Se encontraron centros en la colecci\xf3n 'centrosTrabajo':",e.size)}else console.log("\u2705 Se encontraron centros en la colecci\xf3n 'centros':",e.size);console.log("Intentando cargar asignaciones para contar plazas ocupadas...");let n=await(0,i.GG)((0,i.rJ)(s.db,"asignaciones"));if(n.empty){console.warn("\u26a0\ufe0f No se encontraron asignaciones en la colecci\xf3n 'asignaciones'");const e=(0,i.rJ)(s.db,"asignacionesActuales");n=await(0,i.GG)(e),n.empty?console.error("\u274c No se encontraron asignaciones en ninguna colecci\xf3n"):console.log("\u2705 Se encontraron asignaciones en la colecci\xf3n 'asignacionesActuales':",n.size)}else console.log("\u2705 Se encontraron asignaciones en la colecci\xf3n 'asignaciones':",n.size);const r={};n.forEach((e=>{const t=e.data();if(t&&t.centerId){const e=t.centerId;r[e]=(r[e]||0)+1}})),console.log("Conteo de asignaciones por centro:",r);const o=new Set,c=new Set,l=new Map,u=[];e.forEach((e=>{const t=e.data(),n=t.nombre||t.centro||"Centro sin nombre",a=n.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g," ").trim(),i=t.codigoCentro||t.codigo||"",s=parseInt(t.plazas||t.plazasTotal||0,10),o=r[e.id]||0,c=Math.max(0,s-o);u.push({id:e.id,docId:e.id,nombre:n,nombreNormalizado:a,codigo:i,plazas:s,asignadas:o,plazasDisponibles:c,plazasOcupadas:o,plazasTotal:s,direccion:t.direccion||"",codigoCentro:i,estadoCentro:t.estadoCentro||"Activo",municipio:t.municipio||"",localidad:t.localidad||"",esDuplicado:!1,duplicadoDe:null})})),console.log(`Se encontraron ${u.length} centros en total antes de filtrar`);for(let t=0;t<u.length;t++){const e=u[t];if(!e.esDuplicado)if(o.has(e.id))e.esDuplicado=!0;else if(e.codigo&&c.has(e.codigo)&&console.warn(`Posible duplicado por c\xf3digo: ${e.codigo} - ${e.nombre}`),l.has(e.nombreNormalizado)){const t=l.get(e.nombreNormalizado);console.warn(`Duplicado por nombre: "${e.nombre}" duplica a ID=${t}`),e.esDuplicado=!0,e.duplicadoDe=t}else o.add(e.id),e.codigo&&c.add(e.codigo),l.set(e.nombreNormalizado,e.id)}const d=u.filter((e=>!e.esDuplicado));console.log(`Despu\xe9s de eliminar duplicados, quedan ${d.length} centros`);let h=d;h.length>366&&(console.warn(`A\xfan hay m\xe1s centros (${h.length}) de los esperados (366). Limitando...`),h=[...h].sort(((e,t)=>t.plazasTotal-e.plazasTotal)).slice(0,366));let f={};h.forEach((e=>{f[e.id]=e})),console.log(`Finalmente se cargar\xe1n ${Object.keys(f).length} centros`),0===Object.keys(f).length&&(console.warn("\u26a0\ufe0f Creando centros de prueba para diagn\xf3stico"),f.centro1={id:"centro1",nombre:"Centro de Prueba 1",plazas:10,asignadas:0,plazasDisponibles:10,plazasOcupadas:0,plazasTotal:10,direccion:"Direcci\xf3n de prueba",codigoCentro:"CP001",estadoCentro:"Activo"},f.centro2={id:"centro2",nombre:"Centro de Prueba 2",plazas:7,asignadas:2,plazasDisponibles:5,plazasOcupadas:2,plazasTotal:7,direccion:"Otra direcci\xf3n",codigoCentro:"CP002",estadoCentro:"Activo"}),console.log("Centros procesados:",Object.keys(f).length),console.log("Procesando asignaciones para mostrar...");const g={},v={};Object.values(f).forEach((e=>{if(g[e.id]=e,e.nombre){const t=e.nombre.toUpperCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");v[t]=e}if(e.centro&&e.centro!==e.nombre){const t=e.centro.toUpperCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");v[t]=e}})),console.log("Centros indexados:",{porId:Object.keys(g).length,porNombre:Object.keys(v).length});let y={};n.forEach((e=>{const t=e.data();if(console.log("Asignaci\xf3n encontrada:",e.id,t),t){let n=g[t.centerId];if(!n&&t.centro){const e=t.centro.toUpperCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");n=v[e],n&&console.log(`Centro encontrado por campo 'centro': "${t.centro}" corresponde a ID=${n.id}`)}if(!n&&t.centerId&&"string"===typeof t.centerId){const e=t.centerId.toUpperCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");n=v[e],n&&console.log(`Centro encontrado por centerId como nombre: "${t.centerId}" corresponde a ID=${n.id}`)}if(!n&&t.centerName){const e=t.centerName.toUpperCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");n=v[e],n&&console.log(`Centro encontrado por centerName: "${t.centerName}" corresponde a ID=${n.id}`)}let r="Centro no encontrado";n?r=n.nombre:t.centro?r=t.centro:t.centerName?r=t.centerName:t.centerId&&"string"===typeof t.centerId&&t.centerId.length>5&&(r=t.centerId),y[e.id]={id:e.id,numeroOrden:t.order||t.numeroOrden||0,centerId:t.centerId||t.centro||"",centroPrevio:t.centroPrevio||t.centroAnterior||"",nombreCentro:r,timestamp:t.timestamp||Date.now(),fechaAsignacion:t.fechaAsignacion||(new Date).toISOString(),centroAsociado:n}}})),console.log("Asignaciones procesadas:",Object.keys(y).length),console.log("Intentando cargar solicitudes pendientes...");const b=(0,i.rJ)(s.db,"solicitudesPendientes"),w=await(0,i.GG)(b);w.empty?console.warn("\u26a0\ufe0f No se encontraron solicitudes pendientes"):console.log("\u2705 Se encontraron solicitudes pendientes:",w.size);let x={};w.forEach((e=>{const t=e.data();console.log("Solicitud encontrada:",e.id,t),x[e.id]={id:e.id,numeroOrden:t.orden||t.numeroOrden||0,centrosIds:t.centrosIds||t.centrosSeleccionados||[],timestamp:t.timestamp||Date.now(),fechaSolicitud:t.fechaSolicitud||(new Date).toISOString(),estado:t.estado||"Pendiente"}})),console.log("Solicitudes procesadas:",Object.keys(x).length),console.log("Intentando cargar historial...");const E=(0,i.rJ)(s.db,"historialSolicitudes"),T=await(0,i.GG)(E);T.empty?console.warn("\u26a0\ufe0f No se encontr\xf3 historial de solicitudes"):console.log("\u2705 Se encontr\xf3 historial de solicitudes:",T.size);let S=[];T.forEach((e=>{var t,n;const r=e.data();S.push({id:e.id,numeroOrden:r.orden||r.numeroOrden||0,centerId:r.centerId||r.centro||"",centroPrevio:r.centroPrevio||"",centroAnterior:r.centroAnterior||"",nombreCentro:(null===(t=f[r.centerId])||void 0===t?void 0:t.nombre)||"Centro no encontrado",nombreCentroAnterior:r.centroAnterior?(null===(n=f[r.centroAnterior])||void 0===n?void 0:n.nombre)||"Centro no encontrado":"",timestamp:r.timestamp||Date.now(),fechaHistorico:r.fechaHistorico||(new Date).toISOString(),estado:r.estado||"Procesado",accion:r.accion||"Asignaci\xf3n",mensaje:r.mensaje||""})})),S.sort(((e,t)=>(t.timestamp||0)-(e.timestamp||0))),console.log("Historial procesado:",S.length,"registros"),t(Object.values(f)),a(Object.values(y)),p(Object.values(x)),m(S),De(f),Le(y),Fe(x);const I=Object.keys(y).length,k=Object.keys(x).length,C=Object.keys(f).length;Be({asignaciones:I,pendientes:k,centros:C,historial:S.length});let _={};Object.values(f).forEach((e=>{_[e.id]={id:e.id,nombre:e.nombre,plazas:e.plazas,asignadas:e.asignadas,plazasDisponibles:e.plazasDisponibles,plazasTotal:e.plazasTotal,codigoCentro:e.codigoCentro,estadoCentro:e.estadoCentro}})),je(_);const A=Object.values(f).reduce(((e,t)=>e+(t.plazasTotal||t.plazas||0)),0),N=Object.values(f).reduce(((e,t)=>e+(t.asignadas||t.plazasOcupadas||0)),0),R=Object.values(f).reduce(((e,t)=>{const n=t.plazasTotal||t.plazas||0,r=t.asignadas||t.plazasOcupadas||0;return e+Math.max(0,n-r)}),0);return console.log("Datos de plazas actualizados. Totales:",{totalCentros:Object.keys(f).length,totalPlazas:A,plazasAsignadas:N,plazasDisponibles:R}),console.log("Datos cargados correctamente:",{centros:C,asignaciones:I,pendientes:k,historial:S.length}),!0}catch(e){return console.error("Error al cargar datos desde Firebase:",e),console.error("Detalles del error:",e.code,e.message,e.stack),!1}},Ke=()=>{const e=(0,i.aQ)((0,i.rJ)(s.db,"centros"),(e=>{const n=new Set,r=new Map,a=[];e.forEach((e=>{const t=e.data(),n=t.nombre||t.centro||"Centro sin nombre",r=n.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g," ").trim();a.push({...t,docId:e.id,id:e.id,nombre:n,nombreNormalizado:r,esDuplicado:!1,duplicadoDe:null})}));for(let t=0;t<a.length;t++){const e=a[t];e.esDuplicado||(n.has(e.id)?e.esDuplicado=!0:r.has(e.nombreNormalizado)?(e.esDuplicado=!0,e.duplicadoDe=r.get(e.nombreNormalizado)):(n.add(e.id),r.set(e.nombreNormalizado,e.id)))}let i=a.filter((e=>!e.esDuplicado));i.length>366&&(i=[...i].sort(((e,t)=>(t.plazas||t.plazasTotal||0)-(e.plazas||e.plazasTotal||0))).slice(0,366)),i.length>0&&(t(i),console.log(`Listener: Actualizados ${i.length} centros filtrados`))})),n=(0,i.aQ)((0,i.rJ)(s.db,"asignaciones"),(e=>{const t=[];e.forEach((e=>{const n=e.data(),r={...n,docId:e.id,order:"number"===typeof n.order?n.order:Number(n.order)||0,centro:n.centro||"No disponible",localidad:n.localidad||"No disponible",municipio:n.municipio||"No disponible",timestamp:n.timestamp||Date.now(),estado:n.estado||"ASIGNADA"};t.push(r)})),t.sort(((e,t)=>(Number(e.order)||0)-(Number(t.order)||0))),a(t)})),r=(0,i.aQ)((0,i.rJ)(s.db,"solicitudesPendientes"),(e=>{const t=[];e.forEach((e=>{const n=e.data(),r={...n,docId:e.id,orden:"number"===typeof n.orden?n.orden:Number(n.orden)||0,centrosIds:n.centrosIds||n.centrosSeleccionados||[]};t.push(r)})),p(t)})),o=(0,i.aQ)((0,i.rJ)(s.db,"historialSolicitudes"),(e=>{const t=[];e.forEach((e=>{t.push({...e.data(),docId:e.id})})),m(t)}));return()=>{e(),n(),r(),o()}},qe=async()=>{try{E(!0),w("Cargando CSV autom\xe1ticamente...");try{const c="/asignacion-plazas/plazas.csv",l=await fetch(c);if(!l.ok)throw new Error(`Error al cargar el CSV: ${l.status} - ${l.statusText}`);const u=await l.text();if(!u||u.length<100)throw new Error("El archivo CSV est\xe1 vac\xedo o es demasiado peque\xf1o");const d=u.split("\n").map((e=>e.replace(/"/g,"").trim())).filter(Boolean);if(d.length<5)throw new Error("El archivo CSV no contiene suficientes l\xedneas de datos");let h=d.findIndex((e=>e.includes("A.S.I.;")));if(-1===h){const e=d.findIndex((e=>e.includes("ASI;")||e.includes("DEPARTAMENTO;")||e.includes("CODIGO;")));if(-1===e)throw new Error("No se encontr\xf3 una l\xednea de encabezado v\xe1lida en el CSV");h=e}if(d[h].split(";").length<5)throw new Error("El formato del encabezado no es v\xe1lido, faltan columnas necesarias");const f=new Set,p=new Set,g=[];let m=1,v=0,y=0,b=0;w("Analizando datos del CSV...");for(let i=h+1;i<d.length;i++){var e,t,n,r,a,o;const s=d[i].trim();if(!s)continue;if(s.includes("de 11")||s.includes("TOTAL ="))continue;const c=s.split(";");if(c.length<5){y++;continue}const l=(null===(e=c[0])||void 0===e?void 0:e.trim())||"",u=(null===(t=c[1])||void 0===t?void 0:t.trim())||"",h=(null===(n=c[2])||void 0===n?void 0:n.trim())||"",x=(null===(r=c[3])||void 0===r?void 0:r.trim())||"",E=(null===(a=c[4])||void 0===a?void 0:a.trim())||"";if(!h||h.length<2){console.warn(`L\xednea ${i+1}: C\xf3digo inv\xe1lido o ausente: "${h}"`),y++;continue}if(!x||x.length<2){console.warn(`L\xednea ${i+1}: Nombre de centro inv\xe1lido o ausente: "${x}"`),y++;continue}if(!E){console.warn(`L\xednea ${i+1}: Municipio ausente para centro: "${x}"`),y++;continue}const T=`${h}-${x}-${E}`.toLowerCase();if(f.has(T)){b++;continue}p.has(h)&&console.warn(`Posible duplicado con c\xf3digo ${h}: "${x}" en ${E}`),f.add(T),p.add(h);let S=1;if(c.length>5&&null!==(o=c[5])&&void 0!==o&&o.trim()){const e=c[5].trim(),t=parseInt(e);!isNaN(t)&&t>0?S=t:console.warn(`L\xednea ${i+1}: Valor de plazas inv\xe1lido: "${e}", usando 1 por defecto`)}else console.warn(`L\xednea ${i+1}: No se especific\xf3 n\xfamero de plazas para "${x}", usando 1 por defecto`);v+=S,g.push({id:m++,asi:l,departamento:u,codigo:h,centro:x,localidad:E,municipio:E,plazas:S,asignadas:0}),g.length%100===0&&w(`Procesando CSV: ${g.length} centros encontrados...`)}if(0===g.length)throw new Error("No se pudieron extraer centros v\xe1lidos del CSV");const x=7066;if(v!==x){const e=[...g].sort(((e,t)=>t.plazas-e.plazas)),t=v-x;if(Math.abs(t)>100&&console.warn(`Diferencia muy grande (${t} plazas) entre el total calculado y el objetivo`),t>0){let n=t,r=0;for(;n>0&&r<Math.min(5,e.length);){const a=e[r],i=Math.min(Math.ceil(t/5),a.plazas-1,n);i>0&&(a.plazas-=i,n-=i),r++}n>0&&(e[0].plazas-=n)}else if(t<0){let n=Math.abs(t),r=0;for(;n>0&&r<Math.min(5,e.length);){const a=e[r],i=Math.min(Math.ceil(Math.abs(t)/5),n);a.plazas+=i,n-=i,r++}n>0&&(e[0].plazas+=n)}const n=g.reduce(((e,t)=>e+t.plazas),0);if(n!==x)throw console.error(`Error en el ajuste: ${n} \u2260 ${x}`),new Error(`No se pudo ajustar el n\xfamero de plazas correctamente: ${n} \u2260 ${x}`)}w(`A\xf1adiendo ${g.length} centros a Firebase...`);let T=0;if((await(0,i.GG)((0,i.rJ)(s.db,"centros"))).size>0)return Ve("Se encontraron datos existentes. Usando datos actuales para evitar duplicaci\xf3n.","warning"),E(!1),await We();const S=100;for(let e=0;e<g.length;e+=S){const t=g.slice(e,e+S);w(`A\xf1adiendo centros: ${e}/${g.length}`);for(const e of t){const t=(0,i.H9)((0,i.rJ)(s.db,"centros"));await(0,i.BN)(t,{...e,docId:t.id}),T++}}return w("Datos cargados correctamente"),await We(),E(!1),Ve(`Se han cargado ${T} centros y exactamente ${x} plazas autom\xe1ticamente`,"success"),!0}catch(c){return console.error("Error al cargar CSV autom\xe1ticamente:",c),E(!1),!1}}catch(c){return console.error("Error al cargar CSV autom\xe1ticamente:",c),E(!1),!1}};(0,r.useEffect)((()=>{let e;return(async()=>{console.log("Inicializando aplicaci\xf3n...");try{console.log("Verificando si ya hay datos en Firebase...");const a=await(0,i.GG)((0,i.rJ)(s.db,"centros"));if(a.empty){console.log("No se encontraron centros. Intentando cargar desde CSV...");(await fetch("/asignacion-plazas/plazas.csv")).ok?(console.log("CSV encontrado, cargando datos autom\xe1ticamente..."),await He(),console.log("Datos cargados desde CSV inicial.")):console.warn("CSV no encontrado en ubicaci\xf3n predeterminada")}else console.log("Datos existentes encontrados:",a.size,"centros");const o=window.location.pathname.split("/"),c="admin"===o[o.length-1];if(z(c),le.current||ue.current)return;le.current=!0;try{if(c){O(!0),P("Cargando datos para el panel de administraci\xf3n..."),M(5);const e=await Ze();if(!e.success)return O(!0),void P(`Error de conexi\xf3n: ${e.message}. Intenta recargar la p\xe1gina.`);P("Cargando centros y solicitudes..."),M(30);try{await We(),console.log("Datos cargados correctamente para el panel de admin"),M(100),P("\xa1Datos cargados correctamente!"),setTimeout((()=>{O(!1)}),1e3)}catch(t){console.error("Error al cargar datos para el panel de admin:",t),P(`Error al cargar datos: ${t.message}`),setTimeout((()=>{O(!1)}),2e3)}return ue.current=!0,void(le.current=!1)}const a=!(await(0,i.GG)((0,i.rJ)(s.db,"solicitudesPendientes"))).empty;(a||c)&&(O(!0),P("Iniciando sistema y verificando conexi\xf3n..."),M(5));const o=await Ze();if(!o.success)return O(!0),void P(`Error de conexi\xf3n: ${o.message}. Intenta recargar la p\xe1gina.`);(a||c)&&(P("Verificando datos..."),M(10));const l=await(0,i.GG)((0,i.rJ)(s.db,"centros"));if(0===l.size){P("Cargando datos iniciales..."),M(20),await Ge("centros");await qe()||await He()}else P("Cargando datos existentes..."),M(30),await We();e=Ke(),P("Limpiando duplicados iniciales..."),M(50),console.log("Ejecutando limpieza inicial de duplicados");const u=await Xe();if(u.error)console.error("Error durante la limpieza inicial:",u.error);else{const e=u.eliminadosSolicitudes+u.eliminadosAsignaciones+u.eliminadosHistorial;console.log(`Limpieza inicial completada: ${e} elementos duplicados eliminados`)}P("Moviendo solicitudes hist\xf3ricas a pendientes..."),M(60);try{const e=await Je();e.error?console.error("Error en el volcado de historial:",e.error):e.volcados>0?(console.log(`Volcado inicial: ${e.volcados} solicitudes recuperadas del historial`),P(`Recuperadas ${e.volcados} solicitudes del historial`)):console.log("No hubo solicitudes para recuperar del historial")}catch(n){console.error("Error durante el volcado de historial:",n)}P("Procesando solicitudes pendientes..."),M(70);try{console.log("Procesando todas las solicitudes pendientes al inicio..."),await Ye();const e=(await(0,i.GG)((0,i.rJ)(s.db,"solicitudesPendientes"))).docs.length;M(100),e>0?(P(`Hay ${e} solicitudes pendientes por procesar.`),console.log(`Quedan ${e} solicitudes pendientes despu\xe9s del procesamiento inicial`)):(P("\xa1Sistema iniciado correctamente!"),setTimeout((()=>{O(!1),Ve("Sistema iniciado correctamente.","success")}),2e3))}catch(r){console.error("Error al procesar solicitudes iniciales:",r),P(`Error al procesar solicitudes: ${r.message}`),M(100),setTimeout((()=>{O(!1),Ve("Se produjo un error durante el procesamiento inicial: "+r.message,"error")}),2e3)}ue.current=!0}catch(t){console.error("Error durante la inicializaci\xf3n:",t),P(`Error: ${t.message}`),setTimeout((()=>{O(!1),Ve("Error durante la inicializaci\xf3n: "+t.message,"error")}),2e3)}finally{le.current=!1}}catch(t){console.error("Error durante la inicializaci\xf3n:",t),P(`Error: ${t.message}`),setTimeout((()=>{O(!1),Ve("Error durante la inicializaci\xf3n: "+t.message,"error")}),2e3)}})(),()=>{e&&e()}}),[]),(0,r.useEffect)((()=>{if(e.length>0){return(async()=>{f.length>0&&!v&&(await Ye(!0),k(45))})(),()=>{he.current&&clearInterval(he.current)}}}),[e.length]),(0,r.useEffect)((()=>(A||(fe.current=setInterval((()=>{k((e=>e<=1?(!v&&f.length>0&&!A&&Ye(!0),45):e-1))}),1e3)),()=>{fe.current&&clearInterval(fe.current)})),[v,f.length,A]);const Ye=async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{respetarAsignacionesExistentes:r=!0}=t;if(de.current)return console.log("Ya hay un procesamiento en curso. Espera a que termine."),!1;de.current=!0,w("Iniciando procesamiento de solicitudes...");try{const t=await(0,i.GG)((0,i.rJ)(s.db,"solicitudesPendientes"));if(t.empty)return console.log("No hay solicitudes pendientes para procesar."),w("No hay solicitudes pendientes para procesar."),setTimeout((()=>{w(""),de.current=!1}),3e3),!0;const u=t.docs.map((e=>({...e.data(),docId:e.id,centrosIds:e.data().centrosIds||e.data().centrosSeleccionados||[]}))).sort(((e,t)=>Number(e.orden)-Number(t.orden)));console.log(`Procesando ${u.length} solicitudes pendientes ordenadas por prioridad...`),w(`Procesando ${u.length} solicitudes pendientes...`);let d=n;r?(console.log("Modo ejecuci\xf3n autom\xe1tica: Se respetar\xe1n las asignaciones existentes"),d=[]):console.log("Modo ejecuci\xf3n manual: Se procesar\xe1n todas las asignaciones seg\xfan prioridad");const h=await(0,o.Kc)(u,d,e,w);if(h.error)console.error("Error al procesar solicitudes:",h.error),w(`Error: ${h.error}`);else{if(console.log("Procesamiento completado:",h.message),w(h.message),!r)try{const e=await et();e&&e.corregidos>0&&(console.log(`Corregidas ${e.corregidos} asignaciones con exceso`),w((t=>`${t} Corregidas ${e.corregidos} asignaciones con exceso.`)))}catch(a){console.error("Error en verificaci\xf3n de asignaciones:",a)}xe((new Date).toLocaleString());try{await We()}catch(c){console.error("Error al recargar datos:",c)}}try{const e=(await(0,i.GG)((0,i.rJ)(s.db,"solicitudesPendientes"))).docs.length;e>0?(console.log(`A\xfan quedan ${e} solicitudes pendientes por procesar`),w((t=>`${t} A\xfan quedan ${e} solicitudes pendientes.`)),e<5&&(console.log("Realizando un segundo intento autom\xe1tico para procesar solicitudes restantes..."),setTimeout((()=>{Ye({respetarAsignacionesExistentes:r})}),3e3))):R&&setTimeout((()=>{O(!1),Ve("Sistema iniciado correctamente","success")}),2e3)}catch(l){console.error("Error al verificar solicitudes pendientes:",l)}return!0}catch(u){return console.error("Error general al procesar solicitudes:",u),w(`Error al procesar solicitudes: ${u.message}`),!1}finally{setTimeout((()=>{de.current=!1}),3e3)}},Qe={container:{maxWidth:"1280px",margin:"0 auto",padding:"20px",backgroundColor:"#f8f9fa",minHeight:"calc(100vh - 120px)",fontFamily:"Arial, sans-serif",position:"relative"},header:{textAlign:"center",marginBottom:"30px",borderBottom:"1px solid #e7e7e7",paddingBottom:"15px"},title:{color:"#2c3e50",fontSize:"28px",margin:"0 0 10px 0"},subtitle:{color:"#7f8c8d",fontSize:"16px",fontWeight:"normal",margin:0},tabs:{display:"flex",gap:"2px",marginBottom:"20px",backgroundColor:"#e9ecef",borderRadius:"10px",padding:"3px",overflow:"hidden"},tab:{padding:"12px 20px",cursor:"pointer",flex:1,textAlign:"center",borderRadius:"8px",transition:"all 0.3s ease",fontSize:"15px",fontWeight:"500"},activeTab:{backgroundColor:"#fff",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",color:"#3498db"},inactiveTab:{backgroundColor:"transparent",color:"#7f8c8d"},sectionTitle:{fontSize:"20px",color:"#2c3e50",marginBottom:"15px",paddingBottom:"8px",borderBottom:"2px solid #e7e7e7"},cardContainer:{backgroundColor:"white",borderRadius:"10px",padding:"20px",boxShadow:"0 2px 10px rgba(0,0,0,0.05)",marginBottom:"20px"},popup:{position:"fixed",top:"20px",right:"20px",padding:"15px 20px",borderRadius:"10px",boxShadow:"0 3px 15px rgba(0,0,0,0.2)",zIndex:1e3,maxWidth:"350px",animation:"slideIn 0.3s ease"},processingButton:{padding:"12px 20px",backgroundImage:v?"linear-gradient(to right, #cccccc, #dddddd)":"linear-gradient(to right, #3498db, #2980b9)",color:"white",border:"none",borderRadius:"6px",cursor:v||0===f.length?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"15px",fontWeight:"500",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",margin:"10px auto"},reloadButton:{padding:"12px 20px",backgroundImage:x?"linear-gradient(to right, #cccccc, #dddddd)":"linear-gradient(to right, #e74c3c, #c0392b)",color:"white",border:"none",borderRadius:"6px",cursor:x?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"15px",fontWeight:"500",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",margin:"10px auto"},adminPanel:{display:"flex",justifyContent:"center",alignItems:"center",marginBottom:"20px"},adminButton:{padding:"12px 20px",backgroundImage:"linear-gradient(to right, #3498db, #2980b9)",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"15px",fontWeight:"500",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",margin:"10px auto"}};(0,r.useEffect)((()=>{const e=()=>{const e=Date.now(),t=pe.current;(0===t||e-t>36e5)&&$e()};n.length>10&&e();const t=setInterval((()=>{e()}),9e5);return()=>clearInterval(t)}),[n.length]);const Xe=async()=>{try{console.log("Ejecutando eliminaci\xf3n de solicitudes y asignaciones duplicadas...");const e=await(0,i.GG)((0,i.rJ)(s.db,"solicitudesPendientes")),t={},n=e.docs.length;e.docs.forEach((e=>{const n={...e.data(),docId:e.id},r=n.orden;r&&(t[r]?t[r].push(n):t[r]=[n])}));let r=0;Object.keys(t).forEach((e=>{const n=t[e];n.length>1&&(r+=n.length-1)}));const a=await(0,i.GG)((0,i.rJ)(s.db,"asignaciones")),o={},c=a.docs.length;a.docs.forEach((e=>{const t={...e.data(),docId:e.id},n=t.order;n&&(o[n]?o[n].push(t):o[n]=[t])}));let l=0;Object.keys(o).forEach((e=>{const t=o[e];t.length>1&&(l+=t.length-1)}));const u=await(0,i.GG)((0,i.rJ)(s.db,"historialSolicitudes")),d={};u.docs.forEach((e=>{const t={...e.data(),docId:e.id},n=t.orden,r=t.estado||"DESCONOCIDO";if(!n)return;const a=`${n}-${r}`;d[a]?d[a].push(t):d[a]=[t]}));let h=0;if(Object.keys(d).forEach((e=>{const t=d[e];t.length>1&&(h+=t.length-1)})),0===r&&0===l&&0===h)return console.log("No se encontraron elementos duplicados"),{eliminadosSolicitudes:0,eliminadosAsignaciones:0,eliminadosHistorial:0,totalSolicitudes:n,totalAsignaciones:c};console.log(`Se encontraron ${r} solicitudes duplicadas, ${l} asignaciones duplicadas y ${h} entradas duplicadas en historial`);const f=(0,i.wP)(s.db);let p=0,g=0,m=0;for(const v in t){const e=t[v];if(e.length>1){e.sort(((e,t)=>{const n=e.timestamp||0;return(t.timestamp||0)-n}));const t=e.slice(1);for(const e of t)f.delete((0,i.H9)(s.db,"solicitudesPendientes",e.docId)),p++}}for(const v in o){const e=o[v];if(e.length>1){e.sort(((e,t)=>{const n=e.timestamp||0;return(t.timestamp||0)-n}));const t=e.slice(1);for(const e of t)f.delete((0,i.H9)(s.db,"asignaciones",e.docId)),g++}}for(const v in d){const e=d[v];if(e.length>1){e.sort(((e,t)=>{const n=e.timestamp||0;return(t.timestamp||0)-n}));const t=e.slice(1);for(const e of t)f.delete((0,i.H9)(s.db,"historialSolicitudes",e.docId)),m++}}return(p>0||g>0||m>0)&&await f.commit(),console.log(`Se eliminaron ${p} solicitudes duplicadas, ${g} asignaciones duplicadas y ${m} entradas duplicadas en historial`),{eliminadosSolicitudes:p,eliminadosAsignaciones:g,eliminadosHistorial:m,totalSolicitudes:n,totalAsignaciones:c}}catch(e){return console.error("Error al eliminar duplicados:",e),{error:e.message,eliminadosSolicitudes:0,eliminadosAsignaciones:0,eliminadosHistorial:0}}};(0,r.useEffect)((()=>{if(ge.current)return void console.log("Verificaci\xf3n ya programada, ignorando programaci\xf3n duplicada");ge.current=!0;const e=()=>{const t=new Date,n=new Date;n.setHours(2,0,0,0),t.getHours()>=2&&n.setDate(n.getDate()+1);const r=n.getTime()-t.getTime();console.log(`Verificaci\xf3n diaria programada para ejecutarse en ${Math.floor(r/36e5)} horas y ${Math.floor(r%36e5/6e4)} minutos (2:00 AM)`);const a=setTimeout((()=>{console.log("Comprobando si se debe ejecutar la verificaci\xf3n diaria (2:00 AM)"),(()=>{const e=localStorage.getItem("ultimaVerificacionDiaria");if(e){const t=new Date(Number(e)),n=new Date;if(t.getDate()===n.getDate()&&t.getMonth()===n.getMonth()&&t.getFullYear()===n.getFullYear())return console.log(`La verificaci\xf3n diaria ya se ejecut\xf3 hoy a las ${t.toLocaleTimeString()}`),!0}return!1})()?(console.log("Saltando verificaci\xf3n, ya se ejecut\xf3 hoy"),e()):(console.log("Iniciando verificaci\xf3n diaria programada (2:00 AM)"),Ye({respetarAsignacionesExistentes:!0}).then((()=>{localStorage.setItem("ultimaVerificacionDiaria",Date.now().toString()),console.log("Verificaci\xf3n diaria completada y marcada como ejecutada hoy"),e()})))}),r);return a},t=e();return()=>{clearTimeout(t),ge.current=!1}}),[]),(0,r.useEffect)((()=>{(async()=>{console.log("Iniciando limpieza inicial de duplicados...");if(!K&&!v){await Xe();"true"!==localStorage.getItem("historialLimpiado")&&(console.log("Ejecutando limpieza de duplicados en historial..."),await tt())}})()}),[K,v]);const Je=async()=>{try{console.log("Volcando datos de historial a solicitudes pendientes...");const e=await(0,i.GG)((0,i.rJ)(s.db,"historialSolicitudes"));if(e.empty)return console.log("No hay entradas en el historial para procesar"),{volcados:0};const t=e.docs.map((e=>({...e.data(),docId:e.id})));console.log(`Se encontraron ${t.length} entradas en el historial`);const n=t.slice(0,5);console.log("Ejemplos de entradas en historial:",n);const r={};t.forEach((e=>{const t=e.estado||"SIN_ESTADO";r[t]=(r[t]||0)+1})),console.log("Conteo de estados en historial:",r);const a=t.filter((e=>e.centrosIds&&e.centrosIds.length>0)).length;console.log(`Entradas con centrosIds v\xe1lidos: ${a} de ${t.length}`);const o=await(0,i.GG)((0,i.rJ)(s.db,"solicitudesPendientes")),c=new Set;o.docs.forEach((e=>{const t=e.data();t.orden&&c.add(t.orden)}));(await(0,i.GG)((0,i.rJ)(s.db,"asignaciones"))).docs.forEach((e=>{const t=e.data();t.order&&c.add(t.order)})),console.log(`Se encontraron ${c.size} \xf3rdenes ya existentes`);const l=t.filter((e=>!!e.orden&&(!c.has(e.orden)&&(e.centrosIds&&e.centrosIds.length||!e.centroId?e.centrosIds&&e.centrosIds.length>0:(e.centrosIds=[e.centroId],!0)))));if(console.log(`Se volcar\xe1n ${l.length} entradas del historial`),0===l.length)return{volcados:0};console.log("Ejemplos de entradas a volcar:",l.slice(0,3));const u=100;let d=0;for(let h=0;h<l.length;h+=u){const e=(0,i.wP)(s.db),t=l.slice(h,h+u);for(const n of t){const t={orden:n.orden,centrosIds:n.centrosIds||[n.centroId],timestamp:Date.now(),intentosFallidos:0},r={};if(Object.entries(t).forEach((e=>{let[t,a]=e;void 0!==a?r[t]=a:"centrosIds"===t&&(n.centroId?r.centrosIds=[n.centroId]:console.warn(`No se pudo recuperar centrosIds para orden ${n.orden}`))})),r.orden&&r.centrosIds){const t=(0,i.H9)((0,i.rJ)(s.db,"solicitudesPendientes"));e.set(t,r),d++}}await e.commit(),console.log(`Procesado lote ${h/u+1} (${t.length} entradas)`)}return console.log(`Se volcaron ${d} entradas del historial a solicitudes pendientes`),{volcados:d}}catch(e){return console.error("Error al volcar datos del historial:",e),{error:e.message,volcados:0}}},Ze=async()=>{try{await(0,i.GG)((0,i.P)((0,i.rJ)(s.db,"centros"),(0,i.AB)(1)));return console.log("Conexi\xf3n con Firebase verificada correctamente."),{success:!0,message:"Conexi\xf3n establecida correctamente."}}catch(e){return console.error("Error de conexi\xf3n con Firebase:",e),Ve("Error de conexi\xf3n con la base de datos. Por favor, verifica tu conexi\xf3n a internet.","error"),{success:!1,error:e,message:e.message}}};(0,r.useEffect)((()=>{let e;return(async()=>{if(!le.current&&!ue.current){le.current=!0;try{O(!0),P("Iniciando sistema y verificando conexi\xf3n..."),M(5);const r=await Ze();if(!r.success)return void P(`Error de conexi\xf3n: ${r.message}. Intenta recargar la p\xe1gina.`);P("Verificando datos..."),M(10);const a=await(0,i.GG)((0,i.rJ)(s.db,"centros"));if(0===a.size){P("Cargando datos iniciales..."),M(20),await Ge("centros");await qe()||await He()}else P("Cargando datos existentes..."),M(30),await We();e=Ke(),P("Limpiando duplicados iniciales..."),M(50),console.log("Ejecutando limpieza inicial de duplicados");const o=await Xe();if(o.error)console.error("Error durante la limpieza inicial:",o.error);else{const e=o.eliminadosSolicitudes+o.eliminadosAsignaciones+o.eliminadosHistorial;console.log(`Limpieza inicial completada: ${e} elementos duplicados eliminados`)}P("Moviendo solicitudes hist\xf3ricas a pendientes..."),M(60);try{const e=await Je();e.error?console.error("Error en el volcado de historial:",e.error):e.volcados>0?(console.log(`Volcado inicial: ${e.volcados} solicitudes recuperadas del historial`),P(`Recuperadas ${e.volcados} solicitudes del historial`)):console.log("No hubo solicitudes para recuperar del historial")}catch(t){console.error("Error durante el volcado de historial:",t)}P("Procesando solicitudes pendientes..."),M(70);try{console.log("Procesando todas las solicitudes pendientes al inicio..."),await Ye();const e=(await(0,i.GG)((0,i.rJ)(s.db,"solicitudesPendientes"))).docs.length;M(100),e>0?(P(`Hay ${e} solicitudes pendientes por procesar.`),console.log(`Quedan ${e} solicitudes pendientes despu\xe9s del procesamiento inicial`)):(P("\xa1Sistema iniciado correctamente!"),setTimeout((()=>{O(!1),Ve("Sistema iniciado correctamente.","success")}),2e3))}catch(n){console.error("Error al procesar solicitudes iniciales:",n),P(`Error al procesar solicitudes: ${n.message}`),M(100),setTimeout((()=>{O(!1),Ve("Se produjo un error durante el procesamiento inicial: "+n.message,"error")}),2e3)}ue.current=!0}catch(r){console.error("Error durante la inicializaci\xf3n:",r),P(`Error: ${r.message}`),setTimeout((()=>{O(!1),Ve("Error durante la inicializaci\xf3n: "+r.message,"error")}),2e3)}finally{le.current=!1}}})(),()=>{e&&e()}}),[]);const et=async()=>{try{if((()=>{try{const e=localStorage.getItem("ultimaVerificacionAsignaciones");if(e){const t=new Date(e),n=new Date;if(t.toDateString()===n.toDateString())return!0}return!1}catch(e){return console.error("Error al verificar ejecuci\xf3n previa:",e),!1}})())return void console.log("La verificaci\xf3n de asignaciones ya se ejecut\xf3 hoy.");P("Verificando y corrigiendo asignaciones existentes..."),M(10),O(!0),await new Promise((e=>setTimeout(e,1e3)));try{if(P("Cargando datos actuales..."),M(20),await We(),0===e.length){P("No hay centros disponibles. Cargando desde CSV..."),M(30);if(!(await fetch("/asignacion-plazas/plazas.csv")).ok)throw new Error("No se encontr\xf3 el archivo CSV de centros");await He()}if(!e||!Array.isArray(e))return console.error("Error: availablePlazas debe ser un array",e),P("Error: No hay datos de centros disponibles"),await new Promise((e=>setTimeout(e,2e3))),O(!1),void Ve("Error: No hay datos de centros disponibles","error");M(40),P("Comprobando excesos de asignaciones en centros..."),await new Promise((e=>setTimeout(e,500)));const t=e.filter((e=>e.asignadas>e.plazas));if(0===t.length)return M(100),P("No se encontraron centros con exceso de asignaciones. Todo est\xe1 correcto."),await new Promise((e=>setTimeout(e,2e3))),O(!1),Ve("Verificaci\xf3n completada: No hay centros con exceso de asignaciones","success"),localStorage.setItem("ultimaVerificacionDiaria",Date.now().toString()),{success:!0,message:"No hay centros con exceso",corregidos:0};M(60),P(`Encontrados ${t.length} centros con exceso de asignaciones. Comenzando reasignaci\xf3n...`),await new Promise((e=>setTimeout(e,1e3)));const r=await(0,o.El)(e,n,s.db);return M(90),P(r.success?`${r.message}. Actualizando interfaz...`:`Error durante la verificaci\xf3n: ${r.message}`),await We(),M(100),P(r.success?`Verificaci\xf3n completada exitosamente. Se corrigieron ${r.corregidos} asignaciones (${r.reasignados} reasignadas).`:`Error durante la verificaci\xf3n: ${r.message}`),await new Promise((e=>setTimeout(e,2e3))),O(!1),r.success?(Ve(r.message,"success"),localStorage.setItem("ultimaVerificacionDiaria",Date.now().toString())):Ve(r.message||"Error al verificar asignaciones","error"),r}catch(t){console.error("Error al verificar asignaciones:",t),P(`Error al verificar asignaciones: ${t.message}`),await new Promise((e=>setTimeout(e,2e3))),O(!1),Ve("Error al verificar asignaciones: "+t.message,"error")}}catch(t){console.error("Error al verificar asignaciones:",t),P(`Error al verificar asignaciones: ${t.message}`),await new Promise((e=>setTimeout(e,2e3))),O(!1),Ve("Error al verificar asignaciones: "+t.message,"error")}},tt=async()=>{try{if("true"===localStorage.getItem("historialLimpiado"))return console.log("La limpieza del historial ya se ha realizado con \xe9xito anteriormente"),{success:!0,eliminados:0,yaRealizado:!0};w&&w("Limpiando duplicados en historial de solicitudes...");const e=[];if((await(0,i.GG)((0,i.P)((0,i.rJ)(s.db,"historialSolicitudes"),(0,i.AB)(1e4)))).forEach((t=>{e.push({...t.data(),docId:t.id})})),0===e.length)return Ve("No hay entradas en el historial de solicitudes","info"),{success:!0,eliminados:0};console.log(`Procesando ${e.length} documentos del historial`);const t={};e.forEach((e=>{const n=e.orden;if(!n)return;let r="desconocida";if(e.timestamp){const t=new Date(e.timestamp);r=`${t.getFullYear()}-${t.getMonth()+1}-${t.getDate()}`}else e.fechaHistorico&&(r=e.fechaHistorico.split("T")[0]);const a=`${n}-${e.estado||"DESCONOCIDO"}-${e.centroId||e.centroAsignado||"sin-centro"}-${r}`;t[a]?t[a].push(e):t[a]=[e]}));let n=0;if(Object.values(t).forEach((e=>{e.length>1&&(n+=e.length-1)})),0===n)return Ve("No se encontraron entradas duplicadas en el historial","success"),localStorage.setItem("historialLimpiado","true"),{success:!0,eliminados:0};console.log(`Se encontraron ${n} entradas duplicadas para eliminar`);const r=450;let a=0,o=0,c=[];for(const i in t){const e=t[i];e.length>1&&(e.sort(((e,t)=>{const n=e.timestamp||0;return(t.timestamp||0)-n})),c.push(...e.slice(1)))}for(let l=0;l<c.length;l+=r){const e=(0,i.wP)(s.db),t=c.slice(l,l+r);for(const n of t)n.docId&&(e.delete((0,i.H9)(s.db,"historialSolicitudes",n.docId)),a++);await e.commit(),o+=t.length,console.log(`Procesado lote ${Math.floor(l/r)+1}: ${t.length} elementos (total ${o}/${c.length})`),await new Promise((e=>setTimeout(e,1e3))),w&&w(`Limpiando duplicados: ${o}/${c.length} (${Math.round(o/c.length*100)}%)`)}return a>0&&(console.log(`Se eliminaron ${a} entradas duplicadas del historial`),Ve(`Se han eliminado ${a} entradas duplicadas del historial`,"success"),localStorage.setItem("historialLimpiado","true")),await We(),{success:!0,eliminados:a}}catch(e){return console.error("Error al limpiar duplicados del historial:",e),Ve(`Error al limpiar duplicados: ${e.message}`,"error"),{success:!1,error:e.message}}finally{w&&w("")}};(0,r.useEffect)((()=>{const e=()=>{const e=Date.now(),t=pe.current;(0===t||e-t>36e5)&&$e()};n.length>10&&e();const t=setInterval((()=>{e()}),9e5);return()=>clearInterval(t)}),[n.length]);const nt=async()=>{if(de.current)return console.log("Ya hay un procesamiento en curso. Se omite la verificaci\xf3n por minuto."),!1;try{const t=await(0,i.GG)((0,i.rJ)(s.db,"solicitudesPendientes"));if(t.empty)return console.log("No hay solicitudes pendientes para procesar en la verificaci\xf3n por minuto."),!0;const n=t.docs.map((e=>({...e.data(),docId:e.id,centrosIds:e.data().centrosIds||e.data().centrosSeleccionados||[]})));console.log(`Verificaci\xf3n por minuto: Procesando ${n.length} solicitudes pendientes...`);const r=n.sort(((e,t)=>Number(e.orden)-Number(t.orden))),a=(await(0,i.GG)((0,i.rJ)(s.db,"asignaciones"))).docs.map((e=>({...e.data(),docId:e.id}))),o={};a.forEach((e=>{e.centerId&&(o[e.centerId]||(o[e.centerId]=[]),o[e.centerId].push(e))}));const c=new Map;a.forEach((e=>{e.order&&c.set(e.order,e)}));let l=0,u=0;const d=(0,i.wP)(s.db);for(const h of r){const t=Number(h.orden);if(c.has(t)){console.log(`La orden ${t} ya tiene una asignaci\xf3n.`),d.delete((0,i.H9)(s.db,"solicitudesPendientes",h.docId));continue}let n=null,r=null;for(const i of h.centrosIds){const a=e.find((e=>e.id===i));if(a){if(a.asignadas<a.plazas){n=i;break}{const e=(o[i]||[]).reduce(((e,t)=>{const n=Number(e.order||0);return Number(t.order||0)>n?t:e}),{order:0});if(e.order&&Number(e.order)>t){n=i,r=e;break}}}}if(!n){console.log(`No se encontr\xf3 plaza disponible para la orden ${t}.`);continue}const a=e.find((e=>e.id===n));if(r){console.log(`Desplazando asignaci\xf3n de orden ${r.order} para asignar orden ${t} en centro ${n}`),d.delete((0,i.H9)(s.db,"asignaciones",r.docId));const e={orden:r.order,centrosIds:[r.centerId],timestamp:(0,i.O5)(),desplazada:!0,desplazadaPor:t},a=(0,i.H9)((0,i.rJ)(s.db,"solicitudesPendientes"));d.set(a,e);const o=(0,i.H9)((0,i.rJ)(s.db,"historialSolicitudes"));d.set(o,{orden:r.order,centroAnterior:r.centerId,centroId:null,estado:"DESPLAZADA",mensaje:`Desplazada por orden ${t} de mayor prioridad`,fechaHistorico:(new Date).toISOString(),timestamp:Date.now()}),u++}const f={order:t,centerId:n,centerName:a?a.nombre:"Centro Desconocido",timestamp:(0,i.O5)()},p=(0,i.H9)((0,i.rJ)(s.db,"asignaciones"));d.set(p,f),d.delete((0,i.H9)(s.db,"solicitudesPendientes",h.docId));const g=(0,i.H9)((0,i.rJ)(s.db,"historialSolicitudes"));d.set(g,{orden:t,centroId:n,estado:r?"PRIORIZADA":"ASIGNADA",mensaje:r?`Asignada con prioridad, desplazando orden ${r.order}`:"Asignada durante procesamiento regular",fechaHistorico:(new Date).toISOString(),timestamp:Date.now()}),l++}return 0===l&&0===u?(console.log("Verificaci\xf3n por minuto: No se realizaron cambios en las asignaciones."),!0):(await d.commit(),console.log(`Verificaci\xf3n por minuto completada: ${l} nuevas asignaciones, ${u} reasignaciones por prioridad.`),(l>0||u>0)&&(await We(),xe((new Date).toLocaleString()),l+u>0&&Ve(`Procesamiento autom\xe1tico: ${l} nuevas asignaciones, ${u} reasignaciones por prioridad.`,"success")),!0)}catch(t){return console.error("Error en procesamiento por minuto:",t),!1}};return(0,r.useEffect)((()=>{console.log("Configurando verificaci\xf3n de solicitudes cada minuto...");const e=setTimeout((()=>{nt()}),3e4),t=setInterval((()=>{nt()}),6e4);return()=>{clearTimeout(e),clearInterval(t)}}),[]),F?(0,c.jsx)(Gc,{assignments:n,availablePlazas:e,solicitudes:f,procesarTodasLasSolicitudes:Ye,procesarSolicitudesPorMinuto:nt,cargarDatosDesdeFirebase:We,eliminarSolicitudesDuplicadas:Xe,limpiarDuplicadosHistorial:tt,db:s.db,loadingProcess:v,processingMessage:b,showNotification:Ve,lastProcessed:T,procesarSolicitudes:o.Kc}):(0,c.jsxs)("div",{className:"App",style:Qe.container,children:[Ee&&(0,c.jsx)("div",{className:"modal-backdrop",children:(0,c.jsxs)("div",{className:"modal-content password-modal",children:[(0,c.jsx)("h3",{children:"Verificaci\xf3n de Administrador"}),(0,c.jsx)("p",{children:"Ingrese la contrase\xf1a para ejecutar la verificaci\xf3n"}),(0,c.jsxs)("form",{onSubmit:e=>{e.preventDefault(),"SoyAdmin"===Se?(Te(!1),Ie(""),Ce(!1),Ye({respetarAsignacionesExistentes:!1})):(Ce(!0),setTimeout((()=>Ce(!1)),3e3))},children:[(0,c.jsx)("input",{type:"password",value:Se,onChange:e=>Ie(e.target.value),placeholder:"Contrase\xf1a"}),ke&&(0,c.jsx)("p",{className:"error-message",children:ke}),(0,c.jsxs)("div",{className:"modal-actions",children:[(0,c.jsx)("button",{type:"button",className:"modal-button cancel",onClick:()=>{Te(!1),Ie(""),Ce("")},children:"Cancelar"}),(0,c.jsx)("button",{type:"submit",className:"modal-button",children:"Verificar"})]})]})]})}),R&&(0,c.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"#0a192f",zIndex:9999,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",color:"white",padding:"20px"},children:(0,c.jsxs)("div",{style:{backgroundColor:"rgba(255, 255, 255, 0.1)",borderRadius:"16px",padding:"40px",maxWidth:"500px",width:"90%",textAlign:"center",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.2)",backdropFilter:"blur(8px)"},children:[(0,c.jsx)("div",{style:{fontSize:"28px",fontWeight:"bold",marginBottom:"20px",color:"#64ffda"},children:"SISTEMA EN MANTENIMIENTO"}),(0,c.jsx)("div",{style:{fontSize:"18px",lineHeight:"1.6",marginBottom:"10px"},children:D||"Estamos verificando y actualizando las asignaciones..."}),(0,c.jsxs)("div",{style:{fontSize:"16px",marginBottom:"20px"},children:["Solicitudes pendientes: ",f.length]}),(0,c.jsx)("div",{style:{width:"100%",height:"8px",backgroundColor:"rgba(255, 255, 255, 0.1)",borderRadius:"4px",marginBottom:"10px",overflow:"hidden"},children:(0,c.jsx)("div",{style:{height:"100%",width:`${L}%`,backgroundColor:"#64ffda",borderRadius:"4px",transition:"width 0.5s ease"}})}),(0,c.jsxs)("div",{style:{fontSize:"14px",color:"#8892b0"},children:[L,"% completado"]}),(0,c.jsx)("div",{style:{marginTop:"30px",fontSize:"14px",color:"#8892b0",fontStyle:"italic"},children:"Por favor espere. El sistema volver\xe1 a estar disponible autom\xe1ticamente."})]})}),(0,c.jsxs)("div",{style:Qe.header,children:[(0,c.jsx)("h1",{style:Qe.title,children:"Sistema de Asignaci\xf3n de Plazas"}),(()=>{const e=localStorage.getItem("ultimaVerificacionDiaria");if(!e)return!0;const t=new Date(Number(e)),n=new Date;return!(t.getDate()===n.getDate()&&t.getMonth()===n.getMonth()&&t.getFullYear()===n.getFullYear())})()&&(0,c.jsx)("div",{style:{position:"absolute",top:"20px",right:"20px",zIndex:50},children:(0,c.jsx)("button",{onClick:()=>Te(!0),style:{padding:"12px 20px",backgroundColor:"#3498db",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"15px",fontWeight:"500",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:"\ud83d\udd04 Verificar Asignaciones Hoy"})}),(0,c.jsxs)("div",{style:Qe.tabs,children:[(0,c.jsx)("div",{style:{...Qe.tab,..."asignaciones"===oe?Qe.activeTab:Qe.inactiveTab},onClick:()=>ce("asignaciones"),children:"\ud83d\udccb Historial de Asignaciones"}),(0,c.jsx)("div",{style:{...Qe.tab,..."solicitudes"===oe?Qe.activeTab:Qe.inactiveTab},onClick:()=>ce("solicitudes"),children:"\ud83d\udd0d Solicitudes Pendientes"}),(0,c.jsx)("div",{style:{...Qe.tab,..."plazas"===oe?Qe.activeTab:Qe.inactiveTab},onClick:()=>ce("plazas"),children:"\ud83c\udfe2 Plazas Disponibles"})]})]}),(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px",fontSize:"14px",color:"#666",padding:"8px 12px",backgroundColor:"#f0f8ff",borderRadius:"6px"},children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("span",{style:{fontWeight:"bold",marginRight:"5px"},children:"Plazas disponibles:"}),7066-n.length," de 7066"," "]}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",flexWrap:"wrap"},children:[f.length>0&&(0,c.jsx)("span",{style:{marginRight:"10px",color:v?"#e74c3c":"#2ecc71"},children:v?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("span",{style:{display:"inline-block",width:"12px",height:"12px",border:"2px solid rgba(231,76,60,0.3)",borderRadius:"50%",borderTopColor:"#e74c3c",animation:"spin 1s linear infinite",marginRight:"5px",verticalAlign:"middle"}}),"Procesando ",f.length," solicitudes..."]}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("span",{style:{color:"#2ecc71",marginRight:"5px"},children:"\u25cf"}),f.length," solicitudes pendientes"]})}),(0,c.jsx)("span",{style:{fontWeight:"bold",marginRight:"5px"},children:"\xdaltima actualizaci\xf3n:"}),T&&"function"===typeof T.getTime?(()=>{const e=T.getHours(),t=T.getMinutes();return 2===e&&0===t?"Actualizado":new Intl.DateTimeFormat("es-ES",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).format(T)})():"No disponible"]})]}),"asignaciones"===oe&&(0,c.jsxs)("div",{style:Qe.cardContainer,children:[(0,c.jsx)("h3",{style:Qe.sectionTitle,children:"Historial de Asignaciones"}),(0,c.jsx)(l,{assignments:n,availablePlazas:e})]}),"solicitudes"===oe&&(0,c.jsxs)("div",{style:Qe.cardContainer,children:[(0,c.jsx)("h3",{style:Qe.sectionTitle,children:"Solicitudes Pendientes"}),(0,c.jsx)(d,{solicitudes:f||[],assignments:n||[],availablePlazas:e||[]})]}),"plazas"===oe&&(0,c.jsxs)("div",{style:Qe.cardContainer,children:[(0,c.jsx)("h3",{style:Qe.sectionTitle,children:"Plazas Disponibles"}),e.length>0?(0,c.jsx)(u,{availablePlazas:e,assignments:n,searchTerm:X,setSearchTerm:J,orderNumber:$,setOrderNumber:H,centrosSeleccionados:G,setCentrosSeleccionados:W,handleOrderSubmit:async(e,t)=>{if(console.log(`Iniciando env\xedo de solicitud para orden ${e}`),void 0===e||null===e||""===e)return console.error("Error en enviarSolicitud: orderNumber es null, undefined o vac\xedo"),Ve("Error: N\xfamero de orden inv\xe1lido","error"),!1;if(!t||!Array.isArray(t)||0===t.length)return console.error("Error en enviarSolicitud: No hay centros seleccionados",t),Ve("Error: Debe seleccionar al menos un centro","error"),!1;const n=Number(e);if(isNaN(n))return console.error("Error en enviarSolicitud: orderNumber no es un n\xfamero v\xe1lido",e),Ve("Error: N\xfamero de orden inv\xe1lido","error"),!1;console.log(`Procesando solicitud para orden ${n} con centros:`,t);try{const e=await Ze();if(!e||!e.success)return console.error("Error de conexi\xf3n con Firebase:",(null===e||void 0===e?void 0:e.error)||"Sin detalles adicionales"),Ve("Error de conexi\xf3n con la base de datos. Por favor, verifica tu conexi\xf3n a internet.","error"),!1;try{if(!(await(0,i.GG)((0,i.P)((0,i.rJ)(s.db,"asignaciones"),(0,i._M)("order","==",n)))).empty)return console.log(`Ya existe una asignaci\xf3n para la orden ${n}`),Ve(`La orden ${n} ya tiene una asignaci\xf3n en el sistema.`,"error"),!1}catch(r){return console.error("Error al verificar asignaciones existentes:",r),Ve("Error al verificar asignaciones existentes. Intente nuevamente.","error"),!1}let a=null;try{const e=await(0,i.GG)((0,i.P)((0,i.rJ)(s.db,"solicitudesPendientes"),(0,i._M)("orden","==",n)));e.empty||(a=e.docs[0].id,console.log(`Encontrada solicitud existente con ID ${a} para orden ${n}`))}catch(r){return console.error("Error al verificar solicitudes pendientes existentes:",r),Ve("Error al verificar solicitudes pendientes. Intente nuevamente.","error"),!1}try{if(a)await(0,i.mZ)((0,i.H9)(s.db,"solicitudesPendientes",a),{centrosSeleccionados:t,timestamp:(0,i.O5)()}),console.log(`Actualizada solicitud existente ${a} para orden ${n}`);else{const e={orden:n,centrosIds:t,timestamp:(0,i.O5)()};await(0,i.BN)((0,i.H9)((0,i.rJ)(s.db,"solicitudesPendientes")),e),console.log(`Creada nueva solicitud para orden ${n}`)}console.log(`Solicitud para orden ${n} enviada correctamente`),Ve(`Solicitud para orden ${n} enviada correctamente. Ser\xe1 procesada autom\xe1ticamente.`,"success"),await We();const e=new Date,r=(0,i.H9)((0,i.rJ)(s.db,"historialSolicitudes"));return await(0,i.BN)(r,{orden:n,centrosIds:t,estado:"PENDIENTE",mensaje:"Solicitud a\xf1adida a la cola de procesamiento",fechaHistorico:e.toISOString(),timestamp:e.getTime()}),H(""),W([]),ce("solicitudes"),!0}catch(r){return console.error("Error al guardar solicitud:",r),Ve(`Error al procesar la solicitud: ${r.message}`,"error"),!1}}catch(r){return console.error(`Error al enviar solicitud para orden ${n}:`,r),Ve(`Error al enviar solicitud: ${r.message}`,"error"),!1}},isProcessing:K}):(0,c.jsxs)("div",{style:{textAlign:"center",padding:"40px 20px",backgroundColor:"#f5f7fa",borderRadius:"8px",color:"#5c6c7c"},children:[(0,c.jsx)("div",{style:{fontSize:"36px",marginBottom:"15px"},children:"\ud83c\udfe2"}),(0,c.jsx)("div",{style:{fontSize:"18px",fontWeight:"bold",marginBottom:"10px"},children:"Cargando plazas..."}),(0,c.jsx)("div",{style:{fontSize:"14px",marginBottom:"20px"},children:"Por favor espera mientras se cargan los datos de los centros."}),(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"10px"},children:[(0,c.jsx)("div",{style:{width:"20px",height:"20px",border:"3px solid rgba(0,0,0,0.1)",borderRadius:"50%",borderTopColor:"#3498db",animation:"spin 1s linear infinite"}}),(0,c.jsx)("div",{children:"Cargando datos..."})]})]})]}),(0,c.jsx)(h,{}),te&&(0,c.jsx)("div",{style:{...Qe.popup,backgroundColor:"success"===ie?"#d4edda":"warning"===ie?"#fff3cd":"#f8d7da",color:"success"===ie?"#155724":"warning"===ie?"#856404":"#721c24"},children:(0,c.jsxs)("div",{style:{display:"flex",alignItems:"flex-start"},children:[(0,c.jsx)("div",{style:{flex:1},children:re}),(0,c.jsx)("button",{onClick:()=>ne(!1),style:{background:"none",border:"none",cursor:"pointer",fontSize:"18px",marginLeft:"10px",color:"inherit"},children:"\xd7"})]})}),(v||x)&&(0,c.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:999},children:(0,c.jsxs)("div",{style:{backgroundColor:"white",padding:"20px",borderRadius:"10px",boxShadow:"0 0 20px rgba(0,0,0,0.2)",maxWidth:"500px",width:"90%",textAlign:"center"},children:[(0,c.jsx)("div",{style:{marginBottom:"15px",fontSize:"18px"},children:x?"Cargando datos...":"Procesando solicitudes..."}),(0,c.jsx)("div",{children:b}),(0,c.jsx)("div",{style:{width:"100%",height:"4px",backgroundColor:"#f1f1f1",borderRadius:"2px",marginTop:"15px",overflow:"hidden",position:"relative"},children:(0,c.jsx)("div",{style:{position:"absolute",top:0,left:0,height:"100%",width:"30%",backgroundColor:"#3498db",borderRadius:"2px",animation:"loading 1.5s infinite ease-in-out"}})})]})}),(0,c.jsx)("style",{children:"\n        @keyframes slideIn {\n          0% { transform: translateX(100%); opacity: 0; }\n          100% { transform: translateX(0); opacity: 1; }\n        }\n        @keyframes loading {\n          0% { left: -30%; }\n          100% { left: 100%; }\n        }\n        @keyframes spin {\n          0% { transform: rotate(0deg); }\n          100% { transform: rotate(360deg); }\n        }\n      "})]})},Kc=e=>{e&&e instanceof Function&&n.e(453).then(n.bind(n,453)).then((t=>{let{getCLS:n,getFID:r,getFCP:a,getLCP:i,getTTFB:s}=t;n(e),r(e),a(e),i(e),s(e)}))};a.createRoot(document.getElementById("root")).render((0,c.jsx)(r.StrictMode,{children:(0,c.jsx)(Wc,{})})),Kc()})();
//# sourceMappingURL=main.c8456760.js.map