/*! For license information please see main.2e55cc77.js.LICENSE.txt */
(()=>{"use strict";var e={43:(e,t,n)=>{e.exports=n(202)},153:(e,t,n)=>{var r=n(43),i=Symbol.for("react.element"),o=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,o={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)s.call(t,r)&&!l.hasOwnProperty(r)&&(o[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===o[r]&&(o[r]=t[r]);return{$$typeof:i,type:e,key:c,ref:u,props:o,_owner:a.current}}t.Fragment=o,t.jsx=c,t.jsxs=c},202:(e,t)=>{var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,m={};function y(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}function v(){}function b(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=y.prototype;var w=b.prototype=new v;w.constructor=b,g(w,y.prototype),w.isPureReactComponent=!0;var x=Array.isArray,I=Object.prototype.hasOwnProperty,S={current:null},E={key:!0,ref:!0,__self:!0,__source:!0};function _(e,t,r){var i,o={},s=null,a=null;if(null!=t)for(i in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(s=""+t.key),t)I.call(t,i)&&!E.hasOwnProperty(i)&&(o[i]=t[i]);var l=arguments.length-2;if(1===l)o.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];o.children=c}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===o[i]&&(o[i]=l[i]);return{$$typeof:n,type:e,key:s,ref:a,props:o,_owner:S.current}}function T(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var k=/\/+/g;function C(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function N(e,t,i,o,s){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l=!1;if(null===e)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return s=s(l=e),e=""===o?"."+C(l,0):o,x(s)?(i="",null!=e&&(i=e.replace(k,"$&/")+"/"),N(s,t,i,"",(function(e){return e}))):null!=s&&(T(s)&&(s=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,i+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(k,"$&/")+"/")+e)),t.push(s)),1;if(l=0,o=""===o?".":o+":",x(e))for(var c=0;c<e.length;c++){var u=o+C(a=e[c],c);l+=N(a,t,i,u,s)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(a=e.next()).done;)l+=N(a=a.value,t,i,u=o+C(a,c++),s);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function A(e,t,n){if(null==e)return e;var r=[],i=0;return N(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function D(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var P={current:null},R={transition:null},O={ReactCurrentDispatcher:P,ReactCurrentBatchConfig:R,ReactCurrentOwner:S};function L(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:A,forEach:function(e,t,n){A(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return A(e,(function(){t++})),t},toArray:function(e){return A(e,(function(e){return e}))||[]},only:function(e){if(!T(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=y,t.Fragment=i,t.Profiler=s,t.PureComponent=b,t.StrictMode=o,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O,t.act=L,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=g({},e.props),o=e.key,s=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,a=S.current),void 0!==t.key&&(o=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)I.call(t,c)&&!E.hasOwnProperty(c)&&(i[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)i.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}return{$$typeof:n,type:e.type,key:o,ref:s,props:i,_owner:a}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=_,t.createFactory=function(e){var t=_.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=T,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:D}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=R.transition;R.transition={};try{e()}finally{R.transition=t}},t.unstable_act=L,t.useCallback=function(e,t){return P.current.useCallback(e,t)},t.useContext=function(e){return P.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return P.current.useDeferredValue(e)},t.useEffect=function(e,t){return P.current.useEffect(e,t)},t.useId=function(){return P.current.useId()},t.useImperativeHandle=function(e,t,n){return P.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return P.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return P.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return P.current.useMemo(e,t)},t.useReducer=function(e,t,n){return P.current.useReducer(e,t,n)},t.useRef=function(e){return P.current.useRef(e)},t.useState=function(e){return P.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return P.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return P.current.useTransition()},t.version="18.3.1"},234:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<o(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,s=i>>>1;r<s;){var a=2*(r+1)-1,l=e[a],c=a+1,u=e[c];if(0>o(l,n))c<i&&0>o(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[a]=n,r=a);else{if(!(c<i&&0>o(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function o(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],d=1,h=null,f=3,p=!1,g=!1,m=!1,y="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=r(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function x(e){if(m=!1,w(e),!g)if(null!==r(c))g=!0,R(I);else{var t=r(u);null!==t&&O(x,t.startTime-e)}}function I(e,n){g=!1,m&&(m=!1,v(T),T=-1),p=!0;var o=f;try{for(w(n),h=r(c);null!==h&&(!(h.expirationTime>n)||e&&!N());){var s=h.callback;if("function"===typeof s){h.callback=null,f=h.priorityLevel;var a=s(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof a?h.callback=a:h===r(c)&&i(c),w(n)}else i(c);h=r(c)}if(null!==h)var l=!0;else{var d=r(u);null!==d&&O(x,d.startTime-n),l=!1}return l}finally{h=null,f=o,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,E=!1,_=null,T=-1,k=5,C=-1;function N(){return!(t.unstable_now()-C<k)}function A(){if(null!==_){var e=t.unstable_now();C=e;var n=!0;try{n=_(!0,e)}finally{n?S():(E=!1,_=null)}}else E=!1}if("function"===typeof b)S=function(){b(A)};else if("undefined"!==typeof MessageChannel){var D=new MessageChannel,P=D.port2;D.port1.onmessage=A,S=function(){P.postMessage(null)}}else S=function(){y(A,0)};function R(e){_=e,E||(E=!0,S())}function O(e,n){T=y((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){g||p||(g=!0,R(I))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,i,o){var s=t.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?s+o:s:o=s,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:d++,callback:i,priorityLevel:e,startTime:o,expirationTime:a=o+a,sortIndex:-1},o>s?(e.sortIndex=o,n(u,e),null===r(c)&&e===r(u)&&(m?(v(T),T=-1):m=!0,O(x,o-s))):(e.sortIndex=a,n(c,e),g||p||(g=!0,R(I))),e},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},391:(e,t,n)=>{var r=n(950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},579:(e,t,n)=>{e.exports=n(153)},730:(e,t,n)=>{var r=n(43),i=n(853);function o(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,a={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(a[e]=t,e=0;e<t.length;e++)s.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function g(e,t,n,r,i,o,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=s}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){m[e]=new g(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];m[t]=new g(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){m[e]=new g(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){m[e]=new g(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){m[e]=new g(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){m[e]=new g(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){m[e]=new g(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){m[e]=new g(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){m[e]=new g(e,5,!1,e.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function b(e,t,n,r){var i=m.hasOwnProperty(t)?m[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!d.call(p,e)||!d.call(f,e)&&(h.test(e)?p[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(y,v);m[t]=new g(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(y,v);m[t]=new g(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(y,v);m[t]=new g(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!1,!1)})),m.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!0,!0)}));var w=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,x=Symbol.for("react.element"),I=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),_=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),k=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),P=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var R=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var O=Symbol.iterator;function L(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=O&&e[O]||e["@@iterator"])?e:null}var M,j=Object.assign;function z(e){if(void 0===M)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);M=t&&t[1]||""}return"\n"+M+e}var F=!1;function V(e,t){if(!e||F)return"";F=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var i=c.stack.split("\n"),o=r.stack.split("\n"),s=i.length-1,a=o.length-1;1<=s&&0<=a&&i[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(i[s]!==o[a]){if(1!==s||1!==a)do{if(s--,0>--a||i[s]!==o[a]){var l="\n"+i[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=s&&0<=a);break}}}finally{F=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?z(e):""}function U(e){switch(e.tag){case 5:return z(e.type);case 16:return z("Lazy");case 13:return z("Suspense");case 19:return z("SuspenseList");case 0:case 2:case 15:return e=V(e.type,!1);case 11:return e=V(e.type.render,!1);case 1:return e=V(e.type,!0);default:return""}}function $(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case S:return"Fragment";case I:return"Portal";case _:return"Profiler";case E:return"StrictMode";case N:return"Suspense";case A:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case k:return(e.displayName||"Context")+".Consumer";case T:return(e._context.displayName||"Context")+".Provider";case C:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case D:return null!==(t=e.displayName||null)?t:$(e.type)||"Memo";case P:t=e._payload,e=e._init;try{return $(e(t))}catch(n){}}return null}function B(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return $(t);case 8:return t===E?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function q(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function H(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function K(e){e._valueTracker||(e._valueTracker=function(e){var t=H(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function W(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=H(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function G(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(St){return e.body}}function Q(e,t){var n=t.checked;return j({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Y(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=q(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function X(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function J(e,t){X(e,t);var n=q(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,q(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&G(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+q(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(o(91));return j({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(o(92));if(te(n)){if(1<n.length)throw Error(o(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:q(n)}}function oe(e,t){var n=q(t.value),r=q(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function se(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ae(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ae(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function ge(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function me(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=ge(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(fe).forEach((function(e){pe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]}))}));var ye=j({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ve(e,t){if(t){if(ye[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(o(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(o(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(o(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var we=null;function xe(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ie=null,Se=null,Ee=null;function _e(e){if(e=Ii(e)){if("function"!==typeof Ie)throw Error(o(280));var t=e.stateNode;t&&(t=Ei(t),Ie(e.stateNode,e.type,t))}}function Te(e){Se?Ee?Ee.push(e):Ee=[e]:Se=e}function ke(){if(Se){var e=Se,t=Ee;if(Ee=Se=null,_e(e),t)for(e=0;e<t.length;e++)_e(t[e])}}function Ce(e,t){return e(t)}function Ne(){}var Ae=!1;function De(e,t,n){if(Ae)return e(t,n);Ae=!0;try{return Ce(e,t,n)}finally{Ae=!1,(null!==Se||null!==Ee)&&(Ne(),ke())}}function Pe(e,t){var n=e.stateNode;if(null===n)return null;var r=Ei(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(o(231,t,typeof n));return n}var Re=!1;if(u)try{var Oe={};Object.defineProperty(Oe,"passive",{get:function(){Re=!0}}),window.addEventListener("test",Oe,Oe),window.removeEventListener("test",Oe,Oe)}catch(ue){Re=!1}function Le(e,t,n,r,i,o,s,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Me=!1,je=null,ze=!1,Fe=null,Ve={onError:function(e){Me=!0,je=e}};function Ue(e,t,n,r,i,o,s,a,l){Me=!1,je=null,Le.apply(Ve,arguments)}function $e(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Be(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function qe(e){if($e(e)!==e)throw Error(o(188))}function He(e){return e=function(e){var t=e.alternate;if(!t){if(null===(t=$e(e)))throw Error(o(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var s=i.alternate;if(null===s){if(null!==(r=i.return)){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return qe(i),e;if(s===r)return qe(i),t;s=s.sibling}throw Error(o(188))}if(n.return!==r.return)n=i,r=s;else{for(var a=!1,l=i.child;l;){if(l===n){a=!0,n=i,r=s;break}if(l===r){a=!0,r=i,n=s;break}l=l.sibling}if(!a){for(l=s.child;l;){if(l===n){a=!0,n=s,r=i;break}if(l===r){a=!0,r=s,n=i;break}l=l.sibling}if(!a)throw Error(o(189))}}if(n.alternate!==r)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?e:t}(e),null!==e?Ke(e):null}function Ke(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ke(e);if(null!==t)return t;e=e.sibling}return null}var We=i.unstable_scheduleCallback,Ge=i.unstable_cancelCallback,Qe=i.unstable_shouldYield,Ye=i.unstable_requestPaint,Xe=i.unstable_now,Je=i.unstable_getCurrentPriorityLevel,Ze=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,it=null,ot=null;var st=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(at(e)/lt|0)|0},at=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,o=e.pingedLanes,s=268435455&n;if(0!==s){var a=s&~i;0!==a?r=dt(a):0!==(o&=s)&&(r=dt(o))}else 0!==(s=n&~i)?r=dt(s):0!==o&&(r=dt(o));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(o=t&-t)||16===i&&0!==(4194240&o)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-st(t)),r|=e[n],t&=~i;return r}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function gt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function mt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function yt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-st(t)]=n}function vt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-st(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var bt=0;function wt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var xt,It,Et,_t,Tt,kt=!1,Ct=[],Nt=null,At=null,Dt=null,Pt=new Map,Rt=new Map,Ot=[],Lt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Mt(e,t){switch(e){case"focusin":case"focusout":Nt=null;break;case"dragenter":case"dragleave":At=null;break;case"mouseover":case"mouseout":Dt=null;break;case"pointerover":case"pointerout":Pt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rt.delete(t.pointerId)}}function jt(e,t,n,r,i,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},null!==t&&(null!==(t=Ii(t))&&It(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function zt(e){var t=xi(e.target);if(null!==t){var n=$e(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Be(n)))return e.blockedOn=t,void Tt(e.priority,(function(){Et(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ft(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=Ii(n))&&It(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);we=r,n.target.dispatchEvent(r),we=null,t.shift()}return!0}function Vt(e,t,n){Ft(e)&&n.delete(t)}function Ut(){kt=!1,null!==Nt&&Ft(Nt)&&(Nt=null),null!==At&&Ft(At)&&(At=null),null!==Dt&&Ft(Dt)&&(Dt=null),Pt.forEach(Vt),Rt.forEach(Vt)}function $t(e,t){e.blockedOn===t&&(e.blockedOn=null,kt||(kt=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Ut)))}function Bt(e){function t(t){return $t(t,e)}if(0<Ct.length){$t(Ct[0],e);for(var n=1;n<Ct.length;n++){var r=Ct[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Nt&&$t(Nt,e),null!==At&&$t(At,e),null!==Dt&&$t(Dt,e),Pt.forEach(t),Rt.forEach(t),n=0;n<Ot.length;n++)(r=Ot[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Ot.length&&null===(n=Ot[0]).blockedOn;)zt(n),null===n.blockedOn&&Ot.shift()}var qt=w.ReactCurrentBatchConfig,Ht=!0;function Kt(e,t,n,r){var i=bt,o=qt.transition;qt.transition=null;try{bt=1,Gt(e,t,n,r)}finally{bt=i,qt.transition=o}}function Wt(e,t,n,r){var i=bt,o=qt.transition;qt.transition=null;try{bt=4,Gt(e,t,n,r)}finally{bt=i,qt.transition=o}}function Gt(e,t,n,r){if(Ht){var i=Yt(e,t,n,r);if(null===i)Wr(e,t,r,Qt,n),Mt(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return Nt=jt(Nt,e,t,n,r,i),!0;case"dragenter":return At=jt(At,e,t,n,r,i),!0;case"mouseover":return Dt=jt(Dt,e,t,n,r,i),!0;case"pointerover":var o=i.pointerId;return Pt.set(o,jt(Pt.get(o)||null,e,t,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,Rt.set(o,jt(Rt.get(o)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Mt(e,r),4&t&&-1<Lt.indexOf(e)){for(;null!==i;){var o=Ii(i);if(null!==o&&xt(o),null===(o=Yt(e,t,n,r))&&Wr(e,t,r,Qt,n),o===i)break;i=o}null!==i&&r.stopPropagation()}else Wr(e,t,r,null,n)}}var Qt=null;function Yt(e,t,n,r){if(Qt=null,null!==(e=xi(e=xe(r))))if(null===(t=$e(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Be(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Qt=e,null}function Xt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Jt=null,Zt=null,en=null;function nn(){if(en)return en;var e,t,n=Zt,r=n.length,i="value"in Jt?Jt.value:Jt.textContent,o=i.length;for(e=0;e<r&&n[e]===i[e];e++);var s=r-e;for(t=1;t<=s&&n[r-t]===i[o-t];t++);return en=i.slice(e,1<t?1-t:void 0)}function rn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function on(){return!0}function sn(){return!1}function an(e){function t(t,n,r,i,o){for(var s in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(i):i[s]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?on:sn,this.isPropagationStopped=sn,this}return j(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=on)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=on)},persist:function(){},isPersistent:on}),t}var ln,cn,un,dn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hn=an(dn),fn=j({},dn,{view:0,detail:0}),pn=an(fn),gn=j({},fn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:kn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==un&&(un&&"mousemove"===e.type?(ln=e.screenX-un.screenX,cn=e.screenY-un.screenY):cn=ln=0,un=e),ln)},movementY:function(e){return"movementY"in e?e.movementY:cn}}),mn=an(gn),yn=an(j({},gn,{dataTransfer:0})),vn=an(j({},fn,{relatedTarget:0})),bn=an(j({},dn,{animationName:0,elapsedTime:0,pseudoElement:0})),wn=j({},dn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),xn=an(wn),In=an(j({},dn,{data:0})),Sn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},En={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_n={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Tn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=_n[e])&&!!t[e]}function kn(){return Tn}var Cn=j({},fn,{key:function(e){if(e.key){var t=Sn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=rn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?En[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:kn,charCode:function(e){return"keypress"===e.type?rn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?rn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Nn=an(Cn),An=an(j({},gn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Dn=an(j({},fn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:kn})),Pn=an(j({},dn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Rn=j({},gn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),On=an(Rn),Mn=[9,13,27,32],jn=u&&"CompositionEvent"in window,zn=null;u&&"documentMode"in document&&(zn=document.documentMode);var Fn=u&&"TextEvent"in window&&!zn,Vn=u&&(!jn||zn&&8<zn&&11>=zn),Un=String.fromCharCode(32),$n=!1;function Bn(e,t){switch(e){case"keyup":return-1!==Mn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function qn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Hn=!1;var Kn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Kn[e.type]:"textarea"===t}function Gn(e,t,n,r){Te(r),0<(t=Qr(t,"onChange")).length&&(n=new hn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Qn=null,Yn=null;function Xn(e){Ur(e,0)}function Jn(e){if(W(Si(e)))return e}function Zn(e,t){if("change"===e)return t}var er=!1;if(u){var tr;if(u){var nr="oninput"in document;if(!nr){var rr=document.createElement("div");rr.setAttribute("oninput","return;"),nr="function"===typeof rr.oninput}tr=nr}else tr=!1;er=tr&&(!document.documentMode||9<document.documentMode)}function ir(){Qn&&(Qn.detachEvent("onpropertychange",or),Yn=Qn=null)}function or(e){if("value"===e.propertyName&&Jn(Yn)){var t=[];Gn(t,Yn,e,xe(e)),De(Xn,t)}}function sr(e,t,n){"focusin"===e?(ir(),Yn=n,(Qn=t).attachEvent("onpropertychange",or)):"focusout"===e&&ir()}function ar(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Jn(Yn)}function lr(e,t){if("click"===e)return Jn(t)}function cr(e,t){if("input"===e||"change"===e)return Jn(t)}var ur="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function dr(e,t){if(ur(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!d.call(t,i)||!ur(e[i],t[i]))return!1}return!0}function hr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function fr(e,t){var n,r=hr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=hr(r)}}function pr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?pr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function gr(){for(var e=window,t=G();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=G((e=t.contentWindow).document)}return t}function mr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function yr(e){var t=gr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&pr(n.ownerDocument.documentElement,n)){if(null!==r&&mr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=void 0===r.end?o:Math.min(r.end,i),!e.extend&&o>r&&(i=r,r=o,o=i),i=fr(n,o);var s=fr(n,r);i&&s&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),o>r?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var vr=u&&"documentMode"in document&&11>=document.documentMode,br=null,wr=null,xr=null,Ir=!1;function Sr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;Ir||null==br||br!==G(r)||("selectionStart"in(r=br)&&mr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},xr&&dr(xr,r)||(xr=r,0<(r=Qr(wr,"onSelect")).length&&(t=new hn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=br)))}function Er(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var _r={animationend:Er("Animation","AnimationEnd"),animationiteration:Er("Animation","AnimationIteration"),animationstart:Er("Animation","AnimationStart"),transitionend:Er("Transition","TransitionEnd")},Tr={},kr={};function Cr(e){if(Tr[e])return Tr[e];if(!_r[e])return e;var t,n=_r[e];for(t in n)if(n.hasOwnProperty(t)&&t in kr)return Tr[e]=n[t];return e}u&&(kr=document.createElement("div").style,"AnimationEvent"in window||(delete _r.animationend.animation,delete _r.animationiteration.animation,delete _r.animationstart.animation),"TransitionEvent"in window||delete _r.transitionend.transition);var Nr=Cr("animationend"),Ar=Cr("animationiteration"),Dr=Cr("animationstart"),Pr=Cr("transitionend"),Rr=new Map,Or="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Lr(e,t){Rr.set(e,t),l(t,[e])}for(var Mr=0;Mr<Or.length;Mr++){var jr=Or[Mr];Lr(jr.toLowerCase(),"on"+(jr[0].toUpperCase()+jr.slice(1)))}Lr(Nr,"onAnimationEnd"),Lr(Ar,"onAnimationIteration"),Lr(Dr,"onAnimationStart"),Lr("dblclick","onDoubleClick"),Lr("focusin","onFocus"),Lr("focusout","onBlur"),Lr(Pr,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fr=new Set("cancel close invalid load scroll toggle".split(" ").concat(zr));function Vr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,s,a,l,c){if(Ue.apply(this,arguments),Me){if(!Me)throw Error(o(198));var u=je;Me=!1,je=null,ze||(ze=!0,Fe=u)}}(r,t,void 0,e),e.currentTarget=null}function Ur(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var s=r.length-1;0<=s;s--){var a=r[s],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==o&&i.isPropagationStopped())break e;Vr(i,a,c),o=l}else for(s=0;s<r.length;s++){if(l=(a=r[s]).instance,c=a.currentTarget,a=a.listener,l!==o&&i.isPropagationStopped())break e;Vr(i,a,c),o=l}}}if(ze)throw e=Fe,ze=!1,Fe=null,e}function $r(e,t){var n=t[vi];void 0===n&&(n=t[vi]=new Set);var r=e+"__bubble";n.has(r)||(Kr(t,e,2,!1),n.add(r))}function Br(e,t,n){var r=0;t&&(r|=4),Kr(n,e,r,t)}var qr="_reactListening"+Math.random().toString(36).slice(2);function Hr(e){if(!e[qr]){e[qr]=!0,s.forEach((function(t){"selectionchange"!==t&&(Fr.has(t)||Br(t,!1,e),Br(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[qr]||(t[qr]=!0,Br("selectionchange",!1,t))}}function Kr(e,t,n,r){switch(Xt(t)){case 1:var i=Kt;break;case 4:i=Wt;break;default:i=Gt}n=i.bind(null,t,n,e),i=void 0,!Re||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Wr(e,t,n,r,i){var o=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var s=r.tag;if(3===s||4===s){var a=r.stateNode.containerInfo;if(a===i||8===a.nodeType&&a.parentNode===i)break;if(4===s)for(s=r.return;null!==s;){var l=s.tag;if((3===l||4===l)&&((l=s.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;s=s.return}for(;null!==a;){if(null===(s=xi(a)))return;if(5===(l=s.tag)||6===l){r=o=s;continue e}a=a.parentNode}}r=r.return}De((function(){var r=o,i=xe(n),s=[];e:{var a=Rr.get(e);if(void 0!==a){var l=hn,c=e;switch(e){case"keypress":if(0===rn(n))break e;case"keydown":case"keyup":l=Nn;break;case"focusin":c="focus",l=vn;break;case"focusout":c="blur",l=vn;break;case"beforeblur":case"afterblur":l=vn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=mn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=yn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Dn;break;case Nr:case Ar:case Dr:l=bn;break;case Pr:l=Pn;break;case"scroll":l=pn;break;case"wheel":l=On;break;case"copy":case"cut":case"paste":l=xn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=An}var u=0!==(4&t),d=!u&&"scroll"===e,h=u?null!==a?a+"Capture":null:a;u=[];for(var f,p=r;null!==p;){var g=(f=p).stateNode;if(5===f.tag&&null!==g&&(f=g,null!==h&&(null!=(g=Pe(p,h))&&u.push(Gr(p,g,f)))),d)break;p=p.return}0<u.length&&(a=new l(a,c,null,n,i),s.push({event:a,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===we||!(c=n.relatedTarget||n.fromElement)||!xi(c)&&!c[yi])&&(l||a)&&(a=i.window===i?i:(a=i.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?xi(c):null)&&(c!==(d=$e(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(u=mn,g="onMouseLeave",h="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=An,g="onPointerLeave",h="onPointerEnter",p="pointer"),d=null==l?a:Si(l),f=null==c?a:Si(c),(a=new u(g,p+"leave",l,n,i)).target=d,a.relatedTarget=f,g=null,xi(i)===r&&((u=new u(h,p+"enter",c,n,i)).target=f,u.relatedTarget=d,g=u),d=g,l&&c)e:{for(h=c,p=0,f=u=l;f;f=Yr(f))p++;for(f=0,g=h;g;g=Yr(g))f++;for(;0<p-f;)u=Yr(u),p--;for(;0<f-p;)h=Yr(h),f--;for(;p--;){if(u===h||null!==h&&u===h.alternate)break e;u=Yr(u),h=Yr(h)}u=null}else u=null;null!==l&&Xr(s,a,l,u,!1),null!==c&&null!==d&&Xr(s,d,c,u,!0)}if("select"===(l=(a=r?Si(r):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var m=Zn;else if(Wn(a))if(er)m=cr;else{m=ar;var y=sr}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(m=lr);switch(m&&(m=m(e,r))?Gn(s,m,n,i):(y&&y(e,a,r),"focusout"===e&&(y=a._wrapperState)&&y.controlled&&"number"===a.type&&ee(a,"number",a.value)),y=r?Si(r):window,e){case"focusin":(Wn(y)||"true"===y.contentEditable)&&(br=y,wr=r,xr=null);break;case"focusout":xr=wr=br=null;break;case"mousedown":Ir=!0;break;case"contextmenu":case"mouseup":case"dragend":Ir=!1,Sr(s,n,i);break;case"selectionchange":if(vr)break;case"keydown":case"keyup":Sr(s,n,i)}var v;if(jn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Hn?Bn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Vn&&"ko"!==n.locale&&(Hn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Hn&&(v=nn()):(Zt="value"in(Jt=i)?Jt.value:Jt.textContent,Hn=!0)),0<(y=Qr(r,b)).length&&(b=new In(b,e,null,n,i),s.push({event:b,listeners:y}),v?b.data=v:null!==(v=qn(n))&&(b.data=v))),(v=Fn?function(e,t){switch(e){case"compositionend":return qn(t);case"keypress":return 32!==t.which?null:($n=!0,Un);case"textInput":return(e=t.data)===Un&&$n?null:e;default:return null}}(e,n):function(e,t){if(Hn)return"compositionend"===e||!jn&&Bn(e,t)?(e=nn(),en=Zt=Jt=null,Hn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Vn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Qr(r,"onBeforeInput")).length&&(i=new In("onBeforeInput","beforeinput",null,n,i),s.push({event:i,listeners:r}),i.data=v))}Ur(s,t)}))}function Gr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Qr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,o=i.stateNode;5===i.tag&&null!==o&&(i=o,null!=(o=Pe(e,n))&&r.unshift(Gr(e,o,i)),null!=(o=Pe(e,t))&&r.push(Gr(e,o,i))),e=e.return}return r}function Yr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Xr(e,t,n,r,i){for(var o=t._reactName,s=[];null!==n&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(null!==l&&l===r)break;5===a.tag&&null!==c&&(a=c,i?null!=(l=Pe(n,o))&&s.unshift(Gr(n,l,a)):i||null!=(l=Pe(n,o))&&s.push(Gr(n,l,a))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var Jr=/\r\n?/g,Zr=/\u0000|\uFFFD/g;function ei(e){return("string"===typeof e?e:""+e).replace(Jr,"\n").replace(Zr,"")}function ti(e,t,n){if(t=ei(t),ei(e)!==t&&n)throw Error(o(425))}function ni(){}var ri=null,ii=null;function oi(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var si="function"===typeof setTimeout?setTimeout:void 0,ai="function"===typeof clearTimeout?clearTimeout:void 0,li="function"===typeof Promise?Promise:void 0,ci="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof li?function(e){return li.resolve(null).then(e).catch(ui)}:si;function ui(e){setTimeout((function(){throw e}))}function di(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void Bt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);Bt(t)}function hi(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function fi(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var pi=Math.random().toString(36).slice(2),gi="__reactFiber$"+pi,mi="__reactProps$"+pi,yi="__reactContainer$"+pi,vi="__reactEvents$"+pi,bi="__reactListeners$"+pi,wi="__reactHandles$"+pi;function xi(e){var t=e[gi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[yi]||n[gi]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=fi(e);null!==e;){if(n=e[gi])return n;e=fi(e)}return t}n=(e=n).parentNode}return null}function Ii(e){return!(e=e[gi]||e[yi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function Si(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(o(33))}function Ei(e){return e[mi]||null}var _i=[],Ti=-1;function ki(e){return{current:e}}function Ci(e){0>Ti||(e.current=_i[Ti],_i[Ti]=null,Ti--)}function Ni(e,t){Ti++,_i[Ti]=e.current,e.current=t}var Ai={},Di=ki(Ai),Pi=ki(!1),Ri=Ai;function Oi(e,t){var n=e.type.contextTypes;if(!n)return Ai;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,o={};for(i in n)o[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Li(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Mi(){Ci(Pi),Ci(Di)}function ji(e,t,n){if(Di.current!==Ai)throw Error(o(168));Ni(Di,t),Ni(Pi,n)}function zi(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(o(108,B(e)||"Unknown",i));return j({},n,r)}function Fi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ai,Ri=Di.current,Ni(Di,e),Ni(Pi,Pi.current),!0}function Vi(e,t,n){var r=e.stateNode;if(!r)throw Error(o(169));n?(e=zi(e,t,Ri),r.__reactInternalMemoizedMergedChildContext=e,Ci(Pi),Ci(Di),Ni(Di,e)):Ci(Pi),Ni(Pi,n)}var Ui=null,$i=!1,Bi=!1;function qi(e){null===Ui?Ui=[e]:Ui.push(e)}function Hi(){if(!Bi&&null!==Ui){Bi=!0;var e=0,t=bt;try{var n=Ui;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Ui=null,$i=!1}catch(i){throw null!==Ui&&(Ui=Ui.slice(e+1)),We(Ze,Hi),i}finally{bt=t,Bi=!1}}return null}var Ki=[],Wi=0,Gi=null,Qi=0,Yi=[],Xi=0,Ji=null,Zi=1,eo="";function to(e,t){Ki[Wi++]=Qi,Ki[Wi++]=Gi,Gi=e,Qi=t}function no(e,t,n){Yi[Xi++]=Zi,Yi[Xi++]=eo,Yi[Xi++]=Ji,Ji=e;var r=Zi;e=eo;var i=32-st(r)-1;r&=~(1<<i),n+=1;var o=32-st(t)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,Zi=1<<32-st(t)+i|n<<i|r,eo=o+e}else Zi=1<<o|n<<i|r,eo=e}function ro(e){null!==e.return&&(to(e,1),no(e,1,0))}function io(e){for(;e===Gi;)Gi=Ki[--Wi],Ki[Wi]=null,Qi=Ki[--Wi],Ki[Wi]=null;for(;e===Ji;)Ji=Yi[--Xi],Yi[Xi]=null,eo=Yi[--Xi],Yi[Xi]=null,Zi=Yi[--Xi],Yi[Xi]=null}var oo=null,so=null,ao=!1,lo=null;function co(e,t){var n=Oc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function uo(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,oo=e,so=hi(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,oo=e,so=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Ji?{id:Zi,overflow:eo}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Oc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,oo=e,so=null,!0);default:return!1}}function ho(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function fo(e){if(ao){var t=so;if(t){var n=t;if(!uo(e,t)){if(ho(e))throw Error(o(418));t=hi(n.nextSibling);var r=oo;t&&uo(e,t)?co(r,n):(e.flags=-4097&e.flags|2,ao=!1,oo=e)}}else{if(ho(e))throw Error(o(418));e.flags=-4097&e.flags|2,ao=!1,oo=e}}}function po(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;oo=e}function go(e){if(e!==oo)return!1;if(!ao)return po(e),ao=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!oi(e.type,e.memoizedProps)),t&&(t=so)){if(ho(e))throw mo(),Error(o(418));for(;t;)co(e,t),t=hi(t.nextSibling)}if(po(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){so=hi(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}so=null}}else so=oo?hi(e.stateNode.nextSibling):null;return!0}function mo(){for(var e=so;e;)e=hi(e.nextSibling)}function yo(){so=oo=null,ao=!1}function vo(e){null===lo?lo=[e]:lo.push(e)}var bo=w.ReactCurrentBatchConfig;function wo(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(o(309));var r=n.stateNode}if(!r)throw Error(o(147,e));var i=r,s=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===s?t.ref:(t=function(e){var t=i.refs;null===e?delete t[s]:t[s]=e},t._stringRef=s,t)}if("string"!==typeof e)throw Error(o(284));if(!n._owner)throw Error(o(290,e))}return e}function xo(e,t){throw e=Object.prototype.toString.call(t),Error(o(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Io(e){return(0,e._init)(e._payload)}function So(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Mc(e,t)).index=0,e.sibling=null,e}function s(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Vc(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){var o=n.type;return o===S?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===o||"object"===typeof o&&null!==o&&o.$$typeof===P&&Io(o)===t.type)?((r=i(t,n.props)).ref=wo(e,t,n),r.return=e,r):((r=jc(n.type,n.key,n.props,null,e.mode,r)).ref=wo(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Uc(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function d(e,t,n,r,o){return null===t||7!==t.tag?((t=zc(n,e.mode,r,o)).return=e,t):((t=i(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Vc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case x:return(n=jc(t.type,t.key,t.props,null,e.mode,n)).ref=wo(e,null,t),n.return=e,n;case I:return(t=Uc(t,e.mode,n)).return=e,t;case P:return h(e,(0,t._init)(t._payload),n)}if(te(t)||L(t))return(t=zc(t,e.mode,n,null)).return=e,t;xo(e,t)}return null}function f(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case x:return n.key===i?c(e,t,n,r):null;case I:return n.key===i?u(e,t,n,r):null;case P:return f(e,t,(i=n._init)(n._payload),r)}if(te(n)||L(n))return null!==i?null:d(e,t,n,r,null);xo(e,n)}return null}function p(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case x:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case I:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case P:return p(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||L(r))return d(t,e=e.get(n)||null,r,i,null);xo(t,r)}return null}function g(i,o,a,l){for(var c=null,u=null,d=o,g=o=0,m=null;null!==d&&g<a.length;g++){d.index>g?(m=d,d=null):m=d.sibling;var y=f(i,d,a[g],l);if(null===y){null===d&&(d=m);break}e&&d&&null===y.alternate&&t(i,d),o=s(y,o,g),null===u?c=y:u.sibling=y,u=y,d=m}if(g===a.length)return n(i,d),ao&&to(i,g),c;if(null===d){for(;g<a.length;g++)null!==(d=h(i,a[g],l))&&(o=s(d,o,g),null===u?c=d:u.sibling=d,u=d);return ao&&to(i,g),c}for(d=r(i,d);g<a.length;g++)null!==(m=p(d,i,g,a[g],l))&&(e&&null!==m.alternate&&d.delete(null===m.key?g:m.key),o=s(m,o,g),null===u?c=m:u.sibling=m,u=m);return e&&d.forEach((function(e){return t(i,e)})),ao&&to(i,g),c}function m(i,a,l,c){var u=L(l);if("function"!==typeof u)throw Error(o(150));if(null==(l=u.call(l)))throw Error(o(151));for(var d=u=null,g=a,m=a=0,y=null,v=l.next();null!==g&&!v.done;m++,v=l.next()){g.index>m?(y=g,g=null):y=g.sibling;var b=f(i,g,v.value,c);if(null===b){null===g&&(g=y);break}e&&g&&null===b.alternate&&t(i,g),a=s(b,a,m),null===d?u=b:d.sibling=b,d=b,g=y}if(v.done)return n(i,g),ao&&to(i,m),u;if(null===g){for(;!v.done;m++,v=l.next())null!==(v=h(i,v.value,c))&&(a=s(v,a,m),null===d?u=v:d.sibling=v,d=v);return ao&&to(i,m),u}for(g=r(i,g);!v.done;m++,v=l.next())null!==(v=p(g,i,m,v.value,c))&&(e&&null!==v.alternate&&g.delete(null===v.key?m:v.key),a=s(v,a,m),null===d?u=v:d.sibling=v,d=v);return e&&g.forEach((function(e){return t(i,e)})),ao&&to(i,m),u}return function e(r,o,s,l){if("object"===typeof s&&null!==s&&s.type===S&&null===s.key&&(s=s.props.children),"object"===typeof s&&null!==s){switch(s.$$typeof){case x:e:{for(var c=s.key,u=o;null!==u;){if(u.key===c){if((c=s.type)===S){if(7===u.tag){n(r,u.sibling),(o=i(u,s.props.children)).return=r,r=o;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===P&&Io(c)===u.type){n(r,u.sibling),(o=i(u,s.props)).ref=wo(r,u,s),o.return=r,r=o;break e}n(r,u);break}t(r,u),u=u.sibling}s.type===S?((o=zc(s.props.children,r.mode,l,s.key)).return=r,r=o):((l=jc(s.type,s.key,s.props,null,r.mode,l)).ref=wo(r,o,s),l.return=r,r=l)}return a(r);case I:e:{for(u=s.key;null!==o;){if(o.key===u){if(4===o.tag&&o.stateNode.containerInfo===s.containerInfo&&o.stateNode.implementation===s.implementation){n(r,o.sibling),(o=i(o,s.children||[])).return=r,r=o;break e}n(r,o);break}t(r,o),o=o.sibling}(o=Uc(s,r.mode,l)).return=r,r=o}return a(r);case P:return e(r,o,(u=s._init)(s._payload),l)}if(te(s))return g(r,o,s,l);if(L(s))return m(r,o,s,l);xo(r,s)}return"string"===typeof s&&""!==s||"number"===typeof s?(s=""+s,null!==o&&6===o.tag?(n(r,o.sibling),(o=i(o,s)).return=r,r=o):(n(r,o),(o=Vc(s,r.mode,l)).return=r,r=o),a(r)):n(r,o)}}var Eo=So(!0),_o=So(!1),To=ki(null),ko=null,Co=null,No=null;function Ao(){No=Co=ko=null}function Do(e){var t=To.current;Ci(To),e._currentValue=t}function Po(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ro(e,t){ko=e,No=Co=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(Ia=!0),e.firstContext=null)}function Oo(e){var t=e._currentValue;if(No!==e)if(e={context:e,memoizedValue:t,next:null},null===Co){if(null===ko)throw Error(o(308));Co=e,ko.dependencies={lanes:0,firstContext:e}}else Co=Co.next=e;return t}var Lo=null;function Mo(e){null===Lo?Lo=[e]:Lo.push(e)}function jo(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,Mo(t)):(n.next=i.next,i.next=n),t.interleaved=n,zo(e,r)}function zo(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Fo=!1;function Vo(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Uo(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function $o(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Bo(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Dl)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,zo(e,n)}return null===(i=r.interleaved)?(t.next=t,Mo(r)):(t.next=i.next,i.next=t),r.interleaved=t,zo(e,n)}function qo(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}function Ho(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?i=o=s:o=o.next=s,n=n.next}while(null!==n);null===o?i=o=t:o=o.next=t}else i=o=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Ko(e,t,n,r){var i=e.updateQueue;Fo=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,a=i.shared.pending;if(null!==a){i.shared.pending=null;var l=a,c=l.next;l.next=null,null===s?o=c:s.next=c,s=l;var u=e.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===a?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(null!==o){var d=i.baseState;for(s=0,u=c=l=null,a=o;;){var h=a.lane,f=a.eventTime;if((r&h)===h){null!==u&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=e,g=a;switch(h=t,f=n,g.tag){case 1:if("function"===typeof(p=g.payload)){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(h="function"===typeof(p=g.payload)?p.call(f,d,h):p)||void 0===h)break e;d=j({},d,h);break e;case 2:Fo=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(h=i.effects)?i.effects=[a]:h.push(a))}else f={eventTime:f,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(c=u=f,l=d):u=u.next=f,s|=h;if(null===(a=a.next)){if(null===(a=i.shared.pending))break;a=(h=a).next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}if(null===u&&(l=d),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null!==(t=i.shared.interleaved)){i=t;do{s|=i.lane,i=i.next}while(i!==t)}else null===o&&(i.shared.lanes=0);Fl|=s,e.lanes=s,e.memoizedState=d}}function Wo(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(o(191,i));i.call(r)}}}var Go={},Qo=ki(Go),Yo=ki(Go),Xo=ki(Go);function Jo(e){if(e===Go)throw Error(o(174));return e}function Zo(e,t){switch(Ni(Xo,t),Ni(Yo,e),Ni(Qo,Go),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ci(Qo),Ni(Qo,t)}function es(){Ci(Qo),Ci(Yo),Ci(Xo)}function ts(e){Jo(Xo.current);var t=Jo(Qo.current),n=le(t,e.type);t!==n&&(Ni(Yo,e),Ni(Qo,n))}function ns(e){Yo.current===e&&(Ci(Qo),Ci(Yo))}var rs=ki(0);function is(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var os=[];function ss(){for(var e=0;e<os.length;e++)os[e]._workInProgressVersionPrimary=null;os.length=0}var as=w.ReactCurrentDispatcher,ls=w.ReactCurrentBatchConfig,cs=0,us=null,ds=null,hs=null,fs=!1,ps=!1,gs=0,ms=0;function ys(){throw Error(o(321))}function vs(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ur(e[n],t[n]))return!1;return!0}function bs(e,t,n,r,i,s){if(cs=s,us=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,as.current=null===e||null===e.memoizedState?na:ra,e=n(r,i),ps){s=0;do{if(ps=!1,gs=0,25<=s)throw Error(o(301));s+=1,hs=ds=null,t.updateQueue=null,as.current=ia,e=n(r,i)}while(ps)}if(as.current=ta,t=null!==ds&&null!==ds.next,cs=0,hs=ds=us=null,fs=!1,t)throw Error(o(300));return e}function ws(){var e=0!==gs;return gs=0,e}function xs(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===hs?us.memoizedState=hs=e:hs=hs.next=e,hs}function Is(){if(null===ds){var e=us.alternate;e=null!==e?e.memoizedState:null}else e=ds.next;var t=null===hs?us.memoizedState:hs.next;if(null!==t)hs=t,ds=e;else{if(null===e)throw Error(o(310));e={memoizedState:(ds=e).memoizedState,baseState:ds.baseState,baseQueue:ds.baseQueue,queue:ds.queue,next:null},null===hs?us.memoizedState=hs=e:hs=hs.next=e}return hs}function Ss(e,t){return"function"===typeof t?t(e):t}function Es(e){var t=Is(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=ds,i=r.baseQueue,s=n.pending;if(null!==s){if(null!==i){var a=i.next;i.next=s.next,s.next=a}r.baseQueue=i=s,n.pending=null}if(null!==i){s=i.next,r=r.baseState;var l=a=null,c=null,u=s;do{var d=u.lane;if((cs&d)===d)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=h,a=r):c=c.next=h,us.lanes|=d,Fl|=d}u=u.next}while(null!==u&&u!==s);null===c?a=r:c.next=l,ur(r,t.memoizedState)||(Ia=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{s=i.lane,us.lanes|=s,Fl|=s,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function _s(e){var t=Is(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,s=t.memoizedState;if(null!==i){n.pending=null;var a=i=i.next;do{s=e(s,a.action),a=a.next}while(a!==i);ur(s,t.memoizedState)||(Ia=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function Ts(){}function ks(e,t){var n=us,r=Is(),i=t(),s=!ur(r.memoizedState,i);if(s&&(r.memoizedState=i,Ia=!0),r=r.queue,Fs(As.bind(null,n,r,e),[e]),r.getSnapshot!==t||s||null!==hs&&1&hs.memoizedState.tag){if(n.flags|=2048,Os(9,Ns.bind(null,n,r,i,t),void 0,null),null===Pl)throw Error(o(349));0!==(30&cs)||Cs(n,t,i)}return i}function Cs(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=us.updateQueue)?(t={lastEffect:null,stores:null},us.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Ns(e,t,n,r){t.value=n,t.getSnapshot=r,Ds(t)&&Ps(e)}function As(e,t,n){return n((function(){Ds(t)&&Ps(e)}))}function Ds(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ur(e,n)}catch(r){return!0}}function Ps(e){var t=zo(e,1);null!==t&&oc(t,e,1,-1)}function Rs(e){var t=xs();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ss,lastRenderedState:e},t.queue=e,e=e.dispatch=Xs.bind(null,us,e),[t.memoizedState,e]}function Os(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=us.updateQueue)?(t={lastEffect:null,stores:null},us.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Ls(){return Is().memoizedState}function Ms(e,t,n,r){var i=xs();us.flags|=e,i.memoizedState=Os(1|t,n,void 0,void 0===r?null:r)}function js(e,t,n,r){var i=Is();r=void 0===r?null:r;var o=void 0;if(null!==ds){var s=ds.memoizedState;if(o=s.destroy,null!==r&&vs(r,s.deps))return void(i.memoizedState=Os(t,n,o,r))}us.flags|=e,i.memoizedState=Os(1|t,n,o,r)}function zs(e,t){return Ms(8390656,8,e,t)}function Fs(e,t){return js(2048,8,e,t)}function Vs(e,t){return js(4,2,e,t)}function Us(e,t){return js(4,4,e,t)}function $s(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Bs(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,js(4,4,$s.bind(null,t,e),n)}function qs(){}function Hs(e,t){var n=Is();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&vs(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Ks(e,t){var n=Is();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&vs(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Ws(e,t,n){return 0===(21&cs)?(e.baseState&&(e.baseState=!1,Ia=!0),e.memoizedState=n):(ur(n,t)||(n=gt(),us.lanes|=n,Fl|=n,e.baseState=!0),t)}function Gs(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=ls.transition;ls.transition={};try{e(!1),t()}finally{bt=n,ls.transition=r}}function Qs(){return Is().memoizedState}function Ys(e,t,n){var r=ic(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Js(e))Zs(t,n);else if(null!==(n=jo(e,t,n,r))){oc(n,e,r,rc()),ea(n,t,r)}}function Xs(e,t,n){var r=ic(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Js(e))Zs(t,i);else{var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var s=t.lastRenderedState,a=o(s,n);if(i.hasEagerState=!0,i.eagerState=a,ur(a,s)){var l=t.interleaved;return null===l?(i.next=i,Mo(t)):(i.next=l.next,l.next=i),void(t.interleaved=i)}}catch(c){}null!==(n=jo(e,t,i,r))&&(oc(n,e,r,i=rc()),ea(n,t,r))}}function Js(e){var t=e.alternate;return e===us||null!==t&&t===us}function Zs(e,t){ps=fs=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function ea(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}var ta={readContext:Oo,useCallback:ys,useContext:ys,useEffect:ys,useImperativeHandle:ys,useInsertionEffect:ys,useLayoutEffect:ys,useMemo:ys,useReducer:ys,useRef:ys,useState:ys,useDebugValue:ys,useDeferredValue:ys,useTransition:ys,useMutableSource:ys,useSyncExternalStore:ys,useId:ys,unstable_isNewReconciler:!1},na={readContext:Oo,useCallback:function(e,t){return xs().memoizedState=[e,void 0===t?null:t],e},useContext:Oo,useEffect:zs,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ms(4194308,4,$s.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ms(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ms(4,2,e,t)},useMemo:function(e,t){var n=xs();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=xs();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Ys.bind(null,us,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},xs().memoizedState=e},useState:Rs,useDebugValue:qs,useDeferredValue:function(e){return xs().memoizedState=e},useTransition:function(){var e=Rs(!1),t=e[0];return e=Gs.bind(null,e[1]),xs().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=us,i=xs();if(ao){if(void 0===n)throw Error(o(407));n=n()}else{if(n=t(),null===Pl)throw Error(o(349));0!==(30&cs)||Cs(r,t,n)}i.memoizedState=n;var s={value:n,getSnapshot:t};return i.queue=s,zs(As.bind(null,r,s,e),[e]),r.flags|=2048,Os(9,Ns.bind(null,r,s,n,t),void 0,null),n},useId:function(){var e=xs(),t=Pl.identifierPrefix;if(ao){var n=eo;t=":"+t+"R"+(n=(Zi&~(1<<32-st(Zi)-1)).toString(32)+n),0<(n=gs++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=ms++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ra={readContext:Oo,useCallback:Hs,useContext:Oo,useEffect:Fs,useImperativeHandle:Bs,useInsertionEffect:Vs,useLayoutEffect:Us,useMemo:Ks,useReducer:Es,useRef:Ls,useState:function(){return Es(Ss)},useDebugValue:qs,useDeferredValue:function(e){return Ws(Is(),ds.memoizedState,e)},useTransition:function(){return[Es(Ss)[0],Is().memoizedState]},useMutableSource:Ts,useSyncExternalStore:ks,useId:Qs,unstable_isNewReconciler:!1},ia={readContext:Oo,useCallback:Hs,useContext:Oo,useEffect:Fs,useImperativeHandle:Bs,useInsertionEffect:Vs,useLayoutEffect:Us,useMemo:Ks,useReducer:_s,useRef:Ls,useState:function(){return _s(Ss)},useDebugValue:qs,useDeferredValue:function(e){var t=Is();return null===ds?t.memoizedState=e:Ws(t,ds.memoizedState,e)},useTransition:function(){return[_s(Ss)[0],Is().memoizedState]},useMutableSource:Ts,useSyncExternalStore:ks,useId:Qs,unstable_isNewReconciler:!1};function oa(e,t){if(e&&e.defaultProps){for(var n in t=j({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function sa(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:j({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var aa={isMounted:function(e){return!!(e=e._reactInternals)&&$e(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=rc(),i=ic(e),o=$o(r,i);o.payload=t,void 0!==n&&null!==n&&(o.callback=n),null!==(t=Bo(e,o,i))&&(oc(t,e,i,r),qo(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=rc(),i=ic(e),o=$o(r,i);o.tag=1,o.payload=t,void 0!==n&&null!==n&&(o.callback=n),null!==(t=Bo(e,o,i))&&(oc(t,e,i,r),qo(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=rc(),r=ic(e),i=$o(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=Bo(e,i,r))&&(oc(t,e,r,n),qo(t,e,r))}};function la(e,t,n,r,i,o,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,o,s):!t.prototype||!t.prototype.isPureReactComponent||(!dr(n,r)||!dr(i,o))}function ca(e,t,n){var r=!1,i=Ai,o=t.contextType;return"object"===typeof o&&null!==o?o=Oo(o):(i=Li(t)?Ri:Di.current,o=(r=null!==(r=t.contextTypes)&&void 0!==r)?Oi(e,i):Ai),t=new t(n,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=aa,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function ua(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&aa.enqueueReplaceState(t,t.state,null)}function da(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},Vo(e);var o=t.contextType;"object"===typeof o&&null!==o?i.context=Oo(o):(o=Li(t)?Ri:Di.current,i.context=Oi(e,o)),i.state=e.memoizedState,"function"===typeof(o=t.getDerivedStateFromProps)&&(sa(e,t,o,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&aa.enqueueReplaceState(i,i.state,null),Ko(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function ha(e,t){try{var n="",r=t;do{n+=U(r),r=r.return}while(r);var i=n}catch(o){i="\nError generating stack: "+o.message+"\n"+o.stack}return{value:e,source:t,stack:i,digest:null}}function fa(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function pa(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var ga="function"===typeof WeakMap?WeakMap:Map;function ma(e,t,n){(n=$o(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Wl||(Wl=!0,Gl=r),pa(0,t)},n}function ya(e,t,n){(n=$o(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){pa(0,t)}}var o=e.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(n.callback=function(){pa(0,t),"function"!==typeof r&&(null===Ql?Ql=new Set([this]):Ql.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function va(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new ga;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=Cc.bind(null,e,t,n),t.then(e,e))}function ba(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function wa(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=$o(-1,1)).tag=2,Bo(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var xa=w.ReactCurrentOwner,Ia=!1;function Sa(e,t,n,r){t.child=null===e?_o(t,null,n,r):Eo(t,e.child,n,r)}function Ea(e,t,n,r,i){n=n.render;var o=t.ref;return Ro(t,i),r=bs(e,t,n,r,o,i),n=ws(),null===e||Ia?(ao&&n&&ro(t),t.flags|=1,Sa(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Wa(e,t,i))}function _a(e,t,n,r,i){if(null===e){var o=n.type;return"function"!==typeof o||Lc(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=jc(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,Ta(e,t,o,r,i))}if(o=e.child,0===(e.lanes&i)){var s=o.memoizedProps;if((n=null!==(n=n.compare)?n:dr)(s,r)&&e.ref===t.ref)return Wa(e,t,i)}return t.flags|=1,(e=Mc(o,r)).ref=t.ref,e.return=t,t.child=e}function Ta(e,t,n,r,i){if(null!==e){var o=e.memoizedProps;if(dr(o,r)&&e.ref===t.ref){if(Ia=!1,t.pendingProps=r=o,0===(e.lanes&i))return t.lanes=e.lanes,Wa(e,t,i);0!==(131072&e.flags)&&(Ia=!0)}}return Na(e,t,n,r,i)}function ka(e,t,n){var r=t.pendingProps,i=r.children,o=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ni(Ml,Ll),Ll|=n;else{if(0===(1073741824&n))return e=null!==o?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ni(Ml,Ll),Ll|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==o?o.baseLanes:n,Ni(Ml,Ll),Ll|=r}else null!==o?(r=o.baseLanes|n,t.memoizedState=null):r=n,Ni(Ml,Ll),Ll|=r;return Sa(e,t,i,n),t.child}function Ca(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Na(e,t,n,r,i){var o=Li(n)?Ri:Di.current;return o=Oi(t,o),Ro(t,i),n=bs(e,t,n,r,o,i),r=ws(),null===e||Ia?(ao&&r&&ro(t),t.flags|=1,Sa(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Wa(e,t,i))}function Aa(e,t,n,r,i){if(Li(n)){var o=!0;Fi(t)}else o=!1;if(Ro(t,i),null===t.stateNode)Ka(e,t),ca(t,n,r),da(t,n,r,i),r=!0;else if(null===e){var s=t.stateNode,a=t.memoizedProps;s.props=a;var l=s.context,c=n.contextType;"object"===typeof c&&null!==c?c=Oo(c):c=Oi(t,c=Li(n)?Ri:Di.current);var u=n.getDerivedStateFromProps,d="function"===typeof u||"function"===typeof s.getSnapshotBeforeUpdate;d||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(a!==r||l!==c)&&ua(t,s,r,c),Fo=!1;var h=t.memoizedState;s.state=h,Ko(t,r,s,i),l=t.memoizedState,a!==r||h!==l||Pi.current||Fo?("function"===typeof u&&(sa(t,n,u,r),l=t.memoizedState),(a=Fo||la(t,n,a,r,h,l,c))?(d||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),s.props=r,s.state=l,s.context=c,r=a):("function"===typeof s.componentDidMount&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,Uo(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:oa(t.type,a),s.props=c,d=t.pendingProps,h=s.context,"object"===typeof(l=n.contextType)&&null!==l?l=Oo(l):l=Oi(t,l=Li(n)?Ri:Di.current);var f=n.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(a!==d||h!==l)&&ua(t,s,r,l),Fo=!1,h=t.memoizedState,s.state=h,Ko(t,r,s,i);var p=t.memoizedState;a!==d||h!==p||Pi.current||Fo?("function"===typeof f&&(sa(t,n,f,r),p=t.memoizedState),(c=Fo||la(t,n,c,r,h,p,l)||!1)?(u||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(r,p,l),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,p,l)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),s.props=r,s.state=p,s.context=l,r=c):("function"!==typeof s.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return Da(e,t,n,r,o,i)}function Da(e,t,n,r,i,o){Ca(e,t);var s=0!==(128&t.flags);if(!r&&!s)return i&&Vi(t,n,!1),Wa(e,t,o);r=t.stateNode,xa.current=t;var a=s&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&s?(t.child=Eo(t,e.child,null,o),t.child=Eo(t,null,a,o)):Sa(e,t,a,o),t.memoizedState=r.state,i&&Vi(t,n,!0),t.child}function Pa(e){var t=e.stateNode;t.pendingContext?ji(0,t.pendingContext,t.pendingContext!==t.context):t.context&&ji(0,t.context,!1),Zo(e,t.containerInfo)}function Ra(e,t,n,r,i){return yo(),vo(i),t.flags|=256,Sa(e,t,n,r),t.child}var Oa,La,Ma,ja,za={dehydrated:null,treeContext:null,retryLane:0};function Fa(e){return{baseLanes:e,cachePool:null,transitions:null}}function Va(e,t,n){var r,i=t.pendingProps,s=rs.current,a=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&s)),r?(a=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),Ni(rs,1&s),null===e)return fo(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=i.children,e=i.fallback,a?(i=t.mode,a=t.child,l={mode:"hidden",children:l},0===(1&i)&&null!==a?(a.childLanes=0,a.pendingProps=l):a=Fc(l,i,0,null),e=zc(e,i,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Fa(n),t.memoizedState=za,e):Ua(t,l));if(null!==(s=e.memoizedState)&&null!==(r=s.dehydrated))return function(e,t,n,r,i,s,a){if(n)return 256&t.flags?(t.flags&=-257,$a(e,t,a,r=fa(Error(o(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(s=r.fallback,i=t.mode,r=Fc({mode:"visible",children:r.children},i,0,null),(s=zc(s,i,a,null)).flags|=2,r.return=t,s.return=t,r.sibling=s,t.child=r,0!==(1&t.mode)&&Eo(t,e.child,null,a),t.child.memoizedState=Fa(a),t.memoizedState=za,s);if(0===(1&t.mode))return $a(e,t,a,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var l=r.dgst;return r=l,$a(e,t,a,r=fa(s=Error(o(419)),r,void 0))}if(l=0!==(a&e.childLanes),Ia||l){if(null!==(r=Pl)){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|a))?0:i)&&i!==s.retryLane&&(s.retryLane=i,zo(e,i),oc(r,e,i,-1))}return vc(),$a(e,t,a,r=fa(Error(o(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=Ac.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,so=hi(i.nextSibling),oo=t,ao=!0,lo=null,null!==e&&(Yi[Xi++]=Zi,Yi[Xi++]=eo,Yi[Xi++]=Ji,Zi=e.id,eo=e.overflow,Ji=t),t=Ua(t,r.children),t.flags|=4096,t)}(e,t,l,i,r,s,n);if(a){a=i.fallback,l=t.mode,r=(s=e.child).sibling;var c={mode:"hidden",children:i.children};return 0===(1&l)&&t.child!==s?((i=t.child).childLanes=0,i.pendingProps=c,t.deletions=null):(i=Mc(s,c)).subtreeFlags=14680064&s.subtreeFlags,null!==r?a=Mc(r,a):(a=zc(a,l,n,null)).flags|=2,a.return=t,i.return=t,i.sibling=a,t.child=i,i=a,a=t.child,l=null===(l=e.child.memoizedState)?Fa(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=e.childLanes&~n,t.memoizedState=za,i}return e=(a=e.child).sibling,i=Mc(a,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function Ua(e,t){return(t=Fc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function $a(e,t,n,r){return null!==r&&vo(r),Eo(t,e.child,null,n),(e=Ua(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Ba(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Po(e.return,t,n)}function qa(e,t,n,r,i){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function Ha(e,t,n){var r=t.pendingProps,i=r.revealOrder,o=r.tail;if(Sa(e,t,r.children,n),0!==(2&(r=rs.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Ba(e,n,t);else if(19===e.tag)Ba(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ni(rs,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===is(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),qa(t,!1,i,n,o);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===is(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}qa(t,!0,n,null,o);break;case"together":qa(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ka(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Wa(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Fl|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(n=Mc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Mc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Ga(e,t){if(!ao)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Qa(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Ya(e,t,n){var r=t.pendingProps;switch(io(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qa(t),null;case 1:case 17:return Li(t.type)&&Mi(),Qa(t),null;case 3:return r=t.stateNode,es(),Ci(Pi),Ci(Di),ss(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(go(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==lo&&(cc(lo),lo=null))),La(e,t),Qa(t),null;case 5:ns(t);var i=Jo(Xo.current);if(n=t.type,null!==e&&null!=t.stateNode)Ma(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(o(166));return Qa(t),null}if(e=Jo(Qo.current),go(t)){r=t.stateNode,n=t.type;var s=t.memoizedProps;switch(r[gi]=t,r[mi]=s,e=0!==(1&t.mode),n){case"dialog":$r("cancel",r),$r("close",r);break;case"iframe":case"object":case"embed":$r("load",r);break;case"video":case"audio":for(i=0;i<zr.length;i++)$r(zr[i],r);break;case"source":$r("error",r);break;case"img":case"image":case"link":$r("error",r),$r("load",r);break;case"details":$r("toggle",r);break;case"input":Y(r,s),$r("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},$r("invalid",r);break;case"textarea":ie(r,s),$r("invalid",r)}for(var l in ve(n,s),i=null,s)if(s.hasOwnProperty(l)){var c=s[l];"children"===l?"string"===typeof c?r.textContent!==c&&(!0!==s.suppressHydrationWarning&&ti(r.textContent,c,e),i=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==s.suppressHydrationWarning&&ti(r.textContent,c,e),i=["children",""+c]):a.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&$r("scroll",r)}switch(n){case"input":K(r),Z(r,s,!0);break;case"textarea":K(r),se(r);break;case"select":case"option":break;default:"function"===typeof s.onClick&&(r.onclick=ni)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ae(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[gi]=t,e[mi]=r,Oa(e,t,!1,!1),t.stateNode=e;e:{switch(l=be(n,r),n){case"dialog":$r("cancel",e),$r("close",e),i=r;break;case"iframe":case"object":case"embed":$r("load",e),i=r;break;case"video":case"audio":for(i=0;i<zr.length;i++)$r(zr[i],e);i=r;break;case"source":$r("error",e),i=r;break;case"img":case"image":case"link":$r("error",e),$r("load",e),i=r;break;case"details":$r("toggle",e),i=r;break;case"input":Y(e,r),i=Q(e,r),$r("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=j({},r,{value:void 0}),$r("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),$r("invalid",e)}for(s in ve(n,i),c=i)if(c.hasOwnProperty(s)){var u=c[s];"style"===s?me(e,u):"dangerouslySetInnerHTML"===s?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===s?"string"===typeof u?("textarea"!==n||""!==u)&&he(e,u):"number"===typeof u&&he(e,""+u):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(a.hasOwnProperty(s)?null!=u&&"onScroll"===s&&$r("scroll",e):null!=u&&b(e,s,u,l))}switch(n){case"input":K(e),Z(e,r,!1);break;case"textarea":K(e),se(e);break;case"option":null!=r.value&&e.setAttribute("value",""+q(r.value));break;case"select":e.multiple=!!r.multiple,null!=(s=r.value)?ne(e,!!r.multiple,s,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=ni)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Qa(t),null;case 6:if(e&&null!=t.stateNode)ja(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(o(166));if(n=Jo(Xo.current),Jo(Qo.current),go(t)){if(r=t.stateNode,n=t.memoizedProps,r[gi]=t,(s=r.nodeValue!==n)&&null!==(e=oo))switch(e.tag){case 3:ti(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&ti(r.nodeValue,n,0!==(1&e.mode))}s&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[gi]=t,t.stateNode=r}return Qa(t),null;case 13:if(Ci(rs),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ao&&null!==so&&0!==(1&t.mode)&&0===(128&t.flags))mo(),yo(),t.flags|=98560,s=!1;else if(s=go(t),null!==r&&null!==r.dehydrated){if(null===e){if(!s)throw Error(o(318));if(!(s=null!==(s=t.memoizedState)?s.dehydrated:null))throw Error(o(317));s[gi]=t}else yo(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Qa(t),s=!1}else null!==lo&&(cc(lo),lo=null),s=!0;if(!s)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&rs.current)?0===jl&&(jl=3):vc())),null!==t.updateQueue&&(t.flags|=4),Qa(t),null);case 4:return es(),La(e,t),null===e&&Hr(t.stateNode.containerInfo),Qa(t),null;case 10:return Do(t.type._context),Qa(t),null;case 19:if(Ci(rs),null===(s=t.memoizedState))return Qa(t),null;if(r=0!==(128&t.flags),null===(l=s.rendering))if(r)Ga(s,!1);else{if(0!==jl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=is(e))){for(t.flags|=128,Ga(s,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(s=n).flags&=14680066,null===(l=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,e=l.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ni(rs,1&rs.current|2),t.child}e=e.sibling}null!==s.tail&&Xe()>Hl&&(t.flags|=128,r=!0,Ga(s,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=is(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Ga(s,!0),null===s.tail&&"hidden"===s.tailMode&&!l.alternate&&!ao)return Qa(t),null}else 2*Xe()-s.renderingStartTime>Hl&&1073741824!==n&&(t.flags|=128,r=!0,Ga(s,!1),t.lanes=4194304);s.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=s.last)?n.sibling=l:t.child=l,s.last=l)}return null!==s.tail?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Xe(),t.sibling=null,n=rs.current,Ni(rs,r?1&n|2:1&n),t):(Qa(t),null);case 22:case 23:return pc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Ll)&&(Qa(t),6&t.subtreeFlags&&(t.flags|=8192)):Qa(t),null;case 24:case 25:return null}throw Error(o(156,t.tag))}function Xa(e,t){switch(io(t),t.tag){case 1:return Li(t.type)&&Mi(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return es(),Ci(Pi),Ci(Di),ss(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return ns(t),null;case 13:if(Ci(rs),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(o(340));yo()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ci(rs),null;case 4:return es(),null;case 10:return Do(t.type._context),null;case 22:case 23:return pc(),null;default:return null}}Oa=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},La=function(){},Ma=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Jo(Qo.current);var o,s=null;switch(n){case"input":i=Q(e,i),r=Q(e,r),s=[];break;case"select":i=j({},i,{value:void 0}),r=j({},r,{value:void 0}),s=[];break;case"textarea":i=re(e,i),r=re(e,r),s=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=ni)}for(u in ve(n,r),n=null,i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&null!=i[u])if("style"===u){var l=i[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(a.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var c=r[u];if(l=null!=i?i[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(s||(s=[]),s.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(s=s||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(s=s||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(a.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&$r("scroll",e),s||l===c||(s=[])):(s=s||[]).push(u,c))}n&&(s=s||[]).push("style",n);var u=s;(t.updateQueue=u)&&(t.flags|=4)}},ja=function(e,t,n,r){n!==r&&(t.flags|=4)};var Ja=!1,Za=!1,el="function"===typeof WeakSet?WeakSet:Set,tl=null;function nl(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){kc(e,t,r)}else n.current=null}function rl(e,t,n){try{n()}catch(r){kc(e,t,r)}}var il=!1;function ol(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var o=i.destroy;i.destroy=void 0,void 0!==o&&rl(t,n,o)}i=i.next}while(i!==r)}}function sl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function al(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function ll(e){var t=e.alternate;null!==t&&(e.alternate=null,ll(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[gi],delete t[mi],delete t[vi],delete t[bi],delete t[wi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function cl(e){return 5===e.tag||3===e.tag||4===e.tag}function ul(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||cl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function dl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=ni));else if(4!==r&&null!==(e=e.child))for(dl(e,t,n),e=e.sibling;null!==e;)dl(e,t,n),e=e.sibling}function hl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(hl(e,t,n),e=e.sibling;null!==e;)hl(e,t,n),e=e.sibling}var fl=null,pl=!1;function gl(e,t,n){for(n=n.child;null!==n;)ml(e,t,n),n=n.sibling}function ml(e,t,n){if(ot&&"function"===typeof ot.onCommitFiberUnmount)try{ot.onCommitFiberUnmount(it,n)}catch(a){}switch(n.tag){case 5:Za||nl(n,t);case 6:var r=fl,i=pl;fl=null,gl(e,t,n),pl=i,null!==(fl=r)&&(pl?(e=fl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):fl.removeChild(n.stateNode));break;case 18:null!==fl&&(pl?(e=fl,n=n.stateNode,8===e.nodeType?di(e.parentNode,n):1===e.nodeType&&di(e,n),Bt(e)):di(fl,n.stateNode));break;case 4:r=fl,i=pl,fl=n.stateNode.containerInfo,pl=!0,gl(e,t,n),fl=r,pl=i;break;case 0:case 11:case 14:case 15:if(!Za&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var o=i,s=o.destroy;o=o.tag,void 0!==s&&(0!==(2&o)||0!==(4&o))&&rl(n,t,s),i=i.next}while(i!==r)}gl(e,t,n);break;case 1:if(!Za&&(nl(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){kc(n,t,a)}gl(e,t,n);break;case 21:gl(e,t,n);break;case 22:1&n.mode?(Za=(r=Za)||null!==n.memoizedState,gl(e,t,n),Za=r):gl(e,t,n);break;default:gl(e,t,n)}}function yl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new el),t.forEach((function(t){var r=Dc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function vl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var s=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 5:fl=l.stateNode,pl=!1;break e;case 3:case 4:fl=l.stateNode.containerInfo,pl=!0;break e}l=l.return}if(null===fl)throw Error(o(160));ml(s,a,i),fl=null,pl=!1;var c=i.alternate;null!==c&&(c.return=null),i.return=null}catch(u){kc(i,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)bl(t,e),t=t.sibling}function bl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(vl(t,e),wl(e),4&r){try{ol(3,e,e.return),sl(3,e)}catch(m){kc(e,e.return,m)}try{ol(5,e,e.return)}catch(m){kc(e,e.return,m)}}break;case 1:vl(t,e),wl(e),512&r&&null!==n&&nl(n,n.return);break;case 5:if(vl(t,e),wl(e),512&r&&null!==n&&nl(n,n.return),32&e.flags){var i=e.stateNode;try{he(i,"")}catch(m){kc(e,e.return,m)}}if(4&r&&null!=(i=e.stateNode)){var s=e.memoizedProps,a=null!==n?n.memoizedProps:s,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===s.type&&null!=s.name&&X(i,s),be(l,a);var u=be(l,s);for(a=0;a<c.length;a+=2){var d=c[a],h=c[a+1];"style"===d?me(i,h):"dangerouslySetInnerHTML"===d?de(i,h):"children"===d?he(i,h):b(i,d,h,u)}switch(l){case"input":J(i,s);break;case"textarea":oe(i,s);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var p=s.value;null!=p?ne(i,!!s.multiple,p,!1):f!==!!s.multiple&&(null!=s.defaultValue?ne(i,!!s.multiple,s.defaultValue,!0):ne(i,!!s.multiple,s.multiple?[]:"",!1))}i[mi]=s}catch(m){kc(e,e.return,m)}}break;case 6:if(vl(t,e),wl(e),4&r){if(null===e.stateNode)throw Error(o(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(m){kc(e,e.return,m)}}break;case 3:if(vl(t,e),wl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Bt(t.containerInfo)}catch(m){kc(e,e.return,m)}break;case 4:default:vl(t,e),wl(e);break;case 13:vl(t,e),wl(e),8192&(i=e.child).flags&&(s=null!==i.memoizedState,i.stateNode.isHidden=s,!s||null!==i.alternate&&null!==i.alternate.memoizedState||(ql=Xe())),4&r&&yl(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Za=(u=Za)||d,vl(t,e),Za=u):vl(t,e),wl(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&0!==(1&e.mode))for(tl=e,d=e.child;null!==d;){for(h=tl=d;null!==tl;){switch(p=(f=tl).child,f.tag){case 0:case 11:case 14:case 15:ol(4,f,f.return);break;case 1:nl(f,f.return);var g=f.stateNode;if("function"===typeof g.componentWillUnmount){r=f,n=f.return;try{t=r,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(m){kc(r,n,m)}}break;case 5:nl(f,f.return);break;case 22:if(null!==f.memoizedState){El(h);continue}}null!==p?(p.return=f,tl=p):El(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{i=h.stateNode,u?"function"===typeof(s=i.style).setProperty?s.setProperty("display","none","important"):s.display="none":(l=h.stateNode,a=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=ge("display",a))}catch(m){kc(e,e.return,m)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(m){kc(e,e.return,m)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:vl(t,e),wl(e),4&r&&yl(e);case 21:}}function wl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(cl(n)){var r=n;break e}n=n.return}throw Error(o(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(he(i,""),r.flags&=-33),hl(e,ul(e),i);break;case 3:case 4:var s=r.stateNode.containerInfo;dl(e,ul(e),s);break;default:throw Error(o(161))}}catch(Ln){kc(e,e.return,Ln)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function xl(e,t,n){tl=e,Il(e,t,n)}function Il(e,t,n){for(var r=0!==(1&e.mode);null!==tl;){var i=tl,o=i.child;if(22===i.tag&&r){var s=null!==i.memoizedState||Ja;if(!s){var a=i.alternate,l=null!==a&&null!==a.memoizedState||Za;a=Ja;var c=Za;if(Ja=s,(Za=l)&&!c)for(tl=i;null!==tl;)l=(s=tl).child,22===s.tag&&null!==s.memoizedState?_l(i):null!==l?(l.return=s,tl=l):_l(i);for(;null!==o;)tl=o,Il(o,t,n),o=o.sibling;tl=i,Ja=a,Za=c}Sl(e)}else 0!==(8772&i.subtreeFlags)&&null!==o?(o.return=i,tl=o):Sl(e)}}function Sl(e){for(;null!==tl;){var t=tl;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Za||sl(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Za)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:oa(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&Wo(t,s,r);break;case 3:var a=t.updateQueue;if(null!==a){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Wo(t,a,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&Bt(h)}}}break;default:throw Error(o(163))}Za||512&t.flags&&al(t)}catch(f){kc(t,t.return,f)}}if(t===e){tl=null;break}if(null!==(n=t.sibling)){n.return=t.return,tl=n;break}tl=t.return}}function El(e){for(;null!==tl;){var t=tl;if(t===e){tl=null;break}var n=t.sibling;if(null!==n){n.return=t.return,tl=n;break}tl=t.return}}function _l(e){for(;null!==tl;){var t=tl;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{sl(4,t)}catch(Ln){kc(t,n,Ln)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(Ln){kc(t,i,Ln)}}var o=t.return;try{al(t)}catch(Ln){kc(t,o,Ln)}break;case 5:var s=t.return;try{al(t)}catch(Ln){kc(t,s,Ln)}}}catch(Ln){kc(t,t.return,Ln)}if(t===e){tl=null;break}var a=t.sibling;if(null!==a){a.return=t.return,tl=a;break}tl=t.return}}var Tl,kl=Math.ceil,Cl=w.ReactCurrentDispatcher,Nl=w.ReactCurrentOwner,Al=w.ReactCurrentBatchConfig,Dl=0,Pl=null,Rl=null,Ol=0,Ll=0,Ml=ki(0),jl=0,zl=null,Fl=0,Vl=0,Ul=0,$l=null,Bl=null,ql=0,Hl=1/0,Kl=null,Wl=!1,Gl=null,Ql=null,Yl=!1,Xl=null,Jl=0,Zl=0,ec=null,tc=-1,nc=0;function rc(){return 0!==(6&Dl)?Xe():-1!==tc?tc:tc=Xe()}function ic(e){return 0===(1&e.mode)?1:0!==(2&Dl)&&0!==Ol?Ol&-Ol:null!==bo.transition?(0===nc&&(nc=gt()),nc):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Xt(e.type)}function oc(e,t,n,r){if(50<Zl)throw Zl=0,ec=null,Error(o(185));yt(e,n,r),0!==(2&Dl)&&e===Pl||(e===Pl&&(0===(2&Dl)&&(Vl|=n),4===jl&&uc(e,Ol)),sc(e,r),1===n&&0===Dl&&0===(1&t.mode)&&(Hl=Xe()+500,$i&&Hi()))}function sc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,o=e.pendingLanes;0<o;){var s=31-st(o),a=1<<s,l=i[s];-1===l?0!==(a&n)&&0===(a&r)||(i[s]=ft(a,t)):l<=t&&(e.expiredLanes|=a),o&=~a}}(e,t);var r=ht(e,e===Pl?Ol:0);if(0===r)null!==n&&Ge(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Ge(n),1===t)0===e.tag?function(e){$i=!0,qi(e)}(dc.bind(null,e)):qi(dc.bind(null,e)),ci((function(){0===(6&Dl)&&Hi()})),n=null;else{switch(wt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Pc(n,ac.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ac(e,t){if(tc=-1,nc=0,0!==(6&Dl))throw Error(o(327));var n=e.callbackNode;if(_c()&&e.callbackNode!==n)return null;var r=ht(e,e===Pl?Ol:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=bc(e,r);else{t=r;var i=Dl;Dl|=2;var s=yc();for(Pl===e&&Ol===t||(Kl=null,Hl=Xe()+500,gc(e,t));;)try{xc();break}catch(l){mc(e,l)}Ao(),Cl.current=s,Dl=i,null!==Rl?t=0:(Pl=null,Ol=0,t=jl)}if(0!==t){if(2===t&&(0!==(i=pt(e))&&(r=i,t=lc(e,i))),1===t)throw n=zl,gc(e,0),uc(e,r),sc(e,Xe()),n;if(6===t)uc(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!ur(o(),i))return!1}catch(a){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=bc(e,r))&&(0!==(s=pt(e))&&(r=s,t=lc(e,s))),1===t))throw n=zl,gc(e,0),uc(e,r),sc(e,Xe()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(o(345));case 2:case 5:Ec(e,Bl,Kl);break;case 3:if(uc(e,r),(130023424&r)===r&&10<(t=ql+500-Xe())){if(0!==ht(e,0))break;if(((i=e.suspendedLanes)&r)!==r){rc(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=si(Ec.bind(null,e,Bl,Kl),t);break}Ec(e,Bl,Kl);break;case 4:if(uc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var a=31-st(r);s=1<<a,(a=t[a])>i&&(i=a),r&=~s}if(r=i,10<(r=(120>(r=Xe()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*kl(r/1960))-r)){e.timeoutHandle=si(Ec.bind(null,e,Bl,Kl),r);break}Ec(e,Bl,Kl);break;default:throw Error(o(329))}}}return sc(e,Xe()),e.callbackNode===n?ac.bind(null,e):null}function lc(e,t){var n=$l;return e.current.memoizedState.isDehydrated&&(gc(e,t).flags|=256),2!==(e=bc(e,t))&&(t=Bl,Bl=n,null!==t&&cc(t)),e}function cc(e){null===Bl?Bl=e:Bl.push.apply(Bl,e)}function uc(e,t){for(t&=~Ul,t&=~Vl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-st(t),r=1<<n;e[n]=-1,t&=~r}}function dc(e){if(0!==(6&Dl))throw Error(o(327));_c();var t=ht(e,0);if(0===(1&t))return sc(e,Xe()),null;var n=bc(e,t);if(0!==e.tag&&2===n){var r=pt(e);0!==r&&(t=r,n=lc(e,r))}if(1===n)throw n=zl,gc(e,0),uc(e,t),sc(e,Xe()),n;if(6===n)throw Error(o(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ec(e,Bl,Kl),sc(e,Xe()),null}function hc(e,t){var n=Dl;Dl|=1;try{return e(t)}finally{0===(Dl=n)&&(Hl=Xe()+500,$i&&Hi())}}function fc(e){null!==Xl&&0===Xl.tag&&0===(6&Dl)&&_c();var t=Dl;Dl|=1;var n=Al.transition,r=bt;try{if(Al.transition=null,bt=1,e)return e()}finally{bt=r,Al.transition=n,0===(6&(Dl=t))&&Hi()}}function pc(){Ll=Ml.current,Ci(Ml)}function gc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ai(n)),null!==Rl)for(n=Rl.return;null!==n;){var r=n;switch(io(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Mi();break;case 3:es(),Ci(Pi),Ci(Di),ss();break;case 5:ns(r);break;case 4:es();break;case 13:case 19:Ci(rs);break;case 10:Do(r.type._context);break;case 22:case 23:pc()}n=n.return}if(Pl=e,Rl=e=Mc(e.current,null),Ol=Ll=t,jl=0,zl=null,Ul=Vl=Fl=0,Bl=$l=null,null!==Lo){for(t=0;t<Lo.length;t++)if(null!==(r=(n=Lo[t]).interleaved)){n.interleaved=null;var i=r.next,o=n.pending;if(null!==o){var s=o.next;o.next=i,r.next=s}n.pending=r}Lo=null}return e}function mc(e,t){for(;;){var n=Rl;try{if(Ao(),as.current=ta,fs){for(var r=us.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}fs=!1}if(cs=0,hs=ds=us=null,ps=!1,gs=0,Nl.current=null,null===n||null===n.return){jl=1,zl=t,Rl=null;break}e:{var s=e,a=n.return,l=n,c=t;if(t=Ol,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,d=l,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=ba(a);if(null!==p){p.flags&=-257,wa(p,a,l,0,t),1&p.mode&&va(s,u,t),c=u;var g=(t=p).updateQueue;if(null===g){var m=new Set;m.add(c),t.updateQueue=m}else g.add(c);break e}if(0===(1&t)){va(s,u,t),vc();break e}c=Error(o(426))}else if(ao&&1&l.mode){var y=ba(a);if(null!==y){0===(65536&y.flags)&&(y.flags|=256),wa(y,a,l,0,t),vo(ha(c,l));break e}}s=c=ha(c,l),4!==jl&&(jl=2),null===$l?$l=[s]:$l.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t,Ho(s,ma(0,c,t));break e;case 1:l=c;var v=s.type,b=s.stateNode;if(0===(128&s.flags)&&("function"===typeof v.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Ql||!Ql.has(b)))){s.flags|=65536,t&=-t,s.lanes|=t,Ho(s,ya(s,l,t));break e}}s=s.return}while(null!==s)}Sc(n)}catch(w){t=w,Rl===n&&null!==n&&(Rl=n=n.return);continue}break}}function yc(){var e=Cl.current;return Cl.current=ta,null===e?ta:e}function vc(){0!==jl&&3!==jl&&2!==jl||(jl=4),null===Pl||0===(268435455&Fl)&&0===(268435455&Vl)||uc(Pl,Ol)}function bc(e,t){var n=Dl;Dl|=2;var r=yc();for(Pl===e&&Ol===t||(Kl=null,gc(e,t));;)try{wc();break}catch(i){mc(e,i)}if(Ao(),Dl=n,Cl.current=r,null!==Rl)throw Error(o(261));return Pl=null,Ol=0,jl}function wc(){for(;null!==Rl;)Ic(Rl)}function xc(){for(;null!==Rl&&!Qe();)Ic(Rl)}function Ic(e){var t=Tl(e.alternate,e,Ll);e.memoizedProps=e.pendingProps,null===t?Sc(e):Rl=t,Nl.current=null}function Sc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ya(n,t,Ll)))return void(Rl=n)}else{if(null!==(n=Xa(n,t)))return n.flags&=32767,void(Rl=n);if(null===e)return jl=6,void(Rl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Rl=t);Rl=t=e}while(null!==t);0===jl&&(jl=5)}function Ec(e,t,n){var r=bt,i=Al.transition;try{Al.transition=null,bt=1,function(e,t,n,r){do{_c()}while(null!==Xl);if(0!==(6&Dl))throw Error(o(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(o(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-st(n),o=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~o}}(e,s),e===Pl&&(Rl=Pl=null,Ol=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Yl||(Yl=!0,Pc(tt,(function(){return _c(),null}))),s=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||s){s=Al.transition,Al.transition=null;var a=bt;bt=1;var l=Dl;Dl|=4,Nl.current=null,function(e,t){if(ri=Ht,mr(e=gr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch(tn){n=null;break e}var a=0,l=-1,c=-1,u=0,d=0,h=e,f=null;t:for(;;){for(var p;h!==n||0!==i&&3!==h.nodeType||(l=a+i),h!==s||0!==r&&3!==h.nodeType||(c=a+r),3===h.nodeType&&(a+=h.nodeValue.length),null!==(p=h.firstChild);)f=h,h=p;for(;;){if(h===e)break t;if(f===n&&++u===i&&(l=a),f===s&&++d===r&&(c=a),null!==(p=h.nextSibling))break;f=(h=f).parentNode}h=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ii={focusedElem:e,selectionRange:n},Ht=!1,tl=t;null!==tl;)if(e=(t=tl).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,tl=e;else for(;null!==tl;){t=tl;try{var g=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==g){var m=g.memoizedProps,y=g.memoizedState,v=t.stateNode,b=v.getSnapshotBeforeUpdate(t.elementType===t.type?m:oa(t.type,m),y);v.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=t.stateNode.containerInfo;1===w.nodeType?w.textContent="":9===w.nodeType&&w.documentElement&&w.removeChild(w.documentElement);break;default:throw Error(o(163))}}catch(tn){kc(t,t.return,tn)}if(null!==(e=t.sibling)){e.return=t.return,tl=e;break}tl=t.return}g=il,il=!1}(e,n),bl(n,e),yr(ii),Ht=!!ri,ii=ri=null,e.current=n,xl(n,e,i),Ye(),Dl=l,bt=a,Al.transition=s}else e.current=n;if(Yl&&(Yl=!1,Xl=e,Jl=i),s=e.pendingLanes,0===s&&(Ql=null),function(e){if(ot&&"function"===typeof ot.onCommitFiberRoot)try{ot.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),sc(e,Xe()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Wl)throw Wl=!1,e=Gl,Gl=null,e;0!==(1&Jl)&&0!==e.tag&&_c(),s=e.pendingLanes,0!==(1&s)?e===ec?Zl++:(Zl=0,ec=e):Zl=0,Hi()}(e,t,n,r)}finally{Al.transition=i,bt=r}return null}function _c(){if(null!==Xl){var e=wt(Jl),t=Al.transition,n=bt;try{if(Al.transition=null,bt=16>e?16:e,null===Xl)var r=!1;else{if(e=Xl,Xl=null,Jl=0,0!==(6&Dl))throw Error(o(331));var i=Dl;for(Dl|=4,tl=e.current;null!==tl;){var s=tl,a=s.child;if(0!==(16&tl.flags)){var l=s.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(tl=u;null!==tl;){var d=tl;switch(d.tag){case 0:case 11:case 15:ol(8,d,s)}var h=d.child;if(null!==h)h.return=d,tl=h;else for(;null!==tl;){var f=(d=tl).sibling,p=d.return;if(ll(d),d===u){tl=null;break}if(null!==f){f.return=p,tl=f;break}tl=p}}}var g=s.alternate;if(null!==g){var m=g.child;if(null!==m){g.child=null;do{var y=m.sibling;m.sibling=null,m=y}while(null!==m)}}tl=s}}if(0!==(2064&s.subtreeFlags)&&null!==a)a.return=s,tl=a;else e:for(;null!==tl;){if(0!==(2048&(s=tl).flags))switch(s.tag){case 0:case 11:case 15:ol(9,s,s.return)}var v=s.sibling;if(null!==v){v.return=s.return,tl=v;break e}tl=s.return}}var b=e.current;for(tl=b;null!==tl;){var w=(a=tl).child;if(0!==(2064&a.subtreeFlags)&&null!==w)w.return=a,tl=w;else e:for(a=b;null!==tl;){if(0!==(2048&(l=tl).flags))try{switch(l.tag){case 0:case 11:case 15:sl(9,l)}}catch(I){kc(l,l.return,I)}if(l===a){tl=null;break e}var x=l.sibling;if(null!==x){x.return=l.return,tl=x;break e}tl=l.return}}if(Dl=i,Hi(),ot&&"function"===typeof ot.onPostCommitFiberRoot)try{ot.onPostCommitFiberRoot(it,e)}catch(I){}r=!0}return r}finally{bt=n,Al.transition=t}}return!1}function Tc(e,t,n){e=Bo(e,t=ma(0,t=ha(n,t),1),1),t=rc(),null!==e&&(yt(e,1,t),sc(e,t))}function kc(e,t,n){if(3===e.tag)Tc(e,e,n);else for(;null!==t;){if(3===t.tag){Tc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Ql||!Ql.has(r))){t=Bo(t,e=ya(t,e=ha(n,e),1),1),e=rc(),null!==t&&(yt(t,1,e),sc(t,e));break}}t=t.return}}function Cc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=rc(),e.pingedLanes|=e.suspendedLanes&n,Pl===e&&(Ol&n)===n&&(4===jl||3===jl&&(130023424&Ol)===Ol&&500>Xe()-ql?gc(e,0):Ul|=n),sc(e,t)}function Nc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=rc();null!==(e=zo(e,t))&&(yt(e,t,n),sc(e,n))}function Ac(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Nc(e,n)}function Dc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(o(314))}null!==r&&r.delete(t),Nc(e,n)}function Pc(e,t){return We(e,t)}function Rc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Oc(e,t,n,r){return new Rc(e,t,n,r)}function Lc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Mc(e,t){var n=e.alternate;return null===n?((n=Oc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function jc(e,t,n,r,i,s){var a=2;if(r=e,"function"===typeof e)Lc(e)&&(a=1);else if("string"===typeof e)a=5;else e:switch(e){case S:return zc(n.children,i,s,t);case E:a=8,i|=8;break;case _:return(e=Oc(12,n,t,2|i)).elementType=_,e.lanes=s,e;case N:return(e=Oc(13,n,t,i)).elementType=N,e.lanes=s,e;case A:return(e=Oc(19,n,t,i)).elementType=A,e.lanes=s,e;case R:return Fc(n,i,s,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case T:a=10;break e;case k:a=9;break e;case C:a=11;break e;case D:a=14;break e;case P:a=16,r=null;break e}throw Error(o(130,null==e?e:typeof e,""))}return(t=Oc(a,n,t,i)).elementType=e,t.type=r,t.lanes=s,t}function zc(e,t,n,r){return(e=Oc(7,e,r,t)).lanes=n,e}function Fc(e,t,n,r){return(e=Oc(22,e,r,t)).elementType=R,e.lanes=n,e.stateNode={isHidden:!1},e}function Vc(e,t,n){return(e=Oc(6,e,null,t)).lanes=n,e}function Uc(e,t,n){return(t=Oc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function $c(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mt(0),this.expirationTimes=mt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Bc(e,t,n,r,i,o,s,a,l){return e=new $c(e,t,n,a,l),1===t?(t=1,!0===o&&(t|=8)):t=0,o=Oc(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Vo(o),e}function qc(e){if(!e)return Ai;e:{if($e(e=e._reactInternals)!==e||1!==e.tag)throw Error(o(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Li(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(o(171))}if(1===e.tag){var n=e.type;if(Li(n))return zi(e,n,t)}return t}function Hc(e,t,n,r,i,o,s,a,l){return(e=Bc(n,r,!0,e,0,o,0,a,l)).context=qc(null),n=e.current,(o=$o(r=rc(),i=ic(n))).callback=void 0!==t&&null!==t?t:null,Bo(n,o,i),e.current.lanes=i,yt(e,i,r),sc(e,r),e}function Kc(e,t,n,r){var i=t.current,o=rc(),s=ic(i);return n=qc(n),null===t.context?t.context=n:t.pendingContext=n,(t=$o(o,s)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Bo(i,t,s))&&(oc(e,i,s,o),qo(e,i,s)),s}function Wc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Gc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Qc(e,t){Gc(e,t),(e=e.alternate)&&Gc(e,t)}Tl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Pi.current)Ia=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return Ia=!1,function(e,t,n){switch(t.tag){case 3:Pa(t),yo();break;case 5:ts(t);break;case 1:Li(t.type)&&Fi(t);break;case 4:Zo(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Ni(To,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ni(rs,1&rs.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Va(e,t,n):(Ni(rs,1&rs.current),null!==(e=Wa(e,t,n))?e.sibling:null);Ni(rs,1&rs.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Ha(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ni(rs,rs.current),r)break;return null;case 22:case 23:return t.lanes=0,ka(e,t,n)}return Wa(e,t,n)}(e,t,n);Ia=0!==(131072&e.flags)}else Ia=!1,ao&&0!==(1048576&t.flags)&&no(t,Qi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ka(e,t),e=t.pendingProps;var i=Oi(t,Di.current);Ro(t,n),i=bs(null,t,r,e,i,n);var s=ws();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Li(r)?(s=!0,Fi(t)):s=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,Vo(t),i.updater=aa,t.stateNode=i,i._reactInternals=t,da(t,r,e,n),t=Da(null,t,r,!0,s,n)):(t.tag=0,ao&&s&&ro(t),Sa(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ka(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return Lc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===C)return 11;if(e===D)return 14}return 2}(r),e=oa(r,e),i){case 0:t=Na(null,t,r,e,n);break e;case 1:t=Aa(null,t,r,e,n);break e;case 11:t=Ea(null,t,r,e,n);break e;case 14:t=_a(null,t,r,oa(r.type,e),n);break e}throw Error(o(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,Na(e,t,r,i=t.elementType===r?i:oa(r,i),n);case 1:return r=t.type,i=t.pendingProps,Aa(e,t,r,i=t.elementType===r?i:oa(r,i),n);case 3:e:{if(Pa(t),null===e)throw Error(o(387));r=t.pendingProps,i=(s=t.memoizedState).element,Uo(e,t),Ko(t,r,null,n);var a=t.memoizedState;if(r=a.element,s.isDehydrated){if(s={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Ra(e,t,r,n,i=ha(Error(o(423)),t));break e}if(r!==i){t=Ra(e,t,r,n,i=ha(Error(o(424)),t));break e}for(so=hi(t.stateNode.containerInfo.firstChild),oo=t,ao=!0,lo=null,n=_o(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(yo(),r===i){t=Wa(e,t,n);break e}Sa(e,t,r,n)}t=t.child}return t;case 5:return ts(t),null===e&&fo(t),r=t.type,i=t.pendingProps,s=null!==e?e.memoizedProps:null,a=i.children,oi(r,i)?a=null:null!==s&&oi(r,s)&&(t.flags|=32),Ca(e,t),Sa(e,t,a,n),t.child;case 6:return null===e&&fo(t),null;case 13:return Va(e,t,n);case 4:return Zo(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Eo(t,null,r,n):Sa(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,Ea(e,t,r,i=t.elementType===r?i:oa(r,i),n);case 7:return Sa(e,t,t.pendingProps,n),t.child;case 8:case 12:return Sa(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,s=t.memoizedProps,a=i.value,Ni(To,r._currentValue),r._currentValue=a,null!==s)if(ur(s.value,a)){if(s.children===i.children&&!Pi.current){t=Wa(e,t,n);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var l=s.dependencies;if(null!==l){a=s.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===s.tag){(c=$o(-1,n&-n)).tag=2;var u=s.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}s.lanes|=n,null!==(c=s.alternate)&&(c.lanes|=n),Po(s.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===s.tag)a=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(a=s.return))throw Error(o(341));a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),Po(a,n,t),a=s.sibling}else a=s.child;if(null!==a)a.return=s;else for(a=s;null!==a;){if(a===t){a=null;break}if(null!==(s=a.sibling)){s.return=a.return,a=s;break}a=a.return}s=a}Sa(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Ro(t,n),r=r(i=Oo(i)),t.flags|=1,Sa(e,t,r,n),t.child;case 14:return i=oa(r=t.type,t.pendingProps),_a(e,t,r,i=oa(r.type,i),n);case 15:return Ta(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:oa(r,i),Ka(e,t),t.tag=1,Li(r)?(e=!0,Fi(t)):e=!1,Ro(t,n),ca(t,r,i),da(t,r,i,n),Da(null,t,r,!0,e,n);case 19:return Ha(e,t,n);case 22:return ka(e,t,n)}throw Error(o(156,t.tag))};var Yc="function"===typeof reportError?reportError:function(e){console.error(e)};function Xc(e){this._internalRoot=e}function Jc(e){this._internalRoot=e}function Zc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function eu(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function tu(){}function nu(e,t,n,r,i){var o=n._reactRootContainer;if(o){var s=o;if("function"===typeof i){var a=i;i=function(){var e=Wc(s);a.call(e)}}Kc(t,s,e,i)}else s=function(e,t,n,r,i){if(i){if("function"===typeof r){var o=r;r=function(){var e=Wc(s);o.call(e)}}var s=Hc(t,r,e,0,null,!1,0,"",tu);return e._reactRootContainer=s,e[yi]=s.current,Hr(8===e.nodeType?e.parentNode:e),fc(),s}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof r){var a=r;r=function(){var e=Wc(l);a.call(e)}}var l=Bc(e,0,!1,null,0,!1,0,"",tu);return e._reactRootContainer=l,e[yi]=l.current,Hr(8===e.nodeType?e.parentNode:e),fc((function(){Kc(t,l,n,r)})),l}(n,t,e,i,r);return Wc(s)}Jc.prototype.render=Xc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(o(409));Kc(e,t,null,null)},Jc.prototype.unmount=Xc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;fc((function(){Kc(null,e,null,null)})),t[yi]=null}},Jc.prototype.unstable_scheduleHydration=function(e){if(e){var t=_t();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ot.length&&0!==t&&t<Ot[n].priority;n++);Ot.splice(n,0,e),0===n&&zt(e)}},xt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(vt(t,1|n),sc(t,Xe()),0===(6&Dl)&&(Hl=Xe()+500,Hi()))}break;case 13:fc((function(){var t=zo(e,1);if(null!==t){var n=rc();oc(t,e,1,n)}})),Qc(e,1)}},It=function(e){if(13===e.tag){var t=zo(e,134217728);if(null!==t)oc(t,e,134217728,rc());Qc(e,134217728)}},Et=function(e){if(13===e.tag){var t=ic(e),n=zo(e,t);if(null!==n)oc(n,e,t,rc());Qc(e,t)}},_t=function(){return bt},Tt=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},Ie=function(e,t,n){switch(t){case"input":if(J(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=Ei(r);if(!i)throw Error(o(90));W(r),J(r,i)}}}break;case"textarea":oe(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ce=hc,Ne=fc;var ru={usingClientEntryPoint:!1,Events:[Ii,Si,Ei,Te,ke,hc]},iu={findFiberByHostInstance:xi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ou={bundleType:iu.bundleType,version:iu.version,rendererPackageName:iu.rendererPackageName,rendererConfig:iu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=He(e))?null:e.stateNode},findFiberByHostInstance:iu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var su=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!su.isDisabled&&su.supportsFiber)try{it=su.inject(ou),ot=su}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ru,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Zc(t))throw Error(o(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:I,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Zc(e))throw Error(o(299));var n=!1,r="",i=Yc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=Bc(e,1,!1,null,0,n,0,r,i),e[yi]=t.current,Hr(8===e.nodeType?e.parentNode:e),new Xc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(o(188));throw e=Object.keys(e).join(","),Error(o(268,e))}return e=null===(e=He(t))?null:e.stateNode},t.flushSync=function(e){return fc(e)},t.hydrate=function(e,t,n){if(!eu(t))throw Error(o(200));return nu(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Zc(e))throw Error(o(405));var r=null!=n&&n.hydratedSources||null,i=!1,s="",a=Yc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(s=n.identifierPrefix),void 0!==n.onRecoverableError&&(a=n.onRecoverableError)),t=Hc(t,null,e,1,null!=n?n:null,i,0,s,a),e[yi]=t.current,Hr(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Jc(t)},t.render=function(e,t,n){if(!eu(t))throw Error(o(200));return nu(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!eu(e))throw Error(o(40));return!!e._reactRootContainer&&(fc((function(){nu(null,null,e,!1,(function(){e._reactRootContainer=null,e[yi]=null}))})),!0)},t.unstable_batchedUpdates=hc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!eu(n))throw Error(o(200));if(null==e||void 0===e._reactInternals)throw Error(o(38));return nu(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},853:(e,t,n)=>{e.exports=n(234)},950:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.m=e,n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,r)=>(n.f[r](e,t),t)),[])),n.u=e=>"static/js/"+e+".4b8be825.chunk.js",n.miniCssF=e=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="asignacion-plazas:";n.l=(r,i,o,s)=>{if(e[r])e[r].push(i);else{var a,l;if(void 0!==o)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==r||d.getAttribute("data-webpack")==t+o){a=d;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,n.nc&&a.setAttribute("nonce",n.nc),a.setAttribute("data-webpack",t+o),a.src=r),e[r]=[i];var h=(t,n)=>{a.onerror=a.onload=null,clearTimeout(f);var i=e[r];if(delete e[r],a.parentNode&&a.parentNode.removeChild(a),i&&i.forEach((e=>e(n))),t)return t(n)},f=setTimeout(h.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=h.bind(null,a.onerror),a.onload=h.bind(null,a.onload),l&&document.head.appendChild(a)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/asignacion-plazas/",(()=>{var e={792:0};n.f.j=(t,r)=>{var i=n.o(e,t)?e[t]:void 0;if(0!==i)if(i)r.push(i[2]);else{var o=new Promise(((n,r)=>i=e[t]=[n,r]));r.push(i[2]=o);var s=n.p+n.u(t),a=new Error;n.l(s,(r=>{if(n.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var o=r&&("load"===r.type?"missing":r.type),s=r&&r.target&&r.target.src;a.message="Loading chunk "+t+" failed.\n("+o+": "+s+")",a.name="ChunkLoadError",a.type=o,a.request=s,i[1](a)}}),"chunk-"+t,t)}};var t=(t,r)=>{var i,o,s=r[0],a=r[1],l=r[2],c=0;if(s.some((t=>0!==e[t]))){for(i in a)n.o(a,i)&&(n.m[i]=a[i]);if(l)l(n)}for(t&&t(r);c<s.length;c++)o=s[c],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0},r=self.webpackChunkasignacion_plazas=self.webpackChunkasignacion_plazas||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var r=n(43),i=n(391);const o=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},s={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const t=e[i],o=i+1<e.length,s=o?e[i+1]:0,a=i+2<e.length,l=a?e[i+2]:0,c=t>>2,u=(3&t)<<4|s>>4;let d=(15&s)<<2|l>>6,h=63&l;a||(h=64,o||(d=64)),r.push(n[c],n[u],n[d],n[h])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(o(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const o=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){const o=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{const o=e[n++],s=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const t=n[e.charAt(i++)],o=i<e.length?n[e.charAt(i)]:0;++i;const s=i<e.length?n[e.charAt(i)]:64;++i;const l=i<e.length?n[e.charAt(i)]:64;if(++i,null==t||null==o||null==s||null==l)throw new a;const c=t<<2|o>>4;if(r.push(c),64!==s){const e=o<<4&240|s>>2;if(r.push(e),64!==l){const e=s<<6&192|l;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class a extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const l=function(e){return function(e){const t=o(e);return s.encodeByteArray(t,!0)}(e).replace(/\./g,"")},c=function(e){try{return s.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};const u=()=>function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,d=()=>{try{return u()||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"/asignacion-plazas",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_FIREBASE_API_KEY:"AIzaSyDo7X1BLIW1hNYQpJLZcDws_L4aGHJWXOQ",REACT_APP_FIREBASE_AUTH_DOMAIN:"asignacion-plazas.firebaseapp.com",REACT_APP_FIREBASE_PROJECT_ID:"asignacion-plazas",REACT_APP_FIREBASE_STORAGE_BUCKET:"asignacion-plazas.firebasestorage.app",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"525955676079",REACT_APP_FIREBASE_APP_ID:"1:525955676079:web:a7e0b00391e75c902fe15a",REACT_APP_FIREBASE_MEASUREMENT_ID:"G-E0DLWYPVKP"}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const t=e&&c(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},h=e=>{var t,n;return null===(n=null===(t=d())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},f=()=>{var e;return null===(e=d())||void 0===e?void 0:e.config},p=e=>{var t;return null===(t=d())||void 0===t?void 0:t[`_${e}`]};class g{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function m(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function y(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}function v(){return!function(){var e;const t=null===(e=d())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(r){return!1}}()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function b(){try{return"object"===typeof indexedDB}catch(e){return!1}}function w(){return new Promise(((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}}))}class x extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,x.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,I.prototype.create)}}class I{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n=`${this.service}/${e}`,r=this.errors[e],i=r?function(e,t){return e.replace(S,((e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`}))}(r,t):"Error",o=`${this.serviceName}: ${i} (${n}).`;return new x(n,o,t)}}const S=/\{\$([^}]+)}/g;function E(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],o=t[i];if(_(n)&&_(o)){if(!E(n,o))return!1}else if(n!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function _(e){return null!==e&&"object"===typeof e}function T(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function k(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}})),t}function C(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class N{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!==typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"===typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=A),void 0===r.error&&(r.error=A),void 0===r.complete&&(r.complete=A);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}})),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){"undefined"!==typeof console&&console.error&&console.error(n)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function A(){}function D(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;const n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3)*Math.pow(t,e),r=Math.round(.5*n*(Math.random()-.5)*2);return Math.min(144e5,n+r)}function P(e){return e&&e._delegate?e._delegate:e}class R{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const O="[DEFAULT]";class L{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new g;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(n){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:O})}catch(t){}for(const[e,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:r});n.resolve(e)}catch(t){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[i,o]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(i)&&o.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const o=this.instances.get(r);return o&&e(o,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch(r){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===O?void 0:i),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch(o){}var i;return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O;return this.component?this.component.multipleInstances?e:O:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class M{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new L(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const j=[];var z;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(z||(z={}));const F={debug:z.DEBUG,verbose:z.VERBOSE,info:z.INFO,warn:z.WARN,error:z.ERROR,silent:z.SILENT},V=z.INFO,U={[z.DEBUG]:"log",[z.VERBOSE]:"log",[z.INFO]:"info",[z.WARN]:"warn",[z.ERROR]:"error"},$=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=U[t];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);for(var i=arguments.length,o=new Array(i>2?i-2:0),s=2;s<i;s++)o[s-2]=arguments[s];console[r](`[${n}]  ${e.name}:`,...o)};class B{constructor(e){this.name=e,this._logLevel=V,this._logHandler=$,this._userLogHandler=null,j.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in z))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?F[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,z.DEBUG,...t),this._logHandler(this,z.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,z.VERBOSE,...t),this._logHandler(this,z.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,z.INFO,...t),this._logHandler(this,z.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,z.WARN,...t),this._logHandler(this,z.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,z.ERROR,...t),this._logHandler(this,z.ERROR,...t)}}let q,H;const K=new WeakMap,W=new WeakMap,G=new WeakMap,Q=new WeakMap,Y=new WeakMap;let X={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return W.get(e);if("objectStoreNames"===t)return e.objectStoreNames||G.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ee(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function J(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(H||(H=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(te(this),n),ee(K.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return ee(e.apply(te(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const o=e.call(te(this),t,...r);return G.set(o,t.sort?t.sort():[t]),ee(o)}}function Z(e){return"function"===typeof e?J(e):(e instanceof IDBTransaction&&function(e){if(W.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",o),e.removeEventListener("abort",o)},i=()=>{t(),r()},o=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",o),e.addEventListener("abort",o)}));W.set(e,t)}(e),t=e,(q||(q=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>t instanceof e))?new Proxy(e,X):e);var t}function ee(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",o)},i=()=>{t(ee(e.result)),r()},o=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",o)}));return t.then((t=>{t instanceof IDBCursor&&K.set(t,e)})).catch((()=>{})),Y.set(t,e),t}(e);if(Q.has(e))return Q.get(e);const t=Z(e);return t!==e&&(Q.set(e,t),Y.set(t,e)),t}const te=e=>Y.get(e);function ne(e,t){let{blocked:n,upgrade:r,blocking:i,terminated:o}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const s=indexedDB.open(e,t),a=ee(s);return r&&s.addEventListener("upgradeneeded",(e=>{r(ee(s.result),e.oldVersion,e.newVersion,ee(s.transaction),e)})),n&&s.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),a.then((e=>{o&&e.addEventListener("close",(()=>o())),i&&e.addEventListener("versionchange",(e=>i(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),a}const re=["get","getKey","getAll","getAllKeys","count"],ie=["put","add","delete","clear"],oe=new Map;function se(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(oe.get(t))return oe.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=ie.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!re.includes(n))return;const o=async function(e){const t=this.transaction(e,i?"readwrite":"readonly");let o=t.store;for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];return r&&(o=o.index(a.shift())),(await Promise.all([o[n](...a),i&&t.done]))[0]};return oe.set(t,o),o}X=(e=>({...e,get:(t,n,r)=>se(t,n)||e.get(t,n,r),has:(t,n)=>!!se(t,n)||e.has(t,n)}))(X);class ae{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const le="@firebase/app",ce="0.11.4",ue=new B("@firebase/app"),de="@firebase/app-compat",he="@firebase/analytics-compat",fe="@firebase/analytics",pe="@firebase/app-check-compat",ge="@firebase/app-check",me="@firebase/auth",ye="@firebase/auth-compat",ve="@firebase/database",be="@firebase/data-connect",we="@firebase/database-compat",xe="@firebase/functions",Ie="@firebase/functions-compat",Se="@firebase/installations",Ee="@firebase/installations-compat",_e="@firebase/messaging",Te="@firebase/messaging-compat",ke="@firebase/performance",Ce="@firebase/performance-compat",Ne="@firebase/remote-config",Ae="@firebase/remote-config-compat",De="@firebase/storage",Pe="@firebase/storage-compat",Re="@firebase/firestore",Oe="@firebase/vertexai",Le="@firebase/firestore-compat",Me="firebase",je="[DEFAULT]",ze={[le]:"fire-core",[de]:"fire-core-compat",[fe]:"fire-analytics",[he]:"fire-analytics-compat",[ge]:"fire-app-check",[pe]:"fire-app-check-compat",[me]:"fire-auth",[ye]:"fire-auth-compat",[ve]:"fire-rtdb",[be]:"fire-data-connect",[we]:"fire-rtdb-compat",[xe]:"fire-fn",[Ie]:"fire-fn-compat",[Se]:"fire-iid",[Ee]:"fire-iid-compat",[_e]:"fire-fcm",[Te]:"fire-fcm-compat",[ke]:"fire-perf",[Ce]:"fire-perf-compat",[Ne]:"fire-rc",[Ae]:"fire-rc-compat",[De]:"fire-gcs",[Pe]:"fire-gcs-compat",[Re]:"fire-fst",[Le]:"fire-fst-compat",[Oe]:"fire-vertex","fire-js":"fire-js",[Me]:"fire-js-all"},Fe=new Map,Ve=new Map,Ue=new Map;function $e(e,t){try{e.container.addComponent(t)}catch(n){ue.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function Be(e){const t=e.name;if(Ue.has(t))return ue.debug(`There were multiple attempts to register component ${t}.`),!1;Ue.set(t,e);for(const n of Fe.values())$e(n,e);for(const n of Ve.values())$e(n,e);return!0}function qe(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function He(e){return null!==e&&void 0!==e&&void 0!==e.settings}const Ke=new I("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class We{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new R("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ke.create("app-deleted",{appName:this._name})}}const Ge="11.6.0";function Qe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const r=Object.assign({name:je,automaticDataCollectionEnabled:!1},t),i=r.name;if("string"!==typeof i||!i)throw Ke.create("bad-app-name",{appName:String(i)});if(n||(n=f()),!n)throw Ke.create("no-options");const o=Fe.get(i);if(o){if(E(n,o.options)&&E(r,o.config))return o;throw Ke.create("duplicate-app",{appName:i})}const s=new M(i);for(const l of Ue.values())s.addComponent(l);const a=new We(n,r,s);return Fe.set(i,a),a}function Ye(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:je;const t=Fe.get(e);if(!t&&e===je&&f())return Qe();if(!t)throw Ke.create("no-app",{appName:e});return t}function Xe(e,t,n){var r;let i=null!==(r=ze[e])&&void 0!==r?r:e;n&&(i+=`-${n}`);const o=i.match(/\s|\//),s=t.match(/\s|\//);if(o||s){const e=[`Unable to register library "${i}" with version "${t}":`];return o&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&s&&e.push("and"),s&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void ue.warn(e.join(" "))}Be(new R(`${i}-version`,(()=>({library:i,version:t})),"VERSION"))}const Je="firebase-heartbeat-store";let Ze=null;function et(){return Ze||(Ze=ne("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(Je)}catch(n){console.warn(n)}}}).catch((e=>{throw Ke.create("idb-open",{originalErrorMessage:e.message})}))),Ze}async function tt(e,t){try{const n=(await et()).transaction(Je,"readwrite"),r=n.objectStore(Je);await r.put(t,nt(e)),await n.done}catch(n){if(n instanceof x)ue.warn(n.message);else{const e=Ke.create("idb-set",{originalErrorMessage:null===n||void 0===n?void 0:n.message});ue.warn(e.message)}}}function nt(e){return`${e.name}!${e.options.appId}`}class rt{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new ot(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){var e,t;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=it();if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some((e=>e.date===r)))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>30){const e=function(e){if(0===e.length)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){ue.warn(n)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=it(),{heartbeatsToSend:n,unsentEntries:r}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const i of e){const e=n.find((e=>e.agent===i.agent));if(e){if(e.dates.push(i.date),st(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),st(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),i=l(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return ue.warn(t),""}}}function it(){return(new Date).toISOString().substring(0,10)}class ot{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!b()&&w().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await et()).transaction(Je),n=await t.objectStore(Je).get(nt(e));return await t.done,n}catch(t){if(t instanceof x)ue.warn(t.message);else{const e=Ke.create("idb-get",{originalErrorMessage:null===t||void 0===t?void 0:t.message});ue.warn(e.message)}}}(this.app);return(null===e||void 0===e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return tt(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return tt(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function st(e){return l(JSON.stringify({version:2,heartbeats:e})).length}var at;at="",Be(new R("platform-logger",(e=>new ae(e)),"PRIVATE")),Be(new R("heartbeat",(e=>new rt(e)),"PRIVATE")),Xe(le,ce,at),Xe(le,ce,"esm2017"),Xe("fire-js","");var lt,ct,ut="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},dt={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(e,t,n){n||(n=0);var r=Array(16);if("string"===typeof t)for(var i=0;16>i;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];var o=e.g[3],s=t+(o^n&(i^o))+r[0]+3614090360&4294967295;s=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=n+(s<<7&4294967295|s>>>25))+((s=o+(i^t&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|s>>>20))+((s=i+(n^o&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^i&(o^t))+r[3]+3250441966&4294967295)<<22&4294967295|s>>>10))+((s=t+(o^n&(i^o))+r[4]+4118548399&4294967295)<<7&4294967295|s>>>25))+((s=o+(i^t&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|s>>>20))+((s=i+(n^o&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^i&(o^t))+r[7]+4249261313&4294967295)<<22&4294967295|s>>>10))+((s=t+(o^n&(i^o))+r[8]+1770035416&4294967295)<<7&4294967295|s>>>25))+((s=o+(i^t&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|s>>>20))+((s=i+(n^o&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^i&(o^t))+r[11]+2304563134&4294967295)<<22&4294967295|s>>>10))+((s=t+(o^n&(i^o))+r[12]+1804603682&4294967295)<<7&4294967295|s>>>25))+((s=o+(i^t&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|s>>>20))+((s=i+(n^o&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^i&(o^t))+r[15]+1236535329&4294967295)<<22&4294967295|s>>>10))+((s=t+(i^o&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|s>>>27))+((s=o+(n^i&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|s>>>23))+((s=i+(t^n&(o^t))+r[11]+643717713&4294967295)<<14&4294967295|s>>>18))+((s=n+(o^t&(i^o))+r[0]+3921069994&4294967295)<<20&4294967295|s>>>12))+((s=t+(i^o&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|s>>>27))+((s=o+(n^i&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|s>>>23))+((s=i+(t^n&(o^t))+r[15]+3634488961&4294967295)<<14&4294967295|s>>>18))+((s=n+(o^t&(i^o))+r[4]+3889429448&4294967295)<<20&4294967295|s>>>12))+((s=t+(i^o&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|s>>>27))+((s=o+(n^i&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|s>>>23))+((s=i+(t^n&(o^t))+r[3]+4107603335&4294967295)<<14&4294967295|s>>>18))+((s=n+(o^t&(i^o))+r[8]+1163531501&4294967295)<<20&4294967295|s>>>12))+((s=t+(i^o&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|s>>>27))+((s=o+(n^i&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|s>>>23))+((s=i+(t^n&(o^t))+r[7]+1735328473&4294967295)<<14&4294967295|s>>>18))+((s=n+(o^t&(i^o))+r[12]+2368359562&4294967295)<<20&4294967295|s>>>12))+((s=t+(n^i^o)+r[5]+4294588738&4294967295)<<4&4294967295|s>>>28))+((s=o+(t^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|s>>>21))+((s=i+(o^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|s>>>16))+((s=n+(i^o^t)+r[14]+4259657740&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^i^o)+r[1]+2763975236&4294967295)<<4&4294967295|s>>>28))+((s=o+(t^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|s>>>21))+((s=i+(o^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|s>>>16))+((s=n+(i^o^t)+r[10]+3200236656&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^i^o)+r[13]+681279174&4294967295)<<4&4294967295|s>>>28))+((s=o+(t^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|s>>>21))+((s=i+(o^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|s>>>16))+((s=n+(i^o^t)+r[6]+76029189&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^i^o)+r[9]+3654602809&4294967295)<<4&4294967295|s>>>28))+((s=o+(t^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|s>>>21))+((s=i+(o^t^n)+r[15]+530742520&4294967295)<<16&4294967295|s>>>16))+((s=n+(i^o^t)+r[2]+3299628645&4294967295)<<23&4294967295|s>>>9))+((s=t+(i^(n|~o))+r[0]+4096336452&4294967295)<<6&4294967295|s>>>26))+((s=o+(n^(t|~i))+r[7]+1126891415&4294967295)<<10&4294967295|s>>>22))+((s=i+(t^(o|~n))+r[14]+2878612391&4294967295)<<15&4294967295|s>>>17))+((s=n+(o^(i|~t))+r[5]+4237533241&4294967295)<<21&4294967295|s>>>11))+((s=t+(i^(n|~o))+r[12]+1700485571&4294967295)<<6&4294967295|s>>>26))+((s=o+(n^(t|~i))+r[3]+2399980690&4294967295)<<10&4294967295|s>>>22))+((s=i+(t^(o|~n))+r[10]+4293915773&4294967295)<<15&4294967295|s>>>17))+((s=n+(o^(i|~t))+r[1]+2240044497&4294967295)<<21&4294967295|s>>>11))+((s=t+(i^(n|~o))+r[8]+1873313359&4294967295)<<6&4294967295|s>>>26))+((s=o+(n^(t|~i))+r[15]+4264355552&4294967295)<<10&4294967295|s>>>22))+((s=i+(t^(o|~n))+r[6]+2734768916&4294967295)<<15&4294967295|s>>>17))+((s=n+(o^(i|~t))+r[13]+1309151649&4294967295)<<21&4294967295|s>>>11))+((o=(t=n+((s=t+(i^(n|~o))+r[4]+4149444226&4294967295)<<6&4294967295|s>>>26))+((s=o+(n^(t|~i))+r[11]+3174756917&4294967295)<<10&4294967295|s>>>22))^((i=o+((s=i+(t^(o|~n))+r[2]+718787259&4294967295)<<15&4294967295|s>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(s<<21&4294967295|s>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+o&4294967295}function r(e,t){this.h=t;for(var n=[],r=!0,i=e.length-1;0<=i;i--){var o=0|e[i];r&&o==t||(n[i]=o,r=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.D=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.C=function(e,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return t.prototype[n].apply(e,i)}}(t,(function(){this.blockSize=-1})),t.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var r=t-this.blockSize,i=this.B,o=this.h,s=0;s<t;){if(0==o)for(;s<=r;)n(this,e,s),s+=this.blockSize;if("string"===typeof e){for(;s<t;)if(i[o++]=e.charCodeAt(s++),o==this.blockSize){n(this,i),o=0;break}}else for(;s<t;)if(i[o++]=e[s++],o==this.blockSize){n(this,i),o=0;break}}this.h=o,this.o+=t},t.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.u(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var i={};function o(e){return-128<=e&&128>e?function(e,t){var n=i;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,(function(e){return new r([0|e],0>e?-1:0)})):new r([0|e],0>e?-1:0)}function s(e){if(isNaN(e)||!isFinite(e))return a;if(0>e)return h(s(-e));for(var t=[],n=1,i=0;e>=n;i++)t[i]=e/n|0,n*=4294967296;return new r(t,0)}var a=o(0),l=o(1),c=o(16777216);function u(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function d(e){return-1==e.h}function h(e){for(var t=e.g.length,n=[],i=0;i<t;i++)n[i]=~e.g[i];return new r(n,~e.h).add(l)}function f(e,t){return e.add(h(t))}function p(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function g(e,t){this.g=e,this.h=t}function m(e,t){if(u(t))throw Error("division by zero");if(u(e))return new g(a,a);if(d(e))return t=m(h(e),t),new g(h(t.g),h(t.h));if(d(t))return t=m(e,h(t)),new g(h(t.g),t.h);if(30<e.g.length){if(d(e)||d(t))throw Error("slowDivide_ only works with positive integers.");for(var n=l,r=t;0>=r.l(e);)n=y(n),r=y(r);var i=v(n,1),o=v(r,1);for(r=v(r,2),n=v(n,2);!u(r);){var c=o.add(r);0>=c.l(e)&&(i=i.add(n),o=c),r=v(r,1),n=v(n,1)}return t=f(e,i.j(t)),new g(i,t)}for(i=a;0<=e.l(t);){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),c=(o=s(n)).j(t);d(c)||0<c.l(e);)c=(o=s(n-=r)).j(t);u(o)&&(o=l),i=i.add(o),e=f(e,c)}return new g(i,e)}function y(e){for(var t=e.g.length+1,n=[],i=0;i<t;i++)n[i]=e.i(i)<<1|e.i(i-1)>>>31;return new r(n,e.h)}function v(e,t){var n=t>>5;t%=32;for(var i=e.g.length-n,o=[],s=0;s<i;s++)o[s]=0<t?e.i(s+n)>>>t|e.i(s+n+1)<<32-t:e.i(s+n);return new r(o,e.h)}(e=r.prototype).m=function(){if(d(this))return-h(this).m();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.i(n);e+=(0<=r?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(u(this))return"0";if(d(this))return"-"+h(this).toString(e);for(var t=s(Math.pow(e,6)),n=this,r="";;){var i=m(n,t).g,o=((0<(n=f(n,i.j(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(u(n=i))return o+r;for(;6>o.length;)o="0"+o;r=o+r}},e.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return d(e=f(this,e))?-1:u(e)?0:1},e.abs=function(){return d(this)?h(this):this},e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0,o=0;o<=t;o++){var s=i+(65535&this.i(o))+(65535&e.i(o)),a=(s>>>16)+(this.i(o)>>>16)+(e.i(o)>>>16);i=a>>>16,s&=65535,a&=65535,n[o]=a<<16|s}return new r(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(u(this)||u(e))return a;if(d(this))return d(e)?h(this).j(h(e)):h(h(this).j(e));if(d(e))return h(this.j(h(e)));if(0>this.l(c)&&0>e.l(c))return s(this.m()*e.m());for(var t=this.g.length+e.g.length,n=[],i=0;i<2*t;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(var o=0;o<e.g.length;o++){var l=this.i(i)>>>16,f=65535&this.i(i),g=e.i(o)>>>16,m=65535&e.i(o);n[2*i+2*o]+=f*m,p(n,2*i+2*o),n[2*i+2*o+1]+=l*m,p(n,2*i+2*o+1),n[2*i+2*o+1]+=f*g,p(n,2*i+2*o+1),n[2*i+2*o+2]+=l*g,p(n,2*i+2*o+2)}for(i=0;i<t;i++)n[i]=n[2*i+1]<<16|n[2*i];for(i=t;i<2*t;i++)n[i]=0;return new r(n,0)},e.A=function(e){return m(this,e).h},e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)&e.i(i);return new r(n,this.h&e.h)},e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)|e.i(i);return new r(n,this.h|e.h)},e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)^e.i(i);return new r(n,this.h^e.h)},t.prototype.digest=t.prototype.v,t.prototype.reset=t.prototype.s,t.prototype.update=t.prototype.u,ct=dt.Md5=t,r.prototype.add=r.prototype.add,r.prototype.multiply=r.prototype.j,r.prototype.modulo=r.prototype.A,r.prototype.compare=r.prototype.l,r.prototype.toNumber=r.prototype.m,r.prototype.toString=r.prototype.toString,r.prototype.getBits=r.prototype.i,r.fromNumber=s,r.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return h(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=s(Math.pow(n,8)),i=a,o=0;o<t.length;o+=8){var l=Math.min(8,t.length-o),c=parseInt(t.substring(o,o+l),n);8>l?(l=s(Math.pow(n,l)),i=i.j(l).add(s(c))):i=(i=i.j(r)).add(s(c))}return i},lt=dt.Integer=r}).apply("undefined"!==typeof ut?ut:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var ht,ft,pt,gt,mt,yt,vt,bt,wt="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},xt={};(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof wt&&wt];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(e,r){if(r)e:{var i=n;e=e.split(".");for(var o=0;o<e.length-1;o++){var s=e[o];if(!(s in i))break e;i=i[s]}(r=r(o=i[e=e[e.length-1]]))!=o&&null!=r&&t(i,e,{configurable:!0,writable:!0,value:r})}}("Array.prototype.values",(function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,i={next:function(){if(!r&&n<e.length){var i=n++;return{value:t(i,e[i]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}(this,(function(e,t){return t}))}}));var r=r||{},i=this||self;function o(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function s(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function a(e,t,n){return e.call.apply(e.bind,arguments)}function l(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function c(e,t,n){return(c=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?a:l).apply(null,arguments)}function u(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function d(e,t){function n(){}n.prototype=t.prototype,e.aa=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Qb=function(e,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return t.prototype[n].apply(e,i)}}function h(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function f(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(o(t)){const n=e.length||0,r=t.length||0;e.length=n+r;for(let i=0;i<r;i++)e[n+i]=t[i]}else e.push(t)}}function p(e){return/^[\s\xa0]*$/.test(e)}function g(){var e=i.navigator;return e&&(e=e.userAgent)?e:""}function m(e){return m[" "](e),e}m[" "]=function(){};var y=-1!=g().indexOf("Gecko")&&!(-1!=g().toLowerCase().indexOf("webkit")&&-1==g().indexOf("Edge"))&&!(-1!=g().indexOf("Trident")||-1!=g().indexOf("MSIE"))&&-1==g().indexOf("Edge");function v(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function b(e){const t={};for(const n in e)t[n]=e[n];return t}const w="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function x(e,t){let n,r;for(let i=1;i<arguments.length;i++){for(n in r=arguments[i],r)e[n]=r[n];for(let t=0;t<w.length;t++)n=w[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function I(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function S(e){i.setTimeout((()=>{throw e}),0)}function E(){var e=N;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var _=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new T),(e=>e.reset()));class T{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let k,C=!1,N=new class{constructor(){this.h=this.g=null}add(e,t){const n=_.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},A=()=>{const e=i.Promise.resolve(void 0);k=()=>{e.then(D)}};var D=()=>{for(var e;e=E();){try{e.h.call(e.g)}catch(n){S(n)}var t=_;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}C=!1};function P(){this.s=this.s,this.C=this.C}function R(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}P.prototype.s=!1,P.prototype.ma=function(){this.s||(this.s=!0,this.N())},P.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},R.prototype.h=function(){this.defaultPrevented=!0};var O=function(){if(!i.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};i.addEventListener("test",e,t),i.removeEventListener("test",e,t)}catch(n){}return e}();function L(e,t){if(R.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(y){e:{try{m(t.nodeName);var i=!0;break e}catch(o){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:M[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&L.aa.h.call(this)}}d(L,R);var M={2:"touch",3:"pen",4:"mouse"};L.prototype.h=function(){L.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var j="closure_listenable_"+(1e6*Math.random()|0),z=0;function F(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=i,this.key=++z,this.da=this.fa=!1}function V(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function U(e){this.src=e,this.g={},this.h=0}function $(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],o=Array.prototype.indexOf.call(i,t,void 0);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(V(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function B(e,t,n,r){for(var i=0;i<e.length;++i){var o=e[i];if(!o.da&&o.listener==t&&o.capture==!!n&&o.ha==r)return i}return-1}U.prototype.add=function(e,t,n,r,i){var o=e.toString();(e=this.g[o])||(e=this.g[o]=[],this.h++);var s=B(e,t,r,i);return-1<s?(t=e[s],n||(t.fa=!1)):((t=new F(t,this.src,o,!!r,i)).fa=n,e.push(t)),t};var q="closure_lm_"+(1e6*Math.random()|0),H={};function K(e,t,n,r,i){if(r&&r.once)return G(e,t,n,r,i);if(Array.isArray(t)){for(var o=0;o<t.length;o++)K(e,t[o],n,r,i);return null}return n=te(n),e&&e[j]?e.K(t,n,s(r)?!!r.capture:!!r,i):W(e,t,n,!1,r,i)}function W(e,t,n,r,i,o){if(!t)throw Error("Invalid event type");var a=s(i)?!!i.capture:!!i,l=Z(e);if(l||(e[q]=l=new U(e)),(n=l.add(t,n,r,a,o)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=J;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)O||(i=a),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(X(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function G(e,t,n,r,i){if(Array.isArray(t)){for(var o=0;o<t.length;o++)G(e,t[o],n,r,i);return null}return n=te(n),e&&e[j]?e.L(t,n,s(r)?!!r.capture:!!r,i):W(e,t,n,!0,r,i)}function Q(e,t,n,r,i){if(Array.isArray(t))for(var o=0;o<t.length;o++)Q(e,t[o],n,r,i);else r=s(r)?!!r.capture:!!r,n=te(n),e&&e[j]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=B(o=e.g[t],n,r,i))&&(V(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete e.g[t],e.h--)))):e&&(e=Z(e))&&(t=e.g[t.toString()],e=-1,t&&(e=B(t,n,r,i)),(n=-1<e?t[e]:null)&&Y(n))}function Y(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[j])$(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(X(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Z(t))?($(n,e),0==n.h&&(n.src=null,t[q]=null)):V(e)}}}function X(e){return e in H?H[e]:H[e]="on"+e}function J(e,t){if(e.da)e=!0;else{t=new L(t,this);var n=e.listener,r=e.ha||e.src;e.fa&&Y(e),e=n.call(r,t)}return e}function Z(e){return(e=e[q])instanceof U?e:null}var ee="__closure_events_fn_"+(1e9*Math.random()>>>0);function te(e){return"function"===typeof e?e:(e[ee]||(e[ee]=function(t){return e.handleEvent(t)}),e[ee])}function ne(){P.call(this),this.i=new U(this),this.M=this,this.F=null}function re(e,t){var n,r=e.F;if(r)for(n=[];r;r=r.F)n.push(r);if(e=e.M,r=t.type||t,"string"===typeof t)t=new R(t,e);else if(t instanceof R)t.target=t.target||e;else{var i=t;x(t=new R(r,e),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=t.g=n[o];i=ie(s,r,!0,t)&&i}if(i=ie(s=t.g=e,r,!0,t)&&i,i=ie(s,r,!1,t)&&i,n)for(o=0;o<n.length;o++)i=ie(s=t.g=n[o],r,!1,t)&&i}function ie(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,o=0;o<t.length;++o){var s=t[o];if(s&&!s.da&&s.capture==n){var a=s.listener,l=s.ha||s.src;s.fa&&$(e.i,s),i=!1!==a.call(l,r)&&i}}return i&&!r.defaultPrevented}function oe(e,t,n){if("function"===typeof e)n&&(e=c(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=c(e.handleEvent,e)}return 2147483647<Number(t)?-1:i.setTimeout(e,t||0)}function se(e){e.g=oe((()=>{e.g=null,e.i&&(e.i=!1,se(e))}),e.l);const t=e.h;e.h=null,e.m.apply(null,t)}d(ne,P),ne.prototype[j]=!0,ne.prototype.removeEventListener=function(e,t,n,r){Q(this,e,t,n,r)},ne.prototype.N=function(){if(ne.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)V(n[r]);delete t.g[e],t.h--}}this.F=null},ne.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},ne.prototype.L=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};class ae extends P{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:se(this)}N(){super.N(),this.g&&(i.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function le(e){P.call(this),this.h=e,this.g={}}d(le,P);var ce=[];function ue(e){v(e.g,(function(e,t){this.g.hasOwnProperty(t)&&Y(e)}),e),e.g={}}le.prototype.N=function(){le.aa.N.call(this),ue(this)},le.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var de=i.JSON.stringify,he=i.JSON.parse,fe=class{stringify(e){return i.JSON.stringify(e,void 0)}parse(e){return i.JSON.parse(e,void 0)}};function pe(){}function ge(e){return e.h||(e.h=e.i())}function me(){}pe.prototype.h=null;var ye={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ve(){R.call(this,"d")}function be(){R.call(this,"c")}d(ve,R),d(be,R);var we={},xe=null;function Ie(){return xe=xe||new ne}function Se(e){R.call(this,we.La,e)}function Ee(e){const t=Ie();re(t,new Se(t))}function _e(e,t){R.call(this,we.STAT_EVENT,e),this.stat=t}function Te(e){const t=Ie();re(t,new _e(t,e))}function ke(e,t){R.call(this,we.Ma,e),this.size=t}function Ce(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return i.setTimeout((function(){e()}),t)}function Ne(){this.g=!0}function Ae(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return de(n)}catch(a){return t}}(e,n)+(r?" "+r:"")}))}we.La="serverreachability",d(Se,R),we.STAT_EVENT="statevent",d(_e,R),we.Ma="timingevent",d(ke,R),Ne.prototype.xa=function(){this.g=!1},Ne.prototype.info=function(){};var De,Pe={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Re={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function Oe(){}function Le(e,t,n,r){this.j=e,this.i=t,this.l=n,this.R=r||1,this.U=new le(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Me}function Me(){this.i=null,this.g="",this.h=!1}d(Oe,pe),Oe.prototype.g=function(){return new XMLHttpRequest},Oe.prototype.i=function(){return{}},De=new Oe;var je={},ze={};function Fe(e,t,n){e.L=1,e.v=dt(st(t)),e.m=n,e.P=!0,Ve(e,null)}function Ve(e,t){e.F=Date.now(),Be(e),e.A=st(e.v);var n=e.A,r=e.R;Array.isArray(r)||(r=[String(r)]),Mt(n.i,"t",r),e.C=0,n=e.j.J,e.h=new Me,e.g=En(e.j,n?t:null,!e.m),0<e.O&&(e.M=new ae(c(e.Y,e,e.g),e.O)),t=e.U,n=e.g,r=e.ca;var i="readystatechange";Array.isArray(i)||(i&&(ce[0]=i.toString()),i=ce);for(var o=0;o<i.length;o++){var s=K(n,i[o],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}t=e.H?b(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),Ee(),function(e,t,n,r,i,o){e.info((function(){if(e.g)if(o)for(var s="",a=o.split("&"),l=0;l<a.length;l++){var c=a[l].split("=");if(1<c.length){var u=c[0];c=c[1];var d=u.split("_");s=2<=d.length&&"type"==d[1]?s+(u+"=")+c+"&":s+(u+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+s}))}(e.i,e.u,e.A,e.l,e.R,e.m)}function Ue(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.j.Ca)}function $e(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?ze:(n=Number(t.substring(n,r)),isNaN(n)?je:(r+=1)+n>t.length?ze:(t=t.slice(r,r+n),e.C=r+n,t))}function Be(e){e.S=Date.now()+e.I,qe(e,e.I)}function qe(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Ce(c(e.ba,e),t)}function He(e){e.B&&(i.clearTimeout(e.B),e.B=null)}function Ke(e){0==e.j.G||e.J||bn(e.j,e)}function We(e){He(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,ue(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function Ge(e,t){try{var n=e.j;if(0!=n.G&&(n.g==e||Ze(n.h,e)))if(!e.K&&Ze(n.h,e)&&3==n.G){try{var r=n.Da.g.parse(t)}catch(u){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;vn(n),ln(n)}gn(n),Te(18)}}else n.za=i[1],0<n.za-n.T&&37500>i[2]&&n.F&&0==n.v&&!n.C&&(n.C=Ce(c(n.Za,n),6e3));if(1>=Je(n.h)&&n.ca){try{n.ca()}catch(u){}n.ca=void 0}}else xn(n,11)}else if((e.K||n.g==e)&&vn(n),!p(t))for(i=n.Da.g.parse(t),t=0;t<i.length;t++){let c=i[t];if(n.T=c[0],c=c[1],2==n.G)if("c"==c[0]){n.K=c[1],n.ia=c[2];const t=c[3];null!=t&&(n.la=t,n.j.info("VER="+n.la));const i=c[4];null!=i&&(n.Aa=i,n.j.info("SVER="+n.Aa));const u=c[5];null!=u&&"number"===typeof u&&0<u&&(r=1.5*u,n.L=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const d=e.g;if(d){const e=d.g?d.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var o=r.h;o.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(o.j=o.l,o.g=new Set,o.h&&(et(o,o.h),o.h=null))}if(r.D){const e=d.g?d.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.ya=e,ut(r.I,r.D,e))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-e.F,n.j.info("Handshake RTT: "+n.R+"ms"));var s=e;if((r=n).qa=Sn(r,r.J?r.ia:null,r.W),s.K){tt(r.h,s);var a=s,l=r.L;l&&(a.I=l),a.B&&(He(a),Be(a)),r.g=s}else pn(r);0<n.i.length&&un(n)}else"stop"!=c[0]&&"close"!=c[0]||xn(n,7);else 3==n.G&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?xn(n,7):an(n):"noop"!=c[0]&&n.l&&n.l.ta(c),n.v=0)}Ee()}catch(u){}}Le.prototype.ca=function(e){e=e.target;const t=this.M;t&&3==nn(e)?t.j():this.Y(e)},Le.prototype.Y=function(e){try{if(e==this.g)e:{const h=nn(this.g);var t=this.g.Ba();this.g.Z();if(!(3>h)&&(3!=h||this.g&&(this.h.h||this.g.oa()||rn(this.g)))){this.J||4!=h||7==t||Ee(),He(this);var n=this.g.Z();this.X=n;t:if(Ue(this)){var r=rn(this.g);e="";var o=r.length,s=4==nn(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){We(this),Ke(this);var a="";break t}this.h.i=new i.TextDecoder}for(t=0;t<o;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:!(s&&t==o-1)});r.length=0,this.h.g+=e,this.C=0,a=this.h.g}else a=this.g.oa();if(this.o=200==n,function(e,t,n,r,i,o,s){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+o+" "+s}))}(this.i,this.u,this.A,this.l,this.R,h,n),this.o){if(this.T&&!this.K){t:{if(this.g){var l,c=this.g;if((l=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!p(l)){var u=l;break t}}u=null}if(!(n=u)){this.o=!1,this.s=3,Te(12),We(this),Ke(this);break e}Ae(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ge(this,n)}if(this.P){let e;for(n=!0;!this.J&&this.C<a.length;){if(e=$e(this,a),e==ze){4==h&&(this.s=4,Te(14),n=!1),Ae(this.i,this.l,null,"[Incomplete Response]");break}if(e==je){this.s=4,Te(15),Ae(this.i,this.l,a,"[Invalid Chunk]"),n=!1;break}Ae(this.i,this.l,e,null),Ge(this,e)}if(Ue(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=h||0!=a.length||this.h.h||(this.s=1,Te(16),n=!1),this.o=this.o&&n,n){if(0<a.length&&!this.W){this.W=!0;var d=this.j;d.g==this&&d.ba&&!d.M&&(d.j.info("Great, no buffering proxy detected. Bytes received: "+a.length),mn(d),d.M=!0,Te(11))}}else Ae(this.i,this.l,a,"[Invalid Chunked Response]"),We(this),Ke(this)}else Ae(this.i,this.l,a,null),Ge(this,a);4==h&&We(this),this.o&&!this.J&&(4==h?bn(this.j,this):(this.o=!1,Be(this)))}else(function(e){const t={};e=(e.g&&2<=nn(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(p(e[r]))continue;var n=I(e[r]);const i=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const o=t[i]||[];t[i]=o,o.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==n&&0<a.indexOf("Unknown SID")?(this.s=3,Te(12)):(this.s=0,Te(13)),We(this),Ke(this)}}}catch(h){}},Le.prototype.cancel=function(){this.J=!0,We(this)},Le.prototype.ba=function(){this.B=null;const e=Date.now();0<=e-this.S?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.i,this.A),2!=this.L&&(Ee(),Te(17)),We(this),this.s=2,Ke(this)):qe(this,this.S-e)};var Qe=class{constructor(e,t){this.g=e,this.map=t}};function Ye(e){this.l=e||10,i.PerformanceNavigationTiming?e=0<(e=i.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(i.chrome&&i.chrome.loadTimes&&i.chrome.loadTimes()&&i.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Xe(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Je(e){return e.h?1:e.g?e.g.size:0}function Ze(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function et(e,t){e.g?e.g.add(t):e.h=t}function tt(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function nt(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return h(e.i)}function rt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(o(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(o(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}(e),r=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(o(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length,s=0;s<i;s++)t.call(void 0,r[s],n&&n[s],e)}Ye.prototype.cancel=function(){if(this.i=nt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var it=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ot(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof ot){this.h=e.h,at(this,e.j),this.o=e.o,this.g=e.g,lt(this,e.s),this.l=e.l;var t=e.i,n=new Pt;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),ct(this,n),this.m=e.m}else e&&(t=String(e).match(it))?(this.h=!1,at(this,t[1]||"",!0),this.o=It(t[2]||""),this.g=It(t[3]||"",!0),lt(this,t[4]),this.l=It(t[5]||"",!0),ct(this,t[6]||"",!0),this.m=It(t[7]||"")):(this.h=!1,this.i=new Pt(null,this.h))}function st(e){return new ot(e)}function at(e,t,n){e.j=n?It(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function lt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function ct(e,t,n){t instanceof Pt?(e.i=t,function(e,t){t&&!e.j&&(Rt(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(Ot(this,t),Mt(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=Et(t,At)),e.i=new Pt(t,e.h))}function ut(e,t,n){e.i.set(t,n)}function dt(e){return ut(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function It(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Et(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,_t),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function _t(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}ot.prototype.toString=function(){var e=[],t=this.j;t&&e.push(Et(t,kt,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(Et(t,kt,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(Et(n,"/"==n.charAt(0)?Nt:Ct,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",Et(n,Dt)),e.join("")};var Tt,kt=/[#\/\?@]/g,Ct=/[#\?:]/g,Nt=/[#\?]/g,At=/[#\?@]/g,Dt=/#/g;function Pt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Rt(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var o=e[n].substring(0,r);i=e[n].substring(r+1)}else o=e[n];t(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function Ot(e,t){Rt(e),t=jt(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Lt(e,t){return Rt(e),t=jt(e,t),e.g.has(t)}function Mt(e,t,n){Ot(e,t),0<n.length&&(e.i=null,e.g.set(jt(e,t),h(n)),e.h+=n.length)}function jt(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function zt(e,t,n,r,i){try{i&&(i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null),r(n)}catch(o){}}function Ft(){this.g=new fe}function Vt(e,t,n){const r=n||"";try{rt(e,(function(e,n){let i=e;s(e)&&(i=de(e)),t.push(r+n+"="+encodeURIComponent(i))}))}catch(i){throw t.push(r+"type="+encodeURIComponent("_badmap")),i}}function Ut(e){this.l=e.Ub||null,this.j=e.eb||!1}function $t(e,t){ne.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function Bt(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function qt(e){e.readyState=4,e.l=null,e.j=null,e.v=null,Ht(e)}function Ht(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Kt(e){let t="";return v(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function Wt(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Kt(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):ut(e,t,n))}function Gt(e){ne.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(e=Pt.prototype).add=function(e,t){Rt(this),this.i=null,e=jt(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){Rt(this),this.g.forEach((function(n,r){n.forEach((function(n){e.call(t,n,r,this)}),this)}),this)},e.na=function(){Rt(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const i=e[r];for(let e=0;e<i.length;e++)n.push(t[r])}return n},e.V=function(e){Rt(this);let t=[];if("string"===typeof e)Lt(this,e)&&(t=t.concat(this.g.get(jt(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},e.set=function(e,t){return Rt(this),this.i=null,Lt(this,e=jt(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const o=encodeURIComponent(String(r)),s=this.V(r);for(r=0;r<s.length;r++){var i=o;""!==s[r]&&(i+="="+encodeURIComponent(String(s[r]))),e.push(i)}}return this.i=e.join("&")},d(Ut,pe),Ut.prototype.g=function(){return new $t(this.l,this.j)},Ut.prototype.i=(Tt={},function(){return Tt}),d($t,ne),(e=$t.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,Ht(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||i).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,qt(this)),this.readyState=0},e.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Ht(this)),this.g&&(this.readyState=3,Ht(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if("undefined"!==typeof i.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Bt(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},e.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?qt(this):Ht(this),3==this.readyState&&Bt(this)}},e.Ra=function(e){this.g&&(this.response=this.responseText=e,qt(this))},e.Qa=function(e){this.g&&(this.response=e,qt(this))},e.ga=function(){this.g&&qt(this)},e.setRequestHeader=function(e,t){this.u.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty($t.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),d(Gt,ne);var Qt=/^https?$/i,Yt=["POST","PUT"];function Xt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,Jt(e),en(e)}function Jt(e){e.A||(e.A=!0,re(e,"complete"),re(e,"error"))}function Zt(e){if(e.h&&"undefined"!=typeof r&&(!e.v[1]||4!=nn(e)||2!=e.Z()))if(e.u&&4==nn(e))oe(e.Ea,0,e);else if(re(e,"readystatechange"),4==nn(e)){e.h=!1;try{const r=e.Z();e:switch(r){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var o;if(o=0===r){var s=String(e.D).match(it)[1]||null;!s&&i.self&&i.self.location&&(s=i.self.location.protocol.slice(0,-1)),o=!Qt.test(s?s.toLowerCase():"")}n=o}if(n)re(e,"complete"),re(e,"success");else{e.m=6;try{var a=2<nn(e)?e.g.statusText:""}catch(l){a=""}e.l=a+" ["+e.Z()+"]",Jt(e)}}finally{en(e)}}}function en(e,t){if(e.g){tn(e);const r=e.g,i=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||re(e,"ready");try{r.onreadystatechange=i}catch(n){}}}function tn(e){e.I&&(i.clearTimeout(e.I),e.I=null)}function nn(e){return e.g?e.g.readyState:0}function rn(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(St){return null}}function on(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function sn(e){this.Aa=0,this.i=[],this.j=new Ne,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=on("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=on("baseRetryDelayMs",5e3,e),this.cb=on("retryDelaySeedMs",1e4,e),this.Wa=on("forwardChannelMaxRetries",2,e),this.wa=on("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new Ye(e&&e.concurrentRequestLimit),this.Da=new Ft,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function an(e){if(cn(e),3==e.G){var t=e.U++,n=st(e.I);if(ut(n,"SID",e.K),ut(n,"RID",t),ut(n,"TYPE","terminate"),hn(e,n),(t=new Le(e,e.j,t)).L=2,t.v=dt(st(n)),n=!1,i.navigator&&i.navigator.sendBeacon)try{n=i.navigator.sendBeacon(t.v.toString(),"")}catch(r){}!n&&i.Image&&((new Image).src=t.v,n=!0),n||(t.g=En(t.j,null),t.g.ea(t.v)),t.F=Date.now(),Be(t)}In(e)}function ln(e){e.g&&(mn(e),e.g.cancel(),e.g=null)}function cn(e){ln(e),e.u&&(i.clearTimeout(e.u),e.u=null),vn(e),e.h.cancel(),e.s&&("number"===typeof e.s&&i.clearTimeout(e.s),e.s=null)}function un(e){if(!Xe(e.h)&&!e.s){e.s=!0;var t=e.Ga;k||A(),C||(k(),C=!0),N.add(t,e),e.B=0}}function dn(e,t){var n;n=t?t.l:e.U++;const r=st(e.I);ut(r,"SID",e.K),ut(r,"RID",n),ut(r,"AID",e.T),hn(e,r),e.m&&e.o&&Wt(r,e.m,e.o),n=new Le(e,e.j,n,e.B+1),null===e.m&&(n.H=e.o),t&&(e.i=t.D.concat(e.i)),t=fn(e,n,1e3),n.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),et(e.h,n),Fe(n,r,t)}function hn(e,t){e.H&&v(e.H,(function(e,n){ut(t,n,e)})),e.l&&rt({},(function(e,n){ut(t,n,e)}))}function fn(e,t,n){n=Math.min(e.i.length,n);var r=e.l?c(e.l.Na,e.l,e):null;e:{var i=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=i[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let s=!0;for(let a=0;a<n;a++){let n=i[a].g;const l=i[a].map;if(n-=t,0>n)t=Math.max(0,i[a].g-100),s=!1;else try{Vt(l,e,"req"+n+"_")}catch(o){r&&r(l)}}if(s){r=e.join("&");break e}}}return e=e.i.splice(0,n),t.D=e,r}function pn(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;k||A(),C||(k(),C=!0),N.add(t,e),e.v=0}}function gn(e){return!(e.g||e.u||3<=e.v)&&(e.Y++,e.u=Ce(c(e.Fa,e),wn(e,e.v)),e.v++,!0)}function mn(e){null!=e.A&&(i.clearTimeout(e.A),e.A=null)}function yn(e){e.g=new Le(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=st(e.qa);ut(t,"RID","rpc"),ut(t,"SID",e.K),ut(t,"AID",e.T),ut(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&ut(t,"TO",e.ja),ut(t,"TYPE","xmlhttp"),hn(e,t),e.m&&e.o&&Wt(t,e.m,e.o),e.L&&(e.g.I=e.L);var n=e.g;e=e.ia,n.L=1,n.v=dt(st(t)),n.m=null,n.P=!0,Ve(n,e)}function vn(e){null!=e.C&&(i.clearTimeout(e.C),e.C=null)}function bn(e,t){var n=null;if(e.g==t){vn(e),mn(e),e.g=null;var r=2}else{if(!Ze(e.h,t))return;n=t.D,tt(e.h,t),r=1}if(0!=e.G)if(t.o)if(1==r){n=t.m?t.m.length:0,t=Date.now()-t.F;var i=e.B;re(r=Ie(),new ke(r,n)),un(e)}else pn(e);else if(3==(i=t.s)||0==i&&0<t.X||!(1==r&&function(e,t){return!(Je(e.h)>=e.h.j-(e.s?1:0))&&(e.s?(e.i=t.D.concat(e.i),!0):!(1==e.G||2==e.G||e.B>=(e.Va?0:e.Wa))&&(e.s=Ce(c(e.Ga,e,t),wn(e,e.B)),e.B++,!0))}(e,t)||2==r&&gn(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),i){case 1:xn(e,5);break;case 4:xn(e,10);break;case 3:xn(e,6);break;default:xn(e,2)}}function wn(e,t){let n=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(n*=2),n*t}function xn(e,t){if(e.j.info("Error code "+t),2==t){var n=c(e.fb,e),r=e.Xa;const t=!r;r=new ot(r||"//www.google.com/images/cleardot.gif"),i.location&&"http"==i.location.protocol||at(r,"https"),dt(r),t?function(e,t){const n=new Ne;if(i.Image){const r=new Image;r.onload=u(zt,n,"TestLoadImage: loaded",!0,t,r),r.onerror=u(zt,n,"TestLoadImage: error",!1,t,r),r.onabort=u(zt,n,"TestLoadImage: abort",!1,t,r),r.ontimeout=u(zt,n,"TestLoadImage: timeout",!1,t,r),i.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(r.toString(),n):function(e,t){new Ne;const n=new AbortController,r=setTimeout((()=>{n.abort(),zt(0,0,!1,t)}),1e4);fetch(e,{signal:n.signal}).then((e=>{clearTimeout(r),e.ok?zt(0,0,!0,t):zt(0,0,!1,t)})).catch((()=>{clearTimeout(r),zt(0,0,!1,t)}))}(r.toString(),n)}else Te(2);e.G=0,e.l&&e.l.sa(t),In(e),cn(e)}function In(e){if(e.G=0,e.ka=[],e.l){const t=nt(e.h);0==t.length&&0==e.i.length||(f(e.ka,t),f(e.ka,e.i),e.h.i.length=0,h(e.i),e.i.length=0),e.l.ra()}}function Sn(e,t,n){var r=n instanceof ot?st(n):new ot(n);if(""!=r.g)t&&(r.g=t+"."+r.g),lt(r,r.s);else{var o=i.location;r=o.protocol,t=t?t+"."+o.hostname:o.hostname,o=+o.port;var s=new ot(null);r&&at(s,r),t&&(s.g=t),o&&lt(s,o),n&&(s.l=n),r=s}return n=e.D,t=e.ya,n&&t&&ut(r,n,t),ut(r,"VER",e.la),hn(e,r),r}function En(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new Gt(new Ut({eb:n})):new Gt(e.pa)).Ha(e.J),t}function _n(){}function Tn(){}function kn(e,t){ne.call(this),this.g=new sn(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!p(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!p(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new An(this)}function Cn(e){ve.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function Nn(){be.call(this),this.status=1}function An(e){this.g=e}(e=Gt.prototype).Ha=function(e){this.J=e},e.ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():De.g(),this.v=this.o?ge(this.o):ge(De),this.g.onreadystatechange=c(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(s){return void Xt(this,s)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var o in r)n.set(o,r[o]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find((e=>"content-type"==e.toLowerCase())),o=i.FormData&&e instanceof i.FormData,!(0<=Array.prototype.indexOf.call(Yt,t,void 0))||r||o||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,a]of n)this.g.setRequestHeader(i,a);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{tn(this),this.u=!0,this.g.send(e),this.u=!1}catch(s){Xt(this,s)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,re(this,"complete"),re(this,"abort"),en(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),en(this,!0)),Gt.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?Zt(this):this.bb())},e.bb=function(){Zt(this)},e.isActive=function(){return!!this.g},e.Z=function(){try{return 2<nn(this)?this.g.status:-1}catch(Tt){return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch(Tt){return""}},e.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),he(t)}},e.Ba=function(){return this.m},e.Ka=function(){return"string"===typeof this.l?this.l:String(this.l)},(e=sn.prototype).la=8,e.G=1,e.connect=function(e,t,n,r){Te(0),this.W=e,this.H=t||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.I=Sn(this,null,this.W),un(this)},e.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const i=new Le(this,this.j,e);let o=this.o;if(this.S&&(o?(o=b(o),x(o,this.S)):o=this.S),null!==this.m||this.O||(i.H=o,o=null),this.P)e:{for(var t=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=fn(this,i,t),ut(n=st(this.I),"RID",e),ut(n,"CVER",22),this.D&&ut(n,"X-HTTP-Session-Id",this.D),hn(this,n),o&&(this.O?t="headers="+encodeURIComponent(String(Kt(o)))+"&"+t:this.m&&Wt(n,this.m,o)),et(this.h,i),this.Ua&&ut(n,"TYPE","init"),this.P?(ut(n,"$req",t),ut(n,"SID","null"),i.T=!0,Fe(i,n,null)):Fe(i,n,t),this.G=2}}else 3==this.G&&(e?dn(this,e):0==this.i.length||Xe(this.h)||dn(this))},e.Fa=function(){if(this.u=null,yn(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=Ce(c(this.ab,this),e)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Te(10),ln(this),yn(this))},e.Za=function(){null!=this.C&&(this.C=null,ln(this),gn(this),Te(19))},e.fb=function(e){e?(this.j.info("Successfully pinged google.com"),Te(2)):(this.j.info("Failed to ping google.com"),Te(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=_n.prototype).ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){},Tn.prototype.g=function(e,t){return new kn(e,t)},d(kn,ne),kn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},kn.prototype.close=function(){an(this.g)},kn.prototype.o=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.u&&((n={}).__data__=de(e),e=n);t.i.push(new Qe(t.Ya++,e)),3==t.G&&un(t)},kn.prototype.N=function(){this.g.l=null,delete this.j,an(this.g),delete this.g,kn.aa.N.call(this)},d(Cn,ve),d(Nn,be),d(An,_n),An.prototype.ua=function(){re(this.g,"a")},An.prototype.ta=function(e){re(this.g,new Cn(e))},An.prototype.sa=function(e){re(this.g,new Nn)},An.prototype.ra=function(){re(this.g,"b")},Tn.prototype.createWebChannel=Tn.prototype.g,kn.prototype.send=kn.prototype.o,kn.prototype.open=kn.prototype.m,kn.prototype.close=kn.prototype.close,bt=xt.createWebChannelTransport=function(){return new Tn},vt=xt.getStatEventTarget=function(){return Ie()},yt=xt.Event=we,mt=xt.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Pe.NO_ERROR=0,Pe.TIMEOUT=8,Pe.HTTP_ERROR=6,gt=xt.ErrorCode=Pe,Re.COMPLETE="complete",pt=xt.EventType=Re,me.EventType=ye,ye.OPEN="a",ye.CLOSE="b",ye.ERROR="c",ye.MESSAGE="d",ne.prototype.listen=ne.prototype.K,ft=xt.WebChannel=me,xt.FetchXmlHttpFactory=Ut,Gt.prototype.listenOnce=Gt.prototype.L,Gt.prototype.getLastError=Gt.prototype.Ka,Gt.prototype.getLastErrorCode=Gt.prototype.Ba,Gt.prototype.getStatus=Gt.prototype.Z,Gt.prototype.getResponseJson=Gt.prototype.Oa,Gt.prototype.getResponseText=Gt.prototype.oa,Gt.prototype.send=Gt.prototype.ea,Gt.prototype.setWithCredentials=Gt.prototype.Ha,ht=xt.XhrIo=Gt}).apply("undefined"!==typeof wt?wt:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const It="@firebase/firestore",St="4.7.10";class Et{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Et.UNAUTHENTICATED=new Et(null),Et.GOOGLE_CREDENTIALS=new Et("google-credentials-uid"),Et.FIRST_PARTY=new Et("first-party-uid"),Et.MOCK_USER=new Et("mock-user");let _t="11.5.0";const Tt=new B("@firebase/firestore");function kt(){return Tt.logLevel}function Ct(e){if(Tt.logLevel<=z.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Dt);Tt.debug(`Firestore (${_t}): ${e}`,...i)}}function Nt(e){if(Tt.logLevel<=z.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Dt);Tt.error(`Firestore (${_t}): ${e}`,...i)}}function At(e){if(Tt.logLevel<=z.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Dt);Tt.warn(`Firestore (${_t}): ${e}`,...i)}}function Dt(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function Pt(){const e=`FIRESTORE (${_t}) INTERNAL ASSERTION FAILED: `+(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state");throw Nt(e),new Error(e)}function Rt(e,t){e||Pt()}function Ot(e,t){return e}const Lt={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Mt extends x{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class jt{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class zt{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Ft{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Et.UNAUTHENTICATED)))}shutdown(){}}class Vt{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class Ut{constructor(e){this.t=e,this.currentUser=Et.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Rt(void 0===this.o);let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new jt;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new jt,e.enqueueRetryable((()=>r(this.currentUser)))};const o=()=>{const t=i;e.enqueueRetryable((async()=>{await t.promise,await r(this.currentUser)}))},s=e=>{Ct("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((e=>s(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?s(e):(Ct("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new jt)}}),0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(Ct("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(Rt("string"==typeof t.accessToken),new zt(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Rt(null===e||"string"==typeof e),new Et(e)}}class $t{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=Et.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}}class Bt{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new $t(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable((()=>t(Et.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class qt{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Ht{constructor(e,t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null,this.V=null,He(e)&&e.settings.appCheckToken&&(this.V=e.settings.appCheckToken)}start(e,t){Rt(void 0===this.o);const n=e=>{null!=e.error&&Ct("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.R;return this.R=e.token,Ct("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const r=e=>{Ct("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit((e=>r(e))),setTimeout((()=>{if(!this.appCheck){const e=this.A.getImmediate({optional:!0});e?r(e):Ct("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.V)return Promise.resolve(new qt(this.V));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(Rt("string"==typeof e.token),this.R=e.token,new qt(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Kt(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}function Wt(){return new TextEncoder}class Gt{static newId(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const n=Kt(40);for(let r=0;r<n.length;++r)t.length<20&&n[r]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62))}return t}}function Qt(e,t){return e<t?-1:e>t?1:0}function Yt(e,t){let n=0;for(;n<e.length&&n<t.length;){const r=e.codePointAt(n),i=t.codePointAt(n);if(r!==i){if(r<128&&i<128)return Qt(r,i);{const o=Wt(),s=Jt(o.encode(Xt(e,n)),o.encode(Xt(t,n)));return 0!==s?s:Qt(r,i)}}n+=r>65535?2:1}return Qt(e.length,t.length)}function Xt(e,t){return e.codePointAt(t)>65535?e.substring(t,t+2):e.substring(t,t+1)}function Jt(e,t){for(let n=0;n<e.length&&n<t.length;++n)if(e[n]!==t[n])return Qt(e[n],t[n]);return Qt(e.length,t.length)}function Zt(e,t,n){return e.length===t.length&&e.every(((e,r)=>n(e,t[r])))}function en(e){return e+"\0"}const tn=-62135596800,nn=1e6;class rn{static now(){return rn.fromMillis(Date.now())}static fromDate(e){return rn.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*nn);return new rn(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Mt(Lt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Mt(Lt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<tn)throw new Mt(Lt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Mt(Lt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/nn}_compareTo(e){return this.seconds===e.seconds?Qt(this.nanoseconds,e.nanoseconds):Qt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-tn;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class on{static fromTimestamp(e){return new on(e)}static min(){return new on(new rn(0,0))}static max(){return new on(new rn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const sn="__name__";class an{constructor(e,t,n){void 0===t?t=0:t>e.length&&Pt(),void 0===n?n=e.length-t:n>e.length-t&&Pt(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===an.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof an?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=an.compareSegments(e.get(r),t.get(r));if(0!==n)return n}return Qt(e.length,t.length)}static compareSegments(e,t){const n=an.isNumericId(e),r=an.isNumericId(t);return n&&!r?-1:!n&&r?1:n&&r?an.extractNumericId(e).compare(an.extractNumericId(t)):Yt(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return lt.fromString(e.substring(4,e.length-2))}}class ln extends an{construct(e,t,n){return new ln(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n){if(i.indexOf("//")>=0)throw new Mt(Lt.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);e.push(...i.split("/").filter((e=>e.length>0)))}return new ln(e)}static emptyPath(){return new ln([])}}const cn=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class un extends an{construct(e,t,n){return new un(e,t,n)}static isValidIdentifier(e){return cn.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),un.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===sn}static keyField(){return new un([sn])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new Mt(Lt.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let o=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new Mt(Lt.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new Mt(Lt.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(o=!o,r++):"."!==t||o?(n+=t,r++):(i(),r++)}if(i(),o)throw new Mt(Lt.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new un(t)}static emptyPath(){return new un([])}}class dn{constructor(e){this.path=e}static fromPath(e){return new dn(ln.fromString(e))}static fromName(e){return new dn(ln.fromString(e).popFirst(5))}static empty(){return new dn(ln.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===ln.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return ln.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new dn(new ln(e.slice()))}}const hn=-1;class fn{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}function pn(e){return e.fields.find((e=>2===e.kind))}function gn(e){return e.fields.filter((e=>2!==e.kind))}fn.UNKNOWN_ID=-1;class mn{constructor(e,t){this.fieldPath=e,this.kind=t}}class yn{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new yn(0,wn.min())}}function vn(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=on.fromTimestamp(1e9===r?new rn(n+1,0):new rn(n,r));return new wn(i,dn.empty(),t)}function bn(e){return new wn(e.readTime,e.key,hn)}class wn{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new wn(on.min(),dn.empty(),hn)}static max(){return new wn(on.max(),dn.empty(),hn)}}function xn(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=dn.comparator(e.documentKey,t.documentKey),0!==n?n:Qt(e.largestBatchId,t.largestBatchId))}const In="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Sn{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function En(e){if(e.code!==Lt.FAILED_PRECONDITION||e.message!==In)throw e;Ct("LocalStore","Unexpectedly lost primary lease")}class _n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Pt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new _n(((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof _n?t:_n.resolve(t)}catch(e){return _n.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):_n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):_n.reject(t)}static resolve(e){return new _n(((t,n)=>{t(e)}))}static reject(e){return new _n(((t,n)=>{n(e)}))}static waitFor(e){return new _n(((t,n)=>{let r=0,i=0,o=!1;e.forEach((e=>{++r,e.next((()=>{++i,o&&i===r&&t()}),(e=>n(e)))})),o=!0,i===r&&t()}))}static or(e){let t=_n.resolve(!1);for(const n of e)t=t.next((e=>e?_n.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,r)=>{n.push(t.call(this,e,r))})),this.waitFor(n)}static mapArray(e,t){return new _n(((n,r)=>{const i=e.length,o=new Array(i);let s=0;for(let a=0;a<i;a++){const l=a;t(e[l]).next((e=>{o[l]=e,++s,s===i&&n(o)}),(e=>r(e)))}}))}static doWhile(e,t){return new _n(((n,r)=>{const i=()=>{!0===e()?t().next((()=>{i()}),r):n()};i()}))}}const Tn="SimpleDb";class kn{static open(e,t,n,r){try{return new kn(t,e.transaction(r,n))}catch(e){throw new Dn(t,e)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.m=new jt,this.transaction.oncomplete=()=>{this.m.resolve()},this.transaction.onabort=()=>{t.error?this.m.reject(new Dn(e,t.error)):this.m.resolve()},this.transaction.onerror=t=>{const n=Mn(t.target.error);this.m.reject(new Dn(e,n))}}get p(){return this.m.promise}abort(e){e&&this.m.reject(e),this.aborted||(Ct(Tn,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}S(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new Rn(t)}}class Cn{static delete(e){return Ct(Tn,"Removing database:",e),On(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!b())return!1;if(Cn.v())return!0;const e=m(),t=Cn.C(e),n=0<t&&t<10,r=Nn(e),i=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||i)}static v(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.__PRIVATE_env)||void 0===e?void 0:e.F)}static M(e,t){return e.store(t)}static C(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}constructor(e,t,n){this.name=e,this.version=t,this.O=n,12.2===Cn.C(m())&&Nt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async N(e){return this.db||(Ct(Tn,"Opening database:",this.name),this.db=await new Promise(((t,n)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=e=>{const n=e.target.result;t(n)},r.onblocked=()=>{n(new Dn(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=t=>{const r=t.target.error;"VersionError"===r.name?n(new Mt(Lt.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===r.name?n(new Mt(Lt.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+r)):n(new Dn(e,r))},r.onupgradeneeded=e=>{Ct(Tn,'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);const t=e.target.result;this.O.B(t,r.transaction,e.oldVersion,this.version).next((()=>{Ct(Tn,"Database upgrade to version "+this.version+" complete")}))}}))),this.L&&(this.db.onversionchange=e=>this.L(e)),this.db}k(e){this.L=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,r){const i="readonly"===t;let o=0;for(;;){++o;try{this.db=await this.N(e);const t=kn.open(this.db,e,i?"readonly":"readwrite",n),o=r(t).next((e=>(t.S(),e))).catch((e=>(t.abort(e),_n.reject(e)))).toPromise();return o.catch((()=>{})),await t.p,o}catch(e){const t=e,n="FirebaseError"!==t.name&&o<3;if(Ct(Tn,"Transaction failed with error:",t.message,"Retrying:",n),this.close(),!n)return Promise.reject(t)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Nn(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class An{constructor(e){this.q=e,this.$=!1,this.U=null}get isDone(){return this.$}get K(){return this.U}set cursor(e){this.q=e}done(){this.$=!0}W(e){this.U=e}delete(){return On(this.q.delete())}}class Dn extends Mt{constructor(e,t){super(Lt.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Pn(e){return"IndexedDbTransactionError"===e.name}class Rn{constructor(e){this.store=e}put(e,t){let n;return void 0!==t?(Ct(Tn,"PUT",this.store.name,e,t),n=this.store.put(t,e)):(Ct(Tn,"PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),On(n)}add(e){return Ct(Tn,"ADD",this.store.name,e,e),On(this.store.add(e))}get(e){return On(this.store.get(e)).next((t=>(void 0===t&&(t=null),Ct(Tn,"GET",this.store.name,e,t),t)))}delete(e){return Ct(Tn,"DELETE",this.store.name,e),On(this.store.delete(e))}count(){return Ct(Tn,"COUNT",this.store.name),On(this.store.count())}G(e,t){const n=this.options(e,t),r=n.index?this.store.index(n.index):this.store;if("function"==typeof r.getAll){const e=r.getAll(n.range);return new _n(((t,n)=>{e.onerror=e=>{n(e.target.error)},e.onsuccess=e=>{t(e.target.result)}}))}{const e=this.cursor(n),t=[];return this.j(e,((e,n)=>{t.push(n)})).next((()=>t))}}H(e,t){const n=this.store.getAll(e,null===t?void 0:t);return new _n(((e,t)=>{n.onerror=e=>{t(e.target.error)},n.onsuccess=t=>{e(t.target.result)}}))}J(e,t){Ct(Tn,"DELETE ALL",this.store.name);const n=this.options(e,t);n.Y=!1;const r=this.cursor(n);return this.j(r,((e,t,n)=>n.delete()))}Z(e,t){let n;t?n=e:(n={},t=e);const r=this.cursor(n);return this.j(r,t)}X(e){const t=this.cursor({});return new _n(((n,r)=>{t.onerror=e=>{const t=Mn(e.target.error);r(t)},t.onsuccess=t=>{const r=t.target.result;r?e(r.primaryKey,r.value).next((e=>{e?r.continue():n()})):n()}}))}j(e,t){const n=[];return new _n(((r,i)=>{e.onerror=e=>{i(e.target.error)},e.onsuccess=e=>{const i=e.target.result;if(!i)return void r();const o=new An(i),s=t(i.primaryKey,i.value,o);if(s instanceof _n){const e=s.catch((e=>(o.done(),_n.reject(e))));n.push(e)}o.isDone?r():null===o.K?i.continue():i.continue(o.K)}})).next((()=>_n.waitFor(n)))}options(e,t){let n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.Y?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function On(e){return new _n(((t,n)=>{e.onsuccess=e=>{const n=e.target.result;t(n)},e.onerror=e=>{const t=Mn(e.target.error);n(t)}}))}let Ln=!1;function Mn(e){const t=Cn.C(m());if(t>=12.2&&t<13){const t="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(t)>=0){const e=new Mt("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Ln||(Ln=!0,setTimeout((()=>{throw e}),0)),e}}return e}const jn="IndexBackfiller";class zn{constructor(e,t){this.asyncQueue=e,this.ee=t,this.task=null}start(){this.te(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}te(e){Ct(jn,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const e=await this.ee.ne();Ct(jn,`Documents written: ${e}`)}catch(e){Pn(e)?Ct(jn,"Ignoring IndexedDB error during index backfill: ",e):await En(e)}await this.te(6e4)}))}}class Fn{constructor(e,t){this.localStore=e,this.persistence=t}async ne(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.re(t,e)))}re(e,t){const n=new Set;let r=t,i=!0;return _n.doWhile((()=>!0===i&&r>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((t=>{if(null!==t&&!n.has(t))return Ct(jn,`Processing collection: ${t}`),this.ie(e,t,r).next((e=>{r-=e,n.add(t)}));i=!1})))).next((()=>t-r))}ie(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((r=>this.localStore.localDocuments.getNextDocuments(e,t,r,n).next((n=>{const i=n.changes;return this.localStore.indexManager.updateIndexEntries(e,i).next((()=>this.se(r,n))).next((n=>(Ct(jn,`Updating offset: ${n}`),this.localStore.indexManager.updateCollectionGroup(e,t,n)))).next((()=>i.size))}))))}se(e,t){let n=e;return t.changes.forEach(((e,t)=>{const r=bn(t);xn(r,n)>0&&(n=r)})),new wn(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}class Vn{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.oe(e),this._e=e=>t.writeSequenceNumber(e))}oe(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this._e&&this._e(e),e}}Vn.ae=-1;const Un=-1;function $n(e){return null==e}function Bn(e){return 0===e&&1/e==-1/0}function qn(e){return"number"==typeof e&&Number.isInteger(e)&&!Bn(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}const Hn="\x01";function Kn(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=Gn(t)),t=Wn(e.get(n),t);return Gn(t)}function Wn(e,t){let n=t;const r=e.length;for(let i=0;i<r;i++){const t=e.charAt(i);switch(t){case"\0":n+="\x01\x10";break;case Hn:n+="\x01\x11";break;default:n+=t}}return n}function Gn(e){return e+Hn+"\x01"}function Qn(e){const t=e.length;if(Rt(t>=2),2===t)return Rt(e.charAt(0)===Hn&&"\x01"===e.charAt(1)),ln.emptyPath();const n=t-2,r=[];let i="";for(let o=0;o<t;){const t=e.indexOf(Hn,o);switch((t<0||t>n)&&Pt(),e.charAt(t+1)){case"\x01":const n=e.substring(o,t);let s;0===i.length?s=n:(i+=n,s=i,i=""),r.push(s);break;case"\x10":i+=e.substring(o,t),i+="\0";break;case"\x11":i+=e.substring(o,t+1);break;default:Pt()}o=t+2}return new ln(r)}const Yn="remoteDocuments",Xn="owner",Jn="owner",Zn="mutationQueues",er="mutations",tr="batchId",nr="userMutationsIndex",rr=["userId","batchId"];function ir(e,t){return[e,Kn(t)]}function or(e,t,n){return[e,Kn(t),n]}const sr={},ar="documentMutations",lr="remoteDocumentsV14",cr=["prefixPath","collectionGroup","readTime","documentId"],ur="documentKeyIndex",dr=["prefixPath","collectionGroup","documentId"],hr="collectionGroupIndex",fr=["collectionGroup","readTime","prefixPath","documentId"],pr="remoteDocumentGlobal",gr="remoteDocumentGlobalKey",mr="targets",yr="queryTargetsIndex",vr=["canonicalId","targetId"],br="targetDocuments",wr=["targetId","path"],xr="documentTargetsIndex",Ir=["path","targetId"],Sr="targetGlobalKey",Er="targetGlobal",_r="collectionParents",Tr=["collectionId","parent"],kr="clientMetadata",Cr="bundles",Nr="namedQueries",Ar="indexConfiguration",Dr="collectionGroupIndex",Pr="indexState",Rr=["indexId","uid"],Or="sequenceNumberIndex",Lr=["uid","sequenceNumber"],Mr="indexEntries",jr=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],zr="documentKeyIndex",Fr=["indexId","uid","orderedDocumentKey"],Vr="documentOverlays",Ur=["userId","collectionPath","documentId"],$r="collectionPathOverlayIndex",Br=["userId","collectionPath","largestBatchId"],qr="collectionGroupOverlayIndex",Hr=["userId","collectionGroup","largestBatchId"],Kr="globals",Wr=[Zn,er,ar,Yn,mr,Xn,Er,br,kr,pr,_r,Cr,Nr],Gr=[...Wr,Vr],Qr=[Zn,er,ar,lr,mr,Xn,Er,br,kr,pr,_r,Cr,Nr,Vr],Yr=Qr,Xr=[...Yr,Ar,Pr,Mr],Jr=Xr,Zr=[...Xr,Kr];class ei extends Sn{constructor(e,t){super(),this.ue=e,this.currentSequenceNumber=t}}function ti(e,t){const n=Ot(e);return Cn.M(n.ue,t)}function ni(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function ri(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function ii(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class oi{constructor(e,t){this.comparator=e,this.root=t||ai.EMPTY}insert(e,t){return new oi(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ai.BLACK,null,null))}remove(e){return new oi(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ai.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new si(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new si(this.root,e,this.comparator,!1)}getReverseIterator(){return new si(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new si(this.root,e,this.comparator,!0)}}class si{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ai{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:ai.RED,this.left=null!=r?r:ai.EMPTY,this.right=null!=i?i:ai.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new ai(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return ai.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return ai.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ai.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ai.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Pt();if(this.right.isRed())throw Pt();const e=this.left.check();if(e!==this.right.check())throw Pt();return e+(this.isRed()?0:1)}}ai.EMPTY=null,ai.RED=!0,ai.BLACK=!1,ai.EMPTY=new class{constructor(){this.size=0}get key(){throw Pt()}get value(){throw Pt()}get color(){throw Pt()}get left(){throw Pt()}get right(){throw Pt()}copy(e,t,n,r,i){return this}insert(e,t,n){return new ai(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class li{constructor(e){this.comparator=e,this.data=new oi(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new ci(this.data.getIterator())}getIteratorFrom(e){return new ci(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof li))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new li(this.comparator);return t.data=e,t}}class ci{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function ui(e){return e.hasNext()?e.getNext():void 0}class di{constructor(e){this.fields=e,e.sort(un.comparator)}static empty(){return new di([])}unionWith(e){let t=new li(un.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new di(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Zt(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class hi extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class fi{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new hi("Invalid base64 string: "+e):e}}(e);return new fi(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new fi(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Qt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}fi.EMPTY_BYTE_STRING=new fi("");const pi=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function gi(e){if(Rt(!!e),"string"==typeof e){let t=0;const n=pi.exec(e);if(Rt(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:mi(e.seconds),nanos:mi(e.nanos)}}function mi(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function yi(e){return"string"==typeof e?fi.fromBase64String(e):fi.fromUint8Array(e)}const vi="server_timestamp",bi="__type__",wi="__previous_value__",xi="__local_write_time__";function Ii(e){var t,n;return(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{})[bi])||void 0===n?void 0:n.stringValue)===vi}function Si(e){const t=e.mapValue.fields[wi];return Ii(t)?Si(t):t}function Ei(e){const t=gi(e.mapValue.fields[xi].timestampValue);return new rn(t.seconds,t.nanos)}class _i{constructor(e,t,n,r,i,o,s,a,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.longPollingOptions=a,this.useFetchStreams=l}}const Ti="(default)";class ki{constructor(e,t){this.projectId=e,this.database=t||Ti}static empty(){return new ki("","")}get isDefaultDatabase(){return this.database===Ti}isEqual(e){return e instanceof ki&&e.projectId===this.projectId&&e.database===this.database}}const Ci="__type__",Ni="__max__",Ai={mapValue:{fields:{__type__:{stringValue:Ni}}}},Di="__vector__",Pi="value",Ri={nullValue:"NULL_VALUE"};function Oi(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Ii(e)?4:Xi(e)?9007199254740991:Qi(e)?10:11:Pt()}function Li(e,t){if(e===t)return!0;const n=Oi(e);if(n!==Oi(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Ei(e).isEqual(Ei(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=gi(e.timestampValue),r=gi(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return yi(e.bytesValue).isEqual(yi(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return mi(e.geoPointValue.latitude)===mi(t.geoPointValue.latitude)&&mi(e.geoPointValue.longitude)===mi(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return mi(e.integerValue)===mi(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=mi(e.doubleValue),r=mi(t.doubleValue);return n===r?Bn(n)===Bn(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return Zt(e.arrayValue.values||[],t.arrayValue.values||[],Li);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(ni(n)!==ni(r))return!1;for(const i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Li(n[i],r[i])))return!1;return!0}(e,t);default:return Pt()}}function Mi(e,t){return void 0!==(e.values||[]).find((e=>Li(e,t)))}function ji(e,t){if(e===t)return 0;const n=Oi(e),r=Oi(t);if(n!==r)return Qt(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Qt(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=mi(e.integerValue||e.doubleValue),r=mi(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return zi(e.timestampValue,t.timestampValue);case 4:return zi(Ei(e),Ei(t));case 5:return Yt(e.stringValue,t.stringValue);case 6:return function(e,t){const n=yi(e),r=yi(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let i=0;i<n.length&&i<r.length;i++){const e=Qt(n[i],r[i]);if(0!==e)return e}return Qt(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=Qt(mi(e.latitude),mi(t.latitude));return 0!==n?n:Qt(mi(e.longitude),mi(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return Fi(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n,r,i,o;const s=e.fields||{},a=t.fields||{},l=null===(n=s[Pi])||void 0===n?void 0:n.arrayValue,c=null===(r=a[Pi])||void 0===r?void 0:r.arrayValue,u=Qt((null===(i=null==l?void 0:l.values)||void 0===i?void 0:i.length)||0,(null===(o=null==c?void 0:c.values)||void 0===o?void 0:o.length)||0);return 0!==u?u:Fi(l,c)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===Ai.mapValue&&t===Ai.mapValue)return 0;if(e===Ai.mapValue)return 1;if(t===Ai.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},o=Object.keys(i);r.sort(),o.sort();for(let s=0;s<r.length&&s<o.length;++s){const e=Yt(r[s],o[s]);if(0!==e)return e;const t=ji(n[r[s]],i[o[s]]);if(0!==t)return t}return Qt(r.length,o.length)}(e.mapValue,t.mapValue);default:throw Pt()}}function zi(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return Qt(e,t);const n=gi(e),r=gi(t),i=Qt(n.seconds,r.seconds);return 0!==i?i:Qt(n.nanos,r.nanos)}function Fi(e,t){const n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){const e=ji(n[i],r[i]);if(e)return e}return Qt(n.length,r.length)}function Vi(e){return Ui(e)}function Ui(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=gi(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return yi(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return dn.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=Ui(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+=`${i}:${Ui(e.fields[i])}`;return n+"}"}(e.mapValue):Pt()}function $i(e){switch(Oi(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=Si(e);return t?16+$i(t):16;case 5:return 2*e.stringValue.length;case 6:return yi(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(e){return(e.values||[]).reduce(((e,t)=>e+$i(t)),0)}(e.arrayValue);case 10:case 11:return function(e){let t=0;return ri(e.fields,((e,n)=>{t+=e.length+$i(n)})),t}(e.mapValue);default:throw Pt()}}function Bi(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function qi(e){return!!e&&"integerValue"in e}function Hi(e){return!!e&&"arrayValue"in e}function Ki(e){return!!e&&"nullValue"in e}function Wi(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Gi(e){return!!e&&"mapValue"in e}function Qi(e){var t,n;return(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{})[Ci])||void 0===n?void 0:n.stringValue)===Di}function Yi(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return ri(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=Yi(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Yi(e.arrayValue.values[n]);return t}return Object.assign({},e)}function Xi(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===Ni}const Ji={mapValue:{fields:{[Ci]:{stringValue:Di},[Pi]:{arrayValue:{}}}}};function Zi(e){return"nullValue"in e?Ri:"booleanValue"in e?{booleanValue:!1}:"integerValue"in e||"doubleValue"in e?{doubleValue:NaN}:"timestampValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in e?{stringValue:""}:"bytesValue"in e?{bytesValue:""}:"referenceValue"in e?Bi(ki.empty(),dn.empty()):"geoPointValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in e?{arrayValue:{}}:"mapValue"in e?Qi(e)?Ji:{mapValue:{}}:Pt()}function eo(e){return"nullValue"in e?{booleanValue:!1}:"booleanValue"in e?{doubleValue:NaN}:"integerValue"in e||"doubleValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in e?{stringValue:""}:"stringValue"in e?{bytesValue:""}:"bytesValue"in e?Bi(ki.empty(),dn.empty()):"referenceValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in e?{arrayValue:{}}:"arrayValue"in e?Ji:"mapValue"in e?Qi(e)?{mapValue:{}}:Ai:Pt()}function to(e,t){const n=ji(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function no(e,t){const n=ji(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}class ro{constructor(e){this.value=e}static empty(){return new ro({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Gi(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Yi(t)}setAll(e){let t=un.emptyPath(),n={},r=[];e.forEach(((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=Yi(e):r.push(i.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());Gi(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Li(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];Gi(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){ri(t,((t,n)=>e[t]=n));for(const r of n)delete e[r]}clone(){return new ro(Yi(this.value))}}function io(e){const t=[];return ri(e.fields,((e,n)=>{const r=new un([e]);if(Gi(n)){const e=io(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)})),new di(t)}class oo{constructor(e,t,n,r,i,o,s){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=o,this.documentState=s}static newInvalidDocument(e){return new oo(e,0,on.min(),on.min(),on.min(),ro.empty(),0)}static newFoundDocument(e,t,n,r){return new oo(e,1,t,on.min(),n,r,0)}static newNoDocument(e,t){return new oo(e,2,t,on.min(),on.min(),ro.empty(),0)}static newUnknownDocument(e,t){return new oo(e,3,t,on.min(),on.min(),ro.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(on.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ro.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ro.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=on.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof oo&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new oo(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class so{constructor(e,t){this.position=e,this.inclusive=t}}function ao(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const o=t[i],s=e.position[i];if(r=o.field.isKeyField()?dn.comparator(dn.fromName(s.referenceValue),n.key):ji(s,n.data.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return r}function lo(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Li(e.position[n],t.position[n]))return!1;return!0}class co{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function uo(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class ho{}class fo extends ho{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new So(e,t,n):"array-contains"===t?new ko(e,n):"in"===t?new Co(e,n):"not-in"===t?new No(e,n):"array-contains-any"===t?new Ao(e,n):new fo(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new Eo(e,n):new _o(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(ji(t,this.value)):null!==t&&Oi(this.value)===Oi(t)&&this.matchesComparison(ji(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Pt()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class po extends ho{constructor(e,t){super(),this.filters=e,this.op=t,this.ce=null}static create(e,t){return new po(e,t)}matches(e){return go(this)?void 0===this.filters.find((t=>!t.matches(e))):void 0!==this.filters.find((t=>t.matches(e)))}getFlattenedFilters(){return null!==this.ce||(this.ce=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.ce}getFilters(){return Object.assign([],this.filters)}}function go(e){return"and"===e.op}function mo(e){return"or"===e.op}function yo(e){return vo(e)&&go(e)}function vo(e){for(const t of e.filters)if(t instanceof po)return!1;return!0}function bo(e){if(e instanceof fo)return e.field.canonicalString()+e.op.toString()+Vi(e.value);if(yo(e))return e.filters.map((e=>bo(e))).join(",");{const t=e.filters.map((e=>bo(e))).join(",");return`${e.op}(${t})`}}function wo(e,t){return e instanceof fo?function(e,t){return t instanceof fo&&e.op===t.op&&e.field.isEqual(t.field)&&Li(e.value,t.value)}(e,t):e instanceof po?function(e,t){return t instanceof po&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce(((e,n,r)=>e&&wo(n,t.filters[r])),!0)}(e,t):void Pt()}function xo(e,t){const n=e.filters.concat(t);return po.create(n,e.op)}function Io(e){return e instanceof fo?function(e){return`${e.field.canonicalString()} ${e.op} ${Vi(e.value)}`}(e):e instanceof po?function(e){return e.op.toString()+" {"+e.getFilters().map(Io).join(" ,")+"}"}(e):"Filter"}class So extends fo{constructor(e,t,n){super(e,t,n),this.key=dn.fromName(n.referenceValue)}matches(e){const t=dn.comparator(e.key,this.key);return this.matchesComparison(t)}}class Eo extends fo{constructor(e,t){super(e,"in",t),this.keys=To("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class _o extends fo{constructor(e,t){super(e,"not-in",t),this.keys=To("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function To(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>dn.fromName(e.referenceValue)))}class ko extends fo{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Hi(t)&&Mi(t.arrayValue,this.value)}}class Co extends fo{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Mi(this.value.arrayValue,t)}}class No extends fo{constructor(e,t){super(e,"not-in",t)}matches(e){if(Mi(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Mi(this.value.arrayValue,t)}}class Ao extends fo{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Hi(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>Mi(this.value.arrayValue,e)))}}class Do{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.le=null}}function Po(e){return new Do(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function Ro(e){const t=Ot(e);if(null===t.le){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>bo(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),$n(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>Vi(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>Vi(e))).join(",")),t.le=e}return t.le}function Oo(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!uo(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!wo(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!lo(e.startAt,t.startAt)&&lo(e.endAt,t.endAt)}function Lo(e){return dn.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function Mo(e,t){return e.filters.filter((e=>e instanceof fo&&e.field.isEqual(t)))}function jo(e,t,n){let r=Ri,i=!0;for(const o of Mo(e,t)){let e=Ri,t=!0;switch(o.op){case"<":case"<=":e=Zi(o.value);break;case"==":case"in":case">=":e=o.value;break;case">":e=o.value,t=!1;break;case"!=":case"not-in":e=Ri}to({value:r,inclusive:i},{value:e,inclusive:t})<0&&(r=e,i=t)}if(null!==n)for(let o=0;o<e.orderBy.length;++o)if(e.orderBy[o].field.isEqual(t)){const e=n.position[o];to({value:r,inclusive:i},{value:e,inclusive:n.inclusive})<0&&(r=e,i=n.inclusive);break}return{value:r,inclusive:i}}function zo(e,t,n){let r=Ai,i=!0;for(const o of Mo(e,t)){let e=Ai,t=!0;switch(o.op){case">=":case">":e=eo(o.value),t=!1;break;case"==":case"in":case"<=":e=o.value;break;case"<":e=o.value,t=!1;break;case"!=":case"not-in":e=Ai}no({value:r,inclusive:i},{value:e,inclusive:t})>0&&(r=e,i=t)}if(null!==n)for(let o=0;o<e.orderBy.length;++o)if(e.orderBy[o].field.isEqual(t)){const e=n.position[o];no({value:r,inclusive:i},{value:e,inclusive:n.inclusive})>0&&(r=e,i=n.inclusive);break}return{value:r,inclusive:i}}class Fo{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=a,this.he=null,this.Pe=null,this.Te=null,this.startAt,this.endAt}}function Vo(e,t,n,r,i,o,s,a){return new Fo(e,t,n,r,i,o,s,a)}function Uo(e){return new Fo(e)}function $o(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Bo(e){return null!==e.collectionGroup}function qo(e){const t=Ot(e);if(null===t.he){t.he=[];const e=new Set;for(const i of t.explicitOrderBy)t.he.push(i),e.add(i.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new li(un.comparator);return e.filters.forEach((e=>{e.getFlattenedFilters().forEach((e=>{e.isInequality()&&(t=t.add(e.field))}))})),t}(t);r.forEach((r=>{e.has(r.canonicalString())||r.isKeyField()||t.he.push(new co(r,n))})),e.has(un.keyField().canonicalString())||t.he.push(new co(un.keyField(),n))}return t.he}function Ho(e){const t=Ot(e);return t.Pe||(t.Pe=Ko(t,qo(e))),t.Pe}function Ko(e,t){if("F"===e.limitType)return Po(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map((e=>{const t="desc"===e.dir?"asc":"desc";return new co(e.field,t)}));const n=e.endAt?new so(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new so(e.startAt.position,e.startAt.inclusive):null;return Po(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function Wo(e,t){const n=e.filters.concat([t]);return new Fo(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function Go(e,t,n){return new Fo(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Qo(e,t){return Oo(Ho(e),Ho(t))&&e.limitType===t.limitType}function Yo(e){return`${Ro(Ho(e))}|lt:${e.limitType}`}function Xo(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>Io(e))).join(", ")}]`),$n(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e))).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>Vi(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>Vi(e))).join(",")),`Target(${t})`}(Ho(e))}; limitType=${e.limitType})`}function Jo(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):dn.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of qo(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=ao(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,qo(e),t))&&!(e.endAt&&!function(e,t,n){const r=ao(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,qo(e),t))}(e,t)}function Zo(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function es(e){return(t,n)=>{let r=!1;for(const i of qo(e)){const e=ts(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function ts(e,t,n){const r=e.field.isKeyField()?dn.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?ji(r,i):Pt()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return Pt()}}class ns{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,i]of n)if(this.equalsFn(r,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){ri(this.inner,((t,n)=>{for(const[r,i]of n)e(r,i)}))}isEmpty(){return ii(this.inner)}size(){return this.innerSize}}const rs=new oi(dn.comparator);function is(){return rs}const os=new oi(dn.comparator);function ss(){let e=os;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.insert(i.key,i);return e}function as(e){let t=os;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function ls(){return us()}function cs(){return us()}function us(){return new ns((e=>e.toString()),((e,t)=>e.isEqual(t)))}const ds=new oi(dn.comparator),hs=new li(dn.comparator);function fs(){let e=hs;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.add(i);return e}const ps=new li(Qt);function gs(){return ps}function ms(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Bn(t)?"-0":t}}function ys(e){return{integerValue:""+e}}function vs(e,t){return qn(t)?ys(t):ms(e,t)}class bs{constructor(){this._=void 0}}function ws(e,t,n){return e instanceof Ss?function(e,t){const n={fields:{[bi]:{stringValue:vi},[xi]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&Ii(t)&&(t=Si(t)),t&&(n.fields[wi]=t),{mapValue:n}}(n,t):e instanceof Es?_s(e,t):e instanceof Ts?ks(e,t):function(e,t){const n=Is(e,t),r=Ns(n)+Ns(e.Ie);return qi(n)&&qi(e.Ie)?ys(r):ms(e.serializer,r)}(e,t)}function xs(e,t,n){return e instanceof Es?_s(e,t):e instanceof Ts?ks(e,t):n}function Is(e,t){return e instanceof Cs?function(e){return qi(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class Ss extends bs{}class Es extends bs{constructor(e){super(),this.elements=e}}function _s(e,t){const n=As(t);for(const r of e.elements)n.some((e=>Li(e,r)))||n.push(r);return{arrayValue:{values:n}}}class Ts extends bs{constructor(e){super(),this.elements=e}}function ks(e,t){let n=As(t);for(const r of e.elements)n=n.filter((e=>!Li(e,r)));return{arrayValue:{values:n}}}class Cs extends bs{constructor(e,t){super(),this.serializer=e,this.Ie=t}}function Ns(e){return mi(e.integerValue||e.doubleValue)}function As(e){return Hi(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class Ds{constructor(e,t){this.field=e,this.transform=t}}class Ps{constructor(e,t){this.version=e,this.transformResults=t}}class Rs{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Rs}static exists(e){return new Rs(void 0,e)}static updateTime(e){return new Rs(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Os(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Ls{}function Ms(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Ks(e.key,Rs.none()):new Us(e.key,e.data,Rs.none());{const n=e.data,r=ro.empty();let i=new li(un.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new $s(e.key,r,new di(i.toArray()),Rs.none())}}function js(e,t,n){e instanceof Us?function(e,t,n){const r=e.value.clone(),i=qs(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof $s?function(e,t,n){if(!Os(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=qs(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(Bs(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function zs(e,t,n,r){return e instanceof Us?function(e,t,n,r){if(!Os(e.precondition,t))return n;const i=e.value.clone(),o=Hs(e.fieldTransforms,r,t);return i.setAll(o),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof $s?function(e,t,n,r){if(!Os(e.precondition,t))return n;const i=Hs(e.fieldTransforms,r,t),o=t.data;return o.setAll(Bs(e)),o.setAll(i),t.convertToFoundDocument(t.version,o).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,r):function(e,t,n){return Os(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Fs(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=Is(r.transform,e||null);null!=i&&(null===n&&(n=ro.empty()),n.set(r.field,i))}return n||null}function Vs(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&Zt(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Es&&t instanceof Es||e instanceof Ts&&t instanceof Ts?Zt(e.elements,t.elements,Li):e instanceof Cs&&t instanceof Cs?Li(e.Ie,t.Ie):e instanceof Ss&&t instanceof Ss}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Us extends Ls{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class $s extends Ls{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Bs(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}})),t}function qs(e,t,n){const r=new Map;Rt(e.length===n.length);for(let i=0;i<n.length;i++){const o=e[i],s=o.transform,a=t.data.field(o.field);r.set(o.field,xs(s,a,n[i]))}return r}function Hs(e,t,n){const r=new Map;for(const i of e){const e=i.transform,o=n.data.field(i.field);r.set(i.field,ws(e,o,t))}return r}class Ks extends Ls{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Ws extends Ls{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Gs{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&js(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=zs(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=zs(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=cs();return this.mutations.forEach((r=>{const i=e.get(r.key),o=i.overlayedDocument;let s=this.applyToLocalView(o,i.mutatedFields);s=t.has(r.key)?null:s;const a=Ms(o,s);null!==a&&n.set(r.key,a),o.isValidDocument()||o.convertToNoDocument(on.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),fs())}isEqual(e){return this.batchId===e.batchId&&Zt(this.mutations,e.mutations,((e,t)=>Vs(e,t)))&&Zt(this.baseMutations,e.baseMutations,((e,t)=>Vs(e,t)))}}class Qs{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){Rt(e.mutations.length===n.length);let r=ds;const i=e.mutations;for(let o=0;o<i.length;o++)r=r.insert(i[o].key,n[o].version);return new Qs(e,t,n,r)}}class Ys{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Xs{constructor(e,t){this.count=e,this.unchangedNames=t}}var Js,Zs;function ea(e){switch(e){case Lt.OK:return Pt();case Lt.CANCELLED:case Lt.UNKNOWN:case Lt.DEADLINE_EXCEEDED:case Lt.RESOURCE_EXHAUSTED:case Lt.INTERNAL:case Lt.UNAVAILABLE:case Lt.UNAUTHENTICATED:return!1;case Lt.INVALID_ARGUMENT:case Lt.NOT_FOUND:case Lt.ALREADY_EXISTS:case Lt.PERMISSION_DENIED:case Lt.FAILED_PRECONDITION:case Lt.ABORTED:case Lt.OUT_OF_RANGE:case Lt.UNIMPLEMENTED:case Lt.DATA_LOSS:return!0;default:return Pt()}}function ta(e){if(void 0===e)return Nt("GRPC error has no .code"),Lt.UNKNOWN;switch(e){case Js.OK:return Lt.OK;case Js.CANCELLED:return Lt.CANCELLED;case Js.UNKNOWN:return Lt.UNKNOWN;case Js.DEADLINE_EXCEEDED:return Lt.DEADLINE_EXCEEDED;case Js.RESOURCE_EXHAUSTED:return Lt.RESOURCE_EXHAUSTED;case Js.INTERNAL:return Lt.INTERNAL;case Js.UNAVAILABLE:return Lt.UNAVAILABLE;case Js.UNAUTHENTICATED:return Lt.UNAUTHENTICATED;case Js.INVALID_ARGUMENT:return Lt.INVALID_ARGUMENT;case Js.NOT_FOUND:return Lt.NOT_FOUND;case Js.ALREADY_EXISTS:return Lt.ALREADY_EXISTS;case Js.PERMISSION_DENIED:return Lt.PERMISSION_DENIED;case Js.FAILED_PRECONDITION:return Lt.FAILED_PRECONDITION;case Js.ABORTED:return Lt.ABORTED;case Js.OUT_OF_RANGE:return Lt.OUT_OF_RANGE;case Js.UNIMPLEMENTED:return Lt.UNIMPLEMENTED;case Js.DATA_LOSS:return Lt.DATA_LOSS;default:return Pt()}}(Zs=Js||(Js={}))[Zs.OK=0]="OK",Zs[Zs.CANCELLED=1]="CANCELLED",Zs[Zs.UNKNOWN=2]="UNKNOWN",Zs[Zs.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Zs[Zs.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Zs[Zs.NOT_FOUND=5]="NOT_FOUND",Zs[Zs.ALREADY_EXISTS=6]="ALREADY_EXISTS",Zs[Zs.PERMISSION_DENIED=7]="PERMISSION_DENIED",Zs[Zs.UNAUTHENTICATED=16]="UNAUTHENTICATED",Zs[Zs.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Zs[Zs.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Zs[Zs.ABORTED=10]="ABORTED",Zs[Zs.OUT_OF_RANGE=11]="OUT_OF_RANGE",Zs[Zs.UNIMPLEMENTED=12]="UNIMPLEMENTED",Zs[Zs.INTERNAL=13]="INTERNAL",Zs[Zs.UNAVAILABLE=14]="UNAVAILABLE",Zs[Zs.DATA_LOSS=15]="DATA_LOSS";let na=null;const ra=new lt([4294967295,4294967295],0);function ia(e){const t=Wt().encode(e),n=new ct;return n.update(t),new Uint8Array(n.digest())}function oa(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),o=t.getUint32(12,!0);return[new lt([n,r],0),new lt([i,o],0)]}class sa{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new aa(`Invalid padding: ${t}`);if(n<0)throw new aa(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new aa(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new aa(`Invalid padding when bitmap length is 0: ${t}`);this.Ee=8*e.length-t,this.de=lt.fromNumber(this.Ee)}Ae(e,t,n){let r=e.add(t.multiply(lt.fromNumber(n)));return 1===r.compare(ra)&&(r=new lt([r.getBits(0),r.getBits(1)],0)),r.modulo(this.de).toNumber()}Re(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Ee)return!1;const t=ia(e),[n,r]=oa(t);for(let i=0;i<this.hashCount;i++){const e=this.Ae(n,r,i);if(!this.Re(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new sa(i,r,t);return n.forEach((e=>o.insert(e))),o}insert(e){if(0===this.Ee)return;const t=ia(e),[n,r]=oa(t);for(let i=0;i<this.hashCount;i++){const e=this.Ae(n,r,i);this.Ve(e)}}Ve(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class aa extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class la{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,ca.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new la(on.min(),r,new oi(Qt),is(),fs())}}class ca{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new ca(n,t,fs(),fs(),fs())}}class ua{constructor(e,t,n,r){this.me=e,this.removedTargetIds=t,this.key=n,this.fe=r}}class da{constructor(e,t){this.targetId=e,this.ge=t}}class ha{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:fi.EMPTY_BYTE_STRING,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class fa{constructor(){this.pe=0,this.ye=ma(),this.we=fi.EMPTY_BYTE_STRING,this.Se=!1,this.be=!0}get current(){return this.Se}get resumeToken(){return this.we}get De(){return 0!==this.pe}get ve(){return this.be}Ce(e){e.approximateByteSize()>0&&(this.be=!0,this.we=e)}Fe(){let e=fs(),t=fs(),n=fs();return this.ye.forEach(((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:Pt()}})),new ca(this.we,this.Se,e,t,n)}Me(){this.be=!1,this.ye=ma()}xe(e,t){this.be=!0,this.ye=this.ye.insert(e,t)}Oe(e){this.be=!0,this.ye=this.ye.remove(e)}Ne(){this.pe+=1}Be(){this.pe-=1,Rt(this.pe>=0)}Le(){this.be=!0,this.Se=!0}}class pa{constructor(e){this.ke=e,this.qe=new Map,this.Qe=is(),this.$e=ga(),this.Ue=ga(),this.Ke=new oi(Qt)}We(e){for(const t of e.me)e.fe&&e.fe.isFoundDocument()?this.Ge(t,e.fe):this.ze(t,e.key,e.fe);for(const t of e.removedTargetIds)this.ze(t,e.key,e.fe)}je(e){this.forEachTarget(e,(t=>{const n=this.He(t);switch(e.state){case 0:this.Je(t)&&n.Ce(e.resumeToken);break;case 1:n.Be(),n.De||n.Me(),n.Ce(e.resumeToken);break;case 2:n.Be(),n.De||this.removeTarget(t);break;case 3:this.Je(t)&&(n.Le(),n.Ce(e.resumeToken));break;case 4:this.Je(t)&&(this.Ye(t),n.Ce(e.resumeToken));break;default:Pt()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.qe.forEach(((e,n)=>{this.Je(n)&&t(n)}))}Ze(e){const t=e.targetId,n=e.ge.count,r=this.Xe(t);if(r){const i=r.target;if(Lo(i))if(0===n){const e=new dn(i.path);this.ze(t,e,oo.newNoDocument(e,on.min()))}else Rt(1===n);else{const r=this.et(t);if(r!==n){const n=this.tt(e),i=n?this.nt(n,e,r):1;if(0!==i){this.Ye(t);const e=2===i?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(t,e)}null==na||na.rt(function(e,t,n,r,i){var o,s,a,l,c,u;const d={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},h=t.unchangedNames;return h&&(d.bloomFilter={applied:0===i,hashCount:null!==(o=null==h?void 0:h.hashCount)&&void 0!==o?o:0,bitmapLength:null!==(l=null===(a=null===(s=null==h?void 0:h.bits)||void 0===s?void 0:s.bitmap)||void 0===a?void 0:a.length)&&void 0!==l?l:0,padding:null!==(u=null===(c=null==h?void 0:h.bits)||void 0===c?void 0:c.padding)&&void 0!==u?u:0,mightContain:e=>{var t;return null!==(t=null==r?void 0:r.mightContain(e))&&void 0!==t&&t}}),d}(r,e.ge,this.ke.it(),n,i))}}}}tt(e){const t=e.ge.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:i=0}=t;let o,s;try{o=yi(n).toUint8Array()}catch(e){if(e instanceof hi)return At("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{s=new sa(o,r,i)}catch(e){return At(e instanceof aa?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===s.Ee?null:s}nt(e,t,n){return t.ge.count===n-this.st(e,t.targetId)?0:2}st(e,t){const n=this.ke.getRemoteKeysForTarget(t);let r=0;return n.forEach((n=>{const i=this.ke.it(),o=`projects/${i.projectId}/databases/${i.database}/documents/${n.path.canonicalString()}`;e.mightContain(o)||(this.ze(t,n,null),r++)})),r}ot(e){const t=new Map;this.qe.forEach(((n,r)=>{const i=this.Xe(r);if(i){if(n.current&&Lo(i.target)){const t=new dn(i.target.path);this._t(t).has(r)||this.ut(r,t)||this.ze(r,t,oo.newNoDocument(t,e))}n.ve&&(t.set(r,n.Fe()),n.Me())}}));let n=fs();this.Ue.forEach(((e,t)=>{let r=!0;t.forEachWhile((e=>{const t=this.Xe(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)})),r&&(n=n.add(e))})),this.Qe.forEach(((t,n)=>n.setReadTime(e)));const r=new la(e,t,this.Ke,this.Qe,n);return this.Qe=is(),this.$e=ga(),this.Ue=ga(),this.Ke=new oi(Qt),r}Ge(e,t){if(!this.Je(e))return;const n=this.ut(e,t.key)?2:0;this.He(e).xe(t.key,n),this.Qe=this.Qe.insert(t.key,t),this.$e=this.$e.insert(t.key,this._t(t.key).add(e)),this.Ue=this.Ue.insert(t.key,this.ct(t.key).add(e))}ze(e,t,n){if(!this.Je(e))return;const r=this.He(e);this.ut(e,t)?r.xe(t,1):r.Oe(t),this.Ue=this.Ue.insert(t,this.ct(t).delete(e)),this.Ue=this.Ue.insert(t,this.ct(t).add(e)),n&&(this.Qe=this.Qe.insert(t,n))}removeTarget(e){this.qe.delete(e)}et(e){const t=this.He(e).Fe();return this.ke.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ne(e){this.He(e).Ne()}He(e){let t=this.qe.get(e);return t||(t=new fa,this.qe.set(e,t)),t}ct(e){let t=this.Ue.get(e);return t||(t=new li(Qt),this.Ue=this.Ue.insert(e,t)),t}_t(e){let t=this.$e.get(e);return t||(t=new li(Qt),this.$e=this.$e.insert(e,t)),t}Je(e){const t=null!==this.Xe(e);return t||Ct("WatchChangeAggregator","Detected inactive target",e),t}Xe(e){const t=this.qe.get(e);return t&&t.De?null:this.ke.lt(e)}Ye(e){this.qe.set(e,new fa),this.ke.getRemoteKeysForTarget(e).forEach((t=>{this.ze(e,t,null)}))}ut(e,t){return this.ke.getRemoteKeysForTarget(e).has(t)}}function ga(){return new oi(dn.comparator)}function ma(){return new oi(dn.comparator)}const ya={asc:"ASCENDING",desc:"DESCENDING"},va={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ba={and:"AND",or:"OR"};class wa{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function xa(e,t){return e.useProto3Json||$n(t)?t:{value:t}}function Ia(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Sa(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Ea(e,t){return Ia(e,t.toTimestamp())}function _a(e){return Rt(!!e),on.fromTimestamp(function(e){const t=gi(e);return new rn(t.seconds,t.nanos)}(e))}function Ta(e,t){return ka(e,t).canonicalString()}function ka(e,t){const n=function(e){return new ln(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function Ca(e){const t=ln.fromString(e);return Rt(Ya(t)),t}function Na(e,t){return Ta(e.databaseId,t.path)}function Aa(e,t){const n=Ca(t);if(n.get(1)!==e.databaseId.projectId)throw new Mt(Lt.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Mt(Lt.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new dn(Oa(n))}function Da(e,t){return Ta(e.databaseId,t)}function Pa(e){const t=Ca(e);return 4===t.length?ln.emptyPath():Oa(t)}function Ra(e){return new ln(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Oa(e){return Rt(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function La(e,t,n){return{name:Na(e,t),fields:n.value.mapValue.fields}}function Ma(e,t,n){const r=Aa(e,t.name),i=_a(t.updateTime),o=t.createTime?_a(t.createTime):on.min(),s=new ro({mapValue:{fields:t.fields}}),a=oo.newFoundDocument(r,i,o,s);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function ja(e,t){let n;if(t instanceof Us)n={update:La(e,t.key,t.value)};else if(t instanceof Ks)n={delete:Na(e,t.key)};else if(t instanceof $s)n={update:La(e,t.key,t.data),updateMask:Qa(t.fieldMask)};else{if(!(t instanceof Ws))return Pt();n={verify:Na(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const n=t.transform;if(n instanceof Ss)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Es)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Ts)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Cs)return{fieldPath:t.field.canonicalString(),increment:n.Ie};throw Pt()}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Ea(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Pt()}(e,t.precondition)),n}function za(e,t){const n=t.currentDocument?function(e){return void 0!==e.updateTime?Rs.updateTime(_a(e.updateTime)):void 0!==e.exists?Rs.exists(e.exists):Rs.none()}(t.currentDocument):Rs.none(),r=t.updateTransforms?t.updateTransforms.map((t=>function(e,t){let n=null;if("setToServerValue"in t)Rt("REQUEST_TIME"===t.setToServerValue),n=new Ss;else if("appendMissingElements"in t){const e=t.appendMissingElements.values||[];n=new Es(e)}else if("removeAllFromArray"in t){const e=t.removeAllFromArray.values||[];n=new Ts(e)}else"increment"in t?n=new Cs(e,t.increment):Pt();const r=un.fromServerFormat(t.fieldPath);return new Ds(r,n)}(e,t))):[];if(t.update){t.update.name;const i=Aa(e,t.update.name),o=new ro({mapValue:{fields:t.update.fields}});if(t.updateMask){const e=function(e){const t=e.fieldPaths||[];return new di(t.map((e=>un.fromServerFormat(e))))}(t.updateMask);return new $s(i,o,e,n,r)}return new Us(i,o,n,r)}if(t.delete){const r=Aa(e,t.delete);return new Ks(r,n)}if(t.verify){const r=Aa(e,t.verify);return new Ws(r,n)}return Pt()}function Fa(e,t){return{documents:[Da(e,t.path)]}}function Va(e,t){const n={structuredQuery:{}},r=t.path;let i;null!==t.collectionGroup?(i=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Da(e,i);const o=function(e){if(0!==e.length)return Ga(po.create(e,"and"))}(t.filters);o&&(n.structuredQuery.where=o);const s=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:Ka(e.field),direction:Ba(e.dir)}}(e)))}(t.orderBy);s&&(n.structuredQuery.orderBy=s);const a=xa(e,t.limit);return null!==a&&(n.structuredQuery.limit=a),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{ht:n,parent:i}}function Ua(e){let t=Pa(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Rt(1===r);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let o=[];n.where&&(o=function(e){const t=$a(e);return t instanceof po&&yo(t)?t.getFilters():[t]}(n.where));let s=[];n.orderBy&&(s=function(e){return e.map((e=>function(e){return new co(Wa(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)))}(n.orderBy));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,$n(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new so(n,t)}(n.startAt));let c=null;return n.endAt&&(c=function(e){const t=!e.before,n=e.values||[];return new so(n,t)}(n.endAt)),Vo(t,i,s,o,a,"F",l,c)}function $a(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Wa(e.unaryFilter.field);return fo.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=Wa(e.unaryFilter.field);return fo.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Wa(e.unaryFilter.field);return fo.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Wa(e.unaryFilter.field);return fo.create(i,"!=",{nullValue:"NULL_VALUE"});default:return Pt()}}(e):void 0!==e.fieldFilter?function(e){return fo.create(Wa(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Pt()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return po.create(e.compositeFilter.filters.map((e=>$a(e))),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return Pt()}}(e.compositeFilter.op))}(e):Pt()}function Ba(e){return ya[e]}function qa(e){return va[e]}function Ha(e){return ba[e]}function Ka(e){return{fieldPath:e.canonicalString()}}function Wa(e){return un.fromServerFormat(e.fieldPath)}function Ga(e){return e instanceof fo?function(e){if("=="===e.op){if(Wi(e.value))return{unaryFilter:{field:Ka(e.field),op:"IS_NAN"}};if(Ki(e.value))return{unaryFilter:{field:Ka(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Wi(e.value))return{unaryFilter:{field:Ka(e.field),op:"IS_NOT_NAN"}};if(Ki(e.value))return{unaryFilter:{field:Ka(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ka(e.field),op:qa(e.op),value:e.value}}}(e):e instanceof po?function(e){const t=e.getFilters().map((e=>Ga(e)));return 1===t.length?t[0]:{compositeFilter:{op:Ha(e.op),filters:t}}}(e):Pt()}function Qa(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function Ya(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class Xa{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:on.min(),o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:on.min(),s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:fi.EMPTY_BYTE_STRING,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s,this.expectedCount=a}withSequenceNumber(e){return new Xa(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Xa(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Xa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Xa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Ja{constructor(e){this.Tt=e}}function Za(e,t){const n=t.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:el(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())r.document=function(e,t){return{name:Na(e,t.key),fields:t.data.value.mapValue.fields,updateTime:Ia(e,t.version.toTimestamp()),createTime:Ia(e,t.createTime.toTimestamp())}}(e.Tt,t);else if(t.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:tl(t.version)};else{if(!t.isUnknownDocument())return Pt();r.unknownDocument={path:n.path.toArray(),version:tl(t.version)}}return r}function el(e){const t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function tl(e){const t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function nl(e){const t=new rn(e.seconds,e.nanoseconds);return on.fromTimestamp(t)}function rl(e,t){const n=(t.baseMutations||[]).map((t=>za(e.Tt,t)));for(let o=0;o<t.mutations.length-1;++o){const e=t.mutations[o];if(o+1<t.mutations.length&&void 0!==t.mutations[o+1].transform){const n=t.mutations[o+1];e.updateTransforms=n.transform.fieldTransforms,t.mutations.splice(o+1,1),++o}}const r=t.mutations.map((t=>za(e.Tt,t))),i=rn.fromMillis(t.localWriteTimeMs);return new Gs(t.batchId,i,n,r)}function il(e){const t=nl(e.readTime),n=void 0!==e.lastLimboFreeSnapshotVersion?nl(e.lastLimboFreeSnapshotVersion):on.min();let r;return r=function(e){return void 0!==e.documents}(e.query)?function(e){return Rt(1===e.documents.length),Ho(Uo(Pa(e.documents[0])))}(e.query):function(e){return Ho(Ua(e))}(e.query),new Xa(r,e.targetId,"TargetPurposeListen",e.lastListenSequenceNumber,t,n,fi.fromBase64String(e.resumeToken))}function ol(e,t){const n=tl(t.snapshotVersion),r=tl(t.lastLimboFreeSnapshotVersion);let i;i=Lo(t.target)?Fa(e.Tt,t.target):Va(e.Tt,t.target).ht;const o=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:Ro(t.target),readTime:n,resumeToken:o,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function sl(e){const t=Ua({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Go(t,t.limit,"L"):t}function al(e,t){return new Ys(t.largestBatchId,za(e.Tt,t.overlayMutation))}function ll(e,t){const n=t.path.lastSegment();return[e,Kn(t.path.popLast()),n]}function cl(e,t,n,r){return{indexId:e,uid:t,sequenceNumber:n,readTime:tl(r.readTime),documentKey:Kn(r.documentKey.path),largestBatchId:r.largestBatchId}}class ul{getBundleMetadata(e,t){return dl(e).get(t).next((e=>{if(e)return function(e){return{id:e.bundleId,createTime:nl(e.createTime),version:e.version}}(e)}))}saveBundleMetadata(e,t){return dl(e).put(function(e){return{bundleId:e.id,createTime:tl(_a(e.createTime)),version:e.version}}(t))}getNamedQuery(e,t){return hl(e).get(t).next((e=>{if(e)return function(e){return{name:e.name,query:sl(e.bundledQuery),readTime:nl(e.readTime)}}(e)}))}saveNamedQuery(e,t){return hl(e).put(function(e){return{name:e.name,readTime:tl(_a(e.readTime)),bundledQuery:e.bundledQuery}}(t))}}function dl(e){return ti(e,Cr)}function hl(e){return ti(e,Nr)}class fl{constructor(e,t){this.serializer=e,this.userId=t}static It(e,t){const n=t.uid||"";return new fl(e,n)}getOverlay(e,t){return pl(e).get(ll(this.userId,t)).next((e=>e?al(this.serializer,e):null))}getOverlays(e,t){const n=ls();return _n.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){const r=[];return n.forEach(((n,i)=>{const o=new Ys(t,i);r.push(this.Et(e,o))})),_n.waitFor(r)}removeOverlaysForBatchId(e,t,n){const r=new Set;t.forEach((e=>r.add(Kn(e.getCollectionPath()))));const i=[];return r.forEach((t=>{const r=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,n+1],!1,!0);i.push(pl(e).J($r,r))})),_n.waitFor(i)}getOverlaysForCollection(e,t,n){const r=ls(),i=Kn(t),o=IDBKeyRange.bound([this.userId,i,n],[this.userId,i,Number.POSITIVE_INFINITY],!0);return pl(e).G($r,o).next((e=>{for(const t of e){const e=al(this.serializer,t);r.set(e.getKey(),e)}return r}))}getOverlaysForCollectionGroup(e,t,n,r){const i=ls();let o;const s=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return pl(e).Z({index:qr,range:s},((e,t,n)=>{const s=al(this.serializer,t);i.size()<r||s.largestBatchId===o?(i.set(s.getKey(),s),o=s.largestBatchId):n.done()})).next((()=>i))}Et(e,t){return pl(e).put(function(e,t,n){const[r,i,o]=ll(t,n.mutation.key);return{userId:t,collectionPath:i,documentId:o,collectionGroup:n.mutation.key.getCollectionGroup(),largestBatchId:n.largestBatchId,overlayMutation:ja(e.Tt,n.mutation)}}(this.serializer,this.userId,t))}}function pl(e){return ti(e,Vr)}class gl{dt(e){return ti(e,Kr)}getSessionToken(e){return this.dt(e).get("sessionToken").next((e=>{const t=null==e?void 0:e.value;return t?fi.fromUint8Array(t):fi.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.dt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class ml{constructor(){}At(e,t){this.Rt(e,t),t.Vt()}Rt(e,t){if("nullValue"in e)this.ft(t,5);else if("booleanValue"in e)this.ft(t,10),t.gt(e.booleanValue?1:0);else if("integerValue"in e)this.ft(t,15),t.gt(mi(e.integerValue));else if("doubleValue"in e){const n=mi(e.doubleValue);isNaN(n)?this.ft(t,13):(this.ft(t,15),Bn(n)?t.gt(0):t.gt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.ft(t,20),"string"==typeof n&&(n=gi(n)),t.yt(`${n.seconds||""}`),t.gt(n.nanos||0)}else if("stringValue"in e)this.wt(e.stringValue,t),this.St(t);else if("bytesValue"in e)this.ft(t,30),t.bt(yi(e.bytesValue)),this.St(t);else if("referenceValue"in e)this.Dt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.ft(t,45),t.gt(n.latitude||0),t.gt(n.longitude||0)}else"mapValue"in e?Xi(e)?this.ft(t,Number.MAX_SAFE_INTEGER):Qi(e)?this.vt(e.mapValue,t):(this.Ct(e.mapValue,t),this.St(t)):"arrayValue"in e?(this.Ft(e.arrayValue,t),this.St(t)):Pt()}wt(e,t){this.ft(t,25),this.Mt(e,t)}Mt(e,t){t.yt(e)}Ct(e,t){const n=e.fields||{};this.ft(t,55);for(const r of Object.keys(n))this.wt(r,t),this.Rt(n[r],t)}vt(e,t){var n,r;const i=e.fields||{};this.ft(t,53);const o=Pi,s=(null===(r=null===(n=i[o].arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.length)||0;this.ft(t,15),t.gt(mi(s)),this.wt(o,t),this.Rt(i[o],t)}Ft(e,t){const n=e.values||[];this.ft(t,50);for(const r of n)this.Rt(r,t)}Dt(e,t){this.ft(t,37),dn.fromName(e).path.forEach((e=>{this.ft(t,60),this.Mt(e,t)}))}ft(e,t){e.gt(t)}St(e){e.gt(2)}}ml.xt=new ml;const yl=255;function vl(e){if(0===e)return 8;let t=0;return e>>4||(t+=4,e<<=4),e>>6||(t+=2,e<<=2),e>>7||(t+=1),t}function bl(e){const t=64-function(e){let t=0;for(let n=0;n<8;++n){const r=vl(255&e[n]);if(t+=r,8!==r)break}return t}(e);return Math.ceil(t/8)}class wl{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ot(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Nt(n.value),n=t.next();this.Bt()}Lt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.kt(n.value),n=t.next();this.qt()}Qt(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.Nt(e);else if(e<2048)this.Nt(960|e>>>6),this.Nt(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Nt(480|e>>>12),this.Nt(128|63&e>>>6),this.Nt(128|63&e);else{const e=t.codePointAt(0);this.Nt(240|e>>>18),this.Nt(128|63&e>>>12),this.Nt(128|63&e>>>6),this.Nt(128|63&e)}}this.Bt()}$t(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.kt(e);else if(e<2048)this.kt(960|e>>>6),this.kt(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.kt(480|e>>>12),this.kt(128|63&e>>>6),this.kt(128|63&e);else{const e=t.codePointAt(0);this.kt(240|e>>>18),this.kt(128|63&e>>>12),this.kt(128|63&e>>>6),this.kt(128|63&e)}}this.qt()}Ut(e){const t=this.Kt(e),n=bl(t);this.Wt(1+n),this.buffer[this.position++]=255&n;for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=255&t[r]}Gt(e){const t=this.Kt(e),n=bl(t);this.Wt(1+n),this.buffer[this.position++]=~(255&n);for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}zt(){this.jt(yl),this.jt(255)}Ht(){this.Jt(yl),this.Jt(255)}reset(){this.position=0}seed(e){this.Wt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Yt(){return this.buffer.slice(0,this.position)}Kt(e){const t=function(e){const t=new DataView(new ArrayBuffer(8));return t.setFloat64(0,e,!1),new Uint8Array(t.buffer)}(e),n=!!(128&t[0]);t[0]^=n?255:128;for(let r=1;r<t.length;++r)t[r]^=n?255:0;return t}Nt(e){const t=255&e;0===t?(this.jt(0),this.jt(255)):t===yl?(this.jt(yl),this.jt(0)):this.jt(t)}kt(e){const t=255&e;0===t?(this.Jt(0),this.Jt(255)):t===yl?(this.Jt(yl),this.Jt(0)):this.Jt(e)}Bt(){this.jt(0),this.jt(1)}qt(){this.Jt(0),this.Jt(1)}jt(e){this.Wt(1),this.buffer[this.position++]=e}Jt(e){this.Wt(1),this.buffer[this.position++]=~e}Wt(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}}class xl{constructor(e){this.Zt=e}bt(e){this.Zt.Ot(e)}yt(e){this.Zt.Qt(e)}gt(e){this.Zt.Ut(e)}Vt(){this.Zt.zt()}}class Il{constructor(e){this.Zt=e}bt(e){this.Zt.Lt(e)}yt(e){this.Zt.$t(e)}gt(e){this.Zt.Gt(e)}Vt(){this.Zt.Ht()}}class Sl{constructor(){this.Zt=new wl,this.Xt=new xl(this.Zt),this.en=new Il(this.Zt)}seed(e){this.Zt.seed(e)}tn(e){return 0===e?this.Xt:this.en}Yt(){return this.Zt.Yt()}reset(){this.Zt.reset()}}class El{constructor(e,t,n,r){this.indexId=e,this.documentKey=t,this.arrayValue=n,this.directionalValue=r}nn(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,n=new Uint8Array(t);return n.set(this.directionalValue,0),t!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new El(this.indexId,this.documentKey,this.arrayValue,n)}}function _l(e,t){let n=e.indexId-t.indexId;return 0!==n?n:(n=Tl(e.arrayValue,t.arrayValue),0!==n?n:(n=Tl(e.directionalValue,t.directionalValue),0!==n?n:dn.comparator(e.documentKey,t.documentKey)))}function Tl(e,t){for(let n=0;n<e.length&&n<t.length;++n){const r=e[n]-t[n];if(0!==r)return r}return e.length-t.length}class kl{constructor(e){this.rn=new li(((e,t)=>un.comparator(e.field,t.field))),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.sn=e.orderBy,this._n=[];for(const t of e.filters){const e=t;e.isInequality()?this.rn=this.rn.add(e):this._n.push(e)}}get an(){return this.rn.size>1}un(e){if(Rt(e.collectionGroup===this.collectionId),this.an)return!1;const t=pn(e);if(void 0!==t&&!this.cn(t))return!1;const n=gn(e);let r=new Set,i=0,o=0;for(;i<n.length&&this.cn(n[i]);++i)r=r.add(n[i].fieldPath.canonicalString());if(i===n.length)return!0;if(this.rn.size>0){const e=this.rn.getIterator().getNext();if(!r.has(e.field.canonicalString())){const t=n[i];if(!this.ln(e,t)||!this.hn(this.sn[o++],t))return!1}++i}for(;i<n.length;++i){const e=n[i];if(o>=this.sn.length||!this.hn(this.sn[o++],e))return!1}return!0}Pn(){if(this.an)return null;let e=new li(un.comparator);const t=[];for(const n of this._n)if(!n.field.isKeyField())if("array-contains"===n.op||"array-contains-any"===n.op)t.push(new mn(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new mn(n.field,0))}for(const n of this.sn)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new mn(n.field,"asc"===n.dir?0:1)));return new fn(fn.UNKNOWN_ID,this.collectionId,t,yn.empty())}cn(e){for(const t of this._n)if(this.ln(t,e))return!0;return!1}ln(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;const n="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===n}hn(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function Cl(e){var t,n;if(Rt(e instanceof fo||e instanceof po),e instanceof fo){if(e instanceof Co){const r=(null===(n=null===(t=e.value.arrayValue)||void 0===t?void 0:t.values)||void 0===n?void 0:n.map((t=>fo.create(e.field,"==",t))))||[];return po.create(r,"or")}return e}const r=e.filters.map((e=>Cl(e)));return po.create(r,e.op)}function Nl(e){if(0===e.getFilters().length)return[];const t=Rl(Cl(e));return Rt(Pl(t)),Al(t)||Dl(t)?[t]:t.getFilters()}function Al(e){return e instanceof fo}function Dl(e){return e instanceof po&&yo(e)}function Pl(e){return Al(e)||Dl(e)||function(e){if(e instanceof po&&mo(e)){for(const t of e.getFilters())if(!Al(t)&&!Dl(t))return!1;return!0}return!1}(e)}function Rl(e){if(Rt(e instanceof fo||e instanceof po),e instanceof fo)return e;if(1===e.filters.length)return Rl(e.filters[0]);const t=e.filters.map((e=>Rl(e)));let n=po.create(t,e.op);return n=Ml(n),Pl(n)?n:(Rt(n instanceof po),Rt(go(n)),Rt(n.filters.length>1),n.filters.reduce(((e,t)=>Ol(e,t))))}function Ol(e,t){let n;return Rt(e instanceof fo||e instanceof po),Rt(t instanceof fo||t instanceof po),n=e instanceof fo?t instanceof fo?function(e,t){return po.create([e,t],"and")}(e,t):Ll(e,t):t instanceof fo?Ll(t,e):function(e,t){if(Rt(e.filters.length>0&&t.filters.length>0),go(e)&&go(t))return xo(e,t.getFilters());const n=mo(e)?e:t,r=mo(e)?t:e,i=n.filters.map((e=>Ol(e,r)));return po.create(i,"or")}(e,t),Ml(n)}function Ll(e,t){if(go(t))return xo(t,e.getFilters());{const n=t.filters.map((t=>Ol(e,t)));return po.create(n,"or")}}function Ml(e){if(Rt(e instanceof fo||e instanceof po),e instanceof fo)return e;const t=e.getFilters();if(1===t.length)return Ml(t[0]);if(vo(e))return e;const n=t.map((e=>Ml(e))),r=[];return n.forEach((t=>{t instanceof fo?r.push(t):t instanceof po&&(t.op===e.op?r.push(...t.filters):r.push(t))})),1===r.length?r[0]:po.create(r,e.op)}class jl{constructor(){this.Tn=new zl}addToCollectionParentIndex(e,t){return this.Tn.add(t),_n.resolve()}getCollectionParents(e,t){return _n.resolve(this.Tn.getEntries(t))}addFieldIndex(e,t){return _n.resolve()}deleteFieldIndex(e,t){return _n.resolve()}deleteAllFieldIndexes(e){return _n.resolve()}createTargetIndexes(e,t){return _n.resolve()}getDocumentsMatchingTarget(e,t){return _n.resolve(null)}getIndexType(e,t){return _n.resolve(0)}getFieldIndexes(e,t){return _n.resolve([])}getNextCollectionGroupToUpdate(e){return _n.resolve(null)}getMinOffset(e,t){return _n.resolve(wn.min())}getMinOffsetFromCollectionGroup(e,t){return _n.resolve(wn.min())}updateCollectionGroup(e,t,n){return _n.resolve()}updateIndexEntries(e,t){return _n.resolve()}}class zl{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new li(ln.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new li(ln.comparator)).toArray()}}const Fl="IndexedDbIndexManager",Vl=new Uint8Array(0);class Ul{constructor(e,t){this.databaseId=t,this.In=new zl,this.En=new ns((e=>Ro(e)),((e,t)=>Oo(e,t))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.In.has(t)){const n=t.lastSegment(),r=t.popLast();e.addOnCommittedListener((()=>{this.In.add(t)}));const i={collectionId:n,parent:Kn(r)};return $l(e).put(i)}return _n.resolve()}getCollectionParents(e,t){const n=[],r=IDBKeyRange.bound([t,""],[en(t),""],!1,!0);return $l(e).G(r).next((e=>{for(const r of e){if(r.collectionId!==t)break;n.push(Qn(r.parent))}return n}))}addFieldIndex(e,t){const n=ql(e),r=function(e){return{indexId:e.indexId,collectionGroup:e.collectionGroup,fields:e.fields.map((e=>[e.fieldPath.canonicalString(),e.kind]))}}(t);delete r.indexId;const i=n.add(r);if(t.indexState){const n=Hl(e);return i.next((e=>{n.put(cl(e,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return i.next()}deleteFieldIndex(e,t){const n=ql(e),r=Hl(e),i=Bl(e);return n.delete(t.indexId).next((()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=ql(e),n=Bl(e),r=Hl(e);return t.J().next((()=>n.J())).next((()=>r.J()))}createTargetIndexes(e,t){return _n.forEach(this.dn(t),(t=>this.getIndexType(e,t).next((n=>{if(0===n||1===n){const n=new kl(t).Pn();if(null!=n)return this.addFieldIndex(e,n)}}))))}getDocumentsMatchingTarget(e,t){const n=Bl(e);let r=!0;const i=new Map;return _n.forEach(this.dn(t),(t=>this.An(e,t).next((e=>{r&&(r=!!e),i.set(t,e)})))).next((()=>{if(r){let e=fs();const r=[];return _n.forEach(i,((i,o)=>{Ct(Fl,`Using index ${function(e){return`id=${e.indexId}|cg=${e.collectionGroup}|f=${e.fields.map((e=>`${e.fieldPath}:${e.kind}`)).join(",")}`}(i)} to execute ${Ro(t)}`);const s=function(e,t){const n=pn(t);if(void 0===n)return null;for(const r of Mo(e,n.fieldPath))switch(r.op){case"array-contains-any":return r.value.arrayValue.values||[];case"array-contains":return[r.value]}return null}(o,i),a=function(e,t){const n=new Map;for(const r of gn(t))for(const t of Mo(e,r.fieldPath))switch(t.op){case"==":case"in":n.set(r.fieldPath.canonicalString(),t.value);break;case"not-in":case"!=":return n.set(r.fieldPath.canonicalString(),t.value),Array.from(n.values())}return null}(o,i),l=function(e,t){const n=[];let r=!0;for(const i of gn(t)){const t=0===i.kind?jo(e,i.fieldPath,e.startAt):zo(e,i.fieldPath,e.startAt);n.push(t.value),r&&(r=t.inclusive)}return new so(n,r)}(o,i),c=function(e,t){const n=[];let r=!0;for(const i of gn(t)){const t=0===i.kind?zo(e,i.fieldPath,e.endAt):jo(e,i.fieldPath,e.endAt);n.push(t.value),r&&(r=t.inclusive)}return new so(n,r)}(o,i),u=this.Rn(i,o,l),d=this.Rn(i,o,c),h=this.Vn(i,o,a),f=this.mn(i.indexId,s,u,l.inclusive,d,c.inclusive,h);return _n.forEach(f,(i=>n.H(i,t.limit).next((t=>{t.forEach((t=>{const n=dn.fromSegments(t.documentKey);e.has(n)||(e=e.add(n),r.push(n))}))}))))})).next((()=>r))}return _n.resolve(null)}))}dn(e){let t=this.En.get(e);return t||(t=0===e.filters.length?[e]:Nl(po.create(e.filters,"and")).map((t=>Po(e.path,e.collectionGroup,e.orderBy,t.getFilters(),e.limit,e.startAt,e.endAt))),this.En.set(e,t),t)}mn(e,t,n,r,i,o,s){const a=(null!=t?t.length:1)*Math.max(n.length,i.length),l=a/(null!=t?t.length:1),c=[];for(let u=0;u<a;++u){const a=t?this.fn(t[u/l]):Vl,d=this.gn(e,a,n[u%l],r),h=this.pn(e,a,i[u%l],o),f=s.map((t=>this.gn(e,a,t,!0)));c.push(...this.createRange(d,h,f))}return c}gn(e,t,n,r){const i=new El(e,dn.empty(),t,n);return r?i:i.nn()}pn(e,t,n,r){const i=new El(e,dn.empty(),t,n);return r?i.nn():i}An(e,t){const n=new kl(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((e=>{let t=null;for(const r of e)n.un(r)&&(!t||r.fields.length>t.fields.length)&&(t=r);return t}))}getIndexType(e,t){let n=2;const r=this.dn(t);return _n.forEach(r,(t=>this.An(e,t).next((e=>{e?0!==n&&e.fields.length<function(e){let t=new li(un.comparator),n=!1;for(const r of e.filters)for(const e of r.getFlattenedFilters())e.field.isKeyField()||("array-contains"===e.op||"array-contains-any"===e.op?n=!0:t=t.add(e.field));for(const r of e.orderBy)r.field.isKeyField()||(t=t.add(r.field));return t.size+(n?1:0)}(t)&&(n=1):n=0})))).next((()=>function(e){return null!==e.limit}(t)&&r.length>1&&2===n?1:n))}yn(e,t){const n=new Sl;for(const r of gn(e)){const e=t.data.field(r.fieldPath);if(null==e)return null;const i=n.tn(r.kind);ml.xt.At(e,i)}return n.Yt()}fn(e){const t=new Sl;return ml.xt.At(e,t.tn(0)),t.Yt()}wn(e,t){const n=new Sl;return ml.xt.At(Bi(this.databaseId,t),n.tn(function(e){const t=gn(e);return 0===t.length?0:t[t.length-1].kind}(e))),n.Yt()}Vn(e,t,n){if(null===n)return[];let r=[];r.push(new Sl);let i=0;for(const o of gn(e)){const e=n[i++];for(const n of r)if(this.Sn(t,o.fieldPath)&&Hi(e))r=this.bn(r,o,e);else{const t=n.tn(o.kind);ml.xt.At(e,t)}}return this.Dn(r)}Rn(e,t,n){return this.Vn(e,t,n.position)}Dn(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].Yt();return t}bn(e,t,n){const r=[...e],i=[];for(const o of n.arrayValue.values||[])for(const e of r){const n=new Sl;n.seed(e.Yt()),ml.xt.At(o,n.tn(t.kind)),i.push(n)}return i}Sn(e,t){return!!e.filters.find((e=>e instanceof fo&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op)))}getFieldIndexes(e,t){const n=ql(e),r=Hl(e);return(t?n.G(Dr,IDBKeyRange.bound(t,t)):n.G()).next((e=>{const t=[];return _n.forEach(e,(e=>r.get([e.indexId,this.uid]).next((n=>{t.push(function(e,t){const n=t?new yn(t.sequenceNumber,new wn(nl(t.readTime),new dn(Qn(t.documentKey)),t.largestBatchId)):yn.empty(),r=e.fields.map((e=>{let[t,n]=e;return new mn(un.fromServerFormat(t),n)}));return new fn(e.indexId,e.collectionGroup,r,n)}(e,n))})))).next((()=>t))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((e=>0===e.length?null:(e.sort(((e,t)=>{const n=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==n?n:Qt(e.collectionGroup,t.collectionGroup)})),e[0].collectionGroup)))}updateCollectionGroup(e,t,n){const r=ql(e),i=Hl(e);return this.vn(e).next((e=>r.G(Dr,IDBKeyRange.bound(t,t)).next((t=>_n.forEach(t,(t=>i.put(cl(t.indexId,this.uid,e,n))))))))}updateIndexEntries(e,t){const n=new Map;return _n.forEach(t,((t,r)=>{const i=n.get(t.collectionGroup);return(i?_n.resolve(i):this.getFieldIndexes(e,t.collectionGroup)).next((i=>(n.set(t.collectionGroup,i),_n.forEach(i,(n=>this.Cn(e,t,n).next((t=>{const i=this.Fn(r,n);return t.isEqual(i)?_n.resolve():this.Mn(e,r,n,t,i)})))))))}))}xn(e,t,n,r){return Bl(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.wn(n,t.key),documentKey:t.key.path.toArray()})}On(e,t,n,r){return Bl(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.wn(n,t.key),t.key.path.toArray()])}Cn(e,t,n){const r=Bl(e);let i=new li(_l);return r.Z({index:zr,range:IDBKeyRange.only([n.indexId,this.uid,this.wn(n,t)])},((e,r)=>{i=i.add(new El(n.indexId,t,r.arrayValue,r.directionalValue))})).next((()=>i))}Fn(e,t){let n=new li(_l);const r=this.yn(t,e);if(null==r)return n;const i=pn(t);if(null!=i){const o=e.data.field(i.fieldPath);if(Hi(o))for(const i of o.arrayValue.values||[])n=n.add(new El(t.indexId,e.key,this.fn(i),r))}else n=n.add(new El(t.indexId,e.key,Vl,r));return n}Mn(e,t,n,r,i){Ct(Fl,"Updating index entries for document '%s'",t.key);const o=[];return function(e,t,n,r,i){const o=e.getIterator(),s=t.getIterator();let a=ui(o),l=ui(s);for(;a||l;){let e=!1,t=!1;if(a&&l){const r=n(a,l);r<0?t=!0:r>0&&(e=!0)}else null!=a?t=!0:e=!0;e?(r(l),l=ui(s)):t?(i(a),a=ui(o)):(a=ui(o),l=ui(s))}}(r,i,_l,(r=>{o.push(this.xn(e,t,n,r))}),(r=>{o.push(this.On(e,t,n,r))})),_n.waitFor(o)}vn(e){let t=1;return Hl(e).Z({index:Or,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((e,n,r)=>{r.done(),t=n.sequenceNumber+1})).next((()=>t))}createRange(e,t,n){n=n.sort(((e,t)=>_l(e,t))).filter(((e,t,n)=>!t||0!==_l(e,n[t-1])));const r=[];r.push(e);for(const o of n){const n=_l(o,e),i=_l(o,t);if(0===n)r[0]=e.nn();else if(n>0&&i<0)r.push(o),r.push(o.nn());else if(i>0)break}r.push(t);const i=[];for(let o=0;o<r.length;o+=2){if(this.Nn(r[o],r[o+1]))return[];const e=[r[o].indexId,this.uid,r[o].arrayValue,r[o].directionalValue,Vl,[]],t=[r[o+1].indexId,this.uid,r[o+1].arrayValue,r[o+1].directionalValue,Vl,[]];i.push(IDBKeyRange.bound(e,t))}return i}Nn(e,t){return _l(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Kl)}getMinOffset(e,t){return _n.mapArray(this.dn(t),(t=>this.An(e,t).next((e=>e||Pt())))).next(Kl)}}function $l(e){return ti(e,_r)}function Bl(e){return ti(e,Mr)}function ql(e){return ti(e,Ar)}function Hl(e){return ti(e,Pr)}function Kl(e){Rt(0!==e.length);let t=e[0].indexState.offset,n=t.largestBatchId;for(let r=1;r<e.length;r++){const i=e[r].indexState.offset;xn(i,t)<0&&(t=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new wn(t.readTime,t.documentKey,n)}const Wl={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Gl=41943040;class Ql{static withCacheSize(e){return new Ql(e,Ql.DEFAULT_COLLECTION_PERCENTILE,Ql.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}function Yl(e,t,n){const r=e.store(er),i=e.store(ar),o=[],s=IDBKeyRange.only(n.batchId);let a=0;const l=r.Z({range:s},((e,t,n)=>(a++,n.delete())));o.push(l.next((()=>{Rt(1===a)})));const c=[];for(const u of n.mutations){const e=or(t,u.key.path,n.batchId);o.push(i.delete(e)),c.push(u.key)}return _n.waitFor(o).next((()=>c))}function Xl(e){if(!e)return 0;let t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw Pt();t=e.noDocument}return JSON.stringify(t).length}Ql.DEFAULT_COLLECTION_PERCENTILE=10,Ql.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ql.DEFAULT=new Ql(Gl,Ql.DEFAULT_COLLECTION_PERCENTILE,Ql.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ql.DISABLED=new Ql(-1,0,0);class Jl{constructor(e,t,n,r){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=r,this.Bn={}}static It(e,t,n,r){Rt(""!==e.uid);const i=e.isAuthenticated()?e.uid:"";return new Jl(i,t,n,r)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ec(e).Z({index:nr,range:n},((e,n,r)=>{t=!1,r.done()})).next((()=>t))}addMutationBatch(e,t,n,r){const i=tc(e),o=ec(e);return o.add({}).next((s=>{Rt("number"==typeof s);const a=new Gs(s,t,n,r),l=function(e,t,n){const r=n.baseMutations.map((t=>ja(e.Tt,t))),i=n.mutations.map((t=>ja(e.Tt,t)));return{userId:t,batchId:n.batchId,localWriteTimeMs:n.localWriteTime.toMillis(),baseMutations:r,mutations:i}}(this.serializer,this.userId,a),c=[];let u=new li(((e,t)=>Qt(e.canonicalString(),t.canonicalString())));for(const e of r){const t=or(this.userId,e.key.path,s);u=u.add(e.key.path.popLast()),c.push(o.put(l)),c.push(i.put(t,sr))}return u.forEach((t=>{c.push(this.indexManager.addToCollectionParentIndex(e,t))})),e.addOnCommittedListener((()=>{this.Bn[s]=a.keys()})),_n.waitFor(c).next((()=>a))}))}lookupMutationBatch(e,t){return ec(e).get(t).next((e=>e?(Rt(e.userId===this.userId),rl(this.serializer,e)):null))}Ln(e,t){return this.Bn[t]?_n.resolve(this.Bn[t]):this.lookupMutationBatch(e,t).next((e=>{if(e){const n=e.keys();return this.Bn[t]=n,n}return null}))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=IDBKeyRange.lowerBound([this.userId,n]);let i=null;return ec(e).Z({index:nr,range:r},((e,t,r)=>{t.userId===this.userId&&(Rt(t.batchId>=n),i=rl(this.serializer,t)),r.done()})).next((()=>i))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=Un;return ec(e).Z({index:nr,range:t,reverse:!0},((e,t,r)=>{n=t.batchId,r.done()})).next((()=>n))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Un],[this.userId,Number.POSITIVE_INFINITY]);return ec(e).G(nr,t).next((e=>e.map((e=>rl(this.serializer,e)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=ir(this.userId,t.path),r=IDBKeyRange.lowerBound(n),i=[];return tc(e).Z({range:r},((n,r,o)=>{const[s,a,l]=n,c=Qn(a);if(s===this.userId&&t.path.isEqual(c))return ec(e).get(l).next((e=>{if(!e)throw Pt();Rt(e.userId===this.userId),i.push(rl(this.serializer,e))}));o.done()})).next((()=>i))}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new li(Qt);const r=[];return t.forEach((t=>{const i=ir(this.userId,t.path),o=IDBKeyRange.lowerBound(i),s=tc(e).Z({range:o},((e,r,i)=>{const[o,s,a]=e,l=Qn(s);o===this.userId&&t.path.isEqual(l)?n=n.add(a):i.done()}));r.push(s)})),_n.waitFor(r).next((()=>this.kn(e,n)))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1,i=ir(this.userId,n),o=IDBKeyRange.lowerBound(i);let s=new li(Qt);return tc(e).Z({range:o},((e,t,i)=>{const[o,a,l]=e,c=Qn(a);o===this.userId&&n.isPrefixOf(c)?c.length===r&&(s=s.add(l)):i.done()})).next((()=>this.kn(e,s)))}kn(e,t){const n=[],r=[];return t.forEach((t=>{r.push(ec(e).get(t).next((e=>{if(null===e)throw Pt();Rt(e.userId===this.userId),n.push(rl(this.serializer,e))})))})),_n.waitFor(r).next((()=>n))}removeMutationBatch(e,t){return Yl(e.ue,this.userId,t).next((n=>(e.addOnCommittedListener((()=>{this.qn(t.batchId)})),_n.forEach(n,(t=>this.referenceDelegate.markPotentiallyOrphaned(e,t))))))}qn(e){delete this.Bn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return _n.resolve();const n=IDBKeyRange.lowerBound(function(e){return[e]}(this.userId)),r=[];return tc(e).Z({range:n},((e,t,n)=>{if(e[0]===this.userId){const t=Qn(e[1]);r.push(t)}else n.done()})).next((()=>{Rt(0===r.length)}))}))}containsKey(e,t){return Zl(e,this.userId,t)}Qn(e){return nc(e).get(this.userId).next((e=>e||{userId:this.userId,lastAcknowledgedBatchId:Un,lastStreamToken:""}))}}function Zl(e,t,n){const r=ir(t,n.path),i=r[1],o=IDBKeyRange.lowerBound(r);let s=!1;return tc(e).Z({range:o,Y:!0},((e,n,r)=>{const[o,a,l]=e;o===t&&a===i&&(s=!0),r.done()})).next((()=>s))}function ec(e){return ti(e,er)}function tc(e){return ti(e,ar)}function nc(e){return ti(e,Zn)}class rc{constructor(e){this.$n=e}next(){return this.$n+=2,this.$n}static Un(){return new rc(0)}static Kn(){return new rc(-1)}}class ic{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Wn(e).next((t=>{const n=new rc(t.highestTargetId);return t.highestTargetId=n.next(),this.Gn(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.Wn(e).next((e=>on.fromTimestamp(new rn(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.Wn(e).next((e=>e.highestListenSequenceNumber))}setTargetsMetadata(e,t,n){return this.Wn(e).next((r=>(r.highestListenSequenceNumber=t,n&&(r.lastRemoteSnapshotVersion=n.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.Gn(e,r))))}addTargetData(e,t){return this.zn(e,t).next((()=>this.Wn(e).next((n=>(n.targetCount+=1,this.jn(t,n),this.Gn(e,n))))))}updateTargetData(e,t){return this.zn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>oc(e).delete(t.targetId))).next((()=>this.Wn(e))).next((t=>(Rt(t.targetCount>0),t.targetCount-=1,this.Gn(e,t))))}removeTargets(e,t,n){let r=0;const i=[];return oc(e).Z(((o,s)=>{const a=il(s);a.sequenceNumber<=t&&null===n.get(a.targetId)&&(r++,i.push(this.removeTargetData(e,a)))})).next((()=>_n.waitFor(i))).next((()=>r))}forEachTarget(e,t){return oc(e).Z(((e,n)=>{const r=il(n);t(r)}))}Wn(e){return sc(e).get(Sr).next((e=>(Rt(null!==e),e)))}Gn(e,t){return sc(e).put(Sr,t)}zn(e,t){return oc(e).put(ol(this.serializer,t))}jn(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.Wn(e).next((e=>e.targetCount))}getTargetData(e,t){const n=Ro(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let i=null;return oc(e).Z({range:r,index:yr},((e,n,r)=>{const o=il(n);Oo(t,o.target)&&(i=o,r.done())})).next((()=>i))}addMatchingKeys(e,t,n){const r=[],i=ac(e);return t.forEach((t=>{const o=Kn(t.path);r.push(i.put({targetId:n,path:o})),r.push(this.referenceDelegate.addReference(e,n,t))})),_n.waitFor(r)}removeMatchingKeys(e,t,n){const r=ac(e);return _n.forEach(t,(t=>{const i=Kn(t.path);return _n.waitFor([r.delete([n,i]),this.referenceDelegate.removeReference(e,n,t)])}))}removeMatchingKeysForTargetId(e,t){const n=ac(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),r=ac(e);let i=fs();return r.Z({range:n,Y:!0},((e,t,n)=>{const r=Qn(e[1]),o=new dn(r);i=i.add(o)})).next((()=>i))}containsKey(e,t){const n=Kn(t.path),r=IDBKeyRange.bound([n],[en(n)],!1,!0);let i=0;return ac(e).Z({index:xr,Y:!0,range:r},((e,t,n)=>{let[r,o]=e;0!==r&&(i++,n.done())})).next((()=>i>0))}lt(e,t){return oc(e).get(t).next((e=>e?il(e):null))}}function oc(e){return ti(e,mr)}function sc(e){return ti(e,Er)}function ac(e){return ti(e,br)}const lc="LruGarbageCollector",cc=1048576;function uc(e,t){let[n,r]=e,[i,o]=t;const s=Qt(n,i);return 0===s?Qt(r,o):s}class dc{constructor(e){this.Hn=e,this.buffer=new li(uc),this.Jn=0}Yn(){return++this.Jn}Zn(e){const t=[e,this.Yn()];if(this.buffer.size<this.Hn)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();uc(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class hc{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Xn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.er(6e4)}stop(){this.Xn&&(this.Xn.cancel(),this.Xn=null)}get started(){return null!==this.Xn}er(e){Ct(lc,`Garbage collection scheduled in ${e}ms`),this.Xn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Xn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){Pn(e)?Ct(lc,"Ignoring IndexedDB error during garbage collection: ",e):await En(e)}await this.er(3e5)}))}}class fc{constructor(e,t){this.tr=e,this.params=t}calculateTargetCount(e,t){return this.tr.nr(e).next((e=>Math.floor(t/100*e)))}nthSequenceNumber(e,t){if(0===t)return _n.resolve(Vn.ae);const n=new dc(t);return this.tr.forEachTarget(e,(e=>n.Zn(e.sequenceNumber))).next((()=>this.tr.rr(e,(e=>n.Zn(e))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.tr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.tr.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(Ct("LruGarbageCollector","Garbage collection skipped; disabled"),_n.resolve(Wl)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(Ct("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Wl):this.ir(e,t)))}getCacheSize(e){return this.tr.getCacheSize(e)}ir(e,t){let n,r,i,o,s,a,l;const c=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((t=>(t>this.params.maximumSequenceNumbersToCollect?(Ct("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),r=this.params.maximumSequenceNumbersToCollect):r=t,o=Date.now(),this.nthSequenceNumber(e,r)))).next((r=>(n=r,s=Date.now(),this.removeTargets(e,n,t)))).next((t=>(i=t,a=Date.now(),this.removeOrphanedDocuments(e,n)))).next((e=>(l=Date.now(),kt()<=z.DEBUG&&Ct("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${o-c}ms\n\tDetermined least recently used ${r} in `+(s-o)+"ms\n"+`\tRemoved ${i} targets in `+(a-s)+"ms\n"+`\tRemoved ${e} documents in `+(l-a)+"ms\n"+`Total Duration: ${l-c}ms`),_n.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e}))))}}function pc(e,t){return new fc(e,t)}class gc{constructor(e,t){this.db=e,this.garbageCollector=pc(this,t)}nr(e){const t=this.sr(e);return this.db.getTargetCache().getTargetCount(e).next((e=>t.next((t=>e+t))))}sr(e){let t=0;return this.rr(e,(e=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}rr(e,t){return this._r(e,((e,n)=>t(n)))}addReference(e,t,n){return mc(e,n)}removeReference(e,t,n){return mc(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return mc(e,t)}ar(e,t){return function(e,t){let n=!1;return nc(e).X((r=>Zl(e,r,t).next((e=>(e&&(n=!0),_n.resolve(!e)))))).next((()=>n))}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let i=0;return this._r(e,((o,s)=>{if(s<=t){const t=this.ar(e,o).next((t=>{if(!t)return i++,n.getEntry(e,o).next((()=>(n.removeEntry(o,on.min()),ac(e).delete(function(e){return[0,Kn(e.path)]}(o)))))}));r.push(t)}})).next((()=>_n.waitFor(r))).next((()=>n.apply(e))).next((()=>i))}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return mc(e,t)}_r(e,t){const n=ac(e);let r,i=Vn.ae;return n.Z({index:xr},((e,n)=>{let[o,s]=e,{path:a,sequenceNumber:l}=n;0===o?(i!==Vn.ae&&t(new dn(Qn(r)),i),i=l,r=a):i=Vn.ae})).next((()=>{i!==Vn.ae&&t(new dn(Qn(r)),i)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function mc(e,t){return ac(e).put(function(e,t){return{targetId:0,path:Kn(e.path),sequenceNumber:t}}(t,e.currentSequenceNumber))}class yc{constructor(){this.changes=new ns((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,oo.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?_n.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class vc{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return Ic(e).put(n)}removeEntry(e,t,n){return Ic(e).delete(function(e,t){const n=e.path.toArray();return[n.slice(0,n.length-2),n[n.length-2],el(t),n[n.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next((n=>(n.byteSize+=t,this.ur(e,n))))}getEntry(e,t){let n=oo.newInvalidDocument(t);return Ic(e).Z({index:ur,range:IDBKeyRange.only(Sc(t))},((e,r)=>{n=this.cr(t,r)})).next((()=>n))}lr(e,t){let n={size:0,document:oo.newInvalidDocument(t)};return Ic(e).Z({index:ur,range:IDBKeyRange.only(Sc(t))},((e,r)=>{n={document:this.cr(t,r),size:Xl(r)}})).next((()=>n))}getEntries(e,t){let n=is();return this.hr(e,t,((e,t)=>{const r=this.cr(e,t);n=n.insert(e,r)})).next((()=>n))}Pr(e,t){let n=is(),r=new oi(dn.comparator);return this.hr(e,t,((e,t)=>{const i=this.cr(e,t);n=n.insert(e,i),r=r.insert(e,Xl(t))})).next((()=>({documents:n,Tr:r})))}hr(e,t,n){if(t.isEmpty())return _n.resolve();let r=new li(_c);t.forEach((e=>r=r.add(e)));const i=IDBKeyRange.bound(Sc(r.first()),Sc(r.last())),o=r.getIterator();let s=o.getNext();return Ic(e).Z({index:ur,range:i},((e,t,r)=>{const i=dn.fromSegments([...t.prefixPath,t.collectionGroup,t.documentId]);for(;s&&_c(s,i)<0;)n(s,null),s=o.getNext();s&&s.isEqual(i)&&(n(s,t),s=o.hasNext()?o.getNext():null),s?r.W(Sc(s)):r.done()})).next((()=>{for(;s;)n(s,null),s=o.hasNext()?o.getNext():null}))}getDocumentsMatchingQuery(e,t,n,r,i){const o=t.path,s=[o.popLast().toArray(),o.lastSegment(),el(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],a=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Ic(e).G(IDBKeyRange.bound(s,a,!0)).next((e=>{null==i||i.incrementDocumentReadCount(e.length);let n=is();for(const i of e){const e=this.cr(dn.fromSegments(i.prefixPath.concat(i.collectionGroup,i.documentId)),i);e.isFoundDocument()&&(Jo(t,e)||r.has(e.key))&&(n=n.insert(e.key,e))}return n}))}getAllFromCollectionGroup(e,t,n,r){let i=is();const o=Ec(t,n),s=Ec(t,wn.max());return Ic(e).Z({index:hr,range:IDBKeyRange.bound(o,s,!0)},((e,t,n)=>{const o=this.cr(dn.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);i=i.insert(o.key,o),i.size===r&&n.done()})).next((()=>i))}newChangeBuffer(e){return new wc(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((e=>e.byteSize))}getMetadata(e){return xc(e).get(gr).next((e=>(Rt(!!e),e)))}ur(e,t){return xc(e).put(gr,t)}cr(e,t){if(t){const e=function(e,t){let n;if(t.document)n=Ma(e.Tt,t.document,!!t.hasCommittedMutations);else if(t.noDocument){const e=dn.fromSegments(t.noDocument.path),r=nl(t.noDocument.readTime);n=oo.newNoDocument(e,r),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return Pt();{const e=dn.fromSegments(t.unknownDocument.path),r=nl(t.unknownDocument.version);n=oo.newUnknownDocument(e,r)}}return t.readTime&&n.setReadTime(function(e){const t=new rn(e[0],e[1]);return on.fromTimestamp(t)}(t.readTime)),n}(this.serializer,t);if(!e.isNoDocument()||!e.version.isEqual(on.min()))return e}return oo.newInvalidDocument(e)}}function bc(e){return new vc(e)}class wc extends yc{constructor(e,t){super(),this.Ir=e,this.trackRemovals=t,this.Er=new ns((e=>e.toString()),((e,t)=>e.isEqual(t)))}applyChanges(e){const t=[];let n=0,r=new li(((e,t)=>Qt(e.canonicalString(),t.canonicalString())));return this.changes.forEach(((i,o)=>{const s=this.Er.get(i);if(t.push(this.Ir.removeEntry(e,i,s.readTime)),o.isValidDocument()){const a=Za(this.Ir.serializer,o);r=r.add(i.path.popLast());const l=Xl(a);n+=l-s.size,t.push(this.Ir.addEntry(e,i,a))}else if(n-=s.size,this.trackRemovals){const n=Za(this.Ir.serializer,o.convertToNoDocument(on.min()));t.push(this.Ir.addEntry(e,i,n))}})),r.forEach((n=>{t.push(this.Ir.indexManager.addToCollectionParentIndex(e,n))})),t.push(this.Ir.updateMetadata(e,n)),_n.waitFor(t)}getFromCache(e,t){return this.Ir.lr(e,t).next((e=>(this.Er.set(t,{size:e.size,readTime:e.document.readTime}),e.document)))}getAllFromCache(e,t){return this.Ir.Pr(e,t).next((e=>{let{documents:t,Tr:n}=e;return n.forEach(((e,n)=>{this.Er.set(e,{size:n,readTime:t.get(e).readTime})})),t}))}}function xc(e){return ti(e,pr)}function Ic(e){return ti(e,lr)}function Sc(e){const t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function Ec(e,t){const n=t.documentKey.path.toArray();return[e,el(t.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function _c(e,t){const n=e.path.toArray(),r=t.path.toArray();let i=0;for(let o=0;o<n.length-2&&o<r.length-2;++o)if(i=Qt(n[o],r[o]),i)return i;return i=Qt(n.length,r.length),i||(i=Qt(n[n.length-2],r[r.length-2]),i||Qt(n[n.length-1],r[r.length-1]))}class Tc{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class kc{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(n=r,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(null!==n&&zs(n.mutation,e,di.empty(),rn.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,fs()).next((()=>t))))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:fs();const r=ls();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,n).next((e=>{let t=ss();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const n=ls();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,fs())))}populateOverlays(e,t,n){const r=[];return n.forEach((e=>{t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,r){let i=is();const o=us(),s=us();return t.forEach(((e,t)=>{const s=n.get(t.key);r.has(t.key)&&(void 0===s||s.mutation instanceof $s)?i=i.insert(t.key,t):void 0!==s?(o.set(t.key,s.mutation.getFieldMask()),zs(s.mutation,t,s.mutation.getFieldMask(),rn.now())):o.set(t.key,di.empty())})),this.recalculateAndSaveOverlays(e,i).next((e=>(e.forEach(((e,t)=>o.set(e,t))),t.forEach(((e,t)=>{var n;return s.set(e,new Tc(t,null!==(n=o.get(e))&&void 0!==n?n:null))})),s)))}recalculateAndSaveOverlays(e,t){const n=us();let r=new oi(((e,t)=>e-t)),i=fs();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const i of e)i.keys().forEach((e=>{const o=t.get(e);if(null===o)return;let s=n.get(e)||di.empty();s=i.applyToLocalView(o,s),n.set(e,s);const a=(r.get(i.batchId)||fs()).add(e);r=r.insert(i.batchId,a)}))})).next((()=>{const o=[],s=r.getReverseIterator();for(;s.hasNext();){const r=s.getNext(),a=r.key,l=r.value,c=cs();l.forEach((e=>{if(!i.has(e)){const r=Ms(t.get(e),n.get(e));null!==r&&c.set(e,r),i=i.add(e)}})),o.push(this.documentOverlayCache.saveOverlays(e,a,c))}return _n.waitFor(o)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return dn.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Bo(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((i=>{const o=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):_n.resolve(ls());let s=hn,a=i;return o.next((t=>_n.forEach(t,((t,n)=>(s<n.largestBatchId&&(s=n.largestBatchId),i.get(t)?_n.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{a=a.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,i))).next((()=>this.computeViews(e,a,t,fs()))).next((e=>({batchId:s,changes:as(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new dn(t)).next((e=>{let t=ss();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const i=t.collectionGroup;let o=ss();return this.indexManager.getCollectionParents(e,i).next((s=>_n.forEach(s,(s=>{const a=function(e,t){return new Fo(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,s.child(i));return this.getDocumentsMatchingCollectionQuery(e,a,n,r).next((e=>{e.forEach(((e,t)=>{o=o.insert(e,t)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r)))).next((e=>{i.forEach(((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,oo.newInvalidDocument(r)))}));let n=ss();return e.forEach(((e,r)=>{const o=i.get(e);void 0!==o&&zs(o.mutation,r,di.empty(),rn.now()),Jo(t,r)&&(n=n.insert(e,r))})),n}))}}class Cc{constructor(e){this.serializer=e,this.dr=new Map,this.Ar=new Map}getBundleMetadata(e,t){return _n.resolve(this.dr.get(t))}saveBundleMetadata(e,t){return this.dr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:_a(e.createTime)}}(t)),_n.resolve()}getNamedQuery(e,t){return _n.resolve(this.Ar.get(t))}saveNamedQuery(e,t){return this.Ar.set(t.name,function(e){return{name:e.name,query:sl(e.bundledQuery),readTime:_a(e.readTime)}}(t)),_n.resolve()}}class Nc{constructor(){this.overlays=new oi(dn.comparator),this.Rr=new Map}getOverlay(e,t){return _n.resolve(this.overlays.get(t))}getOverlays(e,t){const n=ls();return _n.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,r)=>{this.Et(e,t,r)})),_n.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.Rr.get(n);return void 0!==r&&(r.forEach((e=>this.overlays=this.overlays.remove(e))),this.Rr.delete(n)),_n.resolve()}getOverlaysForCollection(e,t,n){const r=ls(),i=t.length+1,o=new dn(t.child("")),s=this.overlays.getIteratorFrom(o);for(;s.hasNext();){const e=s.getNext().value,o=e.getKey();if(!t.isPrefixOf(o.path))break;o.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return _n.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new oi(((e,t)=>e-t));const o=this.overlays.getIterator();for(;o.hasNext();){const e=o.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=ls(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const s=ls(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((e,t)=>s.set(e,t))),!(s.size()>=r)););return _n.resolve(s)}Et(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.Rr.get(r.largestBatchId).delete(n.key);this.Rr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new Ys(t,n));let i=this.Rr.get(t);void 0===i&&(i=fs(),this.Rr.set(t,i)),this.Rr.set(t,i.add(n.key))}}class Ac{constructor(){this.sessionToken=fi.EMPTY_BYTE_STRING}getSessionToken(e){return _n.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,_n.resolve()}}class Dc{constructor(){this.Vr=new li(Pc.mr),this.gr=new li(Pc.pr)}isEmpty(){return this.Vr.isEmpty()}addReference(e,t){const n=new Pc(e,t);this.Vr=this.Vr.add(n),this.gr=this.gr.add(n)}yr(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.wr(new Pc(e,t))}Sr(e,t){e.forEach((e=>this.removeReference(e,t)))}br(e){const t=new dn(new ln([])),n=new Pc(t,e),r=new Pc(t,e+1),i=[];return this.gr.forEachInRange([n,r],(e=>{this.wr(e),i.push(e.key)})),i}Dr(){this.Vr.forEach((e=>this.wr(e)))}wr(e){this.Vr=this.Vr.delete(e),this.gr=this.gr.delete(e)}vr(e){const t=new dn(new ln([])),n=new Pc(t,e),r=new Pc(t,e+1);let i=fs();return this.gr.forEachInRange([n,r],(e=>{i=i.add(e.key)})),i}containsKey(e){const t=new Pc(e,0),n=this.Vr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class Pc{constructor(e,t){this.key=e,this.Cr=t}static mr(e,t){return dn.comparator(e.key,t.key)||Qt(e.Cr,t.Cr)}static pr(e,t){return Qt(e.Cr,t.Cr)||dn.comparator(e.key,t.key)}}class Rc{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Fr=1,this.Mr=new li(Pc.mr)}checkEmpty(e){return _n.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.Fr;this.Fr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Gs(i,t,n,r);this.mutationQueue.push(o);for(const s of r)this.Mr=this.Mr.add(new Pc(s.key,i)),this.indexManager.addToCollectionParentIndex(e,s.key.path.popLast());return _n.resolve(o)}lookupMutationBatch(e,t){return _n.resolve(this.Or(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.Nr(n),i=r<0?0:r;return _n.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return _n.resolve(0===this.mutationQueue.length?Un:this.Fr-1)}getAllMutationBatches(e){return _n.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Pc(t,0),r=new Pc(t,Number.POSITIVE_INFINITY),i=[];return this.Mr.forEachInRange([n,r],(e=>{const t=this.Or(e.Cr);i.push(t)})),_n.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new li(Qt);return t.forEach((e=>{const t=new Pc(e,0),r=new Pc(e,Number.POSITIVE_INFINITY);this.Mr.forEachInRange([t,r],(e=>{n=n.add(e.Cr)}))})),_n.resolve(this.Br(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;dn.isDocumentKey(i)||(i=i.child(""));const o=new Pc(new dn(i),0);let s=new li(Qt);return this.Mr.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(s=s.add(e.Cr)),!0)}),o),_n.resolve(this.Br(s))}Br(e){const t=[];return e.forEach((e=>{const n=this.Or(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){Rt(0===this.Lr(t.batchId,"removed")),this.mutationQueue.shift();let n=this.Mr;return _n.forEach(t.mutations,(r=>{const i=new Pc(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Mr=n}))}qn(e){}containsKey(e,t){const n=new Pc(t,0),r=this.Mr.firstAfterOrEqual(n);return _n.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,_n.resolve()}Lr(e,t){return this.Nr(e)}Nr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Or(e){const t=this.Nr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Oc{constructor(e){this.kr=e,this.docs=new oi(dn.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,o=this.kr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return _n.resolve(n?n.document.mutableCopy():oo.newInvalidDocument(t))}getEntries(e,t){let n=is();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():oo.newInvalidDocument(e))})),_n.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=is();const o=t.path,s=new dn(o.child("__id-9223372036854775808__")),a=this.docs.getIteratorFrom(s);for(;a.hasNext();){const{key:e,value:{document:s}}=a.getNext();if(!o.isPrefixOf(e.path))break;e.path.length>o.length+1||xn(bn(s),n)<=0||(r.has(s.key)||Jo(t,s))&&(i=i.insert(s.key,s.mutableCopy()))}return _n.resolve(i)}getAllFromCollectionGroup(e,t,n,r){Pt()}qr(e,t){return _n.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new Lc(this)}getSize(e){return _n.resolve(this.size)}}class Lc extends yc{constructor(e){super(),this.Ir=e}applyChanges(e){const t=[];return this.changes.forEach(((n,r)=>{r.isValidDocument()?t.push(this.Ir.addEntry(e,r)):this.Ir.removeEntry(n)})),_n.waitFor(t)}getFromCache(e,t){return this.Ir.getEntry(e,t)}getAllFromCache(e,t){return this.Ir.getEntries(e,t)}}class Mc{constructor(e){this.persistence=e,this.Qr=new ns((e=>Ro(e)),Oo),this.lastRemoteSnapshotVersion=on.min(),this.highestTargetId=0,this.$r=0,this.Ur=new Dc,this.targetCount=0,this.Kr=rc.Un()}forEachTarget(e,t){return this.Qr.forEach(((e,n)=>t(n))),_n.resolve()}getLastRemoteSnapshotVersion(e){return _n.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return _n.resolve(this.$r)}allocateTargetId(e){return this.highestTargetId=this.Kr.next(),_n.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.$r&&(this.$r=t),_n.resolve()}zn(e){this.Qr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Kr=new rc(t),this.highestTargetId=t),e.sequenceNumber>this.$r&&(this.$r=e.sequenceNumber)}addTargetData(e,t){return this.zn(t),this.targetCount+=1,_n.resolve()}updateTargetData(e,t){return this.zn(t),_n.resolve()}removeTargetData(e,t){return this.Qr.delete(t.target),this.Ur.br(t.targetId),this.targetCount-=1,_n.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.Qr.forEach(((o,s)=>{s.sequenceNumber<=t&&null===n.get(s.targetId)&&(this.Qr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,s.targetId)),r++)})),_n.waitFor(i).next((()=>r))}getTargetCount(e){return _n.resolve(this.targetCount)}getTargetData(e,t){const n=this.Qr.get(t)||null;return _n.resolve(n)}addMatchingKeys(e,t,n){return this.Ur.yr(t,n),_n.resolve()}removeMatchingKeys(e,t,n){this.Ur.Sr(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((t=>{i.push(r.markPotentiallyOrphaned(e,t))})),_n.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Ur.br(t),_n.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Ur.vr(t);return _n.resolve(n)}containsKey(e,t){return _n.resolve(this.Ur.containsKey(t))}}class jc{constructor(e,t){this.Wr={},this.overlays={},this.Gr=new Vn(0),this.zr=!1,this.zr=!0,this.jr=new Ac,this.referenceDelegate=e(this),this.Hr=new Mc(this),this.indexManager=new jl,this.remoteDocumentCache=function(e){return new Oc(e)}((e=>this.referenceDelegate.Jr(e))),this.serializer=new Ja(t),this.Yr=new Cc(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.zr=!1,Promise.resolve()}get started(){return this.zr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Nc,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.Wr[e.toKey()];return n||(n=new Rc(t,this.referenceDelegate),this.Wr[e.toKey()]=n),n}getGlobalsCache(){return this.jr}getTargetCache(){return this.Hr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Yr}runTransaction(e,t,n){Ct("MemoryPersistence","Starting transaction:",e);const r=new zc(this.Gr.next());return this.referenceDelegate.Zr(),n(r).next((e=>this.referenceDelegate.Xr(r).next((()=>e)))).toPromise().then((e=>(r.raiseOnCommittedEvent(),e)))}ei(e,t){return _n.or(Object.values(this.Wr).map((n=>()=>n.containsKey(e,t))))}}class zc extends Sn{constructor(e){super(),this.currentSequenceNumber=e}}class Fc{constructor(e){this.persistence=e,this.ti=new Dc,this.ni=null}static ri(e){return new Fc(e)}get ii(){if(this.ni)return this.ni;throw Pt()}addReference(e,t,n){return this.ti.addReference(n,t),this.ii.delete(n.toString()),_n.resolve()}removeReference(e,t,n){return this.ti.removeReference(n,t),this.ii.add(n.toString()),_n.resolve()}markPotentiallyOrphaned(e,t){return this.ii.add(t.toString()),_n.resolve()}removeTarget(e,t){this.ti.br(t.targetId).forEach((e=>this.ii.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.ii.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}Zr(){this.ni=new Set}Xr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return _n.forEach(this.ii,(n=>{const r=dn.fromPath(n);return this.si(e,r).next((e=>{e||t.removeEntry(r,on.min())}))})).next((()=>(this.ni=null,t.apply(e))))}updateLimboDocument(e,t){return this.si(e,t).next((e=>{e?this.ii.delete(t.toString()):this.ii.add(t.toString())}))}Jr(e){return 0}si(e,t){return _n.or([()=>_n.resolve(this.ti.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.ei(e,t)])}}class Vc{constructor(e,t){this.persistence=e,this.oi=new ns((e=>Kn(e.path)),((e,t)=>e.isEqual(t))),this.garbageCollector=pc(this,t)}static ri(e,t){return new Vc(e,t)}Zr(){}Xr(e){return _n.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}nr(e){const t=this.sr(e);return this.persistence.getTargetCache().getTargetCount(e).next((e=>t.next((t=>e+t))))}sr(e){let t=0;return this.rr(e,(e=>{t++})).next((()=>t))}rr(e,t){return _n.forEach(this.oi,((n,r)=>this.ar(e,n,r).next((e=>e?_n.resolve():t(r)))))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.qr(e,(r=>this.ar(e,r,t).next((e=>{e||(n++,i.removeEntry(r,on.min()))})))).next((()=>i.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,t){return this.oi.set(t,e.currentSequenceNumber),_n.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.oi.set(n,e.currentSequenceNumber),_n.resolve()}removeReference(e,t,n){return this.oi.set(n,e.currentSequenceNumber),_n.resolve()}updateLimboDocument(e,t){return this.oi.set(t,e.currentSequenceNumber),_n.resolve()}Jr(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=$i(e.data.value)),t}ar(e,t,n){return _n.or([()=>this.persistence.ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const e=this.oi.get(t);return _n.resolve(void 0!==e&&e>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Uc{constructor(e){this.serializer=e}B(e,t,n,r){const i=new kn("createOrUpgrade",t);n<1&&r>=1&&(function(e){e.createObjectStore(Xn)}(e),function(e){e.createObjectStore(Zn,{keyPath:"userId"});e.createObjectStore(er,{keyPath:tr,autoIncrement:!0}).createIndex(nr,rr,{unique:!0}),e.createObjectStore(ar)}(e),$c(e),function(e){e.createObjectStore(Yn)}(e));let o=_n.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore(br),e.deleteObjectStore(mr),e.deleteObjectStore(Er)}(e),$c(e)),o=o.next((()=>function(e){const t=e.store(Er),n={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:on.min().toTimestamp(),targetCount:0};return t.put(Sr,n)}(i)))),n<4&&r>=4&&(0!==n&&(o=o.next((()=>function(e,t){return t.store(er).G().next((n=>{e.deleteObjectStore(er),e.createObjectStore(er,{keyPath:tr,autoIncrement:!0}).createIndex(nr,rr,{unique:!0});const r=t.store(er),i=n.map((e=>r.put(e)));return _n.waitFor(i)}))}(e,i)))),o=o.next((()=>{!function(e){e.createObjectStore(kr,{keyPath:"clientId"})}(e)}))),n<5&&r>=5&&(o=o.next((()=>this._i(i)))),n<6&&r>=6&&(o=o.next((()=>(function(e){e.createObjectStore(pr)}(e),this.ai(i))))),n<7&&r>=7&&(o=o.next((()=>this.ui(i)))),n<8&&r>=8&&(o=o.next((()=>this.ci(e,i)))),n<9&&r>=9&&(o=o.next((()=>{!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e)}))),n<10&&r>=10&&(o=o.next((()=>this.li(i)))),n<11&&r>=11&&(o=o.next((()=>{!function(e){e.createObjectStore(Cr,{keyPath:"bundleId"})}(e),function(e){e.createObjectStore(Nr,{keyPath:"name"})}(e)}))),n<12&&r>=12&&(o=o.next((()=>{!function(e){const t=e.createObjectStore(Vr,{keyPath:Ur});t.createIndex($r,Br,{unique:!1}),t.createIndex(qr,Hr,{unique:!1})}(e)}))),n<13&&r>=13&&(o=o.next((()=>function(e){const t=e.createObjectStore(lr,{keyPath:cr});t.createIndex(ur,dr),t.createIndex(hr,fr)}(e))).next((()=>this.hi(e,i))).next((()=>e.deleteObjectStore(Yn)))),n<14&&r>=14&&(o=o.next((()=>this.Pi(e,i)))),n<15&&r>=15&&(o=o.next((()=>function(e){e.createObjectStore(Ar,{keyPath:"indexId",autoIncrement:!0}).createIndex(Dr,"collectionGroup",{unique:!1});e.createObjectStore(Pr,{keyPath:Rr}).createIndex(Or,Lr,{unique:!1});e.createObjectStore(Mr,{keyPath:jr}).createIndex(zr,Fr,{unique:!1})}(e)))),n<16&&r>=16&&(o=o.next((()=>{t.objectStore(Pr).clear()})).next((()=>{t.objectStore(Mr).clear()}))),n<17&&r>=17&&(o=o.next((()=>{!function(e){e.createObjectStore(Kr,{keyPath:"name"})}(e)}))),o}ai(e){let t=0;return e.store(Yn).Z(((e,n)=>{t+=Xl(n)})).next((()=>{const n={byteSize:t};return e.store(pr).put(gr,n)}))}_i(e){const t=e.store(Zn),n=e.store(er);return t.G().next((t=>_n.forEach(t,(t=>{const r=IDBKeyRange.bound([t.userId,Un],[t.userId,t.lastAcknowledgedBatchId]);return n.G(nr,r).next((n=>_n.forEach(n,(n=>{Rt(n.userId===t.userId);const r=rl(this.serializer,n);return Yl(e,t.userId,r).next((()=>{}))}))))}))))}ui(e){const t=e.store(br),n=e.store(Yn);return e.store(Er).get(Sr).next((e=>{const r=[];return n.Z(((n,i)=>{const o=new ln(n),s=function(e){return[0,Kn(e)]}(o);r.push(t.get(s).next((n=>n?_n.resolve():(n=>t.put({targetId:0,path:Kn(n),sequenceNumber:e.highestListenSequenceNumber}))(o))))})).next((()=>_n.waitFor(r)))}))}ci(e,t){e.createObjectStore(_r,{keyPath:Tr});const n=t.store(_r),r=new zl,i=e=>{if(r.add(e)){const t=e.lastSegment(),r=e.popLast();return n.put({collectionId:t,parent:Kn(r)})}};return t.store(Yn).Z({Y:!0},((e,t)=>{const n=new ln(e);return i(n.popLast())})).next((()=>t.store(ar).Z({Y:!0},((e,t)=>{let[n,r,o]=e;const s=Qn(r);return i(s.popLast())}))))}li(e){const t=e.store(mr);return t.Z(((e,n)=>{const r=il(n),i=ol(this.serializer,r);return t.put(i)}))}hi(e,t){const n=t.store(Yn),r=[];return n.Z(((e,n)=>{const i=t.store(lr),o=function(e){return e.document?new dn(ln.fromString(e.document.name).popFirst(5)):e.noDocument?dn.fromSegments(e.noDocument.path):e.unknownDocument?dn.fromSegments(e.unknownDocument.path):Pt()}(n).path.toArray(),s={prefixPath:o.slice(0,o.length-2),collectionGroup:o[o.length-2],documentId:o[o.length-1],readTime:n.readTime||[0,0],unknownDocument:n.unknownDocument,noDocument:n.noDocument,document:n.document,hasCommittedMutations:!!n.hasCommittedMutations};r.push(i.put(s))})).next((()=>_n.waitFor(r)))}Pi(e,t){const n=t.store(er),r=bc(this.serializer),i=new jc(Fc.ri,this.serializer.Tt);return n.G().next((e=>{const n=new Map;return e.forEach((e=>{var t;let r=null!==(t=n.get(e.userId))&&void 0!==t?t:fs();rl(this.serializer,e).keys().forEach((e=>r=r.add(e))),n.set(e.userId,r)})),_n.forEach(n,((e,n)=>{const o=new Et(n),s=fl.It(this.serializer,o),a=i.getIndexManager(o),l=Jl.It(o,this.serializer,a,i.referenceDelegate);return new kc(r,l,s,a).recalculateAndSaveOverlaysForDocumentKeys(new ei(t,Vn.ae),e).next()}))}))}}function $c(e){e.createObjectStore(br,{keyPath:wr}).createIndex(xr,Ir,{unique:!0}),e.createObjectStore(mr,{keyPath:"targetId"}).createIndex(yr,vr,{unique:!0}),e.createObjectStore(Er)}const Bc="IndexedDbPersistence",qc=18e5,Hc=5e3,Kc="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Wc="main";class Gc{constructor(e,t,n,r,i,o,s,a,l,c){let u=arguments.length>10&&void 0!==arguments[10]?arguments[10]:17;if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.Ti=i,this.window=o,this.document=s,this.Ii=l,this.Ei=c,this.di=u,this.Gr=null,this.zr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ai=null,this.inForeground=!1,this.Ri=null,this.Vi=null,this.mi=Number.NEGATIVE_INFINITY,this.fi=e=>Promise.resolve(),!Gc.D())throw new Mt(Lt.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new gc(this,r),this.gi=t+Wc,this.serializer=new Ja(a),this.pi=new Cn(this.gi,this.di,new Uc(this.serializer)),this.jr=new gl,this.Hr=new ic(this.referenceDelegate,this.serializer),this.remoteDocumentCache=bc(this.serializer),this.Yr=new ul,this.window&&this.window.localStorage?this.yi=this.window.localStorage:(this.yi=null,!1===c&&Nt(Bc,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Mt(Lt.FAILED_PRECONDITION,Kc);return this.Si(),this.bi(),this.Di(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Hr.getHighestSequenceNumber(e)))})).then((e=>{this.Gr=new Vn(e,this.Ii)})).then((()=>{this.zr=!0})).catch((e=>(this.pi&&this.pi.close(),Promise.reject(e))))}Ci(e){return this.fi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.pi.k((async t=>{null===t.newVersion&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Ti.enqueueAndForget((async()=>{this.started&&await this.wi()})))}wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Yc(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Fi(e).next((e=>{e||(this.isPrimary=!1,this.Ti.enqueueRetryable((()=>this.fi(!1))))}))})).next((()=>this.Mi(e))).next((t=>this.isPrimary&&!t?this.xi(e).next((()=>!1)):!!t&&this.Oi(e).next((()=>!0)))))).catch((e=>{if(Pn(e))return Ct(Bc,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Ct(Bc,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Ti.enqueueRetryable((()=>this.fi(e))),this.isPrimary=e}))}Fi(e){return Qc(e).get(Jn).next((e=>_n.resolve(this.Ni(e))))}Bi(e){return Yc(e).delete(this.clientId)}async Li(){if(this.isPrimary&&!this.ki(this.mi,qc)){this.mi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(e=>{const t=ti(e,kr);return t.G().next((e=>{const n=this.qi(e,qc),r=e.filter((e=>-1===n.indexOf(e)));return _n.forEach(r,(e=>t.delete(e.clientId))).next((()=>r))}))})).catch((()=>[]));if(this.yi)for(const t of e)this.yi.removeItem(this.Qi(t.clientId))}}Di(){this.Vi=this.Ti.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.wi().then((()=>this.Li())).then((()=>this.Di()))))}Ni(e){return!!e&&e.ownerId===this.clientId}Mi(e){return this.Ei?_n.resolve(!0):Qc(e).get(Jn).next((t=>{if(null!==t&&this.ki(t.leaseTimestampMs,Hc)&&!this.$i(t.ownerId)){if(this.Ni(t)&&this.networkEnabled)return!0;if(!this.Ni(t)){if(!t.allowTabSynchronization)throw new Mt(Lt.FAILED_PRECONDITION,Kc);return!1}}return!(!this.networkEnabled||!this.inForeground)||Yc(e).G().next((e=>void 0===this.qi(e,Hc).find((e=>{if(this.clientId!==e.clientId){const t=!this.networkEnabled&&e.networkEnabled,n=!this.inForeground&&e.inForeground,r=this.networkEnabled===e.networkEnabled;if(t||n&&r)return!0}return!1}))))})).next((e=>(this.isPrimary!==e&&Ct(Bc,`Client ${e?"is":"is not"} eligible for a primary lease.`),e)))}async shutdown(){this.zr=!1,this.Ui(),this.Vi&&(this.Vi.cancel(),this.Vi=null),this.Ki(),this.Wi(),await this.pi.runTransaction("shutdown","readwrite",[Xn,kr],(e=>{const t=new ei(e,Vn.ae);return this.xi(t).next((()=>this.Bi(t)))})),this.pi.close(),this.Gi()}qi(e,t){return e.filter((e=>this.ki(e.updateTimeMs,t)&&!this.$i(e.clientId)))}zi(){return this.runTransaction("getActiveClients","readonly",(e=>Yc(e).G().next((e=>this.qi(e,qc).map((e=>e.clientId))))))}get started(){return this.zr}getGlobalsCache(){return this.jr}getMutationQueue(e,t){return Jl.It(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Hr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Ul(e,this.serializer.Tt.databaseId)}getDocumentOverlayCache(e){return fl.It(this.serializer,e)}getBundleCache(){return this.Yr}runTransaction(e,t,n){Ct(Bc,"Starting transaction:",e);const r="readonly"===t?"readonly":"readwrite",i=function(e){return 17===e?Zr:16===e?Jr:15===e?Xr:14===e?Yr:13===e?Qr:12===e?Gr:11===e?Wr:void Pt()}(this.di);let o;return this.pi.runTransaction(e,r,i,(r=>(o=new ei(r,this.Gr?this.Gr.next():Vn.ae),"readwrite-primary"===t?this.Fi(o).next((e=>!!e||this.Mi(o))).next((t=>{if(!t)throw Nt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ti.enqueueRetryable((()=>this.fi(!1))),new Mt(Lt.FAILED_PRECONDITION,In);return n(o)})).next((e=>this.Oi(o).next((()=>e)))):this.ji(o).next((()=>n(o)))))).then((e=>(o.raiseOnCommittedEvent(),e)))}ji(e){return Qc(e).get(Jn).next((e=>{if(null!==e&&this.ki(e.leaseTimestampMs,Hc)&&!this.$i(e.ownerId)&&!this.Ni(e)&&!(this.Ei||this.allowTabSynchronization&&e.allowTabSynchronization))throw new Mt(Lt.FAILED_PRECONDITION,Kc)}))}Oi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Qc(e).put(Jn,t)}static D(){return Cn.D()}xi(e){const t=Qc(e);return t.get(Jn).next((e=>this.Ni(e)?(Ct(Bc,"Releasing primary lease."),t.delete(Jn)):_n.resolve()))}ki(e,t){const n=Date.now();return!(e<n-t)&&(!(e>n)||(Nt(`Detected an update time that is in the future: ${e} > ${n}`),!1))}Si(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ri=()=>{this.Ti.enqueueAndForget((()=>(this.inForeground="visible"===this.document.visibilityState,this.wi())))},this.document.addEventListener("visibilitychange",this.Ri),this.inForeground="visible"===this.document.visibilityState)}Ki(){this.Ri&&(this.document.removeEventListener("visibilitychange",this.Ri),this.Ri=null)}bi(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Ai=()=>{this.Ui();const e=/(?:Version|Mobile)\/1[456]/;v()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Ti.enterRestrictedMode(!0),this.Ti.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Ai))}Wi(){this.Ai&&(this.window.removeEventListener("pagehide",this.Ai),this.Ai=null)}$i(e){var t;try{const n=null!==(null===(t=this.yi)||void 0===t?void 0:t.getItem(this.Qi(e)));return Ct(Bc,`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(e){return Nt(Bc,"Failed to get zombied client id.",e),!1}}Ui(){if(this.yi)try{this.yi.setItem(this.Qi(this.clientId),String(Date.now()))}catch(e){Nt("Failed to set zombie client id.",e)}}Gi(){if(this.yi)try{this.yi.removeItem(this.Qi(this.clientId))}catch(e){}}Qi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Qc(e){return ti(e,Xn)}function Yc(e){return ti(e,kr)}function Xc(e,t){let n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}class Jc{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Hi=n,this.Ji=r}static Yi(e,t){let n=fs(),r=fs();for(const i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new Jc(e,t.fromCache,n,r)}}class Zc{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class eu{constructor(){this.Zi=!1,this.Xi=!1,this.es=100,this.ts=v()?8:Nn(m())>0?6:4}initialize(e,t){this.ns=e,this.indexManager=t,this.Zi=!0}getDocumentsMatchingQuery(e,t,n,r){const i={result:null};return this.rs(e,t).next((e=>{i.result=e})).next((()=>{if(!i.result)return this.ss(e,t,r,n).next((e=>{i.result=e}))})).next((()=>{if(i.result)return;const n=new Zc;return this._s(e,t,n).next((r=>{if(i.result=r,this.Xi)return this.us(e,t,n,r.size)}))})).next((()=>i.result))}us(e,t,n,r){return n.documentReadCount<this.es?(kt()<=z.DEBUG&&Ct("QueryEngine","SDK will not create cache indexes for query:",Xo(t),"since it only creates cache indexes for collection contains","more than or equal to",this.es,"documents"),_n.resolve()):(kt()<=z.DEBUG&&Ct("QueryEngine","Query:",Xo(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.ts*r?(kt()<=z.DEBUG&&Ct("QueryEngine","The SDK decides to create cache indexes for query:",Xo(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ho(t))):_n.resolve())}rs(e,t){if($o(t))return _n.resolve(null);let n=Ho(t);return this.indexManager.getIndexType(e,n).next((r=>0===r?null:(null!==t.limit&&1===r&&(t=Go(t,null,"F"),n=Ho(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((r=>{const i=fs(...r);return this.ns.getDocuments(e,i).next((r=>this.indexManager.getMinOffset(e,n).next((n=>{const o=this.cs(t,r);return this.ls(t,o,i,n.readTime)?this.rs(e,Go(t,null,"F")):this.hs(e,o,t,n)}))))})))))}ss(e,t,n,r){return $o(t)||r.isEqual(on.min())?_n.resolve(null):this.ns.getDocuments(e,n).next((i=>{const o=this.cs(t,i);return this.ls(t,o,n,r)?_n.resolve(null):(kt()<=z.DEBUG&&Ct("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Xo(t)),this.hs(e,o,t,vn(r,hn)).next((e=>e)))}))}cs(e,t){let n=new li(es(e));return t.forEach(((t,r)=>{Jo(e,r)&&(n=n.add(r))})),n}ls(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}_s(e,t,n){return kt()<=z.DEBUG&&Ct("QueryEngine","Using full collection scan to execute query:",Xo(t)),this.ns.getDocumentsMatchingQuery(e,t,wn.min(),n)}hs(e,t,n,r){return this.ns.getDocumentsMatchingQuery(e,n,r).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}const tu="LocalStore";class nu{constructor(e,t,n,r){this.persistence=e,this.Ps=t,this.serializer=r,this.Ts=new oi(Qt),this.Is=new ns((e=>Ro(e)),Oo),this.Es=new Map,this.ds=e.getRemoteDocumentCache(),this.Hr=e.getTargetCache(),this.Yr=e.getBundleCache(),this.As(n)}As(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new kc(this.ds,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ds.setIndexManager(this.indexManager),this.Ps.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ts)))}}function ru(e,t,n,r){return new nu(e,t,n,r)}async function iu(e,t){const n=Ot(e);return await n.persistence.runTransaction("Handle user change","readonly",(e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next((i=>(r=i,n.As(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{const i=[],o=[];let s=fs();for(const e of r){i.push(e.batchId);for(const t of e.mutations)s=s.add(t.key)}for(const e of t){o.push(e.batchId);for(const t of e.mutations)s=s.add(t.key)}return n.localDocuments.getDocuments(e,s).next((e=>({Rs:e,removedBatchIds:i,addedBatchIds:o})))}))}))}function ou(e){const t=Ot(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Hr.getLastRemoteSnapshotVersion(e)))}function su(e,t,n){let r=fs(),i=fs();return n.forEach((e=>r=r.add(e))),t.getEntries(e,r).next((e=>{let r=is();return n.forEach(((n,o)=>{const s=e.get(n);o.isFoundDocument()!==s.isFoundDocument()&&(i=i.add(n)),o.isNoDocument()&&o.version.isEqual(on.min())?(t.removeEntry(n,o.readTime),r=r.insert(n,o)):!s.isValidDocument()||o.version.compareTo(s.version)>0||0===o.version.compareTo(s.version)&&s.hasPendingWrites?(t.addEntry(o),r=r.insert(n,o)):Ct(tu,"Ignoring outdated watch update for ",n,". Current version:",s.version," Watch version:",o.version)})),{Vs:r,fs:i}}))}function au(e,t){const n=Ot(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=Un),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}function lu(e,t){const n=Ot(e);return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let r;return n.Hr.getTargetData(e,t).next((i=>i?(r=i,_n.resolve(r)):n.Hr.allocateTargetId(e).next((i=>(r=new Xa(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.Hr.addTargetData(e,r).next((()=>r)))))))})).then((e=>{const r=n.Ts.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ts=n.Ts.insert(e.targetId,e),n.Is.set(t,e.targetId)),e}))}async function cu(e,t,n){const r=Ot(e),i=r.Ts.get(t),o=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",o,(e=>r.persistence.referenceDelegate.removeTarget(e,i)))}catch(e){if(!Pn(e))throw e;Ct(tu,`Failed to update sequence numbers for target ${t}: ${e}`)}r.Ts=r.Ts.remove(t),r.Is.delete(i.target)}function uu(e,t,n){const r=Ot(e);let i=on.min(),o=fs();return r.persistence.runTransaction("Execute query","readwrite",(e=>function(e,t,n){const r=Ot(e),i=r.Is.get(n);return void 0!==i?_n.resolve(r.Ts.get(i)):r.Hr.getTargetData(t,n)}(r,e,Ho(t)).next((t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.Hr.getMatchingKeysForTargetId(e,t.targetId).next((e=>{o=e}))})).next((()=>r.Ps.getDocumentsMatchingQuery(e,t,n?i:on.min(),n?o:fs()))).next((e=>(du(r,Zo(t),e),{documents:e,gs:o})))))}function du(e,t,n){let r=e.Es.get(t)||on.min();n.forEach(((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.Es.set(t,r)}class hu{constructor(){this.activeTargetIds=gs()}Ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}vs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}bs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class fu{constructor(){this.ho=new hu,this.Po={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.ho.Ds(e),this.Po[e]||"not-current"}updateQueryState(e,t,n){this.Po[e]=t}removeLocalQueryTarget(e){this.ho.vs(e)}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){delete this.Po[e]}getAllActiveQueryTargets(){return this.ho.activeTargetIds}isActiveQueryTarget(e){return this.ho.activeTargetIds.has(e)}start(){return this.ho=new hu,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class pu{To(e){}shutdown(){}}const gu="ConnectivityMonitor";class mu{constructor(){this.Io=()=>this.Eo(),this.Ao=()=>this.Ro(),this.Vo=[],this.mo()}To(e){this.Vo.push(e)}shutdown(){window.removeEventListener("online",this.Io),window.removeEventListener("offline",this.Ao)}mo(){window.addEventListener("online",this.Io),window.addEventListener("offline",this.Ao)}Eo(){Ct(gu,"Network connectivity changed: AVAILABLE");for(const e of this.Vo)e(0)}Ro(){Ct(gu,"Network connectivity changed: UNAVAILABLE");for(const e of this.Vo)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let yu=null;function vu(){return null===yu?yu=268435456+Math.round(2147483648*Math.random()):yu++,"0x"+yu.toString(16)}const bu="RestConnection",wu={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class xu{get fo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.po=t+"://"+e.host,this.yo=`projects/${n}/databases/${r}`,this.wo=this.databaseId.database===Ti?`project_id=${n}`:`project_id=${n}&database_id=${r}`}So(e,t,n,r,i){const o=vu(),s=this.bo(e,t.toUriEncodedString());Ct(bu,`Sending RPC '${e}' ${o}:`,s,n);const a={"google-cloud-resource-prefix":this.yo,"x-goog-request-params":this.wo};return this.Do(a,r,i),this.vo(e,s,a,n).then((t=>(Ct(bu,`Received RPC '${e}' ${o}: `,t),t)),(t=>{throw At(bu,`RPC '${e}' ${o} failed with error: `,t,"url: ",s,"request:",n),t}))}Co(e,t,n,r,i,o){return this.So(e,t,n,r,i)}Do(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+_t,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}bo(e,t){const n=wu[e];return`${this.po}/v1/${t}:${n}`}terminate(){}}class Iu{constructor(e){this.Fo=e.Fo,this.Mo=e.Mo}xo(e){this.Oo=e}No(e){this.Bo=e}Lo(e){this.ko=e}onMessage(e){this.qo=e}close(){this.Mo()}send(e){this.Fo(e)}Qo(){this.Oo()}$o(){this.Bo()}Uo(e){this.ko(e)}Ko(e){this.qo(e)}}const Su="WebChannelConnection";class Eu extends xu{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}vo(e,t,n,r){const i=vu();return new Promise(((o,s)=>{const a=new ht;a.setWithCredentials(!0),a.listenOnce(pt.COMPLETE,(()=>{try{switch(a.getLastErrorCode()){case gt.NO_ERROR:const t=a.getResponseJson();Ct(Su,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(t)),o(t);break;case gt.TIMEOUT:Ct(Su,`RPC '${e}' ${i} timed out`),s(new Mt(Lt.DEADLINE_EXCEEDED,"Request time out"));break;case gt.HTTP_ERROR:const n=a.getStatus();if(Ct(Su,`RPC '${e}' ${i} failed with status:`,n,"response text:",a.getResponseText()),n>0){let e=a.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(Lt).indexOf(t)>=0?t:Lt.UNKNOWN}(t.status);s(new Mt(e,t.message))}else s(new Mt(Lt.UNKNOWN,"Server responded with status "+a.getStatus()))}else s(new Mt(Lt.UNAVAILABLE,"Connection failed."));break;default:Pt()}}finally{Ct(Su,`RPC '${e}' ${i} completed.`)}}));const l=JSON.stringify(r);Ct(Su,`RPC '${e}' ${i} sending request:`,r),a.send(t,"POST",l,n,15)}))}Wo(e,t,n){const r=vu(),i=[this.po,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=bt(),s=vt(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(a.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Do(a.initMessageHeaders,t,n),a.encodeInitMessageHeaders=!0;const c=i.join("");Ct(Su,`Creating RPC '${e}' stream ${r}: ${c}`,a);const u=o.createWebChannel(c,a);let d=!1,h=!1;const f=new Iu({Fo:t=>{h?Ct(Su,`Not sending because RPC '${e}' stream ${r} is closed:`,t):(d||(Ct(Su,`Opening RPC '${e}' stream ${r} transport.`),u.open(),d=!0),Ct(Su,`RPC '${e}' stream ${r} sending:`,t),u.send(t))},Mo:()=>u.close()}),p=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return p(u,ft.EventType.OPEN,(()=>{h||(Ct(Su,`RPC '${e}' stream ${r} transport opened.`),f.Qo())})),p(u,ft.EventType.CLOSE,(()=>{h||(h=!0,Ct(Su,`RPC '${e}' stream ${r} transport closed`),f.Uo())})),p(u,ft.EventType.ERROR,(t=>{h||(h=!0,At(Su,`RPC '${e}' stream ${r} transport errored:`,t),f.Uo(new Mt(Lt.UNAVAILABLE,"The operation could not be completed")))})),p(u,ft.EventType.MESSAGE,(t=>{var n;if(!h){const i=t.data[0];Rt(!!i);const o=i,s=(null==o?void 0:o.error)||(null===(n=o[0])||void 0===n?void 0:n.error);if(s){Ct(Su,`RPC '${e}' stream ${r} received error:`,s);const t=s.status;let n=function(e){const t=Js[e];if(void 0!==t)return ta(t)}(t),i=s.message;void 0===n&&(n=Lt.INTERNAL,i="Unknown error status: "+t+" with message "+s.message),h=!0,f.Uo(new Mt(n,i)),u.close()}else Ct(Su,`RPC '${e}' stream ${r} received:`,i),f.Ko(i)}})),p(s,yt.STAT_EVENT,(t=>{t.stat===mt.PROXY?Ct(Su,`RPC '${e}' stream ${r} detected buffering proxy`):t.stat===mt.NOPROXY&&Ct(Su,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{f.$o()}),0),f}}function _u(){return"undefined"!=typeof window?window:null}function Tu(){return"undefined"!=typeof document?document:null}function ku(e){return new wa(e,!0)}class Cu{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.Ti=e,this.timerId=t,this.Go=n,this.zo=r,this.jo=i,this.Ho=0,this.Jo=null,this.Yo=Date.now(),this.reset()}reset(){this.Ho=0}Zo(){this.Ho=this.jo}Xo(e){this.cancel();const t=Math.floor(this.Ho+this.e_()),n=Math.max(0,Date.now()-this.Yo),r=Math.max(0,t-n);r>0&&Ct("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Ho} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Jo=this.Ti.enqueueAfterDelay(this.timerId,r,(()=>(this.Yo=Date.now(),e()))),this.Ho*=this.zo,this.Ho<this.Go&&(this.Ho=this.Go),this.Ho>this.jo&&(this.Ho=this.jo)}t_(){null!==this.Jo&&(this.Jo.skipDelay(),this.Jo=null)}cancel(){null!==this.Jo&&(this.Jo.cancel(),this.Jo=null)}e_(){return(Math.random()-.5)*this.Ho}}const Nu="PersistentStream";class Au{constructor(e,t,n,r,i,o,s,a){this.Ti=e,this.n_=n,this.r_=r,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=s,this.listener=a,this.state=0,this.i_=0,this.s_=null,this.o_=null,this.stream=null,this.__=0,this.a_=new Cu(e,t)}u_(){return 1===this.state||5===this.state||this.c_()}c_(){return 2===this.state||3===this.state}start(){this.__=0,4!==this.state?this.auth():this.l_()}async stop(){this.u_()&&await this.close(0)}h_(){this.state=0,this.a_.reset()}P_(){this.c_()&&null===this.s_&&(this.s_=this.Ti.enqueueAfterDelay(this.n_,6e4,(()=>this.T_())))}I_(e){this.E_(),this.stream.send(e)}async T_(){if(this.c_())return this.close(0)}E_(){this.s_&&(this.s_.cancel(),this.s_=null)}d_(){this.o_&&(this.o_.cancel(),this.o_=null)}async close(e,t){this.E_(),this.d_(),this.a_.cancel(),this.i_++,4!==e?this.a_.reset():t&&t.code===Lt.RESOURCE_EXHAUSTED?(Nt(t.toString()),Nt("Using maximum backoff delay to prevent overloading the backend."),this.a_.Zo()):t&&t.code===Lt.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.A_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Lo(t)}A_(){}auth(){this.state=1;const e=this.R_(this.i_),t=this.i_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((e=>{let[n,r]=e;this.i_===t&&this.V_(n,r)}),(t=>{e((()=>{const e=new Mt(Lt.UNKNOWN,"Fetching auth token failed: "+t.message);return this.m_(e)}))}))}V_(e,t){const n=this.R_(this.i_);this.stream=this.f_(e,t),this.stream.xo((()=>{n((()=>this.listener.xo()))})),this.stream.No((()=>{n((()=>(this.state=2,this.o_=this.Ti.enqueueAfterDelay(this.r_,1e4,(()=>(this.c_()&&(this.state=3),Promise.resolve()))),this.listener.No())))})),this.stream.Lo((e=>{n((()=>this.m_(e)))})),this.stream.onMessage((e=>{n((()=>1==++this.__?this.g_(e):this.onNext(e)))}))}l_(){this.state=5,this.a_.Xo((async()=>{this.state=0,this.start()}))}m_(e){return Ct(Nu,`close with error: ${e}`),this.stream=null,this.close(4,e)}R_(e){return t=>{this.Ti.enqueueAndForget((()=>this.i_===e?t():(Ct(Nu,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Du extends Au{constructor(e,t,n,r,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,o),this.serializer=i}f_(e,t){return this.connection.Wo("Listen",e,t)}g_(e){return this.onNext(e)}onNext(e){this.a_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:Pt()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],o=function(e,t){return e.useProto3Json?(Rt(void 0===t||"string"==typeof t),fi.fromBase64String(t||"")):(Rt(void 0===t||t instanceof Buffer||t instanceof Uint8Array),fi.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),s=t.targetChange.cause,a=s&&function(e){const t=void 0===e.code?Lt.UNKNOWN:ta(e.code);return new Mt(t,e.message||"")}(s);n=new ha(r,i,o,a||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=Aa(e,r.document.name),o=_a(r.document.updateTime),s=r.document.createTime?_a(r.document.createTime):on.min(),a=new ro({mapValue:{fields:r.document.fields}}),l=oo.newFoundDocument(i,o,s,a),c=r.targetIds||[],u=r.removedTargetIds||[];n=new ua(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=Aa(e,r.document),o=r.readTime?_a(r.readTime):on.min(),s=oo.newNoDocument(i,o),a=r.removedTargetIds||[];n=new ua([],a,s.key,s)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=Aa(e,r.document),o=r.removedTargetIds||[];n=new ua([],o,i,null)}else{if(!("filter"in t))return Pt();{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:i}=e,o=new Xs(r,i),s=e.targetId;n=new da(s,o)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return on.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?on.min():t.readTime?_a(t.readTime):on.min()}(e);return this.listener.p_(t,n)}y_(e){const t={};t.database=Ra(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=Lo(r)?{documents:Fa(e,r)}:{query:Va(e,r).ht},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=Sa(e,t.resumeToken);const r=xa(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(on.min())>0){n.readTime=Ia(e,t.snapshotVersion.toTimestamp());const r=xa(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Pt()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.I_(t)}w_(e){const t={};t.database=Ra(this.serializer),t.removeTarget=e,this.I_(t)}}class Pu extends Au{constructor(e,t,n,r,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,o),this.serializer=i}get S_(){return this.__>0}start(){this.lastStreamToken=void 0,super.start()}A_(){this.S_&&this.b_([])}f_(e,t){return this.connection.Wo("Write",e,t)}g_(e){return Rt(!!e.streamToken),this.lastStreamToken=e.streamToken,Rt(!e.writeResults||0===e.writeResults.length),this.listener.D_()}onNext(e){Rt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.a_.reset();const t=function(e,t){return e&&e.length>0?(Rt(void 0!==t),e.map((e=>function(e,t){let n=e.updateTime?_a(e.updateTime):_a(t);return n.isEqual(on.min())&&(n=_a(t)),new Ps(n,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),n=_a(e.commitTime);return this.listener.v_(n,t)}C_(){const e={};e.database=Ra(this.serializer),this.I_(e)}b_(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>ja(this.serializer,e)))};this.I_(t)}}class Ru{}class Ou extends Ru{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.F_=!1}M_(){if(this.F_)throw new Mt(Lt.FAILED_PRECONDITION,"The client has already been terminated.")}So(e,t,n,r){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((i=>{let[o,s]=i;return this.connection.So(e,ka(t,n),r,o,s)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===Lt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Mt(Lt.UNKNOWN,e.toString())}))}Co(e,t,n,r,i){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((o=>{let[s,a]=o;return this.connection.Co(e,ka(t,n),r,s,a,i)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===Lt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Mt(Lt.UNKNOWN,e.toString())}))}terminate(){this.F_=!0,this.connection.terminate()}}class Lu{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.x_=0,this.O_=null,this.N_=!0}B_(){0===this.x_&&(this.L_("Unknown"),this.O_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.O_=null,this.k_("Backend didn't respond within 10 seconds."),this.L_("Offline"),Promise.resolve()))))}q_(e){"Online"===this.state?this.L_("Unknown"):(this.x_++,this.x_>=1&&(this.Q_(),this.k_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.L_("Offline")))}set(e){this.Q_(),this.x_=0,"Online"===e&&(this.N_=!1),this.L_(e)}L_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}k_(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.N_?(Nt(t),this.N_=!1):Ct("OnlineStateTracker",t)}Q_(){null!==this.O_&&(this.O_.cancel(),this.O_=null)}}const Mu="RemoteStore";class ju{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.U_=[],this.K_=new Map,this.W_=new Set,this.G_=[],this.z_=i,this.z_.To((e=>{n.enqueueAndForget((async()=>{Ku(this)&&(Ct(Mu,"Restarting streams for network reachability change."),await async function(e){const t=Ot(e);t.W_.add(4),await Fu(t),t.j_.set("Unknown"),t.W_.delete(4),await zu(t)}(this))}))})),this.j_=new Lu(n,r)}}async function zu(e){if(Ku(e))for(const t of e.G_)await t(!0)}async function Fu(e){for(const t of e.G_)await t(!1)}function Vu(e,t){const n=Ot(e);n.K_.has(t.targetId)||(n.K_.set(t.targetId,t),Hu(n)?qu(n):dd(n).c_()&&$u(n,t))}function Uu(e,t){const n=Ot(e),r=dd(n);n.K_.delete(t),r.c_()&&Bu(n,t),0===n.K_.size&&(r.c_()?r.P_():Ku(n)&&n.j_.set("Unknown"))}function $u(e,t){if(e.H_.Ne(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(on.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}dd(e).y_(t)}function Bu(e,t){e.H_.Ne(t),dd(e).w_(t)}function qu(e){e.H_=new pa({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),lt:t=>e.K_.get(t)||null,it:()=>e.datastore.serializer.databaseId}),dd(e).start(),e.j_.B_()}function Hu(e){return Ku(e)&&!dd(e).u_()&&e.K_.size>0}function Ku(e){return 0===Ot(e).W_.size}function Wu(e){e.H_=void 0}async function Gu(e){e.j_.set("Online")}async function Qu(e){e.K_.forEach(((t,n)=>{$u(e,t)}))}async function Yu(e,t){Wu(e),Hu(e)?(e.j_.q_(t),qu(e)):e.j_.set("Unknown")}async function Xu(e,t,n){if(e.j_.set("Online"),t instanceof ha&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.K_.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.K_.delete(r),e.H_.removeTarget(r))}(e,t)}catch(n){Ct(Mu,"Failed to remove targets %s: %s ",t.targetIds.join(","),n),await Ju(e,n)}else if(t instanceof ua?e.H_.We(t):t instanceof da?e.H_.Ze(t):e.H_.je(t),!n.isEqual(on.min()))try{const t=await ou(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.H_.ot(t);return n.targetChanges.forEach(((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.K_.get(r);i&&e.K_.set(r,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach(((t,n)=>{const r=e.K_.get(t);if(!r)return;e.K_.set(t,r.withResumeToken(fi.EMPTY_BYTE_STRING,r.snapshotVersion)),Bu(e,t);const i=new Xa(r.target,t,n,r.sequenceNumber);$u(e,i)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){Ct(Mu,"Failed to raise snapshot:",t),await Ju(e,t)}}async function Ju(e,t,n){if(!Pn(t))throw t;e.W_.add(1),await Fu(e),e.j_.set("Offline"),n||(n=()=>ou(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{Ct(Mu,"Retrying IndexedDB access"),await n(),e.W_.delete(1),await zu(e)}))}function Zu(e,t){return t().catch((n=>Ju(e,n,t)))}async function ed(e){const t=Ot(e),n=hd(t);let r=t.U_.length>0?t.U_[t.U_.length-1].batchId:Un;for(;td(t);)try{const e=await au(t.localStore,r);if(null===e){0===t.U_.length&&n.P_();break}r=e.batchId,nd(t,e)}catch(e){await Ju(t,e)}rd(t)&&id(t)}function td(e){return Ku(e)&&e.U_.length<10}function nd(e,t){e.U_.push(t);const n=hd(e);n.c_()&&n.S_&&n.b_(t.mutations)}function rd(e){return Ku(e)&&!hd(e).u_()&&e.U_.length>0}function id(e){hd(e).start()}async function od(e){hd(e).C_()}async function sd(e){const t=hd(e);for(const n of e.U_)t.b_(n.mutations)}async function ad(e,t,n){const r=e.U_.shift(),i=Qs.from(r,t,n);await Zu(e,(()=>e.remoteSyncer.applySuccessfulWrite(i))),await ed(e)}async function ld(e,t){t&&hd(e).S_&&await async function(e,t){if(function(e){return ea(e)&&e!==Lt.ABORTED}(t.code)){const n=e.U_.shift();hd(e).h_(),await Zu(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await ed(e)}}(e,t),rd(e)&&id(e)}async function cd(e,t){const n=Ot(e);n.asyncQueue.verifyOperationInProgress(),Ct(Mu,"RemoteStore received new credentials");const r=Ku(n);n.W_.add(3),await Fu(n),r&&n.j_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.W_.delete(3),await zu(n)}async function ud(e,t){const n=Ot(e);t?(n.W_.delete(2),await zu(n)):t||(n.W_.add(2),await Fu(n),n.j_.set("Unknown"))}function dd(e){return e.J_||(e.J_=function(e,t,n){const r=Ot(e);return r.M_(),new Du(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{xo:Gu.bind(null,e),No:Qu.bind(null,e),Lo:Yu.bind(null,e),p_:Xu.bind(null,e)}),e.G_.push((async t=>{t?(e.J_.h_(),Hu(e)?qu(e):e.j_.set("Unknown")):(await e.J_.stop(),Wu(e))}))),e.J_}function hd(e){return e.Y_||(e.Y_=function(e,t,n){const r=Ot(e);return r.M_(),new Pu(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{xo:()=>Promise.resolve(),No:od.bind(null,e),Lo:ld.bind(null,e),D_:sd.bind(null,e),v_:ad.bind(null,e)}),e.G_.push((async t=>{t?(e.Y_.h_(),await ed(e)):(await e.Y_.stop(),e.U_.length>0&&(Ct(Mu,`Stopping write stream with ${e.U_.length} pending writes`),e.U_=[]))}))),e.Y_}class fd{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new jt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,i){const o=Date.now()+n,s=new fd(e,t,o,r,i);return s.start(n),s}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Mt(Lt.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function pd(e,t){if(Nt("AsyncQueue",`${t}: ${e}`),Pn(e))return new Mt(Lt.UNAVAILABLE,`${t}: ${e}`);throw e}class gd{static emptySet(e){return new gd(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||dn.comparator(t.key,n.key):(e,t)=>dn.comparator(e.key,t.key),this.keyedMap=ss(),this.sortedSet=new oi(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof gd))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new gd;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class md{constructor(){this.Z_=new oi(dn.comparator)}track(e){const t=e.doc.key,n=this.Z_.get(t);n?0!==e.type&&3===n.type?this.Z_=this.Z_.insert(t,e):3===e.type&&1!==n.type?this.Z_=this.Z_.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Z_=this.Z_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Z_=this.Z_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Z_=this.Z_.remove(t):1===e.type&&2===n.type?this.Z_=this.Z_.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Z_=this.Z_.insert(t,{type:2,doc:e.doc}):Pt():this.Z_=this.Z_.insert(t,e)}X_(){const e=[];return this.Z_.inorderTraversal(((t,n)=>{e.push(n)})),e}}class yd{constructor(e,t,n,r,i,o,s,a,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=a,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,r,i){const o=[];return t.forEach((e=>{o.push({type:0,doc:e})})),new yd(e,t,gd.emptySet(t),o,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Qo(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class vd{constructor(){this.ea=void 0,this.ta=[]}na(){return this.ta.some((e=>e.ra()))}}class bd{constructor(){this.queries=wd(),this.onlineState="Unknown",this.ia=new Set}terminate(){!function(e,t){const n=Ot(e),r=n.queries;n.queries=wd(),r.forEach(((e,n)=>{for(const r of n.ta)r.onError(t)}))}(this,new Mt(Lt.ABORTED,"Firestore shutting down"))}}function wd(){return new ns((e=>Yo(e)),Qo)}async function xd(e,t){const n=Ot(e);let r=3;const i=t.query;let o=n.queries.get(i);o?!o.na()&&t.ra()&&(r=2):(o=new vd,r=t.ra()?0:1);try{switch(r){case 0:o.ea=await n.onListen(i,!0);break;case 1:o.ea=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(e){const n=pd(e,`Initialization of query '${Xo(t.query)}' failed`);return void t.onError(n)}n.queries.set(i,o),o.ta.push(t),t.sa(n.onlineState),o.ea&&t.oa(o.ea)&&_d(n)}async function Id(e,t){const n=Ot(e),r=t.query;let i=3;const o=n.queries.get(r);if(o){const e=o.ta.indexOf(t);e>=0&&(o.ta.splice(e,1),0===o.ta.length?i=t.ra()?0:1:!o.na()&&t.ra()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Sd(e,t){const n=Ot(e);let r=!1;for(const i of t){const e=i.query,t=n.queries.get(e);if(t){for(const e of t.ta)e.oa(i)&&(r=!0);t.ea=i}}r&&_d(n)}function Ed(e,t,n){const r=Ot(e),i=r.queries.get(t);if(i)for(const o of i.ta)o.onError(n);r.queries.delete(t)}function _d(e){e.ia.forEach((e=>{e.next()}))}var Td,kd;(kd=Td||(Td={}))._a="default",kd.Cache="cache";class Cd{constructor(e,t,n){this.query=e,this.aa=t,this.ua=!1,this.ca=null,this.onlineState="Unknown",this.options=n||{}}oa(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new yd(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.ua?this.la(e)&&(this.aa.next(e),t=!0):this.ha(e,this.onlineState)&&(this.Pa(e),t=!0),this.ca=e,t}onError(e){this.aa.error(e)}sa(e){this.onlineState=e;let t=!1;return this.ca&&!this.ua&&this.ha(this.ca,e)&&(this.Pa(this.ca),t=!0),t}ha(e,t){if(!e.fromCache)return!0;if(!this.ra())return!0;const n="Offline"!==t;return(!this.options.Ta||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}la(e){if(e.docChanges.length>0)return!0;const t=this.ca&&this.ca.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}Pa(e){e=yd.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ua=!0,this.aa.next(e)}ra(){return this.options.source!==Td.Cache}}class Nd{constructor(e){this.key=e}}class Ad{constructor(e){this.key=e}}class Dd{constructor(e,t){this.query=e,this.fa=t,this.ga=null,this.hasCachedResults=!1,this.current=!1,this.pa=fs(),this.mutatedKeys=fs(),this.ya=es(e),this.wa=new gd(this.ya)}get Sa(){return this.fa}ba(e,t){const n=t?t.Da:new md,r=t?t.wa:this.wa;let i=t?t.mutatedKeys:this.mutatedKeys,o=r,s=!1;const a="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((e,t)=>{const c=r.get(e),u=Jo(this.query,t)?t:null,d=!!c&&this.mutatedKeys.has(c.key),h=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;c&&u?c.data.isEqual(u.data)?d!==h&&(n.track({type:3,doc:u}),f=!0):this.va(c,u)||(n.track({type:2,doc:u}),f=!0,(a&&this.ya(u,a)>0||l&&this.ya(u,l)<0)&&(s=!0)):!c&&u?(n.track({type:0,doc:u}),f=!0):c&&!u&&(n.track({type:1,doc:c}),f=!0,(a||l)&&(s=!0)),f&&(u?(o=o.add(u),i=h?i.add(e):i.delete(e)):(o=o.delete(e),i=i.delete(e)))})),null!==this.query.limit)for(;o.size>this.query.limit;){const e="F"===this.query.limitType?o.last():o.first();o=o.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{wa:o,Da:n,ls:s,mutatedKeys:i}}va(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const i=this.wa;this.wa=e.wa,this.mutatedKeys=e.mutatedKeys;const o=e.Da.X_();o.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Pt()}};return n(e)-n(t)}(e.type,t.type)||this.ya(e.doc,t.doc))),this.Ca(n),r=null!=r&&r;const s=t&&!r?this.Fa():[],a=0===this.pa.size&&this.current&&!r?1:0,l=a!==this.ga;return this.ga=a,0!==o.length||l?{snapshot:new yd(this.query,e.wa,i,o,e.mutatedKeys,0===a,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),Ma:s}:{Ma:s}}sa(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({wa:this.wa,Da:new md,mutatedKeys:this.mutatedKeys,ls:!1},!1)):{Ma:[]}}xa(e){return!this.fa.has(e)&&!!this.wa.has(e)&&!this.wa.get(e).hasLocalMutations}Ca(e){e&&(e.addedDocuments.forEach((e=>this.fa=this.fa.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.fa=this.fa.delete(e))),this.current=e.current)}Fa(){if(!this.current)return[];const e=this.pa;this.pa=fs(),this.wa.forEach((e=>{this.xa(e.key)&&(this.pa=this.pa.add(e.key))}));const t=[];return e.forEach((e=>{this.pa.has(e)||t.push(new Ad(e))})),this.pa.forEach((n=>{e.has(n)||t.push(new Nd(n))})),t}Oa(e){this.fa=e.gs,this.pa=fs();const t=this.ba(e.documents);return this.applyChanges(t,!0)}Na(){return yd.fromInitialDocuments(this.query,this.wa,this.mutatedKeys,0===this.ga,this.hasCachedResults)}}const Pd="SyncEngine";class Rd{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Od{constructor(e){this.key=e,this.Ba=!1}}class Ld{constructor(e,t,n,r,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.La={},this.ka=new ns((e=>Yo(e)),Qo),this.qa=new Map,this.Qa=new Set,this.$a=new oi(dn.comparator),this.Ua=new Map,this.Ka=new Dc,this.Wa={},this.Ga=new Map,this.za=rc.Kn(),this.onlineState="Unknown",this.ja=void 0}get isPrimaryClient(){return!0===this.ja}}async function Md(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=rh(e);let i;const o=r.ka.get(t);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.Na()):i=await zd(r,t,n,!0),i}async function jd(e,t){const n=rh(e);await zd(n,t,!0,!1)}async function zd(e,t,n,r){const i=await lu(e.localStore,Ho(t)),o=i.targetId,s=e.sharedClientState.addLocalQueryTarget(o,n);let a;return r&&(a=await Fd(e,t,o,"current"===s,i.resumeToken)),e.isPrimaryClient&&n&&Vu(e.remoteStore,i),a}async function Fd(e,t,n,r,i){e.Ha=(t,n,r)=>async function(e,t,n,r){let i=t.view.ba(n);i.ls&&(i=await uu(e.localStore,t.query,!1).then((e=>{let{documents:n}=e;return t.view.ba(n,i)})));const o=r&&r.targetChanges.get(t.targetId),s=r&&null!=r.targetMismatches.get(t.targetId),a=t.view.applyChanges(i,e.isPrimaryClient,o,s);return Xd(e,t.targetId,a.Ma),a.snapshot}(e,t,n,r);const o=await uu(e.localStore,t,!0),s=new Dd(t,o.gs),a=s.ba(o.documents),l=ca.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),c=s.applyChanges(a,e.isPrimaryClient,l);Xd(e,n,c.Ma);const u=new Rd(t,n,s);return e.ka.set(t,u),e.qa.has(n)?e.qa.get(n).push(t):e.qa.set(n,[t]),c.snapshot}async function Vd(e,t,n){const r=Ot(e),i=r.ka.get(t),o=r.qa.get(i.targetId);if(o.length>1)return r.qa.set(i.targetId,o.filter((e=>!Qo(e,t)))),void r.ka.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await cu(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Uu(r.remoteStore,i.targetId),Qd(r,i.targetId)})).catch(En)):(Qd(r,i.targetId),await cu(r.localStore,i.targetId,!0))}async function Ud(e,t){const n=Ot(e),r=n.ka.get(t),i=n.qa.get(r.targetId);n.isPrimaryClient&&1===i.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Uu(n.remoteStore,r.targetId))}async function $d(e,t){const n=Ot(e);try{const e=await function(e,t){const n=Ot(e),r=t.snapshotVersion;let i=n.Ts;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const o=n.ds.newChangeBuffer({trackRemovals:!0});i=n.Ts;const s=[];t.targetChanges.forEach(((o,a)=>{const l=i.get(a);if(!l)return;s.push(n.Hr.removeMatchingKeys(e,o.removedDocuments,a).next((()=>n.Hr.addMatchingKeys(e,o.addedDocuments,a))));let c=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(a)?c=c.withResumeToken(fi.EMPTY_BYTE_STRING,on.min()).withLastLimboFreeSnapshotVersion(on.min()):o.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(o.resumeToken,r)),i=i.insert(a,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(l,c,o)&&s.push(n.Hr.updateTargetData(e,c))}));let a=is(),l=fs();if(t.documentUpdates.forEach((r=>{t.resolvedLimboDocuments.has(r)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),s.push(su(e,o,t.documentUpdates).next((e=>{a=e.Vs,l=e.fs}))),!r.isEqual(on.min())){const t=n.Hr.getLastRemoteSnapshotVersion(e).next((t=>n.Hr.setTargetsMetadata(e,e.currentSequenceNumber,r)));s.push(t)}return _n.waitFor(s).next((()=>o.apply(e))).next((()=>n.localDocuments.getLocalViewOfDocuments(e,a,l))).next((()=>a))})).then((e=>(n.Ts=i,e)))}(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const r=n.Ua.get(t);r&&(Rt(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.Ba=!0:e.modifiedDocuments.size>0?Rt(r.Ba):e.removedDocuments.size>0&&(Rt(r.Ba),r.Ba=!1))})),await eh(n,e,t)}catch(e){await En(e)}}function Bd(e,t,n){const r=Ot(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.ka.forEach(((n,r)=>{const i=r.view.sa(t);i.snapshot&&e.push(i.snapshot)})),function(e,t){const n=Ot(e);n.onlineState=t;let r=!1;n.queries.forEach(((e,n)=>{for(const i of n.ta)i.sa(t)&&(r=!0)})),r&&_d(n)}(r.eventManager,t),e.length&&r.La.p_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function qd(e,t,n){const r=Ot(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Ua.get(t),o=i&&i.key;if(o){let e=new oi(dn.comparator);e=e.insert(o,oo.newNoDocument(o,on.min()));const n=fs().add(o),i=new la(on.min(),new Map,new oi(Qt),e,n);await $d(r,i),r.$a=r.$a.remove(o),r.Ua.delete(t),Zd(r)}else await cu(r.localStore,t,!1).then((()=>Qd(r,t,n))).catch(En)}async function Hd(e,t){const n=Ot(e),r=t.batch.batchId;try{const e=await function(e,t){const n=Ot(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const r=t.batch.keys(),i=n.ds.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,o=i.keys();let s=_n.resolve();return o.forEach((e=>{s=s.next((()=>r.getEntry(t,e))).next((t=>{const o=n.docVersions.get(e);Rt(null!==o),t.version.compareTo(o)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),s.next((()=>e.mutationQueue.removeMutationBatch(t,i)))}(n,e,t,i).next((()=>i.apply(e))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=fs();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t)))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(n.localStore,t);Gd(n,r,null),Wd(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await eh(n,e)}catch(e){await En(e)}}async function Kd(e,t,n){const r=Ot(e);try{const e=await function(e,t){const n=Ot(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next((t=>(Rt(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(r.localStore,t);Gd(r,t,n),Wd(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await eh(r,e)}catch(n){await En(n)}}function Wd(e,t){(e.Ga.get(t)||[]).forEach((e=>{e.resolve()})),e.Ga.delete(t)}function Gd(e,t,n){const r=Ot(e);let i=r.Wa[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.Wa[r.currentUser.toKey()]=i}}function Qd(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.qa.get(t))e.ka.delete(r),n&&e.La.Ja(r,n);e.qa.delete(t),e.isPrimaryClient&&e.Ka.br(t).forEach((t=>{e.Ka.containsKey(t)||Yd(e,t)}))}function Yd(e,t){e.Qa.delete(t.path.canonicalString());const n=e.$a.get(t);null!==n&&(Uu(e.remoteStore,n),e.$a=e.$a.remove(t),e.Ua.delete(n),Zd(e))}function Xd(e,t,n){for(const r of n)r instanceof Nd?(e.Ka.addReference(r.key,t),Jd(e,r)):r instanceof Ad?(Ct(Pd,"Document no longer in limbo: "+r.key),e.Ka.removeReference(r.key,t),e.Ka.containsKey(r.key)||Yd(e,r.key)):Pt()}function Jd(e,t){const n=t.key,r=n.path.canonicalString();e.$a.get(n)||e.Qa.has(r)||(Ct(Pd,"New document in limbo: "+n),e.Qa.add(r),Zd(e))}function Zd(e){for(;e.Qa.size>0&&e.$a.size<e.maxConcurrentLimboResolutions;){const t=e.Qa.values().next().value;e.Qa.delete(t);const n=new dn(ln.fromString(t)),r=e.za.next();e.Ua.set(r,new Od(n)),e.$a=e.$a.insert(n,r),Vu(e.remoteStore,new Xa(Ho(Uo(n.path)),r,"TargetPurposeLimboResolution",Vn.ae))}}async function eh(e,t,n){const r=Ot(e),i=[],o=[],s=[];r.ka.isEmpty()||(r.ka.forEach(((e,a)=>{s.push(r.Ha(a,t,n).then((e=>{var t;if((e||n)&&r.isPrimaryClient){const i=e?!e.fromCache:null===(t=null==n?void 0:n.targetChanges.get(a.targetId))||void 0===t?void 0:t.current;r.sharedClientState.updateQueryState(a.targetId,i?"current":"not-current")}if(e){i.push(e);const t=Jc.Yi(a.targetId,e);o.push(t)}})))})),await Promise.all(s),r.La.p_(i),await async function(e,t){const n=Ot(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>_n.forEach(t,(t=>_n.forEach(t.Hi,(r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r))).next((()=>_n.forEach(t.Ji,(r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))))))}catch(e){if(!Pn(e))throw e;Ct(tu,"Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.Ts.get(e),r=t.snapshotVersion,i=t.withLastLimboFreeSnapshotVersion(r);n.Ts=n.Ts.insert(e,i)}}}(r.localStore,o))}async function th(e,t){const n=Ot(e);if(!n.currentUser.isEqual(t)){Ct(Pd,"User change. New user:",t.toKey());const e=await iu(n.localStore,t);n.currentUser=t,function(e,t){e.Ga.forEach((e=>{e.forEach((e=>{e.reject(new Mt(Lt.CANCELLED,t))}))})),e.Ga.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await eh(n,e.Rs)}}function nh(e,t){const n=Ot(e),r=n.Ua.get(t);if(r&&r.Ba)return fs().add(r.key);{let e=fs();const r=n.qa.get(t);if(!r)return e;for(const t of r){const r=n.ka.get(t);e=e.unionWith(r.view.Sa)}return e}}function rh(e){const t=Ot(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=$d.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=nh.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=qd.bind(null,t),t.La.p_=Sd.bind(null,t.eventManager),t.La.Ja=Ed.bind(null,t.eventManager),t}function ih(e){const t=Ot(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Hd.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Kd.bind(null,t),t}class oh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=ku(e.databaseInfo.databaseId),this.sharedClientState=this.Za(e),this.persistence=this.Xa(e),await this.persistence.start(),this.localStore=this.eu(e),this.gcScheduler=this.tu(e,this.localStore),this.indexBackfillerScheduler=this.nu(e,this.localStore)}tu(e,t){return null}nu(e,t){return null}eu(e){return ru(this.persistence,new eu,e.initialUser,this.serializer)}Xa(e){return new jc(Fc.ri,this.serializer)}Za(e){return new fu}async terminate(){var e,t;null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(t=this.indexBackfillerScheduler)||void 0===t||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}oh.provider={build:()=>new oh};class sh extends oh{constructor(e){super(),this.cacheSizeBytes=e}tu(e,t){Rt(this.persistence.referenceDelegate instanceof Vc);const n=this.persistence.referenceDelegate.garbageCollector;return new hc(n,e.asyncQueue,t)}Xa(e){const t=void 0!==this.cacheSizeBytes?Ql.withCacheSize(this.cacheSizeBytes):Ql.DEFAULT;return new jc((e=>Vc.ri(e,t)),this.serializer)}}class ah extends oh{constructor(e,t,n){super(),this.ru=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.ru.initialize(this,e),await ih(this.ru.syncEngine),await ed(this.ru.remoteStore),await this.persistence.Ci((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}eu(e){return ru(this.persistence,new eu,e.initialUser,this.serializer)}tu(e,t){const n=this.persistence.referenceDelegate.garbageCollector;return new hc(n,e.asyncQueue,t)}nu(e,t){const n=new Fn(t,this.persistence);return new zn(e.asyncQueue,n)}Xa(e){const t=Xc(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?Ql.withCacheSize(this.cacheSizeBytes):Ql.DEFAULT;return new Gc(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,_u(),Tu(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Za(e){return new fu}}class lh{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>Bd(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=th.bind(null,this.syncEngine),await ud(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new bd}createDatastore(e){const t=ku(e.databaseInfo.databaseId),n=function(e){return new Eu(e)}(e.databaseInfo);return function(e,t,n,r){return new Ou(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,i){return new ju(e,t,n,r,i)}(this.localStore,this.datastore,e.asyncQueue,(e=>Bd(this.syncEngine,e,0)),mu.D()?new mu:new pu)}createSyncEngine(e,t){return function(e,t,n,r,i,o,s){const a=new Ld(e,t,n,r,i,o);return s&&(a.ja=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=Ot(e);Ct(Mu,"RemoteStore shutting down."),t.W_.add(5),await Fu(t),t.z_.shutdown(),t.j_.set("Unknown")}(this.remoteStore),null===(e=this.datastore)||void 0===e||e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}lh.provider={build:()=>new lh};class ch{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.iu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.iu(this.observer.error,e):Nt("Uncaught Error in snapshot listener:",e.toString()))}su(){this.muted=!0}iu(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const uh="FirestoreClient";class dh{constructor(e,t,n,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=Et.UNAUTHENTICATED,this.clientId=Gt.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,(async e=>{Ct(uh,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(Ct(uh,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new jt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=pd(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function hh(e,t){e.asyncQueue.verifyOperationInProgress(),Ct(uh,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener((async e=>{r.isEqual(e)||(await iu(t.localStore,e),r=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function fh(e,t){e.asyncQueue.verifyOperationInProgress();const n=await ph(e);Ct(uh,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener((e=>cd(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>cd(t.remoteStore,n))),e._onlineComponents=t}async function ph(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){Ct(uh,"Using user provided OfflineComponentProvider");try{await hh(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(e){return"FirebaseError"===e.name?e.code===Lt.FAILED_PRECONDITION||e.code===Lt.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;At("Error using user provided cache. Falling back to memory cache: "+n),await hh(e,new oh)}}else Ct(uh,"Using default OfflineComponentProvider"),await hh(e,new sh(void 0));return e._offlineComponents}async function gh(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(Ct(uh,"Using user provided OnlineComponentProvider"),await fh(e,e._uninitializedComponentsProvider._online)):(Ct(uh,"Using default OnlineComponentProvider"),await fh(e,new lh))),e._onlineComponents}function mh(e){return gh(e).then((e=>e.syncEngine))}async function yh(e){const t=await gh(e),n=t.eventManager;return n.onListen=Md.bind(null,t.syncEngine),n.onUnlisten=Vd.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=jd.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=Ud.bind(null,t.syncEngine),n}function vh(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new jt;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const o=new ch({next:n=>{o.su(),t.enqueueAndForget((()=>Id(e,s))),n.fromCache&&"server"===r.source?i.reject(new Mt(Lt.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),s=new Cd(n,o,{includeMetadataChanges:!0,Ta:!0});return xd(e,s)}(await yh(e),e.asyncQueue,t,n,r))),r.promise}function bh(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const wh=new Map;function xh(e,t,n){if(!n)throw new Mt(Lt.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function Ih(e){if(!dn.isDocumentKey(e))throw new Mt(Lt.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function Sh(e){if(dn.isDocumentKey(e))throw new Mt(Lt.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function Eh(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":Pt()}function _h(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Mt(Lt.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Eh(e);throw new Mt(Lt.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function Th(e,t){if(t<=0)throw new Mt(Lt.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}const kh="firestore.googleapis.com",Ch=!0;class Nh{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new Mt(Lt.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=kh,this.ssl=Ch}else this.host=e.host,this.ssl=null!==(t=e.ssl)&&void 0!==t?t:Ch;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=Gl;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<cc)throw new Mt(Lt.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new Mt(Lt.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=bh(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new Mt(Lt.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new Mt(Lt.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new Mt(Lt.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ah{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Nh({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Mt(Lt.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Mt(Lt.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Nh(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new Ft;switch(e.type){case"firstParty":return new Bt(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Mt(Lt.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=wh.get(e);t&&(Ct("ComponentProvider","Removing Datastore"),wh.delete(e),t.terminate())}(this),Promise.resolve()}}function Dh(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var i;const o=(e=_h(e,Ah))._getSettings(),s=Object.assign(Object.assign({},o),{emulatorOptions:e._getEmulatorOptions()}),a=`${t}:${n}`;o.host!==kh&&o.host!==a&&At("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c=Object.assign(Object.assign({},o),{host:a,ssl:!1,emulatorOptions:r});if(!E(c,s)&&(e._setSettings(c),r.mockUserToken)){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=Et.MOCK_USER;else{t=function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[l(JSON.stringify({alg:"none",type:"JWT"})),l(JSON.stringify(o)),""].join(".")}(r.mockUserToken,null===(i=e._app)||void 0===i?void 0:i.options.projectId);const o=r.mockUserToken.sub||r.mockUserToken.user_id;if(!o)throw new Mt(Lt.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new Et(o)}e._authCredentials=new Vt(new zt(t,n))}}class Ph{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Ph(this.firestore,e,this._query)}}class Rh{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Oh(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Rh(this.firestore,e,this._key)}}class Oh extends Ph{constructor(e,t,n){super(e,t,Uo(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Rh(this.firestore,null,new dn(e))}withConverter(e){return new Oh(this.firestore,e,this._path)}}function Lh(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=P(e),xh("collection","path",t),e instanceof Ah){const n=ln.fromString(t,...r);return Sh(n),new Oh(e,null,n)}{if(!(e instanceof Rh||e instanceof Oh))throw new Mt(Lt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(ln.fromString(t,...r));return Sh(n),new Oh(e.firestore,null,n)}}function Mh(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=P(e),1===arguments.length&&(t=Gt.newId()),xh("doc","path",t),e instanceof Ah){const n=ln.fromString(t,...r);return Ih(n),new Rh(e,null,new dn(n))}{if(!(e instanceof Rh||e instanceof Oh))throw new Mt(Lt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(ln.fromString(t,...r));return Ih(n),new Rh(e.firestore,e instanceof Oh?e.converter:null,new dn(n))}}const jh="AsyncQueue";class zh{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Vu=[],this.mu=!1,this.fu=[],this.gu=null,this.pu=!1,this.yu=!1,this.wu=[],this.a_=new Cu(this,"async_queue_retry"),this.Su=()=>{const e=Tu();e&&Ct(jh,"Visibility state changed to "+e.visibilityState),this.a_.t_()},this.bu=e;const t=Tu();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Su)}get isShuttingDown(){return this.mu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Du(),this.vu(e)}enterRestrictedMode(e){if(!this.mu){this.mu=!0,this.yu=e||!1;const t=Tu();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Su)}}enqueue(e){if(this.Du(),this.mu)return new Promise((()=>{}));const t=new jt;return this.vu((()=>this.mu&&this.yu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Vu.push(e),this.Cu())))}async Cu(){if(0!==this.Vu.length){try{await this.Vu[0](),this.Vu.shift(),this.a_.reset()}catch(e){if(!Pn(e))throw e;Ct(jh,"Operation failed with retryable error: "+e)}this.Vu.length>0&&this.a_.Xo((()=>this.Cu()))}}vu(e){const t=this.bu.then((()=>(this.pu=!0,e().catch((e=>{this.gu=e,this.pu=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw Nt("INTERNAL UNHANDLED ERROR: ",t),e})).then((e=>(this.pu=!1,e))))));return this.bu=t,t}enqueueAfterDelay(e,t,n){this.Du(),this.wu.indexOf(e)>-1&&(t=0);const r=fd.createAndSchedule(this,e,t,n,(e=>this.Fu(e)));return this.fu.push(r),r}Du(){this.gu&&Pt()}verifyOperationInProgress(){}async Mu(){let e;do{e=this.bu,await e}while(e!==this.bu)}xu(e){for(const t of this.fu)if(t.timerId===e)return!0;return!1}Ou(e){return this.Mu().then((()=>{this.fu.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.fu)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Mu()}))}Nu(e){this.wu.push(e)}Fu(e){const t=this.fu.indexOf(e);this.fu.splice(t,1)}}function Fh(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const r of t)if(r in n&&"function"==typeof n[r])return!0;return!1}(e,["next","error","complete"])}class Vh extends Ah{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new zh,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new zh(e),this._firestoreClient=void 0,await e}}}function Uh(e){if(e._terminated)throw new Mt(Lt.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||$h(e),e._firestoreClient}function $h(e){var t,n,r;const i=e._freezeSettings(),o=function(e,t,n,r){return new _i(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,bh(r.experimentalLongPollingOptions),r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,i);e._componentsProvider||(null===(n=i.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=i.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),e._firestoreClient=new dh(e._authCredentials,e._appCheckCredentials,e._queue,o,e._componentsProvider&&function(e){const t=null==e?void 0:e._online.build();return{_offline:null==e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}function Bh(e,t,n){if((e=_h(e,Vh))._firestoreClient||e._terminated)throw new Mt(Lt.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(e._componentsProvider||e._getSettings().localCache)throw new Mt(Lt.FAILED_PRECONDITION,"SDK cache is already specified.");e._componentsProvider={_online:t,_offline:n},$h(e)}class qh{constructor(e){this._byteString=e}static fromBase64String(e){try{return new qh(fi.fromBase64String(e))}catch(e){throw new Mt(Lt.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new qh(fi.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Hh{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;++r)if(0===t[r].length)throw new Mt(Lt.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new un(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Kh{constructor(e){this._methodName=e}}class Wh{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Mt(Lt.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Mt(Lt.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Qt(this._lat,e._lat)||Qt(this._long,e._long)}}class Gh{constructor(e){this._values=(e||[]).map((e=>e))}toArray(){return this._values.map((e=>e))}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}}const Qh=/^__.*__$/;class Yh{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new $s(e,this.data,this.fieldMask,t,this.fieldTransforms):new Us(e,this.data,t,this.fieldTransforms)}}class Xh{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new $s(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Jh(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Pt()}}class Zh{constructor(e,t,n,r,i,o){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Bu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Lu(){return this.settings.Lu}ku(e){return new Zh(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}qu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ku({path:n,Qu:!1});return r.$u(e),r}Uu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ku({path:n,Qu:!1});return r.Bu(),r}Ku(e){return this.ku({path:void 0,Qu:!0})}Wu(e){return mf(e,this.settings.methodName,this.settings.Gu||!1,this.path,this.settings.zu)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}Bu(){if(this.path)for(let e=0;e<this.path.length;e++)this.$u(this.path.get(e))}$u(e){if(0===e.length)throw this.Wu("Document fields must not be empty");if(Jh(this.Lu)&&Qh.test(e))throw this.Wu('Document fields cannot begin and end with "__"')}}class ef{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||ku(e)}ju(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new Zh({Lu:e,methodName:t,zu:n,path:un.emptyPath(),Qu:!1,Gu:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function tf(e){const t=e._freezeSettings(),n=ku(e._databaseId);return new ef(e._databaseId,!!t.ignoreUndefinedProperties,n)}function nf(e,t,n,r,i){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const s=e.ju(o.merge||o.mergeFields?2:0,t,n,i);hf("Data must be an object, but it was:",s,r);const a=uf(r,s);let l,c;if(o.merge)l=new di(s.fieldMask),c=s.fieldTransforms;else if(o.mergeFields){const e=[];for(const r of o.mergeFields){const i=ff(t,r,n);if(!s.contains(i))throw new Mt(Lt.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);yf(e,i)||e.push(i)}l=new di(e),c=s.fieldTransforms.filter((e=>l.covers(e.field)))}else l=null,c=s.fieldTransforms;return new Yh(new ro(a),l,c)}class rf extends Kh{_toFieldTransform(e){if(2!==e.Lu)throw 1===e.Lu?e.Wu(`${this._methodName}() can only appear at the top level of your update data`):e.Wu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof rf}}class of extends Kh{_toFieldTransform(e){return new Ds(e.path,new Ss)}isEqual(e){return e instanceof of}}function sf(e,t,n,r){const i=e.ju(1,t,n);hf("Data must be an object, but it was:",i,r);const o=[],s=ro.empty();ri(r,((e,r)=>{const a=gf(t,e,n);r=P(r);const l=i.Uu(a);if(r instanceof rf)o.push(a);else{const e=cf(r,l);null!=e&&(o.push(a),s.set(a,e))}}));const a=new di(o);return new Xh(s,a,i.fieldTransforms)}function af(e,t,n,r,i,o){const s=e.ju(1,t,n),a=[ff(t,r,n)],l=[i];if(o.length%2!=0)throw new Mt(Lt.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<o.length;h+=2)a.push(ff(t,o[h])),l.push(o[h+1]);const c=[],u=ro.empty();for(let h=a.length-1;h>=0;--h)if(!yf(c,a[h])){const e=a[h];let t=l[h];t=P(t);const n=s.Uu(e);if(t instanceof rf)c.push(e);else{const r=cf(t,n);null!=r&&(c.push(e),u.set(e,r))}}const d=new di(c);return new Xh(u,d,s.fieldTransforms)}function lf(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return cf(n,e.ju(r?4:3,t))}function cf(e,t){if(df(e=P(e)))return hf("Unsupported field value:",t,e),uf(e,t);if(e instanceof Kh)return function(e,t){if(!Jh(t.Lu))throw t.Wu(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.Wu(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.Qu&&4!==t.Lu)throw t.Wu("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=cf(i,t.Ku(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=P(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return vs(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=rn.fromDate(e);return{timestampValue:Ia(t.serializer,n)}}if(e instanceof rn){const n=new rn(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Ia(t.serializer,n)}}if(e instanceof Wh)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof qh)return{bytesValue:Sa(t.serializer,e._byteString)};if(e instanceof Rh){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Wu(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Ta(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof Gh)return function(e,t){return{mapValue:{fields:{[Ci]:{stringValue:Di},[Pi]:{arrayValue:{values:e.toArray().map((e=>{if("number"!=typeof e)throw t.Wu("VectorValues must only contain numeric values.");return ms(t.serializer,e)}))}}}}}}(e,t);throw t.Wu(`Unsupported field value: ${Eh(e)}`)}(e,t)}function uf(e,t){const n={};return ii(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):ri(e,((e,r)=>{const i=cf(r,t.qu(e));null!=i&&(n[e]=i)})),{mapValue:{fields:n}}}function df(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof rn||e instanceof Wh||e instanceof qh||e instanceof Rh||e instanceof Kh||e instanceof Gh)}function hf(e,t,n){if(!df(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const r=Eh(n);throw"an object"===r?t.Wu(e+" a custom object"):t.Wu(e+" "+r)}}function ff(e,t,n){if((t=P(t))instanceof Hh)return t._internalPath;if("string"==typeof t)return gf(e,t);throw mf("Field path arguments must be of type string or ",e,!1,void 0,n)}const pf=new RegExp("[~\\*/\\[\\]]");function gf(e,t,n){if(t.search(pf)>=0)throw mf(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new Hh(...t.split("."))._internalPath}catch(r){throw mf(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function mf(e,t,n,r,i){const o=r&&!r.isEmpty(),s=void 0!==i;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(o||s)&&(l+=" (found",o&&(l+=` in field ${r}`),s&&(l+=` in document ${i}`),l+=")"),new Mt(Lt.INVALID_ARGUMENT,a+e+l)}function yf(e,t){return e.some((e=>e.isEqual(t)))}class vf{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Rh(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new bf(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(wf("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class bf extends vf{data(){return super.data()}}function wf(e,t){return"string"==typeof t?gf(e,t):t instanceof Hh?t._internalPath:t._delegate._internalPath}function xf(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Mt(Lt.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class If{}class Sf extends If{}function Ef(e,t){let n=[];for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];t instanceof If&&n.push(t),n=n.concat(i),function(e){const t=e.filter((e=>e instanceof kf)).length,n=e.filter((e=>e instanceof _f)).length;if(t>1||t>0&&n>0)throw new Mt(Lt.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const s of n)e=s._apply(e);return e}class _f extends Sf{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new _f(e,t,n)}_apply(e){const t=this._parse(e);return Pf(e._query,t),new Ph(e.firestore,e.converter,Wo(e._query,t))}_parse(e){const t=tf(e.firestore),n=function(e,t,n,r,i,o,s){let a;if(i.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new Mt(Lt.INVALID_ARGUMENT,`Invalid Query. You can't perform '${o}' queries on documentId().`);if("in"===o||"not-in"===o){Df(s,o);const t=[];for(const n of s)t.push(Af(r,e,n));a={arrayValue:{values:t}}}else a=Af(r,e,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||Df(s,o),a=lf(n,t,s,"in"===o||"not-in"===o);return fo.create(i,o,a)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}function Tf(e,t,n){const r=t,i=wf("where",e);return _f._create(i,r,n)}class kf extends If{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new kf(e,t)}_parse(e){const t=this._queryConstraints.map((t=>t._parse(e))).filter((e=>e.getFilters().length>0));return 1===t.length?t[0]:po.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const i of r)Pf(n,i),n=Wo(n,i)}(e._query,t),new Ph(e.firestore,e.converter,Wo(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class Cf extends Sf{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new Cf(e,t,n)}_apply(e){return new Ph(e.firestore,e.converter,Go(e._query,this._limit,this._limitType))}}function Nf(e){return Th("limit",e),Cf._create("limit",e,"F")}function Af(e,t,n){if("string"==typeof(n=P(n))){if(""===n)throw new Mt(Lt.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Bo(t)&&-1!==n.indexOf("/"))throw new Mt(Lt.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(ln.fromString(n));if(!dn.isDocumentKey(r))throw new Mt(Lt.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Bi(e,new dn(r))}if(n instanceof Rh)return Bi(e,n._key);throw new Mt(Lt.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Eh(n)}.`)}function Df(e,t){if(!Array.isArray(e)||0===e.length)throw new Mt(Lt.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function Pf(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new Mt(Lt.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new Mt(Lt.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}class Rf{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(Oi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return mi(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(yi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Pt()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return ri(e,((e,r)=>{n[e]=this.convertValue(r,t)})),n}convertVectorValue(e){var t,n,r;const i=null===(r=null===(n=null===(t=e.fields)||void 0===t?void 0:t[Pi].arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.map((e=>mi(e.doubleValue)));return new Gh(i)}convertGeoPoint(e){return new Wh(mi(e.latitude),mi(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Si(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Ei(e));default:return null}}convertTimestamp(e){const t=gi(e);return new rn(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=ln.fromString(e);Rt(Ya(n));const r=new ki(n.get(1),n.get(3)),i=new dn(n.popFirst(5));return r.isEqual(t)||Nt(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function Of(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class Lf{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Mf extends vf{constructor(e,t,n,r,i,o){super(e,t,n,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new jf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(wf("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class jf extends Mf{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class zf{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Lf(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new jf(this._firestore,this._userDataWriter,n.key,n,new Lf(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Mt(Lt.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>{const r=new jf(e._firestore,e._userDataWriter,n.doc.key,n.doc,new Lf(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const r=new jf(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Lf(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,o=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),o=n.indexOf(t.doc.key)),{type:Ff(t.type),doc:r,oldIndex:i,newIndex:o}}))}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function Ff(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Pt()}}class Vf extends Rf{constructor(e){super(),this.firestore=e}convertBytes(e){return new qh(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Rh(this.firestore,null,t)}}function Uf(e){e=_h(e,Ph);const t=_h(e.firestore,Vh),n=Uh(t),r=new Vf(t);return xf(e._query),vh(n,e._query).then((n=>new zf(t,r,e,n)))}function $f(e,t,n){e=_h(e,Rh);const r=_h(e.firestore,Vh),i=Of(e.converter,t,n);return Kf(r,[nf(tf(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,Rs.none())])}function Bf(e,t,n){e=_h(e,Rh);const r=_h(e.firestore,Vh),i=tf(r);let o;for(var s=arguments.length,a=new Array(s>3?s-3:0),l=3;l<s;l++)a[l-3]=arguments[l];return o="string"==typeof(t=P(t))||t instanceof Hh?af(i,"updateDoc",e._key,t,n,a):sf(i,"updateDoc",e._key,t),Kf(r,[o.toMutation(e._key,Rs.exists(!0))])}function qf(e){return Kf(_h(e.firestore,Vh),[new Ks(e._key,Rs.none())])}function Hf(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i,o,s;e=P(e);let a={includeMetadataChanges:!1,source:"default"},l=0;"object"!=typeof n[l]||Fh(n[l])||(a=n[l],l++);const c={includeMetadataChanges:a.includeMetadataChanges,source:a.source};if(Fh(n[l])){const e=n[l];n[l]=null===(i=e.next)||void 0===i?void 0:i.bind(e),n[l+1]=null===(o=e.error)||void 0===o?void 0:o.bind(e),n[l+2]=null===(s=e.complete)||void 0===s?void 0:s.bind(e)}let u,d,h;if(e instanceof Rh)d=_h(e.firestore,Vh),h=Uo(e._key.path),u={next:t=>{n[l]&&n[l](Wf(d,e,t))},error:n[l+1],complete:n[l+2]};else{const t=_h(e,Ph);d=_h(t.firestore,Vh),h=t._query;const r=new Vf(d);u={next:e=>{n[l]&&n[l](new zf(d,r,t,e))},error:n[l+1],complete:n[l+2]},xf(e._query)}return function(e,t,n,r){const i=new ch(r),o=new Cd(t,i,n);return e.asyncQueue.enqueueAndForget((async()=>xd(await yh(e),o))),()=>{i.su(),e.asyncQueue.enqueueAndForget((async()=>Id(await yh(e),o)))}}(Uh(d),h,c,u)}function Kf(e,t){return function(e,t){const n=new jt;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){const r=ih(e);try{const e=await function(e,t){const n=Ot(e),r=rn.now(),i=t.reduce(((e,t)=>e.add(t.key)),fs());let o,s;return n.persistence.runTransaction("Locally write mutations","readwrite",(e=>{let a=is(),l=fs();return n.ds.getEntries(e,i).next((e=>{a=e,a.forEach(((e,t)=>{t.isValidDocument()||(l=l.add(e))}))})).next((()=>n.localDocuments.getOverlayedDocuments(e,a))).next((i=>{o=i;const s=[];for(const e of t){const t=Fs(e,o.get(e.key).overlayedDocument);null!=t&&s.push(new $s(e.key,t,io(t.value.mapValue),Rs.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,s,t)})).next((t=>{s=t;const r=t.applyToLocalDocumentSet(o,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)}))})).then((()=>({batchId:s.batchId,changes:as(o)})))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Wa[e.currentUser.toKey()];r||(r=new oi(Qt)),r=r.insert(t,n),e.Wa[e.currentUser.toKey()]=r}(r,e.batchId,n),await eh(r,e.changes),await ed(r.remoteStore)}catch(e){const t=pd(e,"Failed to persist write");n.reject(t)}}(await mh(e),t,n))),n.promise}(Uh(e),t)}function Wf(e,t,n){const r=n.docs.get(t._key),i=new Vf(e);return new Mf(e,i,t._key,r,new Lf(n.hasPendingWrites,n.fromCache),t.converter)}class Gf{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=tf(e)}set(e,t,n){this._verifyNotCommitted();const r=Qf(e,this._firestore),i=Of(r.converter,t,n),o=nf(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(o.toMutation(r._key,Rs.none())),this}update(e,t,n){this._verifyNotCommitted();const r=Qf(e,this._firestore);let i;for(var o=arguments.length,s=new Array(o>3?o-3:0),a=3;a<o;a++)s[a-3]=arguments[a];return i="string"==typeof(t=P(t))||t instanceof Hh?af(this._dataReader,"WriteBatch.update",r._key,t,n,s):sf(this._dataReader,"WriteBatch.update",r._key,t),this._mutations.push(i.toMutation(r._key,Rs.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Qf(e,this._firestore);return this._mutations=this._mutations.concat(new Ks(t._key,Rs.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Mt(Lt.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Qf(e,t){if((e=P(e)).firestore!==t)throw new Mt(Lt.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}function Yf(){return new of("serverTimestamp")}function Xf(e){return Uh(e=_h(e,Vh)),new Gf(e,(t=>Kf(e,t)))}new WeakMap;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){_t=e}(Ge),Be(new R("firestore",((e,n)=>{let{instanceIdentifier:r,options:i}=n;const o=e.getProvider("app").getImmediate(),s=new Vh(new Ut(e.getProvider("auth-internal")),new Ht(o,e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Mt(Lt.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ki(e.options.projectId,t)}(o,r),o);return i=Object.assign({useFetchStreams:t},i),s._setSettings(i),s}),"PUBLIC").setMultipleInstances(!0)),Xe(It,St,e),Xe(It,St,"esm2017")}();Xe("firebase","11.6.0","app");const Jf="@firebase/installations",Zf="0.6.13",ep=1e4,tp=`w:${Zf}`,np="FIS_v2",rp=36e5,ip=new I("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function op(e){return e instanceof x&&e.code.includes("request-failed")}function sp(e){let{projectId:t}=e;return`https://firebaseinstallations.googleapis.com/v1/projects/${t}/installations`}function ap(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function lp(e,t){const n=(await t.json()).error;return ip.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function cp(e){let{apiKey:t}=e;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function up(e,t){let{refreshToken:n}=t;const r=cp(e);return r.append("Authorization",function(e){return`${np} ${e}`}(n)),r}async function dp(e){const t=await e();return t.status>=500&&t.status<600?e():t}function hp(e){return new Promise((t=>{setTimeout(t,e)}))}const fp=/^[cdef][\w-]{21}$/;function pp(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){const t=(n=e,btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_"));var n;return t.substr(0,22)}(e);return fp.test(t)?t:""}catch(e){return""}}function gp(e){return`${e.appName}!${e.appId}`}const mp=new Map;function yp(e,t){const n=gp(e);vp(n,t),function(e,t){const n=wp();n&&n.postMessage({key:e,fid:t});xp()}(n,t)}function vp(e,t){const n=mp.get(e);if(n)for(const r of n)r(t)}let bp=null;function wp(){return!bp&&"BroadcastChannel"in self&&(bp=new BroadcastChannel("[Firebase] FID Change"),bp.onmessage=e=>{vp(e.data.key,e.data.fid)}),bp}function xp(){0===mp.size&&bp&&(bp.close(),bp=null)}const Ip="firebase-installations-store";let Sp=null;function Ep(){return Sp||(Sp=ne("firebase-installations-database",1,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(Ip)}})),Sp}async function _p(e,t){const n=gp(e),r=(await Ep()).transaction(Ip,"readwrite"),i=r.objectStore(Ip),o=await i.get(n);return await i.put(t,n),await r.done,o&&o.fid===t.fid||yp(e,t.fid),t}async function Tp(e){const t=gp(e),n=(await Ep()).transaction(Ip,"readwrite");await n.objectStore(Ip).delete(t),await n.done}async function kp(e,t){const n=gp(e),r=(await Ep()).transaction(Ip,"readwrite"),i=r.objectStore(Ip),o=await i.get(n),s=t(o);return void 0===s?await i.delete(n):await i.put(s,n),await r.done,!s||o&&o.fid===s.fid||yp(e,s.fid),s}async function Cp(e){let t;const n=await kp(e.appConfig,(n=>{const r=function(e){const t=e||{fid:pp(),registrationStatus:0};return Dp(t)}(n),i=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine){return{installationEntry:t,registrationPromise:Promise.reject(ip.create("app-offline"))}}const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=async function(e,t){try{const n=await async function(e,t){let{appConfig:n,heartbeatServiceProvider:r}=e,{fid:i}=t;const o=sp(n),s=cp(n),a=r.getImmediate({optional:!0});if(a){const e=await a.getHeartbeatsHeader();e&&s.append("x-firebase-client",e)}const l={fid:i,authVersion:np,appId:n.appId,sdkVersion:tp},c={method:"POST",headers:s,body:JSON.stringify(l)},u=await dp((()=>fetch(o,c)));if(u.ok){const e=await u.json();return{fid:e.fid||i,registrationStatus:2,refreshToken:e.refreshToken,authToken:ap(e.authToken)}}throw await lp("Create Installation",u)}(e,t);return _p(e.appConfig,n)}catch(n){throw op(n)&&409===n.customData.serverCode?await Tp(e.appConfig):await _p(e.appConfig,{fid:t.fid,registrationStatus:0}),n}}(e,n);return{installationEntry:n,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:Np(e)}:{installationEntry:t}}(e,r);return t=i.registrationPromise,i.installationEntry}));return""===n.fid?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}async function Np(e){let t=await Ap(e.appConfig);for(;1===t.registrationStatus;)await hp(100),t=await Ap(e.appConfig);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:n}=await Cp(e);return n||t}return t}function Ap(e){return kp(e,(e=>{if(!e)throw ip.create("installation-not-found");return Dp(e)}))}function Dp(e){return 1===(t=e).registrationStatus&&t.registrationTime+ep<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}async function Pp(e,t){let{appConfig:n,heartbeatServiceProvider:r}=e;const i=function(e,t){let{fid:n}=t;return`${sp(e)}/${n}/authTokens:generate`}(n,t),o=up(n,t),s=r.getImmediate({optional:!0});if(s){const e=await s.getHeartbeatsHeader();e&&o.append("x-firebase-client",e)}const a={installation:{sdkVersion:tp,appId:n.appId}},l={method:"POST",headers:o,body:JSON.stringify(a)},c=await dp((()=>fetch(i,l)));if(c.ok){return ap(await c.json())}throw await lp("Generate Auth Token",c)}async function Rp(e){let t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=await kp(e.appConfig,(r=>{if(!Lp(r))throw ip.create("not-registered");const i=r.authToken;if(!n&&function(e){return 2===e.requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+rp}(e)}(i))return r;if(1===i.requestStatus)return t=async function(e,t){let n=await Op(e.appConfig);for(;1===n.authToken.requestStatus;)await hp(100),n=await Op(e.appConfig);const r=n.authToken;return 0===r.requestStatus?Rp(e,t):r}(e,n),r;{if(!navigator.onLine)throw ip.create("app-offline");const n=function(e){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}(r);return t=async function(e,t){try{const n=await Pp(e,t),r=Object.assign(Object.assign({},t),{authToken:n});return await _p(e.appConfig,r),n}catch(n){if(!op(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await _p(e.appConfig,n)}else await Tp(e.appConfig);throw n}}(e,n),n}}));return t?await t:r.authToken}function Op(e){return kp(e,(e=>{if(!Lp(e))throw ip.create("not-registered");const t=e.authToken;return 1===(n=t).requestStatus&&n.requestTime+ep<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e;var n}))}function Lp(e){return void 0!==e&&2===e.registrationStatus}async function Mp(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e;await async function(e){const{registrationPromise:t}=await Cp(e);t&&await t}(n);return(await Rp(n,t)).token}function jp(e){return ip.create("missing-app-config-values",{valueName:e})}const zp="installations",Fp=e=>{const t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw jp("App Configuration");if(!e.name)throw jp("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw jp(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:qe(t,"heartbeat"),_delete:()=>Promise.resolve()}},Vp=e=>{const t=qe(e.getProvider("app").getImmediate(),zp).getImmediate();return{getId:()=>async function(e){const t=e,{installationEntry:n,registrationPromise:r}=await Cp(t);return r?r.catch(console.error):Rp(t).catch(console.error),n.fid}(t),getToken:e=>Mp(t,e)}};Be(new R(zp,Fp,"PUBLIC")),Be(new R("installations-internal",Vp,"PRIVATE")),Xe(Jf,Zf),Xe(Jf,Zf,"esm2017");const Up="analytics",$p="https://www.googletagmanager.com/gtag/js",Bp=new B("@firebase/analytics"),qp=new I("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function Hp(e){if(!e.startsWith($p)){const t=qp.create("invalid-gtag-resource",{gtagURL:e});return Bp.warn(t.message),""}return e}function Kp(e){return Promise.all(e.map((e=>e.catch((e=>e)))))}function Wp(e,t){const n=function(e,t){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(e,t)),n}("firebase-js-sdk-policy",{createScriptURL:Hp}),r=document.createElement("script"),i=`${$p}?l=${e}&id=${t}`;r.src=n?null===n||void 0===n?void 0:n.createScriptURL(i):i,r.async=!0,document.head.appendChild(r)}function Gp(e,t,n,r){return async function(i){try{for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];if("event"===i){const[r,i]=s;await async function(e,t,n,r,i){try{let o=[];if(i&&i.send_to){let e=i.send_to;Array.isArray(e)||(e=[e]);const r=await Kp(n);for(const n of e){const e=r.find((e=>e.measurementId===n)),i=e&&t[e.appId];if(!i){o=[];break}o.push(i)}}0===o.length&&(o=Object.values(t)),await Promise.all(o),e("event",r,i||{})}catch(o){Bp.error(o)}}(e,t,n,r,i)}else if("config"===i){const[i,o]=s;await async function(e,t,n,r,i,o){const s=r[i];try{if(s)await t[s];else{const e=(await Kp(n)).find((e=>e.measurementId===i));e&&await t[e.appId]}}catch(a){Bp.error(a)}e("config",i,o)}(e,t,n,r,i,o)}else if("consent"===i){const[t,n]=s;e("consent",t,n)}else if("get"===i){const[t,n,r]=s;e("get",t,n,r)}else if("set"===i){const[t]=s;e("set",t)}else e(i,...s)}catch(l){Bp.error(l)}}}const Qp=new class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function Yp(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}async function Xp(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qp,n=arguments.length>2?arguments[2]:void 0;const{appId:r,apiKey:i,measurementId:o}=e.options;if(!r)throw qp.create("no-app-id");if(!i){if(o)return{measurementId:o,appId:r};throw qp.create("no-api-key")}const s=t.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new Zp;return setTimeout((async()=>{a.abort()}),void 0!==n?n:6e4),Jp({appId:r,apiKey:i,measurementId:o},s,a,t)}async function Jp(e,t,n){let{throttleEndTimeMillis:r,backoffCount:i}=t,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Qp;var s;const{appId:a,measurementId:l}=e;try{await function(e,t){return new Promise(((n,r)=>{const i=Math.max(t-Date.now(),0),o=setTimeout(n,i);e.addEventListener((()=>{clearTimeout(o),r(qp.create("fetch-throttle",{throttleEndTimeMillis:t}))}))}))}(n,r)}catch(c){if(l)return Bp.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${null===c||void 0===c?void 0:c.message}]`),{appId:a,measurementId:l};throw c}try{const t=await async function(e){var t;const{appId:n,apiKey:r}=e,i={method:"GET",headers:Yp(r)},o="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),s=await fetch(o,i);if(200!==s.status&&304!==s.status){let e="";try{const n=await s.json();(null===(t=n.error)||void 0===t?void 0:t.message)&&(e=n.error.message)}catch(a){}throw qp.create("config-fetch-failed",{httpStatus:s.status,responseMessage:e})}return s.json()}(e);return o.deleteThrottleMetadata(a),t}catch(c){const t=c;if(!function(e){if(!(e instanceof x)||!e.customData)return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(t)){if(o.deleteThrottleMetadata(a),l)return Bp.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${null===t||void 0===t?void 0:t.message}]`),{appId:a,measurementId:l};throw c}const r=503===Number(null===(s=null===t||void 0===t?void 0:t.customData)||void 0===s?void 0:s.httpStatus)?D(i,o.intervalMillis,30):D(i,o.intervalMillis),u={throttleEndTimeMillis:Date.now()+r,backoffCount:i+1};return o.setThrottleMetadata(a,u),Bp.debug(`Calling attemptFetch again in ${r} millis`),Jp(e,u,n,o)}}class Zp{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach((e=>e()))}}let eg,tg;function ng(e){tg=e}function rg(e){eg=e}async function ig(e,t,n,r,i,o,s){var a;const l=Xp(e);l.then((t=>{n[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&Bp.warn(`The measurement ID in the local Firebase config (${e.options.measurementId}) does not match the measurement ID fetched from the server (${t.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)})).catch((e=>Bp.error(e))),t.push(l);const c=async function(){if(!b())return Bp.warn(qp.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await w()}catch(e){return Bp.warn(qp.create("indexeddb-unavailable",{errorInfo:null===e||void 0===e?void 0:e.toString()}).message),!1}return!0}().then((e=>e?r.getId():void 0)),[u,d]=await Promise.all([l,c]);(function(e){const t=window.document.getElementsByTagName("script");for(const n of Object.values(t))if(n.src&&n.src.includes($p)&&n.src.includes(e))return n;return null})(o)||Wp(o,u.measurementId),tg&&(i("consent","default",tg),ng(void 0)),i("js",new Date);const h=null!==(a=null===s||void 0===s?void 0:s.config)&&void 0!==a?a:{};return h.origin="firebase",h.update=!0,null!=d&&(h.firebase_id=d),i("config",u.measurementId,h),eg&&(i("set",eg),rg(void 0)),u.measurementId}class og{constructor(e){this.app=e}_delete(){return delete sg[this.app.options.appId],Promise.resolve()}}let sg={},ag=[];const lg={};let cg,ug,dg="dataLayer",hg="gtag",fg=!1;function pg(){const e=[];if(y()&&e.push("This is a browser extension environment."),"undefined"!==typeof navigator&&navigator.cookieEnabled||e.push("Cookies are not available."),e.length>0){const t=e.map(((e,t)=>`(${t+1}) ${e}`)).join(" "),n=qp.create("invalid-analytics-context",{errorInfo:t});Bp.warn(n.message)}}function gg(e,t,n){pg();const r=e.options.appId;if(!r)throw qp.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw qp.create("no-api-key");Bp.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=sg[r])throw qp.create("already-exists",{id:r});if(!fg){!function(e){let t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(dg);const{wrappedGtag:e,gtagCore:t}=function(e,t,n,r,i){let o=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];window[r].push(arguments)};return window[i]&&"function"===typeof window[i]&&(o=window[i]),window[i]=Gp(o,e,t,n),{gtagCore:o,wrappedGtag:window[i]}}(sg,ag,lg,dg,hg);ug=e,cg=t,fg=!0}sg[r]=ig(e,ag,lg,t,cg,dg,n);return new og(e)}function mg(e,t,n,r){e=P(e),async function(e,t,n,r,i){if(i&&i.global)e("event",n,r);else{const i=await t;e("event",n,Object.assign(Object.assign({},r),{send_to:i}))}}(ug,sg[e.app.options.appId],t,n,r).catch((e=>Bp.error(e)))}const yg="@firebase/analytics",vg="0.10.12";Be(new R(Up,((e,t)=>{let{options:n}=t;return gg(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),n)}),"PUBLIC")),Be(new R("analytics-internal",(function(e){try{const t=e.getProvider(Up).getImmediate();return{logEvent:(e,n,r)=>mg(t,e,n,r)}}catch(t){throw qp.create("interop-component-reg-failed",{reason:t})}}),"PRIVATE")),Xe(yg,vg),Xe(yg,vg,"esm2017");function bg(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;function wg(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const xg=wg,Ig=new I("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Sg=new B("@firebase/auth");function Eg(e){if(Sg.logLevel<=z.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Sg.error(`Auth (${Ge}): ${e}`,...n)}}function _g(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw Ng(e,...n)}function Tg(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Ng(e,...n)}function kg(e,t,n){const r=Object.assign(Object.assign({},xg()),{[t]:n});return new I("auth","Firebase",r).create(t,{appName:e.name})}function Cg(e){return kg(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Ng(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){const t=n[0],r=[...n.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(t,...r)}return Ig.create(e,...n)}function Ag(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];throw Ng(t,...r)}}function Dg(e){const t="INTERNAL ASSERTION FAILED: "+e;throw Eg(t),new Error(t)}function Pg(e,t){e||Dg(t)}function Rg(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function Og(){return"http:"===Lg()||"https:"===Lg()}function Lg(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class Mg{constructor(e,t){this.shortDelay=e,this.longDelay=t,Pg(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(m())||"object"===typeof navigator&&"ReactNative"===navigator.product}get(){return"undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(Og()||y()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function jg(e,t){Pg(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class zg{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void Dg("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void Dg("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void Dg("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Fg={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Vg=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Ug=new Mg(3e4,6e4);function $g(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function Bg(e,t,n,r){return qg(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},(async()=>{let i={},o={};r&&("GET"===t?o=r:i={body:JSON.stringify(r)});const s=T(Object.assign({key:e.config.apiKey},o)).slice(1),a=await e._getAdditionalHeaders();a["Content-Type"]="application/json",e.languageCode&&(a["X-Firebase-Locale"]=e.languageCode);const l=Object.assign({method:t,headers:a},i);return"undefined"!==typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||(l.referrerPolicy="no-referrer"),zg.fetch()(await Kg(e,e.config.apiHost,n,s),l)}))}async function qg(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},Fg),t);try{const t=new Gg(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Qg(e,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const t=i.ok?o.errorMessage:o.error.message,[n,s]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw Qg(e,"credential-already-in-use",o);if("EMAIL_EXISTS"===n)throw Qg(e,"email-already-in-use",o);if("USER_DISABLED"===n)throw Qg(e,"user-disabled",o);const a=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(s)throw kg(e,a,s);_g(e,a)}}catch(i){if(i instanceof x)throw i;_g(e,"network-request-failed",{message:String(i)})}}async function Hg(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const o=await Bg(e,t,n,r,i);return"mfaPendingCredential"in o&&_g(e,"multi-factor-auth-required",{_serverResponse:o}),o}async function Kg(e,t,n,r){const i=`${t}${n}?${r}`,o=e,s=o.config.emulator?jg(e.config,i):`${e.config.apiScheme}://${i}`;if(Vg.includes(n)&&(await o._persistenceManagerAvailable,"COOKIE"===o._getPersistenceType())){return o._getPersistence()._getFinalTarget(s).toString()}return s}function Wg(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Gg{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(Tg(this.auth,"network-request-failed"))),Ug.get())}))}}function Qg(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Tg(e,t,r);return i.customData._tokenResponse=n,i}function Yg(e){return void 0!==e&&void 0!==e.enterprise}class Xg{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Wg(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Jg(e,t){return Bg(e,"GET","/v2/recaptchaConfig",$g(e,t))}async function Zg(e,t){return Bg(e,"POST","/v1/accounts:lookup",t)}function em(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(t){}}function tm(e){return 1e3*Number(e)}function nm(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return Eg("JWT malformed, contained fewer than 3 sections"),null;try{const e=c(n);return e?JSON.parse(e):(Eg("Failed to decode base64 JWT payload"),null)}catch(i){return Eg("Caught error parsing JWT payload as JSON",null===i||void 0===i?void 0:i.toString()),null}}function rm(e){const t=nm(e);return Ag(t,"internal-error"),Ag("undefined"!==typeof t.exp,"internal-error"),Ag("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function im(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(n){throw n instanceof x&&function(e){let{code:t}=e;return"auth/user-disabled"===t||"auth/user-token-expired"===t}(n)&&e.auth.currentUser===e&&await e.auth.signOut(),n}}class om{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===(null===e||void 0===e?void 0:e.code)&&this.schedule(!0))}this.schedule()}}class sm{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=em(this.lastLoginAt),this.creationTime=em(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function am(e){var t;const n=e.auth,r=await e.getIdToken(),i=await im(e,Zg(n,{idToken:r}));Ag(null===i||void 0===i?void 0:i.users.length,n,"internal-error");const o=i.users[0];e._notifyReloadListener(o);const s=(null===(t=o.providerUserInfo)||void 0===t?void 0:t.length)?lm(o.providerUserInfo):[],a=(l=e.providerData,c=s,[...l.filter((e=>!c.some((t=>t.providerId===e.providerId)))),...c]);var l,c;const u=e.isAnonymous,d=!(e.email&&o.passwordHash)&&!(null===a||void 0===a?void 0:a.length),h=!!u&&d,f={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:a,metadata:new sm(o.createdAt,o.lastLoginAt),isAnonymous:h};Object.assign(e,f)}function lm(e){return e.map((e=>{var{providerId:t}=e,n=bg(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}))}class cm{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ag(e.idToken,"internal-error"),Ag("undefined"!==typeof e.idToken,"internal-error"),Ag("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):rm(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Ag(0!==e.length,"internal-error");const t=rm(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||!this.accessToken||this.isExpired?(Ag(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:i}=await async function(e,t){const n=await qg(e,{},(async()=>{const n=T({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,o=await Kg(e,r,"/v1/token",`key=${i}`),s=await e._getAdditionalHeaders();return s["Content-Type"]="application/x-www-form-urlencoded",zg.fetch()(o,{method:"POST",headers:s,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,o=new cm;return n&&(Ag("string"===typeof n,"internal-error",{appName:e}),o.refreshToken=n),r&&(Ag("string"===typeof r,"internal-error",{appName:e}),o.accessToken=r),i&&(Ag("number"===typeof i,"internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new cm,this.toJSON())}_performRefresh(){return Dg("not implemented")}}function um(e,t){Ag("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class dm{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=bg(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new om(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new sm(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await im(this,this.stsTokenManager.getToken(this.auth,e));return Ag(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=P(e),r=await n.getIdToken(t),i=nm(r);Ag(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const o="object"===typeof i.firebase?i.firebase:void 0,s=null===o||void 0===o?void 0:o.sign_in_provider;return{claims:i,token:r,authTime:em(tm(i.auth_time)),issuedAtTime:em(tm(i.iat)),expirationTime:em(tm(i.exp)),signInProvider:s||null,signInSecondFactor:(null===o||void 0===o?void 0:o.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=P(e);await am(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(Ag(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new dm(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Ag(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await am(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(He(this.auth.app))return Promise.reject(Cg(this.auth));const e=await this.getIdToken();return await im(this,async function(e,t){return Bg(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,o,s,a,l,c;const u=null!==(n=t.displayName)&&void 0!==n?n:void 0,d=null!==(r=t.email)&&void 0!==r?r:void 0,h=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,f=null!==(o=t.photoURL)&&void 0!==o?o:void 0,p=null!==(s=t.tenantId)&&void 0!==s?s:void 0,g=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,m=null!==(l=t.createdAt)&&void 0!==l?l:void 0,y=null!==(c=t.lastLoginAt)&&void 0!==c?c:void 0,{uid:v,emailVerified:b,isAnonymous:w,providerData:x,stsTokenManager:I}=t;Ag(v&&I,e,"internal-error");const S=cm.fromJSON(this.name,I);Ag("string"===typeof v,e,"internal-error"),um(u,e.name),um(d,e.name),Ag("boolean"===typeof b,e,"internal-error"),Ag("boolean"===typeof w,e,"internal-error"),um(h,e.name),um(f,e.name),um(p,e.name),um(g,e.name),um(m,e.name),um(y,e.name);const E=new dm({uid:v,auth:e,email:d,emailVerified:b,displayName:u,isAnonymous:w,photoURL:f,phoneNumber:h,tenantId:p,stsTokenManager:S,createdAt:m,lastLoginAt:y});return x&&Array.isArray(x)&&(E.providerData=x.map((e=>Object.assign({},e)))),g&&(E._redirectEventId=g),E}static async _fromIdTokenResponse(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=new cm;r.updateFromServerResponse(t);const i=new dm({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await am(i),i}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];Ag(void 0!==r.localId,"internal-error");const i=void 0!==r.providerUserInfo?lm(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!(null===i||void 0===i?void 0:i.length),s=new cm;s.updateFromIdToken(n);const a=new dm({uid:r.localId,auth:e,stsTokenManager:s,isAnonymous:o}),l={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new sm(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(null===i||void 0===i?void 0:i.length)};return Object.assign(a,l),a}}const hm=new Map;function fm(e){Pg(e instanceof Function,"Expected a class definition");let t=hm.get(e);return t?(Pg(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,hm.set(e,t),t)}class pm{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}pm.type="NONE";const gm=pm;function mm(e,t,n){return`firebase:${e}:${t}:${n}`}class ym{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=mm(this.userKey,r.apiKey,i),this.fullPersistenceKey=mm("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if("string"===typeof e){const t=await Zg(this.auth,{idToken:e}).catch((()=>{}));return t?dm._fromGetAccountInfoResponse(this.auth,t,e):null}return dm._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new ym(fm(gm),e,n);const r=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let i=r[0]||fm(gm);const o=mm(n,e.config.apiKey,e.name);let s=null;for(const c of t)try{const t=await c._get(o);if(t){let n;if("string"===typeof t){const r=await Zg(e,{idToken:t}).catch((()=>{}));if(!r)break;n=await dm._fromGetAccountInfoResponse(e,r,t)}else n=dm._fromJSON(e,t);c!==i&&(s=n),i=c;break}}catch(l){}const a=r.filter((e=>e._shouldAllowMigration));return i._shouldAllowMigration&&a.length?(i=a[0],s&&await i._set(o,s.toJSON()),await Promise.all(t.map((async e=>{if(e!==i)try{await e._remove(o)}catch(l){}}))),new ym(i,e,n)):new ym(i,e,n)}}function vm(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Im(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(bm(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Em(t))return"Blackberry";if(_m(t))return"Webos";if(wm(t))return"Safari";if((t.includes("chrome/")||xm(t))&&!t.includes("edge/"))return"Chrome";if(Sm(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null===n||void 0===n?void 0:n.length))return n[1]}return"Other"}function bm(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m();return/firefox\//i.test(e)}function wm(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:m()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function xm(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m();return/crios\//i.test(e)}function Im(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m();return/iemobile/i.test(e)}function Sm(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m();return/android/i.test(e)}function Em(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m();return/blackberry/i.test(e)}function _m(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m();return/webos/i.test(e)}function Tm(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function km(){return function(){const e=m();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}function Cm(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m();return Tm(e)||Sm(e)||_m(e)||Em(e)||/windows phone/i.test(e)||Im(e)}function Nm(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=vm(m());break;case"Worker":t=`${vm(m())}-${e}`;break;default:t=e}const r=n.length?n.join(","):"FirebaseCore-web";return`${t}/JsCore/${Ge}/${r}`}class Am{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,r)=>{try{n(e(t))}catch(i){r(i)}}));n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const e of t)try{e()}catch(r){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===n||void 0===n?void 0:n.message})}}}class Dm{constructor(e){var t,n,r,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=o.minPasswordLength)&&void 0!==t?t:6,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),void 0!==o.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),void 0!==o.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),void 0!==o.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),void 0!==o.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(r=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==r?r:"",this.forceUpgradeOnSignin=null!==(i=e.forceUpgradeOnSignin)&&void 0!==i&&i,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,r,i,o,s;const a={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,a),this.validatePasswordCharacterOptions(e,a),a.isValid&&(a.isValid=null===(t=a.meetsMinPasswordLength)||void 0===t||t),a.isValid&&(a.isValid=null===(n=a.meetsMaxPasswordLength)||void 0===n||n),a.isValid&&(a.isValid=null===(r=a.containsLowercaseLetter)||void 0===r||r),a.isValid&&(a.isValid=null===(i=a.containsUppercaseLetter)||void 0===i||i),a.isValid&&(a.isValid=null===(o=a.containsNumericCharacter)||void 0===o||o),a.isValid&&(a.isValid=null===(s=a.containsNonAlphanumericCharacter)||void 0===s||s),a}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class Pm{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Om(this),this.idTokenSubscription=new Om(this),this.beforeStateQueue=new Am(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Ig,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise((e=>this._resolvePersistenceManagerAvailable=e))}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=fm(t)),this._initializationPromise=this.queue((async()=>{var n,r,i;if(!this._deleted&&(this.persistenceManager=await ym.create(this,e),null===(n=this._resolvePersistenceManagerAvailable)||void 0===n||n.call(this),!this._deleted)){if(null===(r=this._popupRedirectResolver)||void 0===r?void 0:r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(o){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await Zg(this,{idToken:e}),n=await dm._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(He(this.app)){const e=this.app.settings.authIdToken;return e?new Promise((t=>{setTimeout((()=>this.initializeCurrentUserFromIdToken(e).then(t,t)))})):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,o=null===r||void 0===r?void 0:r._redirectEventId,s=await this.tryRedirectSignIn(e);n&&n!==o||!(null===s||void 0===s?void 0:s.user)||(r=s.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(o)))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Ag(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(n){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await am(e)}catch(t){if("auth/network-request-failed"!==(null===t||void 0===t?void 0:t.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(He(this.app))return Promise.reject(Cg(this));const t=e?P(e):null;return t&&Ag(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&Ag(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return He(this.app)?Promise.reject(Cg(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return He(this.app)?Promise.reject(Cg(this)):this.queue((async()=>{await this.assertedPersistence.setPersistence(fm(e))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e){return Bg(e,"GET","/v2/passwordPolicy",$g(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}(this),t=new Dm(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new I("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise(((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged((()=>{n(),e()}),t)}}))}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return Bg(e,"POST","/v2/accounts:revokeToken",$g(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&fm(e)||this._popupRedirectResolver;Ag(t,this,"argument-error"),this.redirectPersistenceManager=await ym.create(this,[fm(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"===typeof t?t:t.next.bind(t);let o=!1;const s=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ag(s,this,"internal-error"),s.then((()=>{o||i(this.currentUser)})),"function"===typeof t){const i=e.addObserver(t,n,r);return()=>{o=!0,i()}}{const n=e.addObserver(t);return()=>{o=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ag(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Nm(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;if(He(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null===t||void 0===t?void 0:t.error)&&function(e){if(Sg.logLevel<=z.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Sg.warn(`Auth (${Ge}): ${e}`,...n)}}(`Error while retrieving App Check token: ${t.error}`),null===t||void 0===t?void 0:t.token}}function Rm(e){return P(e)}class Om{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new N(e,t);return n.subscribe.bind(n)}((e=>this.observer=e))}get next(){return Ag(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Lm={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Mm(e){return Lm.loadJS(e)}function jm(e){return`__${e}${Math.floor(1e6*Math.random())}`}class zm{constructor(){this.enterprise=new Fm}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class Fm{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const Vm="NO_RECAPTCHA";class Um{constructor(e){this.type="recaptcha-enterprise",this.auth=Rm(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(t,n,r){const i=window.grecaptcha;Yg(i)?i.enterprise.ready((()=>{i.enterprise.execute(t,{action:e}).then((e=>{n(e)})).catch((()=>{n(Vm)}))})):r(Error("No reCAPTCHA enterprise script loaded."))}if(this.auth.settings.appVerificationDisabledForTesting){return(new zm).execute("siteKey",{action:"verify"})}return new Promise(((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise((async(t,n)=>{Jg(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((r=>{if(void 0!==r.recaptchaKey){const n=new Xg(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((e=>{n(e)}))}))})(this.auth).then((i=>{if(!t&&Yg(window.grecaptcha))n(i,e,r);else{if("undefined"===typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=Lm.recaptchaEnterpriseScript;0!==t.length&&(t+=i),Mm(t).then((()=>{n(i,e,r)})).catch((e=>{r(e)}))}})).catch((e=>{r(e)}))}))}}async function $m(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const o=new Um(e);let s;if(i)s=Vm;else try{s=await o.verify(n)}catch(l){s=await o.verify(n,!0)}const a=Object.assign({},t);if("mfaSmsEnrollment"===n||"mfaSmsSignIn"===n){if("phoneEnrollmentInfo"in a){const e=a.phoneEnrollmentInfo.phoneNumber,t=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:t,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const e=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:e,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:s}):Object.assign(a,{captchaResponse:s}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Bm(e,t,n,r,i){var o,s;if("EMAIL_PASSWORD_PROVIDER"===i){if(null===(o=e._getRecaptchaConfig())||void 0===o?void 0:o.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await $m(e,t,n,"getOobCode"===n);return r(e,i)}return r(e,t).catch((async i=>{if("auth/missing-recaptcha-token"===i.code){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const i=await $m(e,t,n,"getOobCode"===n);return r(e,i)}return Promise.reject(i)}))}if("PHONE_PROVIDER"===i){if(null===(s=e._getRecaptchaConfig())||void 0===s?void 0:s.isProviderEnabled("PHONE_PROVIDER")){const i=await $m(e,t,n);return r(e,i).catch((async i=>{var o;if("AUDIT"===(null===(o=e._getRecaptchaConfig())||void 0===o?void 0:o.getProviderEnforcementState("PHONE_PROVIDER"))&&("auth/missing-recaptcha-token"===i.code||"auth/invalid-app-credential"===i.code)){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${n} flow.`);const i=await $m(e,t,n,!1,!0);return r(e,i)}return Promise.reject(i)}))}{const i=await $m(e,t,n,!1,!0);return r(e,i)}}return Promise.reject(i+" provider is not supported.")}async function qm(e){const t=Rm(e),n=await Jg(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new Xg(n);if(null==t.tenantId?t._agentRecaptchaConfig=r:t._tenantRecaptchaConfigs[t.tenantId]=r,r.isAnyProviderEnabled()){new Um(t).verify()}}function Hm(e,t,n){const r=Rm(e);Ag(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=!!(null===n||void 0===n?void 0:n.disableWarnings),o=Km(t),{host:s,port:a}=function(e){const t=Km(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const e=i[1];return{host:e,port:Wm(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:Wm(t)}}}(t),l={url:`${o}//${s}${null===a?"":`:${a}`}/`},c=Object.freeze({host:s,port:a,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator)return Ag(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),void Ag(E(l,r.config.emulator)&&E(c,r.emulatorConfig),r,"emulator-config-failed");r.config.emulator=l,r.emulatorConfig=c,r.settings.appVerificationDisabledForTesting=!0,i||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function Km(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Wm(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class Gm{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Dg("not implemented")}_getIdTokenResponse(e){return Dg("not implemented")}_linkToIdToken(e,t){return Dg("not implemented")}_getReauthenticationResolver(e){return Dg("not implemented")}}async function Qm(e,t){return Bg(e,"POST","/v1/accounts:signUp",t)}async function Ym(e,t){return Hg(e,"POST","/v1/accounts:signInWithPassword",$g(e,t))}class Xm extends Gm{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new Xm(e,t,"password")}static _fromEmailAndCode(e,t){return new Xm(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return Bm(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",Ym,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return Hg(e,"POST","/v1/accounts:signInWithEmailLink",$g(e,t))}(e,{email:this._email,oobCode:this._password});default:_g(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return Bm(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Qm,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return Hg(e,"POST","/v1/accounts:signInWithEmailLink",$g(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:_g(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Jm(e,t){return Hg(e,"POST","/v1/accounts:signInWithIdp",$g(e,t))}class Zm extends Gm{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Zm(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):_g("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=bg(t,["providerId","signInMethod"]);if(!n||!r)return null;const o=new Zm(n,r);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){return Jm(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Jm(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Jm(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=T(t)}return e}}async function ey(e,t){return Bg(e,"POST","/v1/accounts:sendVerificationCode",$g(e,t))}const ty={USER_NOT_FOUND:"user-not-found"};class ny extends Gm{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new ny({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new ny({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return Hg(e,"POST","/v1/accounts:signInWithPhoneNumber",$g(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await Hg(e,"POST","/v1/accounts:signInWithPhoneNumber",$g(e,t));if(n.temporaryProof)throw Qg(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return Hg(e,"POST","/v1/accounts:signInWithPhoneNumber",$g(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),ty)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new ny({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class ry{constructor(e){var t,n,r,i,o,s;const a=k(C(e)),l=null!==(t=a.apiKey)&&void 0!==t?t:null,c=null!==(n=a.oobCode)&&void 0!==n?n:null,u=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=a.mode)&&void 0!==r?r:null);Ag(l&&c&&u,"argument-error"),this.apiKey=l,this.operation=u,this.code=c,this.continueUrl=null!==(i=a.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(o=a.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(s=a.tenantId)&&void 0!==s?s:null}static parseLink(e){const t=function(e){const t=k(C(e)).link,n=t?k(C(t)).deep_link_id:null,r=k(C(e)).deep_link_id;return(r?k(C(r)).link:null)||r||n||t||e}(e);try{return new ry(t)}catch(n){return null}}}class iy{constructor(){this.providerId=iy.PROVIDER_ID}static credential(e,t){return Xm._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=ry.parseLink(t);return Ag(n,"argument-error"),Xm._fromEmailAndCode(e,n.code,n.tenantId)}}iy.PROVIDER_ID="password",iy.EMAIL_PASSWORD_SIGN_IN_METHOD="password",iy.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class oy{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class sy extends oy{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class ay extends sy{constructor(){super("facebook.com")}static credential(e){return Zm._fromParams({providerId:ay.PROVIDER_ID,signInMethod:ay.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ay.credentialFromTaggedObject(e)}static credentialFromError(e){return ay.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return ay.credential(t.oauthAccessToken)}catch(n){return null}}}ay.FACEBOOK_SIGN_IN_METHOD="facebook.com",ay.PROVIDER_ID="facebook.com";class ly extends sy{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Zm._fromParams({providerId:ly.PROVIDER_ID,signInMethod:ly.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return ly.credentialFromTaggedObject(e)}static credentialFromError(e){return ly.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:r}=t;if(!n&&!r)return null;try{return ly.credential(n,r)}catch(i){return null}}}ly.GOOGLE_SIGN_IN_METHOD="google.com",ly.PROVIDER_ID="google.com";class cy extends sy{constructor(){super("github.com")}static credential(e){return Zm._fromParams({providerId:cy.PROVIDER_ID,signInMethod:cy.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return cy.credentialFromTaggedObject(e)}static credentialFromError(e){return cy.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return cy.credential(t.oauthAccessToken)}catch(n){return null}}}cy.GITHUB_SIGN_IN_METHOD="github.com",cy.PROVIDER_ID="github.com";class uy extends sy{constructor(){super("twitter.com")}static credential(e,t){return Zm._fromParams({providerId:uy.PROVIDER_ID,signInMethod:uy.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return uy.credentialFromTaggedObject(e)}static credentialFromError(e){return uy.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=t;if(!n||!r)return null;try{return uy.credential(n,r)}catch(i){return null}}}uy.TWITTER_SIGN_IN_METHOD="twitter.com",uy.PROVIDER_ID="twitter.com";class dy{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=await dm._fromIdTokenResponse(e,n,r),o=hy(n);return new dy({user:i,providerId:o,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=hy(n);return new dy({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function hy(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class fy extends x{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,fy.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new fy(e,t,n,r)}}function py(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw fy._fromErrorAndOperation(e,n,t,r);throw n}))}async function gy(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=await im(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return dy._forOperation(e,"link",r)}async function my(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:r}=e;if(He(r.app))return Promise.reject(Cg(r));const i="reauthenticate";try{const o=await im(e,py(r,i,t,e),n);Ag(o.idToken,r,"internal-error");const s=nm(o.idToken);Ag(s,r,"internal-error");const{sub:a}=s;return Ag(e.uid===a,r,"user-mismatch"),dy._forOperation(e,i,o)}catch(o){throw"auth/user-not-found"===(null===o||void 0===o?void 0:o.code)&&_g(r,"user-mismatch"),o}}async function yy(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(He(e.app))return Promise.reject(Cg(e));const r="signIn",i=await py(e,r,t),o=await dy._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(o.user),o}function vy(e,t){return Bg(e,"POST","/v2/accounts/mfaEnrollment:start",$g(e,t))}new WeakMap;const by="__sak";class wy{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(by,"1"),this.storage.removeItem(by),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class xy extends wy{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Cm(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},i=this.storage.getItem(n);km()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}xy.type="LOCAL";const Iy=xy;function Sy(e){var t,n;const r=e.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),i=RegExp(`${r}=([^;]+)`);return null!==(n=null===(t=document.cookie.match(i))||void 0===t?void 0:t[1])&&void 0!==n?n:null}function Ey(e){return`${"http:"===window.location.protocol?"__dev_":"__HOST-"}FIREBASE_${e.split(":")[3]}`}class _y{constructor(){this.type="COOKIE",this.listenerUnsubscribes=new Map}_getFinalTarget(e){if(void 0===typeof window)return e;const t=new URL(`${window.location.origin}/__cookies__`);return t.searchParams.set("finalTarget",e),t}async _isAvailable(){var e;return!("boolean"===typeof isSecureContext&&!isSecureContext)&&("undefined"!==typeof navigator&&"undefined"!==typeof document&&(null===(e=navigator.cookieEnabled)||void 0===e||e))}async _set(e,t){}async _get(e){if(!this._isAvailable())return null;const t=Ey(e);if(window.cookieStore){const e=await window.cookieStore.get(t);return null===e||void 0===e?void 0:e.value}return Sy(t)}async _remove(e){if(!this._isAvailable())return;if(!await this._get(e))return;const t=Ey(e);document.cookie=`${t}=;Max-Age=34560000;Partitioned;Secure;SameSite=Strict;Path=/;Priority=High`,await fetch("/__cookies__",{method:"DELETE"}).catch((()=>{}))}_addListener(e,t){if(!this._isAvailable())return;const n=Ey(e);if(window.cookieStore){const e=e=>{const r=e.changed.find((e=>e.name===n));r&&t(r.value);e.deleted.find((e=>e.name===n))&&t(null)},r=()=>window.cookieStore.removeEventListener("change",e);return this.listenerUnsubscribes.set(t,r),window.cookieStore.addEventListener("change",e)}let r=Sy(n);const i=setInterval((()=>{const e=Sy(n);e!==r&&(t(e),r=e)}),1e3);this.listenerUnsubscribes.set(t,(()=>clearInterval(i)))}_removeListener(e,t){const n=this.listenerUnsubscribes.get(t);n&&(n(),this.listenerUnsubscribes.delete(t))}}_y.type="COOKIE";class Ty extends wy{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Ty.type="SESSION";const ky=Ty;class Cy{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new Cy(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,o=this.handlersMap[r];if(!(null===o||void 0===o?void 0:o.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const s=Array.from(o).map((async e=>e(t.origin,i))),a=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}})))}(s);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Ny(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}Cy.receivers=[];class Ay{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const r="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,o;return new Promise(((s,a)=>{const l=Ny("",20);r.port1.start();const c=setTimeout((()=>{a(new Error("unsupported_event"))}),n);o={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(c),i=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(i),s(t.data.response);break;default:clearTimeout(c),clearTimeout(i),a(new Error("invalid_response"))}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[r.port2])})).finally((()=>{o&&this.removeMessageHandler(o)}))}}function Dy(){return window}function Py(){return"undefined"!==typeof Dy().WorkerGlobalScope&&"function"===typeof Dy().importScripts}const Ry="firebaseLocalStorageDb",Oy="firebaseLocalStorage",Ly="fbase_key";class My{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function jy(e,t){return e.transaction([Oy],t?"readwrite":"readonly").objectStore(Oy)}function zy(){const e=indexedDB.open(Ry,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(Oy,{keyPath:Ly})}catch(r){n(r)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(Oy)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(Ry);return new My(e).toPromise()}(),t(await zy()))}))}))}async function Fy(e,t,n){const r=jy(e,!0).put({[Ly]:t,value:n});return new My(r).toPromise()}function Vy(e,t){const n=jy(e,!0).delete(t);return new My(n).toPromise()}class Uy{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await zy()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(n){if(t++>3)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Py()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Cy._getInstance(Py()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new Ay(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await zy();return await Fy(e,by,"1"),await Vy(e,by),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>Fy(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=jy(e,!1).get(t),r=await new My(n).toPromise();return void 0===r?null:r.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>Vy(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=jy(e,!1).getAll();return new My(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Uy.type="LOCAL";const $y=Uy;function By(e,t){return Bg(e,"POST","/v2/accounts/mfaSignIn:start",$g(e,t))}jm("rcb"),new Mg(3e4,6e4);const qy="recaptcha";async function Hy(e,t,n){var r;if(!e._getRecaptchaConfig())try{await qm(e)}catch(i){console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let i;if(i="string"===typeof t?{phoneNumber:t}:t,"session"in i){const t=i.session;if("phoneNumber"in i){Ag("enroll"===t.type,e,"internal-error");const r={idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"}},o=Bm(e,r,"mfaSmsEnrollment",(async(e,t)=>{if(t.phoneEnrollmentInfo.captchaResponse===Vm){Ag((null===n||void 0===n?void 0:n.type)===qy,e,"argument-error");return vy(e,await Ky(e,t,n))}return vy(e,t)}),"PHONE_PROVIDER");return(await o.catch((e=>Promise.reject(e)))).phoneSessionInfo.sessionInfo}{Ag("signin"===t.type,e,"internal-error");const o=(null===(r=i.multiFactorHint)||void 0===r?void 0:r.uid)||i.multiFactorUid;Ag(o,e,"missing-multi-factor-info");const s={mfaPendingCredential:t.credential,mfaEnrollmentId:o,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}},a=Bm(e,s,"mfaSmsSignIn",(async(e,t)=>{if(t.phoneSignInInfo.captchaResponse===Vm){Ag((null===n||void 0===n?void 0:n.type)===qy,e,"argument-error");return By(e,await Ky(e,t,n))}return By(e,t)}),"PHONE_PROVIDER");return(await a.catch((e=>Promise.reject(e)))).phoneResponseInfo.sessionInfo}}{const t={phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"},r=Bm(e,t,"sendVerificationCode",(async(e,t)=>{if(t.captchaResponse===Vm){Ag((null===n||void 0===n?void 0:n.type)===qy,e,"argument-error");return ey(e,await Ky(e,t,n))}return ey(e,t)}),"PHONE_PROVIDER");return(await r.catch((e=>Promise.reject(e)))).sessionInfo}}finally{null===n||void 0===n||n._reset()}}async function Ky(e,t,n){Ag(n.type===qy,e,"argument-error");const r=await n.verify();Ag("string"===typeof r,e,"argument-error");const i=Object.assign({},t);if("phoneEnrollmentInfo"in i){const e=i.phoneEnrollmentInfo.phoneNumber,t=i.phoneEnrollmentInfo.captchaResponse,n=i.phoneEnrollmentInfo.clientType,o=i.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(i,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:r,captchaResponse:t,clientType:n,recaptchaVersion:o}}),i}if("phoneSignInInfo"in i){const e=i.phoneSignInInfo.captchaResponse,t=i.phoneSignInInfo.clientType,n=i.phoneSignInInfo.recaptchaVersion;return Object.assign(i,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:e,clientType:t,recaptchaVersion:n}}),i}return Object.assign(i,{recaptchaToken:r}),i}class Wy{constructor(e){this.providerId=Wy.PROVIDER_ID,this.auth=Rm(e)}verifyPhoneNumber(e,t){return Hy(this.auth,e,P(t))}static credential(e,t){return ny._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Wy.credentialFromTaggedObject(t)}static credentialFromError(e){return Wy.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:n,temporaryProof:r}=t;return n&&r?ny._fromTokenResponse(n,r):null}}function Gy(e,t){return t?fm(t):(Ag(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}Wy.PROVIDER_ID="phone",Wy.PHONE_SIGN_IN_METHOD="phone";class Qy extends Gm{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Jm(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Jm(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Jm(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Yy(e){return yy(e.auth,new Qy(e),e.bypassAuthState)}function Xy(e){const{auth:t,user:n}=e;return Ag(n,t,"internal-error"),my(n,new Qy(e),e.bypassAuthState)}async function Jy(e){const{auth:t,user:n}=e;return Ag(n,t,"internal-error"),gy(n,new Qy(e),e.bypassAuthState)}class Zy{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:o,type:s}=e;if(o)return void this.reject(o);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(s)(a))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Yy;case"linkViaPopup":case"linkViaRedirect":return Jy;case"reauthViaPopup":case"reauthViaRedirect":return Xy;default:_g(this.auth,"internal-error")}}resolve(e){Pg(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Pg(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const ev=new Mg(2e3,1e4);class tv extends Zy{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,tv.currentPopupAction&&tv.currentPopupAction.cancel(),tv.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ag(e,this.auth,"internal-error"),e}async onExecution(){Pg(1===this.filter.length,"Popup operations only handle one event");const e=Ny();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(Tg(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(Tg(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,tv.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(Tg(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(e,ev.get())};e()}}tv.currentPopupAction=null;const nv=new Map;class rv extends Zy{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=nv.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=sv(t),r=ov(e);if(!await r._isAvailable())return!1;const i="true"===await r._get(n);return await r._remove(n),i}(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}nv.set(this.auth._key(),e)}return this.bypassAuthState||nv.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function iv(e,t){nv.set(e._key(),t)}function ov(e){return fm(e._redirectPersistence)}function sv(e){return mm("pendingRedirect",e.config.apiKey,e.name)}async function av(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(He(e.app))return Promise.reject(Cg(e));const r=Rm(e),i=Gy(r,t),o=new rv(r,i,n),s=await o.execute();return s&&!n&&(delete s.user._redirectEventId,await r._persistUserIfCurrent(s.user),await r._setRedirectUser(null,t)),s}class lv{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return uv(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!uv(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(Tg(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(cv(e))}saveEventToCache(e){this.cachedEventUids.add(cv(e)),this.lastProcessedEventTime=Date.now()}}function cv(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function uv(e){let{type:t,error:n}=e;return"unknown"===t&&"auth/no-auth-event"===(null===n||void 0===n?void 0:n.code)}const dv=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,hv=/^https?/;async function fv(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e){return Bg(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(e);for(const r of t)try{if(pv(r))return}catch(n){}_g(e,"unauthorized-domain")}function pv(e){const t=Rg(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!hv.test(n))return!1;if(dv.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const gv=new Mg(3e4,6e4);function mv(){const e=Dy().___jsl;if(null===e||void 0===e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function yv(e){return new Promise(((t,n)=>{var r,i,o;function s(){mv(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{mv(),n(Tg(e,"network-request-failed"))},timeout:gv.get()})}if(null===(i=null===(r=Dy().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(o=Dy().gapi)||void 0===o?void 0:o.load)){const t=jm("iframefcb");return Dy()[t]=()=>{gapi.load?s():n(Tg(e,"network-request-failed"))},Mm(`${Lm.gapiScript}?onload=${t}`).catch((e=>n(e)))}s()}})).catch((e=>{throw vv=null,e}))}let vv=null;const bv=new Mg(5e3,15e3),wv={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},xv=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Iv(e){const t=e.config;Ag(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?jg(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,r={apiKey:t.apiKey,appName:e.name,v:Ge},i=xv.get(e.config.apiHost);i&&(r.eid=i);const o=e._getFrameworks();return o.length&&(r.fw=o.join(",")),`${n}?${T(r).slice(1)}`}async function Sv(e){const t=await function(e){return vv=vv||yv(e),vv}(e),n=Dy().gapi;return Ag(n,e,"internal-error"),t.open({where:document.body,url:Iv(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:wv,dontclear:!0},(t=>new Promise((async(n,r)=>{await t.restyle({setHideOnLeave:!1});const i=Tg(e,"network-request-failed"),o=Dy().setTimeout((()=>{r(i)}),bv.get());function s(){Dy().clearTimeout(o),n(t)}t.ping(s).then(s,(()=>{r(i)}))}))))}const Ev={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class _v{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function Tv(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const o=Math.max((window.screen.availHeight-i)/2,0).toString(),s=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},Ev),{width:r.toString(),height:i.toString(),top:o,left:s}),c=m().toLowerCase();n&&(a=xm(c)?"_blank":n),bm(c)&&(t=t||"http://localhost",l.scrollbars="yes");const u=Object.entries(l).reduce(((e,t)=>{let[n,r]=t;return`${e}${n}=${r},`}),"");if(function(){var e;return Tm(arguments.length>0&&void 0!==arguments[0]?arguments[0]:m())&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(c)&&"_self"!==a)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",a),new _v(null);const d=window.open(t||"",a,u);Ag(d,e,"popup-blocked");try{d.focus()}catch(h){}return new _v(d)}const kv="__/auth/handler",Cv="emulator/auth/handler",Nv=encodeURIComponent("fac");async function Av(e,t,n,r,i,o){Ag(e.config.authDomain,e,"auth-domain-config-required"),Ag(e.config.apiKey,e,"invalid-api-key");const s={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:Ge,eventId:i};if(t instanceof oy){t.setDefaultLanguage(e.languageCode),s.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(s.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(o||{}))s[e]=t}if(t instanceof sy){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(s.scopes=e.join(","))}e.tenantId&&(s.tid=e.tenantId);const a=s;for(const u of Object.keys(a))void 0===a[u]&&delete a[u];const l=await e._getAppCheckToken(),c=l?`#${Nv}=${encodeURIComponent(l)}`:"";return`${function(e){let{config:t}=e;if(!t.emulator)return`https://${t.authDomain}/${kv}`;return jg(t,Cv)}(e)}?${T(a).slice(1)}${c}`}const Dv="webStorageSupport";const Pv=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ky,this._completeRedirectFn=av,this._overrideRedirectResult=iv}async _openPopup(e,t,n,r){var i;Pg(null===(i=this.eventManagers[e._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()");return Tv(e,await Av(e,t,n,Rg(),r),Ny())}async _openRedirect(e,t,n,r){await this._originValidation(e);return function(e){Dy().location.href=e}(await Av(e,t,n,Rg(),r)),new Promise((()=>{}))}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(Pg(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await Sv(e),n=new lv(e);return t.register("authEvent",(t=>{Ag(null===t||void 0===t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Dv,{type:Dv},(n=>{var r;const i=null===(r=null===n||void 0===n?void 0:n[0])||void 0===r?void 0:r[Dv];void 0!==i&&t(!!i),_g(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=fv(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Cm()||wm()||Tm()}};var Rv="@firebase/auth",Ov="1.10.0";class Lv{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ag(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const Mv=p("authIdTokenMaxAge")||300;let jv=null;var zv;Lm={loadJS:e=>new Promise(((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=Tg("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)})),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},zv="Browser",Be(new R("auth",((e,t)=>{let{options:n}=t;const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:s,authDomain:a}=r.options;Ag(s&&!s.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:s,authDomain:a,clientPlatform:zv,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Nm(zv)},c=new Pm(r,i,o,l);return function(e,t){const n=(null===t||void 0===t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(fm);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null===t||void 0===t?void 0:t.popupRedirectResolver)}(c,n),c}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),Be(new R("auth-internal",(e=>(e=>new Lv(e))(Rm(e.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),Xe(Rv,Ov,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(zv)),Xe(Rv,Ov,"esm2017");const Fv=Qe({apiKey:"AIzaSyDo7X1BLIW1hNYQpJLZcDws_L4aGHJWXOQ",authDomain:"asignacion-plazas.firebaseapp.com",projectId:"asignacion-plazas",storageBucket:"asignacion-plazas.firebasestorage.app",messagingSenderId:"525955676079",appId:"1:525955676079:web:a7e0b00391e75c902fe15a",measurementId:"G-E0DLWYPVKP"}),Vv=function(e,t){const n="object"==typeof e?e:Ye(),r="string"==typeof e?e:t||Ti,i=qe(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const e=(e=>{const t=h(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]})("firestore");e&&Dh(i,...e)}return i}(Fv);!function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ye();const t=qe(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=qe(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(E(n.getOptions(),null!==t&&void 0!==t?t:{}))return e;_g(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:Pv,persistence:[$y,Iy,ky]}),r=p("authTokenSyncURL");if(r&&"boolean"===typeof isSecureContext&&isSecureContext){const e=new URL(r,location.origin);if(location.origin===e.origin){const t=(i=e.toString(),async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>Mv)return;const r=null===t||void 0===t?void 0:t.token;jv!==r&&(jv=r,await fetch(i,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))});!function(e,t,n){P(e).beforeAuthStateChanged(t,n)}(n,t,(()=>t(n.currentUser))),function(e,t,n,r){P(e).onIdTokenChanged(t,n,r)}(n,(e=>t(e)))}}var i;const o=h("auth");o&&Hm(n,`http://${o}`)}(Fv);try{(function(e,t){At("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=e._freezeSettings();return Bh(e,lh.provider,{build:e=>new ah(e,n.cacheSizeBytes,null==t?void 0:t.forceOwnership)}),Promise.resolve()})(Vv).catch((e=>{"failed-precondition"===e.code||e.code}))}catch(Yv){}const Uv=async(e,t,n,r)=>{try{if(!e||!e.length)return r&&r("No hay solicitudes pendientes para procesar"),{success:!0,message:"No hay solicitudes pendientes para procesar"};r&&r("Iniciando procesamiento de solicitudes...");const i=[...e],o=t.map((e=>({orden:e.order,centroActual:e.id,estaAsignada:!0,docId:e.docId,timestamp:e.timestamp||0,centro:e.centro,localidad:e.localidad,municipio:e.municipio}))),s=[...i,...o].sort(((e,t)=>Number(e.orden)-Number(t.orden)));r&&r(`Procesando ${s.length} solicitudes por prioridad...`);const a=n.map((e=>({...e,asignadas:0,asignacionesPorOrden:[]}))),l=a.reduce(((e,t)=>(e[t.id]=t,e)),{});r&&r("Eliminando asignaciones existentes para recalcular...");for(const e of t)e.docId&&await qf(Mh(Vv,"asignaciones",e.docId));for(const e of a)e.docId&&await Bf(Mh(Vv,"centros",e.docId),{asignadas:0});let c=0,u=0;const d=[],h=new Set,f=[],p=[];for(const e of s){if(h.has(e.orden))continue;r&&r(`Procesando solicitud/asignaci\xf3n #${e.orden} (procesadas: ${h.size})`);let t=!1,n=null;if(e.estaAsignada&&e.centroActual){const r=l[e.centroActual];if(r&&r.asignadas<r.plazas){r.asignadas++,r.asignacionesPorOrden.push(e.orden);const i={order:e.orden,id:r.id,localidad:r.localidad||e.localidad,centro:r.centro||e.centro,municipio:r.municipio||e.municipio,timestamp:Date.now(),mantenida:!0},o=Mh(Lh(Vv,"asignaciones"));await $f(o,i),d.push({...i,docId:o.id}),t=!0,n=r,p.push({tipo:"MANTENIDA",orden:e.orden,centroId:r.id,centro:r.centro,mensaje:`Asignaci\xf3n mantenida en ${r.centro}`})}}if(!t){const r=e.centrosIds||(e.estaAsignada?[e.centroActual]:[]),i=r.length>0?r.map((e=>l[e])).filter(Boolean):a.sort(((e,t)=>e.asignadas/e.plazas-t.asignadas/t.plazas));for(const o of i){if(o.asignadas<o.plazas){o.asignadas++,o.asignacionesPorOrden.push(e.orden);const r={order:e.orden,id:o.id,localidad:o.localidad,centro:o.centro,municipio:o.municipio,timestamp:Date.now()},i=Mh(Lh(Vv,"asignaciones"));await $f(i,r),d.push({...r,docId:i.id}),c++,t=!0,n=o,!e.estaAsignada&&e.docId&&f.push(e.docId),p.push({tipo:e.estaAsignada?"REASIGNADA":"ASIGNADA",orden:e.orden,centroId:o.id,centro:o.centro,mensaje:e.estaAsignada?`Reasignada de ${e.centro||"centro anterior"} a ${o.centro}`:`Asignada a ${o.centro}`});break}if(o.asignacionesPorOrden.length>0){const r=o.asignacionesPorOrden,i=Math.max(...r);if(Number(i)>Number(e.orden)){console.log(`Posible desplazamiento: Orden ${e.orden} tiene mayor prioridad que ${i} en ${o.centro}`);const r=d.find((e=>e.order==i&&e.id===o.id));if(r){s.find((e=>e.orden==i));const l=a.filter((e=>e.id!==o.id&&e.asignadas<e.plazas));if(l.length>0){const s=l[0];o.asignacionesPorOrden=o.asignacionesPorOrden.filter((e=>e!=i)),o.asignacionesPorOrden.push(e.orden);const a={order:e.orden,id:o.id,localidad:o.localidad,centro:o.centro,municipio:o.municipio,timestamp:Date.now(),priorizado:!0},c=Mh(Lh(Vv,"asignaciones"));await $f(c,a),d.push({...a,docId:c.id}),s.asignadas++,s.asignacionesPorOrden.push(i);const h={order:i,id:s.id,localidad:s.localidad,centro:s.centro,municipio:s.municipio,timestamp:Date.now(),desplazada:!0,centroAnterior:o.centro},g=Mh(Lh(Vv,"asignaciones"));await $f(g,h),r.docId&&await qf(Mh(Vv,"asignaciones",r.docId));const m=d.findIndex((e=>e.order==i&&e.id===o.id));m>=0&&d.splice(m,1),d.push({...h,docId:g.id}),t=!0,n=o,u++,!e.estaAsignada&&e.docId&&f.push(e.docId),p.push({tipo:"PRIORIZADA",orden:e.orden,centroId:o.id,centro:o.centro,mensaje:`Priorizada en ${o.centro}, desplazando a orden ${i}`}),p.push({tipo:"DESPLAZADA",orden:i,centroId:s.id,centro:s.centro,centroAnterior:o.centro,mensaje:`Desplazada de ${o.centro} a ${s.centro} por orden ${e.orden} de mayor prioridad`});break}}}}}}h.add(e.orden),t||(p.push({tipo:"NO_ASIGNABLE",orden:e.orden,mensaje:"No hay plazas disponibles en ninguno de los centros solicitados"}),!e.estaAsignada&&e.docId&&f.push(e.docId))}r&&r(`Registrando ${p.length} operaciones en el historial...`);for(const e of p)try{const t=Mh(Lh(Vv,"historialSolicitudes")),n={orden:e.orden,estado:e.tipo,fechaHistorico:(new Date).toISOString(),timestamp:Date.now()};void 0!==e.centroId&&(n.centroId=e.centroId),void 0!==e.centro&&(n.centroAsignado=e.centro),void 0!==e.centroAnterior&&(n.centroAnterior=e.centroAnterior),void 0!==e.mensaje&&(n.mensaje=e.mensaje),await $f(t,n)}catch(Yv){console.error(`Error al registrar historial para orden ${e.orden}:`,Yv)}if(f.length>0){r&&r(`Eliminando ${f.length} solicitudes procesadas...`);let e=0;for(const t of f)try{await qf(Mh(Vv,"solicitudesPendientes",t)),e++}catch(Yv){console.error(`Error al eliminar solicitud ${t}:`,Yv)}r&&r(`Se eliminaron ${e} solicitudes pendientes ya procesadas.`)}r&&r("Actualizando contadores en los centros...");for(const e of a)e.docId&&await Bf(Mh(Vv,"centros",e.docId),{asignadas:e.asignadas});return r&&r(`Procesamiento completado. ${c} nuevas asignaciones, ${u} reasignaciones.`),{success:!0,nuevasAsignaciones:d,eliminadas:f.length,asignacionesNuevas:c,reasignaciones:u,message:`Asignaciones procesadas por prioridad. ${c} nuevas, ${u} reasignaciones.`}}catch(Yv){return console.error("Error en procesarSolicitudes:",Yv),r&&r("Error: "+Yv.message),{success:!1,message:Yv.message}}};var $v=n(579);const Bv=e=>{let{assignments:t=[],availablePlazas:n=[]}=e;const[i,o]=(0,r.useState)(""),[s,a]=(0,r.useState)("TODOS"),[l,c]=(0,r.useState)(""),[u,d]=(0,r.useState)(1),[h]=(0,r.useState)(10),[f,p]=(0,r.useState)({key:"order",direction:"asc"});(0,r.useEffect)((()=>{if(!Array.isArray(t))return c("Error: Los datos de asignaciones no son v\xe1lidos"),void console.error("Dashboard: assignments debe ser un array");const e=t.filter((e=>!e||"object"!==typeof e||!e.numeroOrden&&!e.order||!e.nombreCentro&&!e.centro||!e.timestamp));e.length>0&&console.warn("Algunas asignaciones tienen estructura inv\xe1lida:",e),c("")}),[t]);const g=e=>{if(!e)return"Fecha no disponible";try{return new Date(e).toLocaleString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch(l){return console.error("Error al formatear fecha:",l),"Fecha inv\xe1lida"}};if(l)return(0,$v.jsx)("div",{style:{textAlign:"center",padding:"20px",backgroundColor:"#fff3cd",borderRadius:"8px",color:"#856404",margin:"20px 0"},children:(0,$v.jsx)("p",{children:l})});if(!t.length)return(0,$v.jsxs)("div",{style:{textAlign:"center",padding:"40px 20px",backgroundColor:"#f5f7fa",borderRadius:"8px",color:"#5c6c7c"},children:[(0,$v.jsx)("div",{style:{fontSize:"36px",marginBottom:"15px"},children:"\ud83d\udccb"}),(0,$v.jsx)("div",{style:{fontSize:"18px",fontWeight:"bold",marginBottom:"10px"},children:"No hay asignaciones realizadas"}),(0,$v.jsx)("div",{style:{fontSize:"14px"},children:"Las asignaciones aparecer\xe1n aqu\xed una vez procesadas las solicitudes"})]});const m=(()=>{if(!Array.isArray(t))return[];let e=t;return i&&(e=e.filter((e=>{var t;if(!e)return!1;return[null===(t=e.numeroOrden||e.order)||void 0===t?void 0:t.toString(),e.nombreCentro||e.centro,e.localidad,e.municipio].filter(Boolean).some((e=>e.toLowerCase().includes(i.toLowerCase())))}))),"TODOS"!==s&&(e=e.filter((e=>e&&e.estado===s))),(n=e)&&Array.isArray(n)?[...n].sort(((e,t)=>{if(!e||!t)return 0;let n,r;return"order"===f.key?(n=void 0!==e.numeroOrden?e.numeroOrden:e.order,r=void 0!==t.numeroOrden?t.numeroOrden:t.order):"centro"===f.key?(n=e.nombreCentro||e.centro||"",r=t.nombreCentro||t.centro||""):(n=e[f.key],r=t[f.key]),"order"===f.key&&(n=Number(n)||0,r=Number(r)||0),n<r?"asc"===f.direction?-1:1:n>r?"asc"===f.direction?1:-1:0})):[];var n})(),y=Math.ceil(m.length/h),v=u*h,b=v-h,w=m.slice(b,v),x=e=>{e<1||e>y||d(e)},I=e=>{p((t=>({key:e,direction:t.key===e&&"asc"===t.direction?"desc":"asc"})))},S={container:{position:"relative",padding:"20px",backgroundColor:"#f4f6f9",borderRadius:"8px",boxShadow:"0 4px 8px rgba(0,0,0,0.1)"},infoContainer:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px",flexWrap:"wrap",gap:"15px"},statsContainer:{display:"flex",gap:"15px",flexWrap:"wrap"},statCard:{backgroundColor:"#ffffff",borderRadius:"6px",padding:"15px",minWidth:"140px",boxShadow:"0 2px 5px rgba(0,0,0,0.06)",flex:1},statValue:{fontSize:"24px",fontWeight:"bold",color:"#2d3748",marginBottom:"5px"},statLabel:{fontSize:"13px",color:"#718096"},searchBar:{display:"flex",gap:"10px",marginBottom:"20px"},input:{flex:"1",padding:"10px 12px",borderRadius:"6px",border:"1px solid #e2e8f0",fontSize:"14px"},select:{padding:"10px 12px",borderRadius:"6px",border:"1px solid #e2e8f0",fontSize:"14px",backgroundColor:"#fff"},tableContainer:{overflowX:"auto",backgroundColor:"#ffffff",borderRadius:"8px",boxShadow:"0 2px 5px rgba(0,0,0,0.05)"},table:{width:"100%",borderCollapse:"collapse",fontSize:"14px"},tableHeader:{backgroundColor:"#f8fafc",color:"#4a5568",textAlign:"left",padding:"12px 15px",fontWeight:"bold",borderBottom:"2px solid #e2e8f0",cursor:"pointer",transition:"background-color 0.2s",position:"sticky",top:0},tableCell:{padding:"12px 15px",borderBottom:"1px solid #e2e8f0",color:"#2d3748",whiteSpace:"nowrap"},pagination:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"15px 0",fontSize:"14px"},pageButton:{padding:"6px 12px",margin:"0 4px",backgroundColor:"#f1f5f9",border:"none",borderRadius:"4px",cursor:"pointer",transition:"background-color 0.2s",fontSize:"13px"},activePageButton:{backgroundColor:"#3182ce",color:"#ffffff"},textCenter:{textAlign:"center"},badge:{display:"inline-block",padding:"3px 8px",borderRadius:"12px",fontSize:"12px",fontWeight:"bold",textAlign:"center"},badgePrimary:{backgroundColor:"#ebf5ff",color:"#3182ce"},badgeSuccess:{backgroundColor:"#e6fffa",color:"#38b2ac"},badgeWarning:{backgroundColor:"#fffaf0",color:"#dd6b20"},badgeReasignado:{backgroundColor:"#fef0f5",color:"#d53f8c",border:"1px dashed #d53f8c"},infoRow:{marginBottom:"15px",backgroundColor:"#f8fafc",borderRadius:"6px",padding:"10px 15px",fontSize:"14px",color:"#4a5568",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},orderContainer:{display:"flex",alignItems:"center",gap:"8px"},orderBadge:{color:"#000",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"16px",fontWeight:"bold"},sortIcon:{marginLeft:"4px",display:"inline-block",fontSize:"10px"},leyendaContainer:{marginTop:"20px",padding:"15px",backgroundColor:"#ffffff",borderRadius:"8px",boxShadow:"0 2px 5px rgba(0,0,0,0.05)",fontSize:"13px"},leyendaTitle:{fontSize:"14px",fontWeight:"bold",marginBottom:"10px"},leyendaItems:{display:"flex",flexWrap:"wrap",gap:"15px"},leyendaItem:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"}},E={total:m.length,centros:[...new Set(m.map((e=>e.nombreCentro||e.centro)))].length,reasignados:m.filter((e=>e.reasignado)).length},_=["TODOS",...new Set(m.filter((e=>e.estado)).map((e=>e.estado)))];return(0,$v.jsxs)("div",{style:S.container,children:[(0,$v.jsx)("div",{style:S.infoContainer,children:(0,$v.jsxs)("div",{style:S.statsContainer,children:[(0,$v.jsxs)("div",{style:S.statCard,children:[(0,$v.jsx)("div",{style:S.statValue,children:E.total}),(0,$v.jsx)("div",{style:S.statLabel,children:"Asignaciones totales"})]}),(0,$v.jsxs)("div",{style:S.statCard,children:[(0,$v.jsx)("div",{style:S.statValue,children:E.centros}),(0,$v.jsx)("div",{style:S.statLabel,children:"Centros con asignaciones"})]}),(0,$v.jsxs)("div",{style:S.statCard,children:[(0,$v.jsx)("div",{style:S.statValue,children:E.reasignados}),(0,$v.jsx)("div",{style:S.statLabel,children:"Reasignaciones"})]})]})}),(()=>{const e=t.reduce(((e,t)=>{if(!t)return e;const n=t.centerId||t.id;return n?(e[n]||(e[n]={id:n,centro:t.nombreCentro||t.centro||"Centro desconocido",count:0,plazas:0}),e[n].count++,e):e}),{});for(const t in e){const r=n.find((e=>e.id===t));r&&(e[t].plazas=r.plazas||0)}const r=Object.values(e).filter((e=>e.count>e.plazas&&e.plazas>0));return r.length>0?(0,$v.jsxs)("div",{style:{backgroundColor:"#fff5f5",borderLeft:"4px solid #e53e3e",borderRadius:"4px",padding:"12px 15px",marginBottom:"20px",fontSize:"14px",color:"#742a2a",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[(0,$v.jsx)("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"16px"},children:"\u26a0\ufe0f Se detectaron centros con exceso de asignaciones"}),(0,$v.jsx)("div",{style:{marginBottom:"10px"},children:"Los siguientes centros tienen m\xe1s asignaciones que plazas disponibles:"}),(0,$v.jsx)("ul",{style:{margin:"10px 0",paddingLeft:"25px"},children:r.map((e=>(0,$v.jsxs)("li",{style:{marginBottom:"5px"},children:[(0,$v.jsxs)("strong",{children:[e.centro,":"]})," ",e.count," asignaciones para ",e.plazas," plazas"]},e.id)))}),(0,$v.jsx)("div",{style:{marginTop:"10px",fontSize:"13px"},children:"Se recomienda ejecutar la verificaci\xf3n y correcci\xf3n autom\xe1tica de asignaciones."})]}):null})(),(0,$v.jsxs)("div",{style:S.searchBar,children:[(0,$v.jsx)("input",{type:"text",placeholder:"Buscar por n\xba de orden, centro, localidad...",value:i,onChange:e=>{o(e.target.value),d(1)},style:S.input}),(0,$v.jsx)("select",{value:s,onChange:e=>{a(e.target.value),d(1)},style:S.select,children:_.map((e=>(0,$v.jsx)("option",{value:e,children:"TODOS"===e?"Todos los estados":e},e)))})]}),(0,$v.jsx)("div",{style:S.tableContainer,children:(0,$v.jsxs)("table",{style:S.table,children:[(0,$v.jsx)("thead",{children:(0,$v.jsxs)("tr",{children:[(0,$v.jsx)("th",{style:S.tableHeader,onClick:()=>I("order"),children:(0,$v.jsxs)("div",{style:S.orderContainer,children:["N\xba Orden",(0,$v.jsx)("span",{style:S.sortIcon,children:"order"===f.key&&("asc"===f.direction?"\u25b2":"\u25bc")})]})}),(0,$v.jsxs)("th",{style:S.tableHeader,onClick:()=>I("centro"),children:["Centro",(0,$v.jsx)("span",{style:S.sortIcon,children:"centro"===f.key&&("asc"===f.direction?"\u25b2":"\u25bc")})]}),(0,$v.jsxs)("th",{style:S.tableHeader,onClick:()=>I("localidad"),children:["Localidad/Municipio",(0,$v.jsx)("span",{style:S.sortIcon,children:"localidad"===f.key&&("asc"===f.direction?"\u25b2":"\u25bc")})]}),(0,$v.jsxs)("th",{style:S.tableHeader,onClick:()=>I("timestamp"),children:["Fecha",(0,$v.jsx)("span",{style:S.sortIcon,children:"timestamp"===f.key&&("asc"===f.direction?"\u25b2":"\u25bc")})]})]})}),(0,$v.jsxs)("tbody",{children:[w.map(((e,t)=>(0,$v.jsxs)("tr",{style:e.reasignado?{backgroundColor:"#fff9fb"}:{},children:[(0,$v.jsx)("td",{style:S.tableCell,children:(0,$v.jsx)("div",{style:S.orderContainer,children:(0,$v.jsx)("div",{style:S.orderBadge,children:e.numeroOrden||e.order})})}),(0,$v.jsx)("td",{style:S.tableCell,children:(0,$v.jsxs)("div",{children:[(0,$v.jsx)("strong",{children:e.nombreCentro||e.centerName||e.centro}),e.reasignado&&(0,$v.jsxs)("div",{style:{fontSize:"12px",color:"#d53f8c",marginTop:"4px"},children:["Reasignado de: ",e.centroOriginal||e.centroPrevio]})]})}),(0,$v.jsxs)("td",{style:S.tableCell,children:[e.localidad||"",e.municipio&&(!e.localidad||e.municipio!==e.localidad)&&(0,$v.jsx)("div",{style:{color:"#718096",fontSize:"12px"},children:e.municipio})]}),(0,$v.jsx)("td",{style:S.tableCell,children:g(e.timestamp)})]},e.docId||t))),0===w.length&&(0,$v.jsx)("tr",{children:(0,$v.jsx)("td",{colSpan:"5",style:{...S.tableCell,textAlign:"center",padding:"30px 15px"},children:"No se encontraron asignaciones que coincidan con los filtros."})})]})]})}),y>1&&(0,$v.jsxs)("div",{style:S.pagination,children:[(0,$v.jsxs)("div",{children:["Mostrando ",b+1,"-",Math.min(v,m.length)," de ",m.length]}),(0,$v.jsxs)("div",{children:[(0,$v.jsx)("button",{style:S.pageButton,onClick:()=>x(1),disabled:1===u,children:"\xab"}),(0,$v.jsx)("button",{style:S.pageButton,onClick:()=>x(u-1),disabled:1===u,children:"\u2039"}),Array.from({length:Math.min(5,y)},((e,t)=>{let n;return n=y<=5||u<=3?t+1:u>=y-2?y-4+t:u-2+t,(0,$v.jsx)("button",{style:{...S.pageButton,...u===n?S.activePageButton:{}},onClick:()=>x(n),children:n},n)})),(0,$v.jsx)("button",{style:S.pageButton,onClick:()=>x(u+1),disabled:u===y,children:"\u203a"}),(0,$v.jsx)("button",{style:S.pageButton,onClick:()=>x(y),disabled:u===y,children:"\xbb"})]})]})]})},qv=e=>{let{availablePlazas:t=[],assignments:n=[],searchTerm:i="",setSearchTerm:o,orderNumber:s,setOrderNumber:a,centrosSeleccionados:l=[],setCentrosSeleccionados:c,handleOrderSubmit:u,isProcessing:d=!1}=e;const[h,f]=(0,r.useState)(""),[p,g]=(0,r.useState)(1),[m,y]=(0,r.useState)(10),[v,b]=(0,r.useState)("undefined"!==typeof window?window.innerWidth:1200),[w,x]=(0,r.useState)(null),[I,S]=(0,r.useState)(""),[E,_]=(0,r.useState)(""),[T,k]=(0,r.useState)(""),[C,N]=(0,r.useState)(null);(0,r.useEffect)((()=>{o&&a&&c&&u||console.error("PlazasDisponibles: Faltan funciones de callback requeridas")}),[o,a,c,u]),(0,r.useEffect)((()=>{const e=()=>{b(window.innerWidth)};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]);const A=v<768,D=e=>{const n=new Set;return t.forEach((t=>{t[e]&&n.add(t[e])})),Array.from(n).sort()},P=D("asi"),R=D("departamento"),O=D("municipio"),L=[...t.filter((e=>{if(i){const t=i.toLowerCase();if(!(e.centro&&e.centro.toLowerCase().includes(t)||e.nombre&&e.nombre.toLowerCase().includes(t)||e.nombreCentro&&e.nombreCentro.toLowerCase().includes(t)||e.localidad&&e.localidad.toLowerCase().includes(t)||e.municipio&&e.municipio.toLowerCase().includes(t)||e.codigo&&e.codigo.toLowerCase().includes(t)||e.asi&&e.asi.toLowerCase().includes(t)||e.departamento&&e.departamento.toLowerCase().includes(t)))return!1}return(!I||e.asi===I)&&(!E||e.departamento===E)&&(!T||e.municipio===T)}))].sort(((e,t)=>{var n;const r=e.plazas-(e.asignadas||0),i=t.plazas-(t.asignadas||0);return 0===i&&r>0?-1:0===r&&i>0?1:r!==i?i-r:(null===(n=e.centro)||void 0===n?void 0:n.localeCompare(t.centro||""))||0})),M=Math.ceil(L.length/m),j=p*m,z=j-m,F=L.slice(z,j),V=t.reduce(((e,t)=>e+(t.plazas||0)),0),U=(t.reduce(((e,t)=>e+(t.asignadas||0)),0),()=>{x(null)}),$=e=>{try{const t=Number(e.target.value);if(!t||isNaN(t))return void console.error("ID de centro inv\xe1lido:",e.target.value);e.target.checked?l.includes(t)||c((e=>[...e,t])):c((e=>e.filter((e=>e!==t))))}catch(h){console.error("Error al seleccionar centro:",h)}};return(0,$v.jsxs)("div",{className:"plazas-container",children:[C&&(0,$v.jsx)("div",{className:`submit-message ${C.type}`,style:{padding:"10px 15px",margin:"10px 0",borderRadius:"4px",backgroundColor:"success"===C.type?"#d4edda":"#f8d7da",color:"success"===C.type?"#155724":"#721c24",border:"1px solid "+("success"===C.type?"#c3e6cb":"#f5c6cb")},children:C.message}),(0,$v.jsxs)("div",{style:{marginBottom:"25px",padding:"20px",backgroundColor:"#f8f9fa",borderRadius:"8px",border:"1px solid #e9ecef",boxShadow:"0 2px 8px rgba(0,0,0,0.05)"},children:[(0,$v.jsx)("h3",{style:{fontSize:"18px",color:"#343a40",marginTop:0,marginBottom:"15px",borderBottom:"2px solid #e9ecef",paddingBottom:"10px"},children:"Solicitar una plaza"}),(0,$v.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),f(""),!s)return void f("Por favor ingrese un n\xfamero de orden");if(!l.length)return void f("Por favor seleccione al menos un centro");const n=l.filter((e=>{const n=t.find((t=>t.id===e));return!n||n.plazas<=n.asignadas}));n.length>0?f("Algunos centros seleccionados ya no tienen plazas disponibles"):u(s,l)},children:[(0,$v.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,$v.jsx)("label",{htmlFor:"orderNumber",style:{display:"block",marginBottom:"8px",fontWeight:"bold",color:"#495057"},children:"N\xfamero de Orden:"}),(0,$v.jsx)("input",{type:"number",id:"orderNumber",value:s,onChange:e=>{const t=e.target.value;if(f(""),""===t)return void a("");const n=Number(t);isNaN(n)?f("Por favor ingrese un n\xfamero v\xe1lido"):n<1?f("El n\xfamero de orden debe ser mayor a 0"):Number.isInteger(n)?a(n):f("El n\xfamero de orden debe ser un n\xfamero entero")},style:{width:"100%",padding:"12px 15px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"16px",boxShadow:"inset 0 1px 3px rgba(0,0,0,0.05)"},required:!0,placeholder:"Introduce tu n\xfamero de orden"})]}),(0,$v.jsxs)("div",{style:{padding:"12px 15px",backgroundColor:"#e6f7ff",border:"1px solid #91d5ff",borderRadius:"6px",marginBottom:"15px",fontSize:"14px",color:"#1890ff",display:"flex",alignItems:"flex-start",gap:"10px"},children:[(0,$v.jsx)("span",{style:{fontSize:"18px"},children:"\u2139\ufe0f"}),(0,$v.jsxs)("div",{children:[(0,$v.jsx)("strong",{children:"Informaci\xf3n importante:"})," Puedes solicitar plazas aunque aparezcan como completas. El sistema asignar\xe1 las plazas priorizando por n\xfamero de orden (menor n\xfamero = mayor prioridad), incluso si la plaza ya est\xe1 asignada a alguien con un n\xfamero de orden mayor."]})]}),(0,$v.jsxs)("div",{style:{padding:"10px 15px",backgroundColor:"#e9f5fe",borderRadius:"6px",marginBottom:"20px",fontSize:"14px",borderLeft:"4px solid #3498db"},children:[(0,$v.jsx)("strong",{children:"Importante:"})," Selecciona tus centros por orden de preferencia. El primer centro que selecciones ser\xe1 tu primera opci\xf3n."]}),l.length>0&&(0,$v.jsxs)("div",{style:{marginBottom:"20px",padding:"15px",backgroundColor:"#e8f5e9",borderRadius:"6px",border:"1px solid #c8e6c9"},children:[(0,$v.jsx)("strong",{style:{color:"#2E7D32"},children:"Centros seleccionados en orden de preferencia:"}),(0,$v.jsx)("ol",{style:{paddingLeft:"25px",marginTop:"10px",marginBottom:"0",color:"#333"},children:l.map(((e,n)=>{const r=t.find((t=>t.id===e));return r?(0,$v.jsxs)("li",{style:{marginBottom:"8px"},children:[(0,$v.jsx)("strong",{children:r.nombre||r.nombreCentro||r.centro}),(0,$v.jsxs)("span",{style:{color:"#555"},children:["(",r.municipio,")"]}),0===n&&(0,$v.jsx)("span",{style:{display:"inline-block",marginLeft:"8px",fontSize:"12px",color:"#d35400",backgroundColor:"#fff3cd",padding:"1px 5px",borderRadius:"10px",fontWeight:"bold"},children:"1\xaa opci\xf3n"})]},e):null}))}),(0,$v.jsx)("div",{style:{marginTop:"10px",textAlign:"right"},children:(0,$v.jsx)("button",{type:"button",onClick:()=>c([]),style:{padding:"6px 12px",backgroundColor:"#f8d7da",color:"#721c24",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"13px"},children:"Limpiar selecci\xf3n"})})]}),(0,$v.jsx)("div",{style:{textAlign:"center"},children:(0,$v.jsx)("button",{type:"submit",disabled:d||0===l.length,style:{padding:"12px 25px",backgroundImage:d?"linear-gradient(to right, #cccccc, #dddddd)":"linear-gradient(to right, #3498db, #2980b9)",color:"white",border:"none",borderRadius:"6px",cursor:d||0===l.length?"not-allowed":"pointer",display:"inline-flex",alignItems:"center",justifyContent:"center",fontSize:"16px",fontWeight:"500",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:d?(0,$v.jsxs)($v.Fragment,{children:[(0,$v.jsx)("span",{style:{display:"inline-block",width:"18px",height:"18px",border:"3px solid rgba(255,255,255,0.3)",borderRadius:"50%",borderTopColor:"white",animation:"spin 1s linear infinite",marginRight:"10px"}}),"Procesando..."]}):(0,$v.jsx)($v.Fragment,{children:"Solicitar Plaza"})})})]})]}),(0,$v.jsxs)("div",{className:"search-container",children:[(0,$v.jsx)("input",{type:"text",className:"search-box",placeholder:"Buscar por centro, municipio o c\xf3digo...",value:i,onChange:e=>{o(e.target.value),g(1)}}),i&&(0,$v.jsx)("button",{className:"clear-search",onClick:()=>o(""),children:"\xd7"})]}),(0,$v.jsxs)("div",{className:"filters-container",children:[(0,$v.jsxs)("select",{className:"filter-select",value:I,onChange:e=>{S(e.target.value),g(1)},children:[(0,$v.jsx)("option",{value:"",children:"Todos los ASI"}),P.map((e=>(0,$v.jsx)("option",{value:e,children:e},e)))]}),(0,$v.jsxs)("select",{className:"filter-select",value:E,onChange:e=>{_(e.target.value),g(1)},children:[(0,$v.jsx)("option",{value:"",children:"Todos los departamentos"}),R.map((e=>(0,$v.jsx)("option",{value:e,children:e},e)))]}),(0,$v.jsxs)("select",{className:"filter-select",value:T,onChange:e=>{k(e.target.value),g(1)},children:[(0,$v.jsx)("option",{value:"",children:"Todos los municipios"}),O.map((e=>(0,$v.jsx)("option",{value:e,children:e},e)))]}),(0,$v.jsxs)("select",{className:"filter-select",value:m,onChange:e=>{y(Number(e.target.value)),g(1)},children:[(0,$v.jsx)("option",{value:10,children:"10 por p\xe1gina"}),(0,$v.jsx)("option",{value:25,children:"25 por p\xe1gina"}),(0,$v.jsx)("option",{value:50,children:"50 por p\xe1gina"}),(0,$v.jsx)("option",{value:100,children:"100 por p\xe1gina"})]})]}),(0,$v.jsxs)("div",{className:"results-info",children:[(0,$v.jsxs)("span",{children:["Mostrando ",F.length," de ",L.length," centros"]}),(0,$v.jsxs)("span",{children:["Total plazas: ",V]})]}),(0,$v.jsx)("div",{className:"plazas-grid",children:0===L.length?(0,$v.jsxs)("div",{className:"empty-state",children:[(0,$v.jsx)("div",{className:"empty-icon",children:"\ud83d\udd0d"}),(0,$v.jsx)("p",{children:"No se encontraron plazas con los criterios seleccionados."}),(0,$v.jsx)("button",{className:"reset-filters",onClick:()=>{o(""),g(1)},children:"Limpiar filtros"})]}):(0,$v.jsxs)("table",{className:"tabla-plazas",children:[(0,$v.jsx)("thead",{children:(0,$v.jsxs)("tr",{children:[(0,$v.jsx)("th",{style:{width:"60px"}}),(0,$v.jsx)("th",{children:"C\xf3digo"}),(0,$v.jsx)("th",{className:"centro-column",children:"Centro"}),(0,$v.jsx)("th",{children:"Municipio"}),(0,$v.jsx)("th",{children:"Plazas"}),v<768&&(0,$v.jsx)("th",{style:{width:"40px"},children:"Info"})]})}),(0,$v.jsx)("tbody",{children:F.map(((e,t)=>{const n=Math.max(0,e.plazas-(e.asignadas||0)),r=l.includes(e.id);let i=t%2===0?"white":"#f9f9f9";r?i="#e6f7ff":0===n?i="#ffe6e6":n<=2&&(i="#fff3cd");const o=e.docId||`plaza-${e.id}-${t}`;return(0,$v.jsxs)("tr",{style:{backgroundColor:i,transition:"background-color 0.2s ease"},onClick:()=>{A&&(r?c(l.filter((t=>t!==e.id))):l.includes(e.id)||c([...l,e.id]))},children:[(0,$v.jsx)("td",{children:(0,$v.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px",justifyContent:"center"},children:[(0,$v.jsx)("input",{type:"checkbox",id:`plaza-${e.id}`,value:e.id,onChange:$,checked:l.includes(e.id),style:{width:"20px",height:"20px",cursor:"pointer"}}),l.includes(e.id)&&(0,$v.jsx)("span",{style:{backgroundImage:"linear-gradient(135deg, #1976D2, #2196F3)",color:"white",borderRadius:"50%",width:"28px",height:"28px",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",fontSize:"14px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:l.indexOf(e.id)+1})]})}),(0,$v.jsx)("td",{children:e.codigo}),(0,$v.jsx)("td",{className:"centro-column",title:e.nombre||e.nombreCentro||e.centro,children:e.nombre||e.nombreCentro||e.centro}),(0,$v.jsx)("td",{children:e.municipio}),(0,$v.jsx)("td",{children:e.plazas}),v<768&&(0,$v.jsx)("td",{children:(0,$v.jsx)("button",{className:"info-button",onClick:t=>{t.stopPropagation(),(e=>{x({...e,disponibles:e.plazas-(e.asignadas||0)})})(e)},children:"\u2139\ufe0f"})})]},o)}))})]})}),L.length>0&&(0,$v.jsxs)("div",{className:"pagination",children:[(0,$v.jsx)("button",{className:"pagination-button",onClick:()=>g(1),disabled:1===p,children:"\xab\xab"}),(0,$v.jsx)("button",{className:"pagination-button",onClick:()=>g((e=>Math.max(1,e-1))),disabled:1===p,children:"\xab"}),(M<=5?Array.from({length:M},((e,t)=>t+1)):p<=3?[1,2,3,4,5]:p>=M-2?[M-4,M-3,M-2,M-1,M]:[p-2,p-1,p,p+1,p+2]).map((e=>(0,$v.jsx)("button",{className:"pagination-button "+(p===e?"active":""),onClick:()=>g(e),children:e},e))),(0,$v.jsx)("button",{className:"pagination-button",onClick:()=>g((e=>Math.min(M,e+1))),disabled:p===M,children:"\xbb"}),(0,$v.jsx)("button",{className:"pagination-button",onClick:()=>g(M),disabled:p===M,children:"\xbb\xbb"})]}),w&&(0,$v.jsx)("div",{className:"info-modal",children:(0,$v.jsxs)("div",{className:"info-content",children:[(0,$v.jsx)("h3",{children:"Informaci\xf3n del centro"}),(0,$v.jsxs)("p",{children:[(0,$v.jsx)("strong",{children:"Centro:"})," ",w.nombre||w.nombreCentro||w.centro]}),(0,$v.jsxs)("p",{children:[(0,$v.jsx)("strong",{children:"C\xf3digo:"})," ",w.codigo]}),(0,$v.jsxs)("p",{children:[(0,$v.jsx)("strong",{children:"Municipio:"})," ",w.municipio]}),(0,$v.jsxs)("p",{children:[(0,$v.jsx)("strong",{children:"Departamento:"})," ",w.departamento]}),(0,$v.jsxs)("p",{children:[(0,$v.jsx)("strong",{children:"ASI:"})," ",w.asi]}),(0,$v.jsxs)("p",{children:[(0,$v.jsx)("strong",{children:"Plazas disponibles:"})," ",w.disponibles]}),(0,$v.jsxs)("div",{className:"modal-footer",children:[(0,$v.jsx)("button",{className:"close-button",onClick:U,children:"Cerrar"}),(0,$v.jsx)("button",{className:"select-button",onClick:()=>{$({target:{value:w.id}}),U()},children:"Seleccionar"})]})]})}),(0,$v.jsx)("style",{children:"\n        .plazas-container {\n          background-color: white;\n          border-radius: 8px;\n          box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);\n          padding: 20px;\n          height: 100%;\n          display: flex;\n          flex-direction: column;\n          overflow: hidden;\n          max-width: 100%;\n          box-sizing: border-box;\n        }\n        \n        .search-container {\n          position: relative;\n          margin-bottom: 15px;\n          width: 100%;\n          max-width: 100%;\n          box-sizing: border-box;\n        }\n        \n        .search-box {\n          width: 100%;\n          padding: 14px 16px;\n          border: 2px solid #ddd;\n          border-radius: 6px;\n          font-size: 16px;\n          transition: border-color 0.3s;\n          box-sizing: border-box;\n          overflow: hidden;\n          text-overflow: ellipsis;\n        }\n        \n        .search-box:focus {\n          border-color: #1976d2;\n          outline: none;\n          box-shadow: 0 0 0 3px rgba(25, 118, 210, 0.2);\n        }\n        \n        .clear-search {\n          position: absolute;\n          right: 10px;\n          top: 50%;\n          transform: translateY(-50%);\n          background: none;\n          border: none;\n          font-size: 24px;\n          cursor: pointer;\n          color: #999;\n          padding: 5px;\n          line-height: 1;\n          z-index: 5;\n        }\n        \n        .clear-search:hover {\n          color: #333;\n        }\n        \n        .filters-container {\n          display: flex;\n          flex-wrap: wrap;\n          gap: 10px;\n          margin-bottom: 15px;\n          max-width: 100%;\n          box-sizing: border-box;\n        }\n        \n        .filter-select {\n          padding: 10px;\n          border: 1px solid #ddd;\n          border-radius: 4px;\n          min-width: 150px;\n          flex: 1 1 auto;\n          box-sizing: border-box;\n          max-width: 100%;\n        }\n        \n        @media (max-width: 768px) {\n          .filters-container {\n            flex-direction: column;\n            gap: 8px;\n          }\n          \n          .filter-select {\n            width: 100%;\n            min-width: auto;\n          }\n          \n          .search-box {\n            padding: 12px 14px;\n            font-size: 14px;\n          }\n          \n          .clear-search {\n            right: 5px;\n            font-size: 20px;\n          }\n        }\n        \n        .results-info {\n          display: flex;\n          justify-content: space-between;\n          margin-bottom: 10px;\n          font-size: 14px;\n          color: #555;\n          font-weight: 500;\n          flex-wrap: wrap;\n          width: 100%;\n          box-sizing: border-box;\n        }\n        \n        .plazas-grid {\n          overflow-y: auto;\n          height: 100%;\n          border: 1px solid #eee;\n          border-radius: 4px;\n          margin-bottom: 15px;\n          -webkit-overflow-scrolling: touch;\n        }\n        \n        .tabla-plazas {\n          width: 100%;\n          border-collapse: collapse;\n          table-layout: fixed;\n        }\n        \n        .tabla-plazas th {\n          background-color: #f5f5f5;\n          position: sticky;\n          top: 0;\n          padding: 12px 10px;\n          text-align: left;\n          border-bottom: 2px solid #ddd;\n          z-index: 10;\n          font-weight: 600;\n        }\n        \n        .tabla-plazas td {\n          padding: 12px 10px;\n          border-bottom: 1px solid #eee;\n          word-break: break-word;\n        }\n        \n        .centro-column {\n          max-width: 300px;\n          white-space: nowrap;\n          overflow: hidden;\n          text-overflow: ellipsis;\n        }\n        \n        .tabla-plazas tr:hover {\n          background-color: #f9f9f9;\n        }\n        \n        .selected-row {\n          background-color: #e3f2fd;\n        }\n        \n        .selected-row:hover {\n          background-color: #bbdefb;\n        }\n        \n        .empty-state {\n          display: flex;\n          flex-direction: column;\n          align-items: center;\n          justify-content: center;\n          padding: 40px 0;\n          text-align: center;\n          color: #757575;\n        }\n        \n        .empty-icon {\n          font-size: 48px;\n          margin-bottom: 20px;\n        }\n        \n        .reset-filters {\n          margin-top: 15px;\n          padding: 8px 16px;\n          background-color: #1976d2;\n          color: white;\n          border: none;\n          border-radius: 4px;\n          cursor: pointer;\n        }\n        \n        .pagination {\n          display: flex;\n          justify-content: center;\n          gap: 5px;\n          margin-top: 15px;\n          flex-wrap: wrap;\n        }\n        \n        .pagination-button {\n          padding: 8px 12px;\n          border: 1px solid #ddd;\n          background-color: white;\n          border-radius: 4px;\n          cursor: pointer;\n          transition: all 0.2s;\n        }\n        \n        .pagination-button.active {\n          background-color: #1976d2;\n          color: white;\n          border-color: #1976d2;\n        }\n        \n        .pagination-button:hover:not(:disabled) {\n          background-color: #f0f0f0;\n          border-color: #bbb;\n        }\n        \n        .pagination-button:disabled {\n          cursor: not-allowed;\n          opacity: 0.5;\n        }\n        \n        .info-button {\n          background: none;\n          border: none;\n          cursor: pointer;\n          font-size: 18px;\n          padding: 2px;\n        }\n        \n        .info-modal {\n          position: fixed;\n          top: 0;\n          left: 0;\n          right: 0;\n          bottom: 0;\n          background-color: rgba(0, 0, 0, 0.5);\n          display: flex;\n          justify-content: center;\n          align-items: center;\n          z-index: 1000;\n        }\n        \n        .info-content {\n          background-color: white;\n          border-radius: 8px;\n          padding: 20px;\n          width: 90%;\n          max-width: 500px;\n          max-height: 80vh;\n          overflow-y: auto;\n          box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);\n        }\n        \n        .info-content h3 {\n          margin-top: 0;\n          color: #1a237e;\n          border-bottom: 1px solid #eee;\n          padding-bottom: 10px;\n        }\n        \n        .modal-footer {\n          display: flex;\n          justify-content: flex-end;\n          gap: 10px;\n          margin-top: 20px;\n          border-top: 1px solid #eee;\n          padding-top: 15px;\n        }\n        \n        .close-button, .select-button {\n          padding: 8px 16px;\n          border-radius: 4px;\n          border: none;\n          cursor: pointer;\n        }\n        \n        .close-button {\n          background-color: #f5f5f5;\n          color: #333;\n        }\n        \n        .select-button {\n          background-color: #1976d2;\n          color: white;\n        }\n        \n        /* Dise\xf1o responsive */\n        @media (max-width: 768px) {\n          .plazas-container {\n            padding: 15px 10px;\n          }\n          \n          .filters-container {\n            flex-direction: column;\n            gap: 8px;\n          }\n          \n          .filter-select {\n            width: 100%;\n          }\n          \n          .tabla-plazas th, .tabla-plazas td {\n            padding: 10px 5px;\n            font-size: 13px;\n          }\n          \n          .tabla-plazas th:nth-child(1) {\n            width: 65px;\n          }\n          \n          .tabla-plazas th:nth-child(2) {\n            width: 60px;\n          }\n          \n          .tabla-plazas th:nth-child(4) {\n            width: 80px;\n          }\n          \n          .tabla-plazas th:nth-child(5) {\n            width: 45px;\n          }\n          \n          .centro-column {\n            max-width: 100px;\n          }\n          \n          .pagination-button {\n            padding: 6px 10px;\n            font-size: 13px;\n          }\n          \n          h2 {\n            font-size: 20px;\n            margin-top: 0;\n          }\n          \n          form > div {\n            margin-bottom: 10px !important;\n          }\n          \n          .search-box {\n            padding: 10px 12px;\n            font-size: 14px;\n          }\n        }\n        \n        /* Animaciones */\n        @keyframes spin {\n          0% { transform: rotate(0deg); }\n          100% { transform: rotate(360deg); }\n        }\n      "})]})},Hv=e=>{let{solicitudes:t=[],assignments:n=[],availablePlazas:i=[]}=e;const[o,s]=(0,r.useState)(1),[a,l]=(0,r.useState)(10),[c,u]=(0,r.useState)(""),[d,h]=(0,r.useState)(""),[f,p]=(0,r.useState)("undefined"!==typeof window?window.innerWidth:1200),[g,m]=(0,r.useState)({key:"orden",direction:"asc"});if((0,r.useEffect)((()=>Array.isArray(t)?Array.isArray(n)?Array.isArray(i)?void h(""):(h("Error: Las plazas disponibles no son v\xe1lidas"),void console.error("SolicitudesPendientes: availablePlazas debe ser un array")):(h("Error: Las asignaciones no son v\xe1lidas"),void console.error("SolicitudesPendientes: assignments debe ser un array")):(h("Error: Las solicitudes no son v\xe1lidas"),void console.error("SolicitudesPendientes: solicitudes debe ser un array"))),[t,n,i]),(0,r.useEffect)((()=>{const e=()=>{p(window.innerWidth)};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),d)return(0,$v.jsx)("div",{style:{textAlign:"center",padding:"20px",backgroundColor:"#fff3cd",borderRadius:"8px",color:"#856404",margin:"20px 0"},children:(0,$v.jsx)("p",{children:d})});const y=f<768,v=(b=(Array.isArray(t)?t:[]).filter((e=>!!e&&(void 0===e.orden||null===e.orden?(console.warn("Solicitud sin n\xfamero de orden:",e),!1):!(!Array.isArray(e.centrosIds)&&!Array.isArray(e.centrosSeleccionados))||(console.warn("Solicitud sin centros seleccionados:",e),!1)))).filter((e=>{var t;const n=[null===(t=e.orden)||void 0===t?void 0:t.toString(),...(e.centrosIds||e.centrosSeleccionados||[]).map((e=>{const t=i.find((t=>t.id===e));return t?[t.nombre||t.nombreCentro||t.centro,t.localidad,t.municipio]:[]})).flat()].filter(Boolean);return n.some((e=>e.toLowerCase().includes(c.toLowerCase())))})),b&&Array.isArray(b)?[...b].sort(((e,t)=>{if(!e||!t)return 0;let n=e[g.key],r=t[g.key];return"orden"===g.key&&(n=Number(n)||0,r=Number(r)||0),n<r?"asc"===g.direction?-1:1:n>r?"asc"===g.direction?1:-1:0})):[]);var b;const w=Math.ceil(v.length/a),x=o*a,I=x-a,S=v.slice(I,x),E=e=>{e<1||e>w||s(e)};return t.length?(0,$v.jsxs)("div",{children:[(0,$v.jsxs)("div",{style:{marginBottom:"15px",fontSize:"14px",padding:"12px 15px",backgroundColor:"#fff7f0",borderRadius:"6px",borderLeft:"4px solid #d35400",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:["A continuaci\xf3n se muestran las solicitudes pendientes con sus preferencias de centros en orden.",(0,$v.jsx)("p",{style:{color:"#d35400",fontWeight:"bold",marginTop:"8px",marginBottom:"0"},children:"\u26a0\ufe0f Las solicitudes se procesan por orden de prioridad (n\xfamero de orden menor = mayor prioridad)"})]}),(0,$v.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,$v.jsxs)("div",{style:{marginBottom:"10px",position:"relative"},children:[(0,$v.jsx)("input",{type:"text",placeholder:"Buscar por n\xfamero de orden o centro...",value:c,onChange:e=>{u(e.target.value),s(1)},style:{padding:"12px 15px",paddingLeft:"40px",border:"1px solid #ddd",borderRadius:"6px",width:"100%",fontSize:"16px",boxShadow:"inset 0 1px 3px rgba(0,0,0,0.05)"}}),(0,$v.jsx)("div",{style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",color:"#666",fontSize:"18px"},children:"\ud83d\udd0d"})]}),(0,$v.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"10px"},children:[(0,$v.jsxs)("div",{style:{marginBottom:"10px",fontSize:"14px",color:"#666"},children:["Mostrando ",(0,$v.jsxs)("strong",{children:[v.length>0?I+1:0,"-",Math.min(x,v.length)]})," de ",(0,$v.jsx)("strong",{children:v.length})," solicitudes",c&&` (filtradas de ${t.length})`]}),(0,$v.jsx)("div",{children:(0,$v.jsxs)("select",{value:a,onChange:e=>{l(Number(e.target.value)),s(1)},style:{padding:"8px 12px",border:"1px solid #ddd",borderRadius:"6px",backgroundColor:"white",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:[(0,$v.jsx)("option",{value:10,children:"10 por p\xe1gina"}),(0,$v.jsx)("option",{value:25,children:"25 por p\xe1gina"}),(0,$v.jsx)("option",{value:50,children:"50 por p\xe1gina"}),(0,$v.jsx)("option",{value:v.length,children:"Ver todas"})]})})]})]}),y&&(0,$v.jsx)("div",{style:{marginBottom:"15px",fontSize:"13px",color:"#666",textAlign:"center",backgroundColor:"#fff3cd",padding:"8px",borderRadius:"4px"},children:"\u2190 Desliza para ver la tabla completa \u2192"}),(0,$v.jsx)("div",{style:{overflowX:"auto",border:"1px solid #e1e8f0",borderRadius:"6px",WebkitOverflowScrolling:"touch"},children:(0,$v.jsxs)("table",{className:"responsive-table",style:{width:"100%",borderCollapse:"collapse",minWidth:y?"768px":"auto"},children:[(0,$v.jsx)("thead",{children:(0,$v.jsxs)("tr",{style:{backgroundImage:"linear-gradient(to right, #fef5ec, #fde4ce)",position:"sticky",top:0,zIndex:5},children:[(0,$v.jsx)("th",{style:{border:"1px solid #ddd",padding:"12px 15px",textAlign:"left",color:"#d35400"},children:"N\xba Orden"}),(0,$v.jsx)("th",{style:{border:"1px solid #ddd",padding:"12px 15px",textAlign:"left",color:"#d35400"},children:"Fecha/Hora"}),(0,$v.jsx)("th",{style:{border:"1px solid #ddd",padding:"12px 15px",textAlign:"left",color:"#d35400"},children:"Centros Seleccionados (en orden de preferencia)"}),(0,$v.jsx)("th",{style:{border:"1px solid #ddd",padding:"12px 15px",textAlign:"center",color:"#d35400"},children:"Estado"})]})}),(0,$v.jsxs)("tbody",{children:[S.map(((e,t)=>{const r=new Date(e.timestamp),o=`${r.toLocaleDateString()} ${r.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`,s=n.some((t=>t.order===e.orden)),a=n.find((t=>t.order===e.orden)),l=s?"#e8f5e9":t%2===0?"white":"#fef9f4";return(0,$v.jsxs)("tr",{style:{backgroundColor:l,opacity:s?.8:1,transition:"background-color 0.2s ease"},children:[(0,$v.jsxs)("td",{style:{border:"1px solid #ddd",padding:"12px 15px",fontWeight:"bold",backgroundColor:e.orden<=50?"#fff3cd":"inherit"},children:[e.orden,e.orden<=50&&(0,$v.jsx)("span",{style:{display:"inline-block",marginLeft:"8px",fontSize:"12px",color:"#856404",backgroundColor:"#fff3cd",padding:"2px 6px",borderRadius:"12px",boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},children:"Alta prioridad"})]}),(0,$v.jsx)("td",{style:{border:"1px solid #ddd",padding:"12px 15px"},children:o}),(0,$v.jsx)("td",{style:{border:"1px solid #ddd",padding:"12px 15px"},children:(0,$v.jsx)("ol",{style:{margin:"0",paddingLeft:"20px"},children:Array.isArray((null===e||void 0===e?void 0:e.centrosIds)||(null===e||void 0===e?void 0:e.centrosSeleccionados))?((null===e||void 0===e?void 0:e.centrosIds)||(null===e||void 0===e?void 0:e.centrosSeleccionados)||[]).map(((e,t)=>{const n=e&&i&&Array.isArray(i)?i.find((t=>t&&t.id===e)):null,r=a&&a.id===e;return(0,$v.jsx)("li",{style:{marginBottom:"8px",backgroundColor:r?"#f1f8e9":"transparent",padding:r?"4px 8px":"0",borderRadius:r?"4px":"0",border:r?"1px solid #c8e6c9":"none"},children:n?(0,$v.jsxs)($v.Fragment,{children:[(0,$v.jsx)("strong",{style:{color:0===t?"#d35400":"inherit"},children:n.nombre||n.nombreCentro||n.centro}),(0,$v.jsxs)("div",{className:"centro-localidad",children:[n.localidad&&`- ${n.localidad}`,n.municipio&&n.municipio!==n.localidad&&(0,$v.jsx)("span",{style:{marginLeft:"5px"},children:`(${n.municipio})`})]}),0===t&&(0,$v.jsx)("span",{style:{display:"inline-block",marginLeft:"8px",fontSize:"12px",color:"#d35400",backgroundColor:"#fff3cd",padding:"1px 5px",borderRadius:"10px",fontWeight:"bold"},children:"1\xaa opci\xf3n"}),n.plazas&&void 0!==n.asignadas&&n.plazas-n.asignadas<=0&&!r&&(0,$v.jsx)("span",{style:{color:"#e74c3c",marginLeft:"10px",fontSize:"12px",fontWeight:"bold",backgroundColor:"#ffebee",padding:"1px 6px",borderRadius:"10px"},children:"Completo"}),r&&(0,$v.jsx)("span",{style:{color:"#2E7D32",marginLeft:"10px",fontSize:"12px",fontWeight:"bold",backgroundColor:"#e8f5e9",padding:"1px 6px",borderRadius:"10px"},children:"\u2713 Asignado"})]}):(0,$v.jsxs)("span",{style:{color:"#999"},children:["Centro no disponible",(0,$v.jsxs)("small",{style:{display:"block",fontSize:"11px",marginTop:"2px"},children:["Este centro ya no est\xe1 disponible o ha cambiado su ID: ",e]})]})},t)})):(0,$v.jsx)("li",{children:"No hay centros seleccionados"})})}),(0,$v.jsx)("td",{style:{border:"1px solid #ddd",padding:"12px 15px",textAlign:"center"},children:s?(0,$v.jsx)("div",{style:{backgroundColor:"#e8f5e9",color:"#2E7D32",padding:"8px 12px",borderRadius:"6px",fontSize:"14px",fontWeight:"bold",border:"1px solid #c8e6c9",display:"inline-block"},children:"\u2713 Asignado"}):(0,$v.jsx)("div",{style:{backgroundColor:"#fff7e6",color:"#f39c12",padding:"8px 12px",borderRadius:"6px",fontSize:"14px",fontWeight:"bold",border:"1px solid #ffeeba",display:"inline-block"},children:"Pendiente"})})]},t)})),0===S.length&&(0,$v.jsx)("tr",{children:(0,$v.jsx)("td",{colSpan:"4",style:{textAlign:"center",padding:"30px",color:"#666"},children:c?`No se encontraron solicitudes que coincidan con "${c}"`:"No hay solicitudes pendientes para mostrar"})})]})]})}),v.length>a&&(0,$v.jsxs)("div",{style:{display:"flex",justifyContent:"center",marginTop:"20px",gap:"5px",flexWrap:"wrap"},children:[(0,$v.jsx)("button",{onClick:()=>E(o-1),disabled:1===o,style:{padding:"8px 12px",backgroundColor:1===o?"#f1f1f1":"white",border:"1px solid #ddd",borderRadius:"4px",cursor:1===o?"not-allowed":"pointer"},children:"\xab Anterior"}),Array.from({length:Math.min(5,w)},((e,t)=>{let n;return n=w<=5||o<=3?t+1:o>=w-2?w-4+t:o-2+t,(0,$v.jsx)("button",{onClick:()=>E(n),style:{padding:"8px 12px",backgroundColor:o===n?"#e67e22":"white",color:o===n?"white":"#333",border:"1px solid #ddd",borderRadius:"4px",cursor:"pointer"},children:n},n)})),(0,$v.jsx)("button",{onClick:()=>E(o+1),disabled:o===w,style:{padding:"8px 12px",backgroundColor:o===w?"#f1f1f1":"white",border:"1px solid #ddd",borderRadius:"4px",cursor:o===w?"not-allowed":"pointer"},children:"Siguiente \xbb"})]})]}):(0,$v.jsxs)("div",{style:{textAlign:"center",padding:"40px 20px",backgroundColor:"#f5f7fa",borderRadius:"8px",color:"#5c6c7c"},children:[(0,$v.jsx)("div",{style:{fontSize:"36px",marginBottom:"15px"},children:"\ud83d\udcdd"}),(0,$v.jsx)("div",{style:{fontSize:"18px",fontWeight:"bold",marginBottom:"10px"},children:"No hay solicitudes pendientes"}),(0,$v.jsx)("div",{style:{fontSize:"14px"},children:'Las solicitudes aparecer\xe1n aqu\xed cuando se env\xeden desde la pesta\xf1a "Plazas Disponibles"'})]})};const Kv=function(){return(0,$v.jsxs)("div",{style:{marginTop:"40px",marginBottom:"20px",padding:"15px",borderTop:"1px solid #eee",textAlign:"center",color:"#666",fontSize:"14px"},children:[(0,$v.jsxs)("p",{children:["Realizado por ",(0,$v.jsx)("a",{href:"https://ag-marketing.es",target:"_blank",rel:"noopener noreferrer",style:{color:"#18539E",textDecoration:"none",fontWeight:"bold"},children:"AG-Marketing"})]}),(0,$v.jsxs)("p",{children:["\xa9 ",(new Date).getFullYear()," - Todos los derechos reservados"]})]})},Wv=e=>{let{assignments:t=[],availablePlazas:n=[],solicitudes:i=[],procesarTodasLasSolicitudes:o,procesarSolicitudesPorMinuto:s,cargarDatosDesdeFirebase:a,eliminarSolicitudesDuplicadas:l,limpiarDuplicadosHistorial:c,db:u,loadingProcess:d,processingMessage:h,showNotification:f,lastProcessed:p,procesarSolicitudes:g}=e;const[m,y]=(0,r.useState)(!1),[v,b]=(0,r.useState)(!1),[w,x]=(0,r.useState)(""),[I,S]=(0,r.useState)(""),[E,_]=(0,r.useState)(""),[T,k]=(0,r.useState)("");if(!m)return(0,$v.jsxs)("div",{style:{maxWidth:"1280px",margin:"0 auto",padding:"20px",fontFamily:"Arial, sans-serif",display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",flexDirection:"column"},children:[(0,$v.jsx)("h1",{style:{marginBottom:"30px",color:"#2c3e50"},children:"Panel de Administraci\xf3n"}),(0,$v.jsxs)("div",{style:{backgroundColor:"white",padding:"30px",borderRadius:"10px",boxShadow:"0 4px 15px rgba(0,0,0,0.1)",width:"100%",maxWidth:"400px"},children:[(0,$v.jsx)("h2",{style:{textAlign:"center",marginBottom:"25px"},children:"Autenticaci\xf3n Requerida"}),v&&(0,$v.jsx)("div",{style:{backgroundColor:"#f8d7da",color:"#721c24",padding:"10px",borderRadius:"5px",marginBottom:"15px",textAlign:"center"},children:"Contrase\xf1a incorrecta. Int\xe9ntalo de nuevo."}),(0,$v.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,$v.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"bold"},children:"Contrase\xf1a de Administrador:"}),(0,$v.jsx)("input",{type:"password",value:w,onChange:e=>x(e.target.value),style:{width:"100%",padding:"12px",border:"1px solid #ddd",borderRadius:"5px",fontSize:"16px"},placeholder:"Ingrese la contrase\xf1a",onKeyDown:e=>{"Enter"===e.key&&("SoyAdmin"===w?y(!0):b(!0))}})]}),(0,$v.jsx)("button",{onClick:()=>{"SoyAdmin"===w?y(!0):b(!0)},style:{width:"100%",padding:"12px",backgroundColor:"#3498db",color:"white",border:"none",borderRadius:"5px",fontSize:"16px",fontWeight:"bold",cursor:"pointer"},children:"Acceder"}),(0,$v.jsx)("div",{style:{marginTop:"20px",textAlign:"center"},children:(0,$v.jsx)("a",{href:"/",style:{color:"#3498db",textDecoration:"none"},children:"Volver a la p\xe1gina principal"})})]})]});return(0,$v.jsxs)("div",{style:{maxWidth:"1280px",margin:"0 auto",padding:"20px",fontFamily:"Arial, sans-serif"},children:[(0,$v.jsx)("h1",{style:{textAlign:"center",marginBottom:"20px"},children:"Panel de Administraci\xf3n"}),(0,$v.jsxs)("div",{style:{backgroundColor:"#f8f9fa",padding:"15px",borderRadius:"10px",marginBottom:"20px",textAlign:"center",border:"1px solid #e9ecef"},children:[(0,$v.jsx)("h3",{style:{marginTop:0,color:"#2c3e50"},children:"Bienvenido al Panel de Administraci\xf3n"}),(0,$v.jsx)("p",{children:"Desde aqu\xed puede gestionar las solicitudes pendientes sin que aparezca la pantalla de mantenimiento para los usuarios del sistema. Puede procesar todas las solicitudes a la vez o una por una."}),(0,$v.jsx)("p",{style:{fontWeight:"bold",color:"#3498db"},children:"El sistema procesa solicitudes por orden de prioridad, desplazando asignaciones si es necesario."})]}),(0,$v.jsxs)("div",{style:{backgroundColor:"white",padding:"20px",borderRadius:"10px",boxShadow:"0 2px 10px rgba(0,0,0,0.05)",marginBottom:"20px",display:"flex",flexDirection:"column",gap:"15px"},children:[(0,$v.jsx)("h2",{children:"Acciones de Administraci\xf3n"}),(0,$v.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"15px"},children:[(0,$v.jsxs)("button",{onClick:async()=>{await l(),await c(),f("Duplicados eliminados correctamente","success")},style:{padding:"15px 20px",backgroundColor:"#e74c3c",color:"white",border:"none",borderRadius:"5px",cursor:"pointer",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px"},disabled:d,children:[(0,$v.jsx)("span",{children:"\ud83d\uddd1\ufe0f"})," Eliminar Duplicados"]}),(0,$v.jsxs)("button",{onClick:()=>o({respetarAsignacionesExistentes:!1}),style:{padding:"15px 20px",backgroundColor:"#3498db",color:"white",border:"none",borderRadius:"5px",cursor:i.length>0?"pointer":"not-allowed",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",opacity:i.length>0?1:.6},disabled:0===i.length||d,children:[(0,$v.jsx)("span",{children:"\ud83d\udd04"})," Reasignar Plazas por Orden"]}),(0,$v.jsxs)("button",{onClick:s,style:{padding:"15px 20px",backgroundColor:"#2ecc71",color:"white",border:"none",borderRadius:"5px",cursor:i.length>0?"pointer":"not-allowed",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",opacity:i.length>0?1:.6},disabled:0===i.length||d,children:[(0,$v.jsx)("span",{children:"\u25b6\ufe0f"})," Procesar Siguiente Solicitud"]})]})]}),h&&(0,$v.jsxs)("div",{style:{marginTop:"15px",padding:"15px",backgroundColor:"#f8f9fa",borderRadius:"5px",fontStyle:"italic",marginBottom:"20px",textAlign:"center",border:"1px solid #e9ecef"},children:[(0,$v.jsx)("strong",{children:"Estado:"})," ",h||T]}),(0,$v.jsxs)("div",{style:{backgroundColor:"white",padding:"20px",borderRadius:"10px",boxShadow:"0 2px 10px rgba(0,0,0,0.05)",marginBottom:"20px"},children:[(0,$v.jsx)("h2",{children:"Asignaciones Actuales"}),(0,$v.jsx)("div",{style:{marginBottom:"15px"},children:(0,$v.jsx)("input",{type:"text",placeholder:"Buscar por n\xfamero de orden o centro...",value:I,onChange:e=>S(e.target.value),style:{width:"100%",padding:"10px",border:"1px solid #ddd",borderRadius:"5px",marginBottom:"10px"}})}),t.length>0?(0,$v.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,$v.jsx)("thead",{children:(0,$v.jsxs)("tr",{style:{backgroundColor:"#f8f9fa"},children:[(0,$v.jsx)("th",{style:{padding:"10px",textAlign:"left"},children:"Orden"}),(0,$v.jsx)("th",{style:{padding:"10px",textAlign:"left"},children:"Centro Asignado"}),(0,$v.jsx)("th",{style:{padding:"10px",textAlign:"left"},children:"Plazas Disponibles"}),(0,$v.jsx)("th",{style:{padding:"10px",textAlign:"left"},children:"Acciones"})]})}),(0,$v.jsx)("tbody",{children:t.sort(((e,t)=>{const n=e.numeroOrden||e.order||0,r=t.numeroOrden||t.order||0;return Number(n)-Number(r)})).filter((e=>{const t=I.toLowerCase(),n=(e.numeroOrden||e.order||"").toString(),r=e.nombreCentro||e.centerName||"";return n.includes(t)||r.toLowerCase().includes(t)})).map((e=>{const t=(e=>{let t=null;if(e.centroAsociado?t=e.centroAsociado:e.centerId&&(t=n.find((t=>t.id===e.centerId))),!t&&e.nombreCentro&&"Centro no encontrado"!==e.nombreCentro){const r=e.nombreCentro.toLowerCase();if(t=n.find((e=>e.nombre&&e.nombre.toLowerCase()===r||e.centro&&e.centro.toLowerCase()===r)),!t)try{const e=r.normalize("NFD").replace(/[\u0300-\u036f]/g,"");t=n.find((t=>!(!t.nombre&&!t.centro)&&(t.nombre||t.centro||"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")===e))}catch(Yv){console.error("Error al normalizar nombre:",Yv)}}if(!t&&e.centerName&&"Centro no encontrado"!==e.centerName){const r=e.centerName.toLowerCase();if(t=n.find((e=>e.nombre&&e.nombre.toLowerCase()===r||e.centro&&e.centro.toLowerCase()===r)),!t)try{const e=r.normalize("NFD").replace(/[\u0300-\u036f]/g,"");t=n.find((t=>!(!t.nombre&&!t.centro)&&(t.nombre||t.centro||"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")===e))}catch(Yv){console.error("Error al normalizar centerName:",Yv)}}if(!t){t={id:e.centerId||"desconocido",nombre:e.nombreCentro||e.centerName||"Centro desconocido",plazas:0,asignadas:0,municipio:e.municipio||"",localidad:e.localidad||""};const r=(e.nombreCentro||e.centerName||"").toLowerCase();if(r.length>5){const e=n.find((e=>e.nombre&&e.nombre.toLowerCase().includes(r)||e.centro&&e.centro.toLowerCase().includes(r)));if(e&&(t=e,console.log(`Coincidencia parcial encontrada para "${r}": ${e.nombre||e.centro}`)),!e)try{const e=r.normalize("NFD").replace(/[\u0300-\u036f]/g,""),i=n.find((t=>!(!t.nombre&&!t.centro)&&(t.nombre||t.centro||"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(e)));i&&(t=i,console.log(`Coincidencia normalizada encontrada para "${r}": ${i.nombre||i.centro}`))}catch(Yv){console.error("Error al normalizar b\xfasqueda parcial:",Yv)}}}return t})(e),r=Math.max(0,(t.plazas||0)-(t.asignadas||0)),i=t.plazas||0;return(0,$v.jsxs)("tr",{style:{borderBottom:"1px solid #eee"},children:[(0,$v.jsx)("td",{style:{padding:"10px"},children:e.numeroOrden||e.order}),(0,$v.jsx)("td",{style:{padding:"10px"},children:e.nombreCentro||e.centerName}),(0,$v.jsxs)("td",{style:{padding:"10px"},children:[(0,$v.jsx)("strong",{children:r})," / ",i]}),(0,$v.jsx)("td",{style:{padding:"10px"},children:(0,$v.jsx)("button",{onClick:()=>(async e=>{try{const t=e;if(!t.order&&!t.numeroOrden)return void f("Error: No se pudo obtener el n\xfamero de orden","error");const n=t.numeroOrden||t.order,r={orden:n,centrosIds:t.centerId?[t.centerId]:[],timestamp:Yf()};console.log("Nueva solicitud a crear:",r);const i=Xf(u),o=Mh(Lh(u,"solicitudesPendientes"));i.set(o,r);const s=Mh(u,"asignaciones",t.docId);i.delete(s);const l=new Date,c={orden:n,estado:"REASIGNANDO",mensaje:"Reasignaci\xf3n manual desde el panel de administraci\xf3n",fechaHistorico:l.toISOString(),timestamp:l.getTime()};t.centerId&&(c.centroAnterior=t.centerId),console.log("Datos de historial a crear:",c);const d=Mh(Lh(u,"historialSolicitudes"));i.set(d,c),await i.commit(),await a(),f(`Asignaci\xf3n para orden ${n} movida a solicitudes pendientes`,"success")}catch(Yv){console.error("Error al reasignar:",Yv),f(`Error al reasignar: ${Yv.message}`,"error")}})(e),style:{padding:"5px 10px",backgroundColor:"#f39c12",color:"white",border:"none",borderRadius:"3px",cursor:"pointer"},disabled:d,children:"Reasignar"})})]},e.docId)}))})]}):(0,$v.jsx)("p",{children:"No hay asignaciones."})]}),(0,$v.jsxs)("div",{style:{backgroundColor:"white",padding:"20px",borderRadius:"10px",boxShadow:"0 2px 10px rgba(0,0,0,0.05)",marginBottom:"20px"},children:[(0,$v.jsx)("h2",{children:"Solicitudes Pendientes"}),(0,$v.jsx)("div",{style:{marginBottom:"15px"},children:(0,$v.jsx)("input",{type:"text",placeholder:"Buscar por n\xfamero de orden...",value:E,onChange:e=>_(e.target.value),style:{width:"100%",padding:"10px",border:"1px solid #ddd",borderRadius:"5px",marginBottom:"10px"}})}),i.length>0?(0,$v.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,$v.jsx)("thead",{children:(0,$v.jsxs)("tr",{style:{backgroundColor:"#f8f9fa"},children:[(0,$v.jsx)("th",{style:{padding:"10px",textAlign:"left"},children:"Orden"}),(0,$v.jsx)("th",{style:{padding:"10px",textAlign:"left"},children:"Centros Solicitados"}),(0,$v.jsx)("th",{style:{padding:"10px",textAlign:"left"},children:"Plazas Disponibles"}),(0,$v.jsx)("th",{style:{padding:"10px",textAlign:"left"},children:"Acciones"})]})}),(0,$v.jsx)("tbody",{children:i.sort(((e,t)=>Number(e.orden)-Number(t.orden))).filter((e=>{const t=E.toLowerCase();return String(e.orden).includes(t)})).map((e=>{var t,r;return(0,$v.jsxs)("tr",{style:{borderBottom:"1px solid #eee"},children:[(0,$v.jsx)("td",{style:{padding:"10px"},children:e.orden}),(0,$v.jsx)("td",{style:{padding:"10px"},children:null===(t=e.centrosIds)||void 0===t?void 0:t.map(((t,r)=>{let i=null;if(i=n.find((e=>e.id===t)),!i&&"string"===typeof t&&t.length>5){const e=t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");i=n.find((t=>(t.nombre||t.centro||"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")===e))}if(!i&&"string"===typeof t&&t.length>5){const e=t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),r=n.find((t=>(t.nombre||t.centro||"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(e)));r&&(i=r)}i||(i={id:t,plazas:0,asignadas:0});const o=Math.max(0,(i.plazas||0)-(i.asignadas||0)),s=i.plazas||0;return(0,$v.jsxs)("div",{style:{marginBottom:r<e.centrosIds.length-1?"5px":"0",padding:"3px",backgroundColor:0===r?"#f2f9ff":"transparent",borderRadius:"3px"},children:[i.nombre||i.centro||t,": ",(0,$v.jsx)("strong",{children:o})," / ",s]},t)}))}),(0,$v.jsx)("td",{style:{padding:"10px"},children:null===(r=e.centrosIds)||void 0===r?void 0:r.map(((t,r)=>{let i=null;if(i=n.find((e=>e.id===t)),!i&&"string"===typeof t&&t.length>5){const e=t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");i=n.find((t=>(t.nombre||t.centro||"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")===e))}if(!i&&"string"===typeof t&&t.length>5){const e=t.toLowerCase(),r=n.find((t=>t.nombre&&t.nombre.toLowerCase().includes(e)||t.centro&&t.centro.toLowerCase().includes(e)));r&&(i=r)}i||(i={plazas:0,asignadas:0});const o=Math.max(0,(i.plazas||0)-(i.asignadas||0)),s=i.plazas||0;return(0,$v.jsxs)("div",{style:{marginBottom:r<e.centrosIds.length-1?"5px":"0",padding:"3px",backgroundColor:0===r?"#f2f9ff":"transparent",borderRadius:"3px"},children:[(0,$v.jsx)("strong",{children:o})," / ",s]},t)}))}),(0,$v.jsx)("td",{style:{padding:"10px"},children:(0,$v.jsx)("button",{onClick:()=>{g([e],[],n,k).then((async()=>{await a(),f(`Solicitud ${e.orden} procesada`,"success")}))},style:{padding:"5px 10px",backgroundColor:"#3498db",color:"white",border:"none",borderRadius:"3px",cursor:"pointer"},disabled:d,children:"Procesar"})})]},e.docId)}))})]}):(0,$v.jsx)("p",{children:"No hay solicitudes pendientes."})]}),(0,$v.jsx)("div",{style:{textAlign:"center",marginTop:"20px"},children:(0,$v.jsx)("a",{href:"/",style:{padding:"10px 20px",backgroundColor:"#f8f9fa",color:"#333",textDecoration:"none",borderRadius:"5px",fontWeight:"bold"},children:"Volver a la p\xe1gina principal"})}),(0,$v.jsxs)("div",{style:{marginTop:"20px",padding:"15px",backgroundColor:"#f8f9fa",borderRadius:"5px",textAlign:"center",fontSize:"14px",color:"#666"},children:[(0,$v.jsxs)("p",{children:["Plazas asignadas: ",t.length," / Plazas disponibles: ",7066-t.length]}),(0,$v.jsxs)("p",{children:["\xdaltima actualizaci\xf3n: ",p&&"function"===typeof p.getTime?p.toLocaleString():"No disponible"]})]})]})};const Gv=function(){const[e,t]=(0,r.useState)([]),[n,i]=(0,r.useState)([]),[o,s]=(0,r.useState)([]),[a,l]=(0,r.useState)([]),[c,u]=(0,r.useState)(!1),[d,h]=(0,r.useState)(""),[f,p]=(0,r.useState)(!1),[g,m]=(0,r.useState)(new Date),[y,v]=(0,r.useState)(45),[b,w]=(0,r.useState)(!1),[x,I]=(0,r.useState)(!1),[S,E]=(0,r.useState)(!1),[_,T]=(0,r.useState)("Iniciando sistema y verificando datos..."),[k,C]=(0,r.useState)(10),[N,A]=(0,r.useState)(!1),[D,P]=(0,r.useState)(!1),[R,O]=(0,r.useState)(!1),[L,M]=(0,r.useState)(""),[j,z]=(0,r.useState)([]),[F,V]=(0,r.useState)(!1),[U,$]=(0,r.useState)(null),[B,q]=(0,r.useState)(""),[H,K]=(0,r.useState)(""),[W,G]=(0,r.useState)(!1),[Q,Y]=(0,r.useState)(""),[X,J]=(0,r.useState)("success"),[Z,ee]=(0,r.useState)("asignaciones"),te=(0,r.useRef)(!1),ne=(0,r.useRef)(!1),re=(0,r.useRef)(!1),ie=(0,r.useRef)(null),oe=((0,r.useRef)(0),(0,r.useRef)(null)),se=(0,r.useRef)(0),ae=(0,r.useRef)(!1),[le,ce]=(0,r.useState)(!1),[ue,de]=(0,r.useState)({show:!1,message:"",type:""}),[he,fe]=(0,r.useState)(""),[pe,ge]=(0,r.useState)(!1),[me,ye]=(0,r.useState)(""),[ve,be]=(0,r.useState)(!1),[we,xe]=(0,r.useState)(""),[Ie,Se]=(0,r.useState)("all"),[Ee,_e]=(0,r.useState)({}),[Te,ke]=(0,r.useState)({}),[Ce,Ne]=(0,r.useState)({}),[Ae,De]=(0,r.useState)({}),[Pe,Re]=(0,r.useState)({asignaciones:0,pendientes:0,centros:0,historial:0}),Oe=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";Y(e),J(t),G(!0),"error"!==t&&setTimeout((()=>{G(!1)}),5e3)},Le=async()=>{if(!b){w(!0),h("Reseteando y recalculando contadores de asignaciones...");try{await ze();const t=await(async(e,t,n)=>{try{for(const t of e)if(t.docId)try{await Bf(Mh(n,"centros",t.docId),{asignadas:0})}catch(Yv){console.error(`Error al resetear contador para ${t.centro}:`,Yv)}const r={};for(const e of t){const t=e.centroId||e.id;t&&(r[t]=(r[t]||0)+1)}let i=0,o=0;for(const t of e){const e=t.id;if(e&&r[e]&&t.docId)try{await Bf(Mh(n,"centros",t.docId),{asignadas:r[e]}),i++}catch(Yv){console.error(`Error al actualizar contador para ${t.centro}:`,Yv),o++}}return{success:!0,actualizados:i,errores:o,message:`Contadores reiniciados. ${i} centros actualizados.`}}catch(Yv){return console.error("Error al resetear contadores:",Yv),{success:!1,error:Yv.message,message:"Error al resetear contadores: "+Yv.message}}})(e,n,Vv);se.current=Date.now(),await ze(),t.success?Oe(`Contadores recalculados correctamente: ${t.actualizados} centros actualizados.`,"success"):Oe(`Error al recalcular contadores: ${t.message}`,"error")}catch(Yv){console.error("Error al resetear contadores:",Yv),Oe(`Error al resetear contadores: ${Yv.message}`,"error")}finally{w(!1),h("")}}},Me=async e=>{try{let a=null;if(e&&e.target&&e.target.files&&e.target.files.length>0)a=e.target.files[0];else try{const e="/asignacion-plazas/plazas.csv",t=await fetch(e);if(t.ok)a=await t.blob();else{console.log("CSV no encontrado en la ubicaci\xf3n predeterminada, abriendo di\xe1logo de selecci\xf3n...");const e=document.createElement("input");e.type="file",e.accept=".csv";const t=new Promise((t=>{e.onchange=e=>t(e.target.files[0])}));e.click(),a=await t}}catch(Yv){console.error("Error al intentar cargar CSV autom\xe1ticamente:",Yv);const t=document.createElement("input");t.type="file",t.accept=".csv";const n=new Promise((e=>{t.onchange=t=>e(t.target.files[0])}));t.click(),a=await n}p(!0),h("Cargando y procesando archivo CSV...");try{await je("centros");const e=await fetch(a);if(!e.ok)throw new Error(`Error al cargar el CSV: ${e.status} - ${e.statusText}`);const l=await e.text();if(l.length<100)throw new Error("El archivo CSV parece estar vac\xedo o es demasiado peque\xf1o");const c=l.split("\n").map((e=>e.replace(/"/g,"").trim())).filter(Boolean);if(c.length<5)throw new Error("El archivo CSV no contiene suficientes l\xedneas de datos");const u=c.findIndex((e=>e.includes("A.S.I.;")));if(-1===u){const e=c.findIndex((e=>e.includes("ASI;")||e.includes("DEPARTAMENTO;")||e.includes("CODIGO;")));if(-1===e)throw new Error("No se encontr\xf3 una l\xednea de encabezado v\xe1lida en el CSV");u=e}if(c[u].split(";").length<5)throw new Error("El formato del encabezado no es v\xe1lido, faltan columnas necesarias");const d=new Set,f=new Set,g=[];let m=1,y=0,v=0,b=0;h("Analizando datos del CSV...");for(let a=u+1;a<c.length;a++){var t,n,r,i,o,s;const e=c[a].trim();if(!e)continue;if(e.includes("de 11")||e.includes("TOTAL ="))continue;const l=e.split(";");if(l.length<5){v++;continue}const u=(null===(t=l[0])||void 0===t?void 0:t.trim())||"",p=(null===(n=l[1])||void 0===n?void 0:n.trim())||"",w=(null===(r=l[2])||void 0===r?void 0:r.trim())||"",x=(null===(i=l[3])||void 0===i?void 0:i.trim())||"",I=(null===(o=l[4])||void 0===o?void 0:o.trim())||"";if(!w||w.length<2){console.warn(`L\xednea ${a+1}: C\xf3digo inv\xe1lido o ausente: "${w}"`),v++;continue}if(!x||x.length<2){console.warn(`L\xednea ${a+1}: Nombre de centro inv\xe1lido o ausente: "${x}"`),v++;continue}if(!I){console.warn(`L\xednea ${a+1}: Municipio ausente para centro: "${x}"`),v++;continue}const S=`${w}-${x}-${I}`.toLowerCase();if(d.has(S)){b++;continue}f.has(w)&&console.warn(`Posible duplicado con c\xf3digo ${w}: "${x}" en ${I}`),d.add(S),f.add(w);let E=1;if(l.length>5&&null!==(s=l[5])&&void 0!==s&&s.trim()){const e=l[5].trim(),t=parseInt(e);!isNaN(t)&&t>0?E=t:console.warn(`L\xednea ${a+1}: Valor de plazas inv\xe1lido: "${e}", usando 1 por defecto`)}else console.warn(`L\xednea ${a+1}: No se especific\xf3 n\xfamero de plazas para "${x}", usando 1 por defecto`);y+=E,g.push({id:m++,asi:u,departamento:p,codigo:w,centro:x,localidad:I,municipio:I,plazas:E,asignadas:0}),g.length%100===0&&h(`Procesando CSV: ${g.length} centros encontrados...`)}if(0===g.length)throw new Error("No se pudieron extraer centros v\xe1lidos del CSV");const w=7066;if(y!==w){const e=[...g].sort(((e,t)=>t.plazas-e.plazas)),t=y-w;if(Math.abs(t)>100&&console.warn(`Diferencia muy grande (${t} plazas) entre el total calculado y el objetivo`),t>0){let n=t,r=0;for(;n>0&&r<Math.min(5,e.length);){const i=e[r],o=Math.min(Math.ceil(t/5),i.plazas-1,n);o>0&&(i.plazas-=o,n-=o),r++}n>0&&(e[0].plazas-=n)}else if(t<0){let n=Math.abs(t),r=0;for(;n>0&&r<Math.min(5,e.length);){const i=e[r],o=Math.min(Math.ceil(Math.abs(t)/5),n);i.plazas+=o,n-=o,r++}n>0&&(e[0].plazas+=n)}const n=g.reduce(((e,t)=>e+t.plazas),0);if(n!==w)throw console.error(`Error en el ajuste: ${n} \u2260 ${w}`),new Error(`No se pudo ajustar el n\xfamero de plazas correctamente: ${n} \u2260 ${w}`)}h(`A\xf1adiendo ${g.length} centros a Firebase...`);let x=0;if((await Uf(Lh(Vv,"centros"))).size>0)return Oe("Se encontraron datos existentes. Usando datos actuales para evitar duplicaci\xf3n.","warning"),p(!1),await ze();const I=100;for(let t=0;t<g.length;t+=I){const e=g.slice(t,t+I);h(`A\xf1adiendo centros: ${t}/${g.length}`);for(const t of e){const e=Mh(Lh(Vv,"centros"));await $f(e,{...t,docId:e.id}),x++}}return h("Datos cargados correctamente"),await ze(),p(!1),Oe(`Se han cargado ${x} centros y exactamente ${w} plazas correctamente`,"success"),!0}catch(Yv){return console.error("Error al cargar o procesar el CSV:",Yv),Oe(`Error en la importaci\xf3n: ${Yv.message}`,"error"),p(!1),!1}}catch(Yv){return console.error("Error al cargar datos desde CSV:",Yv),Oe(`Error al cargar datos desde CSV: ${Yv.message}`,"error"),p(!1),!1}},je=async e=>{try{h(`Limpiando colecci\xf3n ${e}...`);const t=await Uf(Lh(Vv,e));if(t.size>0)for(const n of t.docs)await qf(Mh(Vv,e,n.id));return!0}catch(Yv){throw console.error(`Error al limpiar colecci\xf3n ${e}:`,Yv),Yv}},ze=async()=>{console.log("Iniciando carga de datos desde Firebase...");try{console.log("Verificando colecciones disponibles en Firebase..."),console.log("Intentando cargar centros...");let e=await Uf(Lh(Vv,"centros"));if(e.empty){console.warn("\u26a0\ufe0f No se encontraron centros en la colecci\xf3n 'centros'");const t=Lh(Vv,"centrosTrabajo");e=await Uf(t),e.empty?console.error("\u274c No se encontraron centros en ninguna colecci\xf3n"):console.log("\u2705 Se encontraron centros en la colecci\xf3n 'centrosTrabajo':",e.size)}else console.log("\u2705 Se encontraron centros en la colecci\xf3n 'centros':",e.size);console.log("Intentando cargar asignaciones para contar plazas ocupadas...");let n=await Uf(Lh(Vv,"asignaciones"));if(n.empty){console.warn("\u26a0\ufe0f No se encontraron asignaciones en la colecci\xf3n 'asignaciones'");const e=Lh(Vv,"asignacionesActuales");n=await Uf(e),n.empty?console.error("\u274c No se encontraron asignaciones en ninguna colecci\xf3n"):console.log("\u2705 Se encontraron asignaciones en la colecci\xf3n 'asignacionesActuales':",n.size)}else console.log("\u2705 Se encontraron asignaciones en la colecci\xf3n 'asignaciones':",n.size);const r={};n.forEach((e=>{const t=e.data();if(t&&t.centerId){const e=t.centerId;r[e]=(r[e]||0)+1}})),console.log("Conteo de asignaciones por centro:",r);let o={};e.forEach((e=>{const t=e.data();console.log("Centro encontrado:",e.id,t);const n=parseInt(t.plazas||t.plazasTotal||0,10),i=r[e.id]||0,s=Math.max(0,n-i);o[e.id]={id:e.id,nombre:t.nombre||t.centro||"Centro sin nombre",plazas:n,asignadas:i,plazasDisponibles:s,plazasOcupadas:i,plazasTotal:n,direccion:t.direccion||"",codigoCentro:t.codigoCentro||t.id||"",estadoCentro:t.estadoCentro||"Activo",municipio:t.municipio||"",localidad:t.localidad||""}})),0===Object.keys(o).length&&(console.warn("\u26a0\ufe0f Creando centros de prueba para diagn\xf3stico"),o.centro1={id:"centro1",nombre:"Centro de Prueba 1",plazas:10,asignadas:0,plazasDisponibles:10,plazasOcupadas:0,plazasTotal:10,direccion:"Direcci\xf3n de prueba",codigoCentro:"CP001",estadoCentro:"Activo",municipio:"Municipio de Prueba 1",localidad:"Localidad de Prueba 1"},o.centro2={id:"centro2",nombre:"Centro de Prueba 2",plazas:7,asignadas:2,plazasDisponibles:5,plazasOcupadas:2,plazasTotal:7,direccion:"Otra direcci\xf3n",codigoCentro:"CP002",estadoCentro:"Activo",municipio:"Municipio de Prueba 2",localidad:"Localidad de Prueba 2"}),console.log("Centros procesados:",Object.keys(o).length),console.log("Procesando asignaciones para mostrar...");const a={},c={};Object.values(o).forEach((e=>{if(a[e.id]=e,e.nombre){const t=e.nombre.toUpperCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");c[t]=e}if(e.centro&&e.centro!==e.nombre){const t=e.centro.toUpperCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");c[t]=e}})),console.log("Centros indexados:",{porId:Object.keys(a).length,porNombre:Object.keys(c).length});let u={};n.forEach((e=>{const t=e.data();if(console.log("Asignaci\xf3n encontrada:",e.id,t),t){let n=a[t.centerId];if(!n&&t.centro){const e=t.centro.toUpperCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");n=c[e],n&&console.log(`Centro encontrado por campo 'centro': "${t.centro}" corresponde a ID=${n.id}`)}if(!n&&t.centerId&&"string"===typeof t.centerId){const e=t.centerId.toUpperCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");n=c[e],n&&console.log(`Centro encontrado por centerId como nombre: "${t.centerId}" corresponde a ID=${n.id}`)}if(!n&&t.centerName){const e=t.centerName.toUpperCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");n=c[e],n&&console.log(`Centro encontrado por centerName: "${t.centerName}" corresponde a ID=${n.id}`)}let r="Centro no encontrado";n?r=n.nombre:t.centro?r=t.centro:t.centerName?r=t.centerName:t.centerId&&"string"===typeof t.centerId&&t.centerId.length>5&&(r=t.centerId),u[e.id]={id:e.id,numeroOrden:t.order||t.numeroOrden||0,centerId:t.centerId||t.centro||"",centroPrevio:t.centroPrevio||t.centroAnterior||"",nombreCentro:r,timestamp:t.timestamp||Date.now(),fechaAsignacion:t.fechaAsignacion||(new Date).toISOString(),centroAsociado:n,municipio:t.municipio||(n?n.municipio:""),localidad:t.localidad||(n?n.localidad:"")}}})),console.log("Asignaciones procesadas:",Object.keys(u).length),console.log("Intentando cargar solicitudes pendientes...");const d=Lh(Vv,"solicitudesPendientes"),h=await Uf(d);h.empty?console.warn("\u26a0\ufe0f No se encontraron solicitudes pendientes"):console.log("\u2705 Se encontraron solicitudes pendientes:",h.size);let f={};h.forEach((e=>{const t=e.data();console.log("Solicitud encontrada:",e.id,t),f[e.id]={id:e.id,numeroOrden:t.orden||t.numeroOrden||0,centrosIds:t.centrosIds||t.centrosSeleccionados||[],timestamp:t.timestamp||Date.now(),fechaSolicitud:t.fechaSolicitud||(new Date).toISOString(),estado:t.estado||"Pendiente"}})),console.log("Solicitudes procesadas:",Object.keys(f).length),console.log("Intentando cargar historial...");const p=Lh(Vv,"historialSolicitudes"),g=await Uf(p);g.empty?console.warn("\u26a0\ufe0f No se encontr\xf3 historial de solicitudes"):console.log("\u2705 Se encontr\xf3 historial de solicitudes:",g.size);let m=[];g.forEach((e=>{var t,n;const r=e.data();m.push({id:e.id,numeroOrden:r.orden||r.numeroOrden||0,centerId:r.centerId||r.centro||"",centroPrevio:r.centroPrevio||"",centroAnterior:r.centroAnterior||"",nombreCentro:(null===(t=o[r.centerId])||void 0===t?void 0:t.nombre)||"Centro no encontrado",nombreCentroAnterior:r.centroAnterior?(null===(n=o[r.centroAnterior])||void 0===n?void 0:n.nombre)||"Centro no encontrado":"",timestamp:r.timestamp||Date.now(),fechaHistorico:r.fechaHistorico||(new Date).toISOString(),estado:r.estado||"Procesado",accion:r.accion||"Asignaci\xf3n",mensaje:r.mensaje||""})})),m.sort(((e,t)=>(t.timestamp||0)-(e.timestamp||0))),console.log("Historial procesado:",m.length,"registros"),t(Object.values(o)),i(Object.values(u)),s(Object.values(f)),l(m),_e(o),ke(u),Ne(f);const y=Object.keys(u).length,v=Object.keys(f).length,b=Object.keys(o).length;Re({asignaciones:y,pendientes:v,centros:b,historial:m.length});let w={};return Object.values(o).forEach((e=>{w[e.id]={id:e.id,nombre:e.nombre,plazas:e.plazas,asignadas:e.asignadas,plazasDisponibles:e.plazasDisponibles,plazasTotal:e.plazasTotal,codigoCentro:e.codigoCentro,estadoCentro:e.estadoCentro,municipio:e.municipio||"",localidad:e.localidad||""}})),De(w),console.log("Datos de plazas actualizados. Totales:",{totalCentros:Object.keys(o).length,totalPlazas:Object.values(o).reduce(((e,t)=>e+t.plazasTotal),0),plazasAsignadas:Object.values(o).reduce(((e,t)=>e+t.asignadas),0),plazasDisponibles:Object.values(o).reduce(((e,t)=>e+t.plazasDisponibles),0)}),console.log("Datos cargados correctamente:",{centros:b,asignaciones:y,pendientes:v,historial:m.length}),!0}catch(Yv){return console.error("Error al cargar datos desde Firebase:",Yv),console.error("Detalles del error:",Yv.code,Yv.message,Yv.stack),!1}},Fe=()=>{const e=Hf(Lh(Vv,"centros"),(e=>{const n=[];e.forEach((e=>{n.push({...e.data(),docId:e.id})})),n.length>0&&t(n)})),n=Hf(Lh(Vv,"asignaciones"),(e=>{const t=[];e.forEach((e=>{const n=e.data(),r={...n,docId:e.id,order:"number"===typeof n.order?n.order:Number(n.order)||0,centro:n.centro||"No disponible",localidad:n.localidad||"No disponible",municipio:n.municipio||"No disponible",timestamp:n.timestamp||Date.now(),estado:n.estado||"ASIGNADA"};t.push(r)})),t.sort(((e,t)=>(Number(e.order)||0)-(Number(t.order)||0))),i(t)})),r=Hf(Lh(Vv,"solicitudesPendientes"),(e=>{const t=[];e.forEach((e=>{const n=e.data(),r={...n,docId:e.id,orden:"number"===typeof n.orden?n.orden:Number(n.orden)||0,centrosIds:n.centrosIds||n.centrosSeleccionados||[]};t.push(r)})),s(t)})),o=Hf(Lh(Vv,"historialSolicitudes"),(e=>{const t=[];e.forEach((e=>{t.push({...e.data(),docId:e.id})})),l(t)}));return()=>{e(),n(),r(),o()}},Ve=async()=>{try{const s="/asignacion-plazas/plazas.csv",a=await fetch(s);if(a.ok){p(!0),h("Cargando y procesando archivo CSV autom\xe1ticamente...");const s=await a.blob();if(await je("centros"),s.size<100)throw new Error("El archivo CSV parece estar vac\xedo o es demasiado peque\xf1o");const l=(await s.text()).split("\n").map((e=>e.replace(/"/g,"").trim())).filter(Boolean);if(l.length<5)throw new Error("El archivo CSV no contiene suficientes l\xedneas de datos");let c=l.findIndex((e=>e.includes("A.S.I.;")));if(-1===c){const e=l.findIndex((e=>e.includes("ASI;")||e.includes("DEPARTAMENTO;")||e.includes("CODIGO;")));if(-1===e)throw new Error("No se encontr\xf3 una l\xednea de encabezado v\xe1lida en el CSV");c=e}if(l[c].split(";").length<5)throw new Error("El formato del encabezado no es v\xe1lido, faltan columnas necesarias");const u=new Set,d=new Set,f=[];let g=1,m=0,y=0,v=0;h("Analizando datos del CSV...");for(let a=c+1;a<l.length;a++){var e,t,n,r,i,o;const s=l[a].trim();if(!s)continue;if(s.includes("de 11")||s.includes("TOTAL ="))continue;const c=s.split(";");if(c.length<5){y++;continue}const p=(null===(e=c[0])||void 0===e?void 0:e.trim())||"",b=(null===(t=c[1])||void 0===t?void 0:t.trim())||"",w=(null===(n=c[2])||void 0===n?void 0:n.trim())||"",x=(null===(r=c[3])||void 0===r?void 0:r.trim())||"",I=(null===(i=c[4])||void 0===i?void 0:i.trim())||"";if(!w||w.length<2){console.warn(`L\xednea ${a+1}: C\xf3digo inv\xe1lido o ausente: "${w}"`),y++;continue}if(!x||x.length<2){console.warn(`L\xednea ${a+1}: Nombre de centro inv\xe1lido o ausente: "${x}"`),y++;continue}if(!I){console.warn(`L\xednea ${a+1}: Municipio ausente para centro: "${x}"`),y++;continue}const S=`${w}-${x}-${I}`.toLowerCase();if(u.has(S)){v++;continue}d.has(w)&&console.warn(`Posible duplicado con c\xf3digo ${w}: "${x}" en ${I}`),u.add(S),d.add(w);let E=1;if(c.length>5&&null!==(o=c[5])&&void 0!==o&&o.trim()){const e=c[5].trim(),t=parseInt(e);!isNaN(t)&&t>0?E=t:console.warn(`L\xednea ${a+1}: Valor de plazas inv\xe1lido: "${e}", usando 1 por defecto`)}else console.warn(`L\xednea ${a+1}: No se especific\xf3 n\xfamero de plazas para "${x}", usando 1 por defecto`);m+=E,f.push({id:g++,asi:p,departamento:b,codigo:w,centro:x,localidad:I,municipio:I,plazas:E,asignadas:0}),f.length%100===0&&h(`Procesando CSV: ${f.length} centros encontrados...`)}if(0===f.length)throw new Error("No se pudieron extraer centros v\xe1lidos del CSV");const b=7066;if(m!==b){const e=[...f].sort(((e,t)=>t.plazas-e.plazas)),t=m-b;if(Math.abs(t)>100&&console.warn(`Diferencia muy grande (${t} plazas) entre el total calculado y el objetivo`),t>0){let n=t,r=0;for(;n>0&&r<Math.min(5,e.length);){const i=e[r],o=Math.min(Math.ceil(t/5),i.plazas-1,n);o>0&&(i.plazas-=o,n-=o),r++}n>0&&(e[0].plazas-=n)}else if(t<0){let n=Math.abs(t),r=0;for(;n>0&&r<Math.min(5,e.length);){const i=e[r],o=Math.min(Math.ceil(Math.abs(t)/5),n);i.plazas+=o,n-=o,r++}n>0&&(e[0].plazas+=n)}const n=f.reduce(((e,t)=>e+t.plazas),0);if(n!==b)throw console.error(`Error en el ajuste: ${n} \u2260 ${b}`),new Error(`No se pudo ajustar el n\xfamero de plazas correctamente: ${n} \u2260 ${b}`)}h(`A\xf1adiendo ${f.length} centros a Firebase...`);let w=0;if((await Uf(Lh(Vv,"centros"))).size>0)return Oe("Se encontraron datos existentes. Usando datos actuales para evitar duplicaci\xf3n.","warning"),p(!1),await ze();const x=100;for(let e=0;e<f.length;e+=x){const t=f.slice(e,e+x);h(`A\xf1adiendo centros: ${e}/${f.length}`);for(const e of t){const t=Mh(Lh(Vv,"centros"));await $f(t,{...e,docId:t.id}),w++}}return h("Datos cargados correctamente"),await ze(),p(!1),Oe(`Se han cargado ${w} centros y exactamente ${b} plazas autom\xe1ticamente`,"success"),!0}return console.log("CSV no encontrado en la ubicaci\xf3n predeterminada:",a.status),!1}catch(Yv){return console.error("Error al cargar CSV autom\xe1ticamente:",Yv),p(!1),!1}};(0,r.useEffect)((()=>{let e;return(async()=>{const t=window.location.pathname.split("/"),n="admin"===t[t.length-1];if(A(n),!te.current&&!ne.current){te.current=!0;try{if(n){E(!0),T("Cargando datos para el panel de administraci\xf3n..."),C(5);const e=await He();if(!e.success)return E(!0),void T(`Error de conexi\xf3n: ${e.message}. Intenta recargar la p\xe1gina.`);T("Cargando centros y solicitudes..."),C(30);try{await ze(),console.log("Datos cargados correctamente para el panel de admin"),C(100),T("\xa1Datos cargados correctamente!"),setTimeout((()=>{E(!1)}),1e3)}catch(Yv){console.error("Error al cargar datos para el panel de admin:",Yv),T(`Error al cargar datos: ${Yv.message}`),setTimeout((()=>{E(!1)}),2e3)}return ne.current=!0,void(te.current=!1)}const t=!(await Uf(Lh(Vv,"solicitudesPendientes"))).empty;(t||n)&&(E(!0),T("Iniciando sistema y verificando conexi\xf3n..."),C(5));const o=await He();if(!o.success)return E(!0),void T(`Error de conexi\xf3n: ${o.message}. Intenta recargar la p\xe1gina.`);(t||n)&&(T("Verificando datos..."),C(10));const s=await Uf(Lh(Vv,"centros"));if(0===s.size){T("Cargando datos iniciales..."),C(20),await je("centros");await Ve()||await Me()}else T("Cargando datos existentes..."),C(30),await ze();e=Fe(),T("Limpiando duplicados iniciales..."),C(50),console.log("Ejecutando limpieza inicial de duplicados");const a=await Be();if(a.error)console.error("Error durante la limpieza inicial:",a.error);else{const e=a.eliminadosSolicitudes+a.eliminadosAsignaciones+a.eliminadosHistorial;console.log(`Limpieza inicial completada: ${e} elementos duplicados eliminados`)}T("Moviendo solicitudes hist\xf3ricas a pendientes..."),C(60);try{const e=await qe();e.error?console.error("Error en el volcado de historial:",e.error):e.volcados>0?(console.log(`Volcado inicial: ${e.volcados} solicitudes recuperadas del historial`),T(`Recuperadas ${e.volcados} solicitudes del historial`)):console.log("No hubo solicitudes para recuperar del historial")}catch(r){console.error("Error durante el volcado de historial:",r)}T("Procesando solicitudes pendientes..."),C(70);try{console.log("Procesando todas las solicitudes pendientes al inicio..."),await Ue();const e=(await Uf(Lh(Vv,"solicitudesPendientes"))).docs.length;C(100),e>0?(T(`Hay ${e} solicitudes pendientes por procesar.`),console.log(`Quedan ${e} solicitudes pendientes despu\xe9s del procesamiento inicial`)):(T("\xa1Sistema iniciado correctamente!"),setTimeout((()=>{E(!1),Oe("Sistema iniciado correctamente.","success")}),2e3))}catch(i){console.error("Error al procesar solicitudes iniciales:",i),T(`Error al procesar solicitudes: ${i.message}`),C(100),setTimeout((()=>{E(!1),Oe("Se produjo un error durante el procesamiento inicial: "+i.message,"error")}),2e3)}ne.current=!0}catch(Yv){console.error("Error durante la inicializaci\xf3n:",Yv),T(`Error: ${Yv.message}`),setTimeout((()=>{E(!1),Oe("Error durante la inicializaci\xf3n: "+Yv.message,"error")}),2e3)}finally{te.current=!1}}})(),()=>{e&&e()}}),[]),(0,r.useEffect)((()=>{if(e.length>0){return(async()=>{o.length>0&&!c&&(await Ue(!0),v(45))})(),()=>{ie.current&&clearInterval(ie.current)}}}),[e.length]),(0,r.useEffect)((()=>(x||(oe.current=setInterval((()=>{v((e=>e<=1?(!c&&o.length>0&&!x&&Ue(!0),45):e-1))}),1e3)),()=>{oe.current&&clearInterval(oe.current)})),[c,o.length,x]);const Ue=async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{respetarAsignacionesExistentes:r=!0}=t;if(re.current)return console.log("Ya hay un procesamiento en curso. Espera a que termine."),!1;re.current=!0,h("Iniciando procesamiento de solicitudes...");try{const t=await Uf(Lh(Vv,"solicitudesPendientes"));if(t.empty)return console.log("No hay solicitudes pendientes para procesar."),h("No hay solicitudes pendientes para procesar."),setTimeout((()=>{h(""),re.current=!1}),3e3),!0;const a=t.docs.map((e=>({...e.data(),docId:e.id,centrosIds:e.data().centrosIds||e.data().centrosSeleccionados||[]}))).sort(((e,t)=>Number(e.orden)-Number(t.orden)));console.log(`Procesando ${a.length} solicitudes pendientes ordenadas por prioridad...`),h(`Procesando ${a.length} solicitudes pendientes...`);let l=n;r?(console.log("Modo ejecuci\xf3n autom\xe1tica: Se respetar\xe1n las asignaciones existentes"),l=[]):console.log("Modo ejecuci\xf3n manual: Se procesar\xe1n todas las asignaciones seg\xfan prioridad");const c=await Uv(a,l,e,h);if(c.error)console.error("Error al procesar solicitudes:",c.error),h(`Error: ${c.error}`);else{if(console.log("Procesamiento completado:",c.message),h(c.message),!r)try{const e=await Ke();e&&e.corregidos>0&&(console.log(`Corregidas ${e.corregidos} asignaciones con exceso`),h((t=>`${t} Corregidas ${e.corregidos} asignaciones con exceso.`)))}catch(i){console.error("Error en verificaci\xf3n de asignaciones:",i)}fe((new Date).toLocaleString());try{await ze()}catch(o){console.error("Error al recargar datos:",o)}}try{const e=(await Uf(Lh(Vv,"solicitudesPendientes"))).docs.length;e>0?(console.log(`A\xfan quedan ${e} solicitudes pendientes por procesar`),h((t=>`${t} A\xfan quedan ${e} solicitudes pendientes.`)),e<5&&(console.log("Realizando un segundo intento autom\xe1tico para procesar solicitudes restantes..."),setTimeout((()=>{Ue({respetarAsignacionesExistentes:r})}),3e3))):S&&setTimeout((()=>{E(!1),Oe("Sistema iniciado correctamente","success")}),2e3)}catch(s){console.error("Error al verificar solicitudes pendientes:",s)}return!0}catch(Yv){return console.error("Error general al procesar solicitudes:",Yv),h(`Error al procesar solicitudes: ${Yv.message}`),!1}finally{setTimeout((()=>{re.current=!1}),3e3)}},$e={container:{maxWidth:"1280px",margin:"0 auto",padding:"20px",backgroundColor:"#f8f9fa",minHeight:"100vh",fontFamily:"Arial, sans-serif"},header:{textAlign:"center",marginBottom:"30px",borderBottom:"1px solid #e7e7e7",paddingBottom:"15px"},title:{color:"#2c3e50",fontSize:"28px",margin:"0 0 10px 0"},subtitle:{color:"#7f8c8d",fontSize:"16px",fontWeight:"normal",margin:0},tabs:{display:"flex",gap:"2px",marginBottom:"20px",backgroundColor:"#e9ecef",borderRadius:"10px",padding:"3px",overflow:"hidden"},tab:{padding:"12px 20px",cursor:"pointer",flex:1,textAlign:"center",borderRadius:"8px",transition:"all 0.3s ease",fontSize:"15px",fontWeight:"500"},activeTab:{backgroundColor:"#fff",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",color:"#3498db"},inactiveTab:{backgroundColor:"transparent",color:"#7f8c8d"},sectionTitle:{fontSize:"20px",color:"#2c3e50",marginBottom:"15px",paddingBottom:"8px",borderBottom:"2px solid #e7e7e7"},cardContainer:{backgroundColor:"white",borderRadius:"10px",padding:"20px",boxShadow:"0 2px 10px rgba(0,0,0,0.05)",marginBottom:"20px"},popup:{position:"fixed",top:"20px",right:"20px",padding:"15px 20px",borderRadius:"10px",boxShadow:"0 3px 15px rgba(0,0,0,0.2)",zIndex:1e3,maxWidth:"350px",animation:"slideIn 0.3s ease"},processingButton:{padding:"12px 20px",backgroundImage:c?"linear-gradient(to right, #cccccc, #dddddd)":"linear-gradient(to right, #3498db, #2980b9)",color:"white",border:"none",borderRadius:"6px",cursor:c||0===o.length?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"15px",fontWeight:"500",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",margin:"10px auto"},reloadButton:{padding:"12px 20px",backgroundImage:f?"linear-gradient(to right, #cccccc, #dddddd)":"linear-gradient(to right, #e74c3c, #c0392b)",color:"white",border:"none",borderRadius:"6px",cursor:f?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"15px",fontWeight:"500",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",margin:"10px auto"},adminPanel:{display:"flex",justifyContent:"center",alignItems:"center",marginBottom:"20px"},adminButton:{padding:"12px 20px",backgroundImage:"linear-gradient(to right, #3498db, #2980b9)",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"15px",fontWeight:"500",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",margin:"10px auto"}};(0,r.useEffect)((()=>{const e=()=>{const e=Date.now(),t=se.current;(0===t||e-t>36e5)&&Le()};n.length>10&&e();const t=setInterval((()=>{e()}),9e5);return()=>clearInterval(t)}),[n.length]);const Be=async()=>{try{console.log("Ejecutando eliminaci\xf3n de solicitudes y asignaciones duplicadas...");const e=await Uf(Lh(Vv,"solicitudesPendientes")),t={},n=e.docs.length;e.docs.forEach((e=>{const n={...e.data(),docId:e.id},r=n.orden;r&&(t[r]?t[r].push(n):t[r]=[n])}));let r=0;Object.keys(t).forEach((e=>{const n=t[e];n.length>1&&(r+=n.length-1)}));const i=await Uf(Lh(Vv,"asignaciones")),o={},s=i.docs.length;i.docs.forEach((e=>{const t={...e.data(),docId:e.id},n=t.order;n&&(o[n]?o[n].push(t):o[n]=[t])}));let a=0;Object.keys(o).forEach((e=>{const t=o[e];t.length>1&&(a+=t.length-1)}));const l=await Uf(Lh(Vv,"historialSolicitudes")),c={};l.docs.forEach((e=>{const t={...e.data(),docId:e.id},n=t.orden,r=t.estado||"DESCONOCIDO";if(!n)return;const i=`${n}-${r}`;c[i]?c[i].push(t):c[i]=[t]}));let u=0;if(Object.keys(c).forEach((e=>{const t=c[e];t.length>1&&(u+=t.length-1)})),0===r&&0===a&&0===u)return console.log("No se encontraron elementos duplicados"),{eliminadosSolicitudes:0,eliminadosAsignaciones:0,eliminadosHistorial:0,totalSolicitudes:n,totalAsignaciones:s};console.log(`Se encontraron ${r} solicitudes duplicadas, ${a} asignaciones duplicadas y ${u} entradas duplicadas en historial`);const d=Xf(Vv);let h=0,f=0,p=0;for(const g in t){const e=t[g];if(e.length>1){e.sort(((e,t)=>{const n=e.timestamp||0;return(t.timestamp||0)-n}));const t=e.slice(1);for(const e of t)d.delete(Mh(Vv,"solicitudesPendientes",e.docId)),h++}}for(const g in o){const e=o[g];if(e.length>1){e.sort(((e,t)=>{const n=e.timestamp||0;return(t.timestamp||0)-n}));const t=e.slice(1);for(const e of t)d.delete(Mh(Vv,"asignaciones",e.docId)),f++}}for(const g in c){const e=c[g];if(e.length>1){e.sort(((e,t)=>{const n=e.timestamp||0;return(t.timestamp||0)-n}));const t=e.slice(1);for(const e of t)d.delete(Mh(Vv,"historialSolicitudes",e.docId)),p++}}return(h>0||f>0||p>0)&&await d.commit(),console.log(`Se eliminaron ${h} solicitudes duplicadas, ${f} asignaciones duplicadas y ${p} entradas duplicadas en historial`),{eliminadosSolicitudes:h,eliminadosAsignaciones:f,eliminadosHistorial:p,totalSolicitudes:n,totalAsignaciones:s}}catch(Yv){return console.error("Error al eliminar duplicados:",Yv),{error:Yv.message,eliminadosSolicitudes:0,eliminadosAsignaciones:0,eliminadosHistorial:0}}};(0,r.useEffect)((()=>{if(ae.current)return void console.log("Verificaci\xf3n ya programada, ignorando programaci\xf3n duplicada");ae.current=!0;const e=()=>{const t=new Date,n=new Date;n.setHours(2,0,0,0),t.getHours()>=2&&n.setDate(n.getDate()+1);const r=n.getTime()-t.getTime();console.log(`Verificaci\xf3n diaria programada para ejecutarse en ${Math.floor(r/36e5)} horas y ${Math.floor(r%36e5/6e4)} minutos (2:00 AM)`);const i=setTimeout((()=>{console.log("Comprobando si se debe ejecutar la verificaci\xf3n diaria (2:00 AM)"),(()=>{const e=localStorage.getItem("ultimaVerificacionDiaria");if(e){const t=new Date(Number(e)),n=new Date;if(t.getDate()===n.getDate()&&t.getMonth()===n.getMonth()&&t.getFullYear()===n.getFullYear())return console.log(`La verificaci\xf3n diaria ya se ejecut\xf3 hoy a las ${t.toLocaleTimeString()}`),!0}return!1})()?(console.log("Saltando verificaci\xf3n, ya se ejecut\xf3 hoy"),e()):(console.log("Iniciando verificaci\xf3n diaria programada (2:00 AM)"),Ue({respetarAsignacionesExistentes:!0}).then((()=>{localStorage.setItem("ultimaVerificacionDiaria",Date.now().toString()),console.log("Verificaci\xf3n diaria completada y marcada como ejecutada hoy"),e()})))}),r);return i},t=e();return()=>{clearTimeout(t),ae.current=!1}}),[]),(0,r.useEffect)((()=>{(async()=>{console.log("Iniciando limpieza inicial de duplicados...");if(!F&&!c){await Be();"true"!==localStorage.getItem("historialLimpiado")&&(console.log("Ejecutando limpieza de duplicados en historial..."),await We())}})()}),[F,c]);const qe=async()=>{try{console.log("Volcando datos de historial a solicitudes pendientes...");const e=await Uf(Lh(Vv,"historialSolicitudes"));if(e.empty)return console.log("No hay entradas en el historial para procesar"),{volcados:0};const t=e.docs.map((e=>({...e.data(),docId:e.id})));console.log(`Se encontraron ${t.length} entradas en el historial`);const n=t.slice(0,5);console.log("Ejemplos de entradas en historial:",n);const r={};t.forEach((e=>{const t=e.estado||"SIN_ESTADO";r[t]=(r[t]||0)+1})),console.log("Conteo de estados en historial:",r);const i=t.filter((e=>e.centrosIds&&e.centrosIds.length>0)).length;console.log(`Entradas con centrosIds v\xe1lidos: ${i} de ${t.length}`);const o=await Uf(Lh(Vv,"solicitudesPendientes")),s=new Set;o.docs.forEach((e=>{const t=e.data();t.orden&&s.add(t.orden)}));(await Uf(Lh(Vv,"asignaciones"))).docs.forEach((e=>{const t=e.data();t.order&&s.add(t.order)})),console.log(`Se encontraron ${s.size} \xf3rdenes ya existentes`);const a=t.filter((e=>!!e.orden&&(!s.has(e.orden)&&(e.centrosIds&&e.centrosIds.length||!e.centroId?e.centrosIds&&e.centrosIds.length>0:(e.centrosIds=[e.centroId],!0)))));if(console.log(`Se volcar\xe1n ${a.length} entradas del historial`),0===a.length)return{volcados:0};console.log("Ejemplos de entradas a volcar:",a.slice(0,3));const l=100;let c=0;for(let u=0;u<a.length;u+=l){const e=Xf(Vv),t=a.slice(u,u+l);for(const n of t){const t={orden:n.orden,centrosIds:n.centrosIds||[n.centroId],timestamp:Date.now(),intentosFallidos:0},r={};if(Object.entries(t).forEach((e=>{let[t,i]=e;void 0!==i?r[t]=i:"centrosIds"===t&&(n.centroId?r.centrosIds=[n.centroId]:console.warn(`No se pudo recuperar centrosIds para orden ${n.orden}`))})),r.orden&&r.centrosIds){const t=Mh(Lh(Vv,"solicitudesPendientes"));e.set(t,r),c++}}await e.commit(),console.log(`Procesado lote ${u/l+1} (${t.length} entradas)`)}return console.log(`Se volcaron ${c} entradas del historial a solicitudes pendientes`),{volcados:c}}catch(Yv){return console.error("Error al volcar datos del historial:",Yv),{error:Yv.message,volcados:0}}},He=async()=>{try{await Uf(Ef(Lh(Vv,"centros"),Nf(1)));return console.log("Conexi\xf3n con Firebase verificada correctamente."),{success:!0,message:"Conexi\xf3n establecida correctamente."}}catch(Yv){return console.error("Error de conexi\xf3n con Firebase:",Yv),Oe("Error de conexi\xf3n con la base de datos. Por favor, verifica tu conexi\xf3n a internet.","error"),{success:!1,error:Yv,message:Yv.message}}};(0,r.useEffect)((()=>{let e;return(async()=>{if(!te.current&&!ne.current){te.current=!0;try{E(!0),T("Iniciando sistema y verificando conexi\xf3n..."),C(5);const r=await He();if(!r.success)return void T(`Error de conexi\xf3n: ${r.message}. Intenta recargar la p\xe1gina.`);T("Verificando datos..."),C(10);const i=await Uf(Lh(Vv,"centros"));if(0===i.size){T("Cargando datos iniciales..."),C(20),await je("centros");await Ve()||await Me()}else T("Cargando datos existentes..."),C(30),await ze();e=Fe(),T("Limpiando duplicados iniciales..."),C(50),console.log("Ejecutando limpieza inicial de duplicados");const o=await Be();if(o.error)console.error("Error durante la limpieza inicial:",o.error);else{const e=o.eliminadosSolicitudes+o.eliminadosAsignaciones+o.eliminadosHistorial;console.log(`Limpieza inicial completada: ${e} elementos duplicados eliminados`)}T("Moviendo solicitudes hist\xf3ricas a pendientes..."),C(60);try{const e=await qe();e.error?console.error("Error en el volcado de historial:",e.error):e.volcados>0?(console.log(`Volcado inicial: ${e.volcados} solicitudes recuperadas del historial`),T(`Recuperadas ${e.volcados} solicitudes del historial`)):console.log("No hubo solicitudes para recuperar del historial")}catch(t){console.error("Error durante el volcado de historial:",t)}T("Procesando solicitudes pendientes..."),C(70);try{console.log("Procesando todas las solicitudes pendientes al inicio..."),await Ue();const e=(await Uf(Lh(Vv,"solicitudesPendientes"))).docs.length;C(100),e>0?(T(`Hay ${e} solicitudes pendientes por procesar.`),console.log(`Quedan ${e} solicitudes pendientes despu\xe9s del procesamiento inicial`)):(T("\xa1Sistema iniciado correctamente!"),setTimeout((()=>{E(!1),Oe("Sistema iniciado correctamente.","success")}),2e3))}catch(n){console.error("Error al procesar solicitudes iniciales:",n),T(`Error al procesar solicitudes: ${n.message}`),C(100),setTimeout((()=>{E(!1),Oe("Se produjo un error durante el procesamiento inicial: "+n.message,"error")}),2e3)}ne.current=!0}catch(Yv){console.error("Error durante la inicializaci\xf3n:",Yv),T(`Error: ${Yv.message}`),setTimeout((()=>{E(!1),Oe("Error durante la inicializaci\xf3n: "+Yv.message,"error")}),2e3)}finally{te.current=!1}}})(),()=>{e&&e()}}),[]);const Ke=async()=>{try{if((()=>{const e=localStorage.getItem("ultimaVerificacionDiaria");if(e){const t=new Date(Number(e)),n=new Date;if(t.getDate()===n.getDate()&&t.getMonth()===n.getMonth()&&t.getFullYear()===n.getFullYear())return console.log(`La verificaci\xf3n diaria ya se ejecut\xf3 hoy a las ${t.toLocaleTimeString()}`),!0}return!1})())return Oe("La verificaci\xf3n de asignaciones ya se ejecut\xf3 hoy. Solo se permite una vez al d\xeda.","info"),{success:!0,message:"Verificaci\xf3n ya ejecutada hoy",yaRealizada:!0};if(C(0),E(!0),T("Iniciando verificaci\xf3n de asignaciones..."),await new Promise((e=>setTimeout(e,500))),!e||!Array.isArray(e))return console.error("Error: availablePlazas debe ser un array",e),T("Error: No hay datos de centros disponibles"),await new Promise((e=>setTimeout(e,2e3))),E(!1),void Oe("Error: No hay datos de centros disponibles","error");if(C(20),T("Analizando datos de centros y plazas..."),await new Promise((e=>setTimeout(e,500))),!n||!Array.isArray(n))return console.error("Error: assignments debe ser un array",n),T("Error: No hay datos de asignaciones"),await new Promise((e=>setTimeout(e,2e3))),E(!1),void Oe("Error: No hay datos de asignaciones","error");C(40),T("Comprobando excesos de asignaciones en centros..."),await new Promise((e=>setTimeout(e,500)));const t=e.filter((e=>e.asignadas>e.plazas));if(0===t.length)return C(100),T("No se encontraron centros con exceso de asignaciones. Todo est\xe1 correcto."),await new Promise((e=>setTimeout(e,2e3))),E(!1),Oe("Verificaci\xf3n completada: No hay centros con exceso de asignaciones","success"),localStorage.setItem("ultimaVerificacionDiaria",Date.now().toString()),{success:!0,message:"No hay centros con exceso",corregidos:0};C(60),T(`Encontrados ${t.length} centros con exceso de asignaciones. Comenzando reasignaci\xf3n...`),await new Promise((e=>setTimeout(e,1e3)));const r=await(async(e,t,n)=>{try{if(!Array.isArray(e))return console.error("Error: centros debe ser un array",e),{success:!1,message:"Lista de centros inv\xe1lida",error:"centros debe ser un array"};if(!Array.isArray(t))return console.error("Error: asignaciones debe ser un array",t),{success:!1,message:"Lista de asignaciones inv\xe1lida",error:"asignaciones debe ser un array"};if(!n)return console.error("Error: no se proporcion\xf3 la referencia a la base de datos"),{success:!1,message:"Referencia a la base de datos no proporcionada",error:"db es requerido"};console.log("Verificando centros con exceso de asignaciones...");const r=e.filter((e=>e&&"object"===typeof e&&!isNaN(e.asignadas)&&!isNaN(e.plazas)));if(0===r.length)return console.log("No hay centros v\xe1lidos para verificar"),{success:!0,message:"No hay centros v\xe1lidos para verificar",corregidos:0};const i=r.filter((e=>e.asignadas>e.plazas));if(0===i.length)return console.log("No se encontraron centros con exceso de asignaciones"),{success:!0,message:"No hay centros con exceso",corregidos:0};console.log(`Centros con exceso: ${i.length}`);const o=r.filter((e=>e.asignadas<e.plazas));let s=0,a=0,l=0;for(const e of i){if(!e.centro||!e.id){console.warn("Centro inv\xe1lido:",e);continue}console.log(`Centro ${e.centro}: ${e.asignadas} asignadas, ${e.plazas} plazas`);const r=t.filter((t=>t&&t.id===e.id));if(!r.length){console.warn(`No se encontraron asignaciones para ${e.centro}`);continue}if(r.sort(((e,t)=>(Number(e.order)||0)-(Number(t.order)||0))),e.asignadas-e.plazas<=0)continue;const i=r.slice(e.plazas);console.log(`Procesando ${i.length} asignaciones excedentes en ${e.centro}`);for(const t of i)try{let r=!1;const i=o.filter((t=>t.id!==e.id));if(i.length>0){const o=[...i].sort(((e,t)=>e.asignadas/e.plazas-t.asignadas/t.plazas)),s=o[0];if(s&&s.asignadas<s.plazas){const i=Mh(Lh(n,"asignaciones")),o={order:t.order,id:s.id,localidad:s.localidad,centro:s.centro,municipio:s.municipio,timestamp:Date.now(),reasignado:!0,centroOriginal:e.centro};await $f(i,o),await Bf(Mh(n,"centros",s.docId),{asignadas:s.asignadas+1});const l=Mh(Lh(n,"historialSolicitudes")),c={orden:t.order,centroIdOriginal:t.id,centroIdNuevo:s.id,estado:"REASIGNADO",mensaje:`Reasignaci\xf3n de ${e.centro} a ${s.centro} por exceso de plazas`,centroOriginal:t.centro||e.centro,centroAsignado:s.centro,localidad:s.localidad,municipio:s.municipio,fechaHistorico:(new Date).toISOString(),timestamp:Date.now()};await $f(l,c),s.asignadas++,r=!0,a++,console.log(`Asignaci\xf3n ${t.order} reasignada de ${e.centro} a ${s.centro}`)}}if(!r)try{const r=Mh(Lh(n,"historialSolicitudes")),i={orden:t.order,centroId:t.id,estado:"EXCESO_NO_REASIGNABLE",mensaje:`Centro ${e.centro} con exceso de plazas. Se mantiene la asignaci\xf3n actual.`,centroAsignado:t.centro||e.centro,localidad:t.localidad||e.localidad,municipio:t.municipio||e.municipio,fechaHistorico:(new Date).toISOString(),timestamp:Date.now()};await $f(r,i),console.log(`Asignaci\xf3n ${t.order} en exceso en ${e.centro}, pero se mantiene sin convertir a solicitud pendiente`),s++}catch(Yv){console.error(`Error al registrar en historial para orden ${t.order}:`,Yv)}t.docId?(await qf(Mh(n,"asignaciones",t.docId)),s++,console.log(`Asignaci\xf3n ${t.docId} eliminada`)):console.warn(`Asignaci\xf3n sin docId para orden ${t.order}`)}catch(Yv){console.error(`Error al corregir asignaci\xf3n para orden ${t.order}:`,Yv)}if(e.docId)try{await Bf(Mh(n,"centros",e.docId),{asignadas:e.plazas}),console.log(`Contador actualizado para ${e.centro}: ${e.plazas}`)}catch(Yv){console.error(`Error al actualizar contador para ${e.centro}:`,Yv)}else console.warn(`Centro ${e.centro} sin docId, no se actualiz\xf3 contador`)}return{success:!0,message:`Se corrigieron ${s} asignaciones excedentes (${a} reasignadas, ${l} recuperadas)`,corregidos:s,reasignados:a,recuperados:l}}catch(Yv){return console.error("Error en verificaci\xf3n y correcci\xf3n:",Yv),{success:!1,error:Yv.message,message:"Error en verificaci\xf3n: "+Yv.message}}})(e,n,Vv);return C(90),T(r.success?`${r.message}. Actualizando interfaz...`:`Error durante la verificaci\xf3n: ${r.message}`),await ze(),C(100),T(r.success?`Verificaci\xf3n completada exitosamente. Se corrigieron ${r.corregidos} asignaciones (${r.reasignados} reasignadas).`:`Error durante la verificaci\xf3n: ${r.message}`),await new Promise((e=>setTimeout(e,2e3))),E(!1),r.success?(Oe(r.message,"success"),localStorage.setItem("ultimaVerificacionDiaria",Date.now().toString())):Oe(r.message||"Error al verificar asignaciones","error"),r}catch(Yv){console.error("Error al verificar asignaciones:",Yv),T(`Error al verificar asignaciones: ${Yv.message}`),await new Promise((e=>setTimeout(e,2e3))),E(!1),Oe("Error al verificar asignaciones: "+Yv.message,"error")}},We=async()=>{try{if("true"===localStorage.getItem("historialLimpiado"))return console.log("La limpieza del historial ya se ha realizado con \xe9xito anteriormente"),{success:!0,eliminados:0,yaRealizado:!0};h&&h("Limpiando duplicados en historial de solicitudes...");const e=[];if((await Uf(Ef(Lh(Vv,"historialSolicitudes"),Nf(1e4)))).forEach((t=>{e.push({...t.data(),docId:t.id})})),0===e.length)return Oe("No hay entradas en el historial de solicitudes","info"),{success:!0,eliminados:0};console.log(`Procesando ${e.length} documentos del historial`);const t={};e.forEach((e=>{const n=e.orden;if(!n)return;let r="desconocida";if(e.timestamp){const t=new Date(e.timestamp);r=`${t.getFullYear()}-${t.getMonth()+1}-${t.getDate()}`}else e.fechaHistorico&&(r=e.fechaHistorico.split("T")[0]);const i=`${n}-${e.estado||"DESCONOCIDO"}-${e.centroId||e.centroAsignado||"sin-centro"}-${r}`;t[i]?t[i].push(e):t[i]=[e]}));let n=0;if(Object.values(t).forEach((e=>{e.length>1&&(n+=e.length-1)})),0===n)return Oe("No se encontraron entradas duplicadas en el historial","success"),localStorage.setItem("historialLimpiado","true"),{success:!0,eliminados:0};console.log(`Se encontraron ${n} entradas duplicadas para eliminar`);const r=450;let i=0,o=0,s=[];for(const a in t){const e=t[a];e.length>1&&(e.sort(((e,t)=>{const n=e.timestamp||0;return(t.timestamp||0)-n})),s.push(...e.slice(1)))}for(let a=0;a<s.length;a+=r){const e=Xf(Vv),t=s.slice(a,a+r);for(const n of t)n.docId&&(e.delete(Mh(Vv,"historialSolicitudes",n.docId)),i++);await e.commit(),o+=t.length,console.log(`Procesado lote ${Math.floor(a/r)+1}: ${t.length} elementos (total ${o}/${s.length})`),await new Promise((e=>setTimeout(e,1e3))),h&&h(`Limpiando duplicados: ${o}/${s.length} (${Math.round(o/s.length*100)}%)`)}return i>0&&(console.log(`Se eliminaron ${i} entradas duplicadas del historial`),Oe(`Se han eliminado ${i} entradas duplicadas del historial`,"success"),localStorage.setItem("historialLimpiado","true")),await ze(),{success:!0,eliminados:i}}catch(Yv){return console.error("Error al limpiar duplicados del historial:",Yv),Oe(`Error al limpiar duplicados: ${Yv.message}`,"error"),{success:!1,error:Yv.message}}finally{h&&h("")}};(0,r.useEffect)((()=>{const e=()=>{const e=Date.now(),t=se.current;(0===t||e-t>36e5)&&Le()};n.length>10&&e();const t=setInterval((()=>{e()}),9e5);return()=>clearInterval(t)}),[n.length]);const Ge=async()=>{if(re.current)return console.log("Ya hay un procesamiento en curso. Se omite la verificaci\xf3n por minuto."),!1;try{const t=await Uf(Lh(Vv,"solicitudesPendientes"));if(t.empty)return console.log("No hay solicitudes pendientes para procesar en la verificaci\xf3n por minuto."),!0;const n=t.docs.map((e=>({...e.data(),docId:e.id,centrosIds:e.data().centrosIds||e.data().centrosSeleccionados||[]})));console.log(`Verificaci\xf3n por minuto: Procesando ${n.length} solicitudes pendientes...`);const r=n.sort(((e,t)=>Number(e.orden)-Number(t.orden))),i=(await Uf(Lh(Vv,"asignaciones"))).docs.map((e=>({...e.data(),docId:e.id}))),o={};i.forEach((e=>{e.centerId&&(o[e.centerId]||(o[e.centerId]=[]),o[e.centerId].push(e))}));const s=new Map;i.forEach((e=>{e.order&&s.set(e.order,e)}));let a=0,l=0;const c=Xf(Vv);for(const u of r){const t=Number(u.orden);if(s.has(t)){console.log(`La orden ${t} ya tiene una asignaci\xf3n.`),c.delete(Mh(Vv,"solicitudesPendientes",u.docId));continue}let n=null,r=null;for(const s of u.centrosIds){const i=e.find((e=>e.id===s));if(i){if(i.asignadas<i.plazas){n=s;break}{const e=(o[s]||[]).reduce(((e,t)=>{const n=Number(e.order||0);return Number(t.order||0)>n?t:e}),{order:0});if(e.order&&Number(e.order)>t){n=s,r=e;break}}}}if(!n){console.log(`No se encontr\xf3 plaza disponible para la orden ${t}.`);continue}const i=e.find((e=>e.id===n));if(r){console.log(`Desplazando asignaci\xf3n de orden ${r.order} para asignar orden ${t} en centro ${n}`),c.delete(Mh(Vv,"asignaciones",r.docId));const e={orden:r.order,centrosIds:[r.centerId],timestamp:Yf(),desplazada:!0,desplazadaPor:t},i=Mh(Lh(Vv,"solicitudesPendientes"));c.set(i,e);const o=Mh(Lh(Vv,"historialSolicitudes"));c.set(o,{orden:r.order,centroAnterior:r.centerId,centroId:null,estado:"DESPLAZADA",mensaje:`Desplazada por orden ${t} de mayor prioridad`,fechaHistorico:(new Date).toISOString(),timestamp:Date.now()}),l++}const d={order:t,centerId:n,centerName:i?i.nombre:"Centro Desconocido",timestamp:Yf()},h=Mh(Lh(Vv,"asignaciones"));c.set(h,d),c.delete(Mh(Vv,"solicitudesPendientes",u.docId));const f=Mh(Lh(Vv,"historialSolicitudes"));c.set(f,{orden:t,centroId:n,estado:r?"PRIORIZADA":"ASIGNADA",mensaje:r?`Asignada con prioridad, desplazando orden ${r.order}`:"Asignada durante procesamiento regular",fechaHistorico:(new Date).toISOString(),timestamp:Date.now()}),a++}return 0===a&&0===l?(console.log("Verificaci\xf3n por minuto: No se realizaron cambios en las asignaciones."),!0):(await c.commit(),console.log(`Verificaci\xf3n por minuto completada: ${a} nuevas asignaciones, ${l} reasignaciones por prioridad.`),(a>0||l>0)&&(await ze(),fe((new Date).toLocaleString()),a+l>0&&Oe(`Procesamiento autom\xe1tico: ${a} nuevas asignaciones, ${l} reasignaciones por prioridad.`,"success")),!0)}catch(Yv){return console.error("Error en procesamiento por minuto:",Yv),!1}};return(0,r.useEffect)((()=>{console.log("Configurando verificaci\xf3n de solicitudes cada minuto...");const e=setTimeout((()=>{Ge()}),3e4),t=setInterval((()=>{Ge()}),6e4);return()=>{clearTimeout(e),clearInterval(t)}}),[]),N?(0,$v.jsx)(Wv,{assignments:n,availablePlazas:e,solicitudes:o,procesarTodasLasSolicitudes:Ue,procesarSolicitudesPorMinuto:Ge,cargarDatosDesdeFirebase:ze,eliminarSolicitudesDuplicadas:Be,limpiarDuplicadosHistorial:We,db:Vv,loadingProcess:c,processingMessage:d,showNotification:Oe,lastProcessed:g,procesarSolicitudes:Uv}):(0,$v.jsxs)("div",{className:"App",style:$e.container,children:[pe&&(0,$v.jsx)("div",{className:"modal-backdrop",children:(0,$v.jsxs)("div",{className:"modal-content password-modal",children:[(0,$v.jsx)("h3",{children:"Verificaci\xf3n de Administrador"}),(0,$v.jsx)("p",{children:"Ingrese la contrase\xf1a para ejecutar la verificaci\xf3n"}),(0,$v.jsxs)("form",{onSubmit:e=>{e.preventDefault(),"SoyAdmin"===me?(ge(!1),ye(""),be(!1),Ue({respetarAsignacionesExistentes:!1})):(be(!0),setTimeout((()=>be(!1)),3e3))},children:[(0,$v.jsx)("input",{type:"password",value:me,onChange:e=>ye(e.target.value),placeholder:"Contrase\xf1a"}),ve&&(0,$v.jsx)("p",{className:"error-message",children:ve}),(0,$v.jsxs)("div",{className:"modal-actions",children:[(0,$v.jsx)("button",{type:"button",className:"modal-button cancel",onClick:()=>{ge(!1),ye(""),be("")},children:"Cancelar"}),(0,$v.jsx)("button",{type:"submit",className:"modal-button",children:"Verificar"})]})]})]})}),S&&(0,$v.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"#0a192f",zIndex:9999,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",color:"white",padding:"20px"},children:(0,$v.jsxs)("div",{style:{backgroundColor:"rgba(255, 255, 255, 0.1)",borderRadius:"16px",padding:"40px",maxWidth:"500px",width:"90%",textAlign:"center",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.2)",backdropFilter:"blur(8px)"},children:[(0,$v.jsx)("div",{style:{fontSize:"28px",fontWeight:"bold",marginBottom:"20px",color:"#64ffda"},children:"SISTEMA EN MANTENIMIENTO"}),(0,$v.jsx)("div",{style:{fontSize:"18px",lineHeight:"1.6",marginBottom:"10px"},children:_||"Estamos verificando y actualizando las asignaciones..."}),(0,$v.jsxs)("div",{style:{fontSize:"16px",marginBottom:"20px"},children:["Solicitudes pendientes: ",o.length]}),(0,$v.jsx)("div",{style:{width:"100%",height:"8px",backgroundColor:"rgba(255, 255, 255, 0.1)",borderRadius:"4px",marginBottom:"10px",overflow:"hidden"},children:(0,$v.jsx)("div",{style:{height:"100%",width:`${k}%`,backgroundColor:"#64ffda",borderRadius:"4px",transition:"width 0.5s ease"}})}),(0,$v.jsxs)("div",{style:{fontSize:"14px",color:"#8892b0"},children:[k,"% completado"]}),(0,$v.jsx)("div",{style:{marginTop:"30px",fontSize:"14px",color:"#8892b0",fontStyle:"italic"},children:"Por favor espere. El sistema volver\xe1 a estar disponible autom\xe1ticamente."})]})}),(0,$v.jsxs)("div",{style:$e.header,children:[(0,$v.jsx)("h1",{style:$e.title,children:"Sistema de Asignaci\xf3n de Plazas"}),(()=>{const e=localStorage.getItem("ultimaVerificacionDiaria");if(!e)return!0;const t=new Date(Number(e)),n=new Date;return!(t.getDate()===n.getDate()&&t.getMonth()===n.getMonth()&&t.getFullYear()===n.getFullYear())})()&&(0,$v.jsx)("div",{style:{position:"absolute",top:"20px",right:"20px",zIndex:50},children:(0,$v.jsx)("button",{onClick:()=>ge(!0),style:{padding:"12px 20px",backgroundColor:"#3498db",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"15px",fontWeight:"500",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:"\ud83d\udd04 Verificar Asignaciones Hoy"})}),(0,$v.jsxs)("div",{style:$e.tabs,children:[(0,$v.jsx)("div",{style:{...$e.tab,..."asignaciones"===Z?$e.activeTab:$e.inactiveTab},onClick:()=>ee("asignaciones"),children:"\ud83d\udccb Historial de Asignaciones"}),(0,$v.jsx)("div",{style:{...$e.tab,..."solicitudes"===Z?$e.activeTab:$e.inactiveTab},onClick:()=>ee("solicitudes"),children:"\ud83d\udd0d Solicitudes Pendientes"}),(0,$v.jsx)("div",{style:{...$e.tab,..."plazas"===Z?$e.activeTab:$e.inactiveTab},onClick:()=>ee("plazas"),children:"\ud83c\udfe2 Plazas Disponibles"})]})]}),(0,$v.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px",fontSize:"14px",color:"#666",padding:"8px 12px",backgroundColor:"#f0f8ff",borderRadius:"6px"},children:[(0,$v.jsxs)("div",{children:[(0,$v.jsx)("span",{style:{fontWeight:"bold",marginRight:"5px"},children:"Plazas disponibles:"}),7066-n.length," de 7066"," "]}),(0,$v.jsxs)("div",{style:{display:"flex",alignItems:"center",flexWrap:"wrap"},children:[o.length>0&&(0,$v.jsx)("span",{style:{marginRight:"10px",color:c?"#e74c3c":"#2ecc71"},children:c?(0,$v.jsxs)($v.Fragment,{children:[(0,$v.jsx)("span",{style:{display:"inline-block",width:"12px",height:"12px",border:"2px solid rgba(231,76,60,0.3)",borderRadius:"50%",borderTopColor:"#e74c3c",animation:"spin 1s linear infinite",marginRight:"5px",verticalAlign:"middle"}}),"Procesando ",o.length," solicitudes..."]}):(0,$v.jsxs)($v.Fragment,{children:[(0,$v.jsx)("span",{style:{color:"#2ecc71",marginRight:"5px"},children:"\u25cf"}),o.length," solicitudes pendientes"]})}),(0,$v.jsx)("span",{style:{fontWeight:"bold",marginRight:"5px"},children:"\xdaltima actualizaci\xf3n:"}),g&&"function"===typeof g.getTime?(()=>{const e=g.getHours(),t=g.getMinutes();return 2===e&&0===t?"Actualizado":new Intl.DateTimeFormat("es-ES",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).format(g)})():"No disponible"]})]}),"asignaciones"===Z&&(0,$v.jsxs)("div",{style:$e.cardContainer,children:[(0,$v.jsx)("h3",{style:$e.sectionTitle,children:"Historial de Asignaciones"}),(0,$v.jsx)(Bv,{assignments:n,availablePlazas:e})]}),"solicitudes"===Z&&(0,$v.jsxs)("div",{style:$e.cardContainer,children:[(0,$v.jsx)("h3",{style:$e.sectionTitle,children:"Solicitudes Pendientes"}),(0,$v.jsx)(Hv,{solicitudes:o||[],assignments:n||[],availablePlazas:e||[]})]}),"plazas"===Z&&(0,$v.jsxs)("div",{style:$e.cardContainer,children:[(0,$v.jsx)("h3",{style:$e.sectionTitle,children:"Plazas Disponibles"}),e.length>0?(0,$v.jsx)(qv,{availablePlazas:e,assignments:n,searchTerm:B,setSearchTerm:q,orderNumber:L,setOrderNumber:M,centrosSeleccionados:j,setCentrosSeleccionados:z,handleOrderSubmit:async(e,t)=>{if(console.log(`Iniciando env\xedo de solicitud para orden ${e}`),void 0===e||null===e||""===e)return console.error("Error en enviarSolicitud: orderNumber es null, undefined o vac\xedo"),Oe("Error: N\xfamero de orden inv\xe1lido","error"),!1;if(!t||!Array.isArray(t)||0===t.length)return console.error("Error en enviarSolicitud: No hay centros seleccionados",t),Oe("Error: Debe seleccionar al menos un centro","error"),!1;const n=Number(e);if(isNaN(n))return console.error("Error en enviarSolicitud: orderNumber no es un n\xfamero v\xe1lido",e),Oe("Error: N\xfamero de orden inv\xe1lido","error"),!1;console.log(`Procesando solicitud para orden ${n} con centros:`,t);try{const e=await He();if(!e||!e.success)return console.error("Error de conexi\xf3n con Firebase:",(null===e||void 0===e?void 0:e.error)||"Sin detalles adicionales"),Oe("Error de conexi\xf3n con la base de datos. Por favor, verifica tu conexi\xf3n a internet.","error"),!1;try{if(!(await Uf(Ef(Lh(Vv,"asignaciones"),Tf("order","==",n)))).empty)return console.log(`Ya existe una asignaci\xf3n para la orden ${n}`),Oe(`La orden ${n} ya tiene una asignaci\xf3n en el sistema.`,"error"),!1}catch(Yv){return console.error("Error al verificar asignaciones existentes:",Yv),Oe("Error al verificar asignaciones existentes. Intente nuevamente.","error"),!1}let r=null;try{const e=await Uf(Ef(Lh(Vv,"solicitudesPendientes"),Tf("orden","==",n)));e.empty||(r=e.docs[0].id,console.log(`Encontrada solicitud existente con ID ${r} para orden ${n}`))}catch(Yv){return console.error("Error al verificar solicitudes pendientes existentes:",Yv),Oe("Error al verificar solicitudes pendientes. Intente nuevamente.","error"),!1}try{if(r)await Bf(Mh(Vv,"solicitudesPendientes",r),{centrosSeleccionados:t,timestamp:Yf()}),console.log(`Actualizada solicitud existente ${r} para orden ${n}`);else{const e={orden:n,centrosIds:t,timestamp:Yf()};await $f(Mh(Lh(Vv,"solicitudesPendientes")),e),console.log(`Creada nueva solicitud para orden ${n}`)}console.log(`Solicitud para orden ${n} enviada correctamente`),Oe(`Solicitud para orden ${n} enviada correctamente. Ser\xe1 procesada autom\xe1ticamente.`,"success"),await ze();const e=new Date,i=Mh(Lh(Vv,"historialSolicitudes"));return await $f(i,{orden:n,centrosIds:t,estado:"PENDIENTE",mensaje:"Solicitud a\xf1adida a la cola de procesamiento",fechaHistorico:e.toISOString(),timestamp:e.getTime()}),M(""),z([]),ee("solicitudes"),!0}catch(Yv){return console.error("Error al guardar solicitud:",Yv),Oe(`Error al procesar la solicitud: ${Yv.message}`,"error"),!1}}catch(Yv){return console.error(`Error al enviar solicitud para orden ${n}:`,Yv),Oe(`Error al enviar solicitud: ${Yv.message}`,"error"),!1}},isProcessing:F}):(0,$v.jsxs)("div",{style:{textAlign:"center",padding:"40px 20px",backgroundColor:"#f5f7fa",borderRadius:"8px",color:"#5c6c7c"},children:[(0,$v.jsx)("div",{style:{fontSize:"36px",marginBottom:"15px"},children:"\ud83c\udfe2"}),(0,$v.jsx)("div",{style:{fontSize:"18px",fontWeight:"bold",marginBottom:"10px"},children:"Cargando plazas..."}),(0,$v.jsx)("div",{style:{fontSize:"14px",marginBottom:"20px"},children:"Por favor espera mientras se cargan los datos de los centros."}),(0,$v.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"10px"},children:[(0,$v.jsx)("div",{style:{width:"20px",height:"20px",border:"3px solid rgba(0,0,0,0.1)",borderRadius:"50%",borderTopColor:"#3498db",animation:"spin 1s linear infinite"}}),(0,$v.jsx)("div",{children:"Cargando datos..."})]})]})]}),(0,$v.jsx)(Kv,{}),W&&(0,$v.jsx)("div",{style:{...$e.popup,backgroundColor:"success"===X?"#d4edda":"warning"===X?"#fff3cd":"#f8d7da",color:"success"===X?"#155724":"warning"===X?"#856404":"#721c24"},children:(0,$v.jsxs)("div",{style:{display:"flex",alignItems:"flex-start"},children:[(0,$v.jsx)("div",{style:{flex:1},children:Q}),(0,$v.jsx)("button",{onClick:()=>G(!1),style:{background:"none",border:"none",cursor:"pointer",fontSize:"18px",marginLeft:"10px",color:"inherit"},children:"\xd7"})]})}),(c||f)&&(0,$v.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:999},children:(0,$v.jsxs)("div",{style:{backgroundColor:"white",padding:"20px",borderRadius:"10px",boxShadow:"0 0 20px rgba(0,0,0,0.2)",maxWidth:"500px",width:"90%",textAlign:"center"},children:[(0,$v.jsx)("div",{style:{marginBottom:"15px",fontSize:"18px"},children:f?"Cargando datos...":"Procesando solicitudes..."}),(0,$v.jsx)("div",{children:d}),(0,$v.jsx)("div",{style:{width:"100%",height:"4px",backgroundColor:"#f1f1f1",borderRadius:"2px",marginTop:"15px",overflow:"hidden",position:"relative"},children:(0,$v.jsx)("div",{style:{position:"absolute",top:0,left:0,height:"100%",width:"30%",backgroundColor:"#3498db",borderRadius:"2px",animation:"loading 1.5s infinite ease-in-out"}})})]})}),(0,$v.jsx)("style",{children:"\n        @keyframes slideIn {\n          0% { transform: translateX(100%); opacity: 0; }\n          100% { transform: translateX(0); opacity: 1; }\n        }\n        @keyframes loading {\n          0% { left: -30%; }\n          100% { left: 100%; }\n        }\n        @keyframes spin {\n          0% { transform: rotate(0deg); }\n          100% { transform: rotate(360deg); }\n        }\n      "})]})},Qv=e=>{e&&e instanceof Function&&n.e(453).then(n.bind(n,453)).then((t=>{let{getCLS:n,getFID:r,getFCP:i,getLCP:o,getTTFB:s}=t;n(e),r(e),i(e),o(e),s(e)}))};i.createRoot(document.getElementById("root")).render((0,$v.jsx)(r.StrictMode,{children:(0,$v.jsx)(Gv,{})})),Qv()})();
//# sourceMappingURL=main.2e55cc77.js.map