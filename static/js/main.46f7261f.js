/*! For license information please see main.46f7261f.js.LICENSE.txt */
(()=>{"use strict";var e={43:(e,t,n)=>{e.exports=n(202)},153:(e,t,n)=>{var r=n(43),a=Symbol.for("react.element"),i=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,n){var r,i={},l=null,u=null;for(r in void 0!==n&&(l=""+n),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(u=t.ref),t)s.call(t,r)&&!c.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:a,type:e,key:l,ref:u,props:i,_owner:o.current}}t.Fragment=i,t.jsx=l,t.jsxs=l},202:(e,t)=>{var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),c=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,m={};function v(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var w=b.prototype=new y;w.constructor=b,g(w,v.prototype),w.isPureReactComponent=!0;var E=Array.isArray,T=Object.prototype.hasOwnProperty,x={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function I(e,t,r){var a,i={},s=null,o=null;if(null!=t)for(a in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(s=""+t.key),t)T.call(t,a)&&!S.hasOwnProperty(a)&&(i[a]=t[a]);var c=arguments.length-2;if(1===c)i.children=r;else if(1<c){for(var l=Array(c),u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}if(e&&e.defaultProps)for(a in c=e.defaultProps)void 0===i[a]&&(i[a]=c[a]);return{$$typeof:n,type:e,key:s,ref:o,props:i,_owner:x.current}}function k(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var _=/\/+/g;function C(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function A(e,t,a,i,s){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var c=!1;if(null===e)c=!0;else switch(o){case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case n:case r:c=!0}}if(c)return s=s(c=e),e=""===i?"."+C(c,0):i,E(s)?(a="",null!=e&&(a=e.replace(_,"$&/")+"/"),A(s,t,a,"",(function(e){return e}))):null!=s&&(k(s)&&(s=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,a+(!s.key||c&&c.key===s.key?"":(""+s.key).replace(_,"$&/")+"/")+e)),t.push(s)),1;if(c=0,i=""===i?".":i+":",E(e))for(var l=0;l<e.length;l++){var u=i+C(o=e[l],l);c+=A(o,t,a,u,s)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),l=0;!(o=e.next()).done;)c+=A(o=o.value,t,a,u=i+C(o,l++),s);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return c}function N(e,t,n){if(null==e)return e;var r=[],a=0;return A(e,r,"","",(function(e){return t.call(n,e,a++)})),r}function R(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var O={current:null},D={transition:null},P={ReactCurrentDispatcher:O,ReactCurrentBatchConfig:D,ReactCurrentOwner:x};function L(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:N,forEach:function(e,t,n){N(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return N(e,(function(){t++})),t},toArray:function(e){return N(e,(function(e){return e}))||[]},only:function(e){if(!k(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=a,t.Profiler=s,t.PureComponent=b,t.StrictMode=i,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=P,t.act=L,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=g({},e.props),i=e.key,s=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,o=x.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(l in t)T.call(t,l)&&!S.hasOwnProperty(l)&&(a[l]=void 0===t[l]&&void 0!==c?c[l]:t[l])}var l=arguments.length-2;if(1===l)a.children=r;else if(1<l){c=Array(l);for(var u=0;u<l;u++)c[u]=arguments[u+2];a.children=c}return{$$typeof:n,type:e.type,key:i,ref:s,props:a,_owner:o}},t.createContext=function(e){return(e={$$typeof:c,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=I,t.createFactory=function(e){var t=I.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:l,render:e}},t.isValidElement=k,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:R}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=D.transition;D.transition={};try{e()}finally{D.transition=t}},t.unstable_act=L,t.useCallback=function(e,t){return O.current.useCallback(e,t)},t.useContext=function(e){return O.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return O.current.useDeferredValue(e)},t.useEffect=function(e,t){return O.current.useEffect(e,t)},t.useId=function(){return O.current.useId()},t.useImperativeHandle=function(e,t,n){return O.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return O.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return O.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return O.current.useMemo(e,t)},t.useReducer=function(e,t,n){return O.current.useReducer(e,t,n)},t.useRef=function(e){return O.current.useRef(e)},t.useState=function(e){return O.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return O.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return O.current.useTransition()},t.version="18.3.1"},234:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,a=e[r];if(!(0<i(a,t)))break e;e[r]=t,e[n]=a,n=r}}function r(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length,s=a>>>1;r<s;){var o=2*(r+1)-1,c=e[o],l=o+1,u=e[l];if(0>i(c,n))l<a&&0>i(u,c)?(e[r]=u,e[l]=n,r=l):(e[r]=c,e[o]=n,r=o);else{if(!(l<a&&0>i(u,n)))break e;e[r]=u,e[l]=n,r=l}}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,c=o.now();t.unstable_now=function(){return o.now()-c}}var l=[],u=[],d=1,h=null,f=3,p=!1,g=!1,m=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=r(u);null!==t;){if(null===t.callback)a(u);else{if(!(t.startTime<=e))break;a(u),t.sortIndex=t.expirationTime,n(l,t)}t=r(u)}}function E(e){if(m=!1,w(e),!g)if(null!==r(l))g=!0,D(T);else{var t=r(u);null!==t&&P(E,t.startTime-e)}}function T(e,n){g=!1,m&&(m=!1,y(k),k=-1),p=!0;var i=f;try{for(w(n),h=r(l);null!==h&&(!(h.expirationTime>n)||e&&!A());){var s=h.callback;if("function"===typeof s){h.callback=null,f=h.priorityLevel;var o=s(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof o?h.callback=o:h===r(l)&&a(l),w(n)}else a(l);h=r(l)}if(null!==h)var c=!0;else{var d=r(u);null!==d&&P(E,d.startTime-n),c=!1}return c}finally{h=null,f=i,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var x,S=!1,I=null,k=-1,_=5,C=-1;function A(){return!(t.unstable_now()-C<_)}function N(){if(null!==I){var e=t.unstable_now();C=e;var n=!0;try{n=I(!0,e)}finally{n?x():(S=!1,I=null)}}else S=!1}if("function"===typeof b)x=function(){b(N)};else if("undefined"!==typeof MessageChannel){var R=new MessageChannel,O=R.port2;R.port1.onmessage=N,x=function(){O.postMessage(null)}}else x=function(){v(N,0)};function D(e){I=e,S||(S=!0,x())}function P(e,n){k=v((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){g||p||(g=!0,D(T))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,a,i){var s=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?s+i:s:i=s,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:d++,callback:a,priorityLevel:e,startTime:i,expirationTime:o=i+o,sortIndex:-1},i>s?(e.sortIndex=i,n(u,e),null===r(l)&&e===r(u)&&(m?(y(k),k=-1):m=!0,P(E,i-s))):(e.sortIndex=o,n(l,e),g||p||(g=!0,D(T))),e},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},391:(e,t,n)=>{var r=n(950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},579:(e,t,n)=>{e.exports=n(153)},730:(e,t,n)=>{var r=n(43),a=n(853);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,o={};function c(e,t){l(e,t),l(e+"Capture",t)}function l(e,t){for(o[e]=t,e=0;e<t.length;e++)s.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function g(e,t,n,r,a,i,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=s}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){m[e]=new g(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];m[t]=new g(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){m[e]=new g(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){m[e]=new g(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){m[e]=new g(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){m[e]=new g(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){m[e]=new g(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){m[e]=new g(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){m[e]=new g(e,5,!1,e.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,r){var a=m.hasOwnProperty(t)?m[t]:null;(null!==a?0!==a.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,a,r)&&(n=null),r||null===a?function(e){return!!d.call(p,e)||!d.call(f,e)&&(h.test(e)?p[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=null===n?3!==a.type&&"":n:(t=a.attributeName,r=a.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(a=a.type)||4===a&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(v,y);m[t]=new g(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(v,y);m[t]=new g(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(v,y);m[t]=new g(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!1,!1)})),m.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!0,!0)}));var w=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,E=Symbol.for("react.element"),T=Symbol.for("react.portal"),x=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),I=Symbol.for("react.profiler"),k=Symbol.for("react.provider"),_=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),N=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),O=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var D=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var P=Symbol.iterator;function L(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=P&&e[P]||e["@@iterator"])?e:null}var M,F=Object.assign;function z(e){if(void 0===M)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);M=t&&t[1]||""}return"\n"+M+e}var j=!1;function U(e,t){if(!e||j)return"";j=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var r=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){r=l}e.call(t.prototype)}else{try{throw Error()}catch(l){r=l}e()}}catch(l){if(l&&r&&"string"===typeof l.stack){for(var a=l.stack.split("\n"),i=r.stack.split("\n"),s=a.length-1,o=i.length-1;1<=s&&0<=o&&a[s]!==i[o];)o--;for(;1<=s&&0<=o;s--,o--)if(a[s]!==i[o]){if(1!==s||1!==o)do{if(s--,0>--o||a[s]!==i[o]){var c="\n"+a[s].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}}while(1<=s&&0<=o);break}}}finally{j=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?z(e):""}function B(e){switch(e.tag){case 5:return z(e.type);case 16:return z("Lazy");case 13:return z("Suspense");case 19:return z("SuspenseList");case 0:case 2:case 15:return e=U(e.type,!1);case 11:return e=U(e.type.render,!1);case 1:return e=U(e.type,!0);default:return""}}function V(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case x:return"Fragment";case T:return"Portal";case I:return"Profiler";case S:return"StrictMode";case A:return"Suspense";case N:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case _:return(e.displayName||"Context")+".Consumer";case k:return(e._context.displayName||"Context")+".Provider";case C:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case R:return null!==(t=e.displayName||null)?t:V(e.type)||"Memo";case O:t=e._payload,e=e._init;try{return V(e(t))}catch(n){}}return null}function $(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(t);case 8:return t===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function H(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function W(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function G(e){e._valueTracker||(e._valueTracker=function(e){var t=W(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var a=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=W(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function q(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(St){return e.body}}function Y(e,t){var n=t.checked;return F({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function X(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=H(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Q(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function J(e,t){Q(e,t);var n=H(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,H(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&q(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+H(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(i(91));return F({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ae(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(i(92));if(te(n)){if(1<n.length)throw Error(i(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:H(n)}}function ie(e,t){var n=H(t.value),r=H(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function se(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ce(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var le,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((le=le||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=le.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function ge(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function me(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),a=ge(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}Object.keys(fe).forEach((function(e){pe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]}))}));var ve=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(i(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(i(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(i(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var we=null;function Ee(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Te=null,xe=null,Se=null;function Ie(e){if(e=Ta(e)){if("function"!==typeof Te)throw Error(i(280));var t=e.stateNode;t&&(t=Sa(t),Te(e.stateNode,e.type,t))}}function ke(e){xe?Se?Se.push(e):Se=[e]:xe=e}function _e(){if(xe){var e=xe,t=Se;if(Se=xe=null,Ie(e),t)for(e=0;e<t.length;e++)Ie(t[e])}}function Ce(e,t){return e(t)}function Ae(){}var Ne=!1;function Re(e,t,n){if(Ne)return e(t,n);Ne=!0;try{return Ce(e,t,n)}finally{Ne=!1,(null!==xe||null!==Se)&&(Ae(),_e())}}function Oe(e,t){var n=e.stateNode;if(null===n)return null;var r=Sa(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(i(231,t,typeof n));return n}var De=!1;if(u)try{var Pe={};Object.defineProperty(Pe,"passive",{get:function(){De=!0}}),window.addEventListener("test",Pe,Pe),window.removeEventListener("test",Pe,Pe)}catch(ue){De=!1}function Le(e,t,n,r,a,i,s,o,c){var l=Array.prototype.slice.call(arguments,3);try{t.apply(n,l)}catch(u){this.onError(u)}}var Me=!1,Fe=null,ze=!1,je=null,Ue={onError:function(e){Me=!0,Fe=e}};function Be(e,t,n,r,a,i,s,o,c){Me=!1,Fe=null,Le.apply(Ue,arguments)}function Ve(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function $e(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function He(e){if(Ve(e)!==e)throw Error(i(188))}function We(e){return e=function(e){var t=e.alternate;if(!t){if(null===(t=Ve(e)))throw Error(i(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var s=a.alternate;if(null===s){if(null!==(r=a.return)){n=r;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===n)return He(a),e;if(s===r)return He(a),t;s=s.sibling}throw Error(i(188))}if(n.return!==r.return)n=a,r=s;else{for(var o=!1,c=a.child;c;){if(c===n){o=!0,n=a,r=s;break}if(c===r){o=!0,r=a,n=s;break}c=c.sibling}if(!o){for(c=s.child;c;){if(c===n){o=!0,n=s,r=a;break}if(c===r){o=!0,r=s,n=a;break}c=c.sibling}if(!o)throw Error(i(189))}}if(n.alternate!==r)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?e:t}(e),null!==e?Ge(e):null}function Ge(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ge(e);if(null!==t)return t;e=e.sibling}return null}var Ke=a.unstable_scheduleCallback,qe=a.unstable_cancelCallback,Ye=a.unstable_shouldYield,Xe=a.unstable_requestPaint,Qe=a.unstable_now,Je=a.unstable_getCurrentPriorityLevel,Ze=a.unstable_ImmediatePriority,et=a.unstable_UserBlockingPriority,tt=a.unstable_NormalPriority,nt=a.unstable_LowPriority,rt=a.unstable_IdlePriority,at=null,it=null;var st=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/ct|0)|0},ot=Math.log,ct=Math.LN2;var lt=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,a=e.suspendedLanes,i=e.pingedLanes,s=268435455&n;if(0!==s){var o=s&~a;0!==o?r=dt(o):0!==(i&=s)&&(r=dt(i))}else 0!==(s=n&~a)?r=dt(s):0!==i&&(r=dt(i));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&a)&&((a=r&-r)>=(i=t&-t)||16===a&&0!==(4194240&i)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)a=1<<(n=31-st(t)),r|=e[n],t&=~a;return r}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function gt(){var e=lt;return 0===(4194240&(lt<<=1))&&(lt=64),e}function mt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-st(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-st(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var bt=0;function wt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var Et,Tt,xt,It,kt,_t=!1,Ct=[],At=null,Nt=null,Rt=null,Ot=new Map,Dt=new Map,Pt=[],Lt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Mt(e,t){switch(e){case"focusin":case"focusout":At=null;break;case"dragenter":case"dragleave":Nt=null;break;case"mouseover":case"mouseout":Rt=null;break;case"pointerover":case"pointerout":Ot.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Dt.delete(t.pointerId)}}function Ft(e,t,n,r,a,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},null!==t&&(null!==(t=Ta(t))&&Tt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function zt(e){var t=Ea(e.target);if(null!==t){var n=Ve(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=$e(n)))return e.blockedOn=t,void kt(e.priority,(function(){xt(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function jt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Xt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=Ta(n))&&Tt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);we=r,n.target.dispatchEvent(r),we=null,t.shift()}return!0}function Ut(e,t,n){jt(e)&&n.delete(t)}function Bt(){_t=!1,null!==At&&jt(At)&&(At=null),null!==Nt&&jt(Nt)&&(Nt=null),null!==Rt&&jt(Rt)&&(Rt=null),Ot.forEach(Ut),Dt.forEach(Ut)}function Vt(e,t){e.blockedOn===t&&(e.blockedOn=null,_t||(_t=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Bt)))}function $t(e){function t(t){return Vt(t,e)}if(0<Ct.length){Vt(Ct[0],e);for(var n=1;n<Ct.length;n++){var r=Ct[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==At&&Vt(At,e),null!==Nt&&Vt(Nt,e),null!==Rt&&Vt(Rt,e),Ot.forEach(t),Dt.forEach(t),n=0;n<Pt.length;n++)(r=Pt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Pt.length&&null===(n=Pt[0]).blockedOn;)zt(n),null===n.blockedOn&&Pt.shift()}var Ht=w.ReactCurrentBatchConfig,Wt=!0;function Gt(e,t,n,r){var a=bt,i=Ht.transition;Ht.transition=null;try{bt=1,qt(e,t,n,r)}finally{bt=a,Ht.transition=i}}function Kt(e,t,n,r){var a=bt,i=Ht.transition;Ht.transition=null;try{bt=4,qt(e,t,n,r)}finally{bt=a,Ht.transition=i}}function qt(e,t,n,r){if(Wt){var a=Xt(e,t,n,r);if(null===a)Kr(e,t,r,Yt,n),Mt(e,r);else if(function(e,t,n,r,a){switch(t){case"focusin":return At=Ft(At,e,t,n,r,a),!0;case"dragenter":return Nt=Ft(Nt,e,t,n,r,a),!0;case"mouseover":return Rt=Ft(Rt,e,t,n,r,a),!0;case"pointerover":var i=a.pointerId;return Ot.set(i,Ft(Ot.get(i)||null,e,t,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,Dt.set(i,Ft(Dt.get(i)||null,e,t,n,r,a)),!0}return!1}(a,e,t,n,r))r.stopPropagation();else if(Mt(e,r),4&t&&-1<Lt.indexOf(e)){for(;null!==a;){var i=Ta(a);if(null!==i&&Et(i),null===(i=Xt(e,t,n,r))&&Kr(e,t,r,Yt,n),i===a)break;a=i}null!==a&&r.stopPropagation()}else Kr(e,t,r,null,n)}}var Yt=null;function Xt(e,t,n,r){if(Yt=null,null!==(e=Ea(e=Ee(r))))if(null===(t=Ve(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=$e(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Yt=e,null}function Qt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Jt=null,Zt=null,en=null;function tn(){if(en)return en;var e,t,n=Zt,r=n.length,a="value"in Jt?Jt.value:Jt.textContent,i=a.length;for(e=0;e<r&&n[e]===a[e];e++);var s=r-e;for(t=1;t<=s&&n[r-t]===a[i-t];t++);return en=a.slice(e,1<t?1-t:void 0)}function rn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function an(){return!0}function sn(){return!1}function on(e){function t(t,n,r,a,i){for(var s in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(a):a[s]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?an:sn,this.isPropagationStopped=sn,this}return F(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=an)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=an)},persist:function(){},isPersistent:an}),t}var cn,ln,un,dn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hn=on(dn),fn=F({},dn,{view:0,detail:0}),pn=on(fn),gn=F({},fn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_n,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==un&&(un&&"mousemove"===e.type?(cn=e.screenX-un.screenX,ln=e.screenY-un.screenY):ln=cn=0,un=e),cn)},movementY:function(e){return"movementY"in e?e.movementY:ln}}),mn=on(gn),vn=on(F({},gn,{dataTransfer:0})),yn=on(F({},fn,{relatedTarget:0})),bn=on(F({},dn,{animationName:0,elapsedTime:0,pseudoElement:0})),wn=F({},dn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),En=on(wn),Tn=on(F({},dn,{data:0})),xn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Sn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},In={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=In[e])&&!!t[e]}function _n(){return kn}var Cn=F({},fn,{key:function(e){if(e.key){var t=xn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=rn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Sn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_n,charCode:function(e){return"keypress"===e.type?rn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?rn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),An=on(Cn),Nn=on(F({},gn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Rn=on(F({},fn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_n})),On=on(F({},dn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Dn=F({},gn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Pn=on(Dn),Ln=[9,13,27,32],Fn=u&&"CompositionEvent"in window,zn=null;u&&"documentMode"in document&&(zn=document.documentMode);var jn=u&&"TextEvent"in window&&!zn,Un=u&&(!Fn||zn&&8<zn&&11>=zn),Bn=String.fromCharCode(32),Vn=!1;function $n(e,t){switch(e){case"keyup":return-1!==Ln.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Hn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Wn=!1;var Gn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Kn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Gn[e.type]:"textarea"===t}function qn(e,t,n,r){ke(r),0<(t=Yr(t,"onChange")).length&&(n=new hn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Yn=null,Xn=null;function Qn(e){Br(e,0)}function Jn(e){if(K(xa(e)))return e}function Zn(e,t){if("change"===e)return t}var er=!1;if(u){var tr;if(u){var nr="oninput"in document;if(!nr){var rr=document.createElement("div");rr.setAttribute("oninput","return;"),nr="function"===typeof rr.oninput}tr=nr}else tr=!1;er=tr&&(!document.documentMode||9<document.documentMode)}function ar(){Yn&&(Yn.detachEvent("onpropertychange",ir),Xn=Yn=null)}function ir(e){if("value"===e.propertyName&&Jn(Xn)){var t=[];qn(t,Xn,e,Ee(e)),Re(Qn,t)}}function sr(e,t,n){"focusin"===e?(ar(),Xn=n,(Yn=t).attachEvent("onpropertychange",ir)):"focusout"===e&&ar()}function or(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Jn(Xn)}function cr(e,t){if("click"===e)return Jn(t)}function lr(e,t){if("input"===e||"change"===e)return Jn(t)}var ur="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function dr(e,t){if(ur(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!d.call(t,a)||!ur(e[a],t[a]))return!1}return!0}function hr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function fr(e,t){var n,r=hr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=hr(r)}}function pr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?pr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function gr(){for(var e=window,t=q();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=q((e=t.contentWindow).document)}return t}function mr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function vr(e){var t=gr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&pr(n.ownerDocument.documentElement,n)){if(null!==r&&mr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var a=n.textContent.length,i=Math.min(r.start,a);r=void 0===r.end?i:Math.min(r.end,a),!e.extend&&i>r&&(a=r,r=i,i=a),a=fr(n,i);var s=fr(n,r);a&&s&&(1!==e.rangeCount||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&((t=t.createRange()).setStart(a.node,a.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var yr=u&&"documentMode"in document&&11>=document.documentMode,br=null,wr=null,Er=null,Tr=!1;function xr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;Tr||null==br||br!==q(r)||("selectionStart"in(r=br)&&mr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},Er&&dr(Er,r)||(Er=r,0<(r=Yr(wr,"onSelect")).length&&(t=new hn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=br)))}function Sr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Ir={animationend:Sr("Animation","AnimationEnd"),animationiteration:Sr("Animation","AnimationIteration"),animationstart:Sr("Animation","AnimationStart"),transitionend:Sr("Transition","TransitionEnd")},kr={},_r={};function Cr(e){if(kr[e])return kr[e];if(!Ir[e])return e;var t,n=Ir[e];for(t in n)if(n.hasOwnProperty(t)&&t in _r)return kr[e]=n[t];return e}u&&(_r=document.createElement("div").style,"AnimationEvent"in window||(delete Ir.animationend.animation,delete Ir.animationiteration.animation,delete Ir.animationstart.animation),"TransitionEvent"in window||delete Ir.transitionend.transition);var Ar=Cr("animationend"),Nr=Cr("animationiteration"),Rr=Cr("animationstart"),Or=Cr("transitionend"),Dr=new Map,Pr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Lr(e,t){Dr.set(e,t),c(t,[e])}for(var Mr=0;Mr<Pr.length;Mr++){var Fr=Pr[Mr];Lr(Fr.toLowerCase(),"on"+(Fr[0].toUpperCase()+Fr.slice(1)))}Lr(Ar,"onAnimationEnd"),Lr(Nr,"onAnimationIteration"),Lr(Rr,"onAnimationStart"),Lr("dblclick","onDoubleClick"),Lr("focusin","onFocus"),Lr("focusout","onBlur"),Lr(Or,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),c("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),c("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),c("onBeforeInput",["compositionend","keypress","textInput","paste"]),c("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jr=new Set("cancel close invalid load scroll toggle".split(" ").concat(zr));function Ur(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,a,s,o,c,l){if(Be.apply(this,arguments),Me){if(!Me)throw Error(i(198));var u=Fe;Me=!1,Fe=null,ze||(ze=!0,je=u)}}(r,t,void 0,e),e.currentTarget=null}function Br(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var s=r.length-1;0<=s;s--){var o=r[s],c=o.instance,l=o.currentTarget;if(o=o.listener,c!==i&&a.isPropagationStopped())break e;Ur(a,o,l),i=c}else for(s=0;s<r.length;s++){if(c=(o=r[s]).instance,l=o.currentTarget,o=o.listener,c!==i&&a.isPropagationStopped())break e;Ur(a,o,l),i=c}}}if(ze)throw e=je,ze=!1,je=null,e}function Vr(e,t){var n=t[ya];void 0===n&&(n=t[ya]=new Set);var r=e+"__bubble";n.has(r)||(Gr(t,e,2,!1),n.add(r))}function $r(e,t,n){var r=0;t&&(r|=4),Gr(n,e,r,t)}var Hr="_reactListening"+Math.random().toString(36).slice(2);function Wr(e){if(!e[Hr]){e[Hr]=!0,s.forEach((function(t){"selectionchange"!==t&&(jr.has(t)||$r(t,!1,e),$r(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Hr]||(t[Hr]=!0,$r("selectionchange",!1,t))}}function Gr(e,t,n,r){switch(Qt(t)){case 1:var a=Gt;break;case 4:a=Kt;break;default:a=qt}n=a.bind(null,t,n,e),a=void 0,!De||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Kr(e,t,n,r,a){var i=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var s=r.tag;if(3===s||4===s){var o=r.stateNode.containerInfo;if(o===a||8===o.nodeType&&o.parentNode===a)break;if(4===s)for(s=r.return;null!==s;){var c=s.tag;if((3===c||4===c)&&((c=s.stateNode.containerInfo)===a||8===c.nodeType&&c.parentNode===a))return;s=s.return}for(;null!==o;){if(null===(s=Ea(o)))return;if(5===(c=s.tag)||6===c){r=i=s;continue e}o=o.parentNode}}r=r.return}Re((function(){var r=i,a=Ee(n),s=[];e:{var o=Dr.get(e);if(void 0!==o){var c=hn,l=e;switch(e){case"keypress":if(0===rn(n))break e;case"keydown":case"keyup":c=An;break;case"focusin":l="focus",c=yn;break;case"focusout":l="blur",c=yn;break;case"beforeblur":case"afterblur":c=yn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=mn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=vn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=Rn;break;case Ar:case Nr:case Rr:c=bn;break;case Or:c=On;break;case"scroll":c=pn;break;case"wheel":c=Pn;break;case"copy":case"cut":case"paste":c=En;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=Nn}var u=0!==(4&t),d=!u&&"scroll"===e,h=u?null!==o?o+"Capture":null:o;u=[];for(var f,p=r;null!==p;){var g=(f=p).stateNode;if(5===f.tag&&null!==g&&(f=g,null!==h&&(null!=(g=Oe(p,h))&&u.push(qr(p,g,f)))),d)break;p=p.return}0<u.length&&(o=new c(o,l,null,n,a),s.push({event:o,listeners:u}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===we||!(l=n.relatedTarget||n.fromElement)||!Ea(l)&&!l[va])&&(c||o)&&(o=a.window===a?a:(o=a.ownerDocument)?o.defaultView||o.parentWindow:window,c?(c=r,null!==(l=(l=n.relatedTarget||n.toElement)?Ea(l):null)&&(l!==(d=Ve(l))||5!==l.tag&&6!==l.tag)&&(l=null)):(c=null,l=r),c!==l)){if(u=mn,g="onMouseLeave",h="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=Nn,g="onPointerLeave",h="onPointerEnter",p="pointer"),d=null==c?o:xa(c),f=null==l?o:xa(l),(o=new u(g,p+"leave",c,n,a)).target=d,o.relatedTarget=f,g=null,Ea(a)===r&&((u=new u(h,p+"enter",l,n,a)).target=f,u.relatedTarget=d,g=u),d=g,c&&l)e:{for(h=l,p=0,f=u=c;f;f=Xr(f))p++;for(f=0,g=h;g;g=Xr(g))f++;for(;0<p-f;)u=Xr(u),p--;for(;0<f-p;)h=Xr(h),f--;for(;p--;){if(u===h||null!==h&&u===h.alternate)break e;u=Xr(u),h=Xr(h)}u=null}else u=null;null!==c&&Qr(s,o,c,u,!1),null!==l&&null!==d&&Qr(s,d,l,u,!0)}if("select"===(c=(o=r?xa(r):window).nodeName&&o.nodeName.toLowerCase())||"input"===c&&"file"===o.type)var m=Zn;else if(Kn(o))if(er)m=lr;else{m=or;var v=sr}else(c=o.nodeName)&&"input"===c.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(m=cr);switch(m&&(m=m(e,r))?qn(s,m,n,a):(v&&v(e,o,r),"focusout"===e&&(v=o._wrapperState)&&v.controlled&&"number"===o.type&&ee(o,"number",o.value)),v=r?xa(r):window,e){case"focusin":(Kn(v)||"true"===v.contentEditable)&&(br=v,wr=r,Er=null);break;case"focusout":Er=wr=br=null;break;case"mousedown":Tr=!0;break;case"contextmenu":case"mouseup":case"dragend":Tr=!1,xr(s,n,a);break;case"selectionchange":if(yr)break;case"keydown":case"keyup":xr(s,n,a)}var y;if(Fn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Wn?$n(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Un&&"ko"!==n.locale&&(Wn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Wn&&(y=tn()):(Zt="value"in(Jt=a)?Jt.value:Jt.textContent,Wn=!0)),0<(v=Yr(r,b)).length&&(b=new Tn(b,e,null,n,a),s.push({event:b,listeners:v}),y?b.data=y:null!==(y=Hn(n))&&(b.data=y))),(y=jn?function(e,t){switch(e){case"compositionend":return Hn(t);case"keypress":return 32!==t.which?null:(Vn=!0,Bn);case"textInput":return(e=t.data)===Bn&&Vn?null:e;default:return null}}(e,n):function(e,t){if(Wn)return"compositionend"===e||!Fn&&$n(e,t)?(e=tn(),en=Zt=Jt=null,Wn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Un&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Yr(r,"onBeforeInput")).length&&(a=new Tn("onBeforeInput","beforeinput",null,n,a),s.push({event:a,listeners:r}),a.data=y))}Br(s,t)}))}function qr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Yr(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,i=a.stateNode;5===a.tag&&null!==i&&(a=i,null!=(i=Oe(e,n))&&r.unshift(qr(e,i,a)),null!=(i=Oe(e,t))&&r.push(qr(e,i,a))),e=e.return}return r}function Xr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Qr(e,t,n,r,a){for(var i=t._reactName,s=[];null!==n&&n!==r;){var o=n,c=o.alternate,l=o.stateNode;if(null!==c&&c===r)break;5===o.tag&&null!==l&&(o=l,a?null!=(c=Oe(n,i))&&s.unshift(qr(n,c,o)):a||null!=(c=Oe(n,i))&&s.push(qr(n,c,o))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var Jr=/\r\n?/g,Zr=/\u0000|\uFFFD/g;function ea(e){return("string"===typeof e?e:""+e).replace(Jr,"\n").replace(Zr,"")}function ta(e,t,n){if(t=ea(t),ea(e)!==t&&n)throw Error(i(425))}function na(){}var ra=null,aa=null;function ia(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var sa="function"===typeof setTimeout?setTimeout:void 0,oa="function"===typeof clearTimeout?clearTimeout:void 0,ca="function"===typeof Promise?Promise:void 0,la="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ca?function(e){return ca.resolve(null).then(e).catch(ua)}:sa;function ua(e){setTimeout((function(){throw e}))}function da(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)){if(0===r)return e.removeChild(a),void $t(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=a}while(n);$t(t)}function ha(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function fa(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var pa=Math.random().toString(36).slice(2),ga="__reactFiber$"+pa,ma="__reactProps$"+pa,va="__reactContainer$"+pa,ya="__reactEvents$"+pa,ba="__reactListeners$"+pa,wa="__reactHandles$"+pa;function Ea(e){var t=e[ga];if(t)return t;for(var n=e.parentNode;n;){if(t=n[va]||n[ga]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=fa(e);null!==e;){if(n=e[ga])return n;e=fa(e)}return t}n=(e=n).parentNode}return null}function Ta(e){return!(e=e[ga]||e[va])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function xa(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(i(33))}function Sa(e){return e[ma]||null}var Ia=[],ka=-1;function _a(e){return{current:e}}function Ca(e){0>ka||(e.current=Ia[ka],Ia[ka]=null,ka--)}function Aa(e,t){ka++,Ia[ka]=e.current,e.current=t}var Na={},Ra=_a(Na),Oa=_a(!1),Da=Na;function Pa(e,t){var n=e.type.contextTypes;if(!n)return Na;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a,i={};for(a in n)i[a]=t[a];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function La(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Ma(){Ca(Oa),Ca(Ra)}function Fa(e,t,n){if(Ra.current!==Na)throw Error(i(168));Aa(Ra,t),Aa(Oa,n)}function za(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var a in r=r.getChildContext())if(!(a in t))throw Error(i(108,$(e)||"Unknown",a));return F({},n,r)}function ja(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Na,Da=Ra.current,Aa(Ra,e),Aa(Oa,Oa.current),!0}function Ua(e,t,n){var r=e.stateNode;if(!r)throw Error(i(169));n?(e=za(e,t,Da),r.__reactInternalMemoizedMergedChildContext=e,Ca(Oa),Ca(Ra),Aa(Ra,e)):Ca(Oa),Aa(Oa,n)}var Ba=null,Va=!1,$a=!1;function Ha(e){null===Ba?Ba=[e]:Ba.push(e)}function Wa(){if(!$a&&null!==Ba){$a=!0;var e=0,t=bt;try{var n=Ba;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Ba=null,Va=!1}catch(a){throw null!==Ba&&(Ba=Ba.slice(e+1)),Ke(Ze,Wa),a}finally{bt=t,$a=!1}}return null}var Ga=[],Ka=0,qa=null,Ya=0,Xa=[],Qa=0,Ja=null,Za=1,ei="";function ti(e,t){Ga[Ka++]=Ya,Ga[Ka++]=qa,qa=e,Ya=t}function ni(e,t,n){Xa[Qa++]=Za,Xa[Qa++]=ei,Xa[Qa++]=Ja,Ja=e;var r=Za;e=ei;var a=32-st(r)-1;r&=~(1<<a),n+=1;var i=32-st(t)+a;if(30<i){var s=a-a%5;i=(r&(1<<s)-1).toString(32),r>>=s,a-=s,Za=1<<32-st(t)+a|n<<a|r,ei=i+e}else Za=1<<i|n<<a|r,ei=e}function ri(e){null!==e.return&&(ti(e,1),ni(e,1,0))}function ai(e){for(;e===qa;)qa=Ga[--Ka],Ga[Ka]=null,Ya=Ga[--Ka],Ga[Ka]=null;for(;e===Ja;)Ja=Xa[--Qa],Xa[Qa]=null,ei=Xa[--Qa],Xa[Qa]=null,Za=Xa[--Qa],Xa[Qa]=null}var ii=null,si=null,oi=!1,ci=null;function li(e,t){var n=Pl(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function ui(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ii=e,si=ha(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ii=e,si=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Ja?{id:Za,overflow:ei}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Pl(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ii=e,si=null,!0);default:return!1}}function di(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function hi(e){if(oi){var t=si;if(t){var n=t;if(!ui(e,t)){if(di(e))throw Error(i(418));t=ha(n.nextSibling);var r=ii;t&&ui(e,t)?li(r,n):(e.flags=-4097&e.flags|2,oi=!1,ii=e)}}else{if(di(e))throw Error(i(418));e.flags=-4097&e.flags|2,oi=!1,ii=e}}}function fi(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ii=e}function pi(e){if(e!==ii)return!1;if(!oi)return fi(e),oi=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ia(e.type,e.memoizedProps)),t&&(t=si)){if(di(e))throw gi(),Error(i(418));for(;t;)li(e,t),t=ha(t.nextSibling)}if(fi(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){si=ha(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}si=null}}else si=ii?ha(e.stateNode.nextSibling):null;return!0}function gi(){for(var e=si;e;)e=ha(e.nextSibling)}function mi(){si=ii=null,oi=!1}function vi(e){null===ci?ci=[e]:ci.push(e)}var yi=w.ReactCurrentBatchConfig;function bi(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(i(309));var r=n.stateNode}if(!r)throw Error(i(147,e));var a=r,s=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===s?t.ref:(t=function(e){var t=a.refs;null===e?delete t[s]:t[s]=e},t._stringRef=s,t)}if("string"!==typeof e)throw Error(i(284));if(!n._owner)throw Error(i(290,e))}return e}function wi(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Ei(e){return(0,e._init)(e._payload)}function Ti(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Ml(e,t)).index=0,e.sibling=null,e}function s(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function c(e,t,n,r){return null===t||6!==t.tag?((t=Ul(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function l(e,t,n,r){var i=n.type;return i===x?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===O&&Ei(i)===t.type)?((r=a(t,n.props)).ref=bi(e,t,n),r.return=e,r):((r=Fl(n.type,n.key,n.props,null,e.mode,r)).ref=bi(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Bl(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function d(e,t,n,r,i){return null===t||7!==t.tag?((t=zl(n,e.mode,r,i)).return=e,t):((t=a(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Ul(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case E:return(n=Fl(t.type,t.key,t.props,null,e.mode,n)).ref=bi(e,null,t),n.return=e,n;case T:return(t=Bl(t,e.mode,n)).return=e,t;case O:return h(e,(0,t._init)(t._payload),n)}if(te(t)||L(t))return(t=zl(t,e.mode,n,null)).return=e,t;wi(e,t)}return null}function f(e,t,n,r){var a=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==a?null:c(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case E:return n.key===a?l(e,t,n,r):null;case T:return n.key===a?u(e,t,n,r):null;case O:return f(e,t,(a=n._init)(n._payload),r)}if(te(n)||L(n))return null!==a?null:d(e,t,n,r,null);wi(e,n)}return null}function p(e,t,n,r,a){if("string"===typeof r&&""!==r||"number"===typeof r)return c(t,e=e.get(n)||null,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case E:return l(t,e=e.get(null===r.key?n:r.key)||null,r,a);case T:return u(t,e=e.get(null===r.key?n:r.key)||null,r,a);case O:return p(e,t,n,(0,r._init)(r._payload),a)}if(te(r)||L(r))return d(t,e=e.get(n)||null,r,a,null);wi(t,r)}return null}function g(a,i,o,c){for(var l=null,u=null,d=i,g=i=0,m=null;null!==d&&g<o.length;g++){d.index>g?(m=d,d=null):m=d.sibling;var v=f(a,d,o[g],c);if(null===v){null===d&&(d=m);break}e&&d&&null===v.alternate&&t(a,d),i=s(v,i,g),null===u?l=v:u.sibling=v,u=v,d=m}if(g===o.length)return n(a,d),oi&&ti(a,g),l;if(null===d){for(;g<o.length;g++)null!==(d=h(a,o[g],c))&&(i=s(d,i,g),null===u?l=d:u.sibling=d,u=d);return oi&&ti(a,g),l}for(d=r(a,d);g<o.length;g++)null!==(m=p(d,a,g,o[g],c))&&(e&&null!==m.alternate&&d.delete(null===m.key?g:m.key),i=s(m,i,g),null===u?l=m:u.sibling=m,u=m);return e&&d.forEach((function(e){return t(a,e)})),oi&&ti(a,g),l}function m(a,o,c,l){var u=L(c);if("function"!==typeof u)throw Error(i(150));if(null==(c=u.call(c)))throw Error(i(151));for(var d=u=null,g=o,m=o=0,v=null,y=c.next();null!==g&&!y.done;m++,y=c.next()){g.index>m?(v=g,g=null):v=g.sibling;var b=f(a,g,y.value,l);if(null===b){null===g&&(g=v);break}e&&g&&null===b.alternate&&t(a,g),o=s(b,o,m),null===d?u=b:d.sibling=b,d=b,g=v}if(y.done)return n(a,g),oi&&ti(a,m),u;if(null===g){for(;!y.done;m++,y=c.next())null!==(y=h(a,y.value,l))&&(o=s(y,o,m),null===d?u=y:d.sibling=y,d=y);return oi&&ti(a,m),u}for(g=r(a,g);!y.done;m++,y=c.next())null!==(y=p(g,a,m,y.value,l))&&(e&&null!==y.alternate&&g.delete(null===y.key?m:y.key),o=s(y,o,m),null===d?u=y:d.sibling=y,d=y);return e&&g.forEach((function(e){return t(a,e)})),oi&&ti(a,m),u}return function e(r,i,s,c){if("object"===typeof s&&null!==s&&s.type===x&&null===s.key&&(s=s.props.children),"object"===typeof s&&null!==s){switch(s.$$typeof){case E:e:{for(var l=s.key,u=i;null!==u;){if(u.key===l){if((l=s.type)===x){if(7===u.tag){n(r,u.sibling),(i=a(u,s.props.children)).return=r,r=i;break e}}else if(u.elementType===l||"object"===typeof l&&null!==l&&l.$$typeof===O&&Ei(l)===u.type){n(r,u.sibling),(i=a(u,s.props)).ref=bi(r,u,s),i.return=r,r=i;break e}n(r,u);break}t(r,u),u=u.sibling}s.type===x?((i=zl(s.props.children,r.mode,c,s.key)).return=r,r=i):((c=Fl(s.type,s.key,s.props,null,r.mode,c)).ref=bi(r,i,s),c.return=r,r=c)}return o(r);case T:e:{for(u=s.key;null!==i;){if(i.key===u){if(4===i.tag&&i.stateNode.containerInfo===s.containerInfo&&i.stateNode.implementation===s.implementation){n(r,i.sibling),(i=a(i,s.children||[])).return=r,r=i;break e}n(r,i);break}t(r,i),i=i.sibling}(i=Bl(s,r.mode,c)).return=r,r=i}return o(r);case O:return e(r,i,(u=s._init)(s._payload),c)}if(te(s))return g(r,i,s,c);if(L(s))return m(r,i,s,c);wi(r,s)}return"string"===typeof s&&""!==s||"number"===typeof s?(s=""+s,null!==i&&6===i.tag?(n(r,i.sibling),(i=a(i,s)).return=r,r=i):(n(r,i),(i=Ul(s,r.mode,c)).return=r,r=i),o(r)):n(r,i)}}var xi=Ti(!0),Si=Ti(!1),Ii=_a(null),ki=null,_i=null,Ci=null;function Ai(){Ci=_i=ki=null}function Ni(e){var t=Ii.current;Ca(Ii),e._currentValue=t}function Ri(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Oi(e,t){ki=e,Ci=_i=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(To=!0),e.firstContext=null)}function Di(e){var t=e._currentValue;if(Ci!==e)if(e={context:e,memoizedValue:t,next:null},null===_i){if(null===ki)throw Error(i(308));_i=e,ki.dependencies={lanes:0,firstContext:e}}else _i=_i.next=e;return t}var Pi=null;function Li(e){null===Pi?Pi=[e]:Pi.push(e)}function Mi(e,t,n,r){var a=t.interleaved;return null===a?(n.next=n,Li(t)):(n.next=a.next,a.next=n),t.interleaved=n,Fi(e,r)}function Fi(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var zi=!1;function ji(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ui(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Bi(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Vi(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Rc)){var a=r.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),r.pending=t,Fi(e,n)}return null===(a=r.interleaved)?(t.next=t,Li(r)):(t.next=a.next,a.next=t),r.interleaved=t,Fi(e,n)}function $i(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Hi(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?a=i=s:i=i.next=s,n=n.next}while(null!==n);null===i?a=i=t:i=i.next=t}else a=i=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Wi(e,t,n,r){var a=e.updateQueue;zi=!1;var i=a.firstBaseUpdate,s=a.lastBaseUpdate,o=a.shared.pending;if(null!==o){a.shared.pending=null;var c=o,l=c.next;c.next=null,null===s?i=l:s.next=l,s=c;var u=e.alternate;null!==u&&((o=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===o?u.firstBaseUpdate=l:o.next=l,u.lastBaseUpdate=c))}if(null!==i){var d=a.baseState;for(s=0,u=l=c=null,o=i;;){var h=o.lane,f=o.eventTime;if((r&h)===h){null!==u&&(u=u.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var p=e,g=o;switch(h=t,f=n,g.tag){case 1:if("function"===typeof(p=g.payload)){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(h="function"===typeof(p=g.payload)?p.call(f,d,h):p)||void 0===h)break e;d=F({},d,h);break e;case 2:zi=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(h=a.effects)?a.effects=[o]:h.push(o))}else f={eventTime:f,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===u?(l=u=f,c=d):u=u.next=f,s|=h;if(null===(o=o.next)){if(null===(o=a.shared.pending))break;o=(h=o).next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}if(null===u&&(c=d),a.baseState=c,a.firstBaseUpdate=l,a.lastBaseUpdate=u,null!==(t=a.shared.interleaved)){a=t;do{s|=a.lane,a=a.next}while(a!==t)}else null===i&&(a.shared.lanes=0);jc|=s,e.lanes=s,e.memoizedState=d}}function Gi(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(null!==a){if(r.callback=null,r=n,"function"!==typeof a)throw Error(i(191,a));a.call(r)}}}var Ki={},qi=_a(Ki),Yi=_a(Ki),Xi=_a(Ki);function Qi(e){if(e===Ki)throw Error(i(174));return e}function Ji(e,t){switch(Aa(Xi,t),Aa(Yi,e),Aa(qi,Ki),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ce(null,"");break;default:t=ce(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ca(qi),Aa(qi,t)}function Zi(){Ca(qi),Ca(Yi),Ca(Xi)}function es(e){Qi(Xi.current);var t=Qi(qi.current),n=ce(t,e.type);t!==n&&(Aa(Yi,e),Aa(qi,n))}function ts(e){Yi.current===e&&(Ca(qi),Ca(Yi))}var ns=_a(0);function rs(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var as=[];function is(){for(var e=0;e<as.length;e++)as[e]._workInProgressVersionPrimary=null;as.length=0}var ss=w.ReactCurrentDispatcher,os=w.ReactCurrentBatchConfig,cs=0,ls=null,us=null,ds=null,hs=!1,fs=!1,ps=0,gs=0;function ms(){throw Error(i(321))}function vs(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ur(e[n],t[n]))return!1;return!0}function ys(e,t,n,r,a,s){if(cs=s,ls=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ss.current=null===e||null===e.memoizedState?to:no,e=n(r,a),fs){s=0;do{if(fs=!1,ps=0,25<=s)throw Error(i(301));s+=1,ds=us=null,t.updateQueue=null,ss.current=ro,e=n(r,a)}while(fs)}if(ss.current=eo,t=null!==us&&null!==us.next,cs=0,ds=us=ls=null,hs=!1,t)throw Error(i(300));return e}function bs(){var e=0!==ps;return ps=0,e}function ws(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ds?ls.memoizedState=ds=e:ds=ds.next=e,ds}function Es(){if(null===us){var e=ls.alternate;e=null!==e?e.memoizedState:null}else e=us.next;var t=null===ds?ls.memoizedState:ds.next;if(null!==t)ds=t,us=e;else{if(null===e)throw Error(i(310));e={memoizedState:(us=e).memoizedState,baseState:us.baseState,baseQueue:us.baseQueue,queue:us.queue,next:null},null===ds?ls.memoizedState=ds=e:ds=ds.next=e}return ds}function Ts(e,t){return"function"===typeof t?t(e):t}function xs(e){var t=Es(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=us,a=r.baseQueue,s=n.pending;if(null!==s){if(null!==a){var o=a.next;a.next=s.next,s.next=o}r.baseQueue=a=s,n.pending=null}if(null!==a){s=a.next,r=r.baseState;var c=o=null,l=null,u=s;do{var d=u.lane;if((cs&d)===d)null!==l&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===l?(c=l=h,o=r):l=l.next=h,ls.lanes|=d,jc|=d}u=u.next}while(null!==u&&u!==s);null===l?o=r:l.next=c,ur(r,t.memoizedState)||(To=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=l,n.lastRenderedState=r}if(null!==(e=n.interleaved)){a=e;do{s=a.lane,ls.lanes|=s,jc|=s,a=a.next}while(a!==e)}else null===a&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Ss(e){var t=Es(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,s=t.memoizedState;if(null!==a){n.pending=null;var o=a=a.next;do{s=e(s,o.action),o=o.next}while(o!==a);ur(s,t.memoizedState)||(To=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function Is(){}function ks(e,t){var n=ls,r=Es(),a=t(),s=!ur(r.memoizedState,a);if(s&&(r.memoizedState=a,To=!0),r=r.queue,zs(As.bind(null,n,r,e),[e]),r.getSnapshot!==t||s||null!==ds&&1&ds.memoizedState.tag){if(n.flags|=2048,Ds(9,Cs.bind(null,n,r,a,t),void 0,null),null===Oc)throw Error(i(349));0!==(30&cs)||_s(n,t,a)}return a}function _s(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=ls.updateQueue)?(t={lastEffect:null,stores:null},ls.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Cs(e,t,n,r){t.value=n,t.getSnapshot=r,Ns(t)&&Rs(e)}function As(e,t,n){return n((function(){Ns(t)&&Rs(e)}))}function Ns(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ur(e,n)}catch(r){return!0}}function Rs(e){var t=Fi(e,1);null!==t&&il(t,e,1,-1)}function Os(e){var t=ws();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ts,lastRenderedState:e},t.queue=e,e=e.dispatch=Xs.bind(null,ls,e),[t.memoizedState,e]}function Ds(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=ls.updateQueue)?(t={lastEffect:null,stores:null},ls.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Ps(){return Es().memoizedState}function Ls(e,t,n,r){var a=ws();ls.flags|=e,a.memoizedState=Ds(1|t,n,void 0,void 0===r?null:r)}function Ms(e,t,n,r){var a=Es();r=void 0===r?null:r;var i=void 0;if(null!==us){var s=us.memoizedState;if(i=s.destroy,null!==r&&vs(r,s.deps))return void(a.memoizedState=Ds(t,n,i,r))}ls.flags|=e,a.memoizedState=Ds(1|t,n,i,r)}function Fs(e,t){return Ls(8390656,8,e,t)}function zs(e,t){return Ms(2048,8,e,t)}function js(e,t){return Ms(4,2,e,t)}function Us(e,t){return Ms(4,4,e,t)}function Bs(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Vs(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ms(4,4,Bs.bind(null,t,e),n)}function $s(){}function Hs(e,t){var n=Es();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&vs(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Ws(e,t){var n=Es();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&vs(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Gs(e,t,n){return 0===(21&cs)?(e.baseState&&(e.baseState=!1,To=!0),e.memoizedState=n):(ur(n,t)||(n=gt(),ls.lanes|=n,jc|=n,e.baseState=!0),t)}function Ks(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=os.transition;os.transition={};try{e(!1),t()}finally{bt=n,os.transition=r}}function qs(){return Es().memoizedState}function Ys(e,t,n){var r=al(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Qs(e))Js(t,n);else if(null!==(n=Mi(e,t,n,r))){il(n,e,r,rl()),Zs(n,t,r)}}function Xs(e,t,n){var r=al(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Qs(e))Js(t,a);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var s=t.lastRenderedState,o=i(s,n);if(a.hasEagerState=!0,a.eagerState=o,ur(o,s)){var c=t.interleaved;return null===c?(a.next=a,Li(t)):(a.next=c.next,c.next=a),void(t.interleaved=a)}}catch(l){}null!==(n=Mi(e,t,a,r))&&(il(n,e,r,a=rl()),Zs(n,t,r))}}function Qs(e){var t=e.alternate;return e===ls||null!==t&&t===ls}function Js(e,t){fs=hs=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Zs(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var eo={readContext:Di,useCallback:ms,useContext:ms,useEffect:ms,useImperativeHandle:ms,useInsertionEffect:ms,useLayoutEffect:ms,useMemo:ms,useReducer:ms,useRef:ms,useState:ms,useDebugValue:ms,useDeferredValue:ms,useTransition:ms,useMutableSource:ms,useSyncExternalStore:ms,useId:ms,unstable_isNewReconciler:!1},to={readContext:Di,useCallback:function(e,t){return ws().memoizedState=[e,void 0===t?null:t],e},useContext:Di,useEffect:Fs,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ls(4194308,4,Bs.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ls(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ls(4,2,e,t)},useMemo:function(e,t){var n=ws();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=ws();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Ys.bind(null,ls,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},ws().memoizedState=e},useState:Os,useDebugValue:$s,useDeferredValue:function(e){return ws().memoizedState=e},useTransition:function(){var e=Os(!1),t=e[0];return e=Ks.bind(null,e[1]),ws().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=ls,a=ws();if(oi){if(void 0===n)throw Error(i(407));n=n()}else{if(n=t(),null===Oc)throw Error(i(349));0!==(30&cs)||_s(r,t,n)}a.memoizedState=n;var s={value:n,getSnapshot:t};return a.queue=s,Fs(As.bind(null,r,s,e),[e]),r.flags|=2048,Ds(9,Cs.bind(null,r,s,n,t),void 0,null),n},useId:function(){var e=ws(),t=Oc.identifierPrefix;if(oi){var n=ei;t=":"+t+"R"+(n=(Za&~(1<<32-st(Za)-1)).toString(32)+n),0<(n=ps++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=gs++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},no={readContext:Di,useCallback:Hs,useContext:Di,useEffect:zs,useImperativeHandle:Vs,useInsertionEffect:js,useLayoutEffect:Us,useMemo:Ws,useReducer:xs,useRef:Ps,useState:function(){return xs(Ts)},useDebugValue:$s,useDeferredValue:function(e){return Gs(Es(),us.memoizedState,e)},useTransition:function(){return[xs(Ts)[0],Es().memoizedState]},useMutableSource:Is,useSyncExternalStore:ks,useId:qs,unstable_isNewReconciler:!1},ro={readContext:Di,useCallback:Hs,useContext:Di,useEffect:zs,useImperativeHandle:Vs,useInsertionEffect:js,useLayoutEffect:Us,useMemo:Ws,useReducer:Ss,useRef:Ps,useState:function(){return Ss(Ts)},useDebugValue:$s,useDeferredValue:function(e){var t=Es();return null===us?t.memoizedState=e:Gs(t,us.memoizedState,e)},useTransition:function(){return[Ss(Ts)[0],Es().memoizedState]},useMutableSource:Is,useSyncExternalStore:ks,useId:qs,unstable_isNewReconciler:!1};function ao(e,t){if(e&&e.defaultProps){for(var n in t=F({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function io(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:F({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var so={isMounted:function(e){return!!(e=e._reactInternals)&&Ve(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=rl(),a=al(e),i=Bi(r,a);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Vi(e,i,a))&&(il(t,e,a,r),$i(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=rl(),a=al(e),i=Bi(r,a);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Vi(e,i,a))&&(il(t,e,a,r),$i(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=rl(),r=al(e),a=Bi(n,r);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),null!==(t=Vi(e,a,r))&&(il(t,e,r,n),$i(t,e,r))}};function oo(e,t,n,r,a,i,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,s):!t.prototype||!t.prototype.isPureReactComponent||(!dr(n,r)||!dr(a,i))}function co(e,t,n){var r=!1,a=Na,i=t.contextType;return"object"===typeof i&&null!==i?i=Di(i):(a=La(t)?Da:Ra.current,i=(r=null!==(r=t.contextTypes)&&void 0!==r)?Pa(e,a):Na),t=new t(n,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=so,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function lo(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&so.enqueueReplaceState(t,t.state,null)}function uo(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs={},ji(e);var i=t.contextType;"object"===typeof i&&null!==i?a.context=Di(i):(i=La(t)?Da:Ra.current,a.context=Pa(e,i)),a.state=e.memoizedState,"function"===typeof(i=t.getDerivedStateFromProps)&&(io(e,t,i,n),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&so.enqueueReplaceState(a,a.state,null),Wi(e,n,a,r),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4194308)}function ho(e,t){try{var n="",r=t;do{n+=B(r),r=r.return}while(r);var a=n}catch(i){a="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:a,digest:null}}function fo(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function po(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var go="function"===typeof WeakMap?WeakMap:Map;function mo(e,t,n){(n=Bi(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Kc||(Kc=!0,qc=r),po(0,t)},n}function vo(e,t,n){(n=Bi(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){po(0,t)}}var i=e.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(n.callback=function(){po(0,t),"function"!==typeof r&&(null===Yc?Yc=new Set([this]):Yc.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function yo(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new go;var a=new Set;r.set(t,a)}else void 0===(a=r.get(t))&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=Cl.bind(null,e,t,n),t.then(e,e))}function bo(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function wo(e,t,n,r,a){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Bi(-1,1)).tag=2,Vi(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=a,e)}var Eo=w.ReactCurrentOwner,To=!1;function xo(e,t,n,r){t.child=null===e?Si(t,null,n,r):xi(t,e.child,n,r)}function So(e,t,n,r,a){n=n.render;var i=t.ref;return Oi(t,a),r=ys(e,t,n,r,i,a),n=bs(),null===e||To?(oi&&n&&ri(t),t.flags|=1,xo(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Ko(e,t,a))}function Io(e,t,n,r,a){if(null===e){var i=n.type;return"function"!==typeof i||Ll(i)||void 0!==i.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Fl(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,ko(e,t,i,r,a))}if(i=e.child,0===(e.lanes&a)){var s=i.memoizedProps;if((n=null!==(n=n.compare)?n:dr)(s,r)&&e.ref===t.ref)return Ko(e,t,a)}return t.flags|=1,(e=Ml(i,r)).ref=t.ref,e.return=t,t.child=e}function ko(e,t,n,r,a){if(null!==e){var i=e.memoizedProps;if(dr(i,r)&&e.ref===t.ref){if(To=!1,t.pendingProps=r=i,0===(e.lanes&a))return t.lanes=e.lanes,Ko(e,t,a);0!==(131072&e.flags)&&(To=!0)}}return Ao(e,t,n,r,a)}function _o(e,t,n){var r=t.pendingProps,a=r.children,i=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Aa(Mc,Lc),Lc|=n;else{if(0===(1073741824&n))return e=null!==i?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Aa(Mc,Lc),Lc|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==i?i.baseLanes:n,Aa(Mc,Lc),Lc|=r}else null!==i?(r=i.baseLanes|n,t.memoizedState=null):r=n,Aa(Mc,Lc),Lc|=r;return xo(e,t,a,n),t.child}function Co(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ao(e,t,n,r,a){var i=La(n)?Da:Ra.current;return i=Pa(t,i),Oi(t,a),n=ys(e,t,n,r,i,a),r=bs(),null===e||To?(oi&&r&&ri(t),t.flags|=1,xo(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Ko(e,t,a))}function No(e,t,n,r,a){if(La(n)){var i=!0;ja(t)}else i=!1;if(Oi(t,a),null===t.stateNode)Go(e,t),co(t,n,r),uo(t,n,r,a),r=!0;else if(null===e){var s=t.stateNode,o=t.memoizedProps;s.props=o;var c=s.context,l=n.contextType;"object"===typeof l&&null!==l?l=Di(l):l=Pa(t,l=La(n)?Da:Ra.current);var u=n.getDerivedStateFromProps,d="function"===typeof u||"function"===typeof s.getSnapshotBeforeUpdate;d||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o!==r||c!==l)&&lo(t,s,r,l),zi=!1;var h=t.memoizedState;s.state=h,Wi(t,r,s,a),c=t.memoizedState,o!==r||h!==c||Oa.current||zi?("function"===typeof u&&(io(t,n,u,r),c=t.memoizedState),(o=zi||oo(t,n,o,r,h,c,l))?(d||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),s.props=r,s.state=c,s.context=l,r=o):("function"===typeof s.componentDidMount&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,Ui(e,t),o=t.memoizedProps,l=t.type===t.elementType?o:ao(t.type,o),s.props=l,d=t.pendingProps,h=s.context,"object"===typeof(c=n.contextType)&&null!==c?c=Di(c):c=Pa(t,c=La(n)?Da:Ra.current);var f=n.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o!==d||h!==c)&&lo(t,s,r,c),zi=!1,h=t.memoizedState,s.state=h,Wi(t,r,s,a);var p=t.memoizedState;o!==d||h!==p||Oa.current||zi?("function"===typeof f&&(io(t,n,f,r),p=t.memoizedState),(l=zi||oo(t,n,l,r,h,p,c)||!1)?(u||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(r,p,c),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,p,c)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),s.props=r,s.state=p,s.context=c,r=l):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return Ro(e,t,n,r,i,a)}function Ro(e,t,n,r,a,i){Co(e,t);var s=0!==(128&t.flags);if(!r&&!s)return a&&Ua(t,n,!1),Ko(e,t,i);r=t.stateNode,Eo.current=t;var o=s&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&s?(t.child=xi(t,e.child,null,i),t.child=xi(t,null,o,i)):xo(e,t,o,i),t.memoizedState=r.state,a&&Ua(t,n,!0),t.child}function Oo(e){var t=e.stateNode;t.pendingContext?Fa(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Fa(0,t.context,!1),Ji(e,t.containerInfo)}function Do(e,t,n,r,a){return mi(),vi(a),t.flags|=256,xo(e,t,n,r),t.child}var Po,Lo,Mo,Fo,zo={dehydrated:null,treeContext:null,retryLane:0};function jo(e){return{baseLanes:e,cachePool:null,transitions:null}}function Uo(e,t,n){var r,a=t.pendingProps,s=ns.current,o=!1,c=0!==(128&t.flags);if((r=c)||(r=(null===e||null!==e.memoizedState)&&0!==(2&s)),r?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),Aa(ns,1&s),null===e)return hi(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(c=a.children,e=a.fallback,o?(a=t.mode,o=t.child,c={mode:"hidden",children:c},0===(1&a)&&null!==o?(o.childLanes=0,o.pendingProps=c):o=jl(c,a,0,null),e=zl(e,a,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=jo(n),t.memoizedState=zo,e):Bo(t,c));if(null!==(s=e.memoizedState)&&null!==(r=s.dehydrated))return function(e,t,n,r,a,s,o){if(n)return 256&t.flags?(t.flags&=-257,Vo(e,t,o,r=fo(Error(i(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(s=r.fallback,a=t.mode,r=jl({mode:"visible",children:r.children},a,0,null),(s=zl(s,a,o,null)).flags|=2,r.return=t,s.return=t,r.sibling=s,t.child=r,0!==(1&t.mode)&&xi(t,e.child,null,o),t.child.memoizedState=jo(o),t.memoizedState=zo,s);if(0===(1&t.mode))return Vo(e,t,o,null);if("$!"===a.data){if(r=a.nextSibling&&a.nextSibling.dataset)var c=r.dgst;return r=c,Vo(e,t,o,r=fo(s=Error(i(419)),r,void 0))}if(c=0!==(o&e.childLanes),To||c){if(null!==(r=Oc)){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(a=0!==(a&(r.suspendedLanes|o))?0:a)&&a!==s.retryLane&&(s.retryLane=a,Fi(e,a),il(r,e,a,-1))}return yl(),Vo(e,t,o,r=fo(Error(i(421))))}return"$?"===a.data?(t.flags|=128,t.child=e.child,t=Nl.bind(null,e),a._reactRetry=t,null):(e=s.treeContext,si=ha(a.nextSibling),ii=t,oi=!0,ci=null,null!==e&&(Xa[Qa++]=Za,Xa[Qa++]=ei,Xa[Qa++]=Ja,Za=e.id,ei=e.overflow,Ja=t),t=Bo(t,r.children),t.flags|=4096,t)}(e,t,c,a,r,s,n);if(o){o=a.fallback,c=t.mode,r=(s=e.child).sibling;var l={mode:"hidden",children:a.children};return 0===(1&c)&&t.child!==s?((a=t.child).childLanes=0,a.pendingProps=l,t.deletions=null):(a=Ml(s,l)).subtreeFlags=14680064&s.subtreeFlags,null!==r?o=Ml(r,o):(o=zl(o,c,n,null)).flags|=2,o.return=t,a.return=t,a.sibling=o,t.child=a,a=o,o=t.child,c=null===(c=e.child.memoizedState)?jo(n):{baseLanes:c.baseLanes|n,cachePool:null,transitions:c.transitions},o.memoizedState=c,o.childLanes=e.childLanes&~n,t.memoizedState=zo,a}return e=(o=e.child).sibling,a=Ml(o,{mode:"visible",children:a.children}),0===(1&t.mode)&&(a.lanes=n),a.return=t,a.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=a,t.memoizedState=null,a}function Bo(e,t){return(t=jl({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Vo(e,t,n,r){return null!==r&&vi(r),xi(t,e.child,null,n),(e=Bo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function $o(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ri(e.return,t,n)}function Ho(e,t,n,r,a){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function Wo(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;if(xo(e,t,r.children,n),0!==(2&(r=ns.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&$o(e,n,t);else if(19===e.tag)$o(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Aa(ns,r),0===(1&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===rs(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),Ho(t,!1,a,n,i);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===rs(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}Ho(t,!0,n,null,i);break;case"together":Ho(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Go(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ko(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),jc|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(n=Ml(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Ml(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function qo(e,t){if(!oi)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Yo(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=14680064&a.subtreeFlags,r|=14680064&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Xo(e,t,n){var r=t.pendingProps;switch(ai(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Yo(t),null;case 1:case 17:return La(t.type)&&Ma(),Yo(t),null;case 3:return r=t.stateNode,Zi(),Ca(Oa),Ca(Ra),is(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(pi(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ci&&(ll(ci),ci=null))),Lo(e,t),Yo(t),null;case 5:ts(t);var a=Qi(Xi.current);if(n=t.type,null!==e&&null!=t.stateNode)Mo(e,t,n,r,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(i(166));return Yo(t),null}if(e=Qi(qi.current),pi(t)){r=t.stateNode,n=t.type;var s=t.memoizedProps;switch(r[ga]=t,r[ma]=s,e=0!==(1&t.mode),n){case"dialog":Vr("cancel",r),Vr("close",r);break;case"iframe":case"object":case"embed":Vr("load",r);break;case"video":case"audio":for(a=0;a<zr.length;a++)Vr(zr[a],r);break;case"source":Vr("error",r);break;case"img":case"image":case"link":Vr("error",r),Vr("load",r);break;case"details":Vr("toggle",r);break;case"input":X(r,s),Vr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Vr("invalid",r);break;case"textarea":ae(r,s),Vr("invalid",r)}for(var c in ye(n,s),a=null,s)if(s.hasOwnProperty(c)){var l=s[c];"children"===c?"string"===typeof l?r.textContent!==l&&(!0!==s.suppressHydrationWarning&&ta(r.textContent,l,e),a=["children",l]):"number"===typeof l&&r.textContent!==""+l&&(!0!==s.suppressHydrationWarning&&ta(r.textContent,l,e),a=["children",""+l]):o.hasOwnProperty(c)&&null!=l&&"onScroll"===c&&Vr("scroll",r)}switch(n){case"input":G(r),Z(r,s,!0);break;case"textarea":G(r),se(r);break;case"select":case"option":break;default:"function"===typeof s.onClick&&(r.onclick=na)}r=a,t.updateQueue=r,null!==r&&(t.flags|=4)}else{c=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=c.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=c.createElement(n,{is:r.is}):(e=c.createElement(n),"select"===n&&(c=e,r.multiple?c.multiple=!0:r.size&&(c.size=r.size))):e=c.createElementNS(e,n),e[ga]=t,e[ma]=r,Po(e,t,!1,!1),t.stateNode=e;e:{switch(c=be(n,r),n){case"dialog":Vr("cancel",e),Vr("close",e),a=r;break;case"iframe":case"object":case"embed":Vr("load",e),a=r;break;case"video":case"audio":for(a=0;a<zr.length;a++)Vr(zr[a],e);a=r;break;case"source":Vr("error",e),a=r;break;case"img":case"image":case"link":Vr("error",e),Vr("load",e),a=r;break;case"details":Vr("toggle",e),a=r;break;case"input":X(e,r),a=Y(e,r),Vr("invalid",e);break;case"option":default:a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=F({},r,{value:void 0}),Vr("invalid",e);break;case"textarea":ae(e,r),a=re(e,r),Vr("invalid",e)}for(s in ye(n,a),l=a)if(l.hasOwnProperty(s)){var u=l[s];"style"===s?me(e,u):"dangerouslySetInnerHTML"===s?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===s?"string"===typeof u?("textarea"!==n||""!==u)&&he(e,u):"number"===typeof u&&he(e,""+u):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(o.hasOwnProperty(s)?null!=u&&"onScroll"===s&&Vr("scroll",e):null!=u&&b(e,s,u,c))}switch(n){case"input":G(e),Z(e,r,!1);break;case"textarea":G(e),se(e);break;case"option":null!=r.value&&e.setAttribute("value",""+H(r.value));break;case"select":e.multiple=!!r.multiple,null!=(s=r.value)?ne(e,!!r.multiple,s,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=na)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Yo(t),null;case 6:if(e&&null!=t.stateNode)Fo(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(i(166));if(n=Qi(Xi.current),Qi(qi.current),pi(t)){if(r=t.stateNode,n=t.memoizedProps,r[ga]=t,(s=r.nodeValue!==n)&&null!==(e=ii))switch(e.tag){case 3:ta(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&ta(r.nodeValue,n,0!==(1&e.mode))}s&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[ga]=t,t.stateNode=r}return Yo(t),null;case 13:if(Ca(ns),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(oi&&null!==si&&0!==(1&t.mode)&&0===(128&t.flags))gi(),mi(),t.flags|=98560,s=!1;else if(s=pi(t),null!==r&&null!==r.dehydrated){if(null===e){if(!s)throw Error(i(318));if(!(s=null!==(s=t.memoizedState)?s.dehydrated:null))throw Error(i(317));s[ga]=t}else mi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Yo(t),s=!1}else null!==ci&&(ll(ci),ci=null),s=!0;if(!s)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&ns.current)?0===Fc&&(Fc=3):yl())),null!==t.updateQueue&&(t.flags|=4),Yo(t),null);case 4:return Zi(),Lo(e,t),null===e&&Wr(t.stateNode.containerInfo),Yo(t),null;case 10:return Ni(t.type._context),Yo(t),null;case 19:if(Ca(ns),null===(s=t.memoizedState))return Yo(t),null;if(r=0!==(128&t.flags),null===(c=s.rendering))if(r)qo(s,!1);else{if(0!==Fc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(c=rs(e))){for(t.flags|=128,qo(s,!1),null!==(r=c.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(s=n).flags&=14680066,null===(c=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=c.childLanes,s.lanes=c.lanes,s.child=c.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=c.memoizedProps,s.memoizedState=c.memoizedState,s.updateQueue=c.updateQueue,s.type=c.type,e=c.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Aa(ns,1&ns.current|2),t.child}e=e.sibling}null!==s.tail&&Qe()>Wc&&(t.flags|=128,r=!0,qo(s,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=rs(c))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),qo(s,!0),null===s.tail&&"hidden"===s.tailMode&&!c.alternate&&!oi)return Yo(t),null}else 2*Qe()-s.renderingStartTime>Wc&&1073741824!==n&&(t.flags|=128,r=!0,qo(s,!1),t.lanes=4194304);s.isBackwards?(c.sibling=t.child,t.child=c):(null!==(n=s.last)?n.sibling=c:t.child=c,s.last=c)}return null!==s.tail?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Qe(),t.sibling=null,n=ns.current,Aa(ns,r?1&n|2:1&n),t):(Yo(t),null);case 22:case 23:return pl(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Lc)&&(Yo(t),6&t.subtreeFlags&&(t.flags|=8192)):Yo(t),null;case 24:case 25:return null}throw Error(i(156,t.tag))}function Qo(e,t){switch(ai(t),t.tag){case 1:return La(t.type)&&Ma(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Zi(),Ca(Oa),Ca(Ra),is(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return ts(t),null;case 13:if(Ca(ns),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));mi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ca(ns),null;case 4:return Zi(),null;case 10:return Ni(t.type._context),null;case 22:case 23:return pl(),null;default:return null}}Po=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Lo=function(){},Mo=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,Qi(qi.current);var i,s=null;switch(n){case"input":a=Y(e,a),r=Y(e,r),s=[];break;case"select":a=F({},a,{value:void 0}),r=F({},r,{value:void 0}),s=[];break;case"textarea":a=re(e,a),r=re(e,r),s=[];break;default:"function"!==typeof a.onClick&&"function"===typeof r.onClick&&(e.onclick=na)}for(u in ye(n,r),n=null,a)if(!r.hasOwnProperty(u)&&a.hasOwnProperty(u)&&null!=a[u])if("style"===u){var c=a[u];for(i in c)c.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(o.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(c=null!=a?a[u]:void 0,r.hasOwnProperty(u)&&l!==c&&(null!=l||null!=c))if("style"===u)if(c){for(i in c)!c.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in l)l.hasOwnProperty(i)&&c[i]!==l[i]&&(n||(n={}),n[i]=l[i])}else n||(s||(s=[]),s.push(u,n)),n=l;else"dangerouslySetInnerHTML"===u?(l=l?l.__html:void 0,c=c?c.__html:void 0,null!=l&&c!==l&&(s=s||[]).push(u,l)):"children"===u?"string"!==typeof l&&"number"!==typeof l||(s=s||[]).push(u,""+l):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(o.hasOwnProperty(u)?(null!=l&&"onScroll"===u&&Vr("scroll",e),s||c===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(t.updateQueue=u)&&(t.flags|=4)}},Fo=function(e,t,n,r){n!==r&&(t.flags|=4)};var Jo=!1,Zo=!1,ec="function"===typeof WeakSet?WeakSet:Set,tc=null;function nc(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){_l(e,t,r)}else n.current=null}function rc(e,t,n){try{n()}catch(r){_l(e,t,r)}}var ac=!1;function ic(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var a=r=r.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,void 0!==i&&rc(t,n,i)}a=a.next}while(a!==r)}}function sc(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function oc(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function cc(e){var t=e.alternate;null!==t&&(e.alternate=null,cc(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[ga],delete t[ma],delete t[ya],delete t[ba],delete t[wa])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function lc(e){return 5===e.tag||3===e.tag||4===e.tag}function uc(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||lc(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function dc(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=na));else if(4!==r&&null!==(e=e.child))for(dc(e,t,n),e=e.sibling;null!==e;)dc(e,t,n),e=e.sibling}function hc(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(hc(e,t,n),e=e.sibling;null!==e;)hc(e,t,n),e=e.sibling}var fc=null,pc=!1;function gc(e,t,n){for(n=n.child;null!==n;)mc(e,t,n),n=n.sibling}function mc(e,t,n){if(it&&"function"===typeof it.onCommitFiberUnmount)try{it.onCommitFiberUnmount(at,n)}catch(o){}switch(n.tag){case 5:Zo||nc(n,t);case 6:var r=fc,a=pc;fc=null,gc(e,t,n),pc=a,null!==(fc=r)&&(pc?(e=fc,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):fc.removeChild(n.stateNode));break;case 18:null!==fc&&(pc?(e=fc,n=n.stateNode,8===e.nodeType?da(e.parentNode,n):1===e.nodeType&&da(e,n),$t(e)):da(fc,n.stateNode));break;case 4:r=fc,a=pc,fc=n.stateNode.containerInfo,pc=!0,gc(e,t,n),fc=r,pc=a;break;case 0:case 11:case 14:case 15:if(!Zo&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){a=r=r.next;do{var i=a,s=i.destroy;i=i.tag,void 0!==s&&(0!==(2&i)||0!==(4&i))&&rc(n,t,s),a=a.next}while(a!==r)}gc(e,t,n);break;case 1:if(!Zo&&(nc(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){_l(n,t,o)}gc(e,t,n);break;case 21:gc(e,t,n);break;case 22:1&n.mode?(Zo=(r=Zo)||null!==n.memoizedState,gc(e,t,n),Zo=r):gc(e,t,n);break;default:gc(e,t,n)}}function vc(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new ec),t.forEach((function(t){var r=Rl.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function yc(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var a=n[r];try{var s=e,o=t,c=o;e:for(;null!==c;){switch(c.tag){case 5:fc=c.stateNode,pc=!1;break e;case 3:case 4:fc=c.stateNode.containerInfo,pc=!0;break e}c=c.return}if(null===fc)throw Error(i(160));mc(s,o,a),fc=null,pc=!1;var l=a.alternate;null!==l&&(l.return=null),a.return=null}catch(u){_l(a,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)bc(t,e),t=t.sibling}function bc(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(yc(t,e),wc(e),4&r){try{ic(3,e,e.return),sc(3,e)}catch(m){_l(e,e.return,m)}try{ic(5,e,e.return)}catch(m){_l(e,e.return,m)}}break;case 1:yc(t,e),wc(e),512&r&&null!==n&&nc(n,n.return);break;case 5:if(yc(t,e),wc(e),512&r&&null!==n&&nc(n,n.return),32&e.flags){var a=e.stateNode;try{he(a,"")}catch(m){_l(e,e.return,m)}}if(4&r&&null!=(a=e.stateNode)){var s=e.memoizedProps,o=null!==n?n.memoizedProps:s,c=e.type,l=e.updateQueue;if(e.updateQueue=null,null!==l)try{"input"===c&&"radio"===s.type&&null!=s.name&&Q(a,s),be(c,o);var u=be(c,s);for(o=0;o<l.length;o+=2){var d=l[o],h=l[o+1];"style"===d?me(a,h):"dangerouslySetInnerHTML"===d?de(a,h):"children"===d?he(a,h):b(a,d,h,u)}switch(c){case"input":J(a,s);break;case"textarea":ie(a,s);break;case"select":var f=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var p=s.value;null!=p?ne(a,!!s.multiple,p,!1):f!==!!s.multiple&&(null!=s.defaultValue?ne(a,!!s.multiple,s.defaultValue,!0):ne(a,!!s.multiple,s.multiple?[]:"",!1))}a[ma]=s}catch(m){_l(e,e.return,m)}}break;case 6:if(yc(t,e),wc(e),4&r){if(null===e.stateNode)throw Error(i(162));a=e.stateNode,s=e.memoizedProps;try{a.nodeValue=s}catch(m){_l(e,e.return,m)}}break;case 3:if(yc(t,e),wc(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{$t(t.containerInfo)}catch(m){_l(e,e.return,m)}break;case 4:default:yc(t,e),wc(e);break;case 13:yc(t,e),wc(e),8192&(a=e.child).flags&&(s=null!==a.memoizedState,a.stateNode.isHidden=s,!s||null!==a.alternate&&null!==a.alternate.memoizedState||(Hc=Qe())),4&r&&vc(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Zo=(u=Zo)||d,yc(t,e),Zo=u):yc(t,e),wc(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&0!==(1&e.mode))for(tc=e,d=e.child;null!==d;){for(h=tc=d;null!==tc;){switch(p=(f=tc).child,f.tag){case 0:case 11:case 14:case 15:ic(4,f,f.return);break;case 1:nc(f,f.return);var g=f.stateNode;if("function"===typeof g.componentWillUnmount){r=f,n=f.return;try{t=r,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(m){_l(r,n,m)}}break;case 5:nc(f,f.return);break;case 22:if(null!==f.memoizedState){Sc(h);continue}}null!==p?(p.return=f,tc=p):Sc(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{a=h.stateNode,u?"function"===typeof(s=a.style).setProperty?s.setProperty("display","none","important"):s.display="none":(c=h.stateNode,o=void 0!==(l=h.memoizedProps.style)&&null!==l&&l.hasOwnProperty("display")?l.display:null,c.style.display=ge("display",o))}catch(m){_l(e,e.return,m)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(m){_l(e,e.return,m)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:yc(t,e),wc(e),4&r&&vc(e);case 21:}}function wc(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(lc(n)){var r=n;break e}n=n.return}throw Error(i(160))}switch(r.tag){case 5:var a=r.stateNode;32&r.flags&&(he(a,""),r.flags&=-33),hc(e,uc(e),a);break;case 3:case 4:var s=r.stateNode.containerInfo;dc(e,uc(e),s);break;default:throw Error(i(161))}}catch(Mn){_l(e,e.return,Mn)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Ec(e,t,n){tc=e,Tc(e,t,n)}function Tc(e,t,n){for(var r=0!==(1&e.mode);null!==tc;){var a=tc,i=a.child;if(22===a.tag&&r){var s=null!==a.memoizedState||Jo;if(!s){var o=a.alternate,c=null!==o&&null!==o.memoizedState||Zo;o=Jo;var l=Zo;if(Jo=s,(Zo=c)&&!l)for(tc=a;null!==tc;)c=(s=tc).child,22===s.tag&&null!==s.memoizedState?Ic(a):null!==c?(c.return=s,tc=c):Ic(a);for(;null!==i;)tc=i,Tc(i,t,n),i=i.sibling;tc=a,Jo=o,Zo=l}xc(e)}else 0!==(8772&a.subtreeFlags)&&null!==i?(i.return=a,tc=i):xc(e)}}function xc(e){for(;null!==tc;){var t=tc;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Zo||sc(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Zo)if(null===n)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:ao(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&Gi(t,s,r);break;case 3:var o=t.updateQueue;if(null!==o){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Gi(t,o,n)}break;case 5:var c=t.stateNode;if(null===n&&4&t.flags){n=c;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&$t(h)}}}break;default:throw Error(i(163))}Zo||512&t.flags&&oc(t)}catch(f){_l(t,t.return,f)}}if(t===e){tc=null;break}if(null!==(n=t.sibling)){n.return=t.return,tc=n;break}tc=t.return}}function Sc(e){for(;null!==tc;){var t=tc;if(t===e){tc=null;break}var n=t.sibling;if(null!==n){n.return=t.return,tc=n;break}tc=t.return}}function Ic(e){for(;null!==tc;){var t=tc;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{sc(4,t)}catch(Mn){_l(t,n,Mn)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var a=t.return;try{r.componentDidMount()}catch(Mn){_l(t,a,Mn)}}var i=t.return;try{oc(t)}catch(Mn){_l(t,i,Mn)}break;case 5:var s=t.return;try{oc(t)}catch(Mn){_l(t,s,Mn)}}}catch(Mn){_l(t,t.return,Mn)}if(t===e){tc=null;break}var o=t.sibling;if(null!==o){o.return=t.return,tc=o;break}tc=t.return}}var kc,_c=Math.ceil,Cc=w.ReactCurrentDispatcher,Ac=w.ReactCurrentOwner,Nc=w.ReactCurrentBatchConfig,Rc=0,Oc=null,Dc=null,Pc=0,Lc=0,Mc=_a(0),Fc=0,zc=null,jc=0,Uc=0,Bc=0,Vc=null,$c=null,Hc=0,Wc=1/0,Gc=null,Kc=!1,qc=null,Yc=null,Xc=!1,Qc=null,Jc=0,Zc=0,el=null,tl=-1,nl=0;function rl(){return 0!==(6&Rc)?Qe():-1!==tl?tl:tl=Qe()}function al(e){return 0===(1&e.mode)?1:0!==(2&Rc)&&0!==Pc?Pc&-Pc:null!==yi.transition?(0===nl&&(nl=gt()),nl):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Qt(e.type)}function il(e,t,n,r){if(50<Zc)throw Zc=0,el=null,Error(i(185));vt(e,n,r),0!==(2&Rc)&&e===Oc||(e===Oc&&(0===(2&Rc)&&(Uc|=n),4===Fc&&ul(e,Pc)),sl(e,r),1===n&&0===Rc&&0===(1&t.mode)&&(Wc=Qe()+500,Va&&Wa()))}function sl(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var s=31-st(i),o=1<<s,c=a[s];-1===c?0!==(o&n)&&0===(o&r)||(a[s]=ft(o,t)):c<=t&&(e.expiredLanes|=o),i&=~o}}(e,t);var r=ht(e,e===Oc?Pc:0);if(0===r)null!==n&&qe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&qe(n),1===t)0===e.tag?function(e){Va=!0,Ha(e)}(dl.bind(null,e)):Ha(dl.bind(null,e)),la((function(){0===(6&Rc)&&Wa()})),n=null;else{switch(wt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Ol(n,ol.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ol(e,t){if(tl=-1,nl=0,0!==(6&Rc))throw Error(i(327));var n=e.callbackNode;if(Il()&&e.callbackNode!==n)return null;var r=ht(e,e===Oc?Pc:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=bl(e,r);else{t=r;var a=Rc;Rc|=2;var s=vl();for(Oc===e&&Pc===t||(Gc=null,Wc=Qe()+500,gl(e,t));;)try{El();break}catch(c){ml(e,c)}Ai(),Cc.current=s,Rc=a,null!==Dc?t=0:(Oc=null,Pc=0,t=Fc)}if(0!==t){if(2===t&&(0!==(a=pt(e))&&(r=a,t=cl(e,a))),1===t)throw n=zc,gl(e,0),ul(e,r),sl(e,Qe()),n;if(6===t)ul(e,r);else{if(a=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!ur(i(),a))return!1}catch(o){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(a)&&(2===(t=bl(e,r))&&(0!==(s=pt(e))&&(r=s,t=cl(e,s))),1===t))throw n=zc,gl(e,0),ul(e,r),sl(e,Qe()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(i(345));case 2:case 5:Sl(e,$c,Gc);break;case 3:if(ul(e,r),(130023424&r)===r&&10<(t=Hc+500-Qe())){if(0!==ht(e,0))break;if(((a=e.suspendedLanes)&r)!==r){rl(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=sa(Sl.bind(null,e,$c,Gc),t);break}Sl(e,$c,Gc);break;case 4:if(ul(e,r),(4194240&r)===r)break;for(t=e.eventTimes,a=-1;0<r;){var o=31-st(r);s=1<<o,(o=t[o])>a&&(a=o),r&=~s}if(r=a,10<(r=(120>(r=Qe()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*_c(r/1960))-r)){e.timeoutHandle=sa(Sl.bind(null,e,$c,Gc),r);break}Sl(e,$c,Gc);break;default:throw Error(i(329))}}}return sl(e,Qe()),e.callbackNode===n?ol.bind(null,e):null}function cl(e,t){var n=Vc;return e.current.memoizedState.isDehydrated&&(gl(e,t).flags|=256),2!==(e=bl(e,t))&&(t=$c,$c=n,null!==t&&ll(t)),e}function ll(e){null===$c?$c=e:$c.push.apply($c,e)}function ul(e,t){for(t&=~Bc,t&=~Uc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-st(t),r=1<<n;e[n]=-1,t&=~r}}function dl(e){if(0!==(6&Rc))throw Error(i(327));Il();var t=ht(e,0);if(0===(1&t))return sl(e,Qe()),null;var n=bl(e,t);if(0!==e.tag&&2===n){var r=pt(e);0!==r&&(t=r,n=cl(e,r))}if(1===n)throw n=zc,gl(e,0),ul(e,t),sl(e,Qe()),n;if(6===n)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Sl(e,$c,Gc),sl(e,Qe()),null}function hl(e,t){var n=Rc;Rc|=1;try{return e(t)}finally{0===(Rc=n)&&(Wc=Qe()+500,Va&&Wa())}}function fl(e){null!==Qc&&0===Qc.tag&&0===(6&Rc)&&Il();var t=Rc;Rc|=1;var n=Nc.transition,r=bt;try{if(Nc.transition=null,bt=1,e)return e()}finally{bt=r,Nc.transition=n,0===(6&(Rc=t))&&Wa()}}function pl(){Lc=Mc.current,Ca(Mc)}function gl(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,oa(n)),null!==Dc)for(n=Dc.return;null!==n;){var r=n;switch(ai(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Ma();break;case 3:Zi(),Ca(Oa),Ca(Ra),is();break;case 5:ts(r);break;case 4:Zi();break;case 13:case 19:Ca(ns);break;case 10:Ni(r.type._context);break;case 22:case 23:pl()}n=n.return}if(Oc=e,Dc=e=Ml(e.current,null),Pc=Lc=t,Fc=0,zc=null,Bc=Uc=jc=0,$c=Vc=null,null!==Pi){for(t=0;t<Pi.length;t++)if(null!==(r=(n=Pi[t]).interleaved)){n.interleaved=null;var a=r.next,i=n.pending;if(null!==i){var s=i.next;i.next=a,r.next=s}n.pending=r}Pi=null}return e}function ml(e,t){for(;;){var n=Dc;try{if(Ai(),ss.current=eo,hs){for(var r=ls.memoizedState;null!==r;){var a=r.queue;null!==a&&(a.pending=null),r=r.next}hs=!1}if(cs=0,ds=us=ls=null,fs=!1,ps=0,Ac.current=null,null===n||null===n.return){Fc=1,zc=t,Dc=null;break}e:{var s=e,o=n.return,c=n,l=t;if(t=Pc,c.flags|=32768,null!==l&&"object"===typeof l&&"function"===typeof l.then){var u=l,d=c,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=bo(o);if(null!==p){p.flags&=-257,wo(p,o,c,0,t),1&p.mode&&yo(s,u,t),l=u;var g=(t=p).updateQueue;if(null===g){var m=new Set;m.add(l),t.updateQueue=m}else g.add(l);break e}if(0===(1&t)){yo(s,u,t),yl();break e}l=Error(i(426))}else if(oi&&1&c.mode){var v=bo(o);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),wo(v,o,c,0,t),vi(ho(l,c));break e}}s=l=ho(l,c),4!==Fc&&(Fc=2),null===Vc?Vc=[s]:Vc.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t,Hi(s,mo(0,l,t));break e;case 1:c=l;var y=s.type,b=s.stateNode;if(0===(128&s.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Yc||!Yc.has(b)))){s.flags|=65536,t&=-t,s.lanes|=t,Hi(s,vo(s,c,t));break e}}s=s.return}while(null!==s)}xl(n)}catch(w){t=w,Dc===n&&null!==n&&(Dc=n=n.return);continue}break}}function vl(){var e=Cc.current;return Cc.current=eo,null===e?eo:e}function yl(){0!==Fc&&3!==Fc&&2!==Fc||(Fc=4),null===Oc||0===(268435455&jc)&&0===(268435455&Uc)||ul(Oc,Pc)}function bl(e,t){var n=Rc;Rc|=2;var r=vl();for(Oc===e&&Pc===t||(Gc=null,gl(e,t));;)try{wl();break}catch(a){ml(e,a)}if(Ai(),Rc=n,Cc.current=r,null!==Dc)throw Error(i(261));return Oc=null,Pc=0,Fc}function wl(){for(;null!==Dc;)Tl(Dc)}function El(){for(;null!==Dc&&!Ye();)Tl(Dc)}function Tl(e){var t=kc(e.alternate,e,Lc);e.memoizedProps=e.pendingProps,null===t?xl(e):Dc=t,Ac.current=null}function xl(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Xo(n,t,Lc)))return void(Dc=n)}else{if(null!==(n=Qo(n,t)))return n.flags&=32767,void(Dc=n);if(null===e)return Fc=6,void(Dc=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Dc=t);Dc=t=e}while(null!==t);0===Fc&&(Fc=5)}function Sl(e,t,n){var r=bt,a=Nc.transition;try{Nc.transition=null,bt=1,function(e,t,n,r){do{Il()}while(null!==Qc);if(0!==(6&Rc))throw Error(i(327));n=e.finishedWork;var a=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-st(n),i=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~i}}(e,s),e===Oc&&(Dc=Oc=null,Pc=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Xc||(Xc=!0,Ol(tt,(function(){return Il(),null}))),s=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||s){s=Nc.transition,Nc.transition=null;var o=bt;bt=1;var c=Rc;Rc|=4,Ac.current=null,function(e,t){if(ra=Wt,mr(e=gr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var a=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch(nn){n=null;break e}var o=0,c=-1,l=-1,u=0,d=0,h=e,f=null;t:for(;;){for(var p;h!==n||0!==a&&3!==h.nodeType||(c=o+a),h!==s||0!==r&&3!==h.nodeType||(l=o+r),3===h.nodeType&&(o+=h.nodeValue.length),null!==(p=h.firstChild);)f=h,h=p;for(;;){if(h===e)break t;if(f===n&&++u===a&&(c=o),f===s&&++d===r&&(l=o),null!==(p=h.nextSibling))break;f=(h=f).parentNode}h=p}n=-1===c||-1===l?null:{start:c,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(aa={focusedElem:e,selectionRange:n},Wt=!1,tc=t;null!==tc;)if(e=(t=tc).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,tc=e;else for(;null!==tc;){t=tc;try{var g=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==g){var m=g.memoizedProps,v=g.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?m:ao(t.type,m),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=t.stateNode.containerInfo;1===w.nodeType?w.textContent="":9===w.nodeType&&w.documentElement&&w.removeChild(w.documentElement);break;default:throw Error(i(163))}}catch(nn){_l(t,t.return,nn)}if(null!==(e=t.sibling)){e.return=t.return,tc=e;break}tc=t.return}g=ac,ac=!1}(e,n),bc(n,e),vr(aa),Wt=!!ra,aa=ra=null,e.current=n,Ec(n,e,a),Xe(),Rc=c,bt=o,Nc.transition=s}else e.current=n;if(Xc&&(Xc=!1,Qc=e,Jc=a),s=e.pendingLanes,0===s&&(Yc=null),function(e){if(it&&"function"===typeof it.onCommitFiberRoot)try{it.onCommitFiberRoot(at,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),sl(e,Qe()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(Kc)throw Kc=!1,e=qc,qc=null,e;0!==(1&Jc)&&0!==e.tag&&Il(),s=e.pendingLanes,0!==(1&s)?e===el?Zc++:(Zc=0,el=e):Zc=0,Wa()}(e,t,n,r)}finally{Nc.transition=a,bt=r}return null}function Il(){if(null!==Qc){var e=wt(Jc),t=Nc.transition,n=bt;try{if(Nc.transition=null,bt=16>e?16:e,null===Qc)var r=!1;else{if(e=Qc,Qc=null,Jc=0,0!==(6&Rc))throw Error(i(331));var a=Rc;for(Rc|=4,tc=e.current;null!==tc;){var s=tc,o=s.child;if(0!==(16&tc.flags)){var c=s.deletions;if(null!==c){for(var l=0;l<c.length;l++){var u=c[l];for(tc=u;null!==tc;){var d=tc;switch(d.tag){case 0:case 11:case 15:ic(8,d,s)}var h=d.child;if(null!==h)h.return=d,tc=h;else for(;null!==tc;){var f=(d=tc).sibling,p=d.return;if(cc(d),d===u){tc=null;break}if(null!==f){f.return=p,tc=f;break}tc=p}}}var g=s.alternate;if(null!==g){var m=g.child;if(null!==m){g.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(null!==m)}}tc=s}}if(0!==(2064&s.subtreeFlags)&&null!==o)o.return=s,tc=o;else e:for(;null!==tc;){if(0!==(2048&(s=tc).flags))switch(s.tag){case 0:case 11:case 15:ic(9,s,s.return)}var y=s.sibling;if(null!==y){y.return=s.return,tc=y;break e}tc=s.return}}var b=e.current;for(tc=b;null!==tc;){var w=(o=tc).child;if(0!==(2064&o.subtreeFlags)&&null!==w)w.return=o,tc=w;else e:for(o=b;null!==tc;){if(0!==(2048&(c=tc).flags))try{switch(c.tag){case 0:case 11:case 15:sc(9,c)}}catch(T){_l(c,c.return,T)}if(c===o){tc=null;break e}var E=c.sibling;if(null!==E){E.return=c.return,tc=E;break e}tc=c.return}}if(Rc=a,Wa(),it&&"function"===typeof it.onPostCommitFiberRoot)try{it.onPostCommitFiberRoot(at,e)}catch(T){}r=!0}return r}finally{bt=n,Nc.transition=t}}return!1}function kl(e,t,n){e=Vi(e,t=mo(0,t=ho(n,t),1),1),t=rl(),null!==e&&(vt(e,1,t),sl(e,t))}function _l(e,t,n){if(3===e.tag)kl(e,e,n);else for(;null!==t;){if(3===t.tag){kl(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Yc||!Yc.has(r))){t=Vi(t,e=vo(t,e=ho(n,e),1),1),e=rl(),null!==t&&(vt(t,1,e),sl(t,e));break}}t=t.return}}function Cl(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=rl(),e.pingedLanes|=e.suspendedLanes&n,Oc===e&&(Pc&n)===n&&(4===Fc||3===Fc&&(130023424&Pc)===Pc&&500>Qe()-Hc?gl(e,0):Bc|=n),sl(e,t)}function Al(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=rl();null!==(e=Fi(e,t))&&(vt(e,t,n),sl(e,n))}function Nl(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Al(e,n)}function Rl(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;null!==a&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(i(314))}null!==r&&r.delete(t),Al(e,n)}function Ol(e,t){return Ke(e,t)}function Dl(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pl(e,t,n,r){return new Dl(e,t,n,r)}function Ll(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Ml(e,t){var n=e.alternate;return null===n?((n=Pl(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Fl(e,t,n,r,a,s){var o=2;if(r=e,"function"===typeof e)Ll(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case x:return zl(n.children,a,s,t);case S:o=8,a|=8;break;case I:return(e=Pl(12,n,t,2|a)).elementType=I,e.lanes=s,e;case A:return(e=Pl(13,n,t,a)).elementType=A,e.lanes=s,e;case N:return(e=Pl(19,n,t,a)).elementType=N,e.lanes=s,e;case D:return jl(n,a,s,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case k:o=10;break e;case _:o=9;break e;case C:o=11;break e;case R:o=14;break e;case O:o=16,r=null;break e}throw Error(i(130,null==e?e:typeof e,""))}return(t=Pl(o,n,t,a)).elementType=e,t.type=r,t.lanes=s,t}function zl(e,t,n,r){return(e=Pl(7,e,r,t)).lanes=n,e}function jl(e,t,n,r){return(e=Pl(22,e,r,t)).elementType=D,e.lanes=n,e.stateNode={isHidden:!1},e}function Ul(e,t,n){return(e=Pl(6,e,null,t)).lanes=n,e}function Bl(e,t,n){return(t=Pl(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Vl(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mt(0),this.expirationTimes=mt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mt(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function $l(e,t,n,r,a,i,s,o,c){return e=new Vl(e,t,n,o,c),1===t?(t=1,!0===i&&(t|=8)):t=0,i=Pl(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},ji(i),e}function Hl(e){if(!e)return Na;e:{if(Ve(e=e._reactInternals)!==e||1!==e.tag)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(La(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(i(171))}if(1===e.tag){var n=e.type;if(La(n))return za(e,n,t)}return t}function Wl(e,t,n,r,a,i,s,o,c){return(e=$l(n,r,!0,e,0,i,0,o,c)).context=Hl(null),n=e.current,(i=Bi(r=rl(),a=al(n))).callback=void 0!==t&&null!==t?t:null,Vi(n,i,a),e.current.lanes=a,vt(e,a,r),sl(e,r),e}function Gl(e,t,n,r){var a=t.current,i=rl(),s=al(a);return n=Hl(n),null===t.context?t.context=n:t.pendingContext=n,(t=Bi(i,s)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Vi(a,t,s))&&(il(e,a,s,i),$i(e,a,s)),s}function Kl(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function ql(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Yl(e,t){ql(e,t),(e=e.alternate)&&ql(e,t)}kc=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Oa.current)To=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return To=!1,function(e,t,n){switch(t.tag){case 3:Oo(t),mi();break;case 5:es(t);break;case 1:La(t.type)&&ja(t);break;case 4:Ji(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;Aa(Ii,r._currentValue),r._currentValue=a;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Aa(ns,1&ns.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Uo(e,t,n):(Aa(ns,1&ns.current),null!==(e=Ko(e,t,n))?e.sibling:null);Aa(ns,1&ns.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Wo(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),Aa(ns,ns.current),r)break;return null;case 22:case 23:return t.lanes=0,_o(e,t,n)}return Ko(e,t,n)}(e,t,n);To=0!==(131072&e.flags)}else To=!1,oi&&0!==(1048576&t.flags)&&ni(t,Ya,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Go(e,t),e=t.pendingProps;var a=Pa(t,Ra.current);Oi(t,n),a=ys(null,t,r,e,a,n);var s=bs();return t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,La(r)?(s=!0,ja(t)):s=!1,t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,ji(t),a.updater=so,t.stateNode=a,a._reactInternals=t,uo(t,r,e,n),t=Ro(null,t,r,!0,s,n)):(t.tag=0,oi&&s&&ri(t),xo(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Go(e,t),e=t.pendingProps,r=(a=r._init)(r._payload),t.type=r,a=t.tag=function(e){if("function"===typeof e)return Ll(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===C)return 11;if(e===R)return 14}return 2}(r),e=ao(r,e),a){case 0:t=Ao(null,t,r,e,n);break e;case 1:t=No(null,t,r,e,n);break e;case 11:t=So(null,t,r,e,n);break e;case 14:t=Io(null,t,r,ao(r.type,e),n);break e}throw Error(i(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,Ao(e,t,r,a=t.elementType===r?a:ao(r,a),n);case 1:return r=t.type,a=t.pendingProps,No(e,t,r,a=t.elementType===r?a:ao(r,a),n);case 3:e:{if(Oo(t),null===e)throw Error(i(387));r=t.pendingProps,a=(s=t.memoizedState).element,Ui(e,t),Wi(t,r,null,n);var o=t.memoizedState;if(r=o.element,s.isDehydrated){if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Do(e,t,r,n,a=ho(Error(i(423)),t));break e}if(r!==a){t=Do(e,t,r,n,a=ho(Error(i(424)),t));break e}for(si=ha(t.stateNode.containerInfo.firstChild),ii=t,oi=!0,ci=null,n=Si(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(mi(),r===a){t=Ko(e,t,n);break e}xo(e,t,r,n)}t=t.child}return t;case 5:return es(t),null===e&&hi(t),r=t.type,a=t.pendingProps,s=null!==e?e.memoizedProps:null,o=a.children,ia(r,a)?o=null:null!==s&&ia(r,s)&&(t.flags|=32),Co(e,t),xo(e,t,o,n),t.child;case 6:return null===e&&hi(t),null;case 13:return Uo(e,t,n);case 4:return Ji(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=xi(t,null,r,n):xo(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,So(e,t,r,a=t.elementType===r?a:ao(r,a),n);case 7:return xo(e,t,t.pendingProps,n),t.child;case 8:case 12:return xo(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,s=t.memoizedProps,o=a.value,Aa(Ii,r._currentValue),r._currentValue=o,null!==s)if(ur(s.value,o)){if(s.children===a.children&&!Oa.current){t=Ko(e,t,n);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var c=s.dependencies;if(null!==c){o=s.child;for(var l=c.firstContext;null!==l;){if(l.context===r){if(1===s.tag){(l=Bi(-1,n&-n)).tag=2;var u=s.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),Ri(s.return,n,t),c.lanes|=n;break}l=l.next}}else if(10===s.tag)o=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(o=s.return))throw Error(i(341));o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),Ri(o,n,t),o=s.sibling}else o=s.child;if(null!==o)o.return=s;else for(o=s;null!==o;){if(o===t){o=null;break}if(null!==(s=o.sibling)){s.return=o.return,o=s;break}o=o.return}s=o}xo(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,Oi(t,n),r=r(a=Di(a)),t.flags|=1,xo(e,t,r,n),t.child;case 14:return a=ao(r=t.type,t.pendingProps),Io(e,t,r,a=ao(r.type,a),n);case 15:return ko(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:ao(r,a),Go(e,t),t.tag=1,La(r)?(e=!0,ja(t)):e=!1,Oi(t,n),co(t,r,a),uo(t,r,a,n),Ro(null,t,r,!0,e,n);case 19:return Wo(e,t,n);case 22:return _o(e,t,n)}throw Error(i(156,t.tag))};var Xl="function"===typeof reportError?reportError:function(e){console.error(e)};function Ql(e){this._internalRoot=e}function Jl(e){this._internalRoot=e}function Zl(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function eu(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function tu(){}function nu(e,t,n,r,a){var i=n._reactRootContainer;if(i){var s=i;if("function"===typeof a){var o=a;a=function(){var e=Kl(s);o.call(e)}}Gl(t,s,e,a)}else s=function(e,t,n,r,a){if(a){if("function"===typeof r){var i=r;r=function(){var e=Kl(s);i.call(e)}}var s=Wl(t,r,e,0,null,!1,0,"",tu);return e._reactRootContainer=s,e[va]=s.current,Wr(8===e.nodeType?e.parentNode:e),fl(),s}for(;a=e.lastChild;)e.removeChild(a);if("function"===typeof r){var o=r;r=function(){var e=Kl(c);o.call(e)}}var c=$l(e,0,!1,null,0,!1,0,"",tu);return e._reactRootContainer=c,e[va]=c.current,Wr(8===e.nodeType?e.parentNode:e),fl((function(){Gl(t,c,n,r)})),c}(n,t,e,a,r);return Kl(s)}Jl.prototype.render=Ql.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));Gl(e,t,null,null)},Jl.prototype.unmount=Ql.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;fl((function(){Gl(null,e,null,null)})),t[va]=null}},Jl.prototype.unstable_scheduleHydration=function(e){if(e){var t=It();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Pt.length&&0!==t&&t<Pt[n].priority;n++);Pt.splice(n,0,e),0===n&&zt(e)}},Et=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(yt(t,1|n),sl(t,Qe()),0===(6&Rc)&&(Wc=Qe()+500,Wa()))}break;case 13:fl((function(){var t=Fi(e,1);if(null!==t){var n=rl();il(t,e,1,n)}})),Yl(e,1)}},Tt=function(e){if(13===e.tag){var t=Fi(e,134217728);if(null!==t)il(t,e,134217728,rl());Yl(e,134217728)}},xt=function(e){if(13===e.tag){var t=al(e),n=Fi(e,t);if(null!==n)il(n,e,t,rl());Yl(e,t)}},It=function(){return bt},kt=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},Te=function(e,t,n){switch(t){case"input":if(J(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=Sa(r);if(!a)throw Error(i(90));K(r),J(r,a)}}}break;case"textarea":ie(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ce=hl,Ae=fl;var ru={usingClientEntryPoint:!1,Events:[Ta,xa,Sa,ke,_e,hl]},au={findFiberByHostInstance:Ea,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},iu={bundleType:au.bundleType,version:au.version,rendererPackageName:au.rendererPackageName,rendererConfig:au.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=We(e))?null:e.stateNode},findFiberByHostInstance:au.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var su=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!su.isDisabled&&su.supportsFiber)try{at=su.inject(iu),it=su}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ru,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Zl(t))throw Error(i(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:T,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Zl(e))throw Error(i(299));var n=!1,r="",a=Xl;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(a=t.onRecoverableError)),t=$l(e,1,!1,null,0,n,0,r,a),e[va]=t.current,Wr(8===e.nodeType?e.parentNode:e),new Ql(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=null===(e=We(t))?null:e.stateNode},t.flushSync=function(e){return fl(e)},t.hydrate=function(e,t,n){if(!eu(t))throw Error(i(200));return nu(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Zl(e))throw Error(i(405));var r=null!=n&&n.hydratedSources||null,a=!1,s="",o=Xl;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(a=!0),void 0!==n.identifierPrefix&&(s=n.identifierPrefix),void 0!==n.onRecoverableError&&(o=n.onRecoverableError)),t=Wl(t,null,e,1,null!=n?n:null,a,0,s,o),e[va]=t.current,Wr(e),r)for(e=0;e<r.length;e++)a=(a=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new Jl(t)},t.render=function(e,t,n){if(!eu(t))throw Error(i(200));return nu(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!eu(e))throw Error(i(40));return!!e._reactRootContainer&&(fl((function(){nu(null,null,e,!1,(function(){e._reactRootContainer=null,e[va]=null}))})),!0)},t.unstable_batchedUpdates=hl,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!eu(n))throw Error(i(200));if(null==e||void 0===e._reactInternals)throw Error(i(38));return nu(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},853:(e,t,n)=>{e.exports=n(234)},950:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.m=e,n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,r)=>(n.f[r](e,t),t)),[])),n.u=e=>"static/js/"+e+".4b8be825.chunk.js",n.miniCssF=e=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="asignacion-plazas:";n.l=(r,a,i,s)=>{if(e[r])e[r].push(a);else{var o,c;if(void 0!==i)for(var l=document.getElementsByTagName("script"),u=0;u<l.length;u++){var d=l[u];if(d.getAttribute("src")==r||d.getAttribute("data-webpack")==t+i){o=d;break}}o||(c=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,n.nc&&o.setAttribute("nonce",n.nc),o.setAttribute("data-webpack",t+i),o.src=r),e[r]=[a];var h=(t,n)=>{o.onerror=o.onload=null,clearTimeout(f);var a=e[r];if(delete e[r],o.parentNode&&o.parentNode.removeChild(o),a&&a.forEach((e=>e(n))),t)return t(n)},f=setTimeout(h.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=h.bind(null,o.onerror),o.onload=h.bind(null,o.onload),c&&document.head.appendChild(o)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/asignacion-plazas/",(()=>{var e={792:0};n.f.j=(t,r)=>{var a=n.o(e,t)?e[t]:void 0;if(0!==a)if(a)r.push(a[2]);else{var i=new Promise(((n,r)=>a=e[t]=[n,r]));r.push(a[2]=i);var s=n.p+n.u(t),o=new Error;n.l(s,(r=>{if(n.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=r&&("load"===r.type?"missing":r.type),s=r&&r.target&&r.target.src;o.message="Loading chunk "+t+" failed.\n("+i+": "+s+")",o.name="ChunkLoadError",o.type=i,o.request=s,a[1](o)}}),"chunk-"+t,t)}};var t=(t,r)=>{var a,i,s=r[0],o=r[1],c=r[2],l=0;if(s.some((t=>0!==e[t]))){for(a in o)n.o(o,a)&&(n.m[a]=o[a]);if(c)c(n)}for(t&&t(r);l<s.length;l++)i=s[l],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0},r=self.webpackChunkasignacion_plazas=self.webpackChunkasignacion_plazas||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var r=n(43),a=n(391);const i=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let a=e.charCodeAt(r);a<128?t[n++]=a:a<2048?(t[n++]=a>>6|192,t[n++]=63&a|128):55296===(64512&a)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(a=65536+((1023&a)<<10)+(1023&e.charCodeAt(++r)),t[n++]=a>>18|240,t[n++]=a>>12&63|128,t[n++]=a>>6&63|128,t[n++]=63&a|128):(t[n++]=a>>12|224,t[n++]=a>>6&63|128,t[n++]=63&a|128)}return t},s={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let a=0;a<e.length;a+=3){const t=e[a],i=a+1<e.length,s=i?e[a+1]:0,o=a+2<e.length,c=o?e[a+2]:0,l=t>>2,u=(3&t)<<4|s>>4;let d=(15&s)<<2|c>>6,h=63&c;o||(h=64,i||(d=64)),r.push(n[l],n[u],n[d],n[h])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(i(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const a=e[n++];if(a<128)t[r++]=String.fromCharCode(a);else if(a>191&&a<224){const i=e[n++];t[r++]=String.fromCharCode((31&a)<<6|63&i)}else if(a>239&&a<365){const i=((7&a)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(i>>10)),t[r++]=String.fromCharCode(56320+(1023&i))}else{const i=e[n++],s=e[n++];t[r++]=String.fromCharCode((15&a)<<12|(63&i)<<6|63&s)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let a=0;a<e.length;){const t=n[e.charAt(a++)],i=a<e.length?n[e.charAt(a)]:0;++a;const s=a<e.length?n[e.charAt(a)]:64;++a;const c=a<e.length?n[e.charAt(a)]:64;if(++a,null==t||null==i||null==s||null==c)throw new o;const l=t<<2|i>>4;if(r.push(l),64!==s){const e=i<<4&240|s>>2;if(r.push(e),64!==c){const e=s<<6&192|c;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class o extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const c=function(e){return function(e){const t=i(e);return s.encodeByteArray(t,!0)}(e).replace(/\./g,"")},l=function(e){try{return s.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};const u=()=>function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,d=()=>{try{return u()||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"/asignacion-plazas",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_FIREBASE_API_KEY:"AIzaSyDo7X1BLIW1hNYQpJLZcDws_L4aGHJWXOQ",REACT_APP_FIREBASE_AUTH_DOMAIN:"asignacion-plazas.firebaseapp.com",REACT_APP_FIREBASE_PROJECT_ID:"asignacion-plazas",REACT_APP_FIREBASE_STORAGE_BUCKET:"asignacion-plazas.firebasestorage.app",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"525955676079",REACT_APP_FIREBASE_APP_ID:"1:525955676079:web:a7e0b00391e75c902fe15a",REACT_APP_FIREBASE_MEASUREMENT_ID:"G-E0DLWYPVKP"}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const t=e&&l(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},h=e=>{var t,n;return null===(n=null===(t=d())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},f=()=>{var e;return null===(e=d())||void 0===e?void 0:e.config},p=e=>{var t;return null===(t=d())||void 0===t?void 0:t[`_${e}`]};class g{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function m(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function v(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}function y(){return!function(){var e;const t=null===(e=d())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(r){return!1}}()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function b(){try{return"object"===typeof indexedDB}catch(e){return!1}}function w(){return new Promise(((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(r);a.onsuccess=()=>{a.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},a.onupgradeneeded=()=>{n=!1},a.onerror=()=>{var e;t((null===(e=a.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}}))}class E extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,E.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,T.prototype.create)}}class T{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n=`${this.service}/${e}`,r=this.errors[e],a=r?function(e,t){return e.replace(x,((e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`}))}(r,t):"Error",i=`${this.serviceName}: ${a} (${n}).`;return new E(n,i,t)}}const x=/\{\$([^}]+)}/g;function S(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const a of n){if(!r.includes(a))return!1;const n=e[a],i=t[a];if(I(n)&&I(i)){if(!S(n,i))return!1}else if(n!==i)return!1}for(const a of r)if(!n.includes(a))return!1;return!0}function I(e){return null!==e&&"object"===typeof e}function k(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function _(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}})),t}function C(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class A{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!==typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"===typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=N),void 0===r.error&&(r.error=N),void 0===r.complete&&(r.complete=N);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}})),this.observers.push(r),a}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){"undefined"!==typeof console&&console.error&&console.error(n)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function N(){}function R(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;const n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3)*Math.pow(t,e),r=Math.round(.5*n*(Math.random()-.5)*2);return Math.min(144e5,n+r)}function O(e){return e&&e._delegate?e._delegate:e}class D{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const P="[DEFAULT]";class L{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new g;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(n){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(a){if(r)return null;throw a}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:P})}catch(t){}for(const[e,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:r});n.resolve(e)}catch(t){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[a,i]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(a)&&i.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),a=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;a.add(e),this.onInitCallbacks.set(r,a);const i=this.instances.get(r);return i&&e(i,r),()=>{a.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const a of n)try{a(e,t)}catch(r){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(a=t,a===P?void 0:a),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch(i){}var a;return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P;return this.component?this.component.multipleInstances?e:P:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class M{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new L(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const F=[];var z;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(z||(z={}));const j={debug:z.DEBUG,verbose:z.VERBOSE,info:z.INFO,warn:z.WARN,error:z.ERROR,silent:z.SILENT},U=z.INFO,B={[z.DEBUG]:"log",[z.VERBOSE]:"log",[z.INFO]:"info",[z.WARN]:"warn",[z.ERROR]:"error"},V=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=B[t];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);for(var a=arguments.length,i=new Array(a>2?a-2:0),s=2;s<a;s++)i[s-2]=arguments[s];console[r](`[${n}]  ${e.name}:`,...i)};class H{constructor(e){this.name=e,this._logLevel=U,this._logHandler=V,this._userLogHandler=null,F.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in z))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?j[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,z.DEBUG,...t),this._logHandler(this,z.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,z.VERBOSE,...t),this._logHandler(this,z.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,z.INFO,...t),this._logHandler(this,z.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,z.WARN,...t),this._logHandler(this,z.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,z.ERROR,...t),this._logHandler(this,z.ERROR,...t)}}let W,G;const K=new WeakMap,q=new WeakMap,Y=new WeakMap,X=new WeakMap,Q=new WeakMap;let J={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return q.get(e);if("objectStoreNames"===t)return e.objectStoreNames||Y.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return te(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function Z(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(G||(G=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(ne(this),n),te(K.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return te(e.apply(ne(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];const i=e.call(ne(this),t,...r);return Y.set(i,t.sort?t.sort():[t]),te(i)}}function ee(e){return"function"===typeof e?Z(e):(e instanceof IDBTransaction&&function(e){if(q.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",a),e.removeEventListener("error",i),e.removeEventListener("abort",i)},a=()=>{t(),r()},i=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",a),e.addEventListener("error",i),e.addEventListener("abort",i)}));q.set(e,t)}(e),t=e,(W||(W=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>t instanceof e))?new Proxy(e,J):e);var t}function te(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",a),e.removeEventListener("error",i)},a=()=>{t(te(e.result)),r()},i=()=>{n(e.error),r()};e.addEventListener("success",a),e.addEventListener("error",i)}));return t.then((t=>{t instanceof IDBCursor&&K.set(t,e)})).catch((()=>{})),Q.set(t,e),t}(e);if(X.has(e))return X.get(e);const t=ee(e);return t!==e&&(X.set(e,t),Q.set(t,e)),t}const ne=e=>Q.get(e);function re(e,t){let{blocked:n,upgrade:r,blocking:a,terminated:i}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const s=indexedDB.open(e,t),o=te(s);return r&&s.addEventListener("upgradeneeded",(e=>{r(te(s.result),e.oldVersion,e.newVersion,te(s.transaction),e)})),n&&s.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),o.then((e=>{i&&e.addEventListener("close",(()=>i())),a&&e.addEventListener("versionchange",(e=>a(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),o}const ae=["get","getKey","getAll","getAllKeys","count"],ie=["put","add","delete","clear"],se=new Map;function oe(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(se.get(t))return se.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,a=ie.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!a&&!ae.includes(n))return;const i=async function(e){const t=this.transaction(e,a?"readwrite":"readonly");let i=t.store;for(var s=arguments.length,o=new Array(s>1?s-1:0),c=1;c<s;c++)o[c-1]=arguments[c];return r&&(i=i.index(o.shift())),(await Promise.all([i[n](...o),a&&t.done]))[0]};return se.set(t,i),i}J=(e=>({...e,get:(t,n,r)=>oe(t,n)||e.get(t,n,r),has:(t,n)=>!!oe(t,n)||e.has(t,n)}))(J);class ce{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const le="@firebase/app",ue="0.11.4",de=new H("@firebase/app"),he="@firebase/app-compat",fe="@firebase/analytics-compat",pe="@firebase/analytics",ge="@firebase/app-check-compat",me="@firebase/app-check",ve="@firebase/auth",ye="@firebase/auth-compat",be="@firebase/database",we="@firebase/data-connect",Ee="@firebase/database-compat",Te="@firebase/functions",xe="@firebase/functions-compat",Se="@firebase/installations",Ie="@firebase/installations-compat",ke="@firebase/messaging",_e="@firebase/messaging-compat",Ce="@firebase/performance",Ae="@firebase/performance-compat",Ne="@firebase/remote-config",Re="@firebase/remote-config-compat",Oe="@firebase/storage",De="@firebase/storage-compat",Pe="@firebase/firestore",Le="@firebase/vertexai",Me="@firebase/firestore-compat",Fe="firebase",ze="[DEFAULT]",je={[le]:"fire-core",[he]:"fire-core-compat",[pe]:"fire-analytics",[fe]:"fire-analytics-compat",[me]:"fire-app-check",[ge]:"fire-app-check-compat",[ve]:"fire-auth",[ye]:"fire-auth-compat",[be]:"fire-rtdb",[we]:"fire-data-connect",[Ee]:"fire-rtdb-compat",[Te]:"fire-fn",[xe]:"fire-fn-compat",[Se]:"fire-iid",[Ie]:"fire-iid-compat",[ke]:"fire-fcm",[_e]:"fire-fcm-compat",[Ce]:"fire-perf",[Ae]:"fire-perf-compat",[Ne]:"fire-rc",[Re]:"fire-rc-compat",[Oe]:"fire-gcs",[De]:"fire-gcs-compat",[Pe]:"fire-fst",[Me]:"fire-fst-compat",[Le]:"fire-vertex","fire-js":"fire-js",[Fe]:"fire-js-all"},Ue=new Map,Be=new Map,Ve=new Map;function $e(e,t){try{e.container.addComponent(t)}catch(n){de.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function He(e){const t=e.name;if(Ve.has(t))return de.debug(`There were multiple attempts to register component ${t}.`),!1;Ve.set(t,e);for(const n of Ue.values())$e(n,e);for(const n of Be.values())$e(n,e);return!0}function We(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function Ge(e){return null!==e&&void 0!==e&&void 0!==e.settings}const Ke=new T("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class qe{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new D("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ke.create("app-deleted",{appName:this._name})}}const Ye="11.6.0";function Xe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const r=Object.assign({name:ze,automaticDataCollectionEnabled:!1},t),a=r.name;if("string"!==typeof a||!a)throw Ke.create("bad-app-name",{appName:String(a)});if(n||(n=f()),!n)throw Ke.create("no-options");const i=Ue.get(a);if(i){if(S(n,i.options)&&S(r,i.config))return i;throw Ke.create("duplicate-app",{appName:a})}const s=new M(a);for(const c of Ve.values())s.addComponent(c);const o=new qe(n,r,s);return Ue.set(a,o),o}function Qe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ze;const t=Ue.get(e);if(!t&&e===ze&&f())return Xe();if(!t)throw Ke.create("no-app",{appName:e});return t}function Je(e,t,n){var r;let a=null!==(r=je[e])&&void 0!==r?r:e;n&&(a+=`-${n}`);const i=a.match(/\s|\//),s=t.match(/\s|\//);if(i||s){const e=[`Unable to register library "${a}" with version "${t}":`];return i&&e.push(`library name "${a}" contains illegal characters (whitespace or "/")`),i&&s&&e.push("and"),s&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void de.warn(e.join(" "))}He(new D(`${a}-version`,(()=>({library:a,version:t})),"VERSION"))}const Ze="firebase-heartbeat-store";let et=null;function tt(){return et||(et=re("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(Ze)}catch(n){console.warn(n)}}}).catch((e=>{throw Ke.create("idb-open",{originalErrorMessage:e.message})}))),et}async function nt(e,t){try{const n=(await tt()).transaction(Ze,"readwrite"),r=n.objectStore(Ze);await r.put(t,rt(e)),await n.done}catch(n){if(n instanceof E)de.warn(n.message);else{const e=Ke.create("idb-set",{originalErrorMessage:null===n||void 0===n?void 0:n.message});de.warn(e.message)}}}function rt(e){return`${e.name}!${e.options.appId}`}class at{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new st(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){var e,t;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=it();if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some((e=>e.date===r)))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>30){const e=function(e){if(0===e.length)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){de.warn(n)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=it(),{heartbeatsToSend:n,unsentEntries:r}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const a of e){const e=n.find((e=>e.agent===a.agent));if(e){if(e.dates.push(a.date),ot(n)>t){e.dates.pop();break}}else if(n.push({agent:a.agent,dates:[a.date]}),ot(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),a=c(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(t){return de.warn(t),""}}}function it(){return(new Date).toISOString().substring(0,10)}class st{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!b()&&w().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await tt()).transaction(Ze),n=await t.objectStore(Ze).get(rt(e));return await t.done,n}catch(t){if(t instanceof E)de.warn(t.message);else{const e=Ke.create("idb-get",{originalErrorMessage:null===t||void 0===t?void 0:t.message});de.warn(e.message)}}}(this.app);return(null===e||void 0===e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return nt(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return nt(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function ot(e){return c(JSON.stringify({version:2,heartbeats:e})).length}var ct;ct="",He(new D("platform-logger",(e=>new ce(e)),"PRIVATE")),He(new D("heartbeat",(e=>new at(e)),"PRIVATE")),Je(le,ue,ct),Je(le,ue,"esm2017"),Je("fire-js","");var lt,ut,dt="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},ht={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(e,t,n){n||(n=0);var r=Array(16);if("string"===typeof t)for(var a=0;16>a;++a)r[a]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(a=0;16>a;++a)r[a]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],a=e.g[2];var i=e.g[3],s=t+(i^n&(a^i))+r[0]+3614090360&4294967295;s=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=n+(s<<7&4294967295|s>>>25))+((s=i+(a^t&(n^a))+r[1]+3905402710&4294967295)<<12&4294967295|s>>>20))+((s=a+(n^i&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^a&(i^t))+r[3]+3250441966&4294967295)<<22&4294967295|s>>>10))+((s=t+(i^n&(a^i))+r[4]+4118548399&4294967295)<<7&4294967295|s>>>25))+((s=i+(a^t&(n^a))+r[5]+1200080426&4294967295)<<12&4294967295|s>>>20))+((s=a+(n^i&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^a&(i^t))+r[7]+4249261313&4294967295)<<22&4294967295|s>>>10))+((s=t+(i^n&(a^i))+r[8]+1770035416&4294967295)<<7&4294967295|s>>>25))+((s=i+(a^t&(n^a))+r[9]+2336552879&4294967295)<<12&4294967295|s>>>20))+((s=a+(n^i&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^a&(i^t))+r[11]+2304563134&4294967295)<<22&4294967295|s>>>10))+((s=t+(i^n&(a^i))+r[12]+1804603682&4294967295)<<7&4294967295|s>>>25))+((s=i+(a^t&(n^a))+r[13]+4254626195&4294967295)<<12&4294967295|s>>>20))+((s=a+(n^i&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^a&(i^t))+r[15]+1236535329&4294967295)<<22&4294967295|s>>>10))+((s=t+(a^i&(n^a))+r[1]+4129170786&4294967295)<<5&4294967295|s>>>27))+((s=i+(n^a&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|s>>>23))+((s=a+(t^n&(i^t))+r[11]+643717713&4294967295)<<14&4294967295|s>>>18))+((s=n+(i^t&(a^i))+r[0]+3921069994&4294967295)<<20&4294967295|s>>>12))+((s=t+(a^i&(n^a))+r[5]+3593408605&4294967295)<<5&4294967295|s>>>27))+((s=i+(n^a&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|s>>>23))+((s=a+(t^n&(i^t))+r[15]+3634488961&4294967295)<<14&4294967295|s>>>18))+((s=n+(i^t&(a^i))+r[4]+3889429448&4294967295)<<20&4294967295|s>>>12))+((s=t+(a^i&(n^a))+r[9]+568446438&4294967295)<<5&4294967295|s>>>27))+((s=i+(n^a&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|s>>>23))+((s=a+(t^n&(i^t))+r[3]+4107603335&4294967295)<<14&4294967295|s>>>18))+((s=n+(i^t&(a^i))+r[8]+1163531501&4294967295)<<20&4294967295|s>>>12))+((s=t+(a^i&(n^a))+r[13]+2850285829&4294967295)<<5&4294967295|s>>>27))+((s=i+(n^a&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|s>>>23))+((s=a+(t^n&(i^t))+r[7]+1735328473&4294967295)<<14&4294967295|s>>>18))+((s=n+(i^t&(a^i))+r[12]+2368359562&4294967295)<<20&4294967295|s>>>12))+((s=t+(n^a^i)+r[5]+4294588738&4294967295)<<4&4294967295|s>>>28))+((s=i+(t^n^a)+r[8]+2272392833&4294967295)<<11&4294967295|s>>>21))+((s=a+(i^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|s>>>16))+((s=n+(a^i^t)+r[14]+4259657740&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^a^i)+r[1]+2763975236&4294967295)<<4&4294967295|s>>>28))+((s=i+(t^n^a)+r[4]+1272893353&4294967295)<<11&4294967295|s>>>21))+((s=a+(i^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|s>>>16))+((s=n+(a^i^t)+r[10]+3200236656&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^a^i)+r[13]+681279174&4294967295)<<4&4294967295|s>>>28))+((s=i+(t^n^a)+r[0]+3936430074&4294967295)<<11&4294967295|s>>>21))+((s=a+(i^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|s>>>16))+((s=n+(a^i^t)+r[6]+76029189&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^a^i)+r[9]+3654602809&4294967295)<<4&4294967295|s>>>28))+((s=i+(t^n^a)+r[12]+3873151461&4294967295)<<11&4294967295|s>>>21))+((s=a+(i^t^n)+r[15]+530742520&4294967295)<<16&4294967295|s>>>16))+((s=n+(a^i^t)+r[2]+3299628645&4294967295)<<23&4294967295|s>>>9))+((s=t+(a^(n|~i))+r[0]+4096336452&4294967295)<<6&4294967295|s>>>26))+((s=i+(n^(t|~a))+r[7]+1126891415&4294967295)<<10&4294967295|s>>>22))+((s=a+(t^(i|~n))+r[14]+2878612391&4294967295)<<15&4294967295|s>>>17))+((s=n+(i^(a|~t))+r[5]+4237533241&4294967295)<<21&4294967295|s>>>11))+((s=t+(a^(n|~i))+r[12]+1700485571&4294967295)<<6&4294967295|s>>>26))+((s=i+(n^(t|~a))+r[3]+2399980690&4294967295)<<10&4294967295|s>>>22))+((s=a+(t^(i|~n))+r[10]+4293915773&4294967295)<<15&4294967295|s>>>17))+((s=n+(i^(a|~t))+r[1]+2240044497&4294967295)<<21&4294967295|s>>>11))+((s=t+(a^(n|~i))+r[8]+1873313359&4294967295)<<6&4294967295|s>>>26))+((s=i+(n^(t|~a))+r[15]+4264355552&4294967295)<<10&4294967295|s>>>22))+((s=a+(t^(i|~n))+r[6]+2734768916&4294967295)<<15&4294967295|s>>>17))+((s=n+(i^(a|~t))+r[13]+1309151649&4294967295)<<21&4294967295|s>>>11))+((i=(t=n+((s=t+(a^(n|~i))+r[4]+4149444226&4294967295)<<6&4294967295|s>>>26))+((s=i+(n^(t|~a))+r[11]+3174756917&4294967295)<<10&4294967295|s>>>22))^((a=i+((s=a+(t^(i|~n))+r[2]+718787259&4294967295)<<15&4294967295|s>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(a+(s<<21&4294967295|s>>>11))&4294967295,e.g[2]=e.g[2]+a&4294967295,e.g[3]=e.g[3]+i&4294967295}function r(e,t){this.h=t;for(var n=[],r=!0,a=e.length-1;0<=a;a--){var i=0|e[a];r&&i==t||(n[a]=i,r=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.D=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.C=function(e,n,r){for(var a=Array(arguments.length-2),i=2;i<arguments.length;i++)a[i-2]=arguments[i];return t.prototype[n].apply(e,a)}}(t,(function(){this.blockSize=-1})),t.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var r=t-this.blockSize,a=this.B,i=this.h,s=0;s<t;){if(0==i)for(;s<=r;)n(this,e,s),s+=this.blockSize;if("string"===typeof e){for(;s<t;)if(a[i++]=e.charCodeAt(s++),i==this.blockSize){n(this,a),i=0;break}}else for(;s<t;)if(a[i++]=e[s++],i==this.blockSize){n(this,a),i=0;break}}this.h=i,this.o+=t},t.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.u(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var a={};function i(e){return-128<=e&&128>e?function(e,t){var n=a;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,(function(e){return new r([0|e],0>e?-1:0)})):new r([0|e],0>e?-1:0)}function s(e){if(isNaN(e)||!isFinite(e))return o;if(0>e)return h(s(-e));for(var t=[],n=1,a=0;e>=n;a++)t[a]=e/n|0,n*=4294967296;return new r(t,0)}var o=i(0),c=i(1),l=i(16777216);function u(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function d(e){return-1==e.h}function h(e){for(var t=e.g.length,n=[],a=0;a<t;a++)n[a]=~e.g[a];return new r(n,~e.h).add(c)}function f(e,t){return e.add(h(t))}function p(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function g(e,t){this.g=e,this.h=t}function m(e,t){if(u(t))throw Error("division by zero");if(u(e))return new g(o,o);if(d(e))return t=m(h(e),t),new g(h(t.g),h(t.h));if(d(t))return t=m(e,h(t)),new g(h(t.g),t.h);if(30<e.g.length){if(d(e)||d(t))throw Error("slowDivide_ only works with positive integers.");for(var n=c,r=t;0>=r.l(e);)n=v(n),r=v(r);var a=y(n,1),i=y(r,1);for(r=y(r,2),n=y(n,2);!u(r);){var l=i.add(r);0>=l.l(e)&&(a=a.add(n),i=l),r=y(r,1),n=y(n,1)}return t=f(e,a.j(t)),new g(a,t)}for(a=o;0<=e.l(t);){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),l=(i=s(n)).j(t);d(l)||0<l.l(e);)l=(i=s(n-=r)).j(t);u(i)&&(i=c),a=a.add(i),e=f(e,l)}return new g(a,e)}function v(e){for(var t=e.g.length+1,n=[],a=0;a<t;a++)n[a]=e.i(a)<<1|e.i(a-1)>>>31;return new r(n,e.h)}function y(e,t){var n=t>>5;t%=32;for(var a=e.g.length-n,i=[],s=0;s<a;s++)i[s]=0<t?e.i(s+n)>>>t|e.i(s+n+1)<<32-t:e.i(s+n);return new r(i,e.h)}(e=r.prototype).m=function(){if(d(this))return-h(this).m();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.i(n);e+=(0<=r?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(u(this))return"0";if(d(this))return"-"+h(this).toString(e);for(var t=s(Math.pow(e,6)),n=this,r="";;){var a=m(n,t).g,i=((0<(n=f(n,a.j(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(u(n=a))return i+r;for(;6>i.length;)i="0"+i;r=i+r}},e.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return d(e=f(this,e))?-1:u(e)?0:1},e.abs=function(){return d(this)?h(this):this},e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],a=0,i=0;i<=t;i++){var s=a+(65535&this.i(i))+(65535&e.i(i)),o=(s>>>16)+(this.i(i)>>>16)+(e.i(i)>>>16);a=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new r(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(u(this)||u(e))return o;if(d(this))return d(e)?h(this).j(h(e)):h(h(this).j(e));if(d(e))return h(this.j(h(e)));if(0>this.l(l)&&0>e.l(l))return s(this.m()*e.m());for(var t=this.g.length+e.g.length,n=[],a=0;a<2*t;a++)n[a]=0;for(a=0;a<this.g.length;a++)for(var i=0;i<e.g.length;i++){var c=this.i(a)>>>16,f=65535&this.i(a),g=e.i(i)>>>16,m=65535&e.i(i);n[2*a+2*i]+=f*m,p(n,2*a+2*i),n[2*a+2*i+1]+=c*m,p(n,2*a+2*i+1),n[2*a+2*i+1]+=f*g,p(n,2*a+2*i+1),n[2*a+2*i+2]+=c*g,p(n,2*a+2*i+2)}for(a=0;a<t;a++)n[a]=n[2*a+1]<<16|n[2*a];for(a=t;a<2*t;a++)n[a]=0;return new r(n,0)},e.A=function(e){return m(this,e).h},e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],a=0;a<t;a++)n[a]=this.i(a)&e.i(a);return new r(n,this.h&e.h)},e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],a=0;a<t;a++)n[a]=this.i(a)|e.i(a);return new r(n,this.h|e.h)},e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],a=0;a<t;a++)n[a]=this.i(a)^e.i(a);return new r(n,this.h^e.h)},t.prototype.digest=t.prototype.v,t.prototype.reset=t.prototype.s,t.prototype.update=t.prototype.u,ut=ht.Md5=t,r.prototype.add=r.prototype.add,r.prototype.multiply=r.prototype.j,r.prototype.modulo=r.prototype.A,r.prototype.compare=r.prototype.l,r.prototype.toNumber=r.prototype.m,r.prototype.toString=r.prototype.toString,r.prototype.getBits=r.prototype.i,r.fromNumber=s,r.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return h(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=s(Math.pow(n,8)),a=o,i=0;i<t.length;i+=8){var c=Math.min(8,t.length-i),l=parseInt(t.substring(i,i+c),n);8>c?(c=s(Math.pow(n,c)),a=a.j(c).add(s(l))):a=(a=a.j(r)).add(s(l))}return a},lt=ht.Integer=r}).apply("undefined"!==typeof dt?dt:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var ft,pt,gt,mt,vt,yt,bt,wt,Et="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},Tt={};(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof Et&&Et];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(e,r){if(r)e:{var a=n;e=e.split(".");for(var i=0;i<e.length-1;i++){var s=e[i];if(!(s in a))break e;a=a[s]}(r=r(i=a[e=e[e.length-1]]))!=i&&null!=r&&t(a,e,{configurable:!0,writable:!0,value:r})}}("Array.prototype.values",(function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,a={next:function(){if(!r&&n<e.length){var a=n++;return{value:t(a,e[a]),done:!1}}return r=!0,{done:!0,value:void 0}}};return a[Symbol.iterator]=function(){return a},a}(this,(function(e,t){return t}))}}));var r=r||{},a=this||self;function i(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function s(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function o(e,t,n){return e.call.apply(e.bind,arguments)}function c(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function l(e,t,n){return(l=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?o:c).apply(null,arguments)}function u(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function d(e,t){function n(){}n.prototype=t.prototype,e.aa=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Qb=function(e,n,r){for(var a=Array(arguments.length-2),i=2;i<arguments.length;i++)a[i-2]=arguments[i];return t.prototype[n].apply(e,a)}}function h(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function f(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(i(t)){const n=e.length||0,r=t.length||0;e.length=n+r;for(let a=0;a<r;a++)e[n+a]=t[a]}else e.push(t)}}function p(e){return/^[\s\xa0]*$/.test(e)}function g(){var e=a.navigator;return e&&(e=e.userAgent)?e:""}function m(e){return m[" "](e),e}m[" "]=function(){};var v=-1!=g().indexOf("Gecko")&&!(-1!=g().toLowerCase().indexOf("webkit")&&-1==g().indexOf("Edge"))&&!(-1!=g().indexOf("Trident")||-1!=g().indexOf("MSIE"))&&-1==g().indexOf("Edge");function y(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function b(e){const t={};for(const n in e)t[n]=e[n];return t}const w="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function E(e,t){let n,r;for(let a=1;a<arguments.length;a++){for(n in r=arguments[a],r)e[n]=r[n];for(let t=0;t<w.length;t++)n=w[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function T(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function x(e){a.setTimeout((()=>{throw e}),0)}function S(){var e=A;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var I=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new k),(e=>e.reset()));class k{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let _,C=!1,A=new class{constructor(){this.h=this.g=null}add(e,t){const n=I.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},N=()=>{const e=a.Promise.resolve(void 0);_=()=>{e.then(R)}};var R=()=>{for(var e;e=S();){try{e.h.call(e.g)}catch(n){x(n)}var t=I;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}C=!1};function O(){this.s=this.s,this.C=this.C}function D(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}O.prototype.s=!1,O.prototype.ma=function(){this.s||(this.s=!0,this.N())},O.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},D.prototype.h=function(){this.defaultPrevented=!0};var P=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};a.addEventListener("test",e,t),a.removeEventListener("test",e,t)}catch(n){}return e}();function L(e,t){if(D.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(v){e:{try{m(t.nodeName);var a=!0;break e}catch(i){}a=!1}a||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:M[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&L.aa.h.call(this)}}d(L,D);var M={2:"touch",3:"pen",4:"mouse"};L.prototype.h=function(){L.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var F="closure_listenable_"+(1e6*Math.random()|0),z=0;function j(e,t,n,r,a){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=a,this.key=++z,this.da=this.fa=!1}function U(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function B(e){this.src=e,this.g={},this.h=0}function V(e,t){var n=t.type;if(n in e.g){var r,a=e.g[n],i=Array.prototype.indexOf.call(a,t,void 0);(r=0<=i)&&Array.prototype.splice.call(a,i,1),r&&(U(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function $(e,t,n,r){for(var a=0;a<e.length;++a){var i=e[a];if(!i.da&&i.listener==t&&i.capture==!!n&&i.ha==r)return a}return-1}B.prototype.add=function(e,t,n,r,a){var i=e.toString();(e=this.g[i])||(e=this.g[i]=[],this.h++);var s=$(e,t,r,a);return-1<s?(t=e[s],n||(t.fa=!1)):((t=new j(t,this.src,i,!!r,a)).fa=n,e.push(t)),t};var H="closure_lm_"+(1e6*Math.random()|0),W={};function G(e,t,n,r,a){if(r&&r.once)return q(e,t,n,r,a);if(Array.isArray(t)){for(var i=0;i<t.length;i++)G(e,t[i],n,r,a);return null}return n=te(n),e&&e[F]?e.K(t,n,s(r)?!!r.capture:!!r,a):K(e,t,n,!1,r,a)}function K(e,t,n,r,a,i){if(!t)throw Error("Invalid event type");var o=s(a)?!!a.capture:!!a,c=Z(e);if(c||(e[H]=c=new B(e)),(n=c.add(t,n,r,o,i)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=J;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)P||(a=o),void 0===a&&(a=!1),e.addEventListener(t.toString(),r,a);else if(e.attachEvent)e.attachEvent(Q(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function q(e,t,n,r,a){if(Array.isArray(t)){for(var i=0;i<t.length;i++)q(e,t[i],n,r,a);return null}return n=te(n),e&&e[F]?e.L(t,n,s(r)?!!r.capture:!!r,a):K(e,t,n,!0,r,a)}function Y(e,t,n,r,a){if(Array.isArray(t))for(var i=0;i<t.length;i++)Y(e,t[i],n,r,a);else r=s(r)?!!r.capture:!!r,n=te(n),e&&e[F]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=$(i=e.g[t],n,r,a))&&(U(i[n]),Array.prototype.splice.call(i,n,1),0==i.length&&(delete e.g[t],e.h--)))):e&&(e=Z(e))&&(t=e.g[t.toString()],e=-1,t&&(e=$(t,n,r,a)),(n=-1<e?t[e]:null)&&X(n))}function X(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[F])V(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(Q(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Z(t))?(V(n,e),0==n.h&&(n.src=null,t[H]=null)):U(e)}}}function Q(e){return e in W?W[e]:W[e]="on"+e}function J(e,t){if(e.da)e=!0;else{t=new L(t,this);var n=e.listener,r=e.ha||e.src;e.fa&&X(e),e=n.call(r,t)}return e}function Z(e){return(e=e[H])instanceof B?e:null}var ee="__closure_events_fn_"+(1e9*Math.random()>>>0);function te(e){return"function"===typeof e?e:(e[ee]||(e[ee]=function(t){return e.handleEvent(t)}),e[ee])}function ne(){O.call(this),this.i=new B(this),this.M=this,this.F=null}function re(e,t){var n,r=e.F;if(r)for(n=[];r;r=r.F)n.push(r);if(e=e.M,r=t.type||t,"string"===typeof t)t=new D(t,e);else if(t instanceof D)t.target=t.target||e;else{var a=t;E(t=new D(r,e),a)}if(a=!0,n)for(var i=n.length-1;0<=i;i--){var s=t.g=n[i];a=ae(s,r,!0,t)&&a}if(a=ae(s=t.g=e,r,!0,t)&&a,a=ae(s,r,!1,t)&&a,n)for(i=0;i<n.length;i++)a=ae(s=t.g=n[i],r,!1,t)&&a}function ae(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var a=!0,i=0;i<t.length;++i){var s=t[i];if(s&&!s.da&&s.capture==n){var o=s.listener,c=s.ha||s.src;s.fa&&V(e.i,s),a=!1!==o.call(c,r)&&a}}return a&&!r.defaultPrevented}function ie(e,t,n){if("function"===typeof e)n&&(e=l(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=l(e.handleEvent,e)}return 2147483647<Number(t)?-1:a.setTimeout(e,t||0)}function se(e){e.g=ie((()=>{e.g=null,e.i&&(e.i=!1,se(e))}),e.l);const t=e.h;e.h=null,e.m.apply(null,t)}d(ne,O),ne.prototype[F]=!0,ne.prototype.removeEventListener=function(e,t,n,r){Y(this,e,t,n,r)},ne.prototype.N=function(){if(ne.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)U(n[r]);delete t.g[e],t.h--}}this.F=null},ne.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},ne.prototype.L=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};class oe extends O{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:se(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ce(e){O.call(this),this.h=e,this.g={}}d(ce,O);var le=[];function ue(e){y(e.g,(function(e,t){this.g.hasOwnProperty(t)&&X(e)}),e),e.g={}}ce.prototype.N=function(){ce.aa.N.call(this),ue(this)},ce.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var de=a.JSON.stringify,he=a.JSON.parse,fe=class{stringify(e){return a.JSON.stringify(e,void 0)}parse(e){return a.JSON.parse(e,void 0)}};function pe(){}function ge(e){return e.h||(e.h=e.i())}function me(){}pe.prototype.h=null;var ve={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ye(){D.call(this,"d")}function be(){D.call(this,"c")}d(ye,D),d(be,D);var we={},Ee=null;function Te(){return Ee=Ee||new ne}function xe(e){D.call(this,we.La,e)}function Se(e){const t=Te();re(t,new xe(t))}function Ie(e,t){D.call(this,we.STAT_EVENT,e),this.stat=t}function ke(e){const t=Te();re(t,new Ie(t,e))}function _e(e,t){D.call(this,we.Ma,e),this.size=t}function Ce(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return a.setTimeout((function(){e()}),t)}function Ae(){this.g=!0}function Ne(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var a=r[1];if(Array.isArray(a)&&!(1>a.length)){var i=a[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(var s=1;s<a.length;s++)a[s]=""}}}return de(n)}catch(o){return t}}(e,n)+(r?" "+r:"")}))}we.La="serverreachability",d(xe,D),we.STAT_EVENT="statevent",d(Ie,D),we.Ma="timingevent",d(_e,D),Ae.prototype.xa=function(){this.g=!1},Ae.prototype.info=function(){};var Re,Oe={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},De={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function Pe(){}function Le(e,t,n,r){this.j=e,this.i=t,this.l=n,this.R=r||1,this.U=new ce(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Me}function Me(){this.i=null,this.g="",this.h=!1}d(Pe,pe),Pe.prototype.g=function(){return new XMLHttpRequest},Pe.prototype.i=function(){return{}},Re=new Pe;var Fe={},ze={};function je(e,t,n){e.L=1,e.v=dt(st(t)),e.m=n,e.P=!0,Ue(e,null)}function Ue(e,t){e.F=Date.now(),$e(e),e.A=st(e.v);var n=e.A,r=e.R;Array.isArray(r)||(r=[String(r)]),Mt(n.i,"t",r),e.C=0,n=e.j.J,e.h=new Me,e.g=Sn(e.j,n?t:null,!e.m),0<e.O&&(e.M=new oe(l(e.Y,e,e.g),e.O)),t=e.U,n=e.g,r=e.ca;var a="readystatechange";Array.isArray(a)||(a&&(le[0]=a.toString()),a=le);for(var i=0;i<a.length;i++){var s=G(n,a[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}t=e.H?b(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),Se(),function(e,t,n,r,a,i){e.info((function(){if(e.g)if(i)for(var s="",o=i.split("&"),c=0;c<o.length;c++){var l=o[c].split("=");if(1<l.length){var u=l[0];l=l[1];var d=u.split("_");s=2<=d.length&&"type"==d[1]?s+(u+"=")+l+"&":s+(u+"=redacted&")}}else s=null;else s=i;return"XMLHTTP REQ ("+r+") [attempt "+a+"]: "+t+"\n"+n+"\n"+s}))}(e.i,e.u,e.A,e.l,e.R,e.m)}function Be(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.j.Ca)}function Ve(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?ze:(n=Number(t.substring(n,r)),isNaN(n)?Fe:(r+=1)+n>t.length?ze:(t=t.slice(r,r+n),e.C=r+n,t))}function $e(e){e.S=Date.now()+e.I,He(e,e.I)}function He(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Ce(l(e.ba,e),t)}function We(e){e.B&&(a.clearTimeout(e.B),e.B=null)}function Ge(e){0==e.j.G||e.J||bn(e.j,e)}function Ke(e){We(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,ue(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function qe(e,t){try{var n=e.j;if(0!=n.G&&(n.g==e||Ze(n.h,e)))if(!e.K&&Ze(n.h,e)&&3==n.G){try{var r=n.Da.g.parse(t)}catch(u){r=null}if(Array.isArray(r)&&3==r.length){var a=r;if(0==a[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;yn(n),cn(n)}gn(n),ke(18)}}else n.za=a[1],0<n.za-n.T&&37500>a[2]&&n.F&&0==n.v&&!n.C&&(n.C=Ce(l(n.Za,n),6e3));if(1>=Je(n.h)&&n.ca){try{n.ca()}catch(u){}n.ca=void 0}}else En(n,11)}else if((e.K||n.g==e)&&yn(n),!p(t))for(a=n.Da.g.parse(t),t=0;t<a.length;t++){let l=a[t];if(n.T=l[0],l=l[1],2==n.G)if("c"==l[0]){n.K=l[1],n.ia=l[2];const t=l[3];null!=t&&(n.la=t,n.j.info("VER="+n.la));const a=l[4];null!=a&&(n.Aa=a,n.j.info("SVER="+n.Aa));const u=l[5];null!=u&&"number"===typeof u&&0<u&&(r=1.5*u,n.L=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const d=e.g;if(d){const e=d.g?d.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var i=r.h;i.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(i.j=i.l,i.g=new Set,i.h&&(et(i,i.h),i.h=null))}if(r.D){const e=d.g?d.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.ya=e,ut(r.I,r.D,e))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-e.F,n.j.info("Handshake RTT: "+n.R+"ms"));var s=e;if((r=n).qa=xn(r,r.J?r.ia:null,r.W),s.K){tt(r.h,s);var o=s,c=r.L;c&&(o.I=c),o.B&&(We(o),$e(o)),r.g=s}else pn(r);0<n.i.length&&un(n)}else"stop"!=l[0]&&"close"!=l[0]||En(n,7);else 3==n.G&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?En(n,7):on(n):"noop"!=l[0]&&n.l&&n.l.ta(l),n.v=0)}Se()}catch(u){}}Le.prototype.ca=function(e){e=e.target;const t=this.M;t&&3==nn(e)?t.j():this.Y(e)},Le.prototype.Y=function(e){try{if(e==this.g)e:{const h=nn(this.g);var t=this.g.Ba();this.g.Z();if(!(3>h)&&(3!=h||this.g&&(this.h.h||this.g.oa()||rn(this.g)))){this.J||4!=h||7==t||Se(),We(this);var n=this.g.Z();this.X=n;t:if(Be(this)){var r=rn(this.g);e="";var i=r.length,s=4==nn(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){Ke(this),Ge(this);var o="";break t}this.h.i=new a.TextDecoder}for(t=0;t<i;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:!(s&&t==i-1)});r.length=0,this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.oa();if(this.o=200==n,function(e,t,n,r,a,i,s){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+a+"]: "+t+"\n"+n+"\n"+i+" "+s}))}(this.i,this.u,this.A,this.l,this.R,h,n),this.o){if(this.T&&!this.K){t:{if(this.g){var c,l=this.g;if((c=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!p(c)){var u=c;break t}}u=null}if(!(n=u)){this.o=!1,this.s=3,ke(12),Ke(this),Ge(this);break e}Ne(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,qe(this,n)}if(this.P){let e;for(n=!0;!this.J&&this.C<o.length;){if(e=Ve(this,o),e==ze){4==h&&(this.s=4,ke(14),n=!1),Ne(this.i,this.l,null,"[Incomplete Response]");break}if(e==Fe){this.s=4,ke(15),Ne(this.i,this.l,o,"[Invalid Chunk]"),n=!1;break}Ne(this.i,this.l,e,null),qe(this,e)}if(Be(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=h||0!=o.length||this.h.h||(this.s=1,ke(16),n=!1),this.o=this.o&&n,n){if(0<o.length&&!this.W){this.W=!0;var d=this.j;d.g==this&&d.ba&&!d.M&&(d.j.info("Great, no buffering proxy detected. Bytes received: "+o.length),mn(d),d.M=!0,ke(11))}}else Ne(this.i,this.l,o,"[Invalid Chunked Response]"),Ke(this),Ge(this)}else Ne(this.i,this.l,o,null),qe(this,o);4==h&&Ke(this),this.o&&!this.J&&(4==h?bn(this.j,this):(this.o=!1,$e(this)))}else(function(e){const t={};e=(e.g&&2<=nn(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(p(e[r]))continue;var n=T(e[r]);const a=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const i=t[a]||[];t[a]=i,i.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.s=3,ke(12)):(this.s=0,ke(13)),Ke(this),Ge(this)}}}catch(h){}},Le.prototype.cancel=function(){this.J=!0,Ke(this)},Le.prototype.ba=function(){this.B=null;const e=Date.now();0<=e-this.S?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.i,this.A),2!=this.L&&(Se(),ke(17)),Ke(this),this.s=2,Ge(this)):He(this,this.S-e)};var Ye=class{constructor(e,t){this.g=e,this.map=t}};function Xe(e){this.l=e||10,a.PerformanceNavigationTiming?e=0<(e=a.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Qe(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Je(e){return e.h?1:e.g?e.g.size:0}function Ze(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function et(e,t){e.g?e.g.add(t):e.h=t}function tt(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function nt(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return h(e.i)}function rt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(i(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(i(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}(e),r=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(i(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),a=r.length,s=0;s<a;s++)t.call(void 0,r[s],n&&n[s],e)}Xe.prototype.cancel=function(){if(this.i=nt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var at=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function it(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof it){this.h=e.h,ot(this,e.j),this.o=e.o,this.g=e.g,ct(this,e.s),this.l=e.l;var t=e.i,n=new Ot;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),lt(this,n),this.m=e.m}else e&&(t=String(e).match(at))?(this.h=!1,ot(this,t[1]||"",!0),this.o=ht(t[2]||""),this.g=ht(t[3]||"",!0),ct(this,t[4]),this.l=ht(t[5]||"",!0),lt(this,t[6]||"",!0),this.m=ht(t[7]||"")):(this.h=!1,this.i=new Ot(null,this.h))}function st(e){return new it(e)}function ot(e,t,n){e.j=n?ht(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function ct(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function lt(e,t,n){t instanceof Ot?(e.i=t,function(e,t){t&&!e.j&&(Dt(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(Pt(this,t),Mt(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=xt(t,Nt)),e.i=new Ot(t,e.h))}function ut(e,t,n){e.i.set(t,n)}function dt(e){return ut(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function ht(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function xt(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,It),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function It(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}it.prototype.toString=function(){var e=[],t=this.j;t&&e.push(xt(t,_t,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(xt(t,_t,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(xt(n,"/"==n.charAt(0)?At:Ct,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",xt(n,Rt)),e.join("")};var kt,_t=/[#\/\?@]/g,Ct=/[#\?:]/g,At=/[#\?]/g,Nt=/[#\?@]/g,Rt=/#/g;function Ot(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Dt(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),a=null;if(0<=r){var i=e[n].substring(0,r);a=e[n].substring(r+1)}else i=e[n];t(i,a?decodeURIComponent(a.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function Pt(e,t){Dt(e),t=Ft(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Lt(e,t){return Dt(e),t=Ft(e,t),e.g.has(t)}function Mt(e,t,n){Pt(e,t),0<n.length&&(e.i=null,e.g.set(Ft(e,t),h(n)),e.h+=n.length)}function Ft(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function zt(e,t,n,r,a){try{a&&(a.onload=null,a.onerror=null,a.onabort=null,a.ontimeout=null),r(n)}catch(i){}}function jt(){this.g=new fe}function Ut(e,t,n){const r=n||"";try{rt(e,(function(e,n){let a=e;s(e)&&(a=de(e)),t.push(r+n+"="+encodeURIComponent(a))}))}catch(a){throw t.push(r+"type="+encodeURIComponent("_badmap")),a}}function Bt(e){this.l=e.Ub||null,this.j=e.eb||!1}function Vt(e,t){ne.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function $t(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function Ht(e){e.readyState=4,e.l=null,e.j=null,e.v=null,Wt(e)}function Wt(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Gt(e){let t="";return y(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function Kt(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Gt(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):ut(e,t,n))}function qt(e){ne.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(e=Ot.prototype).add=function(e,t){Dt(this),this.i=null,e=Ft(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){Dt(this),this.g.forEach((function(n,r){n.forEach((function(n){e.call(t,n,r,this)}),this)}),this)},e.na=function(){Dt(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const a=e[r];for(let e=0;e<a.length;e++)n.push(t[r])}return n},e.V=function(e){Dt(this);let t=[];if("string"===typeof e)Lt(this,e)&&(t=t.concat(this.g.get(Ft(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},e.set=function(e,t){return Dt(this),this.i=null,Lt(this,e=Ft(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const i=encodeURIComponent(String(r)),s=this.V(r);for(r=0;r<s.length;r++){var a=i;""!==s[r]&&(a+="="+encodeURIComponent(String(s[r]))),e.push(a)}}return this.i=e.join("&")},d(Bt,pe),Bt.prototype.g=function(){return new Vt(this.l,this.j)},Bt.prototype.i=(kt={},function(){return kt}),d(Vt,ne),(e=Vt.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,Wt(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||a).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Ht(this)),this.readyState=0},e.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Wt(this)),this.g&&(this.readyState=3,Wt(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if("undefined"!==typeof a.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;$t(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},e.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Ht(this):Wt(this),3==this.readyState&&$t(this)}},e.Ra=function(e){this.g&&(this.response=this.responseText=e,Ht(this))},e.Qa=function(e){this.g&&(this.response=e,Ht(this))},e.ga=function(){this.g&&Ht(this)},e.setRequestHeader=function(e,t){this.u.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Vt.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),d(qt,ne);var Yt=/^https?$/i,Xt=["POST","PUT"];function Qt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,Jt(e),en(e)}function Jt(e){e.A||(e.A=!0,re(e,"complete"),re(e,"error"))}function Zt(e){if(e.h&&"undefined"!=typeof r&&(!e.v[1]||4!=nn(e)||2!=e.Z()))if(e.u&&4==nn(e))ie(e.Ea,0,e);else if(re(e,"readystatechange"),4==nn(e)){e.h=!1;try{const r=e.Z();e:switch(r){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var i;if(i=0===r){var s=String(e.D).match(at)[1]||null;!s&&a.self&&a.self.location&&(s=a.self.location.protocol.slice(0,-1)),i=!Yt.test(s?s.toLowerCase():"")}n=i}if(n)re(e,"complete"),re(e,"success");else{e.m=6;try{var o=2<nn(e)?e.g.statusText:""}catch(c){o=""}e.l=o+" ["+e.Z()+"]",Jt(e)}}finally{en(e)}}}function en(e,t){if(e.g){tn(e);const r=e.g,a=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||re(e,"ready");try{r.onreadystatechange=a}catch(n){}}}function tn(e){e.I&&(a.clearTimeout(e.I),e.I=null)}function nn(e){return e.g?e.g.readyState:0}function rn(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(St){return null}}function an(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function sn(e){this.Aa=0,this.i=[],this.j=new Ae,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=an("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=an("baseRetryDelayMs",5e3,e),this.cb=an("retryDelaySeedMs",1e4,e),this.Wa=an("forwardChannelMaxRetries",2,e),this.wa=an("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new Xe(e&&e.concurrentRequestLimit),this.Da=new jt,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function on(e){if(ln(e),3==e.G){var t=e.U++,n=st(e.I);if(ut(n,"SID",e.K),ut(n,"RID",t),ut(n,"TYPE","terminate"),hn(e,n),(t=new Le(e,e.j,t)).L=2,t.v=dt(st(n)),n=!1,a.navigator&&a.navigator.sendBeacon)try{n=a.navigator.sendBeacon(t.v.toString(),"")}catch(r){}!n&&a.Image&&((new Image).src=t.v,n=!0),n||(t.g=Sn(t.j,null),t.g.ea(t.v)),t.F=Date.now(),$e(t)}Tn(e)}function cn(e){e.g&&(mn(e),e.g.cancel(),e.g=null)}function ln(e){cn(e),e.u&&(a.clearTimeout(e.u),e.u=null),yn(e),e.h.cancel(),e.s&&("number"===typeof e.s&&a.clearTimeout(e.s),e.s=null)}function un(e){if(!Qe(e.h)&&!e.s){e.s=!0;var t=e.Ga;_||N(),C||(_(),C=!0),A.add(t,e),e.B=0}}function dn(e,t){var n;n=t?t.l:e.U++;const r=st(e.I);ut(r,"SID",e.K),ut(r,"RID",n),ut(r,"AID",e.T),hn(e,r),e.m&&e.o&&Kt(r,e.m,e.o),n=new Le(e,e.j,n,e.B+1),null===e.m&&(n.H=e.o),t&&(e.i=t.D.concat(e.i)),t=fn(e,n,1e3),n.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),et(e.h,n),je(n,r,t)}function hn(e,t){e.H&&y(e.H,(function(e,n){ut(t,n,e)})),e.l&&rt({},(function(e,n){ut(t,n,e)}))}function fn(e,t,n){n=Math.min(e.i.length,n);var r=e.l?l(e.l.Na,e.l,e):null;e:{var a=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=a[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let s=!0;for(let o=0;o<n;o++){let n=a[o].g;const c=a[o].map;if(n-=t,0>n)t=Math.max(0,a[o].g-100),s=!1;else try{Ut(c,e,"req"+n+"_")}catch(i){r&&r(c)}}if(s){r=e.join("&");break e}}}return e=e.i.splice(0,n),t.D=e,r}function pn(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;_||N(),C||(_(),C=!0),A.add(t,e),e.v=0}}function gn(e){return!(e.g||e.u||3<=e.v)&&(e.Y++,e.u=Ce(l(e.Fa,e),wn(e,e.v)),e.v++,!0)}function mn(e){null!=e.A&&(a.clearTimeout(e.A),e.A=null)}function vn(e){e.g=new Le(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=st(e.qa);ut(t,"RID","rpc"),ut(t,"SID",e.K),ut(t,"AID",e.T),ut(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&ut(t,"TO",e.ja),ut(t,"TYPE","xmlhttp"),hn(e,t),e.m&&e.o&&Kt(t,e.m,e.o),e.L&&(e.g.I=e.L);var n=e.g;e=e.ia,n.L=1,n.v=dt(st(t)),n.m=null,n.P=!0,Ue(n,e)}function yn(e){null!=e.C&&(a.clearTimeout(e.C),e.C=null)}function bn(e,t){var n=null;if(e.g==t){yn(e),mn(e),e.g=null;var r=2}else{if(!Ze(e.h,t))return;n=t.D,tt(e.h,t),r=1}if(0!=e.G)if(t.o)if(1==r){n=t.m?t.m.length:0,t=Date.now()-t.F;var a=e.B;re(r=Te(),new _e(r,n)),un(e)}else pn(e);else if(3==(a=t.s)||0==a&&0<t.X||!(1==r&&function(e,t){return!(Je(e.h)>=e.h.j-(e.s?1:0))&&(e.s?(e.i=t.D.concat(e.i),!0):!(1==e.G||2==e.G||e.B>=(e.Va?0:e.Wa))&&(e.s=Ce(l(e.Ga,e,t),wn(e,e.B)),e.B++,!0))}(e,t)||2==r&&gn(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),a){case 1:En(e,5);break;case 4:En(e,10);break;case 3:En(e,6);break;default:En(e,2)}}function wn(e,t){let n=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(n*=2),n*t}function En(e,t){if(e.j.info("Error code "+t),2==t){var n=l(e.fb,e),r=e.Xa;const t=!r;r=new it(r||"//www.google.com/images/cleardot.gif"),a.location&&"http"==a.location.protocol||ot(r,"https"),dt(r),t?function(e,t){const n=new Ae;if(a.Image){const r=new Image;r.onload=u(zt,n,"TestLoadImage: loaded",!0,t,r),r.onerror=u(zt,n,"TestLoadImage: error",!1,t,r),r.onabort=u(zt,n,"TestLoadImage: abort",!1,t,r),r.ontimeout=u(zt,n,"TestLoadImage: timeout",!1,t,r),a.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(r.toString(),n):function(e,t){new Ae;const n=new AbortController,r=setTimeout((()=>{n.abort(),zt(0,0,!1,t)}),1e4);fetch(e,{signal:n.signal}).then((e=>{clearTimeout(r),e.ok?zt(0,0,!0,t):zt(0,0,!1,t)})).catch((()=>{clearTimeout(r),zt(0,0,!1,t)}))}(r.toString(),n)}else ke(2);e.G=0,e.l&&e.l.sa(t),Tn(e),ln(e)}function Tn(e){if(e.G=0,e.ka=[],e.l){const t=nt(e.h);0==t.length&&0==e.i.length||(f(e.ka,t),f(e.ka,e.i),e.h.i.length=0,h(e.i),e.i.length=0),e.l.ra()}}function xn(e,t,n){var r=n instanceof it?st(n):new it(n);if(""!=r.g)t&&(r.g=t+"."+r.g),ct(r,r.s);else{var i=a.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var s=new it(null);r&&ot(s,r),t&&(s.g=t),i&&ct(s,i),n&&(s.l=n),r=s}return n=e.D,t=e.ya,n&&t&&ut(r,n,t),ut(r,"VER",e.la),hn(e,r),r}function Sn(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new qt(new Bt({eb:n})):new qt(e.pa)).Ha(e.J),t}function In(){}function kn(){}function _n(e,t){ne.call(this),this.g=new sn(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!p(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!p(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new Nn(this)}function Cn(e){ye.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function An(){be.call(this),this.status=1}function Nn(e){this.g=e}(e=qt.prototype).Ha=function(e){this.J=e},e.ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Re.g(),this.v=this.o?ge(this.o):ge(Re),this.g.onreadystatechange=l(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(s){return void Qt(this,s)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find((e=>"content-type"==e.toLowerCase())),i=a.FormData&&e instanceof a.FormData,!(0<=Array.prototype.indexOf.call(Xt,t,void 0))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[a,o]of n)this.g.setRequestHeader(a,o);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{tn(this),this.u=!0,this.g.send(e),this.u=!1}catch(s){Qt(this,s)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,re(this,"complete"),re(this,"abort"),en(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),en(this,!0)),qt.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?Zt(this):this.bb())},e.bb=function(){Zt(this)},e.isActive=function(){return!!this.g},e.Z=function(){try{return 2<nn(this)?this.g.status:-1}catch(kt){return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch(kt){return""}},e.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),he(t)}},e.Ba=function(){return this.m},e.Ka=function(){return"string"===typeof this.l?this.l:String(this.l)},(e=sn.prototype).la=8,e.G=1,e.connect=function(e,t,n,r){ke(0),this.W=e,this.H=t||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.I=xn(this,null,this.W),un(this)},e.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const a=new Le(this,this.j,e);let i=this.o;if(this.S&&(i?(i=b(i),E(i,this.S)):i=this.S),null!==this.m||this.O||(a.H=i,i=null),this.P)e:{for(var t=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=fn(this,a,t),ut(n=st(this.I),"RID",e),ut(n,"CVER",22),this.D&&ut(n,"X-HTTP-Session-Id",this.D),hn(this,n),i&&(this.O?t="headers="+encodeURIComponent(String(Gt(i)))+"&"+t:this.m&&Kt(n,this.m,i)),et(this.h,a),this.Ua&&ut(n,"TYPE","init"),this.P?(ut(n,"$req",t),ut(n,"SID","null"),a.T=!0,je(a,n,null)):je(a,n,t),this.G=2}}else 3==this.G&&(e?dn(this,e):0==this.i.length||Qe(this.h)||dn(this))},e.Fa=function(){if(this.u=null,vn(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=Ce(l(this.ab,this),e)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ke(10),cn(this),vn(this))},e.Za=function(){null!=this.C&&(this.C=null,cn(this),gn(this),ke(19))},e.fb=function(e){e?(this.j.info("Successfully pinged google.com"),ke(2)):(this.j.info("Failed to ping google.com"),ke(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=In.prototype).ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){},kn.prototype.g=function(e,t){return new _n(e,t)},d(_n,ne),_n.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},_n.prototype.close=function(){on(this.g)},_n.prototype.o=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.u&&((n={}).__data__=de(e),e=n);t.i.push(new Ye(t.Ya++,e)),3==t.G&&un(t)},_n.prototype.N=function(){this.g.l=null,delete this.j,on(this.g),delete this.g,_n.aa.N.call(this)},d(Cn,ye),d(An,be),d(Nn,In),Nn.prototype.ua=function(){re(this.g,"a")},Nn.prototype.ta=function(e){re(this.g,new Cn(e))},Nn.prototype.sa=function(e){re(this.g,new An)},Nn.prototype.ra=function(){re(this.g,"b")},kn.prototype.createWebChannel=kn.prototype.g,_n.prototype.send=_n.prototype.o,_n.prototype.open=_n.prototype.m,_n.prototype.close=_n.prototype.close,wt=Tt.createWebChannelTransport=function(){return new kn},bt=Tt.getStatEventTarget=function(){return Te()},yt=Tt.Event=we,vt=Tt.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Oe.NO_ERROR=0,Oe.TIMEOUT=8,Oe.HTTP_ERROR=6,mt=Tt.ErrorCode=Oe,De.COMPLETE="complete",gt=Tt.EventType=De,me.EventType=ve,ve.OPEN="a",ve.CLOSE="b",ve.ERROR="c",ve.MESSAGE="d",ne.prototype.listen=ne.prototype.K,pt=Tt.WebChannel=me,Tt.FetchXmlHttpFactory=Bt,qt.prototype.listenOnce=qt.prototype.L,qt.prototype.getLastError=qt.prototype.Ka,qt.prototype.getLastErrorCode=qt.prototype.Ba,qt.prototype.getStatus=qt.prototype.Z,qt.prototype.getResponseJson=qt.prototype.Oa,qt.prototype.getResponseText=qt.prototype.oa,qt.prototype.send=qt.prototype.ea,qt.prototype.setWithCredentials=qt.prototype.Ha,ft=Tt.XhrIo=qt}).apply("undefined"!==typeof Et?Et:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const xt="@firebase/firestore",St="4.7.10";class It{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}It.UNAUTHENTICATED=new It(null),It.GOOGLE_CREDENTIALS=new It("google-credentials-uid"),It.FIRST_PARTY=new It("first-party-uid"),It.MOCK_USER=new It("mock-user");let kt="11.5.0";const _t=new H("@firebase/firestore");function Ct(){return _t.logLevel}function At(e){if(_t.logLevel<=z.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const a=n.map(Ot);_t.debug(`Firestore (${kt}): ${e}`,...a)}}function Nt(e){if(_t.logLevel<=z.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const a=n.map(Ot);_t.error(`Firestore (${kt}): ${e}`,...a)}}function Rt(e){if(_t.logLevel<=z.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const a=n.map(Ot);_t.warn(`Firestore (${kt}): ${e}`,...a)}}function Ot(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function Dt(){const e=`FIRESTORE (${kt}) INTERNAL ASSERTION FAILED: `+(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state");throw Nt(e),new Error(e)}function Pt(e,t){e||Dt()}function Lt(e,t){return e}const Mt={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ft extends E{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class zt{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class jt{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Ut{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(It.UNAUTHENTICATED)))}shutdown(){}}class Bt{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class Vt{constructor(e){this.t=e,this.currentUser=It.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Pt(void 0===this.o);let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let a=new zt;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new zt,e.enqueueRetryable((()=>r(this.currentUser)))};const i=()=>{const t=a;e.enqueueRetryable((async()=>{await t.promise,await r(this.currentUser)}))},s=e=>{At("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),i())};this.t.onInit((e=>s(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?s(e):(At("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new zt)}}),0),i()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(At("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(Pt("string"==typeof t.accessToken),new jt(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Pt(null===e||"string"==typeof e),new It(e)}}class $t{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=It.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}}class Ht{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new $t(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable((()=>t(It.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Wt{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Gt{constructor(e,t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null,this.V=null,Ge(e)&&e.settings.appCheckToken&&(this.V=e.settings.appCheckToken)}start(e,t){Pt(void 0===this.o);const n=e=>{null!=e.error&&At("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.R;return this.R=e.token,At("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const r=e=>{At("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit((e=>r(e))),setTimeout((()=>{if(!this.appCheck){const e=this.A.getImmediate({optional:!0});e?r(e):At("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.V)return Promise.resolve(new Wt(this.V));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(Pt("string"==typeof e.token),this.R=e.token,new Wt(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Kt(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}function qt(){return new TextEncoder}class Yt{static newId(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const n=Kt(40);for(let r=0;r<n.length;++r)t.length<20&&n[r]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62))}return t}}function Xt(e,t){return e<t?-1:e>t?1:0}function Qt(e,t){let n=0;for(;n<e.length&&n<t.length;){const r=e.codePointAt(n),a=t.codePointAt(n);if(r!==a){if(r<128&&a<128)return Xt(r,a);{const i=qt(),s=Zt(i.encode(Jt(e,n)),i.encode(Jt(t,n)));return 0!==s?s:Xt(r,a)}}n+=r>65535?2:1}return Xt(e.length,t.length)}function Jt(e,t){return e.codePointAt(t)>65535?e.substring(t,t+2):e.substring(t,t+1)}function Zt(e,t){for(let n=0;n<e.length&&n<t.length;++n)if(e[n]!==t[n])return Xt(e[n],t[n]);return Xt(e.length,t.length)}function en(e,t,n){return e.length===t.length&&e.every(((e,r)=>n(e,t[r])))}function tn(e){return e+"\0"}const nn=-62135596800,rn=1e6;class an{static now(){return an.fromMillis(Date.now())}static fromDate(e){return an.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*rn);return new an(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ft(Mt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ft(Mt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<nn)throw new Ft(Mt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ft(Mt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/rn}_compareTo(e){return this.seconds===e.seconds?Xt(this.nanoseconds,e.nanoseconds):Xt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-nn;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class sn{static fromTimestamp(e){return new sn(e)}static min(){return new sn(new an(0,0))}static max(){return new sn(new an(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const on="__name__";class cn{constructor(e,t,n){void 0===t?t=0:t>e.length&&Dt(),void 0===n?n=e.length-t:n>e.length-t&&Dt(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===cn.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof cn?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=cn.compareSegments(e.get(r),t.get(r));if(0!==n)return n}return Xt(e.length,t.length)}static compareSegments(e,t){const n=cn.isNumericId(e),r=cn.isNumericId(t);return n&&!r?-1:!n&&r?1:n&&r?cn.extractNumericId(e).compare(cn.extractNumericId(t)):Qt(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return lt.fromString(e.substring(4,e.length-2))}}class ln extends cn{construct(e,t,n){return new ln(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const a of n){if(a.indexOf("//")>=0)throw new Ft(Mt.INVALID_ARGUMENT,`Invalid segment (${a}). Paths must not contain // in them.`);e.push(...a.split("/").filter((e=>e.length>0)))}return new ln(e)}static emptyPath(){return new ln([])}}const un=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class dn extends cn{construct(e,t,n){return new dn(e,t,n)}static isValidIdentifier(e){return un.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),dn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===on}static keyField(){return new dn([on])}static fromServerFormat(e){const t=[];let n="",r=0;const a=()=>{if(0===n.length)throw new Ft(Mt.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let i=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new Ft(Mt.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new Ft(Mt.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(i=!i,r++):"."!==t||i?(n+=t,r++):(a(),r++)}if(a(),i)throw new Ft(Mt.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new dn(t)}static emptyPath(){return new dn([])}}class hn{constructor(e){this.path=e}static fromPath(e){return new hn(ln.fromString(e))}static fromName(e){return new hn(ln.fromString(e).popFirst(5))}static empty(){return new hn(ln.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===ln.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return ln.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new hn(new ln(e.slice()))}}const fn=-1;class pn{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}function gn(e){return e.fields.find((e=>2===e.kind))}function mn(e){return e.fields.filter((e=>2!==e.kind))}pn.UNKNOWN_ID=-1;class vn{constructor(e,t){this.fieldPath=e,this.kind=t}}class yn{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new yn(0,En.min())}}function bn(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,a=sn.fromTimestamp(1e9===r?new an(n+1,0):new an(n,r));return new En(a,hn.empty(),t)}function wn(e){return new En(e.readTime,e.key,fn)}class En{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new En(sn.min(),hn.empty(),fn)}static max(){return new En(sn.max(),hn.empty(),fn)}}function Tn(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=hn.comparator(e.documentKey,t.documentKey),0!==n?n:Xt(e.largestBatchId,t.largestBatchId))}const xn="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Sn{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function In(e){if(e.code!==Mt.FAILED_PRECONDITION||e.message!==xn)throw e;At("LocalStore","Unexpectedly lost primary lease")}class kn{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Dt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new kn(((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof kn?t:kn.resolve(t)}catch(e){return kn.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):kn.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):kn.reject(t)}static resolve(e){return new kn(((t,n)=>{t(e)}))}static reject(e){return new kn(((t,n)=>{n(e)}))}static waitFor(e){return new kn(((t,n)=>{let r=0,a=0,i=!1;e.forEach((e=>{++r,e.next((()=>{++a,i&&a===r&&t()}),(e=>n(e)))})),i=!0,a===r&&t()}))}static or(e){let t=kn.resolve(!1);for(const n of e)t=t.next((e=>e?kn.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,r)=>{n.push(t.call(this,e,r))})),this.waitFor(n)}static mapArray(e,t){return new kn(((n,r)=>{const a=e.length,i=new Array(a);let s=0;for(let o=0;o<a;o++){const c=o;t(e[c]).next((e=>{i[c]=e,++s,s===a&&n(i)}),(e=>r(e)))}}))}static doWhile(e,t){return new kn(((n,r)=>{const a=()=>{!0===e()?t().next((()=>{a()}),r):n()};a()}))}}const _n="SimpleDb";class Cn{static open(e,t,n,r){try{return new Cn(t,e.transaction(r,n))}catch(e){throw new On(t,e)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.m=new zt,this.transaction.oncomplete=()=>{this.m.resolve()},this.transaction.onabort=()=>{t.error?this.m.reject(new On(e,t.error)):this.m.resolve()},this.transaction.onerror=t=>{const n=Fn(t.target.error);this.m.reject(new On(e,n))}}get p(){return this.m.promise}abort(e){e&&this.m.reject(e),this.aborted||(At(_n,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}S(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new Pn(t)}}class An{static delete(e){return At(_n,"Removing database:",e),Ln(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!b())return!1;if(An.v())return!0;const e=m(),t=An.C(e),n=0<t&&t<10,r=Nn(e),a=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||a)}static v(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.__PRIVATE_env)||void 0===e?void 0:e.F)}static M(e,t){return e.store(t)}static C(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}constructor(e,t,n){this.name=e,this.version=t,this.O=n,12.2===An.C(m())&&Nt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async N(e){return this.db||(At(_n,"Opening database:",this.name),this.db=await new Promise(((t,n)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=e=>{const n=e.target.result;t(n)},r.onblocked=()=>{n(new On(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=t=>{const r=t.target.error;"VersionError"===r.name?n(new Ft(Mt.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===r.name?n(new Ft(Mt.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+r)):n(new On(e,r))},r.onupgradeneeded=e=>{At(_n,'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);const t=e.target.result;this.O.B(t,r.transaction,e.oldVersion,this.version).next((()=>{At(_n,"Database upgrade to version "+this.version+" complete")}))}}))),this.L&&(this.db.onversionchange=e=>this.L(e)),this.db}k(e){this.L=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,r){const a="readonly"===t;let i=0;for(;;){++i;try{this.db=await this.N(e);const t=Cn.open(this.db,e,a?"readonly":"readwrite",n),i=r(t).next((e=>(t.S(),e))).catch((e=>(t.abort(e),kn.reject(e)))).toPromise();return i.catch((()=>{})),await t.p,i}catch(e){const t=e,n="FirebaseError"!==t.name&&i<3;if(At(_n,"Transaction failed with error:",t.message,"Retrying:",n),this.close(),!n)return Promise.reject(t)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Nn(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class Rn{constructor(e){this.q=e,this.$=!1,this.U=null}get isDone(){return this.$}get K(){return this.U}set cursor(e){this.q=e}done(){this.$=!0}W(e){this.U=e}delete(){return Ln(this.q.delete())}}class On extends Ft{constructor(e,t){super(Mt.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Dn(e){return"IndexedDbTransactionError"===e.name}class Pn{constructor(e){this.store=e}put(e,t){let n;return void 0!==t?(At(_n,"PUT",this.store.name,e,t),n=this.store.put(t,e)):(At(_n,"PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Ln(n)}add(e){return At(_n,"ADD",this.store.name,e,e),Ln(this.store.add(e))}get(e){return Ln(this.store.get(e)).next((t=>(void 0===t&&(t=null),At(_n,"GET",this.store.name,e,t),t)))}delete(e){return At(_n,"DELETE",this.store.name,e),Ln(this.store.delete(e))}count(){return At(_n,"COUNT",this.store.name),Ln(this.store.count())}G(e,t){const n=this.options(e,t),r=n.index?this.store.index(n.index):this.store;if("function"==typeof r.getAll){const e=r.getAll(n.range);return new kn(((t,n)=>{e.onerror=e=>{n(e.target.error)},e.onsuccess=e=>{t(e.target.result)}}))}{const e=this.cursor(n),t=[];return this.j(e,((e,n)=>{t.push(n)})).next((()=>t))}}H(e,t){const n=this.store.getAll(e,null===t?void 0:t);return new kn(((e,t)=>{n.onerror=e=>{t(e.target.error)},n.onsuccess=t=>{e(t.target.result)}}))}J(e,t){At(_n,"DELETE ALL",this.store.name);const n=this.options(e,t);n.Y=!1;const r=this.cursor(n);return this.j(r,((e,t,n)=>n.delete()))}Z(e,t){let n;t?n=e:(n={},t=e);const r=this.cursor(n);return this.j(r,t)}X(e){const t=this.cursor({});return new kn(((n,r)=>{t.onerror=e=>{const t=Fn(e.target.error);r(t)},t.onsuccess=t=>{const r=t.target.result;r?e(r.primaryKey,r.value).next((e=>{e?r.continue():n()})):n()}}))}j(e,t){const n=[];return new kn(((r,a)=>{e.onerror=e=>{a(e.target.error)},e.onsuccess=e=>{const a=e.target.result;if(!a)return void r();const i=new Rn(a),s=t(a.primaryKey,a.value,i);if(s instanceof kn){const e=s.catch((e=>(i.done(),kn.reject(e))));n.push(e)}i.isDone?r():null===i.K?a.continue():a.continue(i.K)}})).next((()=>kn.waitFor(n)))}options(e,t){let n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.Y?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Ln(e){return new kn(((t,n)=>{e.onsuccess=e=>{const n=e.target.result;t(n)},e.onerror=e=>{const t=Fn(e.target.error);n(t)}}))}let Mn=!1;function Fn(e){const t=An.C(m());if(t>=12.2&&t<13){const t="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(t)>=0){const e=new Ft("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Mn||(Mn=!0,setTimeout((()=>{throw e}),0)),e}}return e}const zn="IndexBackfiller";class jn{constructor(e,t){this.asyncQueue=e,this.ee=t,this.task=null}start(){this.te(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}te(e){At(zn,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const e=await this.ee.ne();At(zn,`Documents written: ${e}`)}catch(e){Dn(e)?At(zn,"Ignoring IndexedDB error during index backfill: ",e):await In(e)}await this.te(6e4)}))}}class Un{constructor(e,t){this.localStore=e,this.persistence=t}async ne(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.re(t,e)))}re(e,t){const n=new Set;let r=t,a=!0;return kn.doWhile((()=>!0===a&&r>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((t=>{if(null!==t&&!n.has(t))return At(zn,`Processing collection: ${t}`),this.ie(e,t,r).next((e=>{r-=e,n.add(t)}));a=!1})))).next((()=>t-r))}ie(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((r=>this.localStore.localDocuments.getNextDocuments(e,t,r,n).next((n=>{const a=n.changes;return this.localStore.indexManager.updateIndexEntries(e,a).next((()=>this.se(r,n))).next((n=>(At(zn,`Updating offset: ${n}`),this.localStore.indexManager.updateCollectionGroup(e,t,n)))).next((()=>a.size))}))))}se(e,t){let n=e;return t.changes.forEach(((e,t)=>{const r=wn(t);Tn(r,n)>0&&(n=r)})),new En(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}class Bn{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.oe(e),this._e=e=>t.writeSequenceNumber(e))}oe(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this._e&&this._e(e),e}}Bn.ae=-1;const Vn=-1;function $n(e){return null==e}function Hn(e){return 0===e&&1/e==-1/0}function Wn(e){return"number"==typeof e&&Number.isInteger(e)&&!Hn(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}const Gn="\x01";function Kn(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=Yn(t)),t=qn(e.get(n),t);return Yn(t)}function qn(e,t){let n=t;const r=e.length;for(let a=0;a<r;a++){const t=e.charAt(a);switch(t){case"\0":n+="\x01\x10";break;case Gn:n+="\x01\x11";break;default:n+=t}}return n}function Yn(e){return e+Gn+"\x01"}function Xn(e){const t=e.length;if(Pt(t>=2),2===t)return Pt(e.charAt(0)===Gn&&"\x01"===e.charAt(1)),ln.emptyPath();const n=t-2,r=[];let a="";for(let i=0;i<t;){const t=e.indexOf(Gn,i);switch((t<0||t>n)&&Dt(),e.charAt(t+1)){case"\x01":const n=e.substring(i,t);let s;0===a.length?s=n:(a+=n,s=a,a=""),r.push(s);break;case"\x10":a+=e.substring(i,t),a+="\0";break;case"\x11":a+=e.substring(i,t+1);break;default:Dt()}i=t+2}return new ln(r)}const Qn="remoteDocuments",Jn="owner",Zn="owner",er="mutationQueues",tr="mutations",nr="batchId",rr="userMutationsIndex",ar=["userId","batchId"];function ir(e,t){return[e,Kn(t)]}function sr(e,t,n){return[e,Kn(t),n]}const or={},cr="documentMutations",lr="remoteDocumentsV14",ur=["prefixPath","collectionGroup","readTime","documentId"],dr="documentKeyIndex",hr=["prefixPath","collectionGroup","documentId"],fr="collectionGroupIndex",pr=["collectionGroup","readTime","prefixPath","documentId"],gr="remoteDocumentGlobal",mr="remoteDocumentGlobalKey",vr="targets",yr="queryTargetsIndex",br=["canonicalId","targetId"],wr="targetDocuments",Er=["targetId","path"],Tr="documentTargetsIndex",xr=["path","targetId"],Sr="targetGlobalKey",Ir="targetGlobal",kr="collectionParents",_r=["collectionId","parent"],Cr="clientMetadata",Ar="bundles",Nr="namedQueries",Rr="indexConfiguration",Or="collectionGroupIndex",Dr="indexState",Pr=["indexId","uid"],Lr="sequenceNumberIndex",Mr=["uid","sequenceNumber"],Fr="indexEntries",zr=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],jr="documentKeyIndex",Ur=["indexId","uid","orderedDocumentKey"],Br="documentOverlays",Vr=["userId","collectionPath","documentId"],$r="collectionPathOverlayIndex",Hr=["userId","collectionPath","largestBatchId"],Wr="collectionGroupOverlayIndex",Gr=["userId","collectionGroup","largestBatchId"],Kr="globals",qr=[er,tr,cr,Qn,vr,Jn,Ir,wr,Cr,gr,kr,Ar,Nr],Yr=[...qr,Br],Xr=[er,tr,cr,lr,vr,Jn,Ir,wr,Cr,gr,kr,Ar,Nr,Br],Qr=Xr,Jr=[...Qr,Rr,Dr,Fr],Zr=Jr,ea=[...Jr,Kr];class ta extends Sn{constructor(e,t){super(),this.ue=e,this.currentSequenceNumber=t}}function na(e,t){const n=Lt(e);return An.M(n.ue,t)}function ra(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function aa(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function ia(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class sa{constructor(e,t){this.comparator=e,this.root=t||ca.EMPTY}insert(e,t){return new sa(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ca.BLACK,null,null))}remove(e){return new sa(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ca.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new oa(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new oa(this.root,e,this.comparator,!1)}getReverseIterator(){return new oa(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new oa(this.root,e,this.comparator,!0)}}class oa{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?n(e.key,t):1,t&&r&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(0===a){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ca{constructor(e,t,n,r,a){this.key=e,this.value=t,this.color=null!=n?n:ca.RED,this.left=null!=r?r:ca.EMPTY,this.right=null!=a?a:ca.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,a){return new ca(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=a?a:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const a=n(e,r.key);return r=a<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===a?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return ca.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return ca.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ca.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ca.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Dt();if(this.right.isRed())throw Dt();const e=this.left.check();if(e!==this.right.check())throw Dt();return e+(this.isRed()?0:1)}}ca.EMPTY=null,ca.RED=!0,ca.BLACK=!1,ca.EMPTY=new class{constructor(){this.size=0}get key(){throw Dt()}get value(){throw Dt()}get color(){throw Dt()}get left(){throw Dt()}get right(){throw Dt()}copy(e,t,n,r,a){return this}insert(e,t,n){return new ca(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class la{constructor(e){this.comparator=e,this.data=new sa(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new ua(this.data.getIterator())}getIteratorFrom(e){return new ua(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof la))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new la(this.comparator);return t.data=e,t}}class ua{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function da(e){return e.hasNext()?e.getNext():void 0}class ha{constructor(e){this.fields=e,e.sort(dn.comparator)}static empty(){return new ha([])}unionWith(e){let t=new la(dn.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new ha(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return en(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class fa extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class pa{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new fa("Invalid base64 string: "+e):e}}(e);return new pa(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new pa(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Xt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}pa.EMPTY_BYTE_STRING=new pa("");const ga=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ma(e){if(Pt(!!e),"string"==typeof e){let t=0;const n=ga.exec(e);if(Pt(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:va(e.seconds),nanos:va(e.nanos)}}function va(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function ya(e){return"string"==typeof e?pa.fromBase64String(e):pa.fromUint8Array(e)}const ba="server_timestamp",wa="__type__",Ea="__previous_value__",Ta="__local_write_time__";function xa(e){var t,n;return(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{})[wa])||void 0===n?void 0:n.stringValue)===ba}function Sa(e){const t=e.mapValue.fields[Ea];return xa(t)?Sa(t):t}function Ia(e){const t=ma(e.mapValue.fields[Ta].timestampValue);return new an(t.seconds,t.nanos)}class ka{constructor(e,t,n,r,a,i,s,o,c){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=a,this.forceLongPolling=i,this.autoDetectLongPolling=s,this.longPollingOptions=o,this.useFetchStreams=c}}const _a="(default)";class Ca{constructor(e,t){this.projectId=e,this.database=t||_a}static empty(){return new Ca("","")}get isDefaultDatabase(){return this.database===_a}isEqual(e){return e instanceof Ca&&e.projectId===this.projectId&&e.database===this.database}}const Aa="__type__",Na="__max__",Ra={mapValue:{fields:{__type__:{stringValue:Na}}}},Oa="__vector__",Da="value",Pa={nullValue:"NULL_VALUE"};function La(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?xa(e)?4:Ja(e)?9007199254740991:Xa(e)?10:11:Dt()}function Ma(e,t){if(e===t)return!0;const n=La(e);if(n!==La(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Ia(e).isEqual(Ia(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=ma(e.timestampValue),r=ma(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return ya(e.bytesValue).isEqual(ya(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return va(e.geoPointValue.latitude)===va(t.geoPointValue.latitude)&&va(e.geoPointValue.longitude)===va(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return va(e.integerValue)===va(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=va(e.doubleValue),r=va(t.doubleValue);return n===r?Hn(n)===Hn(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return en(e.arrayValue.values||[],t.arrayValue.values||[],Ma);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(ra(n)!==ra(r))return!1;for(const a in n)if(n.hasOwnProperty(a)&&(void 0===r[a]||!Ma(n[a],r[a])))return!1;return!0}(e,t);default:return Dt()}}function Fa(e,t){return void 0!==(e.values||[]).find((e=>Ma(e,t)))}function za(e,t){if(e===t)return 0;const n=La(e),r=La(t);if(n!==r)return Xt(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Xt(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=va(e.integerValue||e.doubleValue),r=va(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return ja(e.timestampValue,t.timestampValue);case 4:return ja(Ia(e),Ia(t));case 5:return Qt(e.stringValue,t.stringValue);case 6:return function(e,t){const n=ya(e),r=ya(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let a=0;a<n.length&&a<r.length;a++){const e=Xt(n[a],r[a]);if(0!==e)return e}return Xt(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=Xt(va(e.latitude),va(t.latitude));return 0!==n?n:Xt(va(e.longitude),va(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return Ua(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n,r,a,i;const s=e.fields||{},o=t.fields||{},c=null===(n=s[Da])||void 0===n?void 0:n.arrayValue,l=null===(r=o[Da])||void 0===r?void 0:r.arrayValue,u=Xt((null===(a=null==c?void 0:c.values)||void 0===a?void 0:a.length)||0,(null===(i=null==l?void 0:l.values)||void 0===i?void 0:i.length)||0);return 0!==u?u:Ua(c,l)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===Ra.mapValue&&t===Ra.mapValue)return 0;if(e===Ra.mapValue)return 1;if(t===Ra.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),a=t.fields||{},i=Object.keys(a);r.sort(),i.sort();for(let s=0;s<r.length&&s<i.length;++s){const e=Qt(r[s],i[s]);if(0!==e)return e;const t=za(n[r[s]],a[i[s]]);if(0!==t)return t}return Xt(r.length,i.length)}(e.mapValue,t.mapValue);default:throw Dt()}}function ja(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return Xt(e,t);const n=ma(e),r=ma(t),a=Xt(n.seconds,r.seconds);return 0!==a?a:Xt(n.nanos,r.nanos)}function Ua(e,t){const n=e.values||[],r=t.values||[];for(let a=0;a<n.length&&a<r.length;++a){const e=za(n[a],r[a]);if(e)return e}return Xt(n.length,r.length)}function Ba(e){return Va(e)}function Va(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=ma(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return ya(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return hn.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=Va(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const a of t)r?r=!1:n+=",",n+=`${a}:${Va(e.fields[a])}`;return n+"}"}(e.mapValue):Dt()}function $a(e){switch(La(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=Sa(e);return t?16+$a(t):16;case 5:return 2*e.stringValue.length;case 6:return ya(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(e){return(e.values||[]).reduce(((e,t)=>e+$a(t)),0)}(e.arrayValue);case 10:case 11:return function(e){let t=0;return aa(e.fields,((e,n)=>{t+=e.length+$a(n)})),t}(e.mapValue);default:throw Dt()}}function Ha(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function Wa(e){return!!e&&"integerValue"in e}function Ga(e){return!!e&&"arrayValue"in e}function Ka(e){return!!e&&"nullValue"in e}function qa(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Ya(e){return!!e&&"mapValue"in e}function Xa(e){var t,n;return(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{})[Aa])||void 0===n?void 0:n.stringValue)===Oa}function Qa(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return aa(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=Qa(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Qa(e.arrayValue.values[n]);return t}return Object.assign({},e)}function Ja(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===Na}const Za={mapValue:{fields:{[Aa]:{stringValue:Oa},[Da]:{arrayValue:{}}}}};function ei(e){return"nullValue"in e?Pa:"booleanValue"in e?{booleanValue:!1}:"integerValue"in e||"doubleValue"in e?{doubleValue:NaN}:"timestampValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in e?{stringValue:""}:"bytesValue"in e?{bytesValue:""}:"referenceValue"in e?Ha(Ca.empty(),hn.empty()):"geoPointValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in e?{arrayValue:{}}:"mapValue"in e?Xa(e)?Za:{mapValue:{}}:Dt()}function ti(e){return"nullValue"in e?{booleanValue:!1}:"booleanValue"in e?{doubleValue:NaN}:"integerValue"in e||"doubleValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in e?{stringValue:""}:"stringValue"in e?{bytesValue:""}:"bytesValue"in e?Ha(Ca.empty(),hn.empty()):"referenceValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in e?{arrayValue:{}}:"arrayValue"in e?Za:"mapValue"in e?Xa(e)?{mapValue:{}}:Ra:Dt()}function ni(e,t){const n=za(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function ri(e,t){const n=za(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}class ai{constructor(e){this.value=e}static empty(){return new ai({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Ya(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Qa(t)}setAll(e){let t=dn.emptyPath(),n={},r=[];e.forEach(((e,a)=>{if(!t.isImmediateParentOf(a)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=a.popLast()}e?n[a.lastSegment()]=Qa(e):r.push(a.lastSegment())}));const a=this.getFieldsMap(t);this.applyChanges(a,n,r)}delete(e){const t=this.field(e.popLast());Ya(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ma(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];Ya(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){aa(t,((t,n)=>e[t]=n));for(const r of n)delete e[r]}clone(){return new ai(Qa(this.value))}}function ii(e){const t=[];return aa(e.fields,((e,n)=>{const r=new dn([e]);if(Ya(n)){const e=ii(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)})),new ha(t)}class si{constructor(e,t,n,r,a,i,s){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=a,this.data=i,this.documentState=s}static newInvalidDocument(e){return new si(e,0,sn.min(),sn.min(),sn.min(),ai.empty(),0)}static newFoundDocument(e,t,n,r){return new si(e,1,t,sn.min(),n,r,0)}static newNoDocument(e,t){return new si(e,2,t,sn.min(),sn.min(),ai.empty(),0)}static newUnknownDocument(e,t){return new si(e,3,t,sn.min(),sn.min(),ai.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(sn.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ai.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ai.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=sn.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof si&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new si(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class oi{constructor(e,t){this.position=e,this.inclusive=t}}function ci(e,t,n){let r=0;for(let a=0;a<e.position.length;a++){const i=t[a],s=e.position[a];if(r=i.field.isKeyField()?hn.comparator(hn.fromName(s.referenceValue),n.key):za(s,n.data.field(i.field)),"desc"===i.dir&&(r*=-1),0!==r)break}return r}function li(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Ma(e.position[n],t.position[n]))return!1;return!0}class ui{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function di(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class hi{}class fi extends hi{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new xi(e,t,n):"array-contains"===t?new _i(e,n):"in"===t?new Ci(e,n):"not-in"===t?new Ai(e,n):"array-contains-any"===t?new Ni(e,n):new fi(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new Si(e,n):new Ii(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(za(t,this.value)):null!==t&&La(this.value)===La(t)&&this.matchesComparison(za(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Dt()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class pi extends hi{constructor(e,t){super(),this.filters=e,this.op=t,this.ce=null}static create(e,t){return new pi(e,t)}matches(e){return gi(this)?void 0===this.filters.find((t=>!t.matches(e))):void 0!==this.filters.find((t=>t.matches(e)))}getFlattenedFilters(){return null!==this.ce||(this.ce=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.ce}getFilters(){return Object.assign([],this.filters)}}function gi(e){return"and"===e.op}function mi(e){return"or"===e.op}function vi(e){return yi(e)&&gi(e)}function yi(e){for(const t of e.filters)if(t instanceof pi)return!1;return!0}function bi(e){if(e instanceof fi)return e.field.canonicalString()+e.op.toString()+Ba(e.value);if(vi(e))return e.filters.map((e=>bi(e))).join(",");{const t=e.filters.map((e=>bi(e))).join(",");return`${e.op}(${t})`}}function wi(e,t){return e instanceof fi?function(e,t){return t instanceof fi&&e.op===t.op&&e.field.isEqual(t.field)&&Ma(e.value,t.value)}(e,t):e instanceof pi?function(e,t){return t instanceof pi&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce(((e,n,r)=>e&&wi(n,t.filters[r])),!0)}(e,t):void Dt()}function Ei(e,t){const n=e.filters.concat(t);return pi.create(n,e.op)}function Ti(e){return e instanceof fi?function(e){return`${e.field.canonicalString()} ${e.op} ${Ba(e.value)}`}(e):e instanceof pi?function(e){return e.op.toString()+" {"+e.getFilters().map(Ti).join(" ,")+"}"}(e):"Filter"}class xi extends fi{constructor(e,t,n){super(e,t,n),this.key=hn.fromName(n.referenceValue)}matches(e){const t=hn.comparator(e.key,this.key);return this.matchesComparison(t)}}class Si extends fi{constructor(e,t){super(e,"in",t),this.keys=ki("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class Ii extends fi{constructor(e,t){super(e,"not-in",t),this.keys=ki("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function ki(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>hn.fromName(e.referenceValue)))}class _i extends fi{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Ga(t)&&Fa(t.arrayValue,this.value)}}class Ci extends fi{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Fa(this.value.arrayValue,t)}}class Ai extends fi{constructor(e,t){super(e,"not-in",t)}matches(e){if(Fa(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Fa(this.value.arrayValue,t)}}class Ni extends fi{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Ga(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>Fa(this.value.arrayValue,e)))}}class Ri{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=a,this.startAt=i,this.endAt=s,this.le=null}}function Oi(e){return new Ri(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function Di(e){const t=Lt(e);if(null===t.le){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>bi(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),$n(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>Ba(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>Ba(e))).join(",")),t.le=e}return t.le}function Pi(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!di(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!wi(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!li(e.startAt,t.startAt)&&li(e.endAt,t.endAt)}function Li(e){return hn.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function Mi(e,t){return e.filters.filter((e=>e instanceof fi&&e.field.isEqual(t)))}function Fi(e,t,n){let r=Pa,a=!0;for(const i of Mi(e,t)){let e=Pa,t=!0;switch(i.op){case"<":case"<=":e=ei(i.value);break;case"==":case"in":case">=":e=i.value;break;case">":e=i.value,t=!1;break;case"!=":case"not-in":e=Pa}ni({value:r,inclusive:a},{value:e,inclusive:t})<0&&(r=e,a=t)}if(null!==n)for(let i=0;i<e.orderBy.length;++i)if(e.orderBy[i].field.isEqual(t)){const e=n.position[i];ni({value:r,inclusive:a},{value:e,inclusive:n.inclusive})<0&&(r=e,a=n.inclusive);break}return{value:r,inclusive:a}}function zi(e,t,n){let r=Ra,a=!0;for(const i of Mi(e,t)){let e=Ra,t=!0;switch(i.op){case">=":case">":e=ti(i.value),t=!1;break;case"==":case"in":case"<=":e=i.value;break;case"<":e=i.value,t=!1;break;case"!=":case"not-in":e=Ra}ri({value:r,inclusive:a},{value:e,inclusive:t})>0&&(r=e,a=t)}if(null!==n)for(let i=0;i<e.orderBy.length;++i)if(e.orderBy[i].field.isEqual(t)){const e=n.position[i];ri({value:r,inclusive:a},{value:e,inclusive:n.inclusive})>0&&(r=e,a=n.inclusive);break}return{value:r,inclusive:a}}class ji{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=a,this.limitType=i,this.startAt=s,this.endAt=o,this.he=null,this.Pe=null,this.Te=null,this.startAt,this.endAt}}function Ui(e,t,n,r,a,i,s,o){return new ji(e,t,n,r,a,i,s,o)}function Bi(e){return new ji(e)}function Vi(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function $i(e){return null!==e.collectionGroup}function Hi(e){const t=Lt(e);if(null===t.he){t.he=[];const e=new Set;for(const a of t.explicitOrderBy)t.he.push(a),e.add(a.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new la(dn.comparator);return e.filters.forEach((e=>{e.getFlattenedFilters().forEach((e=>{e.isInequality()&&(t=t.add(e.field))}))})),t}(t);r.forEach((r=>{e.has(r.canonicalString())||r.isKeyField()||t.he.push(new ui(r,n))})),e.has(dn.keyField().canonicalString())||t.he.push(new ui(dn.keyField(),n))}return t.he}function Wi(e){const t=Lt(e);return t.Pe||(t.Pe=Gi(t,Hi(e))),t.Pe}function Gi(e,t){if("F"===e.limitType)return Oi(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map((e=>{const t="desc"===e.dir?"asc":"desc";return new ui(e.field,t)}));const n=e.endAt?new oi(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new oi(e.startAt.position,e.startAt.inclusive):null;return Oi(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function Ki(e,t){const n=e.filters.concat([t]);return new ji(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function qi(e,t,n){return new ji(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Yi(e,t){return Pi(Wi(e),Wi(t))&&e.limitType===t.limitType}function Xi(e){return`${Di(Wi(e))}|lt:${e.limitType}`}function Qi(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>Ti(e))).join(", ")}]`),$n(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e))).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>Ba(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>Ba(e))).join(",")),`Target(${t})`}(Wi(e))}; limitType=${e.limitType})`}function Ji(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):hn.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of Hi(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=ci(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,Hi(e),t))&&!(e.endAt&&!function(e,t,n){const r=ci(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,Hi(e),t))}(e,t)}function Zi(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function es(e){return(t,n)=>{let r=!1;for(const a of Hi(e)){const e=ts(a,t,n);if(0!==e)return e;r=r||a.field.isKeyField()}return 0}}function ts(e,t,n){const r=e.field.isKeyField()?hn.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),a=n.data.field(e);return null!==r&&null!==a?za(r,a):Dt()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return Dt()}}class ns{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,a]of n)if(this.equalsFn(r,e))return a}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let a=0;a<r.length;a++)if(this.equalsFn(r[a][0],e))return void(r[a]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){aa(this.inner,((t,n)=>{for(const[r,a]of n)e(r,a)}))}isEmpty(){return ia(this.inner)}size(){return this.innerSize}}const rs=new sa(hn.comparator);function as(){return rs}const is=new sa(hn.comparator);function ss(){let e=is;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const a of n)e=e.insert(a.key,a);return e}function os(e){let t=is;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function cs(){return us()}function ls(){return us()}function us(){return new ns((e=>e.toString()),((e,t)=>e.isEqual(t)))}const ds=new sa(hn.comparator),hs=new la(hn.comparator);function fs(){let e=hs;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const a of n)e=e.add(a);return e}const ps=new la(Xt);function gs(){return ps}function ms(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Hn(t)?"-0":t}}function vs(e){return{integerValue:""+e}}function ys(e,t){return Wn(t)?vs(t):ms(e,t)}class bs{constructor(){this._=void 0}}function ws(e,t,n){return e instanceof xs?function(e,t){const n={fields:{[wa]:{stringValue:ba},[Ta]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&xa(t)&&(t=Sa(t)),t&&(n.fields[Ea]=t),{mapValue:n}}(n,t):e instanceof Ss?Is(e,t):e instanceof ks?_s(e,t):function(e,t){const n=Ts(e,t),r=As(n)+As(e.Ie);return Wa(n)&&Wa(e.Ie)?vs(r):ms(e.serializer,r)}(e,t)}function Es(e,t,n){return e instanceof Ss?Is(e,t):e instanceof ks?_s(e,t):n}function Ts(e,t){return e instanceof Cs?function(e){return Wa(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class xs extends bs{}class Ss extends bs{constructor(e){super(),this.elements=e}}function Is(e,t){const n=Ns(t);for(const r of e.elements)n.some((e=>Ma(e,r)))||n.push(r);return{arrayValue:{values:n}}}class ks extends bs{constructor(e){super(),this.elements=e}}function _s(e,t){let n=Ns(t);for(const r of e.elements)n=n.filter((e=>!Ma(e,r)));return{arrayValue:{values:n}}}class Cs extends bs{constructor(e,t){super(),this.serializer=e,this.Ie=t}}function As(e){return va(e.integerValue||e.doubleValue)}function Ns(e){return Ga(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class Rs{constructor(e,t){this.field=e,this.transform=t}}class Os{constructor(e,t){this.version=e,this.transformResults=t}}class Ds{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Ds}static exists(e){return new Ds(void 0,e)}static updateTime(e){return new Ds(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ps(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Ls{}function Ms(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Gs(e.key,Ds.none()):new Bs(e.key,e.data,Ds.none());{const n=e.data,r=ai.empty();let a=new la(dn.comparator);for(let e of t.fields)if(!a.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),a=a.add(e)}return new Vs(e.key,r,new ha(a.toArray()),Ds.none())}}function Fs(e,t,n){e instanceof Bs?function(e,t,n){const r=e.value.clone(),a=Hs(e.fieldTransforms,t,n.transformResults);r.setAll(a),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof Vs?function(e,t,n){if(!Ps(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=Hs(e.fieldTransforms,t,n.transformResults),a=t.data;a.setAll($s(e)),a.setAll(r),t.convertToFoundDocument(n.version,a).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function zs(e,t,n,r){return e instanceof Bs?function(e,t,n,r){if(!Ps(e.precondition,t))return n;const a=e.value.clone(),i=Ws(e.fieldTransforms,r,t);return a.setAll(i),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),null}(e,t,n,r):e instanceof Vs?function(e,t,n,r){if(!Ps(e.precondition,t))return n;const a=Ws(e.fieldTransforms,r,t),i=t.data;return i.setAll($s(e)),i.setAll(a),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,r):function(e,t,n){return Ps(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function js(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),a=Ts(r.transform,e||null);null!=a&&(null===n&&(n=ai.empty()),n.set(r.field,a))}return n||null}function Us(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&en(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Ss&&t instanceof Ss||e instanceof ks&&t instanceof ks?en(e.elements,t.elements,Ma):e instanceof Cs&&t instanceof Cs?Ma(e.Ie,t.Ie):e instanceof xs&&t instanceof xs}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Bs extends Ls{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Vs extends Ls{constructor(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function $s(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}})),t}function Hs(e,t,n){const r=new Map;Pt(e.length===n.length);for(let a=0;a<n.length;a++){const i=e[a],s=i.transform,o=t.data.field(i.field);r.set(i.field,Es(s,o,n[a]))}return r}function Ws(e,t,n){const r=new Map;for(const a of e){const e=a.transform,i=n.data.field(a.field);r.set(a.field,ws(e,i,t))}return r}class Gs extends Ls{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Ks extends Ls{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class qs{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&Fs(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=zs(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=zs(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=ls();return this.mutations.forEach((r=>{const a=e.get(r.key),i=a.overlayedDocument;let s=this.applyToLocalView(i,a.mutatedFields);s=t.has(r.key)?null:s;const o=Ms(i,s);null!==o&&n.set(r.key,o),i.isValidDocument()||i.convertToNoDocument(sn.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),fs())}isEqual(e){return this.batchId===e.batchId&&en(this.mutations,e.mutations,((e,t)=>Us(e,t)))&&en(this.baseMutations,e.baseMutations,((e,t)=>Us(e,t)))}}class Ys{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){Pt(e.mutations.length===n.length);let r=ds;const a=e.mutations;for(let i=0;i<a.length;i++)r=r.insert(a[i].key,n[i].version);return new Ys(e,t,n,r)}}class Xs{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Qs{constructor(e,t){this.count=e,this.unchangedNames=t}}var Js,Zs;function eo(e){switch(e){case Mt.OK:return Dt();case Mt.CANCELLED:case Mt.UNKNOWN:case Mt.DEADLINE_EXCEEDED:case Mt.RESOURCE_EXHAUSTED:case Mt.INTERNAL:case Mt.UNAVAILABLE:case Mt.UNAUTHENTICATED:return!1;case Mt.INVALID_ARGUMENT:case Mt.NOT_FOUND:case Mt.ALREADY_EXISTS:case Mt.PERMISSION_DENIED:case Mt.FAILED_PRECONDITION:case Mt.ABORTED:case Mt.OUT_OF_RANGE:case Mt.UNIMPLEMENTED:case Mt.DATA_LOSS:return!0;default:return Dt()}}function to(e){if(void 0===e)return Nt("GRPC error has no .code"),Mt.UNKNOWN;switch(e){case Js.OK:return Mt.OK;case Js.CANCELLED:return Mt.CANCELLED;case Js.UNKNOWN:return Mt.UNKNOWN;case Js.DEADLINE_EXCEEDED:return Mt.DEADLINE_EXCEEDED;case Js.RESOURCE_EXHAUSTED:return Mt.RESOURCE_EXHAUSTED;case Js.INTERNAL:return Mt.INTERNAL;case Js.UNAVAILABLE:return Mt.UNAVAILABLE;case Js.UNAUTHENTICATED:return Mt.UNAUTHENTICATED;case Js.INVALID_ARGUMENT:return Mt.INVALID_ARGUMENT;case Js.NOT_FOUND:return Mt.NOT_FOUND;case Js.ALREADY_EXISTS:return Mt.ALREADY_EXISTS;case Js.PERMISSION_DENIED:return Mt.PERMISSION_DENIED;case Js.FAILED_PRECONDITION:return Mt.FAILED_PRECONDITION;case Js.ABORTED:return Mt.ABORTED;case Js.OUT_OF_RANGE:return Mt.OUT_OF_RANGE;case Js.UNIMPLEMENTED:return Mt.UNIMPLEMENTED;case Js.DATA_LOSS:return Mt.DATA_LOSS;default:return Dt()}}(Zs=Js||(Js={}))[Zs.OK=0]="OK",Zs[Zs.CANCELLED=1]="CANCELLED",Zs[Zs.UNKNOWN=2]="UNKNOWN",Zs[Zs.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Zs[Zs.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Zs[Zs.NOT_FOUND=5]="NOT_FOUND",Zs[Zs.ALREADY_EXISTS=6]="ALREADY_EXISTS",Zs[Zs.PERMISSION_DENIED=7]="PERMISSION_DENIED",Zs[Zs.UNAUTHENTICATED=16]="UNAUTHENTICATED",Zs[Zs.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Zs[Zs.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Zs[Zs.ABORTED=10]="ABORTED",Zs[Zs.OUT_OF_RANGE=11]="OUT_OF_RANGE",Zs[Zs.UNIMPLEMENTED=12]="UNIMPLEMENTED",Zs[Zs.INTERNAL=13]="INTERNAL",Zs[Zs.UNAVAILABLE=14]="UNAVAILABLE",Zs[Zs.DATA_LOSS=15]="DATA_LOSS";let no=null;const ro=new lt([4294967295,4294967295],0);function ao(e){const t=qt().encode(e),n=new ut;return n.update(t),new Uint8Array(n.digest())}function io(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),a=t.getUint32(8,!0),i=t.getUint32(12,!0);return[new lt([n,r],0),new lt([a,i],0)]}class so{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new oo(`Invalid padding: ${t}`);if(n<0)throw new oo(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new oo(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new oo(`Invalid padding when bitmap length is 0: ${t}`);this.Ee=8*e.length-t,this.de=lt.fromNumber(this.Ee)}Ae(e,t,n){let r=e.add(t.multiply(lt.fromNumber(n)));return 1===r.compare(ro)&&(r=new lt([r.getBits(0),r.getBits(1)],0)),r.modulo(this.de).toNumber()}Re(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Ee)return!1;const t=ao(e),[n,r]=io(t);for(let a=0;a<this.hashCount;a++){const e=this.Ae(n,r,a);if(!this.Re(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),i=new so(a,r,t);return n.forEach((e=>i.insert(e))),i}insert(e){if(0===this.Ee)return;const t=ao(e),[n,r]=io(t);for(let a=0;a<this.hashCount;a++){const e=this.Ae(n,r,a);this.Ve(e)}}Ve(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class oo extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class co{constructor(e,t,n,r,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,lo.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new co(sn.min(),r,new sa(Xt),as(),fs())}}class lo{constructor(e,t,n,r,a){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new lo(n,t,fs(),fs(),fs())}}class uo{constructor(e,t,n,r){this.me=e,this.removedTargetIds=t,this.key=n,this.fe=r}}class ho{constructor(e,t){this.targetId=e,this.ge=t}}class fo{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:pa.EMPTY_BYTE_STRING,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class po{constructor(){this.pe=0,this.ye=vo(),this.we=pa.EMPTY_BYTE_STRING,this.Se=!1,this.be=!0}get current(){return this.Se}get resumeToken(){return this.we}get De(){return 0!==this.pe}get ve(){return this.be}Ce(e){e.approximateByteSize()>0&&(this.be=!0,this.we=e)}Fe(){let e=fs(),t=fs(),n=fs();return this.ye.forEach(((r,a)=>{switch(a){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:Dt()}})),new lo(this.we,this.Se,e,t,n)}Me(){this.be=!1,this.ye=vo()}xe(e,t){this.be=!0,this.ye=this.ye.insert(e,t)}Oe(e){this.be=!0,this.ye=this.ye.remove(e)}Ne(){this.pe+=1}Be(){this.pe-=1,Pt(this.pe>=0)}Le(){this.be=!0,this.Se=!0}}class go{constructor(e){this.ke=e,this.qe=new Map,this.Qe=as(),this.$e=mo(),this.Ue=mo(),this.Ke=new sa(Xt)}We(e){for(const t of e.me)e.fe&&e.fe.isFoundDocument()?this.Ge(t,e.fe):this.ze(t,e.key,e.fe);for(const t of e.removedTargetIds)this.ze(t,e.key,e.fe)}je(e){this.forEachTarget(e,(t=>{const n=this.He(t);switch(e.state){case 0:this.Je(t)&&n.Ce(e.resumeToken);break;case 1:n.Be(),n.De||n.Me(),n.Ce(e.resumeToken);break;case 2:n.Be(),n.De||this.removeTarget(t);break;case 3:this.Je(t)&&(n.Le(),n.Ce(e.resumeToken));break;case 4:this.Je(t)&&(this.Ye(t),n.Ce(e.resumeToken));break;default:Dt()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.qe.forEach(((e,n)=>{this.Je(n)&&t(n)}))}Ze(e){const t=e.targetId,n=e.ge.count,r=this.Xe(t);if(r){const a=r.target;if(Li(a))if(0===n){const e=new hn(a.path);this.ze(t,e,si.newNoDocument(e,sn.min()))}else Pt(1===n);else{const r=this.et(t);if(r!==n){const n=this.tt(e),a=n?this.nt(n,e,r):1;if(0!==a){this.Ye(t);const e=2===a?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(t,e)}null==no||no.rt(function(e,t,n,r,a){var i,s,o,c,l,u;const d={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},h=t.unchangedNames;return h&&(d.bloomFilter={applied:0===a,hashCount:null!==(i=null==h?void 0:h.hashCount)&&void 0!==i?i:0,bitmapLength:null!==(c=null===(o=null===(s=null==h?void 0:h.bits)||void 0===s?void 0:s.bitmap)||void 0===o?void 0:o.length)&&void 0!==c?c:0,padding:null!==(u=null===(l=null==h?void 0:h.bits)||void 0===l?void 0:l.padding)&&void 0!==u?u:0,mightContain:e=>{var t;return null!==(t=null==r?void 0:r.mightContain(e))&&void 0!==t&&t}}),d}(r,e.ge,this.ke.it(),n,a))}}}}tt(e){const t=e.ge.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:a=0}=t;let i,s;try{i=ya(n).toUint8Array()}catch(e){if(e instanceof fa)return Rt("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{s=new so(i,r,a)}catch(e){return Rt(e instanceof oo?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===s.Ee?null:s}nt(e,t,n){return t.ge.count===n-this.st(e,t.targetId)?0:2}st(e,t){const n=this.ke.getRemoteKeysForTarget(t);let r=0;return n.forEach((n=>{const a=this.ke.it(),i=`projects/${a.projectId}/databases/${a.database}/documents/${n.path.canonicalString()}`;e.mightContain(i)||(this.ze(t,n,null),r++)})),r}ot(e){const t=new Map;this.qe.forEach(((n,r)=>{const a=this.Xe(r);if(a){if(n.current&&Li(a.target)){const t=new hn(a.target.path);this._t(t).has(r)||this.ut(r,t)||this.ze(r,t,si.newNoDocument(t,e))}n.ve&&(t.set(r,n.Fe()),n.Me())}}));let n=fs();this.Ue.forEach(((e,t)=>{let r=!0;t.forEachWhile((e=>{const t=this.Xe(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)})),r&&(n=n.add(e))})),this.Qe.forEach(((t,n)=>n.setReadTime(e)));const r=new co(e,t,this.Ke,this.Qe,n);return this.Qe=as(),this.$e=mo(),this.Ue=mo(),this.Ke=new sa(Xt),r}Ge(e,t){if(!this.Je(e))return;const n=this.ut(e,t.key)?2:0;this.He(e).xe(t.key,n),this.Qe=this.Qe.insert(t.key,t),this.$e=this.$e.insert(t.key,this._t(t.key).add(e)),this.Ue=this.Ue.insert(t.key,this.ct(t.key).add(e))}ze(e,t,n){if(!this.Je(e))return;const r=this.He(e);this.ut(e,t)?r.xe(t,1):r.Oe(t),this.Ue=this.Ue.insert(t,this.ct(t).delete(e)),this.Ue=this.Ue.insert(t,this.ct(t).add(e)),n&&(this.Qe=this.Qe.insert(t,n))}removeTarget(e){this.qe.delete(e)}et(e){const t=this.He(e).Fe();return this.ke.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ne(e){this.He(e).Ne()}He(e){let t=this.qe.get(e);return t||(t=new po,this.qe.set(e,t)),t}ct(e){let t=this.Ue.get(e);return t||(t=new la(Xt),this.Ue=this.Ue.insert(e,t)),t}_t(e){let t=this.$e.get(e);return t||(t=new la(Xt),this.$e=this.$e.insert(e,t)),t}Je(e){const t=null!==this.Xe(e);return t||At("WatchChangeAggregator","Detected inactive target",e),t}Xe(e){const t=this.qe.get(e);return t&&t.De?null:this.ke.lt(e)}Ye(e){this.qe.set(e,new po),this.ke.getRemoteKeysForTarget(e).forEach((t=>{this.ze(e,t,null)}))}ut(e,t){return this.ke.getRemoteKeysForTarget(e).has(t)}}function mo(){return new sa(hn.comparator)}function vo(){return new sa(hn.comparator)}const yo={asc:"ASCENDING",desc:"DESCENDING"},bo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},wo={and:"AND",or:"OR"};class Eo{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function To(e,t){return e.useProto3Json||$n(t)?t:{value:t}}function xo(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function So(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Io(e,t){return xo(e,t.toTimestamp())}function ko(e){return Pt(!!e),sn.fromTimestamp(function(e){const t=ma(e);return new an(t.seconds,t.nanos)}(e))}function _o(e,t){return Co(e,t).canonicalString()}function Co(e,t){const n=function(e){return new ln(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function Ao(e){const t=ln.fromString(e);return Pt(Qo(t)),t}function No(e,t){return _o(e.databaseId,t.path)}function Ro(e,t){const n=Ao(t);if(n.get(1)!==e.databaseId.projectId)throw new Ft(Mt.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Ft(Mt.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new hn(Lo(n))}function Oo(e,t){return _o(e.databaseId,t)}function Do(e){const t=Ao(e);return 4===t.length?ln.emptyPath():Lo(t)}function Po(e){return new ln(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Lo(e){return Pt(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function Mo(e,t,n){return{name:No(e,t),fields:n.value.mapValue.fields}}function Fo(e,t,n){const r=Ro(e,t.name),a=ko(t.updateTime),i=t.createTime?ko(t.createTime):sn.min(),s=new ai({mapValue:{fields:t.fields}}),o=si.newFoundDocument(r,a,i,s);return n&&o.setHasCommittedMutations(),n?o.setHasCommittedMutations():o}function zo(e,t){let n;if(t instanceof Bs)n={update:Mo(e,t.key,t.value)};else if(t instanceof Gs)n={delete:No(e,t.key)};else if(t instanceof Vs)n={update:Mo(e,t.key,t.data),updateMask:Xo(t.fieldMask)};else{if(!(t instanceof Ks))return Dt();n={verify:No(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const n=t.transform;if(n instanceof xs)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Ss)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof ks)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Cs)return{fieldPath:t.field.canonicalString(),increment:n.Ie};throw Dt()}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Io(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Dt()}(e,t.precondition)),n}function jo(e,t){const n=t.currentDocument?function(e){return void 0!==e.updateTime?Ds.updateTime(ko(e.updateTime)):void 0!==e.exists?Ds.exists(e.exists):Ds.none()}(t.currentDocument):Ds.none(),r=t.updateTransforms?t.updateTransforms.map((t=>function(e,t){let n=null;if("setToServerValue"in t)Pt("REQUEST_TIME"===t.setToServerValue),n=new xs;else if("appendMissingElements"in t){const e=t.appendMissingElements.values||[];n=new Ss(e)}else if("removeAllFromArray"in t){const e=t.removeAllFromArray.values||[];n=new ks(e)}else"increment"in t?n=new Cs(e,t.increment):Dt();const r=dn.fromServerFormat(t.fieldPath);return new Rs(r,n)}(e,t))):[];if(t.update){t.update.name;const a=Ro(e,t.update.name),i=new ai({mapValue:{fields:t.update.fields}});if(t.updateMask){const e=function(e){const t=e.fieldPaths||[];return new ha(t.map((e=>dn.fromServerFormat(e))))}(t.updateMask);return new Vs(a,i,e,n,r)}return new Bs(a,i,n,r)}if(t.delete){const r=Ro(e,t.delete);return new Gs(r,n)}if(t.verify){const r=Ro(e,t.verify);return new Ks(r,n)}return Dt()}function Uo(e,t){return{documents:[Oo(e,t.path)]}}function Bo(e,t){const n={structuredQuery:{}},r=t.path;let a;null!==t.collectionGroup?(a=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(a=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Oo(e,a);const i=function(e){if(0!==e.length)return Yo(pi.create(e,"and"))}(t.filters);i&&(n.structuredQuery.where=i);const s=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:Ko(e.field),direction:Ho(e.dir)}}(e)))}(t.orderBy);s&&(n.structuredQuery.orderBy=s);const o=To(e,t.limit);return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{ht:n,parent:a}}function Vo(e){let t=Do(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let a=null;if(r>0){Pt(1===r);const e=n.from[0];e.allDescendants?a=e.collectionId:t=t.child(e.collectionId)}let i=[];n.where&&(i=function(e){const t=$o(e);return t instanceof pi&&vi(t)?t.getFilters():[t]}(n.where));let s=[];n.orderBy&&(s=function(e){return e.map((e=>function(e){return new ui(qo(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)))}(n.orderBy));let o=null;n.limit&&(o=function(e){let t;return t="object"==typeof e?e.value:e,$n(t)?null:t}(n.limit));let c=null;n.startAt&&(c=function(e){const t=!!e.before,n=e.values||[];return new oi(n,t)}(n.startAt));let l=null;return n.endAt&&(l=function(e){const t=!e.before,n=e.values||[];return new oi(n,t)}(n.endAt)),Ui(t,a,s,i,o,"F",c,l)}function $o(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=qo(e.unaryFilter.field);return fi.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=qo(e.unaryFilter.field);return fi.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=qo(e.unaryFilter.field);return fi.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=qo(e.unaryFilter.field);return fi.create(a,"!=",{nullValue:"NULL_VALUE"});default:return Dt()}}(e):void 0!==e.fieldFilter?function(e){return fi.create(qo(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Dt()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return pi.create(e.compositeFilter.filters.map((e=>$o(e))),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return Dt()}}(e.compositeFilter.op))}(e):Dt()}function Ho(e){return yo[e]}function Wo(e){return bo[e]}function Go(e){return wo[e]}function Ko(e){return{fieldPath:e.canonicalString()}}function qo(e){return dn.fromServerFormat(e.fieldPath)}function Yo(e){return e instanceof fi?function(e){if("=="===e.op){if(qa(e.value))return{unaryFilter:{field:Ko(e.field),op:"IS_NAN"}};if(Ka(e.value))return{unaryFilter:{field:Ko(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(qa(e.value))return{unaryFilter:{field:Ko(e.field),op:"IS_NOT_NAN"}};if(Ka(e.value))return{unaryFilter:{field:Ko(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ko(e.field),op:Wo(e.op),value:e.value}}}(e):e instanceof pi?function(e){const t=e.getFilters().map((e=>Yo(e)));return 1===t.length?t[0]:{compositeFilter:{op:Go(e.op),filters:t}}}(e):Dt()}function Xo(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function Qo(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class Jo{constructor(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:sn.min(),i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:sn.min(),s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:pa.EMPTY_BYTE_STRING,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=i,this.resumeToken=s,this.expectedCount=o}withSequenceNumber(e){return new Jo(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Jo(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Jo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Jo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Zo{constructor(e){this.Tt=e}}function ec(e,t){const n=t.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:tc(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())r.document=function(e,t){return{name:No(e,t.key),fields:t.data.value.mapValue.fields,updateTime:xo(e,t.version.toTimestamp()),createTime:xo(e,t.createTime.toTimestamp())}}(e.Tt,t);else if(t.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:nc(t.version)};else{if(!t.isUnknownDocument())return Dt();r.unknownDocument={path:n.path.toArray(),version:nc(t.version)}}return r}function tc(e){const t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function nc(e){const t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function rc(e){const t=new an(e.seconds,e.nanoseconds);return sn.fromTimestamp(t)}function ac(e,t){const n=(t.baseMutations||[]).map((t=>jo(e.Tt,t)));for(let i=0;i<t.mutations.length-1;++i){const e=t.mutations[i];if(i+1<t.mutations.length&&void 0!==t.mutations[i+1].transform){const n=t.mutations[i+1];e.updateTransforms=n.transform.fieldTransforms,t.mutations.splice(i+1,1),++i}}const r=t.mutations.map((t=>jo(e.Tt,t))),a=an.fromMillis(t.localWriteTimeMs);return new qs(t.batchId,a,n,r)}function ic(e){const t=rc(e.readTime),n=void 0!==e.lastLimboFreeSnapshotVersion?rc(e.lastLimboFreeSnapshotVersion):sn.min();let r;return r=function(e){return void 0!==e.documents}(e.query)?function(e){return Pt(1===e.documents.length),Wi(Bi(Do(e.documents[0])))}(e.query):function(e){return Wi(Vo(e))}(e.query),new Jo(r,e.targetId,"TargetPurposeListen",e.lastListenSequenceNumber,t,n,pa.fromBase64String(e.resumeToken))}function sc(e,t){const n=nc(t.snapshotVersion),r=nc(t.lastLimboFreeSnapshotVersion);let a;a=Li(t.target)?Uo(e.Tt,t.target):Bo(e.Tt,t.target).ht;const i=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:Di(t.target),readTime:n,resumeToken:i,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:a}}function oc(e){const t=Vo({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?qi(t,t.limit,"L"):t}function cc(e,t){return new Xs(t.largestBatchId,jo(e.Tt,t.overlayMutation))}function lc(e,t){const n=t.path.lastSegment();return[e,Kn(t.path.popLast()),n]}function uc(e,t,n,r){return{indexId:e,uid:t,sequenceNumber:n,readTime:nc(r.readTime),documentKey:Kn(r.documentKey.path),largestBatchId:r.largestBatchId}}class dc{getBundleMetadata(e,t){return hc(e).get(t).next((e=>{if(e)return function(e){return{id:e.bundleId,createTime:rc(e.createTime),version:e.version}}(e)}))}saveBundleMetadata(e,t){return hc(e).put(function(e){return{bundleId:e.id,createTime:nc(ko(e.createTime)),version:e.version}}(t))}getNamedQuery(e,t){return fc(e).get(t).next((e=>{if(e)return function(e){return{name:e.name,query:oc(e.bundledQuery),readTime:rc(e.readTime)}}(e)}))}saveNamedQuery(e,t){return fc(e).put(function(e){return{name:e.name,readTime:nc(ko(e.readTime)),bundledQuery:e.bundledQuery}}(t))}}function hc(e){return na(e,Ar)}function fc(e){return na(e,Nr)}class pc{constructor(e,t){this.serializer=e,this.userId=t}static It(e,t){const n=t.uid||"";return new pc(e,n)}getOverlay(e,t){return gc(e).get(lc(this.userId,t)).next((e=>e?cc(this.serializer,e):null))}getOverlays(e,t){const n=cs();return kn.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){const r=[];return n.forEach(((n,a)=>{const i=new Xs(t,a);r.push(this.Et(e,i))})),kn.waitFor(r)}removeOverlaysForBatchId(e,t,n){const r=new Set;t.forEach((e=>r.add(Kn(e.getCollectionPath()))));const a=[];return r.forEach((t=>{const r=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,n+1],!1,!0);a.push(gc(e).J($r,r))})),kn.waitFor(a)}getOverlaysForCollection(e,t,n){const r=cs(),a=Kn(t),i=IDBKeyRange.bound([this.userId,a,n],[this.userId,a,Number.POSITIVE_INFINITY],!0);return gc(e).G($r,i).next((e=>{for(const t of e){const e=cc(this.serializer,t);r.set(e.getKey(),e)}return r}))}getOverlaysForCollectionGroup(e,t,n,r){const a=cs();let i;const s=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return gc(e).Z({index:Wr,range:s},((e,t,n)=>{const s=cc(this.serializer,t);a.size()<r||s.largestBatchId===i?(a.set(s.getKey(),s),i=s.largestBatchId):n.done()})).next((()=>a))}Et(e,t){return gc(e).put(function(e,t,n){const[r,a,i]=lc(t,n.mutation.key);return{userId:t,collectionPath:a,documentId:i,collectionGroup:n.mutation.key.getCollectionGroup(),largestBatchId:n.largestBatchId,overlayMutation:zo(e.Tt,n.mutation)}}(this.serializer,this.userId,t))}}function gc(e){return na(e,Br)}class mc{dt(e){return na(e,Kr)}getSessionToken(e){return this.dt(e).get("sessionToken").next((e=>{const t=null==e?void 0:e.value;return t?pa.fromUint8Array(t):pa.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.dt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class vc{constructor(){}At(e,t){this.Rt(e,t),t.Vt()}Rt(e,t){if("nullValue"in e)this.ft(t,5);else if("booleanValue"in e)this.ft(t,10),t.gt(e.booleanValue?1:0);else if("integerValue"in e)this.ft(t,15),t.gt(va(e.integerValue));else if("doubleValue"in e){const n=va(e.doubleValue);isNaN(n)?this.ft(t,13):(this.ft(t,15),Hn(n)?t.gt(0):t.gt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.ft(t,20),"string"==typeof n&&(n=ma(n)),t.yt(`${n.seconds||""}`),t.gt(n.nanos||0)}else if("stringValue"in e)this.wt(e.stringValue,t),this.St(t);else if("bytesValue"in e)this.ft(t,30),t.bt(ya(e.bytesValue)),this.St(t);else if("referenceValue"in e)this.Dt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.ft(t,45),t.gt(n.latitude||0),t.gt(n.longitude||0)}else"mapValue"in e?Ja(e)?this.ft(t,Number.MAX_SAFE_INTEGER):Xa(e)?this.vt(e.mapValue,t):(this.Ct(e.mapValue,t),this.St(t)):"arrayValue"in e?(this.Ft(e.arrayValue,t),this.St(t)):Dt()}wt(e,t){this.ft(t,25),this.Mt(e,t)}Mt(e,t){t.yt(e)}Ct(e,t){const n=e.fields||{};this.ft(t,55);for(const r of Object.keys(n))this.wt(r,t),this.Rt(n[r],t)}vt(e,t){var n,r;const a=e.fields||{};this.ft(t,53);const i=Da,s=(null===(r=null===(n=a[i].arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.length)||0;this.ft(t,15),t.gt(va(s)),this.wt(i,t),this.Rt(a[i],t)}Ft(e,t){const n=e.values||[];this.ft(t,50);for(const r of n)this.Rt(r,t)}Dt(e,t){this.ft(t,37),hn.fromName(e).path.forEach((e=>{this.ft(t,60),this.Mt(e,t)}))}ft(e,t){e.gt(t)}St(e){e.gt(2)}}vc.xt=new vc;const yc=255;function bc(e){if(0===e)return 8;let t=0;return e>>4||(t+=4,e<<=4),e>>6||(t+=2,e<<=2),e>>7||(t+=1),t}function wc(e){const t=64-function(e){let t=0;for(let n=0;n<8;++n){const r=bc(255&e[n]);if(t+=r,8!==r)break}return t}(e);return Math.ceil(t/8)}class Ec{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ot(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Nt(n.value),n=t.next();this.Bt()}Lt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.kt(n.value),n=t.next();this.qt()}Qt(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.Nt(e);else if(e<2048)this.Nt(960|e>>>6),this.Nt(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Nt(480|e>>>12),this.Nt(128|63&e>>>6),this.Nt(128|63&e);else{const e=t.codePointAt(0);this.Nt(240|e>>>18),this.Nt(128|63&e>>>12),this.Nt(128|63&e>>>6),this.Nt(128|63&e)}}this.Bt()}$t(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.kt(e);else if(e<2048)this.kt(960|e>>>6),this.kt(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.kt(480|e>>>12),this.kt(128|63&e>>>6),this.kt(128|63&e);else{const e=t.codePointAt(0);this.kt(240|e>>>18),this.kt(128|63&e>>>12),this.kt(128|63&e>>>6),this.kt(128|63&e)}}this.qt()}Ut(e){const t=this.Kt(e),n=wc(t);this.Wt(1+n),this.buffer[this.position++]=255&n;for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=255&t[r]}Gt(e){const t=this.Kt(e),n=wc(t);this.Wt(1+n),this.buffer[this.position++]=~(255&n);for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}zt(){this.jt(yc),this.jt(255)}Ht(){this.Jt(yc),this.Jt(255)}reset(){this.position=0}seed(e){this.Wt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Yt(){return this.buffer.slice(0,this.position)}Kt(e){const t=function(e){const t=new DataView(new ArrayBuffer(8));return t.setFloat64(0,e,!1),new Uint8Array(t.buffer)}(e),n=!!(128&t[0]);t[0]^=n?255:128;for(let r=1;r<t.length;++r)t[r]^=n?255:0;return t}Nt(e){const t=255&e;0===t?(this.jt(0),this.jt(255)):t===yc?(this.jt(yc),this.jt(0)):this.jt(t)}kt(e){const t=255&e;0===t?(this.Jt(0),this.Jt(255)):t===yc?(this.Jt(yc),this.Jt(0)):this.Jt(e)}Bt(){this.jt(0),this.jt(1)}qt(){this.Jt(0),this.Jt(1)}jt(e){this.Wt(1),this.buffer[this.position++]=e}Jt(e){this.Wt(1),this.buffer[this.position++]=~e}Wt(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}}class Tc{constructor(e){this.Zt=e}bt(e){this.Zt.Ot(e)}yt(e){this.Zt.Qt(e)}gt(e){this.Zt.Ut(e)}Vt(){this.Zt.zt()}}class xc{constructor(e){this.Zt=e}bt(e){this.Zt.Lt(e)}yt(e){this.Zt.$t(e)}gt(e){this.Zt.Gt(e)}Vt(){this.Zt.Ht()}}class Sc{constructor(){this.Zt=new Ec,this.Xt=new Tc(this.Zt),this.en=new xc(this.Zt)}seed(e){this.Zt.seed(e)}tn(e){return 0===e?this.Xt:this.en}Yt(){return this.Zt.Yt()}reset(){this.Zt.reset()}}class Ic{constructor(e,t,n,r){this.indexId=e,this.documentKey=t,this.arrayValue=n,this.directionalValue=r}nn(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,n=new Uint8Array(t);return n.set(this.directionalValue,0),t!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new Ic(this.indexId,this.documentKey,this.arrayValue,n)}}function kc(e,t){let n=e.indexId-t.indexId;return 0!==n?n:(n=_c(e.arrayValue,t.arrayValue),0!==n?n:(n=_c(e.directionalValue,t.directionalValue),0!==n?n:hn.comparator(e.documentKey,t.documentKey)))}function _c(e,t){for(let n=0;n<e.length&&n<t.length;++n){const r=e[n]-t[n];if(0!==r)return r}return e.length-t.length}class Cc{constructor(e){this.rn=new la(((e,t)=>dn.comparator(e.field,t.field))),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.sn=e.orderBy,this._n=[];for(const t of e.filters){const e=t;e.isInequality()?this.rn=this.rn.add(e):this._n.push(e)}}get an(){return this.rn.size>1}un(e){if(Pt(e.collectionGroup===this.collectionId),this.an)return!1;const t=gn(e);if(void 0!==t&&!this.cn(t))return!1;const n=mn(e);let r=new Set,a=0,i=0;for(;a<n.length&&this.cn(n[a]);++a)r=r.add(n[a].fieldPath.canonicalString());if(a===n.length)return!0;if(this.rn.size>0){const e=this.rn.getIterator().getNext();if(!r.has(e.field.canonicalString())){const t=n[a];if(!this.ln(e,t)||!this.hn(this.sn[i++],t))return!1}++a}for(;a<n.length;++a){const e=n[a];if(i>=this.sn.length||!this.hn(this.sn[i++],e))return!1}return!0}Pn(){if(this.an)return null;let e=new la(dn.comparator);const t=[];for(const n of this._n)if(!n.field.isKeyField())if("array-contains"===n.op||"array-contains-any"===n.op)t.push(new vn(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new vn(n.field,0))}for(const n of this.sn)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new vn(n.field,"asc"===n.dir?0:1)));return new pn(pn.UNKNOWN_ID,this.collectionId,t,yn.empty())}cn(e){for(const t of this._n)if(this.ln(t,e))return!0;return!1}ln(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;const n="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===n}hn(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function Ac(e){var t,n;if(Pt(e instanceof fi||e instanceof pi),e instanceof fi){if(e instanceof Ci){const r=(null===(n=null===(t=e.value.arrayValue)||void 0===t?void 0:t.values)||void 0===n?void 0:n.map((t=>fi.create(e.field,"==",t))))||[];return pi.create(r,"or")}return e}const r=e.filters.map((e=>Ac(e)));return pi.create(r,e.op)}function Nc(e){if(0===e.getFilters().length)return[];const t=Pc(Ac(e));return Pt(Dc(t)),Rc(t)||Oc(t)?[t]:t.getFilters()}function Rc(e){return e instanceof fi}function Oc(e){return e instanceof pi&&vi(e)}function Dc(e){return Rc(e)||Oc(e)||function(e){if(e instanceof pi&&mi(e)){for(const t of e.getFilters())if(!Rc(t)&&!Oc(t))return!1;return!0}return!1}(e)}function Pc(e){if(Pt(e instanceof fi||e instanceof pi),e instanceof fi)return e;if(1===e.filters.length)return Pc(e.filters[0]);const t=e.filters.map((e=>Pc(e)));let n=pi.create(t,e.op);return n=Fc(n),Dc(n)?n:(Pt(n instanceof pi),Pt(gi(n)),Pt(n.filters.length>1),n.filters.reduce(((e,t)=>Lc(e,t))))}function Lc(e,t){let n;return Pt(e instanceof fi||e instanceof pi),Pt(t instanceof fi||t instanceof pi),n=e instanceof fi?t instanceof fi?function(e,t){return pi.create([e,t],"and")}(e,t):Mc(e,t):t instanceof fi?Mc(t,e):function(e,t){if(Pt(e.filters.length>0&&t.filters.length>0),gi(e)&&gi(t))return Ei(e,t.getFilters());const n=mi(e)?e:t,r=mi(e)?t:e,a=n.filters.map((e=>Lc(e,r)));return pi.create(a,"or")}(e,t),Fc(n)}function Mc(e,t){if(gi(t))return Ei(t,e.getFilters());{const n=t.filters.map((t=>Lc(e,t)));return pi.create(n,"or")}}function Fc(e){if(Pt(e instanceof fi||e instanceof pi),e instanceof fi)return e;const t=e.getFilters();if(1===t.length)return Fc(t[0]);if(yi(e))return e;const n=t.map((e=>Fc(e))),r=[];return n.forEach((t=>{t instanceof fi?r.push(t):t instanceof pi&&(t.op===e.op?r.push(...t.filters):r.push(t))})),1===r.length?r[0]:pi.create(r,e.op)}class zc{constructor(){this.Tn=new jc}addToCollectionParentIndex(e,t){return this.Tn.add(t),kn.resolve()}getCollectionParents(e,t){return kn.resolve(this.Tn.getEntries(t))}addFieldIndex(e,t){return kn.resolve()}deleteFieldIndex(e,t){return kn.resolve()}deleteAllFieldIndexes(e){return kn.resolve()}createTargetIndexes(e,t){return kn.resolve()}getDocumentsMatchingTarget(e,t){return kn.resolve(null)}getIndexType(e,t){return kn.resolve(0)}getFieldIndexes(e,t){return kn.resolve([])}getNextCollectionGroupToUpdate(e){return kn.resolve(null)}getMinOffset(e,t){return kn.resolve(En.min())}getMinOffsetFromCollectionGroup(e,t){return kn.resolve(En.min())}updateCollectionGroup(e,t,n){return kn.resolve()}updateIndexEntries(e,t){return kn.resolve()}}class jc{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new la(ln.comparator),a=!r.has(n);return this.index[t]=r.add(n),a}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new la(ln.comparator)).toArray()}}const Uc="IndexedDbIndexManager",Bc=new Uint8Array(0);class Vc{constructor(e,t){this.databaseId=t,this.In=new jc,this.En=new ns((e=>Di(e)),((e,t)=>Pi(e,t))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.In.has(t)){const n=t.lastSegment(),r=t.popLast();e.addOnCommittedListener((()=>{this.In.add(t)}));const a={collectionId:n,parent:Kn(r)};return $c(e).put(a)}return kn.resolve()}getCollectionParents(e,t){const n=[],r=IDBKeyRange.bound([t,""],[tn(t),""],!1,!0);return $c(e).G(r).next((e=>{for(const r of e){if(r.collectionId!==t)break;n.push(Xn(r.parent))}return n}))}addFieldIndex(e,t){const n=Wc(e),r=function(e){return{indexId:e.indexId,collectionGroup:e.collectionGroup,fields:e.fields.map((e=>[e.fieldPath.canonicalString(),e.kind]))}}(t);delete r.indexId;const a=n.add(r);if(t.indexState){const n=Gc(e);return a.next((e=>{n.put(uc(e,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return a.next()}deleteFieldIndex(e,t){const n=Wc(e),r=Gc(e),a=Hc(e);return n.delete(t.indexId).next((()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Wc(e),n=Hc(e),r=Gc(e);return t.J().next((()=>n.J())).next((()=>r.J()))}createTargetIndexes(e,t){return kn.forEach(this.dn(t),(t=>this.getIndexType(e,t).next((n=>{if(0===n||1===n){const n=new Cc(t).Pn();if(null!=n)return this.addFieldIndex(e,n)}}))))}getDocumentsMatchingTarget(e,t){const n=Hc(e);let r=!0;const a=new Map;return kn.forEach(this.dn(t),(t=>this.An(e,t).next((e=>{r&&(r=!!e),a.set(t,e)})))).next((()=>{if(r){let e=fs();const r=[];return kn.forEach(a,((a,i)=>{At(Uc,`Using index ${function(e){return`id=${e.indexId}|cg=${e.collectionGroup}|f=${e.fields.map((e=>`${e.fieldPath}:${e.kind}`)).join(",")}`}(a)} to execute ${Di(t)}`);const s=function(e,t){const n=gn(t);if(void 0===n)return null;for(const r of Mi(e,n.fieldPath))switch(r.op){case"array-contains-any":return r.value.arrayValue.values||[];case"array-contains":return[r.value]}return null}(i,a),o=function(e,t){const n=new Map;for(const r of mn(t))for(const t of Mi(e,r.fieldPath))switch(t.op){case"==":case"in":n.set(r.fieldPath.canonicalString(),t.value);break;case"not-in":case"!=":return n.set(r.fieldPath.canonicalString(),t.value),Array.from(n.values())}return null}(i,a),c=function(e,t){const n=[];let r=!0;for(const a of mn(t)){const t=0===a.kind?Fi(e,a.fieldPath,e.startAt):zi(e,a.fieldPath,e.startAt);n.push(t.value),r&&(r=t.inclusive)}return new oi(n,r)}(i,a),l=function(e,t){const n=[];let r=!0;for(const a of mn(t)){const t=0===a.kind?zi(e,a.fieldPath,e.endAt):Fi(e,a.fieldPath,e.endAt);n.push(t.value),r&&(r=t.inclusive)}return new oi(n,r)}(i,a),u=this.Rn(a,i,c),d=this.Rn(a,i,l),h=this.Vn(a,i,o),f=this.mn(a.indexId,s,u,c.inclusive,d,l.inclusive,h);return kn.forEach(f,(a=>n.H(a,t.limit).next((t=>{t.forEach((t=>{const n=hn.fromSegments(t.documentKey);e.has(n)||(e=e.add(n),r.push(n))}))}))))})).next((()=>r))}return kn.resolve(null)}))}dn(e){let t=this.En.get(e);return t||(t=0===e.filters.length?[e]:Nc(pi.create(e.filters,"and")).map((t=>Oi(e.path,e.collectionGroup,e.orderBy,t.getFilters(),e.limit,e.startAt,e.endAt))),this.En.set(e,t),t)}mn(e,t,n,r,a,i,s){const o=(null!=t?t.length:1)*Math.max(n.length,a.length),c=o/(null!=t?t.length:1),l=[];for(let u=0;u<o;++u){const o=t?this.fn(t[u/c]):Bc,d=this.gn(e,o,n[u%c],r),h=this.pn(e,o,a[u%c],i),f=s.map((t=>this.gn(e,o,t,!0)));l.push(...this.createRange(d,h,f))}return l}gn(e,t,n,r){const a=new Ic(e,hn.empty(),t,n);return r?a:a.nn()}pn(e,t,n,r){const a=new Ic(e,hn.empty(),t,n);return r?a.nn():a}An(e,t){const n=new Cc(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((e=>{let t=null;for(const r of e)n.un(r)&&(!t||r.fields.length>t.fields.length)&&(t=r);return t}))}getIndexType(e,t){let n=2;const r=this.dn(t);return kn.forEach(r,(t=>this.An(e,t).next((e=>{e?0!==n&&e.fields.length<function(e){let t=new la(dn.comparator),n=!1;for(const r of e.filters)for(const e of r.getFlattenedFilters())e.field.isKeyField()||("array-contains"===e.op||"array-contains-any"===e.op?n=!0:t=t.add(e.field));for(const r of e.orderBy)r.field.isKeyField()||(t=t.add(r.field));return t.size+(n?1:0)}(t)&&(n=1):n=0})))).next((()=>function(e){return null!==e.limit}(t)&&r.length>1&&2===n?1:n))}yn(e,t){const n=new Sc;for(const r of mn(e)){const e=t.data.field(r.fieldPath);if(null==e)return null;const a=n.tn(r.kind);vc.xt.At(e,a)}return n.Yt()}fn(e){const t=new Sc;return vc.xt.At(e,t.tn(0)),t.Yt()}wn(e,t){const n=new Sc;return vc.xt.At(Ha(this.databaseId,t),n.tn(function(e){const t=mn(e);return 0===t.length?0:t[t.length-1].kind}(e))),n.Yt()}Vn(e,t,n){if(null===n)return[];let r=[];r.push(new Sc);let a=0;for(const i of mn(e)){const e=n[a++];for(const n of r)if(this.Sn(t,i.fieldPath)&&Ga(e))r=this.bn(r,i,e);else{const t=n.tn(i.kind);vc.xt.At(e,t)}}return this.Dn(r)}Rn(e,t,n){return this.Vn(e,t,n.position)}Dn(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].Yt();return t}bn(e,t,n){const r=[...e],a=[];for(const i of n.arrayValue.values||[])for(const e of r){const n=new Sc;n.seed(e.Yt()),vc.xt.At(i,n.tn(t.kind)),a.push(n)}return a}Sn(e,t){return!!e.filters.find((e=>e instanceof fi&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op)))}getFieldIndexes(e,t){const n=Wc(e),r=Gc(e);return(t?n.G(Or,IDBKeyRange.bound(t,t)):n.G()).next((e=>{const t=[];return kn.forEach(e,(e=>r.get([e.indexId,this.uid]).next((n=>{t.push(function(e,t){const n=t?new yn(t.sequenceNumber,new En(rc(t.readTime),new hn(Xn(t.documentKey)),t.largestBatchId)):yn.empty(),r=e.fields.map((e=>{let[t,n]=e;return new vn(dn.fromServerFormat(t),n)}));return new pn(e.indexId,e.collectionGroup,r,n)}(e,n))})))).next((()=>t))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((e=>0===e.length?null:(e.sort(((e,t)=>{const n=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==n?n:Xt(e.collectionGroup,t.collectionGroup)})),e[0].collectionGroup)))}updateCollectionGroup(e,t,n){const r=Wc(e),a=Gc(e);return this.vn(e).next((e=>r.G(Or,IDBKeyRange.bound(t,t)).next((t=>kn.forEach(t,(t=>a.put(uc(t.indexId,this.uid,e,n))))))))}updateIndexEntries(e,t){const n=new Map;return kn.forEach(t,((t,r)=>{const a=n.get(t.collectionGroup);return(a?kn.resolve(a):this.getFieldIndexes(e,t.collectionGroup)).next((a=>(n.set(t.collectionGroup,a),kn.forEach(a,(n=>this.Cn(e,t,n).next((t=>{const a=this.Fn(r,n);return t.isEqual(a)?kn.resolve():this.Mn(e,r,n,t,a)})))))))}))}xn(e,t,n,r){return Hc(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.wn(n,t.key),documentKey:t.key.path.toArray()})}On(e,t,n,r){return Hc(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.wn(n,t.key),t.key.path.toArray()])}Cn(e,t,n){const r=Hc(e);let a=new la(kc);return r.Z({index:jr,range:IDBKeyRange.only([n.indexId,this.uid,this.wn(n,t)])},((e,r)=>{a=a.add(new Ic(n.indexId,t,r.arrayValue,r.directionalValue))})).next((()=>a))}Fn(e,t){let n=new la(kc);const r=this.yn(t,e);if(null==r)return n;const a=gn(t);if(null!=a){const i=e.data.field(a.fieldPath);if(Ga(i))for(const a of i.arrayValue.values||[])n=n.add(new Ic(t.indexId,e.key,this.fn(a),r))}else n=n.add(new Ic(t.indexId,e.key,Bc,r));return n}Mn(e,t,n,r,a){At(Uc,"Updating index entries for document '%s'",t.key);const i=[];return function(e,t,n,r,a){const i=e.getIterator(),s=t.getIterator();let o=da(i),c=da(s);for(;o||c;){let e=!1,t=!1;if(o&&c){const r=n(o,c);r<0?t=!0:r>0&&(e=!0)}else null!=o?t=!0:e=!0;e?(r(c),c=da(s)):t?(a(o),o=da(i)):(o=da(i),c=da(s))}}(r,a,kc,(r=>{i.push(this.xn(e,t,n,r))}),(r=>{i.push(this.On(e,t,n,r))})),kn.waitFor(i)}vn(e){let t=1;return Gc(e).Z({index:Lr,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((e,n,r)=>{r.done(),t=n.sequenceNumber+1})).next((()=>t))}createRange(e,t,n){n=n.sort(((e,t)=>kc(e,t))).filter(((e,t,n)=>!t||0!==kc(e,n[t-1])));const r=[];r.push(e);for(const i of n){const n=kc(i,e),a=kc(i,t);if(0===n)r[0]=e.nn();else if(n>0&&a<0)r.push(i),r.push(i.nn());else if(a>0)break}r.push(t);const a=[];for(let i=0;i<r.length;i+=2){if(this.Nn(r[i],r[i+1]))return[];const e=[r[i].indexId,this.uid,r[i].arrayValue,r[i].directionalValue,Bc,[]],t=[r[i+1].indexId,this.uid,r[i+1].arrayValue,r[i+1].directionalValue,Bc,[]];a.push(IDBKeyRange.bound(e,t))}return a}Nn(e,t){return kc(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Kc)}getMinOffset(e,t){return kn.mapArray(this.dn(t),(t=>this.An(e,t).next((e=>e||Dt())))).next(Kc)}}function $c(e){return na(e,kr)}function Hc(e){return na(e,Fr)}function Wc(e){return na(e,Rr)}function Gc(e){return na(e,Dr)}function Kc(e){Pt(0!==e.length);let t=e[0].indexState.offset,n=t.largestBatchId;for(let r=1;r<e.length;r++){const a=e[r].indexState.offset;Tn(a,t)<0&&(t=a),n<a.largestBatchId&&(n=a.largestBatchId)}return new En(t.readTime,t.documentKey,n)}const qc={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Yc=41943040;class Xc{static withCacheSize(e){return new Xc(e,Xc.DEFAULT_COLLECTION_PERCENTILE,Xc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}function Qc(e,t,n){const r=e.store(tr),a=e.store(cr),i=[],s=IDBKeyRange.only(n.batchId);let o=0;const c=r.Z({range:s},((e,t,n)=>(o++,n.delete())));i.push(c.next((()=>{Pt(1===o)})));const l=[];for(const u of n.mutations){const e=sr(t,u.key.path,n.batchId);i.push(a.delete(e)),l.push(u.key)}return kn.waitFor(i).next((()=>l))}function Jc(e){if(!e)return 0;let t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw Dt();t=e.noDocument}return JSON.stringify(t).length}Xc.DEFAULT_COLLECTION_PERCENTILE=10,Xc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Xc.DEFAULT=new Xc(Yc,Xc.DEFAULT_COLLECTION_PERCENTILE,Xc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Xc.DISABLED=new Xc(-1,0,0);class Zc{constructor(e,t,n,r){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=r,this.Bn={}}static It(e,t,n,r){Pt(""!==e.uid);const a=e.isAuthenticated()?e.uid:"";return new Zc(a,t,n,r)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return tl(e).Z({index:rr,range:n},((e,n,r)=>{t=!1,r.done()})).next((()=>t))}addMutationBatch(e,t,n,r){const a=nl(e),i=tl(e);return i.add({}).next((s=>{Pt("number"==typeof s);const o=new qs(s,t,n,r),c=function(e,t,n){const r=n.baseMutations.map((t=>zo(e.Tt,t))),a=n.mutations.map((t=>zo(e.Tt,t)));return{userId:t,batchId:n.batchId,localWriteTimeMs:n.localWriteTime.toMillis(),baseMutations:r,mutations:a}}(this.serializer,this.userId,o),l=[];let u=new la(((e,t)=>Xt(e.canonicalString(),t.canonicalString())));for(const e of r){const t=sr(this.userId,e.key.path,s);u=u.add(e.key.path.popLast()),l.push(i.put(c)),l.push(a.put(t,or))}return u.forEach((t=>{l.push(this.indexManager.addToCollectionParentIndex(e,t))})),e.addOnCommittedListener((()=>{this.Bn[s]=o.keys()})),kn.waitFor(l).next((()=>o))}))}lookupMutationBatch(e,t){return tl(e).get(t).next((e=>e?(Pt(e.userId===this.userId),ac(this.serializer,e)):null))}Ln(e,t){return this.Bn[t]?kn.resolve(this.Bn[t]):this.lookupMutationBatch(e,t).next((e=>{if(e){const n=e.keys();return this.Bn[t]=n,n}return null}))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=IDBKeyRange.lowerBound([this.userId,n]);let a=null;return tl(e).Z({index:rr,range:r},((e,t,r)=>{t.userId===this.userId&&(Pt(t.batchId>=n),a=ac(this.serializer,t)),r.done()})).next((()=>a))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=Vn;return tl(e).Z({index:rr,range:t,reverse:!0},((e,t,r)=>{n=t.batchId,r.done()})).next((()=>n))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Vn],[this.userId,Number.POSITIVE_INFINITY]);return tl(e).G(rr,t).next((e=>e.map((e=>ac(this.serializer,e)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=ir(this.userId,t.path),r=IDBKeyRange.lowerBound(n),a=[];return nl(e).Z({range:r},((n,r,i)=>{const[s,o,c]=n,l=Xn(o);if(s===this.userId&&t.path.isEqual(l))return tl(e).get(c).next((e=>{if(!e)throw Dt();Pt(e.userId===this.userId),a.push(ac(this.serializer,e))}));i.done()})).next((()=>a))}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new la(Xt);const r=[];return t.forEach((t=>{const a=ir(this.userId,t.path),i=IDBKeyRange.lowerBound(a),s=nl(e).Z({range:i},((e,r,a)=>{const[i,s,o]=e,c=Xn(s);i===this.userId&&t.path.isEqual(c)?n=n.add(o):a.done()}));r.push(s)})),kn.waitFor(r).next((()=>this.kn(e,n)))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1,a=ir(this.userId,n),i=IDBKeyRange.lowerBound(a);let s=new la(Xt);return nl(e).Z({range:i},((e,t,a)=>{const[i,o,c]=e,l=Xn(o);i===this.userId&&n.isPrefixOf(l)?l.length===r&&(s=s.add(c)):a.done()})).next((()=>this.kn(e,s)))}kn(e,t){const n=[],r=[];return t.forEach((t=>{r.push(tl(e).get(t).next((e=>{if(null===e)throw Dt();Pt(e.userId===this.userId),n.push(ac(this.serializer,e))})))})),kn.waitFor(r).next((()=>n))}removeMutationBatch(e,t){return Qc(e.ue,this.userId,t).next((n=>(e.addOnCommittedListener((()=>{this.qn(t.batchId)})),kn.forEach(n,(t=>this.referenceDelegate.markPotentiallyOrphaned(e,t))))))}qn(e){delete this.Bn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return kn.resolve();const n=IDBKeyRange.lowerBound(function(e){return[e]}(this.userId)),r=[];return nl(e).Z({range:n},((e,t,n)=>{if(e[0]===this.userId){const t=Xn(e[1]);r.push(t)}else n.done()})).next((()=>{Pt(0===r.length)}))}))}containsKey(e,t){return el(e,this.userId,t)}Qn(e){return rl(e).get(this.userId).next((e=>e||{userId:this.userId,lastAcknowledgedBatchId:Vn,lastStreamToken:""}))}}function el(e,t,n){const r=ir(t,n.path),a=r[1],i=IDBKeyRange.lowerBound(r);let s=!1;return nl(e).Z({range:i,Y:!0},((e,n,r)=>{const[i,o,c]=e;i===t&&o===a&&(s=!0),r.done()})).next((()=>s))}function tl(e){return na(e,tr)}function nl(e){return na(e,cr)}function rl(e){return na(e,er)}class al{constructor(e){this.$n=e}next(){return this.$n+=2,this.$n}static Un(){return new al(0)}static Kn(){return new al(-1)}}class il{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Wn(e).next((t=>{const n=new al(t.highestTargetId);return t.highestTargetId=n.next(),this.Gn(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.Wn(e).next((e=>sn.fromTimestamp(new an(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.Wn(e).next((e=>e.highestListenSequenceNumber))}setTargetsMetadata(e,t,n){return this.Wn(e).next((r=>(r.highestListenSequenceNumber=t,n&&(r.lastRemoteSnapshotVersion=n.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.Gn(e,r))))}addTargetData(e,t){return this.zn(e,t).next((()=>this.Wn(e).next((n=>(n.targetCount+=1,this.jn(t,n),this.Gn(e,n))))))}updateTargetData(e,t){return this.zn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>sl(e).delete(t.targetId))).next((()=>this.Wn(e))).next((t=>(Pt(t.targetCount>0),t.targetCount-=1,this.Gn(e,t))))}removeTargets(e,t,n){let r=0;const a=[];return sl(e).Z(((i,s)=>{const o=ic(s);o.sequenceNumber<=t&&null===n.get(o.targetId)&&(r++,a.push(this.removeTargetData(e,o)))})).next((()=>kn.waitFor(a))).next((()=>r))}forEachTarget(e,t){return sl(e).Z(((e,n)=>{const r=ic(n);t(r)}))}Wn(e){return ol(e).get(Sr).next((e=>(Pt(null!==e),e)))}Gn(e,t){return ol(e).put(Sr,t)}zn(e,t){return sl(e).put(sc(this.serializer,t))}jn(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.Wn(e).next((e=>e.targetCount))}getTargetData(e,t){const n=Di(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let a=null;return sl(e).Z({range:r,index:yr},((e,n,r)=>{const i=ic(n);Pi(t,i.target)&&(a=i,r.done())})).next((()=>a))}addMatchingKeys(e,t,n){const r=[],a=cl(e);return t.forEach((t=>{const i=Kn(t.path);r.push(a.put({targetId:n,path:i})),r.push(this.referenceDelegate.addReference(e,n,t))})),kn.waitFor(r)}removeMatchingKeys(e,t,n){const r=cl(e);return kn.forEach(t,(t=>{const a=Kn(t.path);return kn.waitFor([r.delete([n,a]),this.referenceDelegate.removeReference(e,n,t)])}))}removeMatchingKeysForTargetId(e,t){const n=cl(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),r=cl(e);let a=fs();return r.Z({range:n,Y:!0},((e,t,n)=>{const r=Xn(e[1]),i=new hn(r);a=a.add(i)})).next((()=>a))}containsKey(e,t){const n=Kn(t.path),r=IDBKeyRange.bound([n],[tn(n)],!1,!0);let a=0;return cl(e).Z({index:Tr,Y:!0,range:r},((e,t,n)=>{let[r,i]=e;0!==r&&(a++,n.done())})).next((()=>a>0))}lt(e,t){return sl(e).get(t).next((e=>e?ic(e):null))}}function sl(e){return na(e,vr)}function ol(e){return na(e,Ir)}function cl(e){return na(e,wr)}const ll="LruGarbageCollector",ul=1048576;function dl(e,t){let[n,r]=e,[a,i]=t;const s=Xt(n,a);return 0===s?Xt(r,i):s}class hl{constructor(e){this.Hn=e,this.buffer=new la(dl),this.Jn=0}Yn(){return++this.Jn}Zn(e){const t=[e,this.Yn()];if(this.buffer.size<this.Hn)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();dl(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class fl{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Xn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.er(6e4)}stop(){this.Xn&&(this.Xn.cancel(),this.Xn=null)}get started(){return null!==this.Xn}er(e){At(ll,`Garbage collection scheduled in ${e}ms`),this.Xn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Xn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){Dn(e)?At(ll,"Ignoring IndexedDB error during garbage collection: ",e):await In(e)}await this.er(3e5)}))}}class pl{constructor(e,t){this.tr=e,this.params=t}calculateTargetCount(e,t){return this.tr.nr(e).next((e=>Math.floor(t/100*e)))}nthSequenceNumber(e,t){if(0===t)return kn.resolve(Bn.ae);const n=new hl(t);return this.tr.forEachTarget(e,(e=>n.Zn(e.sequenceNumber))).next((()=>this.tr.rr(e,(e=>n.Zn(e))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.tr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.tr.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(At("LruGarbageCollector","Garbage collection skipped; disabled"),kn.resolve(qc)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(At("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),qc):this.ir(e,t)))}getCacheSize(e){return this.tr.getCacheSize(e)}ir(e,t){let n,r,a,i,s,o,c;const l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((t=>(t>this.params.maximumSequenceNumbersToCollect?(At("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),r=this.params.maximumSequenceNumbersToCollect):r=t,i=Date.now(),this.nthSequenceNumber(e,r)))).next((r=>(n=r,s=Date.now(),this.removeTargets(e,n,t)))).next((t=>(a=t,o=Date.now(),this.removeOrphanedDocuments(e,n)))).next((e=>(c=Date.now(),Ct()<=z.DEBUG&&At("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${i-l}ms\n\tDetermined least recently used ${r} in `+(s-i)+"ms\n"+`\tRemoved ${a} targets in `+(o-s)+"ms\n"+`\tRemoved ${e} documents in `+(c-o)+"ms\n"+`Total Duration: ${c-l}ms`),kn.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:a,documentsRemoved:e}))))}}function gl(e,t){return new pl(e,t)}class ml{constructor(e,t){this.db=e,this.garbageCollector=gl(this,t)}nr(e){const t=this.sr(e);return this.db.getTargetCache().getTargetCount(e).next((e=>t.next((t=>e+t))))}sr(e){let t=0;return this.rr(e,(e=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}rr(e,t){return this._r(e,((e,n)=>t(n)))}addReference(e,t,n){return vl(e,n)}removeReference(e,t,n){return vl(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return vl(e,t)}ar(e,t){return function(e,t){let n=!1;return rl(e).X((r=>el(e,r,t).next((e=>(e&&(n=!0),kn.resolve(!e)))))).next((()=>n))}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let a=0;return this._r(e,((i,s)=>{if(s<=t){const t=this.ar(e,i).next((t=>{if(!t)return a++,n.getEntry(e,i).next((()=>(n.removeEntry(i,sn.min()),cl(e).delete(function(e){return[0,Kn(e.path)]}(i)))))}));r.push(t)}})).next((()=>kn.waitFor(r))).next((()=>n.apply(e))).next((()=>a))}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return vl(e,t)}_r(e,t){const n=cl(e);let r,a=Bn.ae;return n.Z({index:Tr},((e,n)=>{let[i,s]=e,{path:o,sequenceNumber:c}=n;0===i?(a!==Bn.ae&&t(new hn(Xn(r)),a),a=c,r=o):a=Bn.ae})).next((()=>{a!==Bn.ae&&t(new hn(Xn(r)),a)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function vl(e,t){return cl(e).put(function(e,t){return{targetId:0,path:Kn(e.path),sequenceNumber:t}}(t,e.currentSequenceNumber))}class yl{constructor(){this.changes=new ns((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,si.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?kn.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class bl{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return xl(e).put(n)}removeEntry(e,t,n){return xl(e).delete(function(e,t){const n=e.path.toArray();return[n.slice(0,n.length-2),n[n.length-2],tc(t),n[n.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next((n=>(n.byteSize+=t,this.ur(e,n))))}getEntry(e,t){let n=si.newInvalidDocument(t);return xl(e).Z({index:dr,range:IDBKeyRange.only(Sl(t))},((e,r)=>{n=this.cr(t,r)})).next((()=>n))}lr(e,t){let n={size:0,document:si.newInvalidDocument(t)};return xl(e).Z({index:dr,range:IDBKeyRange.only(Sl(t))},((e,r)=>{n={document:this.cr(t,r),size:Jc(r)}})).next((()=>n))}getEntries(e,t){let n=as();return this.hr(e,t,((e,t)=>{const r=this.cr(e,t);n=n.insert(e,r)})).next((()=>n))}Pr(e,t){let n=as(),r=new sa(hn.comparator);return this.hr(e,t,((e,t)=>{const a=this.cr(e,t);n=n.insert(e,a),r=r.insert(e,Jc(t))})).next((()=>({documents:n,Tr:r})))}hr(e,t,n){if(t.isEmpty())return kn.resolve();let r=new la(kl);t.forEach((e=>r=r.add(e)));const a=IDBKeyRange.bound(Sl(r.first()),Sl(r.last())),i=r.getIterator();let s=i.getNext();return xl(e).Z({index:dr,range:a},((e,t,r)=>{const a=hn.fromSegments([...t.prefixPath,t.collectionGroup,t.documentId]);for(;s&&kl(s,a)<0;)n(s,null),s=i.getNext();s&&s.isEqual(a)&&(n(s,t),s=i.hasNext()?i.getNext():null),s?r.W(Sl(s)):r.done()})).next((()=>{for(;s;)n(s,null),s=i.hasNext()?i.getNext():null}))}getDocumentsMatchingQuery(e,t,n,r,a){const i=t.path,s=[i.popLast().toArray(),i.lastSegment(),tc(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],o=[i.popLast().toArray(),i.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return xl(e).G(IDBKeyRange.bound(s,o,!0)).next((e=>{null==a||a.incrementDocumentReadCount(e.length);let n=as();for(const a of e){const e=this.cr(hn.fromSegments(a.prefixPath.concat(a.collectionGroup,a.documentId)),a);e.isFoundDocument()&&(Ji(t,e)||r.has(e.key))&&(n=n.insert(e.key,e))}return n}))}getAllFromCollectionGroup(e,t,n,r){let a=as();const i=Il(t,n),s=Il(t,En.max());return xl(e).Z({index:fr,range:IDBKeyRange.bound(i,s,!0)},((e,t,n)=>{const i=this.cr(hn.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);a=a.insert(i.key,i),a.size===r&&n.done()})).next((()=>a))}newChangeBuffer(e){return new El(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((e=>e.byteSize))}getMetadata(e){return Tl(e).get(mr).next((e=>(Pt(!!e),e)))}ur(e,t){return Tl(e).put(mr,t)}cr(e,t){if(t){const e=function(e,t){let n;if(t.document)n=Fo(e.Tt,t.document,!!t.hasCommittedMutations);else if(t.noDocument){const e=hn.fromSegments(t.noDocument.path),r=rc(t.noDocument.readTime);n=si.newNoDocument(e,r),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return Dt();{const e=hn.fromSegments(t.unknownDocument.path),r=rc(t.unknownDocument.version);n=si.newUnknownDocument(e,r)}}return t.readTime&&n.setReadTime(function(e){const t=new an(e[0],e[1]);return sn.fromTimestamp(t)}(t.readTime)),n}(this.serializer,t);if(!e.isNoDocument()||!e.version.isEqual(sn.min()))return e}return si.newInvalidDocument(e)}}function wl(e){return new bl(e)}class El extends yl{constructor(e,t){super(),this.Ir=e,this.trackRemovals=t,this.Er=new ns((e=>e.toString()),((e,t)=>e.isEqual(t)))}applyChanges(e){const t=[];let n=0,r=new la(((e,t)=>Xt(e.canonicalString(),t.canonicalString())));return this.changes.forEach(((a,i)=>{const s=this.Er.get(a);if(t.push(this.Ir.removeEntry(e,a,s.readTime)),i.isValidDocument()){const o=ec(this.Ir.serializer,i);r=r.add(a.path.popLast());const c=Jc(o);n+=c-s.size,t.push(this.Ir.addEntry(e,a,o))}else if(n-=s.size,this.trackRemovals){const n=ec(this.Ir.serializer,i.convertToNoDocument(sn.min()));t.push(this.Ir.addEntry(e,a,n))}})),r.forEach((n=>{t.push(this.Ir.indexManager.addToCollectionParentIndex(e,n))})),t.push(this.Ir.updateMetadata(e,n)),kn.waitFor(t)}getFromCache(e,t){return this.Ir.lr(e,t).next((e=>(this.Er.set(t,{size:e.size,readTime:e.document.readTime}),e.document)))}getAllFromCache(e,t){return this.Ir.Pr(e,t).next((e=>{let{documents:t,Tr:n}=e;return n.forEach(((e,n)=>{this.Er.set(e,{size:n,readTime:t.get(e).readTime})})),t}))}}function Tl(e){return na(e,gr)}function xl(e){return na(e,lr)}function Sl(e){const t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function Il(e,t){const n=t.documentKey.path.toArray();return[e,tc(t.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function kl(e,t){const n=e.path.toArray(),r=t.path.toArray();let a=0;for(let i=0;i<n.length-2&&i<r.length-2;++i)if(a=Xt(n[i],r[i]),a)return a;return a=Xt(n.length,r.length),a||(a=Xt(n[n.length-2],r[r.length-2]),a||Xt(n[n.length-1],r[r.length-1]))}class _l{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Cl{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(n=r,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(null!==n&&zs(n.mutation,e,ha.empty(),an.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,fs()).next((()=>t))))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:fs();const r=cs();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,n).next((e=>{let t=ss();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const n=cs();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,fs())))}populateOverlays(e,t,n){const r=[];return n.forEach((e=>{t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,r){let a=as();const i=us(),s=us();return t.forEach(((e,t)=>{const s=n.get(t.key);r.has(t.key)&&(void 0===s||s.mutation instanceof Vs)?a=a.insert(t.key,t):void 0!==s?(i.set(t.key,s.mutation.getFieldMask()),zs(s.mutation,t,s.mutation.getFieldMask(),an.now())):i.set(t.key,ha.empty())})),this.recalculateAndSaveOverlays(e,a).next((e=>(e.forEach(((e,t)=>i.set(e,t))),t.forEach(((e,t)=>{var n;return s.set(e,new _l(t,null!==(n=i.get(e))&&void 0!==n?n:null))})),s)))}recalculateAndSaveOverlays(e,t){const n=us();let r=new sa(((e,t)=>e-t)),a=fs();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const a of e)a.keys().forEach((e=>{const i=t.get(e);if(null===i)return;let s=n.get(e)||ha.empty();s=a.applyToLocalView(i,s),n.set(e,s);const o=(r.get(a.batchId)||fs()).add(e);r=r.insert(a.batchId,o)}))})).next((()=>{const i=[],s=r.getReverseIterator();for(;s.hasNext();){const r=s.getNext(),o=r.key,c=r.value,l=ls();c.forEach((e=>{if(!a.has(e)){const r=Ms(t.get(e),n.get(e));null!==r&&l.set(e,r),a=a.add(e)}})),i.push(this.documentOverlayCache.saveOverlays(e,o,l))}return kn.waitFor(i)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return hn.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):$i(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((a=>{const i=r-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-a.size):kn.resolve(cs());let s=fn,o=a;return i.next((t=>kn.forEach(t,((t,n)=>(s<n.largestBatchId&&(s=n.largestBatchId),a.get(t)?kn.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{o=o.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,a))).next((()=>this.computeViews(e,o,t,fs()))).next((e=>({batchId:s,changes:os(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new hn(t)).next((e=>{let t=ss();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const a=t.collectionGroup;let i=ss();return this.indexManager.getCollectionParents(e,a).next((s=>kn.forEach(s,(s=>{const o=function(e,t){return new ji(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,s.child(a));return this.getDocumentsMatchingCollectionQuery(e,o,n,r).next((e=>{e.forEach(((e,t)=>{i=i.insert(e,t)}))}))})).next((()=>i))))}getDocumentsMatchingCollectionQuery(e,t,n,r){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((i=>(a=i,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,a,r)))).next((e=>{a.forEach(((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,si.newInvalidDocument(r)))}));let n=ss();return e.forEach(((e,r)=>{const i=a.get(e);void 0!==i&&zs(i.mutation,r,ha.empty(),an.now()),Ji(t,r)&&(n=n.insert(e,r))})),n}))}}class Al{constructor(e){this.serializer=e,this.dr=new Map,this.Ar=new Map}getBundleMetadata(e,t){return kn.resolve(this.dr.get(t))}saveBundleMetadata(e,t){return this.dr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:ko(e.createTime)}}(t)),kn.resolve()}getNamedQuery(e,t){return kn.resolve(this.Ar.get(t))}saveNamedQuery(e,t){return this.Ar.set(t.name,function(e){return{name:e.name,query:oc(e.bundledQuery),readTime:ko(e.readTime)}}(t)),kn.resolve()}}class Nl{constructor(){this.overlays=new sa(hn.comparator),this.Rr=new Map}getOverlay(e,t){return kn.resolve(this.overlays.get(t))}getOverlays(e,t){const n=cs();return kn.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,r)=>{this.Et(e,t,r)})),kn.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.Rr.get(n);return void 0!==r&&(r.forEach((e=>this.overlays=this.overlays.remove(e))),this.Rr.delete(n)),kn.resolve()}getOverlaysForCollection(e,t,n){const r=cs(),a=t.length+1,i=new hn(t.child("")),s=this.overlays.getIteratorFrom(i);for(;s.hasNext();){const e=s.getNext().value,i=e.getKey();if(!t.isPrefixOf(i.path))break;i.path.length===a&&e.largestBatchId>n&&r.set(e.getKey(),e)}return kn.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let a=new sa(((e,t)=>e-t));const i=this.overlays.getIterator();for(;i.hasNext();){const e=i.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=a.get(e.largestBatchId);null===t&&(t=cs(),a=a.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const s=cs(),o=a.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach(((e,t)=>s.set(e,t))),!(s.size()>=r)););return kn.resolve(s)}Et(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.Rr.get(r.largestBatchId).delete(n.key);this.Rr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new Xs(t,n));let a=this.Rr.get(t);void 0===a&&(a=fs(),this.Rr.set(t,a)),this.Rr.set(t,a.add(n.key))}}class Rl{constructor(){this.sessionToken=pa.EMPTY_BYTE_STRING}getSessionToken(e){return kn.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,kn.resolve()}}class Ol{constructor(){this.Vr=new la(Dl.mr),this.gr=new la(Dl.pr)}isEmpty(){return this.Vr.isEmpty()}addReference(e,t){const n=new Dl(e,t);this.Vr=this.Vr.add(n),this.gr=this.gr.add(n)}yr(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.wr(new Dl(e,t))}Sr(e,t){e.forEach((e=>this.removeReference(e,t)))}br(e){const t=new hn(new ln([])),n=new Dl(t,e),r=new Dl(t,e+1),a=[];return this.gr.forEachInRange([n,r],(e=>{this.wr(e),a.push(e.key)})),a}Dr(){this.Vr.forEach((e=>this.wr(e)))}wr(e){this.Vr=this.Vr.delete(e),this.gr=this.gr.delete(e)}vr(e){const t=new hn(new ln([])),n=new Dl(t,e),r=new Dl(t,e+1);let a=fs();return this.gr.forEachInRange([n,r],(e=>{a=a.add(e.key)})),a}containsKey(e){const t=new Dl(e,0),n=this.Vr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class Dl{constructor(e,t){this.key=e,this.Cr=t}static mr(e,t){return hn.comparator(e.key,t.key)||Xt(e.Cr,t.Cr)}static pr(e,t){return Xt(e.Cr,t.Cr)||hn.comparator(e.key,t.key)}}class Pl{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Fr=1,this.Mr=new la(Dl.mr)}checkEmpty(e){return kn.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const a=this.Fr;this.Fr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const i=new qs(a,t,n,r);this.mutationQueue.push(i);for(const s of r)this.Mr=this.Mr.add(new Dl(s.key,a)),this.indexManager.addToCollectionParentIndex(e,s.key.path.popLast());return kn.resolve(i)}lookupMutationBatch(e,t){return kn.resolve(this.Or(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.Nr(n),a=r<0?0:r;return kn.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return kn.resolve(0===this.mutationQueue.length?Vn:this.Fr-1)}getAllMutationBatches(e){return kn.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Dl(t,0),r=new Dl(t,Number.POSITIVE_INFINITY),a=[];return this.Mr.forEachInRange([n,r],(e=>{const t=this.Or(e.Cr);a.push(t)})),kn.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new la(Xt);return t.forEach((e=>{const t=new Dl(e,0),r=new Dl(e,Number.POSITIVE_INFINITY);this.Mr.forEachInRange([t,r],(e=>{n=n.add(e.Cr)}))})),kn.resolve(this.Br(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let a=n;hn.isDocumentKey(a)||(a=a.child(""));const i=new Dl(new hn(a),0);let s=new la(Xt);return this.Mr.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(s=s.add(e.Cr)),!0)}),i),kn.resolve(this.Br(s))}Br(e){const t=[];return e.forEach((e=>{const n=this.Or(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){Pt(0===this.Lr(t.batchId,"removed")),this.mutationQueue.shift();let n=this.Mr;return kn.forEach(t.mutations,(r=>{const a=new Dl(r.key,t.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Mr=n}))}qn(e){}containsKey(e,t){const n=new Dl(t,0),r=this.Mr.firstAfterOrEqual(n);return kn.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,kn.resolve()}Lr(e,t){return this.Nr(e)}Nr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Or(e){const t=this.Nr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Ll{constructor(e){this.kr=e,this.docs=new sa(hn.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),a=r?r.size:0,i=this.kr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:i}),this.size+=i-a,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return kn.resolve(n?n.document.mutableCopy():si.newInvalidDocument(t))}getEntries(e,t){let n=as();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():si.newInvalidDocument(e))})),kn.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let a=as();const i=t.path,s=new hn(i.child("__id-9223372036854775808__")),o=this.docs.getIteratorFrom(s);for(;o.hasNext();){const{key:e,value:{document:s}}=o.getNext();if(!i.isPrefixOf(e.path))break;e.path.length>i.length+1||Tn(wn(s),n)<=0||(r.has(s.key)||Ji(t,s))&&(a=a.insert(s.key,s.mutableCopy()))}return kn.resolve(a)}getAllFromCollectionGroup(e,t,n,r){Dt()}qr(e,t){return kn.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new Ml(this)}getSize(e){return kn.resolve(this.size)}}class Ml extends yl{constructor(e){super(),this.Ir=e}applyChanges(e){const t=[];return this.changes.forEach(((n,r)=>{r.isValidDocument()?t.push(this.Ir.addEntry(e,r)):this.Ir.removeEntry(n)})),kn.waitFor(t)}getFromCache(e,t){return this.Ir.getEntry(e,t)}getAllFromCache(e,t){return this.Ir.getEntries(e,t)}}class Fl{constructor(e){this.persistence=e,this.Qr=new ns((e=>Di(e)),Pi),this.lastRemoteSnapshotVersion=sn.min(),this.highestTargetId=0,this.$r=0,this.Ur=new Ol,this.targetCount=0,this.Kr=al.Un()}forEachTarget(e,t){return this.Qr.forEach(((e,n)=>t(n))),kn.resolve()}getLastRemoteSnapshotVersion(e){return kn.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return kn.resolve(this.$r)}allocateTargetId(e){return this.highestTargetId=this.Kr.next(),kn.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.$r&&(this.$r=t),kn.resolve()}zn(e){this.Qr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Kr=new al(t),this.highestTargetId=t),e.sequenceNumber>this.$r&&(this.$r=e.sequenceNumber)}addTargetData(e,t){return this.zn(t),this.targetCount+=1,kn.resolve()}updateTargetData(e,t){return this.zn(t),kn.resolve()}removeTargetData(e,t){return this.Qr.delete(t.target),this.Ur.br(t.targetId),this.targetCount-=1,kn.resolve()}removeTargets(e,t,n){let r=0;const a=[];return this.Qr.forEach(((i,s)=>{s.sequenceNumber<=t&&null===n.get(s.targetId)&&(this.Qr.delete(i),a.push(this.removeMatchingKeysForTargetId(e,s.targetId)),r++)})),kn.waitFor(a).next((()=>r))}getTargetCount(e){return kn.resolve(this.targetCount)}getTargetData(e,t){const n=this.Qr.get(t)||null;return kn.resolve(n)}addMatchingKeys(e,t,n){return this.Ur.yr(t,n),kn.resolve()}removeMatchingKeys(e,t,n){this.Ur.Sr(t,n);const r=this.persistence.referenceDelegate,a=[];return r&&t.forEach((t=>{a.push(r.markPotentiallyOrphaned(e,t))})),kn.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this.Ur.br(t),kn.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Ur.vr(t);return kn.resolve(n)}containsKey(e,t){return kn.resolve(this.Ur.containsKey(t))}}class zl{constructor(e,t){this.Wr={},this.overlays={},this.Gr=new Bn(0),this.zr=!1,this.zr=!0,this.jr=new Rl,this.referenceDelegate=e(this),this.Hr=new Fl(this),this.indexManager=new zc,this.remoteDocumentCache=function(e){return new Ll(e)}((e=>this.referenceDelegate.Jr(e))),this.serializer=new Zo(t),this.Yr=new Al(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.zr=!1,Promise.resolve()}get started(){return this.zr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Nl,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.Wr[e.toKey()];return n||(n=new Pl(t,this.referenceDelegate),this.Wr[e.toKey()]=n),n}getGlobalsCache(){return this.jr}getTargetCache(){return this.Hr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Yr}runTransaction(e,t,n){At("MemoryPersistence","Starting transaction:",e);const r=new jl(this.Gr.next());return this.referenceDelegate.Zr(),n(r).next((e=>this.referenceDelegate.Xr(r).next((()=>e)))).toPromise().then((e=>(r.raiseOnCommittedEvent(),e)))}ei(e,t){return kn.or(Object.values(this.Wr).map((n=>()=>n.containsKey(e,t))))}}class jl extends Sn{constructor(e){super(),this.currentSequenceNumber=e}}class Ul{constructor(e){this.persistence=e,this.ti=new Ol,this.ni=null}static ri(e){return new Ul(e)}get ii(){if(this.ni)return this.ni;throw Dt()}addReference(e,t,n){return this.ti.addReference(n,t),this.ii.delete(n.toString()),kn.resolve()}removeReference(e,t,n){return this.ti.removeReference(n,t),this.ii.add(n.toString()),kn.resolve()}markPotentiallyOrphaned(e,t){return this.ii.add(t.toString()),kn.resolve()}removeTarget(e,t){this.ti.br(t.targetId).forEach((e=>this.ii.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.ii.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}Zr(){this.ni=new Set}Xr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return kn.forEach(this.ii,(n=>{const r=hn.fromPath(n);return this.si(e,r).next((e=>{e||t.removeEntry(r,sn.min())}))})).next((()=>(this.ni=null,t.apply(e))))}updateLimboDocument(e,t){return this.si(e,t).next((e=>{e?this.ii.delete(t.toString()):this.ii.add(t.toString())}))}Jr(e){return 0}si(e,t){return kn.or([()=>kn.resolve(this.ti.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.ei(e,t)])}}class Bl{constructor(e,t){this.persistence=e,this.oi=new ns((e=>Kn(e.path)),((e,t)=>e.isEqual(t))),this.garbageCollector=gl(this,t)}static ri(e,t){return new Bl(e,t)}Zr(){}Xr(e){return kn.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}nr(e){const t=this.sr(e);return this.persistence.getTargetCache().getTargetCount(e).next((e=>t.next((t=>e+t))))}sr(e){let t=0;return this.rr(e,(e=>{t++})).next((()=>t))}rr(e,t){return kn.forEach(this.oi,((n,r)=>this.ar(e,n,r).next((e=>e?kn.resolve():t(r)))))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const r=this.persistence.getRemoteDocumentCache(),a=r.newChangeBuffer();return r.qr(e,(r=>this.ar(e,r,t).next((e=>{e||(n++,a.removeEntry(r,sn.min()))})))).next((()=>a.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,t){return this.oi.set(t,e.currentSequenceNumber),kn.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.oi.set(n,e.currentSequenceNumber),kn.resolve()}removeReference(e,t,n){return this.oi.set(n,e.currentSequenceNumber),kn.resolve()}updateLimboDocument(e,t){return this.oi.set(t,e.currentSequenceNumber),kn.resolve()}Jr(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=$a(e.data.value)),t}ar(e,t,n){return kn.or([()=>this.persistence.ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const e=this.oi.get(t);return kn.resolve(void 0!==e&&e>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Vl{constructor(e){this.serializer=e}B(e,t,n,r){const a=new Cn("createOrUpgrade",t);n<1&&r>=1&&(function(e){e.createObjectStore(Jn)}(e),function(e){e.createObjectStore(er,{keyPath:"userId"});e.createObjectStore(tr,{keyPath:nr,autoIncrement:!0}).createIndex(rr,ar,{unique:!0}),e.createObjectStore(cr)}(e),$l(e),function(e){e.createObjectStore(Qn)}(e));let i=kn.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore(wr),e.deleteObjectStore(vr),e.deleteObjectStore(Ir)}(e),$l(e)),i=i.next((()=>function(e){const t=e.store(Ir),n={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:sn.min().toTimestamp(),targetCount:0};return t.put(Sr,n)}(a)))),n<4&&r>=4&&(0!==n&&(i=i.next((()=>function(e,t){return t.store(tr).G().next((n=>{e.deleteObjectStore(tr),e.createObjectStore(tr,{keyPath:nr,autoIncrement:!0}).createIndex(rr,ar,{unique:!0});const r=t.store(tr),a=n.map((e=>r.put(e)));return kn.waitFor(a)}))}(e,a)))),i=i.next((()=>{!function(e){e.createObjectStore(Cr,{keyPath:"clientId"})}(e)}))),n<5&&r>=5&&(i=i.next((()=>this._i(a)))),n<6&&r>=6&&(i=i.next((()=>(function(e){e.createObjectStore(gr)}(e),this.ai(a))))),n<7&&r>=7&&(i=i.next((()=>this.ui(a)))),n<8&&r>=8&&(i=i.next((()=>this.ci(e,a)))),n<9&&r>=9&&(i=i.next((()=>{!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e)}))),n<10&&r>=10&&(i=i.next((()=>this.li(a)))),n<11&&r>=11&&(i=i.next((()=>{!function(e){e.createObjectStore(Ar,{keyPath:"bundleId"})}(e),function(e){e.createObjectStore(Nr,{keyPath:"name"})}(e)}))),n<12&&r>=12&&(i=i.next((()=>{!function(e){const t=e.createObjectStore(Br,{keyPath:Vr});t.createIndex($r,Hr,{unique:!1}),t.createIndex(Wr,Gr,{unique:!1})}(e)}))),n<13&&r>=13&&(i=i.next((()=>function(e){const t=e.createObjectStore(lr,{keyPath:ur});t.createIndex(dr,hr),t.createIndex(fr,pr)}(e))).next((()=>this.hi(e,a))).next((()=>e.deleteObjectStore(Qn)))),n<14&&r>=14&&(i=i.next((()=>this.Pi(e,a)))),n<15&&r>=15&&(i=i.next((()=>function(e){e.createObjectStore(Rr,{keyPath:"indexId",autoIncrement:!0}).createIndex(Or,"collectionGroup",{unique:!1});e.createObjectStore(Dr,{keyPath:Pr}).createIndex(Lr,Mr,{unique:!1});e.createObjectStore(Fr,{keyPath:zr}).createIndex(jr,Ur,{unique:!1})}(e)))),n<16&&r>=16&&(i=i.next((()=>{t.objectStore(Dr).clear()})).next((()=>{t.objectStore(Fr).clear()}))),n<17&&r>=17&&(i=i.next((()=>{!function(e){e.createObjectStore(Kr,{keyPath:"name"})}(e)}))),i}ai(e){let t=0;return e.store(Qn).Z(((e,n)=>{t+=Jc(n)})).next((()=>{const n={byteSize:t};return e.store(gr).put(mr,n)}))}_i(e){const t=e.store(er),n=e.store(tr);return t.G().next((t=>kn.forEach(t,(t=>{const r=IDBKeyRange.bound([t.userId,Vn],[t.userId,t.lastAcknowledgedBatchId]);return n.G(rr,r).next((n=>kn.forEach(n,(n=>{Pt(n.userId===t.userId);const r=ac(this.serializer,n);return Qc(e,t.userId,r).next((()=>{}))}))))}))))}ui(e){const t=e.store(wr),n=e.store(Qn);return e.store(Ir).get(Sr).next((e=>{const r=[];return n.Z(((n,a)=>{const i=new ln(n),s=function(e){return[0,Kn(e)]}(i);r.push(t.get(s).next((n=>n?kn.resolve():(n=>t.put({targetId:0,path:Kn(n),sequenceNumber:e.highestListenSequenceNumber}))(i))))})).next((()=>kn.waitFor(r)))}))}ci(e,t){e.createObjectStore(kr,{keyPath:_r});const n=t.store(kr),r=new jc,a=e=>{if(r.add(e)){const t=e.lastSegment(),r=e.popLast();return n.put({collectionId:t,parent:Kn(r)})}};return t.store(Qn).Z({Y:!0},((e,t)=>{const n=new ln(e);return a(n.popLast())})).next((()=>t.store(cr).Z({Y:!0},((e,t)=>{let[n,r,i]=e;const s=Xn(r);return a(s.popLast())}))))}li(e){const t=e.store(vr);return t.Z(((e,n)=>{const r=ic(n),a=sc(this.serializer,r);return t.put(a)}))}hi(e,t){const n=t.store(Qn),r=[];return n.Z(((e,n)=>{const a=t.store(lr),i=function(e){return e.document?new hn(ln.fromString(e.document.name).popFirst(5)):e.noDocument?hn.fromSegments(e.noDocument.path):e.unknownDocument?hn.fromSegments(e.unknownDocument.path):Dt()}(n).path.toArray(),s={prefixPath:i.slice(0,i.length-2),collectionGroup:i[i.length-2],documentId:i[i.length-1],readTime:n.readTime||[0,0],unknownDocument:n.unknownDocument,noDocument:n.noDocument,document:n.document,hasCommittedMutations:!!n.hasCommittedMutations};r.push(a.put(s))})).next((()=>kn.waitFor(r)))}Pi(e,t){const n=t.store(tr),r=wl(this.serializer),a=new zl(Ul.ri,this.serializer.Tt);return n.G().next((e=>{const n=new Map;return e.forEach((e=>{var t;let r=null!==(t=n.get(e.userId))&&void 0!==t?t:fs();ac(this.serializer,e).keys().forEach((e=>r=r.add(e))),n.set(e.userId,r)})),kn.forEach(n,((e,n)=>{const i=new It(n),s=pc.It(this.serializer,i),o=a.getIndexManager(i),c=Zc.It(i,this.serializer,o,a.referenceDelegate);return new Cl(r,c,s,o).recalculateAndSaveOverlaysForDocumentKeys(new ta(t,Bn.ae),e).next()}))}))}}function $l(e){e.createObjectStore(wr,{keyPath:Er}).createIndex(Tr,xr,{unique:!0}),e.createObjectStore(vr,{keyPath:"targetId"}).createIndex(yr,br,{unique:!0}),e.createObjectStore(Ir)}const Hl="IndexedDbPersistence",Wl=18e5,Gl=5e3,Kl="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",ql="main";class Yl{constructor(e,t,n,r,a,i,s,o,c,l){let u=arguments.length>10&&void 0!==arguments[10]?arguments[10]:17;if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.Ti=a,this.window=i,this.document=s,this.Ii=c,this.Ei=l,this.di=u,this.Gr=null,this.zr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ai=null,this.inForeground=!1,this.Ri=null,this.Vi=null,this.mi=Number.NEGATIVE_INFINITY,this.fi=e=>Promise.resolve(),!Yl.D())throw new Ft(Mt.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new ml(this,r),this.gi=t+ql,this.serializer=new Zo(o),this.pi=new An(this.gi,this.di,new Vl(this.serializer)),this.jr=new mc,this.Hr=new il(this.referenceDelegate,this.serializer),this.remoteDocumentCache=wl(this.serializer),this.Yr=new dc,this.window&&this.window.localStorage?this.yi=this.window.localStorage:(this.yi=null,!1===l&&Nt(Hl,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Ft(Mt.FAILED_PRECONDITION,Kl);return this.Si(),this.bi(),this.Di(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Hr.getHighestSequenceNumber(e)))})).then((e=>{this.Gr=new Bn(e,this.Ii)})).then((()=>{this.zr=!0})).catch((e=>(this.pi&&this.pi.close(),Promise.reject(e))))}Ci(e){return this.fi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.pi.k((async t=>{null===t.newVersion&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Ti.enqueueAndForget((async()=>{this.started&&await this.wi()})))}wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Ql(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Fi(e).next((e=>{e||(this.isPrimary=!1,this.Ti.enqueueRetryable((()=>this.fi(!1))))}))})).next((()=>this.Mi(e))).next((t=>this.isPrimary&&!t?this.xi(e).next((()=>!1)):!!t&&this.Oi(e).next((()=>!0)))))).catch((e=>{if(Dn(e))return At(Hl,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return At(Hl,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Ti.enqueueRetryable((()=>this.fi(e))),this.isPrimary=e}))}Fi(e){return Xl(e).get(Zn).next((e=>kn.resolve(this.Ni(e))))}Bi(e){return Ql(e).delete(this.clientId)}async Li(){if(this.isPrimary&&!this.ki(this.mi,Wl)){this.mi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(e=>{const t=na(e,Cr);return t.G().next((e=>{const n=this.qi(e,Wl),r=e.filter((e=>-1===n.indexOf(e)));return kn.forEach(r,(e=>t.delete(e.clientId))).next((()=>r))}))})).catch((()=>[]));if(this.yi)for(const t of e)this.yi.removeItem(this.Qi(t.clientId))}}Di(){this.Vi=this.Ti.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.wi().then((()=>this.Li())).then((()=>this.Di()))))}Ni(e){return!!e&&e.ownerId===this.clientId}Mi(e){return this.Ei?kn.resolve(!0):Xl(e).get(Zn).next((t=>{if(null!==t&&this.ki(t.leaseTimestampMs,Gl)&&!this.$i(t.ownerId)){if(this.Ni(t)&&this.networkEnabled)return!0;if(!this.Ni(t)){if(!t.allowTabSynchronization)throw new Ft(Mt.FAILED_PRECONDITION,Kl);return!1}}return!(!this.networkEnabled||!this.inForeground)||Ql(e).G().next((e=>void 0===this.qi(e,Gl).find((e=>{if(this.clientId!==e.clientId){const t=!this.networkEnabled&&e.networkEnabled,n=!this.inForeground&&e.inForeground,r=this.networkEnabled===e.networkEnabled;if(t||n&&r)return!0}return!1}))))})).next((e=>(this.isPrimary!==e&&At(Hl,`Client ${e?"is":"is not"} eligible for a primary lease.`),e)))}async shutdown(){this.zr=!1,this.Ui(),this.Vi&&(this.Vi.cancel(),this.Vi=null),this.Ki(),this.Wi(),await this.pi.runTransaction("shutdown","readwrite",[Jn,Cr],(e=>{const t=new ta(e,Bn.ae);return this.xi(t).next((()=>this.Bi(t)))})),this.pi.close(),this.Gi()}qi(e,t){return e.filter((e=>this.ki(e.updateTimeMs,t)&&!this.$i(e.clientId)))}zi(){return this.runTransaction("getActiveClients","readonly",(e=>Ql(e).G().next((e=>this.qi(e,Wl).map((e=>e.clientId))))))}get started(){return this.zr}getGlobalsCache(){return this.jr}getMutationQueue(e,t){return Zc.It(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Hr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Vc(e,this.serializer.Tt.databaseId)}getDocumentOverlayCache(e){return pc.It(this.serializer,e)}getBundleCache(){return this.Yr}runTransaction(e,t,n){At(Hl,"Starting transaction:",e);const r="readonly"===t?"readonly":"readwrite",a=function(e){return 17===e?ea:16===e?Zr:15===e?Jr:14===e?Qr:13===e?Xr:12===e?Yr:11===e?qr:void Dt()}(this.di);let i;return this.pi.runTransaction(e,r,a,(r=>(i=new ta(r,this.Gr?this.Gr.next():Bn.ae),"readwrite-primary"===t?this.Fi(i).next((e=>!!e||this.Mi(i))).next((t=>{if(!t)throw Nt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ti.enqueueRetryable((()=>this.fi(!1))),new Ft(Mt.FAILED_PRECONDITION,xn);return n(i)})).next((e=>this.Oi(i).next((()=>e)))):this.ji(i).next((()=>n(i)))))).then((e=>(i.raiseOnCommittedEvent(),e)))}ji(e){return Xl(e).get(Zn).next((e=>{if(null!==e&&this.ki(e.leaseTimestampMs,Gl)&&!this.$i(e.ownerId)&&!this.Ni(e)&&!(this.Ei||this.allowTabSynchronization&&e.allowTabSynchronization))throw new Ft(Mt.FAILED_PRECONDITION,Kl)}))}Oi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Xl(e).put(Zn,t)}static D(){return An.D()}xi(e){const t=Xl(e);return t.get(Zn).next((e=>this.Ni(e)?(At(Hl,"Releasing primary lease."),t.delete(Zn)):kn.resolve()))}ki(e,t){const n=Date.now();return!(e<n-t)&&(!(e>n)||(Nt(`Detected an update time that is in the future: ${e} > ${n}`),!1))}Si(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ri=()=>{this.Ti.enqueueAndForget((()=>(this.inForeground="visible"===this.document.visibilityState,this.wi())))},this.document.addEventListener("visibilitychange",this.Ri),this.inForeground="visible"===this.document.visibilityState)}Ki(){this.Ri&&(this.document.removeEventListener("visibilitychange",this.Ri),this.Ri=null)}bi(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Ai=()=>{this.Ui();const e=/(?:Version|Mobile)\/1[456]/;y()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Ti.enterRestrictedMode(!0),this.Ti.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Ai))}Wi(){this.Ai&&(this.window.removeEventListener("pagehide",this.Ai),this.Ai=null)}$i(e){var t;try{const n=null!==(null===(t=this.yi)||void 0===t?void 0:t.getItem(this.Qi(e)));return At(Hl,`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(e){return Nt(Hl,"Failed to get zombied client id.",e),!1}}Ui(){if(this.yi)try{this.yi.setItem(this.Qi(this.clientId),String(Date.now()))}catch(e){Nt("Failed to set zombie client id.",e)}}Gi(){if(this.yi)try{this.yi.removeItem(this.Qi(this.clientId))}catch(e){}}Qi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Xl(e){return na(e,Jn)}function Ql(e){return na(e,Cr)}function Jl(e,t){let n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}class Zl{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Hi=n,this.Ji=r}static Yi(e,t){let n=fs(),r=fs();for(const a of t.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:r=r.add(a.doc.key)}return new Zl(e,t.fromCache,n,r)}}class eu{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class tu{constructor(){this.Zi=!1,this.Xi=!1,this.es=100,this.ts=y()?8:Nn(m())>0?6:4}initialize(e,t){this.ns=e,this.indexManager=t,this.Zi=!0}getDocumentsMatchingQuery(e,t,n,r){const a={result:null};return this.rs(e,t).next((e=>{a.result=e})).next((()=>{if(!a.result)return this.ss(e,t,r,n).next((e=>{a.result=e}))})).next((()=>{if(a.result)return;const n=new eu;return this._s(e,t,n).next((r=>{if(a.result=r,this.Xi)return this.us(e,t,n,r.size)}))})).next((()=>a.result))}us(e,t,n,r){return n.documentReadCount<this.es?(Ct()<=z.DEBUG&&At("QueryEngine","SDK will not create cache indexes for query:",Qi(t),"since it only creates cache indexes for collection contains","more than or equal to",this.es,"documents"),kn.resolve()):(Ct()<=z.DEBUG&&At("QueryEngine","Query:",Qi(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.ts*r?(Ct()<=z.DEBUG&&At("QueryEngine","The SDK decides to create cache indexes for query:",Qi(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Wi(t))):kn.resolve())}rs(e,t){if(Vi(t))return kn.resolve(null);let n=Wi(t);return this.indexManager.getIndexType(e,n).next((r=>0===r?null:(null!==t.limit&&1===r&&(t=qi(t,null,"F"),n=Wi(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((r=>{const a=fs(...r);return this.ns.getDocuments(e,a).next((r=>this.indexManager.getMinOffset(e,n).next((n=>{const i=this.cs(t,r);return this.ls(t,i,a,n.readTime)?this.rs(e,qi(t,null,"F")):this.hs(e,i,t,n)}))))})))))}ss(e,t,n,r){return Vi(t)||r.isEqual(sn.min())?kn.resolve(null):this.ns.getDocuments(e,n).next((a=>{const i=this.cs(t,a);return this.ls(t,i,n,r)?kn.resolve(null):(Ct()<=z.DEBUG&&At("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Qi(t)),this.hs(e,i,t,bn(r,fn)).next((e=>e)))}))}cs(e,t){let n=new la(es(e));return t.forEach(((t,r)=>{Ji(e,r)&&(n=n.add(r))})),n}ls(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const a="F"===e.limitType?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(r)>0)}_s(e,t,n){return Ct()<=z.DEBUG&&At("QueryEngine","Using full collection scan to execute query:",Qi(t)),this.ns.getDocumentsMatchingQuery(e,t,En.min(),n)}hs(e,t,n,r){return this.ns.getDocumentsMatchingQuery(e,n,r).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}const nu="LocalStore";class ru{constructor(e,t,n,r){this.persistence=e,this.Ps=t,this.serializer=r,this.Ts=new sa(Xt),this.Is=new ns((e=>Di(e)),Pi),this.Es=new Map,this.ds=e.getRemoteDocumentCache(),this.Hr=e.getTargetCache(),this.Yr=e.getBundleCache(),this.As(n)}As(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Cl(this.ds,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ds.setIndexManager(this.indexManager),this.Ps.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ts)))}}function au(e,t,n,r){return new ru(e,t,n,r)}async function iu(e,t){const n=Lt(e);return await n.persistence.runTransaction("Handle user change","readonly",(e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next((a=>(r=a,n.As(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{const a=[],i=[];let s=fs();for(const e of r){a.push(e.batchId);for(const t of e.mutations)s=s.add(t.key)}for(const e of t){i.push(e.batchId);for(const t of e.mutations)s=s.add(t.key)}return n.localDocuments.getDocuments(e,s).next((e=>({Rs:e,removedBatchIds:a,addedBatchIds:i})))}))}))}function su(e){const t=Lt(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Hr.getLastRemoteSnapshotVersion(e)))}function ou(e,t,n){let r=fs(),a=fs();return n.forEach((e=>r=r.add(e))),t.getEntries(e,r).next((e=>{let r=as();return n.forEach(((n,i)=>{const s=e.get(n);i.isFoundDocument()!==s.isFoundDocument()&&(a=a.add(n)),i.isNoDocument()&&i.version.isEqual(sn.min())?(t.removeEntry(n,i.readTime),r=r.insert(n,i)):!s.isValidDocument()||i.version.compareTo(s.version)>0||0===i.version.compareTo(s.version)&&s.hasPendingWrites?(t.addEntry(i),r=r.insert(n,i)):At(nu,"Ignoring outdated watch update for ",n,". Current version:",s.version," Watch version:",i.version)})),{Vs:r,fs:a}}))}function cu(e,t){const n=Lt(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=Vn),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}function lu(e,t){const n=Lt(e);return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let r;return n.Hr.getTargetData(e,t).next((a=>a?(r=a,kn.resolve(r)):n.Hr.allocateTargetId(e).next((a=>(r=new Jo(t,a,"TargetPurposeListen",e.currentSequenceNumber),n.Hr.addTargetData(e,r).next((()=>r)))))))})).then((e=>{const r=n.Ts.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ts=n.Ts.insert(e.targetId,e),n.Is.set(t,e.targetId)),e}))}async function uu(e,t,n){const r=Lt(e),a=r.Ts.get(t),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,(e=>r.persistence.referenceDelegate.removeTarget(e,a)))}catch(e){if(!Dn(e))throw e;At(nu,`Failed to update sequence numbers for target ${t}: ${e}`)}r.Ts=r.Ts.remove(t),r.Is.delete(a.target)}function du(e,t,n){const r=Lt(e);let a=sn.min(),i=fs();return r.persistence.runTransaction("Execute query","readwrite",(e=>function(e,t,n){const r=Lt(e),a=r.Is.get(n);return void 0!==a?kn.resolve(r.Ts.get(a)):r.Hr.getTargetData(t,n)}(r,e,Wi(t)).next((t=>{if(t)return a=t.lastLimboFreeSnapshotVersion,r.Hr.getMatchingKeysForTargetId(e,t.targetId).next((e=>{i=e}))})).next((()=>r.Ps.getDocumentsMatchingQuery(e,t,n?a:sn.min(),n?i:fs()))).next((e=>(hu(r,Zi(t),e),{documents:e,gs:i})))))}function hu(e,t,n){let r=e.Es.get(t)||sn.min();n.forEach(((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.Es.set(t,r)}class fu{constructor(){this.activeTargetIds=gs()}Ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}vs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}bs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class pu{constructor(){this.ho=new fu,this.Po={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.ho.Ds(e),this.Po[e]||"not-current"}updateQueryState(e,t,n){this.Po[e]=t}removeLocalQueryTarget(e){this.ho.vs(e)}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){delete this.Po[e]}getAllActiveQueryTargets(){return this.ho.activeTargetIds}isActiveQueryTarget(e){return this.ho.activeTargetIds.has(e)}start(){return this.ho=new fu,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class gu{To(e){}shutdown(){}}const mu="ConnectivityMonitor";class vu{constructor(){this.Io=()=>this.Eo(),this.Ao=()=>this.Ro(),this.Vo=[],this.mo()}To(e){this.Vo.push(e)}shutdown(){window.removeEventListener("online",this.Io),window.removeEventListener("offline",this.Ao)}mo(){window.addEventListener("online",this.Io),window.addEventListener("offline",this.Ao)}Eo(){At(mu,"Network connectivity changed: AVAILABLE");for(const e of this.Vo)e(0)}Ro(){At(mu,"Network connectivity changed: UNAVAILABLE");for(const e of this.Vo)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let yu=null;function bu(){return null===yu?yu=268435456+Math.round(2147483648*Math.random()):yu++,"0x"+yu.toString(16)}const wu="RestConnection",Eu={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Tu{get fo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.po=t+"://"+e.host,this.yo=`projects/${n}/databases/${r}`,this.wo=this.databaseId.database===_a?`project_id=${n}`:`project_id=${n}&database_id=${r}`}So(e,t,n,r,a){const i=bu(),s=this.bo(e,t.toUriEncodedString());At(wu,`Sending RPC '${e}' ${i}:`,s,n);const o={"google-cloud-resource-prefix":this.yo,"x-goog-request-params":this.wo};return this.Do(o,r,a),this.vo(e,s,o,n).then((t=>(At(wu,`Received RPC '${e}' ${i}: `,t),t)),(t=>{throw Rt(wu,`RPC '${e}' ${i} failed with error: `,t,"url: ",s,"request:",n),t}))}Co(e,t,n,r,a,i){return this.So(e,t,n,r,a)}Do(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+kt,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}bo(e,t){const n=Eu[e];return`${this.po}/v1/${t}:${n}`}terminate(){}}class xu{constructor(e){this.Fo=e.Fo,this.Mo=e.Mo}xo(e){this.Oo=e}No(e){this.Bo=e}Lo(e){this.ko=e}onMessage(e){this.qo=e}close(){this.Mo()}send(e){this.Fo(e)}Qo(){this.Oo()}$o(){this.Bo()}Uo(e){this.ko(e)}Ko(e){this.qo(e)}}const Su="WebChannelConnection";class Iu extends Tu{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}vo(e,t,n,r){const a=bu();return new Promise(((i,s)=>{const o=new ft;o.setWithCredentials(!0),o.listenOnce(gt.COMPLETE,(()=>{try{switch(o.getLastErrorCode()){case mt.NO_ERROR:const t=o.getResponseJson();At(Su,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(t)),i(t);break;case mt.TIMEOUT:At(Su,`RPC '${e}' ${a} timed out`),s(new Ft(Mt.DEADLINE_EXCEEDED,"Request time out"));break;case mt.HTTP_ERROR:const n=o.getStatus();if(At(Su,`RPC '${e}' ${a} failed with status:`,n,"response text:",o.getResponseText()),n>0){let e=o.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(Mt).indexOf(t)>=0?t:Mt.UNKNOWN}(t.status);s(new Ft(e,t.message))}else s(new Ft(Mt.UNKNOWN,"Server responded with status "+o.getStatus()))}else s(new Ft(Mt.UNAVAILABLE,"Connection failed."));break;default:Dt()}}finally{At(Su,`RPC '${e}' ${a} completed.`)}}));const c=JSON.stringify(r);At(Su,`RPC '${e}' ${a} sending request:`,r),o.send(t,"POST",c,n,15)}))}Wo(e,t,n){const r=bu(),a=[this.po,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=wt(),s=bt(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;void 0!==c&&(o.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(o.useFetchStreams=!0),this.Do(o.initMessageHeaders,t,n),o.encodeInitMessageHeaders=!0;const l=a.join("");At(Su,`Creating RPC '${e}' stream ${r}: ${l}`,o);const u=i.createWebChannel(l,o);let d=!1,h=!1;const f=new xu({Fo:t=>{h?At(Su,`Not sending because RPC '${e}' stream ${r} is closed:`,t):(d||(At(Su,`Opening RPC '${e}' stream ${r} transport.`),u.open(),d=!0),At(Su,`RPC '${e}' stream ${r} sending:`,t),u.send(t))},Mo:()=>u.close()}),p=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return p(u,pt.EventType.OPEN,(()=>{h||(At(Su,`RPC '${e}' stream ${r} transport opened.`),f.Qo())})),p(u,pt.EventType.CLOSE,(()=>{h||(h=!0,At(Su,`RPC '${e}' stream ${r} transport closed`),f.Uo())})),p(u,pt.EventType.ERROR,(t=>{h||(h=!0,Rt(Su,`RPC '${e}' stream ${r} transport errored:`,t),f.Uo(new Ft(Mt.UNAVAILABLE,"The operation could not be completed")))})),p(u,pt.EventType.MESSAGE,(t=>{var n;if(!h){const a=t.data[0];Pt(!!a);const i=a,s=(null==i?void 0:i.error)||(null===(n=i[0])||void 0===n?void 0:n.error);if(s){At(Su,`RPC '${e}' stream ${r} received error:`,s);const t=s.status;let n=function(e){const t=Js[e];if(void 0!==t)return to(t)}(t),a=s.message;void 0===n&&(n=Mt.INTERNAL,a="Unknown error status: "+t+" with message "+s.message),h=!0,f.Uo(new Ft(n,a)),u.close()}else At(Su,`RPC '${e}' stream ${r} received:`,a),f.Ko(a)}})),p(s,yt.STAT_EVENT,(t=>{t.stat===vt.PROXY?At(Su,`RPC '${e}' stream ${r} detected buffering proxy`):t.stat===vt.NOPROXY&&At(Su,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{f.$o()}),0),f}}function ku(){return"undefined"!=typeof window?window:null}function _u(){return"undefined"!=typeof document?document:null}function Cu(e){return new Eo(e,!0)}class Au{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.Ti=e,this.timerId=t,this.Go=n,this.zo=r,this.jo=a,this.Ho=0,this.Jo=null,this.Yo=Date.now(),this.reset()}reset(){this.Ho=0}Zo(){this.Ho=this.jo}Xo(e){this.cancel();const t=Math.floor(this.Ho+this.e_()),n=Math.max(0,Date.now()-this.Yo),r=Math.max(0,t-n);r>0&&At("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Ho} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Jo=this.Ti.enqueueAfterDelay(this.timerId,r,(()=>(this.Yo=Date.now(),e()))),this.Ho*=this.zo,this.Ho<this.Go&&(this.Ho=this.Go),this.Ho>this.jo&&(this.Ho=this.jo)}t_(){null!==this.Jo&&(this.Jo.skipDelay(),this.Jo=null)}cancel(){null!==this.Jo&&(this.Jo.cancel(),this.Jo=null)}e_(){return(Math.random()-.5)*this.Ho}}const Nu="PersistentStream";class Ru{constructor(e,t,n,r,a,i,s,o){this.Ti=e,this.n_=n,this.r_=r,this.connection=a,this.authCredentialsProvider=i,this.appCheckCredentialsProvider=s,this.listener=o,this.state=0,this.i_=0,this.s_=null,this.o_=null,this.stream=null,this.__=0,this.a_=new Au(e,t)}u_(){return 1===this.state||5===this.state||this.c_()}c_(){return 2===this.state||3===this.state}start(){this.__=0,4!==this.state?this.auth():this.l_()}async stop(){this.u_()&&await this.close(0)}h_(){this.state=0,this.a_.reset()}P_(){this.c_()&&null===this.s_&&(this.s_=this.Ti.enqueueAfterDelay(this.n_,6e4,(()=>this.T_())))}I_(e){this.E_(),this.stream.send(e)}async T_(){if(this.c_())return this.close(0)}E_(){this.s_&&(this.s_.cancel(),this.s_=null)}d_(){this.o_&&(this.o_.cancel(),this.o_=null)}async close(e,t){this.E_(),this.d_(),this.a_.cancel(),this.i_++,4!==e?this.a_.reset():t&&t.code===Mt.RESOURCE_EXHAUSTED?(Nt(t.toString()),Nt("Using maximum backoff delay to prevent overloading the backend."),this.a_.Zo()):t&&t.code===Mt.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.A_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Lo(t)}A_(){}auth(){this.state=1;const e=this.R_(this.i_),t=this.i_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((e=>{let[n,r]=e;this.i_===t&&this.V_(n,r)}),(t=>{e((()=>{const e=new Ft(Mt.UNKNOWN,"Fetching auth token failed: "+t.message);return this.m_(e)}))}))}V_(e,t){const n=this.R_(this.i_);this.stream=this.f_(e,t),this.stream.xo((()=>{n((()=>this.listener.xo()))})),this.stream.No((()=>{n((()=>(this.state=2,this.o_=this.Ti.enqueueAfterDelay(this.r_,1e4,(()=>(this.c_()&&(this.state=3),Promise.resolve()))),this.listener.No())))})),this.stream.Lo((e=>{n((()=>this.m_(e)))})),this.stream.onMessage((e=>{n((()=>1==++this.__?this.g_(e):this.onNext(e)))}))}l_(){this.state=5,this.a_.Xo((async()=>{this.state=0,this.start()}))}m_(e){return At(Nu,`close with error: ${e}`),this.stream=null,this.close(4,e)}R_(e){return t=>{this.Ti.enqueueAndForget((()=>this.i_===e?t():(At(Nu,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Ou extends Ru{constructor(e,t,n,r,a,i){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,i),this.serializer=a}f_(e,t){return this.connection.Wo("Listen",e,t)}g_(e){return this.onNext(e)}onNext(e){this.a_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:Dt()}(t.targetChange.targetChangeType||"NO_CHANGE"),a=t.targetChange.targetIds||[],i=function(e,t){return e.useProto3Json?(Pt(void 0===t||"string"==typeof t),pa.fromBase64String(t||"")):(Pt(void 0===t||t instanceof Buffer||t instanceof Uint8Array),pa.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),s=t.targetChange.cause,o=s&&function(e){const t=void 0===e.code?Mt.UNKNOWN:to(e.code);return new Ft(t,e.message||"")}(s);n=new fo(r,a,i,o||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const a=Ro(e,r.document.name),i=ko(r.document.updateTime),s=r.document.createTime?ko(r.document.createTime):sn.min(),o=new ai({mapValue:{fields:r.document.fields}}),c=si.newFoundDocument(a,i,s,o),l=r.targetIds||[],u=r.removedTargetIds||[];n=new uo(l,u,c.key,c)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const a=Ro(e,r.document),i=r.readTime?ko(r.readTime):sn.min(),s=si.newNoDocument(a,i),o=r.removedTargetIds||[];n=new uo([],o,s.key,s)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const a=Ro(e,r.document),i=r.removedTargetIds||[];n=new uo([],i,a,null)}else{if(!("filter"in t))return Dt();{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:a}=e,i=new Qs(r,a),s=e.targetId;n=new ho(s,i)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return sn.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?sn.min():t.readTime?ko(t.readTime):sn.min()}(e);return this.listener.p_(t,n)}y_(e){const t={};t.database=Po(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=Li(r)?{documents:Uo(e,r)}:{query:Bo(e,r).ht},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=So(e,t.resumeToken);const r=To(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(sn.min())>0){n.readTime=xo(e,t.snapshotVersion.toTimestamp());const r=To(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Dt()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.I_(t)}w_(e){const t={};t.database=Po(this.serializer),t.removeTarget=e,this.I_(t)}}class Du extends Ru{constructor(e,t,n,r,a,i){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,i),this.serializer=a}get S_(){return this.__>0}start(){this.lastStreamToken=void 0,super.start()}A_(){this.S_&&this.b_([])}f_(e,t){return this.connection.Wo("Write",e,t)}g_(e){return Pt(!!e.streamToken),this.lastStreamToken=e.streamToken,Pt(!e.writeResults||0===e.writeResults.length),this.listener.D_()}onNext(e){Pt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.a_.reset();const t=function(e,t){return e&&e.length>0?(Pt(void 0!==t),e.map((e=>function(e,t){let n=e.updateTime?ko(e.updateTime):ko(t);return n.isEqual(sn.min())&&(n=ko(t)),new Os(n,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),n=ko(e.commitTime);return this.listener.v_(n,t)}C_(){const e={};e.database=Po(this.serializer),this.I_(e)}b_(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>zo(this.serializer,e)))};this.I_(t)}}class Pu{}class Lu extends Pu{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.F_=!1}M_(){if(this.F_)throw new Ft(Mt.FAILED_PRECONDITION,"The client has already been terminated.")}So(e,t,n,r){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((a=>{let[i,s]=a;return this.connection.So(e,Co(t,n),r,i,s)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===Mt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Ft(Mt.UNKNOWN,e.toString())}))}Co(e,t,n,r,a){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((i=>{let[s,o]=i;return this.connection.Co(e,Co(t,n),r,s,o,a)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===Mt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Ft(Mt.UNKNOWN,e.toString())}))}terminate(){this.F_=!0,this.connection.terminate()}}class Mu{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.x_=0,this.O_=null,this.N_=!0}B_(){0===this.x_&&(this.L_("Unknown"),this.O_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.O_=null,this.k_("Backend didn't respond within 10 seconds."),this.L_("Offline"),Promise.resolve()))))}q_(e){"Online"===this.state?this.L_("Unknown"):(this.x_++,this.x_>=1&&(this.Q_(),this.k_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.L_("Offline")))}set(e){this.Q_(),this.x_=0,"Online"===e&&(this.N_=!1),this.L_(e)}L_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}k_(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.N_?(Nt(t),this.N_=!1):At("OnlineStateTracker",t)}Q_(){null!==this.O_&&(this.O_.cancel(),this.O_=null)}}const Fu="RemoteStore";class zu{constructor(e,t,n,r,a){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.U_=[],this.K_=new Map,this.W_=new Set,this.G_=[],this.z_=a,this.z_.To((e=>{n.enqueueAndForget((async()=>{Ku(this)&&(At(Fu,"Restarting streams for network reachability change."),await async function(e){const t=Lt(e);t.W_.add(4),await Uu(t),t.j_.set("Unknown"),t.W_.delete(4),await ju(t)}(this))}))})),this.j_=new Mu(n,r)}}async function ju(e){if(Ku(e))for(const t of e.G_)await t(!0)}async function Uu(e){for(const t of e.G_)await t(!1)}function Bu(e,t){const n=Lt(e);n.K_.has(t.targetId)||(n.K_.set(t.targetId,t),Gu(n)?Wu(n):hd(n).c_()&&$u(n,t))}function Vu(e,t){const n=Lt(e),r=hd(n);n.K_.delete(t),r.c_()&&Hu(n,t),0===n.K_.size&&(r.c_()?r.P_():Ku(n)&&n.j_.set("Unknown"))}function $u(e,t){if(e.H_.Ne(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(sn.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}hd(e).y_(t)}function Hu(e,t){e.H_.Ne(t),hd(e).w_(t)}function Wu(e){e.H_=new go({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),lt:t=>e.K_.get(t)||null,it:()=>e.datastore.serializer.databaseId}),hd(e).start(),e.j_.B_()}function Gu(e){return Ku(e)&&!hd(e).u_()&&e.K_.size>0}function Ku(e){return 0===Lt(e).W_.size}function qu(e){e.H_=void 0}async function Yu(e){e.j_.set("Online")}async function Xu(e){e.K_.forEach(((t,n)=>{$u(e,t)}))}async function Qu(e,t){qu(e),Gu(e)?(e.j_.q_(t),Wu(e)):e.j_.set("Unknown")}async function Ju(e,t,n){if(e.j_.set("Online"),t instanceof fo&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.K_.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.K_.delete(r),e.H_.removeTarget(r))}(e,t)}catch(n){At(Fu,"Failed to remove targets %s: %s ",t.targetIds.join(","),n),await Zu(e,n)}else if(t instanceof uo?e.H_.We(t):t instanceof ho?e.H_.Ze(t):e.H_.je(t),!n.isEqual(sn.min()))try{const t=await su(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.H_.ot(t);return n.targetChanges.forEach(((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const a=e.K_.get(r);a&&e.K_.set(r,a.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach(((t,n)=>{const r=e.K_.get(t);if(!r)return;e.K_.set(t,r.withResumeToken(pa.EMPTY_BYTE_STRING,r.snapshotVersion)),Hu(e,t);const a=new Jo(r.target,t,n,r.sequenceNumber);$u(e,a)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){At(Fu,"Failed to raise snapshot:",t),await Zu(e,t)}}async function Zu(e,t,n){if(!Dn(t))throw t;e.W_.add(1),await Uu(e),e.j_.set("Offline"),n||(n=()=>su(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{At(Fu,"Retrying IndexedDB access"),await n(),e.W_.delete(1),await ju(e)}))}function ed(e,t){return t().catch((n=>Zu(e,n,t)))}async function td(e){const t=Lt(e),n=fd(t);let r=t.U_.length>0?t.U_[t.U_.length-1].batchId:Vn;for(;nd(t);)try{const e=await cu(t.localStore,r);if(null===e){0===t.U_.length&&n.P_();break}r=e.batchId,rd(t,e)}catch(e){await Zu(t,e)}ad(t)&&id(t)}function nd(e){return Ku(e)&&e.U_.length<10}function rd(e,t){e.U_.push(t);const n=fd(e);n.c_()&&n.S_&&n.b_(t.mutations)}function ad(e){return Ku(e)&&!fd(e).u_()&&e.U_.length>0}function id(e){fd(e).start()}async function sd(e){fd(e).C_()}async function od(e){const t=fd(e);for(const n of e.U_)t.b_(n.mutations)}async function cd(e,t,n){const r=e.U_.shift(),a=Ys.from(r,t,n);await ed(e,(()=>e.remoteSyncer.applySuccessfulWrite(a))),await td(e)}async function ld(e,t){t&&fd(e).S_&&await async function(e,t){if(function(e){return eo(e)&&e!==Mt.ABORTED}(t.code)){const n=e.U_.shift();fd(e).h_(),await ed(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await td(e)}}(e,t),ad(e)&&id(e)}async function ud(e,t){const n=Lt(e);n.asyncQueue.verifyOperationInProgress(),At(Fu,"RemoteStore received new credentials");const r=Ku(n);n.W_.add(3),await Uu(n),r&&n.j_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.W_.delete(3),await ju(n)}async function dd(e,t){const n=Lt(e);t?(n.W_.delete(2),await ju(n)):t||(n.W_.add(2),await Uu(n),n.j_.set("Unknown"))}function hd(e){return e.J_||(e.J_=function(e,t,n){const r=Lt(e);return r.M_(),new Ou(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{xo:Yu.bind(null,e),No:Xu.bind(null,e),Lo:Qu.bind(null,e),p_:Ju.bind(null,e)}),e.G_.push((async t=>{t?(e.J_.h_(),Gu(e)?Wu(e):e.j_.set("Unknown")):(await e.J_.stop(),qu(e))}))),e.J_}function fd(e){return e.Y_||(e.Y_=function(e,t,n){const r=Lt(e);return r.M_(),new Du(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{xo:()=>Promise.resolve(),No:sd.bind(null,e),Lo:ld.bind(null,e),D_:od.bind(null,e),v_:cd.bind(null,e)}),e.G_.push((async t=>{t?(e.Y_.h_(),await td(e)):(await e.Y_.stop(),e.U_.length>0&&(At(Fu,`Stopping write stream with ${e.U_.length} pending writes`),e.U_=[]))}))),e.Y_}class pd{constructor(e,t,n,r,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=a,this.deferred=new zt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,a){const i=Date.now()+n,s=new pd(e,t,i,r,a);return s.start(n),s}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Ft(Mt.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function gd(e,t){if(Nt("AsyncQueue",`${t}: ${e}`),Dn(e))return new Ft(Mt.UNAVAILABLE,`${t}: ${e}`);throw e}class md{static emptySet(e){return new md(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||hn.comparator(t.key,n.key):(e,t)=>hn.comparator(e.key,t.key),this.keyedMap=ss(),this.sortedSet=new sa(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof md))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new md;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class vd{constructor(){this.Z_=new sa(hn.comparator)}track(e){const t=e.doc.key,n=this.Z_.get(t);n?0!==e.type&&3===n.type?this.Z_=this.Z_.insert(t,e):3===e.type&&1!==n.type?this.Z_=this.Z_.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Z_=this.Z_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Z_=this.Z_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Z_=this.Z_.remove(t):1===e.type&&2===n.type?this.Z_=this.Z_.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Z_=this.Z_.insert(t,{type:2,doc:e.doc}):Dt():this.Z_=this.Z_.insert(t,e)}X_(){const e=[];return this.Z_.inorderTraversal(((t,n)=>{e.push(n)})),e}}class yd{constructor(e,t,n,r,a,i,s,o,c){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=a,this.fromCache=i,this.syncStateChanged=s,this.excludesMetadataChanges=o,this.hasCachedResults=c}static fromInitialDocuments(e,t,n,r,a){const i=[];return t.forEach((e=>{i.push({type:0,doc:e})})),new yd(e,t,md.emptySet(t),i,n,r,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Yi(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class bd{constructor(){this.ea=void 0,this.ta=[]}na(){return this.ta.some((e=>e.ra()))}}class wd{constructor(){this.queries=Ed(),this.onlineState="Unknown",this.ia=new Set}terminate(){!function(e,t){const n=Lt(e),r=n.queries;n.queries=Ed(),r.forEach(((e,n)=>{for(const r of n.ta)r.onError(t)}))}(this,new Ft(Mt.ABORTED,"Firestore shutting down"))}}function Ed(){return new ns((e=>Xi(e)),Yi)}async function Td(e,t){const n=Lt(e);let r=3;const a=t.query;let i=n.queries.get(a);i?!i.na()&&t.ra()&&(r=2):(i=new bd,r=t.ra()?0:1);try{switch(r){case 0:i.ea=await n.onListen(a,!0);break;case 1:i.ea=await n.onListen(a,!1);break;case 2:await n.onFirstRemoteStoreListen(a)}}catch(e){const n=gd(e,`Initialization of query '${Qi(t.query)}' failed`);return void t.onError(n)}n.queries.set(a,i),i.ta.push(t),t.sa(n.onlineState),i.ea&&t.oa(i.ea)&&kd(n)}async function xd(e,t){const n=Lt(e),r=t.query;let a=3;const i=n.queries.get(r);if(i){const e=i.ta.indexOf(t);e>=0&&(i.ta.splice(e,1),0===i.ta.length?a=t.ra()?0:1:!i.na()&&t.ra()&&(a=2))}switch(a){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Sd(e,t){const n=Lt(e);let r=!1;for(const a of t){const e=a.query,t=n.queries.get(e);if(t){for(const e of t.ta)e.oa(a)&&(r=!0);t.ea=a}}r&&kd(n)}function Id(e,t,n){const r=Lt(e),a=r.queries.get(t);if(a)for(const i of a.ta)i.onError(n);r.queries.delete(t)}function kd(e){e.ia.forEach((e=>{e.next()}))}var _d,Cd;(Cd=_d||(_d={}))._a="default",Cd.Cache="cache";class Ad{constructor(e,t,n){this.query=e,this.aa=t,this.ua=!1,this.ca=null,this.onlineState="Unknown",this.options=n||{}}oa(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new yd(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.ua?this.la(e)&&(this.aa.next(e),t=!0):this.ha(e,this.onlineState)&&(this.Pa(e),t=!0),this.ca=e,t}onError(e){this.aa.error(e)}sa(e){this.onlineState=e;let t=!1;return this.ca&&!this.ua&&this.ha(this.ca,e)&&(this.Pa(this.ca),t=!0),t}ha(e,t){if(!e.fromCache)return!0;if(!this.ra())return!0;const n="Offline"!==t;return(!this.options.Ta||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}la(e){if(e.docChanges.length>0)return!0;const t=this.ca&&this.ca.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}Pa(e){e=yd.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ua=!0,this.aa.next(e)}ra(){return this.options.source!==_d.Cache}}class Nd{constructor(e){this.key=e}}class Rd{constructor(e){this.key=e}}class Od{constructor(e,t){this.query=e,this.fa=t,this.ga=null,this.hasCachedResults=!1,this.current=!1,this.pa=fs(),this.mutatedKeys=fs(),this.ya=es(e),this.wa=new md(this.ya)}get Sa(){return this.fa}ba(e,t){const n=t?t.Da:new vd,r=t?t.wa:this.wa;let a=t?t.mutatedKeys:this.mutatedKeys,i=r,s=!1;const o="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,c="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((e,t)=>{const l=r.get(e),u=Ji(this.query,t)?t:null,d=!!l&&this.mutatedKeys.has(l.key),h=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;l&&u?l.data.isEqual(u.data)?d!==h&&(n.track({type:3,doc:u}),f=!0):this.va(l,u)||(n.track({type:2,doc:u}),f=!0,(o&&this.ya(u,o)>0||c&&this.ya(u,c)<0)&&(s=!0)):!l&&u?(n.track({type:0,doc:u}),f=!0):l&&!u&&(n.track({type:1,doc:l}),f=!0,(o||c)&&(s=!0)),f&&(u?(i=i.add(u),a=h?a.add(e):a.delete(e)):(i=i.delete(e),a=a.delete(e)))})),null!==this.query.limit)for(;i.size>this.query.limit;){const e="F"===this.query.limitType?i.last():i.first();i=i.delete(e.key),a=a.delete(e.key),n.track({type:1,doc:e})}return{wa:i,Da:n,ls:s,mutatedKeys:a}}va(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const a=this.wa;this.wa=e.wa,this.mutatedKeys=e.mutatedKeys;const i=e.Da.X_();i.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Dt()}};return n(e)-n(t)}(e.type,t.type)||this.ya(e.doc,t.doc))),this.Ca(n),r=null!=r&&r;const s=t&&!r?this.Fa():[],o=0===this.pa.size&&this.current&&!r?1:0,c=o!==this.ga;return this.ga=o,0!==i.length||c?{snapshot:new yd(this.query,e.wa,a,i,e.mutatedKeys,0===o,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),Ma:s}:{Ma:s}}sa(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({wa:this.wa,Da:new vd,mutatedKeys:this.mutatedKeys,ls:!1},!1)):{Ma:[]}}xa(e){return!this.fa.has(e)&&!!this.wa.has(e)&&!this.wa.get(e).hasLocalMutations}Ca(e){e&&(e.addedDocuments.forEach((e=>this.fa=this.fa.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.fa=this.fa.delete(e))),this.current=e.current)}Fa(){if(!this.current)return[];const e=this.pa;this.pa=fs(),this.wa.forEach((e=>{this.xa(e.key)&&(this.pa=this.pa.add(e.key))}));const t=[];return e.forEach((e=>{this.pa.has(e)||t.push(new Rd(e))})),this.pa.forEach((n=>{e.has(n)||t.push(new Nd(n))})),t}Oa(e){this.fa=e.gs,this.pa=fs();const t=this.ba(e.documents);return this.applyChanges(t,!0)}Na(){return yd.fromInitialDocuments(this.query,this.wa,this.mutatedKeys,0===this.ga,this.hasCachedResults)}}const Dd="SyncEngine";class Pd{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Ld{constructor(e){this.key=e,this.Ba=!1}}class Md{constructor(e,t,n,r,a,i){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=a,this.maxConcurrentLimboResolutions=i,this.La={},this.ka=new ns((e=>Xi(e)),Yi),this.qa=new Map,this.Qa=new Set,this.$a=new sa(hn.comparator),this.Ua=new Map,this.Ka=new Ol,this.Wa={},this.Ga=new Map,this.za=al.Kn(),this.onlineState="Unknown",this.ja=void 0}get isPrimaryClient(){return!0===this.ja}}async function Fd(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=ah(e);let a;const i=r.ka.get(t);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),a=i.view.Na()):a=await jd(r,t,n,!0),a}async function zd(e,t){const n=ah(e);await jd(n,t,!0,!1)}async function jd(e,t,n,r){const a=await lu(e.localStore,Wi(t)),i=a.targetId,s=e.sharedClientState.addLocalQueryTarget(i,n);let o;return r&&(o=await Ud(e,t,i,"current"===s,a.resumeToken)),e.isPrimaryClient&&n&&Bu(e.remoteStore,a),o}async function Ud(e,t,n,r,a){e.Ha=(t,n,r)=>async function(e,t,n,r){let a=t.view.ba(n);a.ls&&(a=await du(e.localStore,t.query,!1).then((e=>{let{documents:n}=e;return t.view.ba(n,a)})));const i=r&&r.targetChanges.get(t.targetId),s=r&&null!=r.targetMismatches.get(t.targetId),o=t.view.applyChanges(a,e.isPrimaryClient,i,s);return Jd(e,t.targetId,o.Ma),o.snapshot}(e,t,n,r);const i=await du(e.localStore,t,!0),s=new Od(t,i.gs),o=s.ba(i.documents),c=lo.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,a),l=s.applyChanges(o,e.isPrimaryClient,c);Jd(e,n,l.Ma);const u=new Pd(t,n,s);return e.ka.set(t,u),e.qa.has(n)?e.qa.get(n).push(t):e.qa.set(n,[t]),l.snapshot}async function Bd(e,t,n){const r=Lt(e),a=r.ka.get(t),i=r.qa.get(a.targetId);if(i.length>1)return r.qa.set(a.targetId,i.filter((e=>!Yi(e,t)))),void r.ka.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(a.targetId),r.sharedClientState.isActiveQueryTarget(a.targetId)||await uu(r.localStore,a.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(a.targetId),n&&Vu(r.remoteStore,a.targetId),Xd(r,a.targetId)})).catch(In)):(Xd(r,a.targetId),await uu(r.localStore,a.targetId,!0))}async function Vd(e,t){const n=Lt(e),r=n.ka.get(t),a=n.qa.get(r.targetId);n.isPrimaryClient&&1===a.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Vu(n.remoteStore,r.targetId))}async function $d(e,t){const n=Lt(e);try{const e=await function(e,t){const n=Lt(e),r=t.snapshotVersion;let a=n.Ts;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const i=n.ds.newChangeBuffer({trackRemovals:!0});a=n.Ts;const s=[];t.targetChanges.forEach(((i,o)=>{const c=a.get(o);if(!c)return;s.push(n.Hr.removeMatchingKeys(e,i.removedDocuments,o).next((()=>n.Hr.addMatchingKeys(e,i.addedDocuments,o))));let l=c.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(o)?l=l.withResumeToken(pa.EMPTY_BYTE_STRING,sn.min()).withLastLimboFreeSnapshotVersion(sn.min()):i.resumeToken.approximateByteSize()>0&&(l=l.withResumeToken(i.resumeToken,r)),a=a.insert(o,l),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(c,l,i)&&s.push(n.Hr.updateTargetData(e,l))}));let o=as(),c=fs();if(t.documentUpdates.forEach((r=>{t.resolvedLimboDocuments.has(r)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),s.push(ou(e,i,t.documentUpdates).next((e=>{o=e.Vs,c=e.fs}))),!r.isEqual(sn.min())){const t=n.Hr.getLastRemoteSnapshotVersion(e).next((t=>n.Hr.setTargetsMetadata(e,e.currentSequenceNumber,r)));s.push(t)}return kn.waitFor(s).next((()=>i.apply(e))).next((()=>n.localDocuments.getLocalViewOfDocuments(e,o,c))).next((()=>o))})).then((e=>(n.Ts=a,e)))}(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const r=n.Ua.get(t);r&&(Pt(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.Ba=!0:e.modifiedDocuments.size>0?Pt(r.Ba):e.removedDocuments.size>0&&(Pt(r.Ba),r.Ba=!1))})),await th(n,e,t)}catch(e){await In(e)}}function Hd(e,t,n){const r=Lt(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.ka.forEach(((n,r)=>{const a=r.view.sa(t);a.snapshot&&e.push(a.snapshot)})),function(e,t){const n=Lt(e);n.onlineState=t;let r=!1;n.queries.forEach(((e,n)=>{for(const a of n.ta)a.sa(t)&&(r=!0)})),r&&kd(n)}(r.eventManager,t),e.length&&r.La.p_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function Wd(e,t,n){const r=Lt(e);r.sharedClientState.updateQueryState(t,"rejected",n);const a=r.Ua.get(t),i=a&&a.key;if(i){let e=new sa(hn.comparator);e=e.insert(i,si.newNoDocument(i,sn.min()));const n=fs().add(i),a=new co(sn.min(),new Map,new sa(Xt),e,n);await $d(r,a),r.$a=r.$a.remove(i),r.Ua.delete(t),eh(r)}else await uu(r.localStore,t,!1).then((()=>Xd(r,t,n))).catch(In)}async function Gd(e,t){const n=Lt(e),r=t.batch.batchId;try{const e=await function(e,t){const n=Lt(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const r=t.batch.keys(),a=n.ds.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const a=n.batch,i=a.keys();let s=kn.resolve();return i.forEach((e=>{s=s.next((()=>r.getEntry(t,e))).next((t=>{const i=n.docVersions.get(e);Pt(null!==i),t.version.compareTo(i)<0&&(a.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),s.next((()=>e.mutationQueue.removeMutationBatch(t,a)))}(n,e,t,a).next((()=>a.apply(e))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=fs();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t)))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(n.localStore,t);Yd(n,r,null),qd(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await th(n,e)}catch(e){await In(e)}}async function Kd(e,t,n){const r=Lt(e);try{const e=await function(e,t){const n=Lt(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next((t=>(Pt(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(r.localStore,t);Yd(r,t,n),qd(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await th(r,e)}catch(n){await In(n)}}function qd(e,t){(e.Ga.get(t)||[]).forEach((e=>{e.resolve()})),e.Ga.delete(t)}function Yd(e,t,n){const r=Lt(e);let a=r.Wa[r.currentUser.toKey()];if(a){const e=a.get(t);e&&(n?e.reject(n):e.resolve(),a=a.remove(t)),r.Wa[r.currentUser.toKey()]=a}}function Xd(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.qa.get(t))e.ka.delete(r),n&&e.La.Ja(r,n);e.qa.delete(t),e.isPrimaryClient&&e.Ka.br(t).forEach((t=>{e.Ka.containsKey(t)||Qd(e,t)}))}function Qd(e,t){e.Qa.delete(t.path.canonicalString());const n=e.$a.get(t);null!==n&&(Vu(e.remoteStore,n),e.$a=e.$a.remove(t),e.Ua.delete(n),eh(e))}function Jd(e,t,n){for(const r of n)r instanceof Nd?(e.Ka.addReference(r.key,t),Zd(e,r)):r instanceof Rd?(At(Dd,"Document no longer in limbo: "+r.key),e.Ka.removeReference(r.key,t),e.Ka.containsKey(r.key)||Qd(e,r.key)):Dt()}function Zd(e,t){const n=t.key,r=n.path.canonicalString();e.$a.get(n)||e.Qa.has(r)||(At(Dd,"New document in limbo: "+n),e.Qa.add(r),eh(e))}function eh(e){for(;e.Qa.size>0&&e.$a.size<e.maxConcurrentLimboResolutions;){const t=e.Qa.values().next().value;e.Qa.delete(t);const n=new hn(ln.fromString(t)),r=e.za.next();e.Ua.set(r,new Ld(n)),e.$a=e.$a.insert(n,r),Bu(e.remoteStore,new Jo(Wi(Bi(n.path)),r,"TargetPurposeLimboResolution",Bn.ae))}}async function th(e,t,n){const r=Lt(e),a=[],i=[],s=[];r.ka.isEmpty()||(r.ka.forEach(((e,o)=>{s.push(r.Ha(o,t,n).then((e=>{var t;if((e||n)&&r.isPrimaryClient){const a=e?!e.fromCache:null===(t=null==n?void 0:n.targetChanges.get(o.targetId))||void 0===t?void 0:t.current;r.sharedClientState.updateQueryState(o.targetId,a?"current":"not-current")}if(e){a.push(e);const t=Zl.Yi(o.targetId,e);i.push(t)}})))})),await Promise.all(s),r.La.p_(a),await async function(e,t){const n=Lt(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>kn.forEach(t,(t=>kn.forEach(t.Hi,(r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r))).next((()=>kn.forEach(t.Ji,(r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))))))}catch(e){if(!Dn(e))throw e;At(nu,"Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.Ts.get(e),r=t.snapshotVersion,a=t.withLastLimboFreeSnapshotVersion(r);n.Ts=n.Ts.insert(e,a)}}}(r.localStore,i))}async function nh(e,t){const n=Lt(e);if(!n.currentUser.isEqual(t)){At(Dd,"User change. New user:",t.toKey());const e=await iu(n.localStore,t);n.currentUser=t,function(e,t){e.Ga.forEach((e=>{e.forEach((e=>{e.reject(new Ft(Mt.CANCELLED,t))}))})),e.Ga.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await th(n,e.Rs)}}function rh(e,t){const n=Lt(e),r=n.Ua.get(t);if(r&&r.Ba)return fs().add(r.key);{let e=fs();const r=n.qa.get(t);if(!r)return e;for(const t of r){const r=n.ka.get(t);e=e.unionWith(r.view.Sa)}return e}}function ah(e){const t=Lt(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=$d.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=rh.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Wd.bind(null,t),t.La.p_=Sd.bind(null,t.eventManager),t.La.Ja=Id.bind(null,t.eventManager),t}function ih(e){const t=Lt(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Gd.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Kd.bind(null,t),t}class sh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Cu(e.databaseInfo.databaseId),this.sharedClientState=this.Za(e),this.persistence=this.Xa(e),await this.persistence.start(),this.localStore=this.eu(e),this.gcScheduler=this.tu(e,this.localStore),this.indexBackfillerScheduler=this.nu(e,this.localStore)}tu(e,t){return null}nu(e,t){return null}eu(e){return au(this.persistence,new tu,e.initialUser,this.serializer)}Xa(e){return new zl(Ul.ri,this.serializer)}Za(e){return new pu}async terminate(){var e,t;null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(t=this.indexBackfillerScheduler)||void 0===t||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}sh.provider={build:()=>new sh};class oh extends sh{constructor(e){super(),this.cacheSizeBytes=e}tu(e,t){Pt(this.persistence.referenceDelegate instanceof Bl);const n=this.persistence.referenceDelegate.garbageCollector;return new fl(n,e.asyncQueue,t)}Xa(e){const t=void 0!==this.cacheSizeBytes?Xc.withCacheSize(this.cacheSizeBytes):Xc.DEFAULT;return new zl((e=>Bl.ri(e,t)),this.serializer)}}class ch extends sh{constructor(e,t,n){super(),this.ru=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.ru.initialize(this,e),await ih(this.ru.syncEngine),await td(this.ru.remoteStore),await this.persistence.Ci((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}eu(e){return au(this.persistence,new tu,e.initialUser,this.serializer)}tu(e,t){const n=this.persistence.referenceDelegate.garbageCollector;return new fl(n,e.asyncQueue,t)}nu(e,t){const n=new Un(t,this.persistence);return new jn(e.asyncQueue,n)}Xa(e){const t=Jl(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?Xc.withCacheSize(this.cacheSizeBytes):Xc.DEFAULT;return new Yl(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,ku(),_u(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Za(e){return new pu}}class lh{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>Hd(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=nh.bind(null,this.syncEngine),await dd(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new wd}createDatastore(e){const t=Cu(e.databaseInfo.databaseId),n=function(e){return new Iu(e)}(e.databaseInfo);return function(e,t,n,r){return new Lu(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,a){return new zu(e,t,n,r,a)}(this.localStore,this.datastore,e.asyncQueue,(e=>Hd(this.syncEngine,e,0)),vu.D()?new vu:new gu)}createSyncEngine(e,t){return function(e,t,n,r,a,i,s){const o=new Md(e,t,n,r,a,i);return s&&(o.ja=!0),o}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=Lt(e);At(Fu,"RemoteStore shutting down."),t.W_.add(5),await Uu(t),t.z_.shutdown(),t.j_.set("Unknown")}(this.remoteStore),null===(e=this.datastore)||void 0===e||e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}lh.provider={build:()=>new lh};class uh{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.iu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.iu(this.observer.error,e):Nt("Uncaught Error in snapshot listener:",e.toString()))}su(){this.muted=!0}iu(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const dh="FirestoreClient";class hh{constructor(e,t,n,r,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=It.UNAUTHENTICATED,this.clientId=Yt.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,(async e=>{At(dh,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(At(dh,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new zt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=gd(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function fh(e,t){e.asyncQueue.verifyOperationInProgress(),At(dh,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener((async e=>{r.isEqual(e)||(await iu(t.localStore,e),r=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function ph(e,t){e.asyncQueue.verifyOperationInProgress();const n=await gh(e);At(dh,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener((e=>ud(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>ud(t.remoteStore,n))),e._onlineComponents=t}async function gh(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){At(dh,"Using user provided OfflineComponentProvider");try{await fh(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(e){return"FirebaseError"===e.name?e.code===Mt.FAILED_PRECONDITION||e.code===Mt.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;Rt("Error using user provided cache. Falling back to memory cache: "+n),await fh(e,new sh)}}else At(dh,"Using default OfflineComponentProvider"),await fh(e,new oh(void 0));return e._offlineComponents}async function mh(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(At(dh,"Using user provided OnlineComponentProvider"),await ph(e,e._uninitializedComponentsProvider._online)):(At(dh,"Using default OnlineComponentProvider"),await ph(e,new lh))),e._onlineComponents}function vh(e){return mh(e).then((e=>e.syncEngine))}async function yh(e){const t=await mh(e),n=t.eventManager;return n.onListen=Fd.bind(null,t.syncEngine),n.onUnlisten=Bd.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=zd.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=Vd.bind(null,t.syncEngine),n}function bh(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new zt;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,a){const i=new uh({next:n=>{i.su(),t.enqueueAndForget((()=>xd(e,s))),n.fromCache&&"server"===r.source?a.reject(new Ft(Mt.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):a.resolve(n)},error:e=>a.reject(e)}),s=new Ad(n,i,{includeMetadataChanges:!0,Ta:!0});return Td(e,s)}(await yh(e),e.asyncQueue,t,n,r))),r.promise}function wh(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const Eh=new Map;function Th(e,t,n){if(!n)throw new Ft(Mt.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function xh(e){if(!hn.isDocumentKey(e))throw new Ft(Mt.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function Sh(e){if(hn.isDocumentKey(e))throw new Ft(Mt.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function Ih(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":Dt()}function kh(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Ft(Mt.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Ih(e);throw new Ft(Mt.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function _h(e,t){if(t<=0)throw new Ft(Mt.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}const Ch="firestore.googleapis.com",Ah=!0;class Nh{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new Ft(Mt.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Ch,this.ssl=Ah}else this.host=e.host,this.ssl=null!==(t=e.ssl)&&void 0!==t?t:Ah;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=Yc;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<ul)throw new Ft(Mt.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new Ft(Mt.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=wh(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new Ft(Mt.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new Ft(Mt.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new Ft(Mt.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Rh{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Nh({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ft(Mt.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Ft(Mt.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Nh(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new Ut;switch(e.type){case"firstParty":return new Ht(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Ft(Mt.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Eh.get(e);t&&(At("ComponentProvider","Removing Datastore"),Eh.delete(e),t.terminate())}(this),Promise.resolve()}}function Oh(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var a;const i=(e=kh(e,Rh))._getSettings(),s=Object.assign(Object.assign({},i),{emulatorOptions:e._getEmulatorOptions()}),o=`${t}:${n}`;i.host!==Ch&&i.host!==o&&Rt("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l=Object.assign(Object.assign({},i),{host:o,ssl:!1,emulatorOptions:r});if(!S(l,s)&&(e._setSettings(l),r.mockUserToken)){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=It.MOCK_USER;else{t=function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,a=e.sub||e.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const i=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},e);return[c(JSON.stringify({alg:"none",type:"JWT"})),c(JSON.stringify(i)),""].join(".")}(r.mockUserToken,null===(a=e._app)||void 0===a?void 0:a.options.projectId);const i=r.mockUserToken.sub||r.mockUserToken.user_id;if(!i)throw new Ft(Mt.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new It(i)}e._authCredentials=new Bt(new jt(t,n))}}class Dh{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Dh(this.firestore,e,this._query)}}class Ph{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Lh(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ph(this.firestore,e,this._key)}}class Lh extends Dh{constructor(e,t,n){super(e,t,Bi(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ph(this.firestore,null,new hn(e))}withConverter(e){return new Lh(this.firestore,e,this._path)}}function Mh(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];if(e=O(e),Th("collection","path",t),e instanceof Rh){const n=ln.fromString(t,...r);return Sh(n),new Lh(e,null,n)}{if(!(e instanceof Ph||e instanceof Lh))throw new Ft(Mt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(ln.fromString(t,...r));return Sh(n),new Lh(e.firestore,null,n)}}function Fh(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];if(e=O(e),1===arguments.length&&(t=Yt.newId()),Th("doc","path",t),e instanceof Rh){const n=ln.fromString(t,...r);return xh(n),new Ph(e,null,new hn(n))}{if(!(e instanceof Ph||e instanceof Lh))throw new Ft(Mt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(ln.fromString(t,...r));return xh(n),new Ph(e.firestore,e instanceof Lh?e.converter:null,new hn(n))}}const zh="AsyncQueue";class jh{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Vu=[],this.mu=!1,this.fu=[],this.gu=null,this.pu=!1,this.yu=!1,this.wu=[],this.a_=new Au(this,"async_queue_retry"),this.Su=()=>{const e=_u();e&&At(zh,"Visibility state changed to "+e.visibilityState),this.a_.t_()},this.bu=e;const t=_u();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Su)}get isShuttingDown(){return this.mu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Du(),this.vu(e)}enterRestrictedMode(e){if(!this.mu){this.mu=!0,this.yu=e||!1;const t=_u();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Su)}}enqueue(e){if(this.Du(),this.mu)return new Promise((()=>{}));const t=new zt;return this.vu((()=>this.mu&&this.yu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Vu.push(e),this.Cu())))}async Cu(){if(0!==this.Vu.length){try{await this.Vu[0](),this.Vu.shift(),this.a_.reset()}catch(e){if(!Dn(e))throw e;At(zh,"Operation failed with retryable error: "+e)}this.Vu.length>0&&this.a_.Xo((()=>this.Cu()))}}vu(e){const t=this.bu.then((()=>(this.pu=!0,e().catch((e=>{this.gu=e,this.pu=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw Nt("INTERNAL UNHANDLED ERROR: ",t),e})).then((e=>(this.pu=!1,e))))));return this.bu=t,t}enqueueAfterDelay(e,t,n){this.Du(),this.wu.indexOf(e)>-1&&(t=0);const r=pd.createAndSchedule(this,e,t,n,(e=>this.Fu(e)));return this.fu.push(r),r}Du(){this.gu&&Dt()}verifyOperationInProgress(){}async Mu(){let e;do{e=this.bu,await e}while(e!==this.bu)}xu(e){for(const t of this.fu)if(t.timerId===e)return!0;return!1}Ou(e){return this.Mu().then((()=>{this.fu.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.fu)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Mu()}))}Nu(e){this.wu.push(e)}Fu(e){const t=this.fu.indexOf(e);this.fu.splice(t,1)}}function Uh(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const r of t)if(r in n&&"function"==typeof n[r])return!0;return!1}(e,["next","error","complete"])}class Bh extends Rh{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new jh,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new jh(e),this._firestoreClient=void 0,await e}}}function Vh(e){if(e._terminated)throw new Ft(Mt.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||$h(e),e._firestoreClient}function $h(e){var t,n,r;const a=e._freezeSettings(),i=function(e,t,n,r){return new ka(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,wh(r.experimentalLongPollingOptions),r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,a);e._componentsProvider||(null===(n=a.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=a.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),e._firestoreClient=new hh(e._authCredentials,e._appCheckCredentials,e._queue,i,e._componentsProvider&&function(e){const t=null==e?void 0:e._online.build();return{_offline:null==e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}function Hh(e,t,n){if((e=kh(e,Bh))._firestoreClient||e._terminated)throw new Ft(Mt.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(e._componentsProvider||e._getSettings().localCache)throw new Ft(Mt.FAILED_PRECONDITION,"SDK cache is already specified.");e._componentsProvider={_online:t,_offline:n},$h(e)}class Wh{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Wh(pa.fromBase64String(e))}catch(e){throw new Ft(Mt.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new Wh(pa.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Gh{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;++r)if(0===t[r].length)throw new Ft(Mt.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new dn(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Kh{constructor(e){this._methodName=e}}class qh{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ft(Mt.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ft(Mt.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Xt(this._lat,e._lat)||Xt(this._long,e._long)}}class Yh{constructor(e){this._values=(e||[]).map((e=>e))}toArray(){return this._values.map((e=>e))}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}}const Xh=/^__.*__$/;class Qh{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new Vs(e,this.data,this.fieldMask,t,this.fieldTransforms):new Bs(e,this.data,t,this.fieldTransforms)}}class Jh{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Vs(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Zh(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Dt()}}class ef{constructor(e,t,n,r,a,i){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===a&&this.Bu(),this.fieldTransforms=a||[],this.fieldMask=i||[]}get path(){return this.settings.path}get Lu(){return this.settings.Lu}ku(e){return new ef(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}qu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ku({path:n,Qu:!1});return r.$u(e),r}Uu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ku({path:n,Qu:!1});return r.Bu(),r}Ku(e){return this.ku({path:void 0,Qu:!0})}Wu(e){return vf(e,this.settings.methodName,this.settings.Gu||!1,this.path,this.settings.zu)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}Bu(){if(this.path)for(let e=0;e<this.path.length;e++)this.$u(this.path.get(e))}$u(e){if(0===e.length)throw this.Wu("Document fields must not be empty");if(Zh(this.Lu)&&Xh.test(e))throw this.Wu('Document fields cannot begin and end with "__"')}}class tf{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Cu(e)}ju(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new ef({Lu:e,methodName:t,zu:n,path:dn.emptyPath(),Qu:!1,Gu:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function nf(e){const t=e._freezeSettings(),n=Cu(e._databaseId);return new tf(e._databaseId,!!t.ignoreUndefinedProperties,n)}function rf(e,t,n,r,a){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const s=e.ju(i.merge||i.mergeFields?2:0,t,n,a);ff("Data must be an object, but it was:",s,r);const o=df(r,s);let c,l;if(i.merge)c=new ha(s.fieldMask),l=s.fieldTransforms;else if(i.mergeFields){const e=[];for(const r of i.mergeFields){const a=pf(t,r,n);if(!s.contains(a))throw new Ft(Mt.INVALID_ARGUMENT,`Field '${a}' is specified in your field mask but missing from your input data.`);yf(e,a)||e.push(a)}c=new ha(e),l=s.fieldTransforms.filter((e=>c.covers(e.field)))}else c=null,l=s.fieldTransforms;return new Qh(new ai(o),c,l)}class af extends Kh{_toFieldTransform(e){if(2!==e.Lu)throw 1===e.Lu?e.Wu(`${this._methodName}() can only appear at the top level of your update data`):e.Wu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof af}}class sf extends Kh{_toFieldTransform(e){return new Rs(e.path,new xs)}isEqual(e){return e instanceof sf}}function of(e,t,n,r){const a=e.ju(1,t,n);ff("Data must be an object, but it was:",a,r);const i=[],s=ai.empty();aa(r,((e,r)=>{const o=mf(t,e,n);r=O(r);const c=a.Uu(o);if(r instanceof af)i.push(o);else{const e=uf(r,c);null!=e&&(i.push(o),s.set(o,e))}}));const o=new ha(i);return new Jh(s,o,a.fieldTransforms)}function cf(e,t,n,r,a,i){const s=e.ju(1,t,n),o=[pf(t,r,n)],c=[a];if(i.length%2!=0)throw new Ft(Mt.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<i.length;h+=2)o.push(pf(t,i[h])),c.push(i[h+1]);const l=[],u=ai.empty();for(let h=o.length-1;h>=0;--h)if(!yf(l,o[h])){const e=o[h];let t=c[h];t=O(t);const n=s.Uu(e);if(t instanceof af)l.push(e);else{const r=uf(t,n);null!=r&&(l.push(e),u.set(e,r))}}const d=new ha(l);return new Jh(u,d,s.fieldTransforms)}function lf(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return uf(n,e.ju(r?4:3,t))}function uf(e,t){if(hf(e=O(e)))return ff("Unsupported field value:",t,e),df(e,t);if(e instanceof Kh)return function(e,t){if(!Zh(t.Lu))throw t.Wu(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.Wu(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.Qu&&4!==t.Lu)throw t.Wu("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const a of e){let e=uf(a,t.Ku(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=O(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return ys(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=an.fromDate(e);return{timestampValue:xo(t.serializer,n)}}if(e instanceof an){const n=new an(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:xo(t.serializer,n)}}if(e instanceof qh)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Wh)return{bytesValue:So(t.serializer,e._byteString)};if(e instanceof Ph){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Wu(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:_o(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof Yh)return function(e,t){return{mapValue:{fields:{[Aa]:{stringValue:Oa},[Da]:{arrayValue:{values:e.toArray().map((e=>{if("number"!=typeof e)throw t.Wu("VectorValues must only contain numeric values.");return ms(t.serializer,e)}))}}}}}}(e,t);throw t.Wu(`Unsupported field value: ${Ih(e)}`)}(e,t)}function df(e,t){const n={};return ia(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):aa(e,((e,r)=>{const a=uf(r,t.qu(e));null!=a&&(n[e]=a)})),{mapValue:{fields:n}}}function hf(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof an||e instanceof qh||e instanceof Wh||e instanceof Ph||e instanceof Kh||e instanceof Yh)}function ff(e,t,n){if(!hf(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const r=Ih(n);throw"an object"===r?t.Wu(e+" a custom object"):t.Wu(e+" "+r)}}function pf(e,t,n){if((t=O(t))instanceof Gh)return t._internalPath;if("string"==typeof t)return mf(e,t);throw vf("Field path arguments must be of type string or ",e,!1,void 0,n)}const gf=new RegExp("[~\\*/\\[\\]]");function mf(e,t,n){if(t.search(gf)>=0)throw vf(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new Gh(...t.split("."))._internalPath}catch(r){throw vf(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function vf(e,t,n,r,a){const i=r&&!r.isEmpty(),s=void 0!==a;let o=`Function ${t}() called with invalid data`;n&&(o+=" (via `toFirestore()`)"),o+=". ";let c="";return(i||s)&&(c+=" (found",i&&(c+=` in field ${r}`),s&&(c+=` in document ${a}`),c+=")"),new Ft(Mt.INVALID_ARGUMENT,o+e+c)}function yf(e,t){return e.some((e=>e.isEqual(t)))}class bf{constructor(e,t,n,r,a){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Ph(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new wf(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Ef("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class wf extends bf{data(){return super.data()}}function Ef(e,t){return"string"==typeof t?mf(e,t):t instanceof Gh?t._internalPath:t._delegate._internalPath}function Tf(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Ft(Mt.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class xf{}class Sf extends xf{}function If(e,t){let n=[];for(var r=arguments.length,a=new Array(r>2?r-2:0),i=2;i<r;i++)a[i-2]=arguments[i];t instanceof xf&&n.push(t),n=n.concat(a),function(e){const t=e.filter((e=>e instanceof Cf)).length,n=e.filter((e=>e instanceof kf)).length;if(t>1||t>0&&n>0)throw new Ft(Mt.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const s of n)e=s._apply(e);return e}class kf extends Sf{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new kf(e,t,n)}_apply(e){const t=this._parse(e);return Df(e._query,t),new Dh(e.firestore,e.converter,Ki(e._query,t))}_parse(e){const t=nf(e.firestore),n=function(e,t,n,r,a,i,s){let o;if(a.isKeyField()){if("array-contains"===i||"array-contains-any"===i)throw new Ft(Mt.INVALID_ARGUMENT,`Invalid Query. You can't perform '${i}' queries on documentId().`);if("in"===i||"not-in"===i){Of(s,i);const t=[];for(const n of s)t.push(Rf(r,e,n));o={arrayValue:{values:t}}}else o=Rf(r,e,s)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Of(s,i),o=lf(n,t,s,"in"===i||"not-in"===i);return fi.create(a,i,o)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}function _f(e,t,n){const r=t,a=Ef("where",e);return kf._create(a,r,n)}class Cf extends xf{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Cf(e,t)}_parse(e){const t=this._queryConstraints.map((t=>t._parse(e))).filter((e=>e.getFilters().length>0));return 1===t.length?t[0]:pi.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const a of r)Df(n,a),n=Ki(n,a)}(e._query,t),new Dh(e.firestore,e.converter,Ki(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class Af extends Sf{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new Af(e,t,n)}_apply(e){return new Dh(e.firestore,e.converter,qi(e._query,this._limit,this._limitType))}}function Nf(e){return _h("limit",e),Af._create("limit",e,"F")}function Rf(e,t,n){if("string"==typeof(n=O(n))){if(""===n)throw new Ft(Mt.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!$i(t)&&-1!==n.indexOf("/"))throw new Ft(Mt.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(ln.fromString(n));if(!hn.isDocumentKey(r))throw new Ft(Mt.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Ha(e,new hn(r))}if(n instanceof Ph)return Ha(e,n._key);throw new Ft(Mt.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Ih(n)}.`)}function Of(e,t){if(!Array.isArray(e)||0===e.length)throw new Ft(Mt.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function Df(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new Ft(Mt.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new Ft(Mt.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}class Pf{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(La(e)){case 0:return null;case 1:return e.booleanValue;case 2:return va(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ya(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Dt()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return aa(e,((e,r)=>{n[e]=this.convertValue(r,t)})),n}convertVectorValue(e){var t,n,r;const a=null===(r=null===(n=null===(t=e.fields)||void 0===t?void 0:t[Da].arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.map((e=>va(e.doubleValue)));return new Yh(a)}convertGeoPoint(e){return new qh(va(e.latitude),va(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Sa(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Ia(e));default:return null}}convertTimestamp(e){const t=ma(e);return new an(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=ln.fromString(e);Pt(Qo(n));const r=new Ca(n.get(1),n.get(3)),a=new hn(n.popFirst(5));return r.isEqual(t)||Nt(`Document ${a} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}function Lf(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class Mf{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ff extends bf{constructor(e,t,n,r,a,i){super(e,t,n,r,i),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new zf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(Ef("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class zf extends Ff{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class jf{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Mf(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new zf(this._firestore,this._userDataWriter,n.key,n,new Mf(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Ft(Mt.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>{const r=new zf(e._firestore,e._userDataWriter,n.doc.key,n.doc,new Mf(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const r=new zf(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Mf(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let a=-1,i=-1;return 0!==t.type&&(a=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),i=n.indexOf(t.doc.key)),{type:Uf(t.type),doc:r,oldIndex:a,newIndex:i}}))}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function Uf(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Dt()}}class Bf extends Pf{constructor(e){super(),this.firestore=e}convertBytes(e){return new Wh(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ph(this.firestore,null,t)}}function Vf(e){e=kh(e,Dh);const t=kh(e.firestore,Bh),n=Vh(t),r=new Bf(t);return Tf(e._query),bh(n,e._query).then((n=>new jf(t,r,e,n)))}function $f(e,t,n){e=kh(e,Ph);const r=kh(e.firestore,Bh),a=Lf(e.converter,t,n);return Kf(r,[rf(nf(r),"setDoc",e._key,a,null!==e.converter,n).toMutation(e._key,Ds.none())])}function Hf(e,t,n){e=kh(e,Ph);const r=kh(e.firestore,Bh),a=nf(r);let i;for(var s=arguments.length,o=new Array(s>3?s-3:0),c=3;c<s;c++)o[c-3]=arguments[c];return i="string"==typeof(t=O(t))||t instanceof Gh?cf(a,"updateDoc",e._key,t,n,o):of(a,"updateDoc",e._key,t),Kf(r,[i.toMutation(e._key,Ds.exists(!0))])}function Wf(e){return Kf(kh(e.firestore,Bh),[new Gs(e._key,Ds.none())])}function Gf(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a,i,s;e=O(e);let o={includeMetadataChanges:!1,source:"default"},c=0;"object"!=typeof n[c]||Uh(n[c])||(o=n[c],c++);const l={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(Uh(n[c])){const e=n[c];n[c]=null===(a=e.next)||void 0===a?void 0:a.bind(e),n[c+1]=null===(i=e.error)||void 0===i?void 0:i.bind(e),n[c+2]=null===(s=e.complete)||void 0===s?void 0:s.bind(e)}let u,d,h;if(e instanceof Ph)d=kh(e.firestore,Bh),h=Bi(e._key.path),u={next:t=>{n[c]&&n[c](qf(d,e,t))},error:n[c+1],complete:n[c+2]};else{const t=kh(e,Dh);d=kh(t.firestore,Bh),h=t._query;const r=new Bf(d);u={next:e=>{n[c]&&n[c](new jf(d,r,t,e))},error:n[c+1],complete:n[c+2]},Tf(e._query)}return function(e,t,n,r){const a=new uh(r),i=new Ad(t,a,n);return e.asyncQueue.enqueueAndForget((async()=>Td(await yh(e),i))),()=>{a.su(),e.asyncQueue.enqueueAndForget((async()=>xd(await yh(e),i)))}}(Vh(d),h,l,u)}function Kf(e,t){return function(e,t){const n=new zt;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){const r=ih(e);try{const e=await function(e,t){const n=Lt(e),r=an.now(),a=t.reduce(((e,t)=>e.add(t.key)),fs());let i,s;return n.persistence.runTransaction("Locally write mutations","readwrite",(e=>{let o=as(),c=fs();return n.ds.getEntries(e,a).next((e=>{o=e,o.forEach(((e,t)=>{t.isValidDocument()||(c=c.add(e))}))})).next((()=>n.localDocuments.getOverlayedDocuments(e,o))).next((a=>{i=a;const s=[];for(const e of t){const t=js(e,i.get(e.key).overlayedDocument);null!=t&&s.push(new Vs(e.key,t,ii(t.value.mapValue),Ds.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,s,t)})).next((t=>{s=t;const r=t.applyToLocalDocumentSet(i,c);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)}))})).then((()=>({batchId:s.batchId,changes:os(i)})))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Wa[e.currentUser.toKey()];r||(r=new sa(Xt)),r=r.insert(t,n),e.Wa[e.currentUser.toKey()]=r}(r,e.batchId,n),await th(r,e.changes),await td(r.remoteStore)}catch(e){const t=gd(e,"Failed to persist write");n.reject(t)}}(await vh(e),t,n))),n.promise}(Vh(e),t)}function qf(e,t,n){const r=n.docs.get(t._key),a=new Bf(e);return new Ff(e,a,t._key,r,new Mf(n.hasPendingWrites,n.fromCache),t.converter)}class Yf{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=nf(e)}set(e,t,n){this._verifyNotCommitted();const r=Xf(e,this._firestore),a=Lf(r.converter,t,n),i=rf(this._dataReader,"WriteBatch.set",r._key,a,null!==r.converter,n);return this._mutations.push(i.toMutation(r._key,Ds.none())),this}update(e,t,n){this._verifyNotCommitted();const r=Xf(e,this._firestore);let a;for(var i=arguments.length,s=new Array(i>3?i-3:0),o=3;o<i;o++)s[o-3]=arguments[o];return a="string"==typeof(t=O(t))||t instanceof Gh?cf(this._dataReader,"WriteBatch.update",r._key,t,n,s):of(this._dataReader,"WriteBatch.update",r._key,t),this._mutations.push(a.toMutation(r._key,Ds.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Xf(e,this._firestore);return this._mutations=this._mutations.concat(new Gs(t._key,Ds.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Ft(Mt.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Xf(e,t){if((e=O(e)).firestore!==t)throw new Ft(Mt.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}function Qf(){return new sf("serverTimestamp")}function Jf(e){return Vh(e=kh(e,Bh)),new Yf(e,(t=>Kf(e,t)))}new WeakMap;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){kt=e}(Ye),He(new D("firestore",((e,n)=>{let{instanceIdentifier:r,options:a}=n;const i=e.getProvider("app").getImmediate(),s=new Bh(new Vt(e.getProvider("auth-internal")),new Gt(i,e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Ft(Mt.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ca(e.options.projectId,t)}(i,r),i);return a=Object.assign({useFetchStreams:t},a),s._setSettings(a),s}),"PUBLIC").setMultipleInstances(!0)),Je(xt,St,e),Je(xt,St,"esm2017")}();Je("firebase","11.6.0","app");const Zf="@firebase/installations",ep="0.6.13",tp=1e4,np=`w:${ep}`,rp="FIS_v2",ap=36e5,ip=new T("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function sp(e){return e instanceof E&&e.code.includes("request-failed")}function op(e){let{projectId:t}=e;return`https://firebaseinstallations.googleapis.com/v1/projects/${t}/installations`}function cp(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function lp(e,t){const n=(await t.json()).error;return ip.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function up(e){let{apiKey:t}=e;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function dp(e,t){let{refreshToken:n}=t;const r=up(e);return r.append("Authorization",function(e){return`${rp} ${e}`}(n)),r}async function hp(e){const t=await e();return t.status>=500&&t.status<600?e():t}function fp(e){return new Promise((t=>{setTimeout(t,e)}))}const pp=/^[cdef][\w-]{21}$/;function gp(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){const t=(n=e,btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_"));var n;return t.substr(0,22)}(e);return pp.test(t)?t:""}catch(e){return""}}function mp(e){return`${e.appName}!${e.appId}`}const vp=new Map;function yp(e,t){const n=mp(e);bp(n,t),function(e,t){const n=Ep();n&&n.postMessage({key:e,fid:t});Tp()}(n,t)}function bp(e,t){const n=vp.get(e);if(n)for(const r of n)r(t)}let wp=null;function Ep(){return!wp&&"BroadcastChannel"in self&&(wp=new BroadcastChannel("[Firebase] FID Change"),wp.onmessage=e=>{bp(e.data.key,e.data.fid)}),wp}function Tp(){0===vp.size&&wp&&(wp.close(),wp=null)}const xp="firebase-installations-store";let Sp=null;function Ip(){return Sp||(Sp=re("firebase-installations-database",1,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(xp)}})),Sp}async function kp(e,t){const n=mp(e),r=(await Ip()).transaction(xp,"readwrite"),a=r.objectStore(xp),i=await a.get(n);return await a.put(t,n),await r.done,i&&i.fid===t.fid||yp(e,t.fid),t}async function _p(e){const t=mp(e),n=(await Ip()).transaction(xp,"readwrite");await n.objectStore(xp).delete(t),await n.done}async function Cp(e,t){const n=mp(e),r=(await Ip()).transaction(xp,"readwrite"),a=r.objectStore(xp),i=await a.get(n),s=t(i);return void 0===s?await a.delete(n):await a.put(s,n),await r.done,!s||i&&i.fid===s.fid||yp(e,s.fid),s}async function Ap(e){let t;const n=await Cp(e.appConfig,(n=>{const r=function(e){const t=e||{fid:gp(),registrationStatus:0};return Op(t)}(n),a=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine){return{installationEntry:t,registrationPromise:Promise.reject(ip.create("app-offline"))}}const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=async function(e,t){try{const n=await async function(e,t){let{appConfig:n,heartbeatServiceProvider:r}=e,{fid:a}=t;const i=op(n),s=up(n),o=r.getImmediate({optional:!0});if(o){const e=await o.getHeartbeatsHeader();e&&s.append("x-firebase-client",e)}const c={fid:a,authVersion:rp,appId:n.appId,sdkVersion:np},l={method:"POST",headers:s,body:JSON.stringify(c)},u=await hp((()=>fetch(i,l)));if(u.ok){const e=await u.json();return{fid:e.fid||a,registrationStatus:2,refreshToken:e.refreshToken,authToken:cp(e.authToken)}}throw await lp("Create Installation",u)}(e,t);return kp(e.appConfig,n)}catch(n){throw sp(n)&&409===n.customData.serverCode?await _p(e.appConfig):await kp(e.appConfig,{fid:t.fid,registrationStatus:0}),n}}(e,n);return{installationEntry:n,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:Np(e)}:{installationEntry:t}}(e,r);return t=a.registrationPromise,a.installationEntry}));return""===n.fid?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}async function Np(e){let t=await Rp(e.appConfig);for(;1===t.registrationStatus;)await fp(100),t=await Rp(e.appConfig);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:n}=await Ap(e);return n||t}return t}function Rp(e){return Cp(e,(e=>{if(!e)throw ip.create("installation-not-found");return Op(e)}))}function Op(e){return 1===(t=e).registrationStatus&&t.registrationTime+tp<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}async function Dp(e,t){let{appConfig:n,heartbeatServiceProvider:r}=e;const a=function(e,t){let{fid:n}=t;return`${op(e)}/${n}/authTokens:generate`}(n,t),i=dp(n,t),s=r.getImmediate({optional:!0});if(s){const e=await s.getHeartbeatsHeader();e&&i.append("x-firebase-client",e)}const o={installation:{sdkVersion:np,appId:n.appId}},c={method:"POST",headers:i,body:JSON.stringify(o)},l=await hp((()=>fetch(a,c)));if(l.ok){return cp(await l.json())}throw await lp("Generate Auth Token",l)}async function Pp(e){let t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=await Cp(e.appConfig,(r=>{if(!Mp(r))throw ip.create("not-registered");const a=r.authToken;if(!n&&function(e){return 2===e.requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+ap}(e)}(a))return r;if(1===a.requestStatus)return t=async function(e,t){let n=await Lp(e.appConfig);for(;1===n.authToken.requestStatus;)await fp(100),n=await Lp(e.appConfig);const r=n.authToken;return 0===r.requestStatus?Pp(e,t):r}(e,n),r;{if(!navigator.onLine)throw ip.create("app-offline");const n=function(e){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}(r);return t=async function(e,t){try{const n=await Dp(e,t),r=Object.assign(Object.assign({},t),{authToken:n});return await kp(e.appConfig,r),n}catch(n){if(!sp(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await kp(e.appConfig,n)}else await _p(e.appConfig);throw n}}(e,n),n}}));return t?await t:r.authToken}function Lp(e){return Cp(e,(e=>{if(!Mp(e))throw ip.create("not-registered");const t=e.authToken;return 1===(n=t).requestStatus&&n.requestTime+tp<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e;var n}))}function Mp(e){return void 0!==e&&2===e.registrationStatus}async function Fp(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e;await async function(e){const{registrationPromise:t}=await Ap(e);t&&await t}(n);return(await Pp(n,t)).token}function zp(e){return ip.create("missing-app-config-values",{valueName:e})}const jp="installations",Up=e=>{const t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw zp("App Configuration");if(!e.name)throw zp("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw zp(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:We(t,"heartbeat"),_delete:()=>Promise.resolve()}},Bp=e=>{const t=We(e.getProvider("app").getImmediate(),jp).getImmediate();return{getId:()=>async function(e){const t=e,{installationEntry:n,registrationPromise:r}=await Ap(t);return r?r.catch(console.error):Pp(t).catch(console.error),n.fid}(t),getToken:e=>Fp(t,e)}};He(new D(jp,Up,"PUBLIC")),He(new D("installations-internal",Bp,"PRIVATE")),Je(Zf,ep),Je(Zf,ep,"esm2017");const Vp="analytics",$p="https://www.googletagmanager.com/gtag/js",Hp=new H("@firebase/analytics"),Wp=new T("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function Gp(e){if(!e.startsWith($p)){const t=Wp.create("invalid-gtag-resource",{gtagURL:e});return Hp.warn(t.message),""}return e}function Kp(e){return Promise.all(e.map((e=>e.catch((e=>e)))))}function qp(e,t){const n=function(e,t){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(e,t)),n}("firebase-js-sdk-policy",{createScriptURL:Gp}),r=document.createElement("script"),a=`${$p}?l=${e}&id=${t}`;r.src=n?null===n||void 0===n?void 0:n.createScriptURL(a):a,r.async=!0,document.head.appendChild(r)}function Yp(e,t,n,r){return async function(a){try{for(var i=arguments.length,s=new Array(i>1?i-1:0),o=1;o<i;o++)s[o-1]=arguments[o];if("event"===a){const[r,a]=s;await async function(e,t,n,r,a){try{let i=[];if(a&&a.send_to){let e=a.send_to;Array.isArray(e)||(e=[e]);const r=await Kp(n);for(const n of e){const e=r.find((e=>e.measurementId===n)),a=e&&t[e.appId];if(!a){i=[];break}i.push(a)}}0===i.length&&(i=Object.values(t)),await Promise.all(i),e("event",r,a||{})}catch(i){Hp.error(i)}}(e,t,n,r,a)}else if("config"===a){const[a,i]=s;await async function(e,t,n,r,a,i){const s=r[a];try{if(s)await t[s];else{const e=(await Kp(n)).find((e=>e.measurementId===a));e&&await t[e.appId]}}catch(o){Hp.error(o)}e("config",a,i)}(e,t,n,r,a,i)}else if("consent"===a){const[t,n]=s;e("consent",t,n)}else if("get"===a){const[t,n,r]=s;e("get",t,n,r)}else if("set"===a){const[t]=s;e("set",t)}else e(a,...s)}catch(c){Hp.error(c)}}}const Xp=new class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function Qp(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}async function Jp(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Xp,n=arguments.length>2?arguments[2]:void 0;const{appId:r,apiKey:a,measurementId:i}=e.options;if(!r)throw Wp.create("no-app-id");if(!a){if(i)return{measurementId:i,appId:r};throw Wp.create("no-api-key")}const s=t.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},o=new eg;return setTimeout((async()=>{o.abort()}),void 0!==n?n:6e4),Zp({appId:r,apiKey:a,measurementId:i},s,o,t)}async function Zp(e,t,n){let{throttleEndTimeMillis:r,backoffCount:a}=t,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Xp;var s;const{appId:o,measurementId:c}=e;try{await function(e,t){return new Promise(((n,r)=>{const a=Math.max(t-Date.now(),0),i=setTimeout(n,a);e.addEventListener((()=>{clearTimeout(i),r(Wp.create("fetch-throttle",{throttleEndTimeMillis:t}))}))}))}(n,r)}catch(l){if(c)return Hp.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${c} provided in the "measurementId" field in the local Firebase config. [${null===l||void 0===l?void 0:l.message}]`),{appId:o,measurementId:c};throw l}try{const t=await async function(e){var t;const{appId:n,apiKey:r}=e,a={method:"GET",headers:Qp(r)},i="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),s=await fetch(i,a);if(200!==s.status&&304!==s.status){let e="";try{const n=await s.json();(null===(t=n.error)||void 0===t?void 0:t.message)&&(e=n.error.message)}catch(o){}throw Wp.create("config-fetch-failed",{httpStatus:s.status,responseMessage:e})}return s.json()}(e);return i.deleteThrottleMetadata(o),t}catch(l){const t=l;if(!function(e){if(!(e instanceof E)||!e.customData)return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(t)){if(i.deleteThrottleMetadata(o),c)return Hp.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${c} provided in the "measurementId" field in the local Firebase config. [${null===t||void 0===t?void 0:t.message}]`),{appId:o,measurementId:c};throw l}const r=503===Number(null===(s=null===t||void 0===t?void 0:t.customData)||void 0===s?void 0:s.httpStatus)?R(a,i.intervalMillis,30):R(a,i.intervalMillis),u={throttleEndTimeMillis:Date.now()+r,backoffCount:a+1};return i.setThrottleMetadata(o,u),Hp.debug(`Calling attemptFetch again in ${r} millis`),Zp(e,u,n,i)}}class eg{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach((e=>e()))}}let tg,ng;function rg(e){ng=e}function ag(e){tg=e}async function ig(e,t,n,r,a,i,s){var o;const c=Jp(e);c.then((t=>{n[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&Hp.warn(`The measurement ID in the local Firebase config (${e.options.measurementId}) does not match the measurement ID fetched from the server (${t.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)})).catch((e=>Hp.error(e))),t.push(c);const l=async function(){if(!b())return Hp.warn(Wp.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await w()}catch(e){return Hp.warn(Wp.create("indexeddb-unavailable",{errorInfo:null===e||void 0===e?void 0:e.toString()}).message),!1}return!0}().then((e=>e?r.getId():void 0)),[u,d]=await Promise.all([c,l]);(function(e){const t=window.document.getElementsByTagName("script");for(const n of Object.values(t))if(n.src&&n.src.includes($p)&&n.src.includes(e))return n;return null})(i)||qp(i,u.measurementId),ng&&(a("consent","default",ng),rg(void 0)),a("js",new Date);const h=null!==(o=null===s||void 0===s?void 0:s.config)&&void 0!==o?o:{};return h.origin="firebase",h.update=!0,null!=d&&(h.firebase_id=d),a("config",u.measurementId,h),tg&&(a("set",tg),ag(void 0)),u.measurementId}class sg{constructor(e){this.app=e}_delete(){return delete og[this.app.options.appId],Promise.resolve()}}let og={},cg=[];const lg={};let ug,dg,hg="dataLayer",fg="gtag",pg=!1;function gg(){const e=[];if(v()&&e.push("This is a browser extension environment."),"undefined"!==typeof navigator&&navigator.cookieEnabled||e.push("Cookies are not available."),e.length>0){const t=e.map(((e,t)=>`(${t+1}) ${e}`)).join(" "),n=Wp.create("invalid-analytics-context",{errorInfo:t});Hp.warn(n.message)}}function mg(e,t,n){gg();const r=e.options.appId;if(!r)throw Wp.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw Wp.create("no-api-key");Hp.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=og[r])throw Wp.create("already-exists",{id:r});if(!pg){!function(e){let t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(hg);const{wrappedGtag:e,gtagCore:t}=function(e,t,n,r,a){let i=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];window[r].push(arguments)};return window[a]&&"function"===typeof window[a]&&(i=window[a]),window[a]=Yp(i,e,t,n),{gtagCore:i,wrappedGtag:window[a]}}(og,cg,lg,hg,fg);dg=e,ug=t,pg=!0}og[r]=ig(e,cg,lg,t,ug,hg,n);return new sg(e)}function vg(e,t,n,r){e=O(e),async function(e,t,n,r,a){if(a&&a.global)e("event",n,r);else{const a=await t;e("event",n,Object.assign(Object.assign({},r),{send_to:a}))}}(dg,og[e.app.options.appId],t,n,r).catch((e=>Hp.error(e)))}const yg="@firebase/analytics",bg="0.10.12";He(new D(Vp,((e,t)=>{let{options:n}=t;return mg(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),n)}),"PUBLIC")),He(new D("analytics-internal",(function(e){try{const t=e.getProvider(Vp).getImmediate();return{logEvent:(e,n,r)=>vg(t,e,n,r)}}catch(t){throw Wp.create("interop-component-reg-failed",{reason:t})}}),"PRIVATE")),Je(yg,bg),Je(yg,bg,"esm2017");function wg(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;function Eg(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Tg=Eg,xg=new T("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Sg=new H("@firebase/auth");function Ig(e){if(Sg.logLevel<=z.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Sg.error(`Auth (${Ye}): ${e}`,...n)}}function kg(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw Ng(e,...n)}function _g(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Ng(e,...n)}function Cg(e,t,n){const r=Object.assign(Object.assign({},Tg()),{[t]:n});return new T("auth","Firebase",r).create(t,{appName:e.name})}function Ag(e){return Cg(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Ng(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){const t=n[0],r=[...n.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(t,...r)}return xg.create(e,...n)}function Rg(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];throw Ng(t,...r)}}function Og(e){const t="INTERNAL ASSERTION FAILED: "+e;throw Ig(t),new Error(t)}function Dg(e,t){e||Og(t)}function Pg(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function Lg(){return"http:"===Mg()||"https:"===Mg()}function Mg(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class Fg{constructor(e,t){this.shortDelay=e,this.longDelay=t,Dg(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(m())||"object"===typeof navigator&&"ReactNative"===navigator.product}get(){return"undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(Lg()||v()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function zg(e,t){Dg(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class jg{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void Og("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void Og("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void Og("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Ug={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Bg=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Vg=new Fg(3e4,6e4);function $g(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function Hg(e,t,n,r){return Wg(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},(async()=>{let a={},i={};r&&("GET"===t?i=r:a={body:JSON.stringify(r)});const s=k(Object.assign({key:e.config.apiKey},i)).slice(1),o=await e._getAdditionalHeaders();o["Content-Type"]="application/json",e.languageCode&&(o["X-Firebase-Locale"]=e.languageCode);const c=Object.assign({method:t,headers:o},a);return"undefined"!==typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||(c.referrerPolicy="no-referrer"),jg.fetch()(await Kg(e,e.config.apiHost,n,s),c)}))}async function Wg(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},Ug),t);try{const t=new Yg(e),a=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const i=await a.json();if("needConfirmation"in i)throw Xg(e,"account-exists-with-different-credential",i);if(a.ok&&!("errorMessage"in i))return i;{const t=a.ok?i.errorMessage:i.error.message,[n,s]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw Xg(e,"credential-already-in-use",i);if("EMAIL_EXISTS"===n)throw Xg(e,"email-already-in-use",i);if("USER_DISABLED"===n)throw Xg(e,"user-disabled",i);const o=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(s)throw Cg(e,o,s);kg(e,o)}}catch(a){if(a instanceof E)throw a;kg(e,"network-request-failed",{message:String(a)})}}async function Gg(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const i=await Hg(e,t,n,r,a);return"mfaPendingCredential"in i&&kg(e,"multi-factor-auth-required",{_serverResponse:i}),i}async function Kg(e,t,n,r){const a=`${t}${n}?${r}`,i=e,s=i.config.emulator?zg(e.config,a):`${e.config.apiScheme}://${a}`;if(Bg.includes(n)&&(await i._persistenceManagerAvailable,"COOKIE"===i._getPersistenceType())){return i._getPersistence()._getFinalTarget(s).toString()}return s}function qg(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Yg{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(_g(this.auth,"network-request-failed"))),Vg.get())}))}}function Xg(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const a=_g(e,t,r);return a.customData._tokenResponse=n,a}function Qg(e){return void 0!==e&&void 0!==e.enterprise}class Jg{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return qg(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Zg(e,t){return Hg(e,"GET","/v2/recaptchaConfig",$g(e,t))}async function em(e,t){return Hg(e,"POST","/v1/accounts:lookup",t)}function tm(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(t){}}function nm(e){return 1e3*Number(e)}function rm(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return Ig("JWT malformed, contained fewer than 3 sections"),null;try{const e=l(n);return e?JSON.parse(e):(Ig("Failed to decode base64 JWT payload"),null)}catch(a){return Ig("Caught error parsing JWT payload as JSON",null===a||void 0===a?void 0:a.toString()),null}}function am(e){const t=rm(e);return Rg(t,"internal-error"),Rg("undefined"!==typeof t.exp,"internal-error"),Rg("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function im(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(n){throw n instanceof E&&function(e){let{code:t}=e;return"auth/user-disabled"===t||"auth/user-token-expired"===t}(n)&&e.auth.currentUser===e&&await e.auth.signOut(),n}}class sm{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===(null===e||void 0===e?void 0:e.code)&&this.schedule(!0))}this.schedule()}}class om{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=tm(this.lastLoginAt),this.creationTime=tm(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function cm(e){var t;const n=e.auth,r=await e.getIdToken(),a=await im(e,em(n,{idToken:r}));Rg(null===a||void 0===a?void 0:a.users.length,n,"internal-error");const i=a.users[0];e._notifyReloadListener(i);const s=(null===(t=i.providerUserInfo)||void 0===t?void 0:t.length)?lm(i.providerUserInfo):[],o=(c=e.providerData,l=s,[...c.filter((e=>!l.some((t=>t.providerId===e.providerId)))),...l]);var c,l;const u=e.isAnonymous,d=!(e.email&&i.passwordHash)&&!(null===o||void 0===o?void 0:o.length),h=!!u&&d,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new om(i.createdAt,i.lastLoginAt),isAnonymous:h};Object.assign(e,f)}function lm(e){return e.map((e=>{var{providerId:t}=e,n=wg(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}))}class um{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Rg(e.idToken,"internal-error"),Rg("undefined"!==typeof e.idToken,"internal-error"),Rg("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):am(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Rg(0!==e.length,"internal-error");const t=am(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||!this.accessToken||this.isExpired?(Rg(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:a}=await async function(e,t){const n=await Wg(e,{},(async()=>{const n=k({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:a}=e.config,i=await Kg(e,r,"/v1/token",`key=${a}`),s=await e._getAdditionalHeaders();return s["Content-Type"]="application/x-www-form-urlencoded",jg.fetch()(i,{method:"POST",headers:s,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(a))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:a}=t,i=new um;return n&&(Rg("string"===typeof n,"internal-error",{appName:e}),i.refreshToken=n),r&&(Rg("string"===typeof r,"internal-error",{appName:e}),i.accessToken=r),a&&(Rg("number"===typeof a,"internal-error",{appName:e}),i.expirationTime=a),i}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new um,this.toJSON())}_performRefresh(){return Og("not implemented")}}function dm(e,t){Rg("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class hm{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,a=wg(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new sm(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new om(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const t=await im(this,this.stsTokenManager.getToken(this.auth,e));return Rg(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=O(e),r=await n.getIdToken(t),a=rm(r);Rg(a&&a.exp&&a.auth_time&&a.iat,n.auth,"internal-error");const i="object"===typeof a.firebase?a.firebase:void 0,s=null===i||void 0===i?void 0:i.sign_in_provider;return{claims:a,token:r,authTime:tm(nm(a.auth_time)),issuedAtTime:tm(nm(a.iat)),expirationTime:tm(nm(a.exp)),signInProvider:s||null,signInSecondFactor:(null===i||void 0===i?void 0:i.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=O(e);await cm(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(Rg(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new hm(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Rg(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await cm(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ge(this.auth.app))return Promise.reject(Ag(this.auth));const e=await this.getIdToken();return await im(this,async function(e,t){return Hg(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,a,i,s,o,c,l;const u=null!==(n=t.displayName)&&void 0!==n?n:void 0,d=null!==(r=t.email)&&void 0!==r?r:void 0,h=null!==(a=t.phoneNumber)&&void 0!==a?a:void 0,f=null!==(i=t.photoURL)&&void 0!==i?i:void 0,p=null!==(s=t.tenantId)&&void 0!==s?s:void 0,g=null!==(o=t._redirectEventId)&&void 0!==o?o:void 0,m=null!==(c=t.createdAt)&&void 0!==c?c:void 0,v=null!==(l=t.lastLoginAt)&&void 0!==l?l:void 0,{uid:y,emailVerified:b,isAnonymous:w,providerData:E,stsTokenManager:T}=t;Rg(y&&T,e,"internal-error");const x=um.fromJSON(this.name,T);Rg("string"===typeof y,e,"internal-error"),dm(u,e.name),dm(d,e.name),Rg("boolean"===typeof b,e,"internal-error"),Rg("boolean"===typeof w,e,"internal-error"),dm(h,e.name),dm(f,e.name),dm(p,e.name),dm(g,e.name),dm(m,e.name),dm(v,e.name);const S=new hm({uid:y,auth:e,email:d,emailVerified:b,displayName:u,isAnonymous:w,photoURL:f,phoneNumber:h,tenantId:p,stsTokenManager:x,createdAt:m,lastLoginAt:v});return E&&Array.isArray(E)&&(S.providerData=E.map((e=>Object.assign({},e)))),g&&(S._redirectEventId=g),S}static async _fromIdTokenResponse(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=new um;r.updateFromServerResponse(t);const a=new hm({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await cm(a),a}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];Rg(void 0!==r.localId,"internal-error");const a=void 0!==r.providerUserInfo?lm(r.providerUserInfo):[],i=!(r.email&&r.passwordHash)&&!(null===a||void 0===a?void 0:a.length),s=new um;s.updateFromIdToken(n);const o=new hm({uid:r.localId,auth:e,stsTokenManager:s,isAnonymous:i}),c={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:a,metadata:new om(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(null===a||void 0===a?void 0:a.length)};return Object.assign(o,c),o}}const fm=new Map;function pm(e){Dg(e instanceof Function,"Expected a class definition");let t=fm.get(e);return t?(Dg(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,fm.set(e,t),t)}class gm{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}gm.type="NONE";const mm=gm;function vm(e,t,n){return`firebase:${e}:${t}:${n}`}class ym{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:a}=this.auth;this.fullUserKey=vm(this.userKey,r.apiKey,a),this.fullPersistenceKey=vm("persistence",r.apiKey,a),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if("string"===typeof e){const t=await em(this.auth,{idToken:e}).catch((()=>{}));return t?hm._fromGetAccountInfoResponse(this.auth,t,e):null}return hm._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new ym(pm(mm),e,n);const r=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let a=r[0]||pm(mm);const i=vm(n,e.config.apiKey,e.name);let s=null;for(const l of t)try{const t=await l._get(i);if(t){let n;if("string"===typeof t){const r=await em(e,{idToken:t}).catch((()=>{}));if(!r)break;n=await hm._fromGetAccountInfoResponse(e,r,t)}else n=hm._fromJSON(e,t);l!==a&&(s=n),a=l;break}}catch(c){}const o=r.filter((e=>e._shouldAllowMigration));return a._shouldAllowMigration&&o.length?(a=o[0],s&&await a._set(i,s.toJSON()),await Promise.all(t.map((async e=>{if(e!==a)try{await e._remove(i)}catch(c){}}))),new ym(a,e,n)):new ym(a,e,n)}}function bm(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(xm(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(wm(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Im(t))return"Blackberry";if(km(t))return"Webos";if(Em(t))return"Safari";if((t.includes("chrome/")||Tm(t))&&!t.includes("edge/"))return"Chrome";if(Sm(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null===n||void 0===n?void 0:n.length))return n[1]}return"Other"}function wm(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m();return/firefox\//i.test(e)}function Em(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:m()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Tm(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m();return/crios\//i.test(e)}function xm(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m();return/iemobile/i.test(e)}function Sm(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m();return/android/i.test(e)}function Im(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m();return/blackberry/i.test(e)}function km(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m();return/webos/i.test(e)}function _m(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function Cm(){return function(){const e=m();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}function Am(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m();return _m(e)||Sm(e)||km(e)||Im(e)||/windows phone/i.test(e)||xm(e)}function Nm(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=bm(m());break;case"Worker":t=`${bm(m())}-${e}`;break;default:t=e}const r=n.length?n.join(","):"FirebaseCore-web";return`${t}/JsCore/${Ye}/${r}`}class Rm{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,r)=>{try{n(e(t))}catch(a){r(a)}}));n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const e of t)try{e()}catch(r){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===n||void 0===n?void 0:n.message})}}}class Om{constructor(e){var t,n,r,a;const i=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=i.minPasswordLength)&&void 0!==t?t:6,i.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=i.maxPasswordLength),void 0!==i.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=i.containsLowercaseCharacter),void 0!==i.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=i.containsUppercaseCharacter),void 0!==i.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=i.containsNumericCharacter),void 0!==i.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=i.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(r=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==r?r:"",this.forceUpgradeOnSignin=null!==(a=e.forceUpgradeOnSignin)&&void 0!==a&&a,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,r,a,i,s;const o={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,o),this.validatePasswordCharacterOptions(e,o),o.isValid&&(o.isValid=null===(t=o.meetsMinPasswordLength)||void 0===t||t),o.isValid&&(o.isValid=null===(n=o.meetsMaxPasswordLength)||void 0===n||n),o.isValid&&(o.isValid=null===(r=o.containsLowercaseLetter)||void 0===r||r),o.isValid&&(o.isValid=null===(a=o.containsUppercaseLetter)||void 0===a||a),o.isValid&&(o.isValid=null===(i=o.containsNumericCharacter)||void 0===i||i),o.isValid&&(o.isValid=null===(s=o.containsNonAlphanumericCharacter)||void 0===s||s),o}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}class Dm{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Lm(this),this.idTokenSubscription=new Lm(this),this.beforeStateQueue=new Rm(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=xg,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise((e=>this._resolvePersistenceManagerAvailable=e))}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=pm(t)),this._initializationPromise=this.queue((async()=>{var n,r,a;if(!this._deleted&&(this.persistenceManager=await ym.create(this,e),null===(n=this._resolvePersistenceManagerAvailable)||void 0===n||n.call(this),!this._deleted)){if(null===(r=this._popupRedirectResolver)||void 0===r?void 0:r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(i){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(a=this.currentUser)||void 0===a?void 0:a.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await em(this,{idToken:e}),n=await hm._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Ge(this.app)){const e=this.app.settings.authIdToken;return e?new Promise((t=>{setTimeout((()=>this.initializeCurrentUserFromIdToken(e).then(t,t)))})):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,i=null===r||void 0===r?void 0:r._redirectEventId,s=await this.tryRedirectSignIn(e);n&&n!==i||!(null===s||void 0===s?void 0:s.user)||(r=s.user,a=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(r)}catch(i){r=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(i)))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Rg(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(n){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await cm(e)}catch(t){if("auth/network-request-failed"!==(null===t||void 0===t?void 0:t.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ge(this.app))return Promise.reject(Ag(this));const t=e?O(e):null;return t&&Rg(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&Rg(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return Ge(this.app)?Promise.reject(Ag(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ge(this.app)?Promise.reject(Ag(this)):this.queue((async()=>{await this.assertedPersistence.setPersistence(pm(e))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e){return Hg(e,"GET","/v2/passwordPolicy",$g(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}(this),t=new Om(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new T("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise(((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged((()=>{n(),e()}),t)}}))}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return Hg(e,"POST","/v2/accounts:revokeToken",$g(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&pm(e)||this._popupRedirectResolver;Rg(t,this,"argument-error"),this.redirectPersistenceManager=await ym.create(this,[pm(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const a="function"===typeof t?t:t.next.bind(t);let i=!1;const s=this._isInitialized?Promise.resolve():this._initializationPromise;if(Rg(s,this,"internal-error"),s.then((()=>{i||a(this.currentUser)})),"function"===typeof t){const a=e.addObserver(t,n,r);return()=>{i=!0,a()}}{const n=e.addObserver(t);return()=>{i=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Rg(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Nm(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;if(Ge(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null===t||void 0===t?void 0:t.error)&&function(e){if(Sg.logLevel<=z.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Sg.warn(`Auth (${Ye}): ${e}`,...n)}}(`Error while retrieving App Check token: ${t.error}`),null===t||void 0===t?void 0:t.token}}function Pm(e){return O(e)}class Lm{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new A(e,t);return n.subscribe.bind(n)}((e=>this.observer=e))}get next(){return Rg(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Mm={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Fm(e){return Mm.loadJS(e)}function zm(e){return`__${e}${Math.floor(1e6*Math.random())}`}class jm{constructor(){this.enterprise=new Um}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class Um{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const Bm="NO_RECAPTCHA";class Vm{constructor(e){this.type="recaptcha-enterprise",this.auth=Pm(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(t,n,r){const a=window.grecaptcha;Qg(a)?a.enterprise.ready((()=>{a.enterprise.execute(t,{action:e}).then((e=>{n(e)})).catch((()=>{n(Bm)}))})):r(Error("No reCAPTCHA enterprise script loaded."))}if(this.auth.settings.appVerificationDisabledForTesting){return(new jm).execute("siteKey",{action:"verify"})}return new Promise(((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise((async(t,n)=>{Zg(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((r=>{if(void 0!==r.recaptchaKey){const n=new Jg(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((e=>{n(e)}))}))})(this.auth).then((a=>{if(!t&&Qg(window.grecaptcha))n(a,e,r);else{if("undefined"===typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=Mm.recaptchaEnterpriseScript;0!==t.length&&(t+=a),Fm(t).then((()=>{n(a,e,r)})).catch((e=>{r(e)}))}})).catch((e=>{r(e)}))}))}}async function $m(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const i=new Vm(e);let s;if(a)s=Bm;else try{s=await i.verify(n)}catch(c){s=await i.verify(n,!0)}const o=Object.assign({},t);if("mfaSmsEnrollment"===n||"mfaSmsSignIn"===n){if("phoneEnrollmentInfo"in o){const e=o.phoneEnrollmentInfo.phoneNumber,t=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:t,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){const e=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:e,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Hm(e,t,n,r,a){var i,s;if("EMAIL_PASSWORD_PROVIDER"===a){if(null===(i=e._getRecaptchaConfig())||void 0===i?void 0:i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await $m(e,t,n,"getOobCode"===n);return r(e,a)}return r(e,t).catch((async a=>{if("auth/missing-recaptcha-token"===a.code){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await $m(e,t,n,"getOobCode"===n);return r(e,a)}return Promise.reject(a)}))}if("PHONE_PROVIDER"===a){if(null===(s=e._getRecaptchaConfig())||void 0===s?void 0:s.isProviderEnabled("PHONE_PROVIDER")){const a=await $m(e,t,n);return r(e,a).catch((async a=>{var i;if("AUDIT"===(null===(i=e._getRecaptchaConfig())||void 0===i?void 0:i.getProviderEnforcementState("PHONE_PROVIDER"))&&("auth/missing-recaptcha-token"===a.code||"auth/invalid-app-credential"===a.code)){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${n} flow.`);const a=await $m(e,t,n,!1,!0);return r(e,a)}return Promise.reject(a)}))}{const a=await $m(e,t,n,!1,!0);return r(e,a)}}return Promise.reject(a+" provider is not supported.")}async function Wm(e){const t=Pm(e),n=await Zg(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new Jg(n);if(null==t.tenantId?t._agentRecaptchaConfig=r:t._tenantRecaptchaConfigs[t.tenantId]=r,r.isAnyProviderEnabled()){new Vm(t).verify()}}function Gm(e,t,n){const r=Pm(e);Rg(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const a=!!(null===n||void 0===n?void 0:n.disableWarnings),i=Km(t),{host:s,port:o}=function(e){const t=Km(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(r);if(a){const e=a[1];return{host:e,port:qm(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:qm(t)}}}(t),c={url:`${i}//${s}${null===o?"":`:${o}`}/`},l=Object.freeze({host:s,port:o,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!r._canInitEmulator)return Rg(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),void Rg(S(c,r.config.emulator)&&S(l,r.emulatorConfig),r,"emulator-config-failed");r.config.emulator=c,r.emulatorConfig=l,r.settings.appVerificationDisabledForTesting=!0,a||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function Km(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function qm(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class Ym{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Og("not implemented")}_getIdTokenResponse(e){return Og("not implemented")}_linkToIdToken(e,t){return Og("not implemented")}_getReauthenticationResolver(e){return Og("not implemented")}}async function Xm(e,t){return Hg(e,"POST","/v1/accounts:signUp",t)}async function Qm(e,t){return Gg(e,"POST","/v1/accounts:signInWithPassword",$g(e,t))}class Jm extends Ym{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new Jm(e,t,"password")}static _fromEmailAndCode(e,t){return new Jm(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return Hm(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",Qm,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return Gg(e,"POST","/v1/accounts:signInWithEmailLink",$g(e,t))}(e,{email:this._email,oobCode:this._password});default:kg(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return Hm(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Xm,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return Gg(e,"POST","/v1/accounts:signInWithEmailLink",$g(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:kg(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Zm(e,t){return Gg(e,"POST","/v1/accounts:signInWithIdp",$g(e,t))}class ev extends Ym{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new ev(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):kg("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,a=wg(t,["providerId","signInMethod"]);if(!n||!r)return null;const i=new ev(n,r);return i.idToken=a.idToken||void 0,i.accessToken=a.accessToken||void 0,i.secret=a.secret,i.nonce=a.nonce,i.pendingToken=a.pendingToken||null,i}_getIdTokenResponse(e){return Zm(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Zm(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Zm(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=k(t)}return e}}async function tv(e,t){return Hg(e,"POST","/v1/accounts:sendVerificationCode",$g(e,t))}const nv={USER_NOT_FOUND:"user-not-found"};class rv extends Ym{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new rv({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new rv({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return Gg(e,"POST","/v1/accounts:signInWithPhoneNumber",$g(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await Gg(e,"POST","/v1/accounts:signInWithPhoneNumber",$g(e,t));if(n.temporaryProof)throw Xg(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return Gg(e,"POST","/v1/accounts:signInWithPhoneNumber",$g(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),nv)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:a}=e;return n||t||r||a?new rv({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:a}):null}}class av{constructor(e){var t,n,r,a,i,s;const o=_(C(e)),c=null!==(t=o.apiKey)&&void 0!==t?t:null,l=null!==(n=o.oobCode)&&void 0!==n?n:null,u=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=o.mode)&&void 0!==r?r:null);Rg(c&&l&&u,"argument-error"),this.apiKey=c,this.operation=u,this.code=l,this.continueUrl=null!==(a=o.continueUrl)&&void 0!==a?a:null,this.languageCode=null!==(i=o.languageCode)&&void 0!==i?i:null,this.tenantId=null!==(s=o.tenantId)&&void 0!==s?s:null}static parseLink(e){const t=function(e){const t=_(C(e)).link,n=t?_(C(t)).deep_link_id:null,r=_(C(e)).deep_link_id;return(r?_(C(r)).link:null)||r||n||t||e}(e);try{return new av(t)}catch(n){return null}}}class iv{constructor(){this.providerId=iv.PROVIDER_ID}static credential(e,t){return Jm._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=av.parseLink(t);return Rg(n,"argument-error"),Jm._fromEmailAndCode(e,n.code,n.tenantId)}}iv.PROVIDER_ID="password",iv.EMAIL_PASSWORD_SIGN_IN_METHOD="password",iv.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class sv{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class ov extends sv{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class cv extends ov{constructor(){super("facebook.com")}static credential(e){return ev._fromParams({providerId:cv.PROVIDER_ID,signInMethod:cv.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return cv.credentialFromTaggedObject(e)}static credentialFromError(e){return cv.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return cv.credential(t.oauthAccessToken)}catch(n){return null}}}cv.FACEBOOK_SIGN_IN_METHOD="facebook.com",cv.PROVIDER_ID="facebook.com";class lv extends ov{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return ev._fromParams({providerId:lv.PROVIDER_ID,signInMethod:lv.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return lv.credentialFromTaggedObject(e)}static credentialFromError(e){return lv.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:r}=t;if(!n&&!r)return null;try{return lv.credential(n,r)}catch(a){return null}}}lv.GOOGLE_SIGN_IN_METHOD="google.com",lv.PROVIDER_ID="google.com";class uv extends ov{constructor(){super("github.com")}static credential(e){return ev._fromParams({providerId:uv.PROVIDER_ID,signInMethod:uv.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return uv.credentialFromTaggedObject(e)}static credentialFromError(e){return uv.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return uv.credential(t.oauthAccessToken)}catch(n){return null}}}uv.GITHUB_SIGN_IN_METHOD="github.com",uv.PROVIDER_ID="github.com";class dv extends ov{constructor(){super("twitter.com")}static credential(e,t){return ev._fromParams({providerId:dv.PROVIDER_ID,signInMethod:dv.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return dv.credentialFromTaggedObject(e)}static credentialFromError(e){return dv.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=t;if(!n||!r)return null;try{return dv.credential(n,r)}catch(a){return null}}}dv.TWITTER_SIGN_IN_METHOD="twitter.com",dv.PROVIDER_ID="twitter.com";class hv{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=await hm._fromIdTokenResponse(e,n,r),i=fv(n);return new hv({user:a,providerId:i,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=fv(n);return new hv({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function fv(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class pv extends E{constructor(e,t,n,r){var a;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,pv.prototype),this.customData={appName:e.name,tenantId:null!==(a=e.tenantId)&&void 0!==a?a:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new pv(e,t,n,r)}}function gv(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw pv._fromErrorAndOperation(e,n,t,r);throw n}))}async function mv(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=await im(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return hv._forOperation(e,"link",r)}async function vv(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:r}=e;if(Ge(r.app))return Promise.reject(Ag(r));const a="reauthenticate";try{const i=await im(e,gv(r,a,t,e),n);Rg(i.idToken,r,"internal-error");const s=rm(i.idToken);Rg(s,r,"internal-error");const{sub:o}=s;return Rg(e.uid===o,r,"user-mismatch"),hv._forOperation(e,a,i)}catch(i){throw"auth/user-not-found"===(null===i||void 0===i?void 0:i.code)&&kg(r,"user-mismatch"),i}}async function yv(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Ge(e.app))return Promise.reject(Ag(e));const r="signIn",a=await gv(e,r,t),i=await hv._fromIdTokenResponse(e,r,a);return n||await e._updateCurrentUser(i.user),i}function bv(e,t){return Hg(e,"POST","/v2/accounts/mfaEnrollment:start",$g(e,t))}new WeakMap;const wv="__sak";class Ev{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(wv,"1"),this.storage.removeItem(wv),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class Tv extends Ev{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Am(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},a=this.storage.getItem(n);Cm()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Tv.type="LOCAL";const xv=Tv;function Sv(e){var t,n;const r=e.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),a=RegExp(`${r}=([^;]+)`);return null!==(n=null===(t=document.cookie.match(a))||void 0===t?void 0:t[1])&&void 0!==n?n:null}function Iv(e){return`${"http:"===window.location.protocol?"__dev_":"__HOST-"}FIREBASE_${e.split(":")[3]}`}class kv{constructor(){this.type="COOKIE",this.listenerUnsubscribes=new Map}_getFinalTarget(e){if(void 0===typeof window)return e;const t=new URL(`${window.location.origin}/__cookies__`);return t.searchParams.set("finalTarget",e),t}async _isAvailable(){var e;return!("boolean"===typeof isSecureContext&&!isSecureContext)&&("undefined"!==typeof navigator&&"undefined"!==typeof document&&(null===(e=navigator.cookieEnabled)||void 0===e||e))}async _set(e,t){}async _get(e){if(!this._isAvailable())return null;const t=Iv(e);if(window.cookieStore){const e=await window.cookieStore.get(t);return null===e||void 0===e?void 0:e.value}return Sv(t)}async _remove(e){if(!this._isAvailable())return;if(!await this._get(e))return;const t=Iv(e);document.cookie=`${t}=;Max-Age=34560000;Partitioned;Secure;SameSite=Strict;Path=/;Priority=High`,await fetch("/__cookies__",{method:"DELETE"}).catch((()=>{}))}_addListener(e,t){if(!this._isAvailable())return;const n=Iv(e);if(window.cookieStore){const e=e=>{const r=e.changed.find((e=>e.name===n));r&&t(r.value);e.deleted.find((e=>e.name===n))&&t(null)},r=()=>window.cookieStore.removeEventListener("change",e);return this.listenerUnsubscribes.set(t,r),window.cookieStore.addEventListener("change",e)}let r=Sv(n);const a=setInterval((()=>{const e=Sv(n);e!==r&&(t(e),r=e)}),1e3);this.listenerUnsubscribes.set(t,(()=>clearInterval(a)))}_removeListener(e,t){const n=this.listenerUnsubscribes.get(t);n&&(n(),this.listenerUnsubscribes.delete(t))}}kv.type="COOKIE";class _v extends Ev{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}_v.type="SESSION";const Cv=_v;class Av{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new Av(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:a}=t.data,i=this.handlersMap[r];if(!(null===i||void 0===i?void 0:i.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const s=Array.from(i).map((async e=>e(t.origin,a))),o=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}})))}(s);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:o})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Nv(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}Av.receivers=[];class Rv{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const r="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let a,i;return new Promise(((s,o)=>{const c=Nv("",20);r.port1.start();const l=setTimeout((()=>{o(new Error("unsupported_event"))}),n);i={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(l),a=setTimeout((()=>{o(new Error("timeout"))}),3e3);break;case"done":clearTimeout(a),s(t.data.response);break;default:clearTimeout(l),clearTimeout(a),o(new Error("invalid_response"))}}},this.handlers.add(i),r.port1.addEventListener("message",i.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[r.port2])})).finally((()=>{i&&this.removeMessageHandler(i)}))}}function Ov(){return window}function Dv(){return"undefined"!==typeof Ov().WorkerGlobalScope&&"function"===typeof Ov().importScripts}const Pv="firebaseLocalStorageDb",Lv="firebaseLocalStorage",Mv="fbase_key";class Fv{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function zv(e,t){return e.transaction([Lv],t?"readwrite":"readonly").objectStore(Lv)}function jv(){const e=indexedDB.open(Pv,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(Lv,{keyPath:Mv})}catch(r){n(r)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(Lv)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(Pv);return new Fv(e).toPromise()}(),t(await jv()))}))}))}async function Uv(e,t,n){const r=zv(e,!0).put({[Mv]:t,value:n});return new Fv(r).toPromise()}function Bv(e,t){const n=zv(e,!0).delete(t);return new Fv(n).toPromise()}class Vv{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await jv()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(n){if(t++>3)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Dv()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Av._getInstance(Dv()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new Rv(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await jv();return await Uv(e,wv,"1"),await Bv(e,wv),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>Uv(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=zv(e,!1).get(t),r=await new Fv(n).toPromise();return void 0===r?null:r.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>Bv(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=zv(e,!1).getAll();return new Fv(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:a}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(a)&&(this.notifyListeners(r,a),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Vv.type="LOCAL";const $v=Vv;function Hv(e,t){return Hg(e,"POST","/v2/accounts/mfaSignIn:start",$g(e,t))}zm("rcb"),new Fg(3e4,6e4);const Wv="recaptcha";async function Gv(e,t,n){var r;if(!e._getRecaptchaConfig())try{await Wm(e)}catch(a){console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let a;if(a="string"===typeof t?{phoneNumber:t}:t,"session"in a){const t=a.session;if("phoneNumber"in a){Rg("enroll"===t.type,e,"internal-error");const r={idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:a.phoneNumber,clientType:"CLIENT_TYPE_WEB"}},i=Hm(e,r,"mfaSmsEnrollment",(async(e,t)=>{if(t.phoneEnrollmentInfo.captchaResponse===Bm){Rg((null===n||void 0===n?void 0:n.type)===Wv,e,"argument-error");return bv(e,await Kv(e,t,n))}return bv(e,t)}),"PHONE_PROVIDER");return(await i.catch((e=>Promise.reject(e)))).phoneSessionInfo.sessionInfo}{Rg("signin"===t.type,e,"internal-error");const i=(null===(r=a.multiFactorHint)||void 0===r?void 0:r.uid)||a.multiFactorUid;Rg(i,e,"missing-multi-factor-info");const s={mfaPendingCredential:t.credential,mfaEnrollmentId:i,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}},o=Hm(e,s,"mfaSmsSignIn",(async(e,t)=>{if(t.phoneSignInInfo.captchaResponse===Bm){Rg((null===n||void 0===n?void 0:n.type)===Wv,e,"argument-error");return Hv(e,await Kv(e,t,n))}return Hv(e,t)}),"PHONE_PROVIDER");return(await o.catch((e=>Promise.reject(e)))).phoneResponseInfo.sessionInfo}}{const t={phoneNumber:a.phoneNumber,clientType:"CLIENT_TYPE_WEB"},r=Hm(e,t,"sendVerificationCode",(async(e,t)=>{if(t.captchaResponse===Bm){Rg((null===n||void 0===n?void 0:n.type)===Wv,e,"argument-error");return tv(e,await Kv(e,t,n))}return tv(e,t)}),"PHONE_PROVIDER");return(await r.catch((e=>Promise.reject(e)))).sessionInfo}}finally{null===n||void 0===n||n._reset()}}async function Kv(e,t,n){Rg(n.type===Wv,e,"argument-error");const r=await n.verify();Rg("string"===typeof r,e,"argument-error");const a=Object.assign({},t);if("phoneEnrollmentInfo"in a){const e=a.phoneEnrollmentInfo.phoneNumber,t=a.phoneEnrollmentInfo.captchaResponse,n=a.phoneEnrollmentInfo.clientType,i=a.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:r,captchaResponse:t,clientType:n,recaptchaVersion:i}}),a}if("phoneSignInInfo"in a){const e=a.phoneSignInInfo.captchaResponse,t=a.phoneSignInInfo.clientType,n=a.phoneSignInInfo.recaptchaVersion;return Object.assign(a,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:e,clientType:t,recaptchaVersion:n}}),a}return Object.assign(a,{recaptchaToken:r}),a}class qv{constructor(e){this.providerId=qv.PROVIDER_ID,this.auth=Pm(e)}verifyPhoneNumber(e,t){return Gv(this.auth,e,O(t))}static credential(e,t){return rv._fromVerification(e,t)}static credentialFromResult(e){const t=e;return qv.credentialFromTaggedObject(t)}static credentialFromError(e){return qv.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:n,temporaryProof:r}=t;return n&&r?rv._fromTokenResponse(n,r):null}}function Yv(e,t){return t?pm(t):(Rg(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}qv.PROVIDER_ID="phone",qv.PHONE_SIGN_IN_METHOD="phone";class Xv extends Ym{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Zm(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Zm(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Zm(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Qv(e){return yv(e.auth,new Xv(e),e.bypassAuthState)}function Jv(e){const{auth:t,user:n}=e;return Rg(n,t,"internal-error"),vv(n,new Xv(e),e.bypassAuthState)}async function Zv(e){const{auth:t,user:n}=e;return Rg(n,t,"internal-error"),mv(n,new Xv(e),e.bypassAuthState)}class ey{constructor(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:a,error:i,type:s}=e;if(i)return void this.reject(i);const o={auth:this.auth,requestUri:t,sessionId:n,tenantId:a||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(s)(o))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Qv;case"linkViaPopup":case"linkViaRedirect":return Zv;case"reauthViaPopup":case"reauthViaRedirect":return Jv;default:kg(this.auth,"internal-error")}}resolve(e){Dg(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Dg(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const ty=new Fg(2e3,1e4);class ny extends ey{constructor(e,t,n,r,a){super(e,t,r,a),this.provider=n,this.authWindow=null,this.pollId=null,ny.currentPopupAction&&ny.currentPopupAction.cancel(),ny.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Rg(e,this.auth,"internal-error"),e}async onExecution(){Dg(1===this.filter.length,"Popup operations only handle one event");const e=Nv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(_g(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(_g(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ny.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(_g(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(e,ty.get())};e()}}ny.currentPopupAction=null;const ry=new Map;class ay extends ey{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=ry.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=oy(t),r=sy(e);if(!await r._isAvailable())return!1;const a="true"===await r._get(n);return await r._remove(n),a}(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}ry.set(this.auth._key(),e)}return this.bypassAuthState||ry.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function iy(e,t){ry.set(e._key(),t)}function sy(e){return pm(e._redirectPersistence)}function oy(e){return vm("pendingRedirect",e.config.apiKey,e.name)}async function cy(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Ge(e.app))return Promise.reject(Ag(e));const r=Pm(e),a=Yv(r,t),i=new ay(r,a,n),s=await i.execute();return s&&!n&&(delete s.user._redirectEventId,await r._persistUserIfCurrent(s.user),await r._setRedirectUser(null,t)),s}class ly{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return dy(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!dy(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(_g(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(uy(e))}saveEventToCache(e){this.cachedEventUids.add(uy(e)),this.lastProcessedEventTime=Date.now()}}function uy(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function dy(e){let{type:t,error:n}=e;return"unknown"===t&&"auth/no-auth-event"===(null===n||void 0===n?void 0:n.code)}const hy=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,fy=/^https?/;async function py(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e){return Hg(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(e);for(const r of t)try{if(gy(r))return}catch(n){}kg(e,"unauthorized-domain")}function gy(e){const t=Pg(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const a=new URL(e);return""===a.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&a.hostname===r}if(!fy.test(n))return!1;if(hy.test(e))return r===e;const a=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(r)}const my=new Fg(3e4,6e4);function vy(){const e=Ov().___jsl;if(null===e||void 0===e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function yy(e){return new Promise(((t,n)=>{var r,a,i;function s(){vy(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{vy(),n(_g(e,"network-request-failed"))},timeout:my.get()})}if(null===(a=null===(r=Ov().gapi)||void 0===r?void 0:r.iframes)||void 0===a?void 0:a.Iframe)t(gapi.iframes.getContext());else{if(!(null===(i=Ov().gapi)||void 0===i?void 0:i.load)){const t=zm("iframefcb");return Ov()[t]=()=>{gapi.load?s():n(_g(e,"network-request-failed"))},Fm(`${Mm.gapiScript}?onload=${t}`).catch((e=>n(e)))}s()}})).catch((e=>{throw by=null,e}))}let by=null;const wy=new Fg(5e3,15e3),Ey={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Ty=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function xy(e){const t=e.config;Rg(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?zg(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,r={apiKey:t.apiKey,appName:e.name,v:Ye},a=Ty.get(e.config.apiHost);a&&(r.eid=a);const i=e._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${k(r).slice(1)}`}async function Sy(e){const t=await function(e){return by=by||yy(e),by}(e),n=Ov().gapi;return Rg(n,e,"internal-error"),t.open({where:document.body,url:xy(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Ey,dontclear:!0},(t=>new Promise((async(n,r)=>{await t.restyle({setHideOnLeave:!1});const a=_g(e,"network-request-failed"),i=Ov().setTimeout((()=>{r(a)}),wy.get());function s(){Ov().clearTimeout(i),n(t)}t.ping(s).then(s,(()=>{r(a)}))}))))}const Iy={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class ky{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function _y(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const i=Math.max((window.screen.availHeight-a)/2,0).toString(),s=Math.max((window.screen.availWidth-r)/2,0).toString();let o="";const c=Object.assign(Object.assign({},Iy),{width:r.toString(),height:a.toString(),top:i,left:s}),l=m().toLowerCase();n&&(o=Tm(l)?"_blank":n),wm(l)&&(t=t||"http://localhost",c.scrollbars="yes");const u=Object.entries(c).reduce(((e,t)=>{let[n,r]=t;return`${e}${n}=${r},`}),"");if(function(){var e;return _m(arguments.length>0&&void 0!==arguments[0]?arguments[0]:m())&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(l)&&"_self"!==o)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",o),new ky(null);const d=window.open(t||"",o,u);Rg(d,e,"popup-blocked");try{d.focus()}catch(h){}return new ky(d)}const Cy="__/auth/handler",Ay="emulator/auth/handler",Ny=encodeURIComponent("fac");async function Ry(e,t,n,r,a,i){Rg(e.config.authDomain,e,"auth-domain-config-required"),Rg(e.config.apiKey,e,"invalid-api-key");const s={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:Ye,eventId:a};if(t instanceof sv){t.setDefaultLanguage(e.languageCode),s.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(s.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(i||{}))s[e]=t}if(t instanceof ov){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(s.scopes=e.join(","))}e.tenantId&&(s.tid=e.tenantId);const o=s;for(const u of Object.keys(o))void 0===o[u]&&delete o[u];const c=await e._getAppCheckToken(),l=c?`#${Ny}=${encodeURIComponent(c)}`:"";return`${function(e){let{config:t}=e;if(!t.emulator)return`https://${t.authDomain}/${Cy}`;return zg(t,Ay)}(e)}?${k(o).slice(1)}${l}`}const Oy="webStorageSupport";const Dy=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Cv,this._completeRedirectFn=cy,this._overrideRedirectResult=iy}async _openPopup(e,t,n,r){var a;Dg(null===(a=this.eventManagers[e._key()])||void 0===a?void 0:a.manager,"_initialize() not called before _openPopup()");return _y(e,await Ry(e,t,n,Pg(),r),Nv())}async _openRedirect(e,t,n,r){await this._originValidation(e);return function(e){Ov().location.href=e}(await Ry(e,t,n,Pg(),r)),new Promise((()=>{}))}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(Dg(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await Sy(e),n=new ly(e);return t.register("authEvent",(t=>{Rg(null===t||void 0===t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Oy,{type:Oy},(n=>{var r;const a=null===(r=null===n||void 0===n?void 0:n[0])||void 0===r?void 0:r[Oy];void 0!==a&&t(!!a),kg(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=py(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Am()||Em()||_m()}};var Py="@firebase/auth",Ly="1.10.0";class My{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Rg(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const Fy=p("authIdTokenMaxAge")||300;let zy=null;var jy;Mm={loadJS:e=>new Promise(((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=_g("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)})),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},jy="Browser",He(new D("auth",((e,t)=>{let{options:n}=t;const r=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:s,authDomain:o}=r.options;Rg(s&&!s.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:s,authDomain:o,clientPlatform:jy,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Nm(jy)},l=new Dm(r,a,i,c);return function(e,t){const n=(null===t||void 0===t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(pm);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null===t||void 0===t?void 0:t.popupRedirectResolver)}(l,n),l}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),He(new D("auth-internal",(e=>(e=>new My(e))(Pm(e.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),Je(Py,Ly,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(jy)),Je(Py,Ly,"esm2017");const Uy=Xe({apiKey:"AIzaSyDo7X1BLIW1hNYQpJLZcDws_L4aGHJWXOQ",authDomain:"asignacion-plazas.firebaseapp.com",projectId:"asignacion-plazas",storageBucket:"asignacion-plazas.firebasestorage.app",messagingSenderId:"525955676079",appId:"1:525955676079:web:a7e0b00391e75c902fe15a",measurementId:"G-E0DLWYPVKP"}),By=function(e,t){const n="object"==typeof e?e:Qe(),r="string"==typeof e?e:t||_a,a=We(n,"firestore").getImmediate({identifier:r});if(!a._initialized){const e=(e=>{const t=h(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]})("firestore");e&&Oh(a,...e)}return a}(Uy);!function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qe();const t=We(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=We(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(S(n.getOptions(),null!==t&&void 0!==t?t:{}))return e;kg(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:Dy,persistence:[$v,xv,Cv]}),r=p("authTokenSyncURL");if(r&&"boolean"===typeof isSecureContext&&isSecureContext){const e=new URL(r,location.origin);if(location.origin===e.origin){const t=(a=e.toString(),async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>Fy)return;const r=null===t||void 0===t?void 0:t.token;zy!==r&&(zy=r,await fetch(a,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))});!function(e,t,n){O(e).beforeAuthStateChanged(t,n)}(n,t,(()=>t(n.currentUser))),function(e,t,n,r){O(e).onIdTokenChanged(t,n,r)}(n,(e=>t(e)))}}var a;const i=h("auth");i&&Gm(n,`http://${i}`)}(Uy);try{(function(e,t){Rt("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=e._freezeSettings();return Hh(e,lh.provider,{build:e=>new ch(e,n.cacheSizeBytes,null==t?void 0:t.forceOwnership)}),Promise.resolve()})(By).catch((e=>{"failed-precondition"===e.code||e.code}))}catch(kC){}const Vy=async(e,t,n,r)=>{try{if(!e||!e.length)return r&&r("No hay solicitudes pendientes para procesar"),{success:!0,message:"No hay solicitudes pendientes para procesar"};r&&r("Iniciando procesamiento de solicitudes...");const a=[...e],i=t.map((e=>({orden:e.order,centroActual:e.id,estaAsignada:!0,docId:e.docId,timestamp:e.timestamp||0,centro:e.centro,localidad:e.localidad,municipio:e.municipio}))),s=[...a,...i].sort(((e,t)=>Number(e.orden)-Number(t.orden)));r&&r(`Procesando ${s.length} solicitudes por prioridad...`);const o=n.map((e=>({...e,asignadas:0,asignacionesPorOrden:[]}))),c=o.reduce(((e,t)=>(e[t.id]=t,e)),{});r&&r("Eliminando asignaciones existentes para recalcular...");for(const e of t)e.docId&&await Wf(Fh(By,"asignaciones",e.docId));for(const e of o)e.docId&&await Hf(Fh(By,"centros",e.docId),{asignadas:0});let l=0,u=0;const d=[],h=new Set,f=[],p=[];for(const e of s){if(h.has(e.orden))continue;r&&r(`Procesando solicitud/asignaci\xf3n #${e.orden} (procesadas: ${h.size})`);let t=!1,n=null;if(e.estaAsignada&&e.centroActual){const r=c[e.centroActual];if(r&&r.asignadas<r.plazas){r.asignadas++,r.asignacionesPorOrden.push(e.orden);const a={order:e.orden,id:r.id,centerId:r.id,localidad:r.localidad||"",centro:r.centro||r.nombre||"Centro sin nombre",municipio:r.municipio||"",timestamp:Date.now()};Object.keys(a).forEach((e=>{void 0===a[e]&&(console.warn(`Campo ${e} es undefined en asignaci\xf3n priorizada. Estableciendo valor predeterminado.`),e.includes("Id")||"order"===e?a[e]="0":"timestamp"===e?a[e]=Date.now():"boolean"===typeof a[e]?a[e]=!1:a[e]="")}));const i=Fh(Mh(By,"asignaciones"));await $f(i,a),d.push({...a,docId:i.id}),t=!0,n=r,p.push({tipo:"MANTENIDA",orden:e.orden,centroId:r.id,centro:r.centro,mensaje:`Asignaci\xf3n mantenida en ${r.centro}`})}}if(!t){const r=e.centrosIds||(e.estaAsignada?[e.centroActual]:[]),a=r.length>0?r.map((e=>c[e])).filter(Boolean):o.sort(((e,t)=>e.asignadas/e.plazas-t.asignadas/t.plazas));for(const i of a){if(i.asignadas<i.plazas){i.asignadas++,i.asignacionesPorOrden.push(e.orden);const r={order:e.orden,id:i.id,centerId:i.id,localidad:i.localidad||"",centro:i.centro||i.nombre||"Centro sin nombre",municipio:i.municipio||"",timestamp:Date.now()};Object.keys(r).forEach((e=>{void 0===r[e]&&(console.warn(`Campo ${e} es undefined en la asignaci\xf3n. Se establecer\xe1 valor predeterminado.`),e.includes("Id")||"order"===e?r[e]="0":r[e]="timestamp"===e?Date.now():"")}));const a=Fh(Mh(By,"asignaciones"));await $f(a,r),d.push({...r,docId:a.id}),l++,t=!0,n=i,!e.estaAsignada&&e.docId&&f.push(e.docId),p.push({tipo:e.estaAsignada?"REASIGNADA":"ASIGNADA",orden:e.orden,centroId:i.id,centro:i.centro,mensaje:e.estaAsignada?`Reasignada de ${e.centro||"centro anterior"} a ${i.centro}`:`Asignada a ${i.centro}`});break}if(i.asignacionesPorOrden.length>0){const r=i.asignacionesPorOrden,a=Math.max(...r);if(Number(a)>Number(e.orden)){console.log(`Posible desplazamiento: Orden ${e.orden} tiene mayor prioridad que ${a} en ${i.centro}`);const r=d.find((e=>e.order==a&&e.id===i.id));if(r){s.find((e=>e.orden==a));const c=o.filter((e=>e.id!==i.id&&e.asignadas<e.plazas));if(c.length>0){const s=c[0];i.asignacionesPorOrden=i.asignacionesPorOrden.filter((e=>e!=a)),i.asignacionesPorOrden.push(e.orden);const o={order:e.orden,id:i.id,centerId:i.id,localidad:i.localidad||"",centro:i.centro||i.nombre||"Centro sin nombre",municipio:i.municipio||"",timestamp:Date.now(),priorizado:!0};Object.keys(o).forEach((e=>{void 0===o[e]&&(console.warn(`Campo ${e} es undefined en asignaci\xf3n priorizada. Estableciendo valor predeterminado.`),e.includes("Id")||"order"===e?o[e]="0":"timestamp"===e?o[e]=Date.now():"boolean"===typeof o[e]?o[e]=!1:o[e]="")}));const l=Fh(Mh(By,"asignaciones"));await $f(l,o),d.push({...o,docId:l.id}),s.asignadas++,s.asignacionesPorOrden.push(a);const h={order:a,id:s.id,centerId:s.id,localidad:s.localidad||"",centro:s.centro||s.nombre||"Centro sin nombre",municipio:s.municipio||"",timestamp:Date.now(),desplazada:!0,centroAnterior:i.centro||i.nombre||"Centro anterior"};Object.keys(h).forEach((e=>{void 0===h[e]&&(console.warn(`Campo ${e} es undefined en asignaci\xf3n reasignada. Estableciendo valor predeterminado.`),e.includes("Id")||"order"===e?h[e]="0":"timestamp"===e?h[e]=Date.now():"boolean"===typeof h[e]?h[e]=!1:h[e]="")}));const g=Fh(Mh(By,"asignaciones"));await $f(g,h),r.docId&&await Wf(Fh(By,"asignaciones",r.docId));const m=d.findIndex((e=>e.order==a&&e.id===i.id));m>=0&&d.splice(m,1),d.push({...h,docId:g.id}),t=!0,n=i,u++,!e.estaAsignada&&e.docId&&f.push(e.docId),p.push({tipo:"PRIORIZADA",orden:e.orden,centroId:i.id,centro:i.centro,mensaje:`Priorizada en ${i.centro}, desplazando a orden ${a}`}),p.push({tipo:"DESPLAZADA",orden:a,centroId:s.id,centro:s.centro,centroAnterior:i.centro,mensaje:`Desplazada de ${i.centro} a ${s.centro} por orden ${e.orden} de mayor prioridad`});break}}}}}}h.add(e.orden),t||(p.push({tipo:"NO_ASIGNABLE",orden:e.orden,mensaje:"No hay plazas disponibles en ninguno de los centros solicitados"}),!e.estaAsignada&&e.docId&&f.push(e.docId))}r&&r(`Registrando ${p.length} operaciones en el historial...`);for(const t of p)try{const n=Fh(Mh(By,"historialSolicitudes")),r={orden:t.orden,estado:t.tipo,fechaHistorico:(new Date).toISOString(),timestamp:Date.now()};void 0!==t.centroId&&(r.centroId=t.centroId),void 0!==t.centro&&(r.centroAsignado=t.centro),void 0!==t.centroAnterior&&(r.centroAnterior=t.centroAnterior),void 0!==t.mensaje&&(r.mensaje=t.mensaje);const a=e.find((e=>e.orden===t.orden));a&&(a.centrosIds||a.centrosSeleccionados)&&(r.centrosSeleccionados=a.centrosIds||a.centrosSeleccionados),await $f(n,r)}catch(kC){console.error(`Error al registrar historial para orden ${t.orden}:`,kC)}if(f.length>0){r&&r(`Eliminando ${f.length} solicitudes procesadas...`);let e=0;for(const t of f)try{await Wf(Fh(By,"solicitudesPendientes",t)),e++}catch(kC){console.error(`Error al eliminar solicitud ${t}:`,kC)}r&&r(`Se eliminaron ${e} solicitudes pendientes ya procesadas.`)}r&&r("Actualizando contadores en los centros...");for(const e of o)e.docId&&await Hf(Fh(By,"centros",e.docId),{asignadas:e.asignadas});return r&&r(`Procesamiento completado. ${l} nuevas asignaciones, ${u} reasignaciones.`),{success:!0,nuevasAsignaciones:d,eliminadas:f.length,asignacionesNuevas:l,reasignaciones:u,message:`Asignaciones procesadas por prioridad. ${l} nuevas, ${u} reasignaciones.`}}catch(kC){return console.error("Error en procesarSolicitudes:",kC),r&&r("Error: "+kC.message),{success:!1,message:kC.message}}};var $y=n(579);const Hy=e=>{let{assignments:t=[],availablePlazas:n=[]}=e;const[a,i]=(0,r.useState)(""),[s,o]=(0,r.useState)("TODOS"),[c,l]=(0,r.useState)(""),[u,d]=(0,r.useState)(1),[h]=(0,r.useState)(10),[f,p]=(0,r.useState)({key:"order",direction:"asc"}),[g,m]=(0,r.useState)(!1);(0,r.useEffect)((()=>{if(!Array.isArray(t))return l("Error: Los datos de asignaciones no son v\xe1lidos"),void console.error("Dashboard: assignments debe ser un array");const e=t.filter((e=>!e||"object"!==typeof e||!e.numeroOrden&&!e.order||!e.nombreCentro&&!e.centro||!e.timestamp));e.length>0&&console.warn("Algunas asignaciones tienen estructura inv\xe1lida:",e),l("")}),[t]);const v=e=>{if(!e)return"Fecha no disponible";try{if(e&&"object"===typeof e&&e.seconds){return new Date(1e3*e.seconds).toLocaleString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}if("number"===typeof e){return new Date(e).toLocaleString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}const t=new Date(e);return isNaN(t.getTime())?"Fecha no disponible":t.toLocaleString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch(c){return console.error("Error al formatear fecha:",e,c),"Fecha no disponible"}};if(c)return(0,$y.jsx)("div",{style:{textAlign:"center",padding:"20px",backgroundColor:"#fff3cd",borderRadius:"8px",color:"#856404",margin:"20px 0"},children:(0,$y.jsx)("p",{children:c})});if(!t.length)return(0,$y.jsxs)("div",{style:{textAlign:"center",padding:"40px 20px",backgroundColor:"#f5f7fa",borderRadius:"8px",color:"#5c6c7c"},children:[(0,$y.jsx)("div",{style:{fontSize:"36px",marginBottom:"15px"},children:"\ud83d\udccb"}),(0,$y.jsx)("div",{style:{fontSize:"18px",fontWeight:"bold",marginBottom:"10px"},children:"No hay asignaciones realizadas"}),(0,$y.jsx)("div",{style:{fontSize:"14px"},children:"Las asignaciones aparecer\xe1n aqu\xed una vez procesadas las solicitudes"})]});const y=(()=>{if(!Array.isArray(t))return[];let e=t;return a&&(e=e.filter((e=>{var t;if(!e)return!1;return[null===(t=e.numeroOrden||e.order)||void 0===t?void 0:t.toString(),e.nombreCentro||e.centro,e.localidad,e.municipio].filter(Boolean).some((e=>e.toLowerCase().includes(a.toLowerCase())))}))),"TODOS"!==s&&(e=e.filter((e=>e&&e.estado===s))),(n=e)&&Array.isArray(n)?[...n].sort(((e,t)=>{if(!e||!t)return 0;let n,r;return"order"===f.key?(n=void 0!==e.numeroOrden?e.numeroOrden:e.order,r=void 0!==t.numeroOrden?t.numeroOrden:t.order):"centro"===f.key?(n=e.nombreCentro||e.centro||"",r=t.nombreCentro||t.centro||""):(n=e[f.key],r=t[f.key]),"order"===f.key&&(n=Number(n)||0,r=Number(r)||0),n<r?"asc"===f.direction?-1:1:n>r?"asc"===f.direction?1:-1:0})):[];var n})(),b=Math.ceil(y.length/h),w=u*h,E=w-h,T=y.slice(E,w),x=e=>{e<1||e>b||d(e)},S=e=>{p((t=>({key:e,direction:t.key===e&&"asc"===t.direction?"desc":"asc"})))},I={container:{position:"relative",padding:"20px",backgroundColor:"#f4f6f9",borderRadius:"8px",boxShadow:"0 4px 8px rgba(0,0,0,0.1)"},infoContainer:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px",flexWrap:"wrap",gap:"15px"},statsContainer:{display:"flex",gap:"15px",flexWrap:"wrap"},statCard:{backgroundColor:"#ffffff",borderRadius:"6px",padding:"15px",minWidth:"140px",boxShadow:"0 2px 5px rgba(0,0,0,0.06)",flex:1},statValue:{fontSize:"24px",fontWeight:"bold",color:"#2d3748",marginBottom:"5px"},statLabel:{fontSize:"13px",color:"#718096"},searchBar:{display:"flex",gap:"10px",marginBottom:"20px"},input:{flex:"1",padding:"10px 12px",borderRadius:"6px",border:"1px solid #e2e8f0",fontSize:"14px"},select:{padding:"10px 12px",borderRadius:"6px",border:"1px solid #e2e8f0",fontSize:"14px",backgroundColor:"#fff"},tableContainer:{overflowX:"auto",backgroundColor:"#ffffff",borderRadius:"8px",boxShadow:"0 2px 5px rgba(0,0,0,0.05)"},table:{width:"100%",borderCollapse:"collapse",fontSize:"14px"},tableHeader:{backgroundColor:"#f8fafc",color:"#4a5568",textAlign:"left",padding:"12px 15px",fontWeight:"bold",borderBottom:"2px solid #e2e8f0",cursor:"pointer",transition:"background-color 0.2s",position:"sticky",top:0},tableCell:{padding:"12px 15px",borderBottom:"1px solid #e2e8f0",color:"#2d3748",whiteSpace:"nowrap"},pagination:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"15px 0",fontSize:"14px"},pageButton:{padding:"6px 12px",margin:"0 4px",backgroundColor:"#f1f5f9",border:"none",borderRadius:"4px",cursor:"pointer",transition:"background-color 0.2s",fontSize:"13px"},activePageButton:{backgroundColor:"#3182ce",color:"#ffffff"},textCenter:{textAlign:"center"},badge:{display:"inline-block",padding:"3px 8px",borderRadius:"12px",fontSize:"12px",fontWeight:"bold",textAlign:"center"},badgePrimary:{backgroundColor:"#ebf5ff",color:"#3182ce"},badgeSuccess:{backgroundColor:"#e6fffa",color:"#38b2ac"},badgeWarning:{backgroundColor:"#fffaf0",color:"#dd6b20"},badgeReasignado:{backgroundColor:"#fef0f5",color:"#d53f8c",border:"1px dashed #d53f8c"},infoRow:{marginBottom:"15px",backgroundColor:"#f8fafc",borderRadius:"6px",padding:"10px 15px",fontSize:"14px",color:"#4a5568",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},orderContainer:{display:"flex",alignItems:"center",gap:"8px"},orderBadge:{color:"#000",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"16px",fontWeight:"bold"},sortIcon:{marginLeft:"4px",display:"inline-block",fontSize:"10px"},leyendaContainer:{marginTop:"20px",padding:"15px",backgroundColor:"#ffffff",borderRadius:"8px",boxShadow:"0 2px 5px rgba(0,0,0,0.05)",fontSize:"13px"},leyendaTitle:{fontSize:"14px",fontWeight:"bold",marginBottom:"10px"},leyendaItems:{display:"flex",flexWrap:"wrap",gap:"15px"},leyendaItem:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"}},k={total:y.length,centros:[...new Set(y.filter((e=>"NO_ASIGNABLE"!==e.estado)).map((e=>e.nombreCentro||e.centro)))].length,reasignados:y.filter((e=>e.reasignado)).length,noAsignables:y.filter((e=>"NO_ASIGNABLE"===e.estado||"REASIGNACION_NO_VIABLE"===e.estado)).length};new Set(y.filter((e=>e.estado)).map((e=>e.estado)));return(0,$y.jsxs)("div",{style:I.container,children:[(0,$y.jsxs)("div",{style:{padding:"15px",backgroundColor:"#fef0f5",borderRadius:"8px",marginBottom:"20px",borderLeft:"4px solid #e53e3e",color:"#e53e3e"},children:[(0,$y.jsx)("h3",{style:{margin:"0 0 10px 0",fontSize:"18px"},children:"\u26a0\ufe0f Aviso Importante"}),(0,$y.jsx)("p",{style:{margin:"0 0 10px 0"},children:"Los datos han sido borrados debido a un conflicto de numeraciones. El error ha sido resuelto."}),(0,$y.jsx)("p",{style:{margin:"0",fontWeight:"bold"},children:"Por favor, vuelva a introducir su solicitud."})]}),(0,$y.jsx)("div",{style:I.infoContainer,children:(0,$y.jsxs)("div",{style:I.statsContainer,children:[(0,$y.jsxs)("div",{style:I.statCard,children:[(0,$y.jsx)("div",{style:I.statValue,children:k.total}),(0,$y.jsx)("div",{style:I.statLabel,children:"Asignaciones totales"})]}),(0,$y.jsxs)("div",{style:I.statCard,children:[(0,$y.jsx)("div",{style:I.statValue,children:k.centros}),(0,$y.jsx)("div",{style:I.statLabel,children:"Centros con asignaciones"})]}),(0,$y.jsxs)("div",{style:I.statCard,children:[(0,$y.jsx)("div",{style:I.statValue,children:k.reasignados}),(0,$y.jsx)("div",{style:I.statLabel,children:"Reasignaciones"})]}),(0,$y.jsxs)("div",{style:{...I.statCard,backgroundColor:k.noAsignables>0?"#fff5f5":"#ffffff",borderLeft:k.noAsignables>0?"3px solid #f56565":"none"},children:[(0,$y.jsx)("div",{style:{...I.statValue,color:k.noAsignables>0?"#e53e3e":"#2d3748"},children:k.noAsignables}),(0,$y.jsx)("div",{style:I.statLabel,children:"No asignables"})]})]})}),(()=>{const e=t.filter((e=>!(!0===e.noAsignable||"NO_ASIGNABLE"===e.estado||"REASIGNACION_NO_VIABLE"===e.estado))).reduce(((e,t)=>{if(!t)return e;const n=t.centerId||t.id;return n?(e[n]||(e[n]={id:n,centro:t.nombreCentro||t.centro||"Centro desconocido",count:0,plazas:0}),e[n].count++,e):e}),{});for(const t in e){const r=n.find((e=>e.id===t));r&&(e[t].plazas=r.plazas||0)}const r=Object.values(e).filter((e=>e.count>e.plazas&&e.plazas>0));return r.length>0?(0,$y.jsxs)("div",{style:{backgroundColor:"#fff5f5",borderLeft:"4px solid #e53e3e",borderRadius:"4px",padding:"12px 15px",marginBottom:"20px",fontSize:"14px",color:"#742a2a",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[(0,$y.jsx)("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"16px"},children:"\u26a0\ufe0f Se detectaron centros con exceso de asignaciones"}),(0,$y.jsx)("div",{style:{marginBottom:"10px"},children:"Los siguientes centros tienen m\xe1s asignaciones que plazas disponibles:"}),(0,$y.jsx)("ul",{style:{margin:"10px 0",paddingLeft:"25px"},children:r.map((e=>(0,$y.jsxs)("li",{style:{marginBottom:"5px"},children:[(0,$y.jsxs)("strong",{children:[e.centro,":"]})," ",e.count," asignaciones para ",e.plazas," plazas"]},e.id)))}),(0,$y.jsx)("div",{style:{marginTop:"10px",fontSize:"13px"},children:"Se recomienda ejecutar la verificaci\xf3n y correcci\xf3n autom\xe1tica de asignaciones."})]}):null})(),(0,$y.jsxs)("div",{style:I.searchBar,children:[(0,$y.jsx)("input",{type:"text",placeholder:"Buscar por n\xba de orden, centro, localidad...",value:a,onChange:e=>{i(e.target.value),d(1)},style:I.input}),(0,$y.jsxs)("select",{value:s,onChange:e=>{o(e.target.value),d(1)},style:I.select,children:[(0,$y.jsx)("option",{value:"TODOS",children:"Todos los estados"}),(0,$y.jsx)("option",{value:"ASIGNADA",children:"Asignada"}),(0,$y.jsx)("option",{value:"REASIGNADO",children:"Reasignada"}),(0,$y.jsx)("option",{value:"NO_ASIGNABLE",children:"No se puede asignar"}),(0,$y.jsx)("option",{value:"REASIGNACION_NO_VIABLE",children:"No se puede reasignar"})]})]}),(0,$y.jsx)("div",{style:I.tableContainer,children:(0,$y.jsxs)("table",{style:I.table,children:[(0,$y.jsx)("thead",{children:(0,$y.jsxs)("tr",{children:[(0,$y.jsx)("th",{style:I.tableHeader,onClick:()=>S("order"),children:(0,$y.jsxs)("div",{style:I.orderContainer,children:["N\xba Orden",(0,$y.jsx)("span",{style:I.sortIcon,children:"order"===f.key&&("asc"===f.direction?"\u25b2":"\u25bc")})]})}),(0,$y.jsxs)("th",{style:I.tableHeader,onClick:()=>S("centro"),children:["Centro",(0,$y.jsx)("span",{style:I.sortIcon,children:"centro"===f.key&&("asc"===f.direction?"\u25b2":"\u25bc")})]}),(0,$y.jsxs)("th",{style:I.tableHeader,onClick:()=>S("localidad"),children:["Ubicaci\xf3n",(0,$y.jsx)("span",{style:{fontSize:"12px",fontWeight:"normal",display:"block"},children:"Localidad / Municipio"}),(0,$y.jsx)("span",{style:I.sortIcon,children:"localidad"===f.key&&("asc"===f.direction?"\u25b2":"\u25bc")})]}),(0,$y.jsxs)("th",{style:I.tableHeader,onClick:()=>S("timestamp"),children:["Fecha",(0,$y.jsx)("span",{style:I.sortIcon,children:"timestamp"===f.key&&("asc"===f.direction?"\u25b2":"\u25bc")})]})]})}),(0,$y.jsxs)("tbody",{children:[T.map(((e,t)=>{let n={};return"NO_ASIGNABLE"===e.estado?n={backgroundColor:"#fff5f5"}:"REASIGNACION_NO_VIABLE"===e.estado?n={backgroundColor:"#fffaf0"}:e.reasignado&&(n={backgroundColor:"#fff9fb"}),(0,$y.jsxs)("tr",{style:n,children:[(0,$y.jsx)("td",{style:I.tableCell,children:(0,$y.jsx)("div",{style:I.orderContainer,children:(0,$y.jsx)("div",{style:I.orderBadge,children:e.numeroOrden||e.order})})}),(0,$y.jsx)("td",{style:I.tableCell,children:(0,$y.jsx)("div",{children:"NO_ASIGNABLE"===e.estado?(0,$y.jsxs)("div",{children:[(0,$y.jsx)("div",{style:{backgroundColor:"#f56565",color:"white",padding:"3px 8px",borderRadius:"4px",display:"inline-block",fontWeight:"bold",fontSize:"12px",marginBottom:"5px"},children:"No se puede asignar"}),(0,$y.jsx)("strong",{children:e.nombreCentro||e.centerName||e.centro||"Centro seleccionado"}),(0,$y.jsx)("div",{style:{fontSize:"12px",color:"#d53f8c",marginTop:"4px"},children:"Reasignado: no hay plaza disponible"})]}):"REASIGNACION_NO_VIABLE"===e.estado?(0,$y.jsxs)("div",{children:[(0,$y.jsx)("div",{style:{backgroundColor:"#ed8936",color:"white",padding:"3px 8px",borderRadius:"4px",display:"inline-block",fontWeight:"bold",fontSize:"12px",marginBottom:"5px"},children:"No se puede reasignar"}),(0,$y.jsx)("strong",{children:e.nombreCentro||e.centerName||e.centro}),(0,$y.jsx)("div",{style:{fontSize:"12px",color:"#d53f8c",marginTop:"4px"},children:"Reasignado: no hay plaza disponible"})]}):(0,$y.jsxs)("div",{children:[(0,$y.jsx)("strong",{children:e.nombreCentro||e.centerName||e.centro}),e.reasignado&&(0,$y.jsxs)("div",{style:{fontSize:"12px",color:"#d53f8c",marginTop:"4px"},children:["Reasignado: ",e.centroOriginal||e.centroPrevio]})]})})}),(0,$y.jsx)("td",{style:I.tableCell,children:(0,$y.jsxs)("div",{children:[e.localidad&&(0,$y.jsx)("div",{style:{fontWeight:"medium"},children:e.localidad}),e.municipio&&e.municipio!==e.localidad&&(0,$y.jsxs)("div",{style:{color:"#4a5568",fontSize:"13px",marginTop:e.localidad?"3px":"0",display:"flex",alignItems:"center"},children:[(0,$y.jsx)("span",{style:{marginRight:"4px"},children:"\ud83d\udccd"}),e.municipio]}),!e.localidad&&!e.municipio&&(0,$y.jsx)("span",{style:{color:"#a0aec0",fontStyle:"italic"}})]})}),(0,$y.jsx)("td",{style:I.tableCell,children:v(e.timestamp)})]},e.docId||t)})),0===T.length&&(0,$y.jsx)("tr",{children:(0,$y.jsx)("td",{colSpan:"5",style:{...I.tableCell,textAlign:"center",padding:"30px 15px"},children:"No se encontraron asignaciones que coincidan con los filtros."})})]})]})}),b>1&&(0,$y.jsxs)("div",{style:I.pagination,children:[(0,$y.jsxs)("div",{children:["Mostrando ",E+1,"-",Math.min(w,y.length)," de ",y.length]}),(0,$y.jsxs)("div",{children:[(0,$y.jsx)("button",{style:I.pageButton,onClick:()=>x(1),disabled:1===u,children:"\xab"}),(0,$y.jsx)("button",{style:I.pageButton,onClick:()=>x(u-1),disabled:1===u,children:"\u2039"}),Array.from({length:Math.min(5,b)},((e,t)=>{let n;return n=b<=5||u<=3?t+1:u>=b-2?b-4+t:u-2+t,(0,$y.jsx)("button",{style:{...I.pageButton,...u===n?I.activePageButton:{}},onClick:()=>x(n),children:n},n)})),(0,$y.jsx)("button",{style:I.pageButton,onClick:()=>x(u+1),disabled:u===b,children:"\u203a"}),(0,$y.jsx)("button",{style:I.pageButton,onClick:()=>x(b),disabled:u===b,children:"\xbb"})]})]})]})},Wy=e=>{let{availablePlazas:t=[],assignments:n=[],searchTerm:a="",setSearchTerm:i,orderNumber:s,setOrderNumber:o,centrosSeleccionados:c=[],setCentrosSeleccionados:l,handleOrderSubmit:u,isProcessing:d=!1}=e;const[h,f]=(0,r.useState)(""),[p,g]=(0,r.useState)(1),[m,v]=(0,r.useState)(10),[y,b]=(0,r.useState)("undefined"!==typeof window?window.innerWidth:1200),[w,E]=(0,r.useState)(null),[T,x]=(0,r.useState)(""),[S,I]=(0,r.useState)(""),[k,_]=(0,r.useState)(""),[C,A]=(0,r.useState)(null);(0,r.useEffect)((()=>{i&&o&&l&&u||console.error("PlazasDisponibles: Faltan funciones de callback requeridas")}),[i,o,l,u]),(0,r.useEffect)((()=>{const e=()=>{b(window.innerWidth)};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]);const N=y<768,R=e=>{const n=new Set;return t.forEach((t=>{t[e]&&n.add(t[e])})),Array.from(n).sort()},O=R("asi"),D=R("departamento"),P=R("municipio"),L=[...t.filter((e=>{if(a){const t=a.toLowerCase();if(!(e.centro&&e.centro.toLowerCase().includes(t)||e.nombre&&e.nombre.toLowerCase().includes(t)||e.nombreCentro&&e.nombreCentro.toLowerCase().includes(t)||e.localidad&&e.localidad.toLowerCase().includes(t)||e.municipio&&e.municipio.toLowerCase().includes(t)||e.codigo&&e.codigo.toLowerCase().includes(t)||e.asi&&e.asi.toLowerCase().includes(t)||e.departamento&&e.departamento.toLowerCase().includes(t)))return!1}return(!T||e.asi===T)&&(!S||e.departamento===S)&&(!k||e.municipio===k)}))].sort(((e,t)=>{var n;const r=e.plazas-(e.asignadas||0),a=t.plazas-(t.asignadas||0);return 0===a&&r>0?-1:0===r&&a>0?1:r!==a?a-r:(null===(n=e.centro)||void 0===n?void 0:n.localeCompare(t.centro||""))||0})),M=Math.ceil(L.length/m),F=p*m,z=F-m,j=L.slice(z,F),U=t.reduce(((e,t)=>e+(t.plazas||0)),0),B=(t.reduce(((e,t)=>e+(t.asignadas||0)),0),()=>{E(null)}),V=e=>{try{const t=e.target.value;if(!t)return void console.error("ID de centro inv\xe1lido:",e.target.value);e.target.checked?c.includes(t)||l((e=>[...e,t])):l((e=>e.filter((e=>e!==t))))}catch(h){console.error("Error al seleccionar centro:",h)}};return(0,$y.jsxs)("div",{className:"plazas-container",children:[C&&(0,$y.jsx)("div",{className:`submit-message ${C.type}`,style:{padding:"10px 15px",margin:"10px 0",borderRadius:"4px",backgroundColor:"success"===C.type?"#d4edda":"#f8d7da",color:"success"===C.type?"#155724":"#721c24",border:"1px solid "+("success"===C.type?"#c3e6cb":"#f5c6cb")},children:C.message}),(0,$y.jsxs)("div",{style:{marginBottom:"25px",padding:"20px",backgroundColor:"#f8f9fa",borderRadius:"8px",border:"1px solid #e9ecef",boxShadow:"0 2px 8px rgba(0,0,0,0.05)"},children:[(0,$y.jsx)("h3",{style:{fontSize:"18px",color:"#343a40",marginTop:0,marginBottom:"15px",borderBottom:"2px solid #e9ecef",paddingBottom:"10px"},children:"Solicitar una plaza"}),(0,$y.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),f(""),!s)return void f("Por favor ingrese un n\xfamero de orden");if(!c.length)return void f("Por favor seleccione al menos un centro");const n=c.filter((e=>{const n=t.find((t=>t.id===e));return!n||n.plazas<=n.asignadas}));n.length>0?f("Algunos centros seleccionados ya no tienen plazas disponibles"):u(s,c)},children:[(0,$y.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,$y.jsx)("label",{htmlFor:"orderNumber",style:{display:"block",marginBottom:"8px",fontWeight:"bold",color:"#495057"},children:"N\xfamero de Orden:"}),(0,$y.jsx)("input",{type:"number",id:"orderNumber",value:s,onChange:e=>{const t=e.target.value;if(f(""),""===t)return void o("");const n=Number(t);isNaN(n)?f("Por favor ingrese un n\xfamero v\xe1lido"):n<1?f("El n\xfamero de orden debe ser mayor a 0"):Number.isInteger(n)?o(n):f("El n\xfamero de orden debe ser un n\xfamero entero")},style:{width:"100%",padding:"12px 15px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"16px",boxShadow:"inset 0 1px 3px rgba(0,0,0,0.05)"},required:!0,placeholder:"Introduce tu n\xfamero de orden"})]}),(0,$y.jsxs)("div",{style:{padding:"12px 15px",backgroundColor:"#e6f7ff",border:"1px solid #91d5ff",borderRadius:"6px",marginBottom:"15px",fontSize:"14px",color:"#1890ff",display:"flex",alignItems:"flex-start",gap:"10px"},children:[(0,$y.jsx)("span",{style:{fontSize:"18px"},children:"\u2139\ufe0f"}),(0,$y.jsxs)("div",{children:[(0,$y.jsx)("strong",{children:"Informaci\xf3n importante:"})," Puedes solicitar plazas aunque aparezcan como completas. El sistema asignar\xe1 las plazas priorizando por n\xfamero de orden (menor n\xfamero = mayor prioridad), incluso si la plaza ya est\xe1 asignada a alguien con un n\xfamero de orden mayor."]})]}),(0,$y.jsxs)("div",{style:{padding:"10px 15px",backgroundColor:"#e9f5fe",borderRadius:"6px",marginBottom:"20px",fontSize:"14px",borderLeft:"4px solid #3498db"},children:[(0,$y.jsx)("strong",{children:"Importante:"})," Selecciona tus centros por orden de preferencia. El primer centro que selecciones ser\xe1 tu primera opci\xf3n."]}),c.length>0&&(0,$y.jsxs)("div",{style:{marginBottom:"20px",padding:"15px",backgroundColor:"#e8f5e9",borderRadius:"6px",border:"1px solid #c8e6c9"},children:[(0,$y.jsx)("strong",{style:{color:"#2E7D32"},children:"Centros seleccionados en orden de preferencia:"}),(0,$y.jsx)("ol",{style:{paddingLeft:"25px",marginTop:"10px",marginBottom:"0",color:"#333"},children:c.map(((e,n)=>{const r=t.find((t=>t.id===e));return r?(0,$y.jsxs)("li",{style:{marginBottom:"8px"},children:[(0,$y.jsx)("strong",{children:r.nombre||r.nombreCentro||r.centro}),r.localidad&&(0,$y.jsxs)("span",{style:{color:"#555",marginLeft:"5px"},children:["- ",r.localidad]}),r.municipio&&r.municipio!==r.localidad&&(0,$y.jsxs)("span",{style:{marginLeft:"5px",color:"#4a5568",fontSize:"13px"},children:[(0,$y.jsx)("span",{style:{marginRight:"4px"},children:"\ud83d\udccd"}),r.municipio]}),0===n&&(0,$y.jsx)("span",{style:{display:"inline-block",marginLeft:"8px",fontSize:"12px",color:"#d35400",backgroundColor:"#fff3cd",padding:"1px 5px",borderRadius:"10px",fontWeight:"bold"},children:"1\xaa opci\xf3n"})]},e):null}))}),(0,$y.jsx)("div",{style:{marginTop:"10px",textAlign:"right"},children:(0,$y.jsx)("button",{type:"button",onClick:()=>l([]),style:{padding:"6px 12px",backgroundColor:"#f8d7da",color:"#721c24",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"13px"},children:"Limpiar selecci\xf3n"})})]}),(0,$y.jsx)("div",{style:{textAlign:"center"},children:(0,$y.jsx)("button",{type:"submit",disabled:d||0===c.length,style:{padding:"12px 25px",backgroundImage:d?"linear-gradient(to right, #cccccc, #dddddd)":"linear-gradient(to right, #3498db, #2980b9)",color:"white",border:"none",borderRadius:"6px",cursor:d||0===c.length?"not-allowed":"pointer",display:"inline-flex",alignItems:"center",justifyContent:"center",fontSize:"16px",fontWeight:"500",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:d?(0,$y.jsxs)($y.Fragment,{children:[(0,$y.jsx)("span",{style:{display:"inline-block",width:"18px",height:"18px",border:"3px solid rgba(255,255,255,0.3)",borderRadius:"50%",borderTopColor:"white",animation:"spin 1s linear infinite",marginRight:"10px"}}),"Procesando..."]}):(0,$y.jsx)($y.Fragment,{children:"Solicitar Plaza"})})})]})]}),(0,$y.jsxs)("div",{className:"search-container",children:[(0,$y.jsx)("input",{type:"text",className:"search-box",placeholder:"Buscar por centro, municipio o c\xf3digo...",value:a,onChange:e=>{i(e.target.value),g(1)}}),a&&(0,$y.jsx)("button",{className:"clear-search",onClick:()=>i(""),children:"\xd7"})]}),(0,$y.jsxs)("div",{className:"filters-container",children:[(0,$y.jsxs)("select",{className:"filter-select",value:T,onChange:e=>{x(e.target.value),g(1)},children:[(0,$y.jsx)("option",{value:"",children:"Todos los ASI"}),O.map((e=>(0,$y.jsx)("option",{value:e,children:e},e)))]}),(0,$y.jsxs)("select",{className:"filter-select",value:S,onChange:e=>{I(e.target.value),g(1)},children:[(0,$y.jsx)("option",{value:"",children:"Todos los departamentos"}),D.map((e=>(0,$y.jsx)("option",{value:e,children:e},e)))]}),(0,$y.jsxs)("select",{className:"filter-select",value:k,onChange:e=>{_(e.target.value),g(1)},children:[(0,$y.jsx)("option",{value:"",children:"Todos los municipios"}),P.map((e=>(0,$y.jsx)("option",{value:e,children:e},e)))]}),(0,$y.jsxs)("select",{className:"filter-select",value:m,onChange:e=>{v(Number(e.target.value)),g(1)},children:[(0,$y.jsx)("option",{value:10,children:"10 por p\xe1gina"}),(0,$y.jsx)("option",{value:25,children:"25 por p\xe1gina"}),(0,$y.jsx)("option",{value:50,children:"50 por p\xe1gina"}),(0,$y.jsx)("option",{value:100,children:"100 por p\xe1gina"})]})]}),(0,$y.jsxs)("div",{className:"results-info",children:[(0,$y.jsxs)("span",{children:["Mostrando ",j.length," de ",L.length," centros"]}),(0,$y.jsxs)("span",{children:["Total plazas: ",U]})]}),(0,$y.jsx)("div",{className:"plazas-grid",children:0===L.length?(0,$y.jsxs)("div",{className:"empty-state",children:[(0,$y.jsx)("div",{className:"empty-icon",children:"\ud83d\udd0d"}),(0,$y.jsx)("p",{children:"No se encontraron plazas con los criterios seleccionados."}),(0,$y.jsx)("button",{className:"reset-filters",onClick:()=>{i(""),g(1)},children:"Limpiar filtros"})]}):(0,$y.jsxs)("table",{className:"tabla-plazas",children:[(0,$y.jsx)("thead",{children:(0,$y.jsxs)("tr",{children:[(0,$y.jsx)("th",{style:{width:"60px"}}),(0,$y.jsx)("th",{children:"C\xf3digo"}),(0,$y.jsx)("th",{className:"centro-column",children:"Centro"}),(0,$y.jsx)("th",{children:"Ubicaci\xf3n"}),(0,$y.jsx)("th",{children:"Plazas"}),y<768&&(0,$y.jsx)("th",{style:{width:"40px"},children:"Info"})]})}),(0,$y.jsx)("tbody",{children:j.map(((e,t)=>{const n=Math.max(0,e.plazas-(e.asignadas||0)),r=c.includes(e.id);let a=t%2===0?"white":"#f9f9f9";r?a="#e6f7ff":0===n?a="#ffe6e6":n<=2&&(a="#fff3cd");const i=e.docId||`plaza-${e.id}-${t}`;return(0,$y.jsxs)("tr",{style:{backgroundColor:a,transition:"background-color 0.2s ease"},onClick:()=>{N&&(r?l(c.filter((t=>t!==e.id))):c.includes(e.id)||l([...c,e.id]))},children:[(0,$y.jsx)("td",{children:(0,$y.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px",justifyContent:"center"},children:[(0,$y.jsx)("input",{type:"checkbox",id:`plaza-${e.id}`,value:e.id,onChange:V,checked:c.includes(e.id),style:{width:"20px",height:"20px",cursor:"pointer"}}),c.includes(e.id)&&(0,$y.jsx)("span",{style:{backgroundImage:"linear-gradient(135deg, #1976D2, #2196F3)",color:"white",borderRadius:"50%",width:"28px",height:"28px",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",fontSize:"14px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:c.indexOf(e.id)+1})]})}),(0,$y.jsx)("td",{children:e.codigo}),(0,$y.jsx)("td",{className:"centro-column",title:e.nombre||e.nombreCentro||e.centro,children:e.nombre||e.nombreCentro||e.centro}),(0,$y.jsx)("td",{children:(0,$y.jsxs)("div",{children:[e.localidad&&(0,$y.jsx)("div",{style:{fontWeight:"medium"},children:e.localidad}),e.municipio&&e.municipio!==e.localidad&&(0,$y.jsxs)("div",{style:{color:"#4a5568",fontSize:"13px",marginTop:e.localidad?"3px":"0",display:"flex",alignItems:"center"},children:[(0,$y.jsx)("span",{style:{marginRight:"4px"},children:"\ud83d\udccd"}),e.municipio]}),!e.localidad&&!e.municipio&&(0,$y.jsx)("span",{style:{color:"#a0aec0",fontStyle:"italic"}})]})}),(0,$y.jsx)("td",{children:e.plazas}),y<768&&(0,$y.jsx)("td",{children:(0,$y.jsx)("button",{className:"info-button",onClick:t=>{t.stopPropagation(),(e=>{E({...e,disponibles:e.plazas-(e.asignadas||0)})})(e)},children:"\u2139\ufe0f"})})]},i)}))})]})}),L.length>0&&(0,$y.jsxs)("div",{className:"pagination",children:[(0,$y.jsx)("button",{className:"pagination-button",onClick:()=>g(1),disabled:1===p,children:"\xab\xab"}),(0,$y.jsx)("button",{className:"pagination-button",onClick:()=>g((e=>Math.max(1,e-1))),disabled:1===p,children:"\xab"}),(M<=5?Array.from({length:M},((e,t)=>t+1)):p<=3?[1,2,3,4,5]:p>=M-2?[M-4,M-3,M-2,M-1,M]:[p-2,p-1,p,p+1,p+2]).map((e=>(0,$y.jsx)("button",{className:"pagination-button "+(p===e?"active":""),onClick:()=>g(e),children:e},e))),(0,$y.jsx)("button",{className:"pagination-button",onClick:()=>g((e=>Math.min(M,e+1))),disabled:p===M,children:"\xbb"}),(0,$y.jsx)("button",{className:"pagination-button",onClick:()=>g(M),disabled:p===M,children:"\xbb\xbb"})]}),w&&(0,$y.jsx)("div",{className:"info-modal",children:(0,$y.jsxs)("div",{className:"info-content",children:[(0,$y.jsx)("h3",{children:"Informaci\xf3n del centro"}),(0,$y.jsxs)("p",{children:[(0,$y.jsx)("strong",{children:"Centro:"})," ",w.nombre||w.nombreCentro||w.centro]}),(0,$y.jsxs)("p",{children:[(0,$y.jsx)("strong",{children:"C\xf3digo:"})," ",w.codigo]}),(0,$y.jsxs)("p",{children:[(0,$y.jsx)("strong",{children:"Municipio:"})," ",w.municipio]}),(0,$y.jsxs)("p",{children:[(0,$y.jsx)("strong",{children:"Departamento:"})," ",w.departamento]}),(0,$y.jsxs)("p",{children:[(0,$y.jsx)("strong",{children:"ASI:"})," ",w.asi]}),(0,$y.jsxs)("p",{children:[(0,$y.jsx)("strong",{children:"Plazas disponibles:"})," ",w.disponibles]}),(0,$y.jsxs)("div",{className:"modal-footer",children:[(0,$y.jsx)("button",{className:"close-button",onClick:B,children:"Cerrar"}),(0,$y.jsx)("button",{className:"select-button",onClick:()=>{V({target:{value:w.id}}),B()},children:"Seleccionar"})]})]})}),(0,$y.jsx)("style",{children:"\n        .plazas-container {\n          background-color: white;\n          border-radius: 8px;\n          box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);\n          padding: 20px;\n          height: 100%;\n          display: flex;\n          flex-direction: column;\n          overflow: hidden;\n          max-width: 100%;\n          box-sizing: border-box;\n        }\n        \n        .search-container {\n          position: relative;\n          margin-bottom: 15px;\n          width: 100%;\n          max-width: 100%;\n          box-sizing: border-box;\n        }\n        \n        .search-box {\n          width: 100%;\n          padding: 14px 16px;\n          border: 2px solid #ddd;\n          border-radius: 6px;\n          font-size: 16px;\n          transition: border-color 0.3s;\n          box-sizing: border-box;\n          overflow: hidden;\n          text-overflow: ellipsis;\n        }\n        \n        .search-box:focus {\n          border-color: #1976d2;\n          outline: none;\n          box-shadow: 0 0 0 3px rgba(25, 118, 210, 0.2);\n        }\n        \n        .clear-search {\n          position: absolute;\n          right: 10px;\n          top: 50%;\n          transform: translateY(-50%);\n          background: none;\n          border: none;\n          font-size: 24px;\n          cursor: pointer;\n          color: #999;\n          padding: 5px;\n          line-height: 1;\n          z-index: 5;\n        }\n        \n        .clear-search:hover {\n          color: #333;\n        }\n        \n        .filters-container {\n          display: flex;\n          flex-wrap: wrap;\n          gap: 10px;\n          margin-bottom: 15px;\n          max-width: 100%;\n          box-sizing: border-box;\n        }\n        \n        .filter-select {\n          padding: 10px;\n          border: 1px solid #ddd;\n          border-radius: 4px;\n          min-width: 150px;\n          flex: 1 1 auto;\n          box-sizing: border-box;\n          max-width: 100%;\n        }\n        \n        @media (max-width: 768px) {\n          .filters-container {\n            flex-direction: column;\n            gap: 8px;\n          }\n          \n          .filter-select {\n            width: 100%;\n            min-width: auto;\n          }\n          \n          .search-box {\n            padding: 12px 14px;\n            font-size: 14px;\n          }\n          \n          .clear-search {\n            right: 5px;\n            font-size: 20px;\n          }\n        }\n        \n        .results-info {\n          display: flex;\n          justify-content: space-between;\n          margin-bottom: 10px;\n          font-size: 14px;\n          color: #555;\n          font-weight: 500;\n          flex-wrap: wrap;\n          width: 100%;\n          box-sizing: border-box;\n        }\n        \n        .plazas-grid {\n          overflow-y: auto;\n          height: 100%;\n          border: 1px solid #eee;\n          border-radius: 4px;\n          margin-bottom: 15px;\n          -webkit-overflow-scrolling: touch;\n        }\n        \n        .tabla-plazas {\n          width: 100%;\n          border-collapse: collapse;\n          table-layout: fixed;\n        }\n        \n        .tabla-plazas th {\n          background-color: #f5f5f5;\n          position: sticky;\n          top: 0;\n          padding: 12px 10px;\n          text-align: left;\n          border-bottom: 2px solid #ddd;\n          z-index: 10;\n          font-weight: 600;\n        }\n        \n        .tabla-plazas td {\n          padding: 12px 10px;\n          border-bottom: 1px solid #eee;\n          word-break: break-word;\n        }\n        \n        .centro-column {\n          max-width: 300px;\n          white-space: nowrap;\n          overflow: hidden;\n          text-overflow: ellipsis;\n        }\n        \n        .tabla-plazas tr:hover {\n          background-color: #f9f9f9;\n        }\n        \n        .selected-row {\n          background-color: #e3f2fd;\n        }\n        \n        .selected-row:hover {\n          background-color: #bbdefb;\n        }\n        \n        .empty-state {\n          display: flex;\n          flex-direction: column;\n          align-items: center;\n          justify-content: center;\n          padding: 40px 0;\n          text-align: center;\n          color: #757575;\n        }\n        \n        .empty-icon {\n          font-size: 48px;\n          margin-bottom: 20px;\n        }\n        \n        .reset-filters {\n          margin-top: 15px;\n          padding: 8px 16px;\n          background-color: #1976d2;\n          color: white;\n          border: none;\n          border-radius: 4px;\n          cursor: pointer;\n        }\n        \n        .pagination {\n          display: flex;\n          justify-content: center;\n          gap: 5px;\n          margin-top: 15px;\n          flex-wrap: wrap;\n        }\n        \n        .pagination-button {\n          padding: 8px 12px;\n          border: 1px solid #ddd;\n          background-color: white;\n          border-radius: 4px;\n          cursor: pointer;\n          transition: all 0.2s;\n        }\n        \n        .pagination-button.active {\n          background-color: #1976d2;\n          color: white;\n          border-color: #1976d2;\n        }\n        \n        .pagination-button:hover:not(:disabled) {\n          background-color: #f0f0f0;\n          border-color: #bbb;\n        }\n        \n        .pagination-button:disabled {\n          cursor: not-allowed;\n          opacity: 0.5;\n        }\n        \n        .info-button {\n          background: none;\n          border: none;\n          cursor: pointer;\n          font-size: 18px;\n          padding: 2px;\n        }\n        \n        .info-modal {\n          position: fixed;\n          top: 0;\n          left: 0;\n          right: 0;\n          bottom: 0;\n          background-color: rgba(0, 0, 0, 0.5);\n          display: flex;\n          justify-content: center;\n          align-items: center;\n          z-index: 1000;\n        }\n        \n        .info-content {\n          background-color: white;\n          border-radius: 8px;\n          padding: 20px;\n          width: 90%;\n          max-width: 500px;\n          max-height: 80vh;\n          overflow-y: auto;\n          box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);\n        }\n        \n        .info-content h3 {\n          margin-top: 0;\n          color: #1a237e;\n          border-bottom: 1px solid #eee;\n          padding-bottom: 10px;\n        }\n        \n        .modal-footer {\n          display: flex;\n          justify-content: flex-end;\n          gap: 10px;\n          margin-top: 20px;\n          border-top: 1px solid #eee;\n          padding-top: 15px;\n        }\n        \n        .close-button, .select-button {\n          padding: 8px 16px;\n          border-radius: 4px;\n          border: none;\n          cursor: pointer;\n        }\n        \n        .close-button {\n          background-color: #f5f5f5;\n          color: #333;\n        }\n        \n        .select-button {\n          background-color: #1976d2;\n          color: white;\n        }\n        \n        /* Dise\xf1o responsive */\n        @media (max-width: 768px) {\n          .plazas-container {\n            padding: 15px 10px;\n          }\n          \n          .filters-container {\n            flex-direction: column;\n            gap: 8px;\n          }\n          \n          .filter-select {\n            width: 100%;\n          }\n          \n          .tabla-plazas th, .tabla-plazas td {\n            padding: 10px 5px;\n            font-size: 13px;\n          }\n          \n          .tabla-plazas th:nth-child(1) {\n            width: 65px;\n          }\n          \n          .tabla-plazas th:nth-child(2) {\n            width: 60px;\n          }\n          \n          .tabla-plazas th:nth-child(4) {\n            width: 80px;\n          }\n          \n          .tabla-plazas th:nth-child(5) {\n            width: 45px;\n          }\n          \n          .centro-column {\n            max-width: 100px;\n          }\n          \n          .pagination-button {\n            padding: 6px 10px;\n            font-size: 13px;\n          }\n          \n          h2 {\n            font-size: 20px;\n            margin-top: 0;\n          }\n          \n          form > div {\n            margin-bottom: 10px !important;\n          }\n          \n          .search-box {\n            padding: 10px 12px;\n            font-size: 14px;\n          }\n        }\n        \n        /* Animaciones */\n        @keyframes spin {\n          0% { transform: rotate(0deg); }\n          100% { transform: rotate(360deg); }\n        }\n      "})]})},Gy=e=>{let{solicitudes:t=[],assignments:n=[],availablePlazas:a=[]}=e;const[i,s]=(0,r.useState)(1),[o,c]=(0,r.useState)(10),[l,u]=(0,r.useState)(""),[d,h]=(0,r.useState)(""),[f,p]=(0,r.useState)("undefined"!==typeof window?window.innerWidth:1200),[g,m]=(0,r.useState)({key:"orden",direction:"asc"});if((0,r.useEffect)((()=>Array.isArray(t)?Array.isArray(n)?Array.isArray(a)?void h(""):(h("Error: Las plazas disponibles no son v\xe1lidas"),void console.error("SolicitudesPendientes: availablePlazas debe ser un array")):(h("Error: Las asignaciones no son v\xe1lidas"),void console.error("SolicitudesPendientes: assignments debe ser un array")):(h("Error: Las solicitudes no son v\xe1lidas"),void console.error("SolicitudesPendientes: solicitudes debe ser un array"))),[t,n,a]),(0,r.useEffect)((()=>{const e=()=>{p(window.innerWidth)};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),d)return(0,$y.jsx)("div",{style:{textAlign:"center",padding:"20px",backgroundColor:"#fff3cd",borderRadius:"8px",color:"#856404",margin:"20px 0"},children:(0,$y.jsx)("p",{children:d})});const v=f<768,y=(b=(Array.isArray(t)?t:[]).filter((e=>!!e&&(void 0!==e.orden&&null!==e.orden||void 0!==e.numeroOrden&&null!==e.numeroOrden?!(!Array.isArray(e.centrosIds)&&!Array.isArray(e.centrosSeleccionados))||(console.warn("Solicitud sin centros seleccionados:",e),!1):(console.warn("Solicitud sin n\xfamero de orden:",e),!1)))).filter((e=>{var t;const n=[null===(t=e.orden||e.numeroOrden)||void 0===t?void 0:t.toString(),...(e.centrosIds||e.centrosSeleccionados||[]).map((e=>{const t=a.find((t=>t.id===e));return t?[t.nombre||t.nombreCentro||t.centro,t.localidad,t.municipio]:[]})).flat()].filter(Boolean);return n.some((e=>e.toLowerCase().includes(l.toLowerCase())))})),b&&Array.isArray(b)?[...b].sort(((e,t)=>{if(!e||!t)return 0;let n=e[g.key],r=t[g.key];return"orden"===g.key&&(n=Number(n||e.numeroOrden)||0,r=Number(r||t.numeroOrden)||0),n<r?"asc"===g.direction?-1:1:n>r?"asc"===g.direction?1:-1:0})):[]);var b;const w=Math.ceil(y.length/o),E=i*o,T=E-o,x=y.slice(T,E),S=e=>{e<1||e>w||s(e)};return t.length?(0,$y.jsxs)("div",{children:[(0,$y.jsxs)("div",{style:{marginBottom:"15px",fontSize:"14px",padding:"12px 15px",backgroundColor:"#fff7f0",borderRadius:"6px",borderLeft:"4px solid #d35400",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:["A continuaci\xf3n se muestran las solicitudes pendientes con sus preferencias de centros en orden.",(0,$y.jsx)("p",{style:{color:"#d35400",fontWeight:"bold",marginTop:"8px",marginBottom:"0"},children:"\u26a0\ufe0f Las solicitudes se procesan por orden de prioridad (n\xfamero de orden menor = mayor prioridad)"})]}),(0,$y.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,$y.jsxs)("div",{style:{marginBottom:"10px",position:"relative"},children:[(0,$y.jsx)("input",{type:"text",placeholder:"Buscar por n\xfamero de orden o centro...",value:l,onChange:e=>{u(e.target.value),s(1)},style:{padding:"12px 15px",paddingLeft:"40px",border:"1px solid #ddd",borderRadius:"6px",width:"100%",fontSize:"16px",boxShadow:"inset 0 1px 3px rgba(0,0,0,0.05)"}}),(0,$y.jsx)("div",{style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",color:"#666",fontSize:"18px"},children:"\ud83d\udd0d"})]}),(0,$y.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"10px"},children:[(0,$y.jsxs)("div",{style:{marginBottom:"10px",fontSize:"14px",color:"#666"},children:["Mostrando ",(0,$y.jsxs)("strong",{children:[y.length>0?T+1:0,"-",Math.min(E,y.length)]})," de ",(0,$y.jsx)("strong",{children:y.length})," solicitudes",l&&` (filtradas de ${t.length})`]}),(0,$y.jsx)("div",{children:(0,$y.jsxs)("select",{value:o,onChange:e=>{c(Number(e.target.value)),s(1)},style:{padding:"8px 12px",border:"1px solid #ddd",borderRadius:"6px",backgroundColor:"white",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:[(0,$y.jsx)("option",{value:10,children:"10 por p\xe1gina"}),(0,$y.jsx)("option",{value:25,children:"25 por p\xe1gina"}),(0,$y.jsx)("option",{value:50,children:"50 por p\xe1gina"}),(0,$y.jsx)("option",{value:y.length,children:"Ver todas"})]})})]})]}),v&&(0,$y.jsx)("div",{style:{marginBottom:"15px",fontSize:"13px",color:"#666",textAlign:"center",backgroundColor:"#fff3cd",padding:"8px",borderRadius:"4px"},children:"\u2190 Desliza para ver la tabla completa \u2192"}),(0,$y.jsx)("div",{style:{overflowX:"auto",border:"1px solid #e1e8f0",borderRadius:"6px",WebkitOverflowScrolling:"touch"},children:(0,$y.jsxs)("table",{className:"responsive-table",style:{width:"100%",borderCollapse:"collapse",minWidth:v?"768px":"auto"},children:[(0,$y.jsx)("thead",{children:(0,$y.jsxs)("tr",{style:{backgroundImage:"linear-gradient(to right, #fef5ec, #fde4ce)",position:"sticky",top:0,zIndex:5},children:[(0,$y.jsx)("th",{style:{border:"1px solid #ddd",padding:"12px 15px",textAlign:"left",color:"#d35400"},children:"N\xba Orden"}),(0,$y.jsx)("th",{style:{border:"1px solid #ddd",padding:"12px 15px",textAlign:"left",color:"#d35400"},children:"Fecha/Hora"}),(0,$y.jsx)("th",{style:{border:"1px solid #ddd",padding:"12px 15px",textAlign:"left",color:"#d35400"},children:"Centros Seleccionados (en orden de preferencia)"}),(0,$y.jsx)("th",{style:{border:"1px solid #ddd",padding:"12px 15px",textAlign:"center",color:"#d35400"},children:"Estado"})]})}),(0,$y.jsxs)("tbody",{children:[x.map(((e,t)=>{const r=new Date(e.timestamp),i=`${r.toLocaleDateString()} ${r.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`,s=n.some((t=>t.order===(e.orden||e.numeroOrden))),o=n.find((t=>t.order===(e.orden||e.numeroOrden))),c=s?"#e8f5e9":t%2===0?"white":"#fef9f4";return(0,$y.jsxs)("tr",{style:{backgroundColor:c,opacity:s?.8:1,transition:"background-color 0.2s ease"},children:[(0,$y.jsxs)("td",{style:{border:"1px solid #ddd",padding:"12px 15px",fontWeight:"bold",backgroundColor:(e.orden||e.numeroOrden)<=50?"#fff3cd":"inherit"},children:[e.orden||e.numeroOrden,(e.orden||e.numeroOrden)<=50&&(0,$y.jsx)("span",{style:{display:"inline-block",marginLeft:"8px",fontSize:"12px",color:"#856404",backgroundColor:"#fff3cd",padding:"2px 6px",borderRadius:"12px",boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},children:"Alta prioridad"})]}),(0,$y.jsx)("td",{style:{border:"1px solid #ddd",padding:"12px 15px"},children:i}),(0,$y.jsx)("td",{style:{border:"1px solid #ddd",padding:"12px 15px"},children:(0,$y.jsx)("ol",{style:{margin:"0",paddingLeft:"20px"},children:Array.isArray((null===e||void 0===e?void 0:e.centrosIds)||(null===e||void 0===e?void 0:e.centrosSeleccionados))?((null===e||void 0===e?void 0:e.centrosIds)||(null===e||void 0===e?void 0:e.centrosSeleccionados)||[]).map(((e,t)=>{const n=e&&a&&Array.isArray(a)?a.find((t=>t&&t.id===e)):null,r=o&&o.id===e;return(0,$y.jsx)("li",{style:{marginBottom:"8px",backgroundColor:r?"#f1f8e9":"transparent",padding:r?"4px 8px":"0",borderRadius:r?"4px":"0",border:r?"1px solid #c8e6c9":"none"},children:n?(0,$y.jsxs)($y.Fragment,{children:[(0,$y.jsx)("strong",{style:{color:0===t?"#d35400":"inherit"},children:n.nombre||n.nombreCentro||n.centro}),(0,$y.jsxs)("div",{className:"centro-localidad",children:[n.localidad&&`- ${n.localidad}`,n.municipio&&n.municipio!==n.localidad&&(0,$y.jsxs)("span",{style:{marginLeft:"5px",color:"#4a5568",fontSize:"13px"},children:[(0,$y.jsx)("span",{style:{marginRight:"4px"},children:"\ud83d\udccd"}),n.municipio]})]}),0===t&&(0,$y.jsx)("span",{style:{display:"inline-block",marginLeft:"8px",fontSize:"12px",color:"#d35400",backgroundColor:"#fff3cd",padding:"1px 5px",borderRadius:"10px",fontWeight:"bold"},children:"1\xaa opci\xf3n"}),n.plazas&&void 0!==n.asignadas&&n.plazas-n.asignadas<=0&&!r&&(0,$y.jsx)("span",{style:{color:"#e74c3c",marginLeft:"10px",fontSize:"12px",fontWeight:"bold",backgroundColor:"#ffebee",padding:"1px 6px",borderRadius:"10px"},children:"Completo"}),r&&(0,$y.jsx)("span",{style:{color:"#2E7D32",marginLeft:"10px",fontSize:"12px",fontWeight:"bold",backgroundColor:"#e8f5e9",padding:"1px 6px",borderRadius:"10px"},children:"\u2713 Asignado"})]}):(0,$y.jsx)("span",{style:{color:"#999"},children:e})},t)})):(0,$y.jsx)("li",{children:"No hay centros seleccionados"})})}),(0,$y.jsx)("td",{style:{border:"1px solid #ddd",padding:"12px 15px",textAlign:"center"},children:s?(0,$y.jsx)("div",{style:{backgroundColor:"#e8f5e9",color:"#2E7D32",padding:"8px 12px",borderRadius:"6px",fontSize:"14px",fontWeight:"bold",border:"1px solid #c8e6c9",display:"inline-block"},children:"\u2713 Asignado"}):(0,$y.jsx)("div",{style:{backgroundColor:"#fff7e6",color:"#f39c12",padding:"8px 12px",borderRadius:"6px",fontSize:"14px",fontWeight:"bold",border:"1px solid #ffeeba",display:"inline-block"},children:"Pendiente"})})]},t)})),0===x.length&&(0,$y.jsx)("tr",{children:(0,$y.jsx)("td",{colSpan:"4",style:{textAlign:"center",padding:"30px",color:"#666"},children:l?`No se encontraron solicitudes que coincidan con "${l}"`:"No hay solicitudes pendientes para mostrar"})})]})]})}),y.length>o&&(0,$y.jsxs)("div",{style:{display:"flex",justifyContent:"center",marginTop:"20px",gap:"5px",flexWrap:"wrap"},children:[(0,$y.jsx)("button",{onClick:()=>S(i-1),disabled:1===i,style:{padding:"8px 12px",backgroundColor:1===i?"#f1f1f1":"white",border:"1px solid #ddd",borderRadius:"4px",cursor:1===i?"not-allowed":"pointer"},children:"\xab Anterior"}),Array.from({length:Math.min(5,w)},((e,t)=>{let n;return n=w<=5||i<=3?t+1:i>=w-2?w-4+t:i-2+t,(0,$y.jsx)("button",{onClick:()=>S(n),style:{padding:"8px 12px",backgroundColor:i===n?"#e67e22":"white",color:i===n?"white":"#333",border:"1px solid #ddd",borderRadius:"4px",cursor:"pointer"},children:n},n)})),(0,$y.jsx)("button",{onClick:()=>S(i+1),disabled:i===w,style:{padding:"8px 12px",backgroundColor:i===w?"#f1f1f1":"white",border:"1px solid #ddd",borderRadius:"4px",cursor:i===w?"not-allowed":"pointer"},children:"Siguiente \xbb"})]})]}):(0,$y.jsxs)("div",{style:{textAlign:"center",padding:"40px 20px",backgroundColor:"#f5f7fa",borderRadius:"8px",color:"#5c6c7c"},children:[(0,$y.jsx)("div",{style:{fontSize:"36px",marginBottom:"15px"},children:"\ud83d\udcdd"}),(0,$y.jsx)("div",{style:{fontSize:"18px",fontWeight:"bold",marginBottom:"10px"},children:"No hay solicitudes pendientes"}),(0,$y.jsx)("div",{style:{fontSize:"14px"},children:'Las solicitudes aparecer\xe1n aqu\xed cuando se env\xeden desde la pesta\xf1a "Plazas Disponibles"'})]})};const Ky=function(){return(0,$y.jsx)("footer",{style:{marginTop:"60px",padding:"20px 15px",borderTop:"1px solid #ddd",backgroundColor:"#f8f9fa",textAlign:"center",color:"#333",fontSize:"14px",width:"100%",position:"relative",display:"block"},children:(0,$y.jsxs)("div",{style:{maxWidth:"1280px",margin:"0 auto"},children:[(0,$y.jsxs)("p",{style:{margin:"10px 0"},children:["Realizado por ",(0,$y.jsx)("a",{href:"https://ag-marketing.es",target:"_blank",rel:"noopener noreferrer",style:{color:"#18539E",textDecoration:"none",fontWeight:"bold"},children:"AG-Marketing"})]}),(0,$y.jsxs)("p",{style:{margin:"10px 0"},children:["\xa9 ",(new Date).getFullYear()," - Todos los derechos reservados"]})]})})};var qy={version:"0.18.5"},Yy=1200,Xy=1252,Qy=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Jy={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Zy=function(e){-1!=Qy.indexOf(e)&&(Xy=Jy[0]=e)};var eb=function(e){Yy=e,Zy(e)};function tb(){eb(1200),Zy(1252)}function nb(e){for(var t=[],n=0,r=e.length;n<r;++n)t[n]=e.charCodeAt(n);return t}function rb(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n+1)+(e.charCodeAt(2*n)<<8));return t.join("")}var ab,ib=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1);return 255==t&&254==n?function(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n)+(e.charCodeAt(2*n+1)<<8));return t.join("")}(e.slice(2)):254==t&&255==n?rb(e.slice(2)):65279==t?e.slice(1):e},sb=function(e){return String.fromCharCode(e)},ob=function(e){return String.fromCharCode(e)};var cb="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function lb(e){for(var t="",n=0,r=0,a=0,i=0,s=0,o=0,c=0,l=0;l<e.length;)i=(n=e.charCodeAt(l++))>>2,s=(3&n)<<4|(r=e.charCodeAt(l++))>>4,o=(15&r)<<2|(a=e.charCodeAt(l++))>>6,c=63&a,isNaN(r)?o=c=64:isNaN(a)&&(c=64),t+=cb.charAt(i)+cb.charAt(s)+cb.charAt(o)+cb.charAt(c);return t}function ub(e){var t="",n=0,r=0,a=0,i=0,s=0,o=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)n=cb.indexOf(e.charAt(c++))<<2|(i=cb.indexOf(e.charAt(c++)))>>4,t+=String.fromCharCode(n),r=(15&i)<<4|(s=cb.indexOf(e.charAt(c++)))>>2,64!==s&&(t+=String.fromCharCode(r)),a=(3&s)<<6|(o=cb.indexOf(e.charAt(c++))),64!==o&&(t+=String.fromCharCode(a));return t}var db=function(){return"undefined"!==typeof Buffer&&"undefined"!==typeof process&&"undefined"!==typeof process.versions&&!!process.versions.node}(),hb=function(){if("undefined"!==typeof Buffer){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch(t){e=!0}return e?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function fb(e){return db?Buffer.alloc?Buffer.alloc(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}function pb(e){return db?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}var gb=function(e){return db?hb(e,"binary"):e.split("").map((function(e){return 255&e.charCodeAt(0)}))};function mb(e){if(Array.isArray(e))return e.map((function(e){return String.fromCharCode(e)})).join("");for(var t=[],n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function vb(e){if("undefined"==typeof ArrayBuffer)throw new Error("Unsupported");if(e instanceof ArrayBuffer)return vb(new Uint8Array(e));for(var t=new Array(e.length),n=0;n<e.length;++n)t[n]=e[n];return t}var yb=db?function(e){return Buffer.concat(e.map((function(e){return Buffer.isBuffer(e)?e:hb(e)})))}:function(e){if("undefined"!==typeof Uint8Array){var t=0,n=0;for(t=0;t<e.length;++t)n+=e[t].length;var r=new Uint8Array(n),a=0;for(t=0,n=0;t<e.length;n+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)r.set(e[t],n);else{if("string"==typeof e[t])throw"wtf";r.set(new Uint8Array(e[t]),n)}return r}return[].concat.apply([],e.map((function(e){return Array.isArray(e)?e:[].slice.call(e)})))};var bb=/\u0000/g,wb=/[\u0001-\u0006]/g;function Eb(e){for(var t="",n=e.length-1;n>=0;)t+=e.charAt(n--);return t}function Tb(e,t){var n=""+e;return n.length>=t?n:Rw("0",t-n.length)+n}function xb(e,t){var n=""+e;return n.length>=t?n:Rw(" ",t-n.length)+n}function Sb(e,t){var n=""+e;return n.length>=t?n:n+Rw(" ",t-n.length)}var Ib=Math.pow(2,32);function kb(e,t){return e>Ib||e<-Ib?function(e,t){var n=""+Math.round(e);return n.length>=t?n:Rw("0",t-n.length)+n}(e,t):function(e,t){var n=""+e;return n.length>=t?n:Rw("0",t-n.length)+n}(Math.round(e),t)}function _b(e,t){return t=t||0,e.length>=7+t&&103===(32|e.charCodeAt(t))&&101===(32|e.charCodeAt(t+1))&&110===(32|e.charCodeAt(t+2))&&101===(32|e.charCodeAt(t+3))&&114===(32|e.charCodeAt(t+4))&&97===(32|e.charCodeAt(t+5))&&108===(32|e.charCodeAt(t+6))}var Cb=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Ab=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];var Nb={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "'},Rb={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Ob={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Db(e,t,n){for(var r=e<0?-1:1,a=e*r,i=0,s=1,o=0,c=1,l=0,u=0,d=Math.floor(a);l<t&&(o=(d=Math.floor(a))*s+i,u=d*l+c,!(a-d<5e-8));)a=1/(a-d),i=s,s=o,c=l,l=u;if(u>t&&(l>t?(u=c,o=i):(u=l,o=s)),!n)return[0,r*o,u];var h=Math.floor(r*o/u);return[h,r*o-h*u,u]}function Pb(e,t,n){if(e>2958465||e<0)return null;var r=0|e,a=Math.floor(86400*(e-r)),i=0,s=[],o={D:r,T:a,u:86400*(e-r)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(r+=1462),o.u>.9999&&(o.u=0,86400==++a&&(o.T=a=0,++r,++o.D)),60===r)s=n?[1317,10,29]:[1900,2,29],i=3;else if(0===r)s=n?[1317,8,29]:[1900,1,0],i=6;else{r>60&&--r;var c=new Date(1900,0,1);c.setDate(c.getDate()+r-1),s=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),r<60&&(i=(i+6)%7),n&&(i=function(e,t){t[0]-=581;var n=e.getDay();e<60&&(n=(n+6)%7);return n}(c,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=i,o}var Lb=new Date(1899,11,31,0,0,0),Mb=Lb.getTime(),Fb=new Date(1900,2,1,0,0,0);function zb(e,t){var n=e.getTime();return t?n-=1262304e5:e>=Fb&&(n+=864e5),(n-(Mb+6e4*(e.getTimezoneOffset()-Lb.getTimezoneOffset())))/864e5}function jb(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Ub(e){var t,n=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return t=n>=-4&&n<=-1?e.toPrecision(10+n):Math.abs(n)<=9?function(e){var t=e<0?12:11,n=jb(e.toFixed(12));return n.length<=t||(n=e.toPrecision(10)).length<=t?n:e.toExponential(5)}(e):10===n?e.toFixed(10).substr(0,12):function(e){var t=jb(e.toFixed(11));return t.length>(e<0?12:11)||"0"===t||"-0"===t?e.toPrecision(6):t}(e),jb(function(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(t.toUpperCase()))}function Bb(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):Ub(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return cw(14,zb(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Vb(e,t,n,r){var a,i="",s=0,o=0,c=n.y,l=0;switch(e){case 98:c=n.y+543;case 121:switch(t.length){case 1:case 2:a=c%100,l=2;break;default:a=c%1e4,l=4}break;case 109:switch(t.length){case 1:case 2:a=n.m,l=t.length;break;case 3:return Ab[n.m-1][1];case 5:return Ab[n.m-1][0];default:return Ab[n.m-1][2]}break;case 100:switch(t.length){case 1:case 2:a=n.d,l=t.length;break;case 3:return Cb[n.q][0];default:return Cb[n.q][1]}break;case 104:switch(t.length){case 1:case 2:a=1+(n.H+11)%12,l=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:a=n.H,l=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:a=n.M,l=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==n.u||"s"!=t&&"ss"!=t?(o=r>=2?3===r?1e3:100:1===r?10:1,(s=Math.round(o*(n.S+n.u)))>=60*o&&(s=0),"s"===t?0===s?"0":""+s/o:(i=Tb(s,2+r),"ss"===t?i.substr(0,2):"."+i.substr(2,t.length-1))):Tb(n.S,t.length);case 90:switch(t){case"[h]":case"[hh]":a=24*n.D+n.H;break;case"[m]":case"[mm]":a=60*(24*n.D+n.H)+n.M;break;case"[s]":case"[ss]":a=60*(60*(24*n.D+n.H)+n.M)+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+t}l=3===t.length?1:2;break;case 101:a=c,l=1}return l>0?Tb(a,l):""}function $b(e){if(e.length<=3)return e;for(var t=e.length%3,n=e.substr(0,t);t!=e.length;t+=3)n+=(n.length>0?",":"")+e.substr(t,3);return n}var Hb=/%/g;function Wb(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+Wb(e,-t);var a=e.indexOf(".");-1===a&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),-1===(n=(t/Math.pow(10,i)).toPrecision(r+1+(a+i)%a)).indexOf("e")){var s=Math.floor(Math.log(t)*Math.LOG10E);for(-1===n.indexOf(".")?n=n.charAt(0)+"."+n.substr(1)+"E+"+(s-n.length+i):n+="E+"+(s-i);"0."===n.substr(0,2);)n=(n=n.charAt(0)+n.substr(2,a)+"."+n.substr(2+a)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,n,r){return t+n+r.substr(0,(a+i)%a)+"."+r.substr(i)+"E"}))}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var Gb=/# (\?+)( ?)\/( ?)(\d+)/;var Kb=/^#*0*\.([0#]+)/,qb=/\).*[0#]/,Yb=/\(###\) ###\\?-####/;function Xb(e){for(var t,n="",r=0;r!=e.length;++r)switch(t=e.charCodeAt(r)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(t)}return n}function Qb(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n}function Jb(e,t){var n=e-Math.floor(e),r=Math.pow(10,t);return t<(""+Math.round(n*r)).length?0:Math.round(n*r)}function Zb(e,t,n){if(40===e.charCodeAt(0)&&!t.match(qb)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?Zb("n",r,n):"("+Zb("n",r,-n)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,n){for(var r=t.length-1;44===t.charCodeAt(r-1);)--r;return nw(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}(e,t,n);if(-1!==t.indexOf("%"))return function(e,t,n){var r=t.replace(Hb,""),a=t.length-r.length;return nw(e,r,n*Math.pow(10,2*a))+Rw("%",a)}(e,t,n);if(-1!==t.indexOf("E"))return Wb(t,n);if(36===t.charCodeAt(0))return"$"+Zb(e,t.substr(" "==t.charAt(1)?2:1),n);var a,i,s,o,c=Math.abs(n),l=n<0?"-":"";if(t.match(/^00+$/))return l+kb(c,t.length);if(t.match(/^[#?]+$/))return"0"===(a=kb(n,0))&&(a=""),a.length>t.length?a:Xb(t.substr(0,t.length-a.length))+a;if(i=t.match(Gb))return function(e,t,n){var r=parseInt(e[4],10),a=Math.round(t*r),i=Math.floor(a/r),s=a-i*r,o=r;return n+(0===i?"":""+i)+" "+(0===s?Rw(" ",e[1].length+1+e[4].length):xb(s,e[1].length)+e[2]+"/"+e[3]+Tb(o,e[4].length))}(i,c,l);if(t.match(/^#+0+$/))return l+kb(c,t.length-t.indexOf("0"));if(i=t.match(Kb))return a=Qb(n,i[1].length).replace(/^([^\.]+)$/,"$1."+Xb(i[1])).replace(/\.$/,"."+Xb(i[1])).replace(/\.(\d*)$/,(function(e,t){return"."+t+Rw("0",Xb(i[1]).length-t.length)})),-1!==t.indexOf("0.")?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return l+Qb(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return l+$b(kb(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+Zb(e,t,-n):$b(""+(Math.floor(n)+function(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(n,i[1].length)))+"."+Tb(Jb(n,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return Zb(e,t.replace(/^#,#*,/,""),n);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Eb(Zb(e,t.replace(/[\\-]/g,""),n)),s=0,Eb(Eb(t.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return s<a.length?a.charAt(s++):"0"===e?"0":""})));if(t.match(Yb))return"("+(a=Zb(e,"##########",n)).substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=Db(c,Math.pow(10,s)-1,!1),a=""+l," "==(u=nw("n",i[1],o[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),a+=u+i[2]+"/"+i[3],(u=Sb(o[2],s)).length<i[4].length&&(u=Xb(i[4].substr(i[4].length-u.length))+u),a+=u;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),l+((o=Db(c,Math.pow(10,s)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?xb(o[1],s)+i[2]+"/"+i[3]+Sb(o[2],s):Rw(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=kb(n,0),t.length<=a.length?a:Xb(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+n.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var d=t.indexOf(".")-s,h=t.length-a.length-d;return Xb(t.substr(0,d)+a+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return s=Jb(n,i[1].length),n<0?"-"+Zb(e,t,-n):$b(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?Tb(0,3-e.length):"")+e}))+"."+Tb(s,i[1].length);switch(t){case"###,##0.00":return Zb(e,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var f=$b(kb(c,0));return"0"!==f?l+f:"";case"###,###.00":return Zb(e,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return Zb(e,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function ew(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+ew(e,-t);var a=e.indexOf(".");-1===a&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),!(n=(t/Math.pow(10,i)).toPrecision(r+1+(a+i)%a)).match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);-1===n.indexOf(".")?n=n.charAt(0)+"."+n.substr(1)+"E+"+(s-n.length+i):n+="E+"+(s-i),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,n,r){return t+n+r.substr(0,(a+i)%a)+"."+r.substr(i)+"E"}))}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function tw(e,t,n){if(40===e.charCodeAt(0)&&!t.match(qb)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?tw("n",r,n):"("+tw("n",r,-n)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,n){for(var r=t.length-1;44===t.charCodeAt(r-1);)--r;return nw(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}(e,t,n);if(-1!==t.indexOf("%"))return function(e,t,n){var r=t.replace(Hb,""),a=t.length-r.length;return nw(e,r,n*Math.pow(10,2*a))+Rw("%",a)}(e,t,n);if(-1!==t.indexOf("E"))return ew(t,n);if(36===t.charCodeAt(0))return"$"+tw(e,t.substr(" "==t.charAt(1)?2:1),n);var a,i,s,o,c=Math.abs(n),l=n<0?"-":"";if(t.match(/^00+$/))return l+Tb(c,t.length);if(t.match(/^[#?]+$/))return a=""+n,0===n&&(a=""),a.length>t.length?a:Xb(t.substr(0,t.length-a.length))+a;if(i=t.match(Gb))return function(e,t,n){return n+(0===t?"":""+t)+Rw(" ",e[1].length+2+e[4].length)}(i,c,l);if(t.match(/^#+0+$/))return l+Tb(c,t.length-t.indexOf("0"));if(i=t.match(Kb))return a=(a=(""+n).replace(/^([^\.]+)$/,"$1."+Xb(i[1])).replace(/\.$/,"."+Xb(i[1]))).replace(/\.(\d*)$/,(function(e,t){return"."+t+Rw("0",Xb(i[1]).length-t.length)})),-1!==t.indexOf("0.")?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return l+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return l+$b(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+tw(e,t,-n):$b(""+n)+"."+Rw("0",i[1].length);if(i=t.match(/^#,#*,#0/))return tw(e,t.replace(/^#,#*,/,""),n);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Eb(tw(e,t.replace(/[\\-]/g,""),n)),s=0,Eb(Eb(t.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return s<a.length?a.charAt(s++):"0"===e?"0":""})));if(t.match(Yb))return"("+(a=tw(e,"##########",n)).substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=Db(c,Math.pow(10,s)-1,!1),a=""+l," "==(u=nw("n",i[1],o[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),a+=u+i[2]+"/"+i[3],(u=Sb(o[2],s)).length<i[4].length&&(u=Xb(i[4].substr(i[4].length-u.length))+u),a+=u;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),l+((o=Db(c,Math.pow(10,s)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?xb(o[1],s)+i[2]+"/"+i[3]+Sb(o[2],s):Rw(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+n,t.length<=a.length?a:Xb(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+n.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var d=t.indexOf(".")-s,h=t.length-a.length-d;return Xb(t.substr(0,d)+a+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return n<0?"-"+tw(e,t,-n):$b(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?Tb(0,3-e.length):"")+e}))+"."+Tb(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var f=$b(""+c);return"0"!==f?l+f:"";default:if(t.match(/\.[0#?]*$/))return tw(e,t.slice(0,t.lastIndexOf(".")),n)+Xb(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function nw(e,t,n){return(0|n)===n?tw(e,t,n):Zb(e,t,n)}var rw=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function aw(e){for(var t=0,n="",r="";t<e.length;)switch(n=e.charAt(t)){case"G":_b(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4e0a":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;if("\u4e0a\u5348/\u4e0b\u5348"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(r=n;"]"!==e.charAt(t++)&&t<e.length;)r+=e.charAt(t);if(r.match(rw))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(n=e.charAt(++t))>-1||"\\"==n&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===n;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;default:++t}return!1}var iw=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function sw(e,t){if(null==t)return!1;var n=parseFloat(t[2]);switch(t[1]){case"=":if(e==n)return!0;break;case">":if(e>n)return!0;break;case"<":if(e<n)return!0;break;case"<>":if(e!=n)return!0;break;case">=":if(e>=n)return!0;break;case"<=":if(e<=n)return!0}return!1}function ow(e,t){var n=function(e){for(var t=[],n=!1,r=0,a=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:n=!n;break;case 95:case 42:case 92:++r;break;case 59:t[t.length]=e.substr(a,r-a),a=r+1}if(t[t.length]=e.substr(a),!0===n)throw new Error("Format |"+e+"| unterminated string ");return t}(e),r=n.length,a=n[r-1].indexOf("@");if(r<4&&a>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if("number"!==typeof t)return[4,4===n.length||a>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=a>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=a>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=a>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"]}var i=t>0?n[0]:t<0?n[1]:n[2];if(-1===n[0].indexOf("[")&&-1===n[1].indexOf("["))return[r,i];if(null!=n[0].match(/\[[=<>]/)||null!=n[1].match(/\[[=<>]/)){var s=n[0].match(iw),o=n[1].match(iw);return sw(t,s)?[r,n[0]]:sw(t,o)?[r,n[1]]:[r,n[null!=s&&null!=o?2:1]]}return[r,i]}function cw(e,t,n){null==n&&(n={});var r="";switch(typeof e){case"string":r="m/d/yy"==e&&n.dateNF?n.dateNF:e;break;case"number":null==(r=14==e&&n.dateNF?n.dateNF:(null!=n.table?n.table:Nb)[e])&&(r=n.table&&n.table[Rb[e]]||Nb[Rb[e]]),null==r&&(r=Ob[e]||"General")}if(_b(r,0))return Bb(t,n);t instanceof Date&&(t=zb(t,n.date1904));var a=ow(r,t);if(_b(a[1]))return Bb(t,n);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return function(e,t,n,r){for(var a,i,s,o=[],c="",l=0,u="",d="t",h="H";l<e.length;)switch(u=e.charAt(l)){case"G":if(!_b(e,l))throw new Error("unrecognized character "+u+" in "+e);o[o.length]={t:"G",v:"General"},l+=7;break;case'"':for(c="";34!==(s=e.charCodeAt(++l))&&l<e.length;)c+=String.fromCharCode(s);o[o.length]={t:"t",v:c},++l;break;case"\\":var f=e.charAt(++l),p="("===f||")"===f?f:"t";o[o.length]={t:p,v:f},++l;break;case"_":o[o.length]={t:"t",v:" "},l+=2;break;case"@":o[o.length]={t:"T",v:t},++l;break;case"B":case"b":if("1"===e.charAt(l+1)||"2"===e.charAt(l+1)){if(null==a&&null==(a=Pb(t,n,"2"===e.charAt(l+1))))return"";o[o.length]={t:"X",v:e.substr(l,2)},d=u,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==a&&null==(a=Pb(t,n)))return"";for(c=u;++l<e.length&&e.charAt(l).toLowerCase()===u;)c+=u;"m"===u&&"h"===d.toLowerCase()&&(u="M"),"h"===u&&(u=h),o[o.length]={t:u,v:c},d=u;break;case"A":case"a":case"\u4e0a":var g={t:u,v:u};if(null==a&&(a=Pb(t,n)),"A/P"===e.substr(l,3).toUpperCase()?(null!=a&&(g.v=a.H>=12?"P":"A"),g.t="T",h="h",l+=3):"AM/PM"===e.substr(l,5).toUpperCase()?(null!=a&&(g.v=a.H>=12?"PM":"AM"),g.t="T",l+=5,h="h"):"\u4e0a\u5348/\u4e0b\u5348"===e.substr(l,5).toUpperCase()?(null!=a&&(g.v=a.H>=12?"\u4e0b\u5348":"\u4e0a\u5348"),g.t="T",l+=5,h="h"):(g.t="t",++l),null==a&&"T"===g.t)return"";o[o.length]=g,d=u;break;case"[":for(c=u;"]"!==e.charAt(l++)&&l<e.length;)c+=e.charAt(l);if("]"!==c.slice(-1))throw'unterminated "[" block: |'+c+"|";if(c.match(rw)){if(null==a&&null==(a=Pb(t,n)))return"";o[o.length]={t:"Z",v:c.toLowerCase()},d=c.charAt(1)}else c.indexOf("$")>-1&&(c=(c.match(/\$([^-\[\]]*)/)||[])[1]||"$",aw(e)||(o[o.length]={t:"t",v:c}));break;case".":if(null!=a){for(c=u;++l<e.length&&"0"===(u=e.charAt(l));)c+=u;o[o.length]={t:"s",v:c};break}case"0":case"#":for(c=u;++l<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(l))>-1;)c+=u;o[o.length]={t:"n",v:c};break;case"?":for(c=u;e.charAt(++l)===u;)c+=u;o[o.length]={t:u,v:c},d=u;break;case"*":++l," "!=e.charAt(l)&&"*"!=e.charAt(l)||++l;break;case"(":case")":o[o.length]={t:1===r?"t":u,v:u},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(c=u;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)c+=e.charAt(l);o[o.length]={t:"D",v:c};break;case" ":o[o.length]={t:u,v:u},++l;break;case"$":o[o.length]={t:"t",v:"$"},++l;break;default:if(-1===",$-+/():!^&'~{}<>=\u20acacfijklopqrtuvwxzP".indexOf(u))throw new Error("unrecognized character "+u+" in "+e);o[o.length]={t:"t",v:u},++l}var m,v=0,y=0;for(l=o.length-1,d="t";l>=0;--l)switch(o[l].t){case"h":case"H":o[l].t=h,d="h",v<1&&(v=1);break;case"s":(m=o[l].v.match(/\.0+$/))&&(y=Math.max(y,m[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":d=o[l].t;break;case"m":"s"===d&&(o[l].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&o[l].v.match(/[Hh]/)&&(v=1),v<2&&o[l].v.match(/[Mm]/)&&(v=2),v<3&&o[l].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:a.u>=.5&&(a.u=0,++a.S),a.S>=60&&(a.S=0,++a.M),a.M>=60&&(a.M=0,++a.H);break;case 2:a.u>=.5&&(a.u=0,++a.S),a.S>=60&&(a.S=0,++a.M)}var b,w="";for(l=0;l<o.length;++l)switch(o[l].t){case"t":case"T":case" ":case"D":break;case"X":o[l].v="",o[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":o[l].v=Vb(o[l].t.charCodeAt(0),o[l].v,a,y),o[l].t="t";break;case"n":case"?":for(b=l+1;null!=o[b]&&("?"===(u=o[b].t)||"D"===u||(" "===u||"t"===u)&&null!=o[b+1]&&("?"===o[b+1].t||"t"===o[b+1].t&&"/"===o[b+1].v)||"("===o[l].t&&(" "===u||"n"===u||")"===u)||"t"===u&&("/"===o[b].v||" "===o[b].v&&null!=o[b+1]&&"?"==o[b+1].t));)o[l].v+=o[b].v,o[b]={v:"",t:";"},++b;w+=o[l].v,l=b-1;break;case"G":o[l].t="t",o[l].v=Bb(t,n)}var E,T,x="";if(w.length>0){40==w.charCodeAt(0)?(E=t<0&&45===w.charCodeAt(0)?-t:t,T=nw("n",w,E)):(T=nw("n",w,E=t<0&&r>1?-t:t),E<0&&o[0]&&"t"==o[0].t&&(T=T.substr(1),o[0].v="-"+o[0].v)),b=T.length-1;var S=o.length;for(l=0;l<o.length;++l)if(null!=o[l]&&"t"!=o[l].t&&o[l].v.indexOf(".")>-1){S=l;break}var I=o.length;if(S===o.length&&-1===T.indexOf("E")){for(l=o.length-1;l>=0;--l)null!=o[l]&&-1!=="n?".indexOf(o[l].t)&&(b>=o[l].v.length-1?(b-=o[l].v.length,o[l].v=T.substr(b+1,o[l].v.length)):b<0?o[l].v="":(o[l].v=T.substr(0,b+1),b=-1),o[l].t="t",I=l);b>=0&&I<o.length&&(o[I].v=T.substr(0,b+1)+o[I].v)}else if(S!==o.length&&-1===T.indexOf("E")){for(b=T.indexOf(".")-1,l=S;l>=0;--l)if(null!=o[l]&&-1!=="n?".indexOf(o[l].t)){for(i=o[l].v.indexOf(".")>-1&&l===S?o[l].v.indexOf(".")-1:o[l].v.length-1,x=o[l].v.substr(i+1);i>=0;--i)b>=0&&("0"===o[l].v.charAt(i)||"#"===o[l].v.charAt(i))&&(x=T.charAt(b--)+x);o[l].v=x,o[l].t="t",I=l}for(b>=0&&I<o.length&&(o[I].v=T.substr(0,b+1)+o[I].v),b=T.indexOf(".")+1,l=S;l<o.length;++l)if(null!=o[l]&&(-1!=="n?(".indexOf(o[l].t)||l===S)){for(i=o[l].v.indexOf(".")>-1&&l===S?o[l].v.indexOf(".")+1:0,x=o[l].v.substr(0,i);i<o[l].v.length;++i)b<T.length&&(x+=T.charAt(b++));o[l].v=x,o[l].t="t",I=l}}}for(l=0;l<o.length;++l)null!=o[l]&&"n?".indexOf(o[l].t)>-1&&(E=r>1&&t<0&&l>0&&"-"===o[l-1].v?-t:t,o[l].v=nw(o[l].t,o[l].v,E),o[l].t="t");var k="";for(l=0;l!==o.length;++l)null!=o[l]&&(k+=o[l].v);return k}(a[1],t,n,a[0])}function lw(e,t){if("number"!=typeof t){t=+t||-1;for(var n=0;n<392;++n)if(void 0!=Nb[n]){if(Nb[n]==e){t=n;break}}else t<0&&(t=n);t<0&&(t=391)}return Nb[t]=e,t}function uw(){var e;e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "',Nb=e}var dw={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},hw=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;var fw=function(){var e={};e.version="1.2.0";var t=function(){for(var e=0,t=new Array(256),n=0;256!=n;++n)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=n)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[n]=e;return"undefined"!==typeof Int32Array?new Int32Array(t):t}();var n=function(e){var t=0,n=0,r=0,a="undefined"!==typeof Int32Array?new Int32Array(4096):new Array(4096);for(r=0;256!=r;++r)a[r]=e[r];for(r=0;256!=r;++r)for(n=e[r],t=256+r;t<4096;t+=256)n=a[t]=n>>>8^e[255&n];var i=[];for(r=1;16!=r;++r)i[r-1]="undefined"!==typeof Int32Array?a.subarray(256*r,256*r+256):a.slice(256*r,256*r+256);return i}(t),r=n[0],a=n[1],i=n[2],s=n[3],o=n[4],c=n[5],l=n[6],u=n[7],d=n[8],h=n[9],f=n[10],p=n[11],g=n[12],m=n[13],v=n[14];return e.table=t,e.bstr=function(e,n){for(var r=~n,a=0,i=e.length;a<i;)r=r>>>8^t[255&(r^e.charCodeAt(a++))];return~r},e.buf=function(e,n){for(var y=~n,b=e.length-15,w=0;w<b;)y=v[e[w++]^255&y]^m[e[w++]^y>>8&255]^g[e[w++]^y>>16&255]^p[e[w++]^y>>>24]^f[e[w++]]^h[e[w++]]^d[e[w++]]^u[e[w++]]^l[e[w++]]^c[e[w++]]^o[e[w++]]^s[e[w++]]^i[e[w++]]^a[e[w++]]^r[e[w++]]^t[e[w++]];for(b+=15;w<b;)y=y>>>8^t[255&(y^e[w++])];return~y},e.str=function(e,n){for(var r=~n,a=0,i=e.length,s=0,o=0;a<i;)(s=e.charCodeAt(a++))<128?r=r>>>8^t[255&(r^s)]:s<2048?r=(r=r>>>8^t[255&(r^(192|s>>6&31))])>>>8^t[255&(r^(128|63&s))]:s>=55296&&s<57344?(s=64+(1023&s),o=1023&e.charCodeAt(a++),r=(r=(r=(r=r>>>8^t[255&(r^(240|s>>8&7))])>>>8^t[255&(r^(128|s>>2&63))])>>>8^t[255&(r^(128|o>>6&15|(3&s)<<4))])>>>8^t[255&(r^(128|63&o))]):r=(r=(r=r>>>8^t[255&(r^(224|s>>12&15))])>>>8^t[255&(r^(128|s>>6&63))])>>>8^t[255&(r^(128|63&s))];return~r},e}(),pw=function(){var e,t={};function n(e){if("/"==e.charAt(e.length-1))return-1===e.slice(0,-1).indexOf("/")?e:n(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(0,t+1)}function r(e){if("/"==e.charAt(e.length-1))return r(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(t+1)}function a(e,t){"string"===typeof t&&(t=new Date(t));var n=t.getHours();n=(n=n<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e.write_shift(2,n);var r=t.getFullYear()-1980;r=(r=r<<4|t.getMonth()+1)<<5|t.getDate(),e.write_shift(2,r)}function i(e){cT(e,0);for(var t={},n=0;e.l<=e.length-4;){var r=e.read_shift(2),a=e.read_shift(2),i=e.l+a,s={};if(21589===r)1&(n=e.read_shift(1))&&(s.mtime=e.read_shift(4)),a>5&&(2&n&&(s.atime=e.read_shift(4)),4&n&&(s.ctime=e.read_shift(4))),s.mtime&&(s.mt=new Date(1e3*s.mtime));e.l=i,t[r]=s}return t}function s(){return e||(e={})}function o(e,t){if(80==e[0]&&75==e[1])return re(e,t);if(109==(32|e[0])&&105==(32|e[1]))return function(e,t){if("mime-version:"!=T(e.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var n=t&&t.root||"",r=(db&&Buffer.isBuffer(e)?e.toString("binary"):T(e)).split("\r\n"),a=0,i="";for(a=0;a<r.length;++a)if(i=r[a],/^Content-Location:/i.test(i)&&(i=i.slice(i.indexOf("file")),n||(n=i.slice(0,i.lastIndexOf("/")+1)),i.slice(0,n.length)!=n))for(;n.length>0&&(n=(n=n.slice(0,n.length-1)).slice(0,n.lastIndexOf("/")+1),i.slice(0,n.length)!=n););var s=(r[1]||"").match(/boundary="(.*?)"/);if(!s)throw new Error("MAD cannot find boundary");var o="--"+(s[1]||""),c=[],l=[],u={FileIndex:c,FullPaths:l};h(u);var d,f=0;for(a=0;a<r.length;++a){var p=r[a];p!==o&&p!==o+"--"||(f++&&le(u,r.slice(d,a),n),d=a)}return u}(e,t);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var n,r,a,i,s,o,f=512,p=[],g=e.slice(0,512);cT(g,0);var m=function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(y,"Header Signature: "),e.l+=16;var t=e.read_shift(2,"u");return[e.read_shift(2,"u"),t]}(g);switch(n=m[0]){case 3:f=512;break;case 4:f=4096;break;case 0:if(0==m[1])return re(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+n)}512!==f&&cT(g=e.slice(0,f),28);var b=e.slice(0,f);!function(e,t){var n=9;switch(e.l+=2,n=e.read_shift(2)){case 9:if(3!=t)throw new Error("Sector Shift: Expected 9 saw "+n);break;case 12:if(4!=t)throw new Error("Sector Shift: Expected 12 saw "+n);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+n)}e.chk("0600","Mini Sector Shift: "),e.chk("000000000000","Reserved: ")}(g,n);var w=g.read_shift(4,"i");if(3===n&&0!==w)throw new Error("# Directory Sectors: Expected 0 saw "+w);g.l+=4,i=g.read_shift(4,"i"),g.l+=4,g.chk("00100000","Mini Stream Cutoff Size: "),s=g.read_shift(4,"i"),r=g.read_shift(4,"i"),o=g.read_shift(4,"i"),a=g.read_shift(4,"i");for(var E=-1,x=0;x<109&&!((E=g.read_shift(4,"i"))<0);++x)p[x]=E;var S=function(e,t){for(var n=Math.ceil(e.length/t)-1,r=[],a=1;a<n;++a)r[a-1]=e.slice(a*t,(a+1)*t);return r[n-1]=e.slice(n*t),r}(e,f);l(o,a,S,f,p);var I=function(e,t,n,r){var a=e.length,i=[],s=[],o=[],c=[],l=r-1,u=0,d=0,h=0,f=0;for(u=0;u<a;++u)if(o=[],(h=u+t)>=a&&(h-=a),!s[h]){c=[];var p=[];for(d=h;d>=0;){p[d]=!0,s[d]=!0,o[o.length]=d,c.push(e[d]);var g=n[Math.floor(4*d/r)];if(r<4+(f=4*d&l))throw new Error("FAT boundary crossed: "+d+" 4 "+r);if(!e[g])break;if(p[d=eT(e[g],f)])break}i[h]={nodes:o,data:AE([c])}}return i}(S,i,p,f);I[i].name="!Directory",r>0&&s!==v&&(I[s].name="!MiniFAT"),I[p[0]].name="!FAT",I.fat_addrs=p,I.ssz=f;var k=[],_=[],C=[];!function(e,t,n,r,a,i,s,o){for(var l,h=0,f=r.length?2:0,p=t[e].data,g=0,m=0;g<p.length;g+=128){var y=p.slice(g,g+128);cT(y,64),m=y.read_shift(2),l=RE(y,0,m-f),r.push(l);var b={name:l,type:y.read_shift(1),color:y.read_shift(1),L:y.read_shift(4,"i"),R:y.read_shift(4,"i"),C:y.read_shift(4,"i"),clsid:y.read_shift(16),state:y.read_shift(4,"i"),start:0,size:0};0!==y.read_shift(2)+y.read_shift(2)+y.read_shift(2)+y.read_shift(2)&&(b.ct=d(y,y.l-8)),0!==y.read_shift(2)+y.read_shift(2)+y.read_shift(2)+y.read_shift(2)&&(b.mt=d(y,y.l-8)),b.start=y.read_shift(4,"i"),b.size=y.read_shift(4,"i"),b.size<0&&b.start<0&&(b.size=b.type=0,b.start=v,b.name=""),5===b.type?(h=b.start,a>0&&h!==v&&(t[h].name="!StreamData")):b.size>=4096?(b.storage="fat",void 0===t[b.start]&&(t[b.start]=u(n,b.start,t.fat_addrs,t.ssz)),t[b.start].name=b.name,b.content=t[b.start].data.slice(0,b.size)):(b.storage="minifat",b.size<0?b.size=0:h!==v&&b.start!==v&&t[h]&&(b.content=c(b,t[h].data,(t[o]||{}).data))),b.content&&cT(b.content,0),i[l]=b,s.push(b)}}(i,I,S,k,r,{},_,s),function(e,t,n){for(var r=0,a=0,i=0,s=0,o=0,c=n.length,l=[],u=[];r<c;++r)l[r]=u[r]=r,t[r]=n[r];for(;o<u.length;++o)a=e[r=u[o]].L,i=e[r].R,s=e[r].C,l[r]===r&&(-1!==a&&l[a]!==a&&(l[r]=l[a]),-1!==i&&l[i]!==i&&(l[r]=l[i])),-1!==s&&(l[s]=r),-1!==a&&r!=l[r]&&(l[a]=l[r],u.lastIndexOf(a)<o&&u.push(a)),-1!==i&&r!=l[r]&&(l[i]=l[r],u.lastIndexOf(i)<o&&u.push(i));for(r=1;r<c;++r)l[r]===r&&(-1!==i&&l[i]!==i?l[r]=l[i]:-1!==a&&l[a]!==a&&(l[r]=l[a]));for(r=1;r<c;++r)if(0!==e[r].type){if((o=r)!=l[o])do{o=l[o],t[r]=t[o]+"/"+t[r]}while(0!==o&&-1!==l[o]&&o!=l[o]);l[r]=-1}for(t[0]+="/",r=1;r<c;++r)2!==e[r].type&&(t[r]+="/")}(_,C,k),k.shift();var A={FileIndex:_,FullPaths:C};return t&&t.raw&&(A.raw={header:b,sectors:S}),A}function c(e,t,n){for(var r=e.start,a=e.size,i=[],s=r;n&&a>0&&s>=0;)i.push(t.slice(s*m,s*m+m)),a-=m,s=eT(n,4*s);return 0===i.length?uT(0):yb(i).slice(0,e.size)}function l(e,t,n,r,a){var i=v;if(e===v){if(0!==t)throw new Error("DIFAT chain shorter than expected")}else if(-1!==e){var s=n[e],o=(r>>>2)-1;if(!s)return;for(var c=0;c<o&&(i=eT(s,4*c))!==v;++c)a.push(i);l(eT(s,r-4),t-1,n,r,a)}}function u(e,t,n,r,a){var i=[],s=[];a||(a=[]);var o=r-1,c=0,l=0;for(c=t;c>=0;){a[c]=!0,i[i.length]=c,s.push(e[c]);var u=n[Math.floor(4*c/r)];if(r<4+(l=4*c&o))throw new Error("FAT boundary crossed: "+c+" 4 "+r);if(!e[u])break;c=eT(e[u],l)}return{nodes:i,data:AE([s])}}function d(e,t){return new Date(1e3*(ZE(e,t+4)/1e7*Math.pow(2,32)+ZE(e,t)/1e7-11644473600))}function h(e,t){var n=t||{},r=n.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=r+"/",e.FileIndex[0]={name:r,type:5}),n.CLSID&&(e.FileIndex[0].clsid=n.CLSID),function(e){var t="\x01Sh33tJ5";if(pw.find(e,"/"+t))return;var n=uT(4);n[0]=55,n[1]=n[3]=50,n[2]=54,e.FileIndex.push({name:t,type:2,content:n,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+t),f(e)}(e)}function f(e,t){h(e);for(var a=!1,i=!1,s=e.FullPaths.length-1;s>=0;--s){var o=e.FileIndex[s];switch(o.type){case 0:i?a=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:i=!0,isNaN(o.R*o.L*o.C)&&(a=!0),o.R>-1&&o.L>-1&&o.R==o.L&&(a=!0);break;default:a=!0}}if(a||t){var c=new Date(1987,1,19),l=0,u=Object.create?Object.create(null):{},d=[];for(s=0;s<e.FullPaths.length;++s)u[e.FullPaths[s]]=!0,0!==e.FileIndex[s].type&&d.push([e.FullPaths[s],e.FileIndex[s]]);for(s=0;s<d.length;++s){var f=n(d[s][0]);(i=u[f])||(d.push([f,{name:r(f).replace("/",""),type:1,clsid:w,ct:c,mt:c,content:null}]),u[f]=!0)}for(d.sort((function(e,t){return function(e,t){for(var n=e.split("/"),r=t.split("/"),a=0,i=0,s=Math.min(n.length,r.length);a<s;++a){if(i=n[a].length-r[a].length)return i;if(n[a]!=r[a])return n[a]<r[a]?-1:1}return n.length-r.length}(e[0],t[0])})),e.FullPaths=[],e.FileIndex=[],s=0;s<d.length;++s)e.FullPaths[s]=d[s][0],e.FileIndex[s]=d[s][1];for(s=0;s<d.length;++s){var p=e.FileIndex[s],g=e.FullPaths[s];if(p.name=r(g).replace("/",""),p.L=p.R=p.C=-(p.color=1),p.size=p.content?p.content.length:0,p.start=0,p.clsid=p.clsid||w,0===s)p.C=d.length>1?1:-1,p.size=0,p.type=5;else if("/"==g.slice(-1)){for(l=s+1;l<d.length&&n(e.FullPaths[l])!=g;++l);for(p.C=l>=d.length?-1:l,l=s+1;l<d.length&&n(e.FullPaths[l])!=n(g);++l);p.R=l>=d.length?-1:l,p.type=1}else n(e.FullPaths[s+1]||"")==n(g)&&(p.R=s+1),p.type=2}}}function p(e,t){var n=t||{};if("mad"==n.fileType)return function(e,t){for(var n=t||{},r=n.boundary||"SheetJS",a=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(r="------="+r).slice(2)+'"',"","",""],i=e.FullPaths[0],s=i,o=e.FileIndex[0],c=1;c<e.FullPaths.length;++c)if(s=e.FullPaths[c].slice(i.length),(o=e.FileIndex[c]).size&&o.content&&"\x01Sh33tJ5"!=s){s=s.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,(function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"})).replace(/[\u0080-\uFFFF]/g,(function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"}));for(var l=o.content,u=db&&Buffer.isBuffer(l)?l.toString("binary"):T(l),d=0,h=Math.min(1024,u.length),f=0,p=0;p<=h;++p)(f=u.charCodeAt(p))>=32&&f<128&&++d;var g=d>=4*h/5;a.push(r),a.push("Content-Location: "+(n.root||"file:///C:/SheetJS/")+s),a.push("Content-Transfer-Encoding: "+(g?"quoted-printable":"base64")),a.push("Content-Type: "+se(o,s)),a.push(""),a.push(g?ce(u):oe(u))}return a.push(r+"--\r\n"),a.join("\r\n")}(e,n);if(f(e),"zip"===n.fileType)return function(e,t){var n=t||{},r=[],i=[],s=uT(1),o=n.compression?8:0,c=0;0;var l=0,u=0,d=0,h=0,f=e.FullPaths[0],p=f,g=e.FileIndex[0],m=[],v=0;for(l=1;l<e.FullPaths.length;++l)if(p=e.FullPaths[l].slice(f.length),(g=e.FileIndex[l]).size&&g.content&&"\x01Sh33tJ5"!=p){var y=d,b=uT(p.length);for(u=0;u<p.length;++u)b.write_shift(1,127&p.charCodeAt(u));b=b.slice(0,b.l),m[h]=fw.buf(g.content,0);var w=g.content;8==o&&(w=x(w)),(s=uT(30)).write_shift(4,67324752),s.write_shift(2,20),s.write_shift(2,c),s.write_shift(2,o),g.mt?a(s,g.mt):s.write_shift(4,0),s.write_shift(-4,8&c?0:m[h]),s.write_shift(4,8&c?0:w.length),s.write_shift(4,8&c?0:g.content.length),s.write_shift(2,b.length),s.write_shift(2,0),d+=s.length,r.push(s),d+=b.length,r.push(b),d+=w.length,r.push(w),8&c&&((s=uT(12)).write_shift(-4,m[h]),s.write_shift(4,w.length),s.write_shift(4,g.content.length),d+=s.l,r.push(s)),(s=uT(46)).write_shift(4,33639248),s.write_shift(2,0),s.write_shift(2,20),s.write_shift(2,c),s.write_shift(2,o),s.write_shift(4,0),s.write_shift(-4,m[h]),s.write_shift(4,w.length),s.write_shift(4,g.content.length),s.write_shift(2,b.length),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(4,0),s.write_shift(4,y),v+=s.l,i.push(s),v+=b.length,i.push(b),++h}return s=uT(22),s.write_shift(4,101010256),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,h),s.write_shift(2,h),s.write_shift(4,v),s.write_shift(4,d),s.write_shift(2,0),yb([yb(r),yb(i),s])}(e,n);var r=function(e){for(var t=0,n=0,r=0;r<e.FileIndex.length;++r){var a=e.FileIndex[r];if(a.content){var i=a.content.length;i>0&&(i<4096?t+=i+63>>6:n+=i+511>>9)}}for(var s=e.FullPaths.length+3>>2,o=t+127>>7,c=(t+7>>3)+n+s+o,l=c+127>>7,u=l<=109?0:Math.ceil((l-109)/127);c+l+u+127>>7>l;)u=++l<=109?0:Math.ceil((l-109)/127);var d=[1,u,l,o,s,n,t,0];return e.FileIndex[0].size=t<<6,d[7]=(e.FileIndex[0].start=d[0]+d[1]+d[2]+d[3]+d[4]+d[5])+(d[6]+7>>3),d}(e),i=uT(r[7]<<9),s=0,o=0;for(s=0;s<8;++s)i.write_shift(1,b[s]);for(s=0;s<8;++s)i.write_shift(2,0);for(i.write_shift(2,62),i.write_shift(2,3),i.write_shift(2,65534),i.write_shift(2,9),i.write_shift(2,6),s=0;s<3;++s)i.write_shift(2,0);for(i.write_shift(4,0),i.write_shift(4,r[2]),i.write_shift(4,r[0]+r[1]+r[2]+r[3]-1),i.write_shift(4,0),i.write_shift(4,4096),i.write_shift(4,r[3]?r[0]+r[1]+r[2]-1:v),i.write_shift(4,r[3]),i.write_shift(-4,r[1]?r[0]-1:v),i.write_shift(4,r[1]),s=0;s<109;++s)i.write_shift(-4,s<r[2]?r[1]+s:-1);if(r[1])for(o=0;o<r[1];++o){for(;s<236+127*o;++s)i.write_shift(-4,s<r[2]?r[1]+s:-1);i.write_shift(-4,o===r[1]-1?v:o+1)}var c=function(e){for(o+=e;s<o-1;++s)i.write_shift(-4,s+1);e&&(++s,i.write_shift(-4,v))};for(o=s=0,o+=r[1];s<o;++s)i.write_shift(-4,E.DIFSECT);for(o+=r[2];s<o;++s)i.write_shift(-4,E.FATSECT);c(r[3]),c(r[4]);for(var l=0,u=0,d=e.FileIndex[0];l<e.FileIndex.length;++l)(d=e.FileIndex[l]).content&&((u=d.content.length)<4096||(d.start=o,c(u+511>>9)));for(c(r[6]+7>>3);511&i.l;)i.write_shift(-4,E.ENDOFCHAIN);for(o=s=0,l=0;l<e.FileIndex.length;++l)(d=e.FileIndex[l]).content&&(!(u=d.content.length)||u>=4096||(d.start=o,c(u+63>>6)));for(;511&i.l;)i.write_shift(-4,E.ENDOFCHAIN);for(s=0;s<r[4]<<2;++s){var h=e.FullPaths[s];if(h&&0!==h.length){d=e.FileIndex[s],0===s&&(d.start=d.size?d.start-1:v);var p=0===s&&n.root||d.name;if(u=2*(p.length+1),i.write_shift(64,p,"utf16le"),i.write_shift(2,u),i.write_shift(1,d.type),i.write_shift(1,d.color),i.write_shift(-4,d.L),i.write_shift(-4,d.R),i.write_shift(-4,d.C),d.clsid)i.write_shift(16,d.clsid,"hex");else for(l=0;l<4;++l)i.write_shift(4,0);i.write_shift(4,d.state||0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,d.start),i.write_shift(4,d.size),i.write_shift(4,0)}else{for(l=0;l<17;++l)i.write_shift(4,0);for(l=0;l<3;++l)i.write_shift(4,-1);for(l=0;l<12;++l)i.write_shift(4,0)}}for(s=1;s<e.FileIndex.length;++s)if((d=e.FileIndex[s]).size>=4096)if(i.l=d.start+1<<9,db&&Buffer.isBuffer(d.content))d.content.copy(i,i.l,0,d.size),i.l+=d.size+511&-512;else{for(l=0;l<d.size;++l)i.write_shift(1,d.content[l]);for(;511&l;++l)i.write_shift(1,0)}for(s=1;s<e.FileIndex.length;++s)if((d=e.FileIndex[s]).size>0&&d.size<4096)if(db&&Buffer.isBuffer(d.content))d.content.copy(i,i.l,0,d.size),i.l+=d.size+63&-64;else{for(l=0;l<d.size;++l)i.write_shift(1,d.content[l]);for(;63&l;++l)i.write_shift(1,0)}if(db)i.l=i.length;else for(;i.l<i.length;)i.write_shift(1,0);return i}t.version="1.2.1";var g,m=64,v=-2,y="d0cf11e0a1b11ae1",b=[208,207,17,224,161,177,26,225],w="00000000000000000000000000000000",E={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:v,FREESECT:-1,HEADER_SIGNATURE:y,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:w,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function T(e){for(var t=new Array(e.length),n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function x(e){return g?g.deflateRawSync(e):q(e)}var S=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],I=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],k=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function _(e){var t=139536&(e<<1|e<<11)|558144&(e<<5|e<<15);return 255&(t>>16|t>>8|t)}for(var C="undefined"!==typeof Uint8Array,A=C?new Uint8Array(256):[],N=0;N<256;++N)A[N]=_(N);function R(e,t){var n=A[255&e];return t<=8?n>>>8-t:(n=n<<8|A[e>>8&255],t<=16?n>>>16-t:(n=n<<8|A[e>>16&255])>>>24-t)}function O(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=6?0:e[r+1]<<8))>>>n&3}function D(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=5?0:e[r+1]<<8))>>>n&7}function P(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=3?0:e[r+1]<<8))>>>n&31}function L(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=1?0:e[r+1]<<8))>>>n&127}function M(e,t,n){var r=7&t,a=t>>>3,i=(1<<n)-1,s=e[a]>>>r;return n<8-r?s&i:(s|=e[a+1]<<8-r,n<16-r?s&i:(s|=e[a+2]<<16-r,n<24-r?s&i:(s|=e[a+3]<<24-r)&i))}function F(e,t,n){var r=7&t,a=t>>>3;return r<=5?e[a]|=(7&n)<<r:(e[a]|=n<<r&255,e[a+1]=(7&n)>>8-r),t+3}function z(e,t,n){return n=(1&n)<<(7&t),e[t>>>3]|=n,t+1}function j(e,t,n){var r=t>>>3;return n<<=7&t,e[r]|=255&n,n>>>=8,e[r+1]=n,t+8}function U(e,t,n){var r=t>>>3;return n<<=7&t,e[r]|=255&n,n>>>=8,e[r+1]=255&n,e[r+2]=n>>>8,t+16}function B(e,t){var n=e.length,r=2*n>t?2*n:t+5,a=0;if(n>=t)return e;if(db){var i=pb(r);if(e.copy)e.copy(i);else for(;a<e.length;++a)i[a]=e[a];return i}if(C){var s=new Uint8Array(r);if(s.set)s.set(e);else for(;a<n;++a)s[a]=e[a];return s}return e.length=r,e}function V(e){for(var t=new Array(e),n=0;n<e;++n)t[n]=0;return t}function $(e,t,n){var r=1,a=0,i=0,s=0,o=0,c=e.length,l=C?new Uint16Array(32):V(32);for(i=0;i<32;++i)l[i]=0;for(i=c;i<n;++i)e[i]=0;c=e.length;var u=C?new Uint16Array(c):V(c);for(i=0;i<c;++i)l[a=e[i]]++,r<a&&(r=a),u[i]=0;for(l[0]=0,i=1;i<=r;++i)l[i+16]=o=o+l[i-1]<<1;for(i=0;i<c;++i)0!=(o=e[i])&&(u[i]=l[o+16]++);var d=0;for(i=0;i<c;++i)if(0!=(d=e[i]))for(o=R(u[i],r)>>r-d,s=(1<<r+4-d)-1;s>=0;--s)t[o|s<<d]=15&d|i<<4;return r}var H=C?new Uint16Array(512):V(512),W=C?new Uint16Array(32):V(32);if(!C){for(var G=0;G<512;++G)H[G]=0;for(G=0;G<32;++G)W[G]=0}!function(){for(var e=[],t=0;t<32;t++)e.push(5);$(e,W,32);var n=[];for(t=0;t<=143;t++)n.push(8);for(;t<=255;t++)n.push(9);for(;t<=279;t++)n.push(7);for(;t<=287;t++)n.push(8);$(n,H,288)}();var K=function(){for(var e=C?new Uint8Array(32768):[],t=0,n=0;t<k.length-1;++t)for(;n<k[t+1];++n)e[n]=t;for(;n<32768;++n)e[n]=29;var r=C?new Uint8Array(259):[];for(t=0,n=0;t<I.length-1;++t)for(;n<I[t+1];++n)r[n]=t;return function(t,n){return t.length<8?function(e,t){for(var n=0;n<e.length;){var r=Math.min(65535,e.length-n),a=n+r==e.length;for(t.write_shift(1,+a),t.write_shift(2,r),t.write_shift(2,65535&~r);r-- >0;)t[t.l++]=e[n++]}return t.l}(t,n):function(t,n){for(var a=0,i=0,s=C?new Uint16Array(32768):[];i<t.length;){var o=Math.min(65535,t.length-i);if(o<10){for(7&(a=F(n,a,+!(i+o!=t.length)))&&(a+=8-(7&a)),n.l=a/8|0,n.write_shift(2,o),n.write_shift(2,65535&~o);o-- >0;)n[n.l++]=t[i++];a=8*n.l}else{a=F(n,a,+!(i+o!=t.length)+2);for(var c=0;o-- >0;){var l=t[i],u=-1,d=0;if((u=s[c=32767&(c<<5^l)])&&((u|=-32768&i)>i&&(u-=32768),u<i))for(;t[u+d]==t[i+d]&&d<250;)++d;if(d>2){(l=r[d])<=22?a=j(n,a,A[l+1]>>1)-1:(j(n,a,3),j(n,a+=5,A[l-23]>>5),a+=3);var h=l<8?0:l-4>>2;h>0&&(U(n,a,d-I[l]),a+=h),l=e[i-u],a=j(n,a,A[l]>>3),a-=3;var f=l<4?0:l-2>>1;f>0&&(U(n,a,i-u-k[l]),a+=f);for(var p=0;p<d;++p)s[c]=32767&i,c=32767&(c<<5^t[i]),++i;o-=d-1}else l<=143?l+=48:a=z(n,a,1),a=j(n,a,A[l]),s[c]=32767&i,++i}a=j(n,a,0)-1}}return n.l=(a+7)/8|0,n.l}(t,n)}}();function q(e){var t=uT(50+Math.floor(1.1*e.length)),n=K(e,t);return t.slice(0,n)}var Y=C?new Uint16Array(32768):V(32768),X=C?new Uint16Array(32768):V(32768),Q=C?new Uint16Array(128):V(128),J=1,Z=1;function ee(e,t){var n=P(e,t)+257,r=P(e,t+=5)+1,a=function(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=4?0:e[r+1]<<8))>>>n&15}(e,t+=5)+4;t+=4;for(var i=0,s=C?new Uint8Array(19):V(19),o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],c=1,l=C?new Uint8Array(8):V(8),u=C?new Uint8Array(8):V(8),d=s.length,h=0;h<a;++h)s[S[h]]=i=D(e,t),c<i&&(c=i),l[i]++,t+=3;var f=0;for(l[0]=0,h=1;h<=c;++h)u[h]=f=f+l[h-1]<<1;for(h=0;h<d;++h)0!=(f=s[h])&&(o[h]=u[f]++);var p=0;for(h=0;h<d;++h)if(0!=(p=s[h])){f=A[o[h]]>>8-p;for(var g=(1<<7-p)-1;g>=0;--g)Q[f|g<<p]=7&p|h<<3}var m=[];for(c=1;m.length<n+r;)switch(t+=7&(f=Q[L(e,t)]),f>>>=3){case 16:for(i=3+O(e,t),t+=2,f=m[m.length-1];i-- >0;)m.push(f);break;case 17:for(i=3+D(e,t),t+=3;i-- >0;)m.push(0);break;case 18:for(i=11+L(e,t),t+=7;i-- >0;)m.push(0);break;default:m.push(f),c<f&&(c=f)}var v=m.slice(0,n),y=m.slice(n);for(h=n;h<286;++h)v[h]=0;for(h=r;h<30;++h)y[h]=0;return J=$(v,Y,286),Z=$(y,X,30),t}function te(e,t){var n=function(e,t){if(3==e[0]&&!(3&e[1]))return[fb(t),2];for(var n=0,r=0,a=pb(t||1<<18),i=0,s=a.length>>>0,o=0,c=0;0==(1&r);)if(r=D(e,n),n+=3,r>>>1!=0)for(r>>1==1?(o=9,c=5):(n=ee(e,n),o=J,c=Z);;){!t&&s<i+32767&&(s=(a=B(a,i+32767)).length);var l=M(e,n,o),u=r>>>1==1?H[l]:Y[l];if(n+=15&u,0===((u>>>=4)>>>8&255))a[i++]=u;else{if(256==u)break;var d=(u-=257)<8?0:u-4>>2;d>5&&(d=0);var h=i+I[u];d>0&&(h+=M(e,n,d),n+=d),l=M(e,n,c),n+=15&(u=r>>>1==1?W[l]:X[l]);var f=(u>>>=4)<4?0:u-2>>1,p=k[u];for(f>0&&(p+=M(e,n,f),n+=f),!t&&s<h&&(s=(a=B(a,h+100)).length);i<h;)a[i]=a[i-p],++i}}else{7&n&&(n+=8-(7&n));var g=e[n>>>3]|e[1+(n>>>3)]<<8;if(n+=32,g>0)for(!t&&s<i+g&&(s=(a=B(a,i+g)).length);g-- >0;)a[i++]=e[n>>>3],n+=8}return t?[a,n+7>>>3]:[a.slice(0,i),n+7>>>3]}(e.slice(e.l||0),t);return e.l+=n[1],n[0]}function ne(e,t){if(!e)throw new Error(t);"undefined"!==typeof console&&console.error(t)}function re(e,t){var n=e;cT(n,0);var r={FileIndex:[],FullPaths:[]};h(r,{root:t.root});for(var a=n.length-4;(80!=n[a]||75!=n[a+1]||5!=n[a+2]||6!=n[a+3])&&a>=0;)--a;n.l=a+4,n.l+=4;var s=n.read_shift(2);n.l+=6;var o=n.read_shift(4);for(n.l=o,a=0;a<s;++a){n.l+=20;var c=n.read_shift(4),l=n.read_shift(4),u=n.read_shift(2),d=n.read_shift(2),f=n.read_shift(2);n.l+=8;var p=n.read_shift(4),g=i(n.slice(n.l+u,n.l+u+d));n.l+=u+d+f;var m=n.l;n.l=p+4,ae(n,c,l,r,g),n.l=m}return r}function ae(e,t,n,r,a){e.l+=2;var s=e.read_shift(2),o=e.read_shift(2),c=function(e){var t=65535&e.read_shift(2),n=65535&e.read_shift(2),r=new Date,a=31&n,i=15&(n>>>=5);n>>>=4,r.setMilliseconds(0),r.setFullYear(n+1980),r.setMonth(i-1),r.setDate(a);var s=31&t,o=63&(t>>>=5);return t>>>=6,r.setHours(t),r.setMinutes(o),r.setSeconds(s<<1),r}(e);if(8257&s)throw new Error("Unsupported ZIP encryption");e.read_shift(4);for(var l=e.read_shift(4),u=e.read_shift(4),d=e.read_shift(2),h=e.read_shift(2),f="",p=0;p<d;++p)f+=String.fromCharCode(e[e.l++]);if(h){var m=i(e.slice(e.l,e.l+h));(m[21589]||{}).mt&&(c=m[21589].mt),((a||{})[21589]||{}).mt&&(c=a[21589].mt)}e.l+=h;var v=e.slice(e.l,e.l+l);switch(o){case 8:v=function(e,t){if(!g)return te(e,t);var n=new(0,g.InflateRaw),r=n._processChunk(e.slice(e.l),n._finishFlushFlag);return e.l+=n.bytesRead,r}(e,u);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+o)}var y=!1;8&s&&(134695760==e.read_shift(4)&&(e.read_shift(4),y=!0),l=e.read_shift(4),u=e.read_shift(4)),l!=t&&ne(y,"Bad compressed size: "+t+" != "+l),u!=n&&ne(y,"Bad uncompressed size: "+n+" != "+u),ue(r,f,v,{unsafe:!0,mt:c})}var ie={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function se(e,t){if(e.ctype)return e.ctype;var n=e.name||"",r=n.match(/\.([^\.]+)$/);return r&&ie[r[1]]||t&&(r=(n=t).match(/[\.\\]([^\.\\])+$/))&&ie[r[1]]?ie[r[1]]:"application/octet-stream"}function oe(e){for(var t=lb(e),n=[],r=0;r<t.length;r+=76)n.push(t.slice(r,r+76));return n.join("\r\n")+"\r\n"}function ce(e){var t=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,(function(e){var t=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==t.length?"0"+t:t)}));"\n"==(t=t.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(t="=0D"+t.slice(1));for(var n=[],r=(t=t.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),a=0;a<r.length;++a){var i=r[a];if(0!=i.length)for(var s=0;s<i.length;){var o=76,c=i.slice(s,s+o);"="==c.charAt(o-1)?o--:"="==c.charAt(o-2)?o-=2:"="==c.charAt(o-3)&&(o-=3),c=i.slice(s,s+o),(s+=o)<i.length&&(c+="="),n.push(c)}else n.push("")}return n.join("\r\n")}function le(e,t,n){for(var r,a="",i="",s="",o=0;o<10;++o){var c=t[o];if(!c||c.match(/^\s*$/))break;var l=c.match(/^(.*?):\s*([^\s].*)$/);if(l)switch(l[1].toLowerCase()){case"content-location":a=l[2].trim();break;case"content-type":s=l[2].trim();break;case"content-transfer-encoding":i=l[2].trim()}}switch(++o,i.toLowerCase()){case"base64":r=gb(ub(t.slice(o).join("")));break;case"quoted-printable":r=function(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n];n<=e.length&&"="==r.charAt(r.length-1);)r=r.slice(0,r.length-1)+e[++n];t.push(r)}for(var a=0;a<t.length;++a)t[a]=t[a].replace(/[=][0-9A-Fa-f]{2}/g,(function(e){return String.fromCharCode(parseInt(e.slice(1),16))}));return gb(t.join("\r\n"))}(t.slice(o));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+i)}var u=ue(e,a.slice(n.length),r,{unsafe:!0});s&&(u.ctype=s)}function ue(e,t,n,a){var i=a&&a.unsafe;i||h(e);var s=!i&&pw.find(e,t);if(!s){var o=e.FullPaths[0];t.slice(0,o.length)==o?o=t:("/"!=o.slice(-1)&&(o+="/"),o=(o+t).replace("//","/")),s={name:r(t),type:2},e.FileIndex.push(s),e.FullPaths.push(o),i||pw.utils.cfb_gc(e)}return s.content=n,s.size=n?n.length:0,a&&(a.CLSID&&(s.clsid=a.CLSID),a.mt&&(s.mt=a.mt),a.ct&&(s.ct=a.ct)),s}return t.find=function(e,t){var n=e.FullPaths.map((function(e){return e.toUpperCase()})),r=n.map((function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]})),a=!1;47===t.charCodeAt(0)?(a=!0,t=n[0].slice(0,-1)+t):a=-1!==t.indexOf("/");var i=t.toUpperCase(),s=!0===a?n.indexOf(i):r.indexOf(i);if(-1!==s)return e.FileIndex[s];var o=!i.match(wb);for(i=i.replace(bb,""),o&&(i=i.replace(wb,"!")),s=0;s<n.length;++s){if((o?n[s].replace(wb,"!"):n[s]).replace(bb,"")==i)return e.FileIndex[s];if((o?r[s].replace(wb,"!"):r[s]).replace(bb,"")==i)return e.FileIndex[s]}return null},t.read=function(t,n){var r=n&&n.type;switch(r||db&&Buffer.isBuffer(t)&&(r="buffer"),r||"base64"){case"file":return function(t,n){return s(),o(e.readFileSync(t),n)}(t,n);case"base64":return o(gb(ub(t)),n);case"binary":return o(gb(t),n)}return o(t,n)},t.parse=o,t.write=function(t,n){var r=p(t,n);switch(n&&n.type||"buffer"){case"file":return s(),e.writeFileSync(n.filename,r),r;case"binary":return"string"==typeof r?r:T(r);case"base64":return lb("string"==typeof r?r:T(r));case"buffer":if(db)return Buffer.isBuffer(r)?r:hb(r);case"array":return"string"==typeof r?gb(r):r}return r},t.writeFile=function(t,n,r){s();var a=p(t,r);e.writeFileSync(n,a)},t.utils={cfb_new:function(e){var t={};return h(t,e),t},cfb_add:ue,cfb_del:function(e,t){h(e);var n=pw.find(e,t);if(n)for(var r=0;r<e.FileIndex.length;++r)if(e.FileIndex[r]==n)return e.FileIndex.splice(r,1),e.FullPaths.splice(r,1),!0;return!1},cfb_mov:function(e,t,n){h(e);var a=pw.find(e,t);if(a)for(var i=0;i<e.FileIndex.length;++i)if(e.FileIndex[i]==a)return e.FileIndex[i].name=r(n),e.FullPaths[i]=n,!0;return!1},cfb_gc:function(e){f(e,!0)},ReadShift:nT,CheckField:oT,prep_blob:cT,bconcat:yb,use_zlib:function(e){try{var t=new(0,e.InflateRaw);if(t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag),!t.bytesRead)throw new Error("zlib does not expose bytesRead");g=e}catch(n){console.error("cannot use native zlib: "+(n.message||n))}},_deflateRaw:q,_inflateRaw:te,consts:E},t}();let gw;function mw(e){for(var t=Object.keys(e),n=[],r=0;r<t.length;++r)Object.prototype.hasOwnProperty.call(e,t[r])&&n.push(t[r]);return n}function vw(e){for(var t=[],n=mw(e),r=0;r!==n.length;++r)t[e[n[r]]]=n[r];return t}var yw=new Date(1899,11,30,0,0,0);function bw(e,t){var n=e.getTime();return t&&(n-=1263168e5),(n-(yw.getTime()+6e4*(e.getTimezoneOffset()-yw.getTimezoneOffset())))/864e5}var ww=new Date,Ew=yw.getTime()+6e4*(ww.getTimezoneOffset()-yw.getTimezoneOffset()),Tw=ww.getTimezoneOffset();function xw(e){var t=new Date;return t.setTime(24*e*60*60*1e3+Ew),t.getTimezoneOffset()!==Tw&&t.setTime(t.getTime()+6e4*(t.getTimezoneOffset()-Tw)),t}function Sw(e){var t=0,n=0,r=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(n=1,i>3&&(r=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":n*=24;case"H":n*=60;case"M":if(!r)throw new Error("Unsupported ISO Duration Field: M");n*=60}t+=n*parseInt(a[i],10)}return t}var Iw=new Date("2017-02-19T19:06:09.000Z"),kw=isNaN(Iw.getFullYear())?new Date("2/19/17"):Iw,_w=2017==kw.getFullYear();function Cw(e,t){var n=new Date(e);if(_w)return t>0?n.setTime(n.getTime()+60*n.getTimezoneOffset()*1e3):t<0&&n.setTime(n.getTime()-60*n.getTimezoneOffset()*1e3),n;if(e instanceof Date)return e;if(1917==kw.getFullYear()&&!isNaN(n.getFullYear())){var r=n.getFullYear();return e.indexOf(""+r)>-1||n.setFullYear(n.getFullYear()+100),n}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-60*i.getTimezoneOffset()*1e3)),i}function Aw(e,t){if(db&&Buffer.isBuffer(e)){if(t){if(255==e[0]&&254==e[1])return pE(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return pE(rb(e.slice(2).toString("binary")))}return e.toString("binary")}if("undefined"!==typeof TextDecoder)try{if(t){if(255==e[0]&&254==e[1])return pE(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return pE(new TextDecoder("utf-16be").decode(e.slice(2)))}var n={"\u20ac":"\x80","\u201a":"\x82","\u0192":"\x83","\u201e":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02c6":"\x88","\u2030":"\x89","\u0160":"\x8a","\u2039":"\x8b","\u0152":"\x8c","\u017d":"\x8e","\u2018":"\x91","\u2019":"\x92","\u201c":"\x93","\u201d":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02dc":"\x98","\u2122":"\x99","\u0161":"\x9a","\u203a":"\x9b","\u0153":"\x9c","\u017e":"\x9e","\u0178":"\x9f"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[\u20ac\u201a\u0192\u201e\u2026\u2020\u2021\u02c6\u2030\u0160\u2039\u0152\u017d\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u02dc\u2122\u0161\u203a\u0153\u017e\u0178]/g,(function(e){return n[e]||e}))}catch(i){}for(var r=[],a=0;a!=e.length;++a)r.push(String.fromCharCode(e[a]));return r.join("")}function Nw(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=Nw(e[n]));return t}function Rw(e,t){for(var n="";n.length<t;)n+=e;return n}function Ow(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var n=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,(function(){return n*=100,""}));return isNaN(t=Number(r))?(r=r.replace(/[(](.*)[)]/,(function(e,t){return n=-n,t})),isNaN(t=Number(r))?t:t/n):t/n}var Dw=["january","february","march","april","may","june","july","august","september","october","november","december"];function Pw(e){var t=new Date(e),n=new Date(NaN),r=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return n;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==Dw.indexOf(s))return n}else if(s.match(/[a-z]/))return n;return r<0||r>8099?n:(a>0||i>1)&&101!=r?t:e.match(/[^-0-9:,\/\\]/)?n:t}var Lw=function(){var e=5=="abacaba".split(/(:?b)/i).length;return function(t,n,r){if(e||"string"==typeof n)return t.split(n);for(var a=t.split(n),i=[a[0]],s=1;s<a.length;++s)i.push(r),i.push(a[s]);return i}}();function Mw(e){return e?e.content&&e.type?Aw(e.content,!0):e.data?ib(e.data):e.asNodeBuffer&&db?ib(e.asNodeBuffer().toString("binary")):e.asBinary?ib(e.asBinary()):e._data&&e._data.getContent?ib(Aw(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Fw(e){if(!e)return null;if(e.data)return nb(e.data);if(e.asNodeBuffer&&db)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return"string"==typeof t?nb(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function zw(e,t){for(var n=e.FullPaths||mw(e.files),r=t.toLowerCase().replace(/[\/]/g,"\\"),a=r.replace(/\\/g,"/"),i=0;i<n.length;++i){var s=n[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==s||a==s)return e.files?e.files[n[i]]:e.FileIndex[i]}return null}function jw(e,t){var n=zw(e,t);if(null==n)throw new Error("Cannot find file "+t+" in zip");return n}function Uw(e,t,n){if(!n)return(r=jw(e,t))&&".bin"===r.name.slice(-4)?Fw(r):Mw(r);var r;if(!t)return null;try{return Uw(e,t)}catch(a){return null}}function Bw(e,t,n){if(!n)return Mw(jw(e,t));if(!t)return null;try{return Bw(e,t)}catch(r){return null}}function Vw(e,t,n){if(!n)return Fw(jw(e,t));if(!t)return null;try{return Vw(e,t)}catch(r){return null}}function $w(e){for(var t=e.FullPaths||mw(e.files),n=[],r=0;r<t.length;++r)"/"!=t[r].slice(-1)&&n.push(t[r].replace(/^Root Entry[\/]/,""));return n.sort()}function Hw(e,t,n){if(e.FullPaths){var r;if("string"==typeof n)return r=db?hb(n):function(e){for(var t=[],n=0,r=e.length+250,a=fb(e.length+255),i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)a[n++]=s;else if(s<2048)a[n++]=192|s>>6&31,a[n++]=128|63&s;else if(s>=55296&&s<57344){s=64+(1023&s);var o=1023&e.charCodeAt(++i);a[n++]=240|s>>8&7,a[n++]=128|s>>2&63,a[n++]=128|o>>6&15|(3&s)<<4,a[n++]=128|63&o}else a[n++]=224|s>>12&15,a[n++]=128|s>>6&63,a[n++]=128|63&s;n>r&&(t.push(a.slice(0,n)),n=0,a=fb(65535),r=65530)}return t.push(a.slice(0,n)),yb(t)}(n),pw.utils.cfb_add(e,t,r);pw.utils.cfb_add(e,t,n)}else e.file(t,n)}function Ww(e,t){switch(t.type){case"base64":return pw.read(e,{type:"base64"});case"binary":return pw.read(e,{type:"binary"});case"buffer":case"array":return pw.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Gw(e,t){if("/"==e.charAt(0))return e.slice(1);var n=t.split("/");"/"!=t.slice(-1)&&n.pop();for(var r=e.split("/");0!==r.length;){var a=r.shift();".."===a?n.pop():"."!==a&&n.push(a)}return n.join("/")}var Kw='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',qw=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Yw=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm,Xw=Kw.match(Yw)?Yw:/<[^>]*>/g,Qw=/<\w*:/,Jw=/<(\/?)\w+:/;function Zw(e,t,n){for(var r={},a=0,i=0;a!==e.length&&(32!==(i=e.charCodeAt(a))&&10!==i&&13!==i);++a);if(t||(r[0]=e.slice(0,a)),a===e.length)return r;var s=e.match(qw),o=0,c="",l=0,u="",d="",h=1;if(s)for(l=0;l!=s.length;++l){for(d=s[l],i=0;i!=d.length&&61!==d.charCodeAt(i);++i);for(u=d.slice(0,i).trim();32==d.charCodeAt(i+1);)++i;for(h=34==(a=d.charCodeAt(i+1))||39==a?1:0,c=d.slice(i+1+h,d.length-h),o=0;o!=u.length&&58!==u.charCodeAt(o);++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),r[u]=c,n||(r[u.toLowerCase()]=c);else{var f=(5===o&&"xmlns"===u.slice(0,5)?"xmlns":"")+u.slice(o+1);if(r[f]&&"ext"==u.slice(o-3,o))continue;r[f]=c,n||(r[f.toLowerCase()]=c)}}return r}function eE(e){return e.replace(Jw,"<$1")}var tE={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},nE=vw(tE),rE=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,t=/_x([\da-fA-F]{4})_/gi;return function n(r){var a=r+"",i=a.indexOf("<![CDATA[");if(-1==i)return a.replace(e,(function(e,t){return tE[e]||String.fromCharCode(parseInt(t,e.indexOf("x")>-1?16:10))||e})).replace(t,(function(e,t){return String.fromCharCode(parseInt(t,16))}));var s=a.indexOf("]]>");return n(a.slice(0,i))+a.slice(i+9,s)+n(a.slice(s+3))}}(),aE=/[&<>'"]/g;var iE=/[\u0000-\u001f]/g;function sE(e){return(e+"").replace(aE,(function(e){return nE[e]})).replace(/\n/g,"<br/>").replace(iE,(function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"}))}var oE=function(){var e=/&#(\d+);/g;function t(e,t){return String.fromCharCode(parseInt(t,10))}return function(n){return n.replace(e,t)}}();function cE(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function lE(e){for(var t="",n=0,r=0,a=0,i=0,s=0,o=0;n<e.length;)(r=e.charCodeAt(n++))<128?t+=String.fromCharCode(r):(a=e.charCodeAt(n++),r>191&&r<224?(s=(31&r)<<6,s|=63&a,t+=String.fromCharCode(s)):(i=e.charCodeAt(n++),r<240?t+=String.fromCharCode((15&r)<<12|(63&a)<<6|63&i):(o=((7&r)<<18|(63&a)<<12|(63&i)<<6|63&(s=e.charCodeAt(n++)))-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(1023&o)))));return t}function uE(e){var t,n,r,a=fb(2*e.length),i=1,s=0,o=0;for(n=0;n<e.length;n+=i)i=1,(r=e.charCodeAt(n))<128?t=r:r<224?(t=64*(31&r)+(63&e.charCodeAt(n+1)),i=2):r<240?(t=4096*(15&r)+64*(63&e.charCodeAt(n+1))+(63&e.charCodeAt(n+2)),i=3):(i=4,t=262144*(7&r)+4096*(63&e.charCodeAt(n+1))+64*(63&e.charCodeAt(n+2))+(63&e.charCodeAt(n+3)),o=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==o&&(a[s++]=255&o,a[s++]=o>>>8,o=0),a[s++]=t%256,a[s++]=t>>>8;return a.slice(0,s).toString("ucs2")}function dE(e){return hb(e,"binary").toString("utf8")}var hE="foo bar baz\xe2\x98\x83\xf0\x9f\x8d\xa3",fE=db&&(dE(hE)==lE(hE)&&dE||uE(hE)==lE(hE)&&uE)||lE,pE=db?function(e){return hb(e,"utf8").toString("binary")}:function(e){for(var t=[],n=0,r=0,a=0;n<e.length;)switch(r=e.charCodeAt(n++),!0){case r<128:t.push(String.fromCharCode(r));break;case r<2048:t.push(String.fromCharCode(192+(r>>6))),t.push(String.fromCharCode(128+(63&r)));break;case r>=55296&&r<57344:r-=55296,a=e.charCodeAt(n++)-56320+(r<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(63&a)));break;default:t.push(String.fromCharCode(224+(r>>12))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(63&r)))}return t.join("")},gE=function(){var e={};return function(t,n){var r=t+"|"+(n||"");return e[r]?e[r]:e[r]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",n||"")}}(),mE=function(){var e=[["nbsp"," "],["middot","\xb7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map((function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]}));return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),r=0;r<e.length;++r)n=n.replace(e[r][0],e[r][1]);return n}}(),vE=function(){var e={};return function(t){return void 0!==e[t]?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),yE=/<\/?(?:vt:)?variant>/g,bE=/<(?:vt:)([^>]*)>([\s\S]*)</;function wE(e,t){var n=Zw(e),r=e.match(vE(n.baseType))||[],a=[];if(r.length!=n.size){if(t.WTF)throw new Error("unexpected vector length "+r.length+" != "+n.size);return a}return r.forEach((function(e){var t=e.replace(yE,"").match(bE);t&&a.push({v:fE(t[2]),t:t[1]})})),a}var EE=/(^\s|\s$|\n)/;function TE(e){return mw(e).map((function(t){return" "+t+'="'+e[t]+'"'})).join("")}function xE(e,t,n){return"<"+e+(null!=n?TE(n):"")+(null!=t?(t.match(EE)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function SE(e){if(db&&Buffer.isBuffer(e))return e.toString("utf8");if("string"===typeof e)return e;if("undefined"!==typeof Uint8Array&&e instanceof Uint8Array)return fE(mb(vb(e)));throw new Error("Bad input format: expected Buffer or string")}var IE=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm,kE="http://schemas.openxmlformats.org/package/2006/content-types",_E=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];var CE=function(e){for(var t=[],n=0;n<e[0].length;++n)if(e[0][n])for(var r=0,a=e[0][n].length;r<a;r+=10240)t.push.apply(t,e[0][n].slice(r,r+10240));return t},AE=db?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map((function(e){return Buffer.isBuffer(e)?e:hb(e)}))):CE(e)}:CE,NE=function(e,t,n){for(var r=[],a=t;a<n;a+=2)r.push(String.fromCharCode(QE(e,a)));return r.join("").replace(bb,"")},RE=db?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf16le",t,n).replace(bb,""):NE(e,t,n)}:NE,OE=function(e,t,n){for(var r=[],a=t;a<t+n;++a)r.push(("0"+e[a].toString(16)).slice(-2));return r.join("")},DE=db?function(e,t,n){return Buffer.isBuffer(e)?e.toString("hex",t,t+n):OE(e,t,n)}:OE,PE=function(e,t,n){for(var r=[],a=t;a<n;a++)r.push(String.fromCharCode(XE(e,a)));return r.join("")},LE=db?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf8",t,n):PE(e,t,n)}:PE,ME=function(e,t){var n=ZE(e,t);return n>0?LE(e,t+4,t+4+n-1):""},FE=ME,zE=function(e,t){var n=ZE(e,t);return n>0?LE(e,t+4,t+4+n-1):""},jE=zE,UE=function(e,t){var n=2*ZE(e,t);return n>0?LE(e,t+4,t+4+n-1):""},BE=UE,VE=function(e,t){var n=ZE(e,t);return n>0?RE(e,t+4,t+4+n):""},$E=VE,HE=function(e,t){var n=ZE(e,t);return n>0?LE(e,t+4,t+4+n):""},WE=HE,GE=function(e,t){return function(e,t){for(var n=1-2*(e[t+7]>>>7),r=((127&e[t+7])<<4)+(e[t+6]>>>4&15),a=15&e[t+6],i=5;i>=0;--i)a=256*a+e[t+i];return 2047==r?0==a?n*(1/0):NaN:(0==r?r=-1022:(r-=1023,a+=Math.pow(2,52)),n*Math.pow(2,r-52)*a)}(e,t)},KE=GE,qE=function(e){return Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array};function YE(){RE=function(e,t,n){return ab.utils.decode(1200,e.slice(t,n)).replace(bb,"")},LE=function(e,t,n){return ab.utils.decode(65001,e.slice(t,n))},FE=function(e,t){var n=ZE(e,t);return n>0?ab.utils.decode(Xy,e.slice(t+4,t+4+n-1)):""},jE=function(e,t){var n=ZE(e,t);return n>0?ab.utils.decode(Yy,e.slice(t+4,t+4+n-1)):""},BE=function(e,t){var n=2*ZE(e,t);return n>0?ab.utils.decode(1200,e.slice(t+4,t+4+n-1)):""},$E=function(e,t){var n=ZE(e,t);return n>0?ab.utils.decode(1200,e.slice(t+4,t+4+n)):""},WE=function(e,t){var n=ZE(e,t);return n>0?ab.utils.decode(65001,e.slice(t+4,t+4+n)):""}}db&&(FE=function(e,t){if(!Buffer.isBuffer(e))return ME(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},jE=function(e,t){if(!Buffer.isBuffer(e))return zE(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},BE=function(e,t){if(!Buffer.isBuffer(e))return UE(e,t);var n=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n-1)},$E=function(e,t){if(!Buffer.isBuffer(e))return VE(e,t);var n=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n)},WE=function(e,t){if(!Buffer.isBuffer(e))return HE(e,t);var n=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+n)},KE=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):GE(e,t)},qE=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array}),"undefined"!==typeof ab&&YE();var XE=function(e,t){return e[t]},QE=function(e,t){return 256*e[t+1]+e[t]},JE=function(e,t){var n=256*e[t+1]+e[t];return n<32768?n:-1*(65535-n+1)},ZE=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},eT=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},tT=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function nT(e,t){var n,r,a,i,s,o,c="",l=[];switch(t){case"dbcs":if(o=this.l,db&&Buffer.isBuffer(this))c=this.slice(this.l,this.l+2*e).toString("utf16le");else for(s=0;s<e;++s)c+=String.fromCharCode(QE(this,o)),o+=2;e*=2;break;case"utf8":c=LE(this,this.l,this.l+e);break;case"utf16le":e*=2,c=RE(this,this.l,this.l+e);break;case"wstr":if("undefined"===typeof ab)return nT.call(this,e,"dbcs");c=ab.utils.decode(Yy,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":c=FE(this,this.l),e=4+ZE(this,this.l);break;case"lpstr-cp":c=jE(this,this.l),e=4+ZE(this,this.l);break;case"lpwstr":c=BE(this,this.l),e=4+2*ZE(this,this.l);break;case"lpp4":e=4+ZE(this,this.l),c=$E(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+ZE(this,this.l),c=WE(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,c="";0!==(a=XE(this,this.l+e++));)l.push(sb(a));c=l.join("");break;case"_wstr":for(e=0,c="";0!==(a=QE(this,this.l+e));)l.push(sb(a)),e+=2;e+=2,c=l.join("");break;case"dbcs-cont":for(c="",o=this.l,s=0;s<e;++s){if(this.lens&&-1!==this.lens.indexOf(o))return a=XE(this,o),this.l=o+1,i=nT.call(this,e-s,a?"dbcs-cont":"sbcs-cont"),l.join("")+i;l.push(sb(QE(this,o))),o+=2}c=l.join(""),e*=2;break;case"cpstr":if("undefined"!==typeof ab){c=ab.utils.decode(Yy,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(c="",o=this.l,s=0;s!=e;++s){if(this.lens&&-1!==this.lens.indexOf(o))return a=XE(this,o),this.l=o+1,i=nT.call(this,e-s,a?"dbcs-cont":"sbcs-cont"),l.join("")+i;l.push(sb(XE(this,o))),o+=1}c=l.join("");break;default:switch(e){case 1:return n=XE(this,this.l),this.l++,n;case 2:return n=("i"===t?JE:QE)(this,this.l),this.l+=2,n;case 4:case-4:return"i"===t||0===(128&this[this.l+3])?(n=(e>0?eT:tT)(this,this.l),this.l+=4,n):(r=ZE(this,this.l),this.l+=4,r);case 8:case-8:if("f"===t)return r=8==e?KE(this,this.l):KE([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,r;e=8;case 16:c=DE(this,this.l,e)}}return this.l+=e,c}var rT=function(e,t,n){e[n]=255&t,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24&255},aT=function(e,t,n){e[n]=255&t,e[n+1]=t>>8&255,e[n+2]=t>>16&255,e[n+3]=t>>24&255},iT=function(e,t,n){e[n]=255&t,e[n+1]=t>>>8&255};function sT(e,t,n){var r=0,a=0;if("dbcs"===n){for(a=0;a!=t.length;++a)iT(this,t.charCodeAt(a),this.l+2*a);r=2*t.length}else if("sbcs"===n){if("undefined"!==typeof ab&&874==Xy)for(a=0;a!=t.length;++a){var i=ab.utils.encode(Xy,t.charAt(a));this[this.l+a]=i[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=255&t.charCodeAt(a);r=t.length}else{if("hex"===n){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}if("utf16le"===n){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var o=t.charCodeAt(a);this[this.l++]=255&o,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}switch(e){case 1:r=1,this[this.l]=255&t;break;case 2:r=2,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t;break;case 3:r=3,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t,t>>>=8,this[this.l+2]=255&t;break;case 4:r=4,rT(this,t,this.l);break;case 8:if(r=8,"f"===n){!function(e,t,n){var r=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,s=r?-t:t;isFinite(s)?0==s?a=i=0:(a=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var o=0;o<=5;++o,i/=256)e[n+o]=255&i;e[n+6]=(15&a)<<4|15&i,e[n+7]=a>>4|r}(this,t,this.l);break}case 16:break;case-4:r=4,aT(this,t,this.l)}}return this.l+=r,this}function oT(e,t){var n=DE(this,this.l,e.length>>1);if(n!==e)throw new Error(t+"Expected "+e+" saw "+n);this.l+=e.length>>1}function cT(e,t){e.l=t,e.read_shift=nT,e.chk=oT,e.write_shift=sT}function lT(e,t){e.l+=t}function uT(e){var t=fb(e);return cT(t,0),t}function dT(e,t,n){if(e){var r,a,i;cT(e,e.l||0);for(var s=e.length,o=0,c=0;e.l<s;){128&(o=e.read_shift(1))&&(o=(127&o)+((127&e.read_shift(1))<<7));var l=b_[o]||b_[65535];for(i=127&(r=e.read_shift(1)),a=1;a<4&&128&r;++a)i+=(127&(r=e.read_shift(1)))<<7*a;c=e.l+i;var u=l.f&&l.f(e,i,n);if(e.l=c,t(u,l,o))return}}}function hT(){var e=[],t=db?256:2048,n=function(e){var t=uT(e);return cT(t,0),t},r=n(t),a=function(){r&&(r.length>r.l&&((r=r.slice(0,r.l)).l=r.length),r.length>0&&e.push(r),r=null)},i=function(e){return r&&e<r.length-r.l?r:(a(),r=n(Math.max(e+1,t)))};return{next:i,push:function(e){a(),null==(r=e).l&&(r.l=r.length),i(t)},end:function(){return a(),yb(e)},_bufs:e}}function fT(e,t,n){var r=Nw(e);if(t.s?(r.cRel&&(r.c+=t.s.c),r.rRel&&(r.r+=t.s.r)):(r.cRel&&(r.c+=t.c),r.rRel&&(r.r+=t.r)),!n||n.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function pT(e,t,n){var r=Nw(e);return r.s=fT(r.s,t.s,n),r.e=fT(r.e,t.s,n),r}function gT(e,t){if(e.cRel&&e.c<0)for(e=Nw(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Nw(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var n=TT(e);return e.cRel||null==e.cRel||(n=n.replace(/^([A-Z])/,"$$$1")),e.rRel||null==e.rRel||(n=function(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(n)),n}function mT(e,t){return 0!=e.s.r||e.s.rRel||e.e.r!=(t.biff>=12?1048575:t.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(t.biff>=12?16383:255)||e.e.cRel?gT(e.s,t.biff)+":"+gT(e.e,t.biff):(e.s.rRel?"":"$")+yT(e.s.r)+":"+(e.e.rRel?"":"$")+yT(e.e.r):(e.s.cRel?"":"$")+wT(e.s.c)+":"+(e.e.cRel?"":"$")+wT(e.e.c)}function vT(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function yT(e){return""+(e+1)}function bT(e){for(var t=e.replace(/^\$([A-Z])/,"$1"),n=0,r=0;r!==t.length;++r)n=26*n+t.charCodeAt(r)-64;return n-1}function wT(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function ET(e){for(var t=0,n=0,r=0;r<e.length;++r){var a=e.charCodeAt(r);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(n=26*n+(a-64))}return{c:n-1,r:t-1}}function TT(e){for(var t=e.c+1,n="";t;t=(t-1)/26|0)n=String.fromCharCode((t-1)%26+65)+n;return n+(e.r+1)}function xT(e){var t=e.indexOf(":");return-1==t?{s:ET(e),e:ET(e)}:{s:ET(e.slice(0,t)),e:ET(e.slice(t+1))}}function ST(e,t){return"undefined"===typeof t||"number"===typeof t?ST(e.s,e.e):("string"!==typeof e&&(e=TT(e)),"string"!==typeof t&&(t=TT(t)),e==t?e:e+":"+t)}function IT(e){var t={s:{c:0,r:0},e:{c:0,r:0}},n=0,r=0,a=0,i=e.length;for(n=0;r<i&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)n=26*n+a;for(t.s.c=--n,n=0;r<i&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)n=10*n+a;if(t.s.r=--n,r===i||10!=a)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++r,n=0;r!=i&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)n=26*n+a;for(t.e.c=--n,n=0;r!=i&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)n=10*n+a;return t.e.r=--n,t}function kT(e,t){var n="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=cw(e.z,n?bw(t):t)}catch(r){}try{return e.w=cw((e.XF||{}).numFmtId||(n?14:0),n?bw(t):t)}catch(r){return""+t}}function _T(e,t,n){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&n&&n.dateNF&&(e.z=n.dateNF),"e"==e.t?ex[e.v]||e.v:kT(e,void 0==t?e.v:t))}function CT(e,t){var n=t&&t.sheet?t.sheet:"Sheet1",r={};return r[n]=e,{SheetNames:[n],Sheets:r}}function AT(e,t,n){var r=n||{},a=e?Array.isArray(e):r.dense;var i=e||(a?[]:{}),s=0,o=0;if(i&&null!=r.origin){if("number"==typeof r.origin)s=r.origin;else{var c="string"==typeof r.origin?ET(r.origin):r.origin;s=c.r,o=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var l={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=IT(i["!ref"]);l.s.c=u.s.c,l.s.r=u.s.r,l.e.c=Math.max(l.e.c,u.e.c),l.e.r=Math.max(l.e.r,u.e.r),-1==s&&(l.e.r=s=u.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[d].length;++h)if("undefined"!==typeof t[d][h]){var f={v:t[d][h]},p=s+d,g=o+h;if(l.s.r>p&&(l.s.r=p),l.s.c>g&&(l.s.c=g),l.e.r<p&&(l.e.r=p),l.e.c<g&&(l.e.c=g),!t[d][h]||"object"!==typeof t[d][h]||Array.isArray(t[d][h])||t[d][h]instanceof Date)if(Array.isArray(f.v)&&(f.f=t[d][h][1],f.v=f.v[0]),null===f.v)if(f.f)f.t="n";else if(r.nullError)f.t="e",f.v=0;else{if(!r.sheetStubs)continue;f.t="z"}else"number"===typeof f.v?f.t="n":"boolean"===typeof f.v?f.t="b":f.v instanceof Date?(f.z=r.dateNF||Nb[14],r.cellDates?(f.t="d",f.w=cw(f.z,bw(f.v))):(f.t="n",f.v=bw(f.v),f.w=cw(f.z,f.v))):f.t="s";else f=t[d][h];if(a)i[p]||(i[p]=[]),i[p][g]&&i[p][g].z&&(f.z=i[p][g].z),i[p][g]=f;else{var m=TT({c:g,r:p});i[m]&&i[m].z&&(f.z=i[m].z),i[m]=f}}}return l.s.c<1e7&&(i["!ref"]=ST(l)),i}function NT(e,t){return AT(null,e,t)}function RT(e){var t=e.read_shift(4);return 0===t?"":e.read_shift(t,"dbcs")}function OT(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function DT(e,t){var n=e.l,r=e.read_shift(1),a=RT(e),i=[],s={t:a,h:a};if(0!==(1&r)){for(var o=e.read_shift(4),c=0;c!=o;++c)i.push(OT(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=n+t,s}var PT=DT;function LT(e){var t=e.read_shift(4),n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:n}}function MT(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var FT=RT;function zT(e){var t=e.read_shift(4);return 0===t||4294967295===t?"":e.read_shift(t,"dbcs")}var jT=RT,UT=zT;function BT(e){var t=e.slice(e.l,e.l+4),n=1&t[0],r=2&t[0];e.l+=4;var a=0===r?KE([0,0,0,0,252&t[0],t[1],t[2],t[3]],0):eT(t,0)>>2;return n?a/100:a}function VT(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var $T=VT;function HT(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function WT(e,t){var n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,1==t?"lpstr":"lpwstr")}var GT=80,KT=[GT,81],qT={1:{n:"CodePage",t:2},2:{n:"Category",t:GT},3:{n:"PresentationFormat",t:GT},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:GT},15:{n:"Company",t:GT},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:GT},27:{n:"ContentStatus",t:GT},28:{n:"Language",t:GT},29:{n:"Version",t:GT},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},YT={1:{n:"CodePage",t:2},2:{n:"Title",t:GT},3:{n:"Subject",t:GT},4:{n:"Author",t:GT},5:{n:"Keywords",t:GT},6:{n:"Comments",t:GT},7:{n:"Template",t:GT},8:{n:"LastAuthor",t:GT},9:{n:"RevNumber",t:GT},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:GT},19:{n:"DocSecurity",t:3},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},XT={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},QT=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function JT(e){return e.map((function(e){return[e>>16&255,e>>8&255,255&e]}))}var ZT=Nw(JT([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),ex={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},tx={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},nx={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};var rx={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function ax(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function ix(e,t){var n={"!id":{}};if(!e)return n;"/"!==t.charAt(0)&&(t="/"+t);var r={};return(e.match(Xw)||[]).forEach((function(e){var a=Zw(e);if("<Relationship"===a[0]){var i={};i.Type=a.Type,i.Target=a.Target,i.Id=a.Id,a.TargetMode&&(i.TargetMode=a.TargetMode);var s="External"===a.TargetMode?a.Target:Gw(a.Target,t);n[s]=i,r[a.Id]=i}})),n["!id"]=r,n}var sx=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],ox=function(){for(var e=new Array(sx.length),t=0;t<sx.length;++t){var n=sx[t],r="(?:"+n[0].slice(0,n[0].indexOf(":"))+":)"+n[0].slice(n[0].indexOf(":")+1);e[t]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return e}();function cx(e){var t={};e=fE(e);for(var n=0;n<sx.length;++n){var r=sx[n],a=e.match(ox[n]);null!=a&&a.length>0&&(t[r[1]]=rE(a[1])),"date"===r[2]&&t[r[1]]&&(t[r[1]]=Cw(t[r[1]]))}return t}var lx=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function ux(e,t,n,r){var a=[];if("string"==typeof e)a=wE(e,r);else for(var i=0;i<e.length;++i)a=a.concat(e[i].map((function(e){return{v:e}})));var s="string"==typeof t?wE(t,r).map((function(e){return e.v})):t,o=0,c=0;if(s.length>0)for(var l=0;l!==a.length;l+=2){switch(c=+a[l+1].v,a[l].v){case"Worksheets":case"\u5de5\u4f5c\u8868":case"\u041b\u0438\u0441\u0442\u044b":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30ef\u30fc\u30af\u30b7\u30fc\u30c8":case"\u05d2\u05dc\u05d9\u05d5\u05e0\u05d5\u05ea \u05e2\u05d1\u05d5\u05d3\u05d4":case"Arbeitsbl\xe4tter":case"\xc7al\u0131\u015fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xe1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xe1lculo":case"Werkbladen":n.Worksheets=c,n.SheetNames=s.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"\u540d\u524d\u4ed8\u304d\u4e00\u89a7":case"Benannte Bereiche":case"Navngivne omr\xe5der":n.NamedRanges=c,n.DefinedNames=s.slice(o,o+c);break;case"Charts":case"Diagramme":n.Chartsheets=c,n.ChartNames=s.slice(o,o+c)}o+=c}}var dx=/<[^>]+>[^<]*/g;var hx,fx={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function px(e,t,n){hx||(hx=vw(fx)),e[t=hx[t]||t]=n}function gx(e){var t=e.read_shift(4),n=e.read_shift(4);return new Date(1e3*(n/1e7*Math.pow(2,32)+t/1e7-11644473600)).toISOString().replace(/\.000/,"")}function mx(e,t,n){var r=e.l,a=e.read_shift(0,"lpstr-cp");if(n)for(;e.l-r&3;)++e.l;return a}function vx(e,t,n){var r=e.read_shift(0,"lpwstr");return n&&(e.l+=4-(r.length+1&3)&3),r}function yx(e,t,n){return 31===t?vx(e):mx(e,0,n)}function bx(e,t,n){return yx(e,t,!1===n?0:4)}function wx(e){var t=e.l,n=xx(e,81);return 0==e[e.l]&&0==e[e.l+1]&&e.l-t&2&&(e.l+=2),[n,xx(e,3)]}function Ex(e,t){for(var n=e.read_shift(4),r={},a=0;a!=n;++a){var i=e.read_shift(4),s=e.read_shift(4);r[i]=e.read_shift(s,1200===t?"utf16le":"utf8").replace(bb,"").replace(wb,"!"),1200===t&&s%2&&(e.l+=2)}return 3&e.l&&(e.l=e.l>>3<<2),r}function Tx(e){var t=e.read_shift(4),n=e.slice(e.l,e.l+t);return e.l+=t,(3&t)>0&&(e.l+=4-(3&t)&3),n}function xx(e,t,n){var r,a=e.read_shift(2),i=n||{};if(e.l+=2,12!==t&&a!==t&&-1===KT.indexOf(t)&&(4126!=(65534&t)||4126!=(65534&a)))throw new Error("Expected type "+t+" saw "+a);switch(12===t?a:t){case 2:return r=e.read_shift(2,"i"),i.raw||(e.l+=2),r;case 3:return r=e.read_shift(4,"i");case 11:return 0!==e.read_shift(4);case 19:return r=e.read_shift(4);case 30:return mx(e,0,4).replace(bb,"");case 31:return vx(e);case 64:return gx(e);case 65:return Tx(e);case 71:return function(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}(e);case 80:return bx(e,a,!i.raw).replace(bb,"");case 81:return function(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return yx(e,t,0)}(e,a).replace(bb,"");case 4108:return function(e){for(var t=e.read_shift(4),n=[],r=0;r<t/2;++r)n.push(wx(e));return n}(e);case 4126:case 4127:return 4127==a?function(e){for(var t=e.read_shift(4),n=[],r=0;r!=t;++r){var a=e.l;n[r]=e.read_shift(0,"lpwstr").replace(bb,""),e.l-a&2&&(e.l+=2)}return n}(e):function(e){for(var t=e.read_shift(4),n=[],r=0;r!=t;++r)n[r]=e.read_shift(0,"lpstr-cp").replace(bb,"");return n}(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function Sx(e,t){var n=e.l,r=e.read_shift(4),a=e.read_shift(4),i=[],s=0,o=0,c=-1,l={};for(s=0;s!=a;++s){var u=e.read_shift(4),d=e.read_shift(4);i[s]=[u,d+n]}i.sort((function(e,t){return e[1]-t[1]}));var h={};for(s=0;s!=a;++s){if(e.l!==i[s][1]){var f=!0;if(s>0&&t)switch(t[i[s-1][0]].t){case 2:e.l+2===i[s][1]&&(e.l+=2,f=!1);break;case 80:case 4108:e.l<=i[s][1]&&(e.l=i[s][1],f=!1)}if((!t||0==s)&&e.l<=i[s][1]&&(f=!1,e.l=i[s][1]),f)throw new Error("Read Error: Expected address "+i[s][1]+" at "+e.l+" :"+s)}if(t){var p=t[i[s][0]];if(h[p.n]=xx(e,p.t,{raw:!0}),"version"===p.p&&(h[p.n]=String(h[p.n]>>16)+"."+("0000"+String(65535&h[p.n])).slice(-4)),"CodePage"==p.n)switch(h[p.n]){case 0:h[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:eb(o=h[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[p.n])}}else if(1===i[s][0]){if(o=h.CodePage=xx(e,2),eb(o),-1!==c){var g=e.l;e.l=i[c][1],l=Ex(e,o),e.l=g}}else if(0===i[s][0]){if(0===o){c=s,e.l=i[s+1][1];continue}l=Ex(e,o)}else{var m,v=l[i[s][0]];switch(e[e.l]){case 65:e.l+=4,m=Tx(e);break;case 30:case 31:e.l+=4,m=bx(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,m=e.read_shift(4,"i");break;case 19:e.l+=4,m=e.read_shift(4);break;case 5:e.l+=4,m=e.read_shift(8,"f");break;case 11:e.l+=4,m=_x(e,4);break;case 64:e.l+=4,m=Cw(gx(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[v]=m}}return e.l=n+r,h}function Ix(e,t,n){var r=e.content;if(!r)return{};cT(r,0);var a,i,s,o,c=0;r.chk("feff","Byte Order: "),r.read_shift(2);var l=r.read_shift(4),u=r.read_shift(16);if(u!==pw.utils.consts.HEADER_CLSID&&u!==n)throw new Error("Bad PropertySet CLSID "+u);if(1!==(a=r.read_shift(4))&&2!==a)throw new Error("Unrecognized #Sets: "+a);if(i=r.read_shift(16),o=r.read_shift(4),1===a&&o!==r.l)throw new Error("Length mismatch: "+o+" !== "+r.l);2===a&&(s=r.read_shift(16),c=r.read_shift(4));var d,h=Sx(r,t),f={SystemIdentifier:l};for(var p in h)f[p]=h[p];if(f.FMTID=i,1===a)return f;if(c-r.l==2&&(r.l+=2),r.l!==c)throw new Error("Length mismatch 2: "+r.l+" !== "+c);try{d=Sx(r,null)}catch(g){}for(p in d)f[p]=d[p];return f.FMTID=[i,s],f}function kx(e,t){return e.read_shift(t),null}function _x(e,t){return 1===e.read_shift(t)}function Cx(e){return e.read_shift(2,"u")}function Ax(e,t){return function(e,t,n){for(var r=[],a=e.l+t;e.l<a;)r.push(n(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return r}(e,t,Cx)}function Nx(e,t,n){var r=e.read_shift(n&&n.biff>=12?2:1),a="sbcs-cont",i=Yy;(n&&n.biff>=8&&(Yy=1200),n&&8!=n.biff)?12==n.biff&&(a="wstr"):e.read_shift(1)&&(a="dbcs-cont");n.biff>=2&&n.biff<=5&&(a="cpstr");var s=r?e.read_shift(r,a):"";return Yy=i,s}function Rx(e){var t=Yy;Yy=1200;var n,r=e.read_shift(2),a=e.read_shift(1),i=4&a,s=8&a,o=1+(1&a),c=0,l={};s&&(c=e.read_shift(2)),i&&(n=e.read_shift(4));var u=2==o?"dbcs-cont":"sbcs-cont",d=0===r?"":e.read_shift(r,u);return s&&(e.l+=4*c),i&&(e.l+=n),l.t=d,s||(l.raw="<t>"+l.t+"</t>",l.r=l.t),Yy=t,l}function Ox(e,t,n){if(n){if(n.biff>=2&&n.biff<=5)return e.read_shift(t,"cpstr");if(n.biff>=12)return e.read_shift(t,"dbcs-cont")}return 0===e.read_shift(1)?e.read_shift(t,"sbcs-cont"):e.read_shift(t,"dbcs-cont")}function Dx(e,t,n){var r=e.read_shift(n&&2==n.biff?1:2);return 0===r?(e.l++,""):Ox(e,r,n)}function Px(e,t,n){if(n.biff>5)return Dx(e,0,n);var r=e.read_shift(1);return 0===r?(e.l++,""):e.read_shift(r,n.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Lx(e,t){var n=e.read_shift(16);switch(n){case"e0c9ea79f9bace118c8200aa004ba90b":return function(e){var t=e.read_shift(4),n=e.l,r=!1;t>24&&(e.l+=t-24,"795881f43b1d7f48af2c825dc4852763"===e.read_shift(16)&&(r=!0),e.l=n);var a=e.read_shift((r?t-24:t)>>1,"utf16le").replace(bb,"");return r&&(e.l+=24),a}(e);case"0303000000000000c000000000000046":return function(e){for(var t=e.read_shift(2),n="";t-- >0;)n+="../";var r=e.read_shift(0,"lpstr-ansi");if(e.l+=2,57005!=e.read_shift(2))throw new Error("Bad FileMoniker");if(0===e.read_shift(4))return n+r.replace(/\\/g,"/");var a=e.read_shift(4);if(3!=e.read_shift(2))throw new Error("Bad FileMoniker");return n+e.read_shift(a>>1,"utf16le").replace(bb,"")}(e);default:throw new Error("Unsupported Moniker "+n)}}function Mx(e){var t=e.read_shift(4);return t>0?e.read_shift(t,"utf16le").replace(bb,""):""}function Fx(e){return[e.read_shift(1),e.read_shift(1),e.read_shift(1),e.read_shift(1)]}function zx(e,t){var n=Fx(e);return n[3]=0,n}function jx(e){return{r:e.read_shift(2),c:e.read_shift(2),ixfe:e.read_shift(2)}}function Ux(e,t,n){var r=n.biff>8?4:2;return[e.read_shift(r),e.read_shift(r,"i"),e.read_shift(r,"i")]}function Bx(e){return[e.read_shift(2),BT(e)]}function Vx(e){var t=e.read_shift(2),n=e.read_shift(2);return{s:{c:e.read_shift(2),r:t},e:{c:e.read_shift(2),r:n}}}function $x(e){var t=e.read_shift(2),n=e.read_shift(2);return{s:{c:e.read_shift(1),r:t},e:{c:e.read_shift(1),r:n}}}var Hx=$x;function Wx(e){e.l+=4;var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2);return e.l+=12,[n,t,r]}function Gx(e){e.l+=2,e.l+=e.read_shift(2)}var Kx={0:Gx,4:Gx,5:Gx,6:Gx,7:function(e){return e.l+=4,e.cf=e.read_shift(2),{}},8:Gx,9:Gx,10:Gx,11:Gx,12:Gx,13:function(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t},14:Gx,15:Gx,16:Gx,17:Gx,18:Gx,19:Gx,20:Gx,21:Wx};function qx(e,t){var n={BIFFVer:0,dt:0};switch(n.BIFFVer=e.read_shift(2),(t-=2)>=2&&(n.dt=e.read_shift(2),e.l-=2),n.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+n.BIFFVer)}return e.read_shift(t),n}function Yx(e,t,n){var r=0;n&&2==n.biff||(r=e.read_shift(2));var a=e.read_shift(2);return n&&2==n.biff&&(r=1-(a>>15),a&=32767),[{Unsynced:1&r,DyZero:(2&r)>>1,ExAsc:(4&r)>>2,ExDsc:(8&r)>>3},a]}var Xx=Px;function Qx(e,t,n){var r=e.l+t,a=8!=n.biff&&n.biff?2:4,i=e.read_shift(a),s=e.read_shift(a),o=e.read_shift(2),c=e.read_shift(2);return e.l=r,{s:{r:i,c:o},e:{r:s,c:c}}}function Jx(e,t,n){var r=jx(e);2!=n.biff&&9!=t||++e.l;var a=function(e){var t=e.read_shift(1);return 1===e.read_shift(1)?t:1===t}(e);return r.val=a,r.t=!0===a||!1===a?"b":"e",r}var Zx=function(e,t,n){return 0===t?"":Px(e,0,n)};function eS(e,t,n){var r,a=e.read_shift(2),i={fBuiltIn:1&a,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return 14849===n.sbcch&&(r=function(e,t,n){e.l+=4,t-=4;var r=e.l+t,a=Nx(e,0,n),i=e.read_shift(2);if(i!==(r-=e.l))throw new Error("Malformed AddinUdf: padding = "+r+" != "+i);return e.l+=i,a}(e,t-2,n)),i.body=r||e.read_shift(t-2),"string"===typeof r&&(i.Name=r),i}var tS=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function nS(e,t,n){var r=e.l+t,a=e.read_shift(2),i=e.read_shift(1),s=e.read_shift(1),o=e.read_shift(n&&2==n.biff?1:2),c=0;(!n||n.biff>=5)&&(5!=n.biff&&(e.l+=2),c=e.read_shift(2),5==n.biff&&(e.l+=2),e.l+=4);var l=Ox(e,s,n);32&a&&(l=tS[l.charCodeAt(0)]);var u=r-e.l;n&&2==n.biff&&--u;var d=r!=e.l&&0!==o&&u>0?function(e,t,n,r){var a,i=e.l+t,s=HI(e,r,n);i!==e.l&&(a=$I(e,i-e.l,s,n));return[s,a]}(e,u,n,o):[];return{chKey:i,Name:l,itab:c,rgce:d}}function rS(e,t,n){if(n.biff<8)return function(e,t,n){3==e[e.l+1]&&e[e.l]++;var r=Nx(e,0,n);return 3==r.charCodeAt(0)?r.slice(1):r}(e,0,n);for(var r=[],a=e.l+t,i=e.read_shift(n.biff>8?4:2);0!==i--;)r.push(Ux(e,n.biff,n));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return r}function aS(e,t,n){var r=Hx(e,6);switch(n.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[r,XI(e,t,n)]}var iS={8:function(e,t){var n=e.l+t;e.l+=10;var r=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=n,{fmt:r}}};function sS(e,t,n){if(!n.cellStyles)return lT(e,t);var r=n&&n.biff>=12?4:2,a=e.read_shift(r),i=e.read_shift(r),s=e.read_shift(r),o=e.read_shift(r),c=e.read_shift(2);2==r&&(e.l+=2);var l={s:a,e:i,w:s,ixfe:o,flags:c};return(n.biff>=5||!n.biff)&&(l.level=c>>8&7),l}var oS=jx,cS=Ax,lS=Dx;var uS=[2,3,48,49,131,139,140,245],dS=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=vw({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(t,n){var r=n||{};r.dateNF||(r.dateNF="yyyymmdd");var a=NT(function(t,n){var r=[],a=fb(1);switch(n.type){case"base64":a=gb(ub(t));break;case"binary":a=gb(t);break;case"buffer":case"array":a=t}cT(a,0);var i=a.read_shift(1),s=!!(136&i),o=!1,c=!1;switch(i){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:o=!0,s=!0;break;case 140:c=!0;break;default:throw new Error("DBF Unsupported Version: "+i.toString(16))}var l=0,u=521;2==i&&(l=a.read_shift(2)),a.l+=3,2!=i&&(l=a.read_shift(4)),l>1048576&&(l=1e6),2!=i&&(u=a.read_shift(2));var d=a.read_shift(2),h=n.codepage||1252;2!=i&&(a.l+=16,a.read_shift(1),0!==a[a.l]&&(h=e[a[a.l]]),a.l+=1,a.l+=2),c&&(a.l+=36);for(var f=[],p={},g=Math.min(a.length,2==i?521:u-10-(o?264:0)),m=c?32:11;a.l<g&&13!=a[a.l];)switch((p={}).name=ab.utils.decode(h,a.slice(a.l,a.l+m)).replace(/[\u0000\r\n].*$/g,""),a.l+=m,p.type=String.fromCharCode(a.read_shift(1)),2==i||c||(p.offset=a.read_shift(4)),p.len=a.read_shift(1),2==i&&(p.offset=a.read_shift(2)),p.dec=a.read_shift(1),p.name.length&&f.push(p),2!=i&&(a.l+=c?13:14),p.type){case"B":o&&8==p.len||!n.WTF||console.log("Skipping "+p.name+":"+p.type);break;case"G":case"P":n.WTF&&console.log("Skipping "+p.name+":"+p.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+p.type)}if(13!==a[a.l]&&(a.l=u-1),13!==a.read_shift(1))throw new Error("DBF Terminator not found "+a.l+" "+a[a.l]);a.l=u;var v=0,y=0;for(r[0]=[],y=0;y!=f.length;++y)r[0][y]=f[y].name;for(;l-- >0;)if(42!==a[a.l])for(++a.l,r[++v]=[],y=0,y=0;y!=f.length;++y){var b=a.slice(a.l,a.l+f[y].len);a.l+=f[y].len,cT(b,0);var w=ab.utils.decode(h,b);switch(f[y].type){case"C":w.trim().length&&(r[v][y]=w.replace(/\s+$/,""));break;case"D":8===w.length?r[v][y]=new Date(+w.slice(0,4),+w.slice(4,6)-1,+w.slice(6,8)):r[v][y]=w;break;case"F":r[v][y]=parseFloat(w.trim());break;case"+":case"I":r[v][y]=c?2147483648^b.read_shift(-4,"i"):b.read_shift(4,"i");break;case"L":switch(w.trim().toUpperCase()){case"Y":case"T":r[v][y]=!0;break;case"N":case"F":r[v][y]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+w+"|")}break;case"M":if(!s)throw new Error("DBF Unexpected MEMO for type "+i.toString(16));r[v][y]="##MEMO##"+(c?parseInt(w.trim(),10):b.read_shift(4));break;case"N":(w=w.replace(/\u0000/g,"").trim())&&"."!=w&&(r[v][y]=+w||0);break;case"@":r[v][y]=new Date(b.read_shift(-8,"f")-621356832e5);break;case"T":r[v][y]=new Date(864e5*(b.read_shift(4)-2440588)+b.read_shift(4));break;case"Y":r[v][y]=b.read_shift(4,"i")/1e4+b.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":r[v][y]=-b.read_shift(-8,"f");break;case"B":if(o&&8==f[y].len){r[v][y]=b.read_shift(8,"f");break}case"G":case"P":b.l+=f[y].len;break;case"0":if("_NullFlags"===f[y].name)break;default:throw new Error("DBF Unsupported data type "+f[y].type)}}else a.l+=d;if(2!=i&&a.l<a.length&&26!=a[a.l++])throw new Error("DBF EOF Marker missing "+(a.l-1)+" of "+a.length+" "+a[a.l-1].toString(16));return n&&n.sheetRows&&(r=r.slice(0,n.sheetRows)),n.DBF=f,r}(t,r),r);return a["!cols"]=r.DBF.map((function(e){return{wch:e.len,DBF:e}})),delete r.DBF,a}var r={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function(e,t){try{return CT(n(e,t),t)}catch(r){if(t&&t.WTF)throw r}return{SheetNames:[],Sheets:{}}},to_sheet:n,from_sheet:function(e,n){var a=n||{};if(+a.codepage>=0&&eb(+a.codepage),"string"==a.type)throw new Error("Cannot write DBF to JS string");var i=hT(),s=hC(e,{header:1,raw:!0,cellDates:!0}),o=s[0],c=s.slice(1),l=e["!cols"]||[],u=0,d=0,h=0,f=1;for(u=0;u<o.length;++u)if(((l[u]||{}).DBF||{}).name)o[u]=l[u].DBF.name,++h;else if(null!=o[u]){if(++h,"number"===typeof o[u]&&(o[u]=o[u].toString(10)),"string"!==typeof o[u])throw new Error("DBF Invalid column name "+o[u]+" |"+typeof o[u]+"|");if(o.indexOf(o[u])!==u)for(d=0;d<1024;++d)if(-1==o.indexOf(o[u]+"_"+d)){o[u]+="_"+d;break}}var p=IT(e["!ref"]),g=[],m=[],v=[];for(u=0;u<=p.e.c-p.s.c;++u){var y="",b="",w=0,E=[];for(d=0;d<c.length;++d)null!=c[d][u]&&E.push(c[d][u]);if(0!=E.length&&null!=o[u]){for(d=0;d<E.length;++d){switch(typeof E[d]){case"number":b="B";break;case"string":default:b="C";break;case"boolean":b="L";break;case"object":b=E[d]instanceof Date?"D":"C"}w=Math.max(w,String(E[d]).length),y=y&&y!=b?"C":b}w>250&&(w=250),"C"==(b=((l[u]||{}).DBF||{}).type)&&l[u].DBF.len>w&&(w=l[u].DBF.len),"B"==y&&"N"==b&&(y="N",v[u]=l[u].DBF.dec,w=l[u].DBF.len),m[u]="C"==y||"N"==b?w:r[y]||0,f+=m[u],g[u]=y}else g[u]="?"}var T=i.next(32);for(T.write_shift(4,318902576),T.write_shift(4,c.length),T.write_shift(2,296+32*h),T.write_shift(2,f),u=0;u<4;++u)T.write_shift(4,0);for(T.write_shift(4,(+t[Xy]||3)<<8),u=0,d=0;u<o.length;++u)if(null!=o[u]){var x=i.next(32),S=(o[u].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);x.write_shift(1,S,"sbcs"),x.write_shift(1,"?"==g[u]?"C":g[u],"sbcs"),x.write_shift(4,d),x.write_shift(1,m[u]||r[g[u]]||0),x.write_shift(1,v[u]||0),x.write_shift(1,2),x.write_shift(4,0),x.write_shift(1,0),x.write_shift(4,0),x.write_shift(4,0),d+=m[u]||r[g[u]]||0}var I=i.next(264);for(I.write_shift(4,13),u=0;u<65;++u)I.write_shift(4,0);for(u=0;u<c.length;++u){var k=i.next(f);for(k.write_shift(1,0),d=0;d<o.length;++d)if(null!=o[d])switch(g[d]){case"L":k.write_shift(1,null==c[u][d]?63:c[u][d]?84:70);break;case"B":k.write_shift(8,c[u][d]||0,"f");break;case"N":var _="0";for("number"==typeof c[u][d]&&(_=c[u][d].toFixed(v[d]||0)),h=0;h<m[d]-_.length;++h)k.write_shift(1,32);k.write_shift(1,_,"sbcs");break;case"D":c[u][d]?(k.write_shift(4,("0000"+c[u][d].getFullYear()).slice(-4),"sbcs"),k.write_shift(2,("00"+(c[u][d].getMonth()+1)).slice(-2),"sbcs"),k.write_shift(2,("00"+c[u][d].getDate()).slice(-2),"sbcs")):k.write_shift(8,"00000000","sbcs");break;case"C":var C=String(null!=c[u][d]?c[u][d]:"").slice(0,m[d]);for(k.write_shift(1,C,"sbcs"),h=0;h<m[d]-C.length;++h)k.write_shift(1,32)}}return i.next(1).write_shift(1,26),i.end()}}}(),hS=function(){var e={AA:"\xc0",BA:"\xc1",CA:"\xc2",DA:195,HA:"\xc4",JA:197,AE:"\xc8",BE:"\xc9",CE:"\xca",HE:"\xcb",AI:"\xcc",BI:"\xcd",CI:"\xce",HI:"\xcf",AO:"\xd2",BO:"\xd3",CO:"\xd4",DO:213,HO:"\xd6",AU:"\xd9",BU:"\xda",CU:"\xdb",HU:"\xdc",Aa:"\xe0",Ba:"\xe1",Ca:"\xe2",Da:227,Ha:"\xe4",Ja:229,Ae:"\xe8",Be:"\xe9",Ce:"\xea",He:"\xeb",Ai:"\xec",Bi:"\xed",Ci:"\xee",Hi:"\xef",Ao:"\xf2",Bo:"\xf3",Co:"\xf4",Do:245,Ho:"\xf6",Au:"\xf9",Bu:"\xfa",Cu:"\xfb",Hu:"\xfc",KC:"\xc7",Kc:"\xe7",q:"\xe6",z:"\u0153",a:"\xc6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1bN("+mw(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(t,n){var r=e[n];return"number"==typeof r?ob(r):r},r=function(e,t,n){var r=t.charCodeAt(0)-32<<4|n.charCodeAt(0)-48;return 59==r?e:ob(r)};function a(e,a){var i,s=e.split(/[\n\r]+/),o=-1,c=-1,l=0,u=0,d=[],h=[],f=null,p={},g=[],m=[],v=[],y=0;for(+a.codepage>=0&&eb(+a.codepage);l!==s.length;++l){y=0;var b,w=s[l].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(t,n),E=w.replace(/;;/g,"\0").split(";").map((function(e){return e.replace(/\u0000/g,";")})),T=E[0];if(w.length>0)switch(T){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==E[1].charAt(0)&&h.push(w.slice(3).replace(/;;/g,";"));break;case"C":var x=!1,S=!1,I=!1,k=!1,_=-1,C=-1;for(u=1;u<E.length;++u)switch(E[u].charAt(0)){case"A":case"G":break;case"X":c=parseInt(E[u].slice(1))-1,S=!0;break;case"Y":for(o=parseInt(E[u].slice(1))-1,S||(c=0),i=d.length;i<=o;++i)d[i]=[];break;case"K":'"'===(b=E[u].slice(1)).charAt(0)?b=b.slice(1,b.length-1):"TRUE"===b?b=!0:"FALSE"===b?b=!1:isNaN(Ow(b))?isNaN(Pw(b).getDate())||(b=Cw(b)):(b=Ow(b),null!==f&&aw(f)&&(b=xw(b))),"undefined"!==typeof ab&&"string"==typeof b&&"string"!=(a||{}).type&&(a||{}).codepage&&(b=ab.utils.decode(a.codepage,b)),x=!0;break;case"E":k=!0;var A=yI(E[u].slice(1),{r:o,c:c});d[o][c]=[d[o][c],A];break;case"S":I=!0,d[o][c]=[d[o][c],"S5S"];break;case"R":_=parseInt(E[u].slice(1))-1;break;case"C":C=parseInt(E[u].slice(1))-1;break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+w)}if(x&&(d[o][c]&&2==d[o][c].length?d[o][c][0]=b:d[o][c]=b,f=null),I){if(k)throw new Error("SYLK shared formula cannot have own formula");var N=_>-1&&d[_][C];if(!N||!N[1])throw new Error("SYLK shared formula cannot find base");d[o][c][1]=EI(N[1],{r:o-_,c:c-C})}break;case"F":var R=0;for(u=1;u<E.length;++u)switch(E[u].charAt(0)){case"X":c=parseInt(E[u].slice(1))-1,++R;break;case"Y":for(o=parseInt(E[u].slice(1))-1,i=d.length;i<=o;++i)d[i]=[];break;case"M":y=parseInt(E[u].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":f=h[parseInt(E[u].slice(1))];break;case"W":for(v=E[u].slice(1).split(" "),i=parseInt(v[0],10);i<=parseInt(v[1],10);++i)y=parseInt(v[2],10),m[i-1]=0===y?{hidden:!0}:{wch:y},qS(m[i-1]);break;case"C":m[c=parseInt(E[u].slice(1))-1]||(m[c]={});break;case"R":g[o=parseInt(E[u].slice(1))-1]||(g[o]={}),y>0?(g[o].hpt=y,g[o].hpx=QS(y)):0===y&&(g[o].hidden=!0);break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+w)}R<1&&(f=null);break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+w)}}return g.length>0&&(p["!rows"]=g),m.length>0&&(p["!cols"]=m),a&&a.sheetRows&&(d=d.slice(0,a.sheetRows)),[d,p]}function i(e,t){var n=function(e,t){switch(t.type){case"base64":return a(ub(e),t);case"binary":return a(e,t);case"buffer":return a(db&&Buffer.isBuffer(e)?e.toString("binary"):mb(e),t);case"array":return a(Aw(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),r=n[0],i=n[1],s=NT(r,t);return mw(i).forEach((function(e){s[e]=i[e]})),s}function s(e,t,n,r){var a="C;Y"+(n+1)+";X"+(r+1)+";K";switch(e.t){case"n":a+=e.v||0,e.f&&!e.F&&(a+=";E"+wI(e.f,{r:n,c:r}));break;case"b":a+=e.v?"TRUE":"FALSE";break;case"e":a+=e.w||e.v;break;case"d":a+='"'+(e.w||e.v)+'"';break;case"s":a+='"'+e.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return a}return e["|"]=254,{to_workbook:function(e,t){return CT(i(e,t),t)},to_sheet:i,from_sheet:function(e,t){var n,r,a=["ID;PWXL;N;E"],i=[],o=IT(e["!ref"]),c=Array.isArray(e),l="\r\n";a.push("P;PGeneral"),a.push("F;P0;DG0G8;M255"),e["!cols"]&&(r=a,e["!cols"].forEach((function(e,t){var n="F;W"+(t+1)+" "+(t+1)+" ";e.hidden?n+="0":("number"!=typeof e.width||e.wpx||(e.wpx=$S(e.width)),"number"!=typeof e.wpx||e.wch||(e.wch=HS(e.wpx)),"number"==typeof e.wch&&(n+=Math.round(e.wch)))," "!=n.charAt(n.length-1)&&r.push(n)}))),e["!rows"]&&function(e,t){t.forEach((function(t,n){var r="F;";t.hidden?r+="M0;":t.hpt?r+="M"+20*t.hpt+";":t.hpx&&(r+="M"+20*XS(t.hpx)+";"),r.length>2&&e.push(r+"R"+(n+1))}))}(a,e["!rows"]),a.push("B;Y"+(o.e.r-o.s.r+1)+";X"+(o.e.c-o.s.c+1)+";D"+[o.s.c,o.s.r,o.e.c,o.e.r].join(" "));for(var u=o.s.r;u<=o.e.r;++u)for(var d=o.s.c;d<=o.e.c;++d){var h=TT({r:u,c:d});(n=c?(e[u]||[])[d]:e[h])&&(null!=n.v||n.f&&!n.F)&&i.push(s(n,0,u,d))}return a.join(l)+l+i.join(l)+l+"E"+l}}}(),fS=function(){function e(e,t){for(var n=e.split("\n"),r=-1,a=-1,i=0,s=[];i!==n.length;++i)if("BOT"!==n[i].trim()){if(!(r<0)){for(var o=n[i].trim().split(","),c=o[0],l=o[1],u=n[++i]||"";1&(u.match(/["]/g)||[]).length&&i<n.length-1;)u+="\n"+n[++i];switch(u=u.trim(),+c){case-1:if("BOT"===u){s[++r]=[],a=0;continue}if("EOD"!==u)throw new Error("Unrecognized DIF special command "+u);break;case 0:"TRUE"===u?s[r][a]=!0:"FALSE"===u?s[r][a]=!1:isNaN(Ow(l))?isNaN(Pw(l).getDate())?s[r][a]=l:s[r][a]=Cw(l):s[r][a]=Ow(l),++a;break;case 1:(u=(u=u.slice(1,u.length-1)).replace(/""/g,'"'))&&u.match(/^=".*"$/)&&(u=u.slice(2,-1)),s[r][a++]=""!==u?u:null}if("EOD"===u)break}}else s[++r]=[],a=0;return t&&t.sheetRows&&(s=s.slice(0,t.sheetRows)),s}function t(t,n){return NT(function(t,n){switch(n.type){case"base64":return e(ub(t),n);case"binary":return e(t,n);case"buffer":return e(db&&Buffer.isBuffer(t)?t.toString("binary"):mb(t),n);case"array":return e(Aw(t),n)}throw new Error("Unrecognized type "+n.type)}(t,n),n)}var n=function(){var e=function(e,t,n,r,a){e.push(t),e.push(n+","+r),e.push('"'+a.replace(/"/g,'""')+'"')},t=function(e,t,n,r){e.push(t+","+n),e.push(1==t?'"'+r.replace(/"/g,'""')+'"':r)};return function(n){var r,a=[],i=IT(n["!ref"]),s=Array.isArray(n);e(a,"TABLE",0,1,"sheetjs"),e(a,"VECTORS",0,i.e.r-i.s.r+1,""),e(a,"TUPLES",0,i.e.c-i.s.c+1,""),e(a,"DATA",0,0,"");for(var o=i.s.r;o<=i.e.r;++o){t(a,-1,0,"BOT");for(var c=i.s.c;c<=i.e.c;++c){var l=TT({r:o,c:c});if(r=s?(n[o]||[])[c]:n[l])switch(r.t){case"n":var u=r.w;u||null==r.v||(u=r.v),null==u?r.f&&!r.F?t(a,1,0,"="+r.f):t(a,1,0,""):t(a,0,u,"V");break;case"b":t(a,0,r.v?1:0,r.v?"TRUE":"FALSE");break;case"s":t(a,1,0,isNaN(r.v)?r.v:'="'+r.v+'"');break;case"d":r.w||(r.w=cw(r.z||Nb[14],bw(Cw(r.v)))),t(a,0,r.w,"V");break;default:t(a,1,0,"")}else t(a,1,0,"")}}t(a,-1,0,"EOD");return a.join("\r\n")}}();return{to_workbook:function(e,n){return CT(t(e,n),n)},to_sheet:t,from_sheet:n}}(),pS=function(){function e(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(e,t){return NT(function(e,t){for(var n=e.split("\n"),r=-1,a=-1,i=0,s=[];i!==n.length;++i){var o=n[i].trim().split(":");if("cell"===o[0]){var c=ET(o[1]);if(s.length<=c.r)for(r=s.length;r<=c.r;++r)s[r]||(s[r]=[]);switch(r=c.r,a=c.c,o[2]){case"t":s[r][a]=o[3].replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n");break;case"v":s[r][a]=+o[3];break;case"vtf":var l=o[o.length-1];case"vtc":"nl"===o[3]?s[r][a]=!!+o[4]:s[r][a]=+o[4],"vtf"==o[2]&&(s[r][a]=[s[r][a],l])}}}return t&&t.sheetRows&&(s=s.slice(0,t.sheetRows)),s}(e,t),t)}var n=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),r=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",a=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),i="--SocialCalcSpreadsheetControlSave--";function s(t){if(!t||!t["!ref"])return"";for(var n,r=[],a=[],i="",s=xT(t["!ref"]),o=Array.isArray(t),c=s.s.r;c<=s.e.r;++c)for(var l=s.s.c;l<=s.e.c;++l)if(i=TT({r:c,c:l}),(n=o?(t[c]||[])[l]:t[i])&&null!=n.v&&"z"!==n.t){switch(a=["cell",i,"t"],n.t){case"s":case"str":a.push(e(n.v));break;case"n":n.f?(a[2]="vtf",a[3]="n",a[4]=n.v,a[5]=e(n.f)):(a[2]="v",a[3]=n.v);break;case"b":a[2]="vt"+(n.f?"f":"c"),a[3]="nl",a[4]=n.v?"1":"0",a[5]=e(n.f||(n.v?"TRUE":"FALSE"));break;case"d":var u=bw(Cw(n.v));a[2]="vtc",a[3]="nd",a[4]=""+u,a[5]=n.w||cw(n.z||Nb[14],u);break;case"e":continue}r.push(a.join(":"))}return r.push("sheet:c:"+(s.e.c-s.s.c+1)+":r:"+(s.e.r-s.s.r+1)+":tvf:1"),r.push("valueformat:1:text-wiki"),r.join("\n")}return{to_workbook:function(e,n){return CT(t(e,n),n)},to_sheet:t,from_sheet:function(e){return[n,r,a,r,s(e),i].join("\n")}}}(),gS=function(){function e(e,t,n,r,a){a.raw?t[n][r]=e:""===e||("TRUE"===e?t[n][r]=!0:"FALSE"===e?t[n][r]=!1:isNaN(Ow(e))?isNaN(Pw(e).getDate())?t[n][r]=e:t[n][r]=Cw(e):t[n][r]=Ow(e))}var t={44:",",9:"\t",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function r(e){for(var r={},a=!1,i=0,s=0;i<e.length;++i)34==(s=e.charCodeAt(i))?a=!a:!a&&s in t&&(r[s]=(r[s]||0)+1);for(i in s=[],r)Object.prototype.hasOwnProperty.call(r,i)&&s.push([r[i],i]);if(!s.length)for(i in r=n)Object.prototype.hasOwnProperty.call(r,i)&&s.push([r[i],i]);return s.sort((function(e,t){return e[0]-t[0]||n[e[1]]-n[t[1]]})),t[s.pop()[1]]||44}function a(e,t){var n=t||{},a="";var i=n.dense?[]:{},s={s:{c:0,r:0},e:{c:0,r:0}};"sep="==e.slice(0,4)?13==e.charCodeAt(5)&&10==e.charCodeAt(6)?(a=e.charAt(4),e=e.slice(7)):13==e.charCodeAt(5)||10==e.charCodeAt(5)?(a=e.charAt(4),e=e.slice(6)):a=r(e.slice(0,1024)):a=n&&n.FS?n.FS:r(e.slice(0,1024));var o=0,c=0,l=0,u=0,d=0,h=a.charCodeAt(0),f=!1,p=0,g=e.charCodeAt(0);e=e.replace(/\r\n/gm,"\n");var m=null!=n.dateNF?function(e){var t="number"==typeof e?Nb[e]:e;return t=t.replace(hw,"(\\d+)"),new RegExp("^"+t+"$")}(n.dateNF):null;function v(){var t=e.slice(u,d),r={};if('"'==t.charAt(0)&&'"'==t.charAt(t.length-1)&&(t=t.slice(1,-1).replace(/""/g,'"')),0===t.length)r.t="z";else if(n.raw)r.t="s",r.v=t;else if(0===t.trim().length)r.t="s",r.v=t;else if(61==t.charCodeAt(0))34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(r.t="s",r.v=t.slice(2,-1).replace(/""/g,'"')):1!=t.length?(r.t="n",r.f=t.slice(1)):(r.t="s",r.v=t);else if("TRUE"==t)r.t="b",r.v=!0;else if("FALSE"==t)r.t="b",r.v=!1;else if(isNaN(l=Ow(t)))if(!isNaN(Pw(t).getDate())||m&&t.match(m)){r.z=n.dateNF||Nb[14];var a=0;m&&t.match(m)&&(t=function(e,t,n){var r=-1,a=-1,i=-1,s=-1,o=-1,c=-1;(t.match(hw)||[]).forEach((function(e,t){var l=parseInt(n[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":r=l;break;case"d":i=l;break;case"h":s=l;break;case"s":c=l;break;case"m":s>=0?o=l:a=l}})),c>=0&&-1==o&&a>=0&&(o=a,a=-1);var l=(""+(r>=0?r:(new Date).getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);7==l.length&&(l="0"+l),8==l.length&&(l="20"+l);var u=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return-1==s&&-1==o&&-1==c?l:-1==r&&-1==a&&-1==i?u:l+"T"+u}(0,n.dateNF,t.match(m)||[]),a=1),n.cellDates?(r.t="d",r.v=Cw(t,a)):(r.t="n",r.v=bw(Cw(t,a))),!1!==n.cellText&&(r.w=cw(r.z,r.v instanceof Date?bw(r.v):r.v)),n.cellNF||delete r.z}else r.t="s",r.v=t;else r.t="n",!1!==n.cellText&&(r.w=t),r.v=l;if("z"==r.t||(n.dense?(i[o]||(i[o]=[]),i[o][c]=r):i[TT({c:c,r:o})]=r),u=d+1,g=e.charCodeAt(u),s.e.c<c&&(s.e.c=c),s.e.r<o&&(s.e.r=o),p==h)++c;else if(c=0,++o,n.sheetRows&&n.sheetRows<=o)return!0}e:for(;d<e.length;++d)switch(p=e.charCodeAt(d)){case 34:34===g&&(f=!f);break;case h:case 10:case 13:if(!f&&v())break e}return d-u>0&&v(),i["!ref"]=ST(s),i}function i(t,n){return n&&n.PRN?n.FS||"sep="==t.slice(0,4)||t.indexOf("\t")>=0||t.indexOf(",")>=0||t.indexOf(";")>=0?a(t,n):NT(function(t,n){var r=n||{},a=[];if(!t||0===t.length)return a;for(var i=t.split(/[\r\n]/),s=i.length-1;s>=0&&0===i[s].length;)--s;for(var o=10,c=0,l=0;l<=s;++l)-1==(c=i[l].indexOf(" "))?c=i[l].length:c++,o=Math.max(o,c);for(l=0;l<=s;++l){a[l]=[];var u=0;for(e(i[l].slice(0,o).trim(),a,l,u,r),u=1;u<=(i[l].length-o)/10+1;++u)e(i[l].slice(o+10*(u-1),o+10*u).trim(),a,l,u,r)}return r.sheetRows&&(a=a.slice(0,r.sheetRows)),a}(t,n),n):a(t,n)}function s(e,t){var n="",r="string"==t.type?[0,0,0,0]:oC(e,t);switch(t.type){case"base64":n=ub(e);break;case"binary":case"string":n=e;break;case"buffer":n=65001==t.codepage?e.toString("utf8"):t.codepage&&"undefined"!==typeof ab?ab.utils.decode(t.codepage,e):db&&Buffer.isBuffer(e)?e.toString("binary"):mb(e);break;case"array":n=Aw(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==r[0]&&187==r[1]&&191==r[2]?n=fE(n.slice(3)):"string"!=t.type&&"buffer"!=t.type&&65001==t.codepage?n=fE(n):"binary"==t.type&&"undefined"!==typeof ab&&t.codepage&&(n=ab.utils.decode(t.codepage,ab.utils.encode(28591,n))),"socialcalc:version:"==n.slice(0,19)?pS.to_sheet("string"==t.type?n:fE(n),t):i(n,t)}return{to_workbook:function(e,t){return CT(s(e,t),t)},to_sheet:s,from_sheet:function(e){for(var t,n=[],r=IT(e["!ref"]),a=Array.isArray(e),i=r.s.r;i<=r.e.r;++i){for(var s=[],o=r.s.c;o<=r.e.c;++o){var c=TT({r:i,c:o});if((t=a?(e[i]||[])[o]:e[c])&&null!=t.v){for(var l=(t.w||(_T(t),t.w)||"").slice(0,10);l.length<10;)l+=" ";s.push(l+(0===o?" ":""))}else s.push("          ")}n.push(s.join(""))}return n.join("\n")}}}();var mS=function(){function e(e,t,n){if(e){cT(e,e.l||0);for(var r=n.Enum||v;e.l<e.length;){var a=e.read_shift(2),i=r[a]||r[65535],s=e.read_shift(2),o=e.l+s,c=i.f&&i.f(e,s,n);if(e.l=o,t(c,i,a))return}}}function t(t,n){if(!t)return t;var r=n||{};var a=r.dense?[]:{},i="Sheet1",s="",o=0,c={},l=[],u=[],d={s:{r:0,c:0},e:{r:0,c:0}},h=r.sheetRows||0;if(0==t[2]&&(8==t[3]||9==t[3])&&t.length>=16&&5==t[14]&&108===t[15])throw new Error("Unsupported Works 3 for Mac file");if(2==t[2])r.Enum=v,e(t,(function(e,t,n){switch(n){case 0:r.vers=e,e>=4096&&(r.qpro=!0);break;case 6:d=e;break;case 204:e&&(s=e);break;case 222:s=e;break;case 15:case 51:r.qpro||(e[1].v=e[1].v.slice(1));case 13:case 14:case 16:14==n&&112==(112&e[2])&&(15&e[2])>1&&(15&e[2])<15&&(e[1].z=r.dateNF||Nb[14],r.cellDates&&(e[1].t="d",e[1].v=xw(e[1].v))),r.qpro&&e[3]>o&&(a["!ref"]=ST(d),c[i]=a,l.push(i),a=r.dense?[]:{},d={s:{r:0,c:0},e:{r:0,c:0}},o=e[3],i=s||"Sheet"+(o+1),s="");var u=r.dense?(a[e[0].r]||[])[e[0].c]:a[TT(e[0])];if(u){u.t=e[1].t,u.v=e[1].v,null!=e[1].z&&(u.z=e[1].z),null!=e[1].f&&(u.f=e[1].f);break}r.dense?(a[e[0].r]||(a[e[0].r]=[]),a[e[0].r][e[0].c]=e[1]):a[TT(e[0])]=e[1]}}),r);else{if(26!=t[2]&&14!=t[2])throw new Error("Unrecognized LOTUS BOF "+t[2]);r.Enum=y,14==t[2]&&(r.qpro=!0,t.l=0),e(t,(function(e,t,n){switch(n){case 204:i=e;break;case 22:e[1].v=e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(e[3]>o&&(a["!ref"]=ST(d),c[i]=a,l.push(i),a=r.dense?[]:{},d={s:{r:0,c:0},e:{r:0,c:0}},o=e[3],i="Sheet"+(o+1)),h>0&&e[0].r>=h)break;r.dense?(a[e[0].r]||(a[e[0].r]=[]),a[e[0].r][e[0].c]=e[1]):a[TT(e[0])]=e[1],d.e.c<e[0].c&&(d.e.c=e[0].c),d.e.r<e[0].r&&(d.e.r=e[0].r);break;case 27:e[14e3]&&(u[e[14e3][0]]=e[14e3][1]);break;case 1537:u[e[0]]=e[1],e[0]==o&&(i=e[1])}}),r)}if(a["!ref"]=ST(d),c[s||i]=a,l.push(s||i),!u.length)return{SheetNames:l,Sheets:c};for(var f={},p=[],g=0;g<u.length;++g)c[l[g]]?(p.push(u[g]||l[g]),f[u[g]]=c[u[g]]||c[l[g]]):(p.push(u[g]),f[u[g]]={"!ref":"A1"});return{SheetNames:p,Sheets:f}}function n(e,t,n){var r=[{c:0,r:0},{t:"n",v:0},0,0];return n.qpro&&20768!=n.vers?(r[0].c=e.read_shift(1),r[3]=e.read_shift(1),r[0].r=e.read_shift(2),e.l+=2):(r[2]=e.read_shift(1),r[0].c=e.read_shift(2),r[0].r=e.read_shift(2)),r}function r(e,t,r){var a=e.l+t,i=n(e,0,r);if(i[1].t="s",20768==r.vers){e.l++;var s=e.read_shift(1);return i[1].v=e.read_shift(s,"utf8"),i}return r.qpro&&e.l++,i[1].v=e.read_shift(a-e.l,"cstr"),i}function a(e,t,n){var r=uT(7+n.length);r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(1,39);for(var a=0;a<r.length;++a){var i=n.charCodeAt(a);r.write_shift(1,i>=128?95:i)}return r.write_shift(1,0),r}function i(e,t,n){var r=uT(7);return r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(2,n,"i"),r}function s(e,t,n){var r=uT(13);return r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(8,n,"f"),r}function o(e,t,n){var r=32768&t;return t=(r?e:0)+((t&=-32769)>=8192?t-16384:t),(r?"":"$")+(n?wT(t):yT(t))}var c={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},l=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function u(e){var t=[{c:0,r:0},{t:"n",v:0},0];return t[0].r=e.read_shift(2),t[3]=e[e.l++],t[0].c=e[e.l++],t}function d(e,t,n,r){var a=uT(6+r.length);a.write_shift(2,e),a.write_shift(1,n),a.write_shift(1,t),a.write_shift(1,39);for(var i=0;i<r.length;++i){var s=r.charCodeAt(i);a.write_shift(1,s>=128?95:s)}return a.write_shift(1,0),a}function h(e,t){var n=u(e),r=e.read_shift(4),a=e.read_shift(4),i=e.read_shift(2);if(65535==i)return 0===r&&3221225472===a?(n[1].t="e",n[1].v=15):0===r&&3489660928===a?(n[1].t="e",n[1].v=42):n[1].v=0,n;var s=32768&i;return i=(32767&i)-16446,n[1].v=(1-2*s)*(a*Math.pow(2,i+32)+r*Math.pow(2,i)),n}function f(e,t,n,r){var a=uT(14);if(a.write_shift(2,e),a.write_shift(1,n),a.write_shift(1,t),0==r)return a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,65535),a;var i,s=0,o=0,c=0;return r<0&&(s=1,r=-r),o=0|Math.log2(r),0==(2147483648&(c=(r/=Math.pow(2,o-31))>>>0))&&(++o,c=(r/=2)>>>0),r-=c,c|=2147483648,c>>>=0,i=(r*=Math.pow(2,32))>>>0,a.write_shift(4,i),a.write_shift(4,c),o+=16383+(s?32768:0),a.write_shift(2,o),a}function p(e,t){var n=u(e),r=e.read_shift(8,"f");return n[1].v=r,n}function g(e,t){return 0==e[e.l+t-1]?e.read_shift(t,"cstr"):""}function m(e,t){var n=uT(5+e.length);n.write_shift(2,14e3),n.write_shift(2,t);for(var r=0;r<e.length;++r){var a=e.charCodeAt(r);n[n.l++]=a>127?95:a}return n[n.l++]=0,n}var v={0:{n:"BOF",f:Cx},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e,t,n){var r={s:{c:0,r:0},e:{c:0,r:0}};return 8==t&&n.qpro?(r.s.c=e.read_shift(1),e.l++,r.s.r=e.read_shift(2),r.e.c=e.read_shift(1),e.l++,r.e.r=e.read_shift(2),r):(r.s.c=e.read_shift(2),r.s.r=e.read_shift(2),12==t&&n.qpro&&(e.l+=2),r.e.c=e.read_shift(2),r.e.r=e.read_shift(2),12==t&&n.qpro&&(e.l+=2),65535==r.s.c&&(r.s.c=r.e.c=r.s.r=r.e.r=0),r)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,t,r){var a=n(e,0,r);return a[1].v=e.read_shift(2,"i"),a}},14:{n:"NUMBER",f:function(e,t,r){var a=n(e,0,r);return a[1].v=e.read_shift(8,"f"),a}},15:{n:"LABEL",f:r},16:{n:"FORMULA",f:function(e,t,r){var a=e.l+t,i=n(e,0,r);if(i[1].v=e.read_shift(8,"f"),r.qpro)e.l=a;else{var s=e.read_shift(2);!function(e,t){cT(e,0);var n=[],r=0,a="",i="",s="",u="";for(;e.l<e.length;){var d=e[e.l++];switch(d){case 0:n.push(e.read_shift(8,"f"));break;case 1:i=o(t[0].c,e.read_shift(2),!0),a=o(t[0].r,e.read_shift(2),!1),n.push(i+a);break;case 2:var h=o(t[0].c,e.read_shift(2),!0),f=o(t[0].r,e.read_shift(2),!1);i=o(t[0].c,e.read_shift(2),!0),a=o(t[0].r,e.read_shift(2),!1),n.push(h+f+":"+i+a);break;case 3:if(e.l<e.length)return void console.error("WK1 premature formula end");break;case 4:n.push("("+n.pop()+")");break;case 5:n.push(e.read_shift(2));break;case 6:for(var p="";d=e[e.l++];)p+=String.fromCharCode(d);n.push('"'+p.replace(/"/g,'""')+'"');break;case 8:n.push("-"+n.pop());break;case 23:n.push("+"+n.pop());break;case 22:n.push("NOT("+n.pop()+")");break;case 20:case 21:u=n.pop(),s=n.pop(),n.push(["AND","OR"][d-20]+"("+s+","+u+")");break;default:if(d<32&&l[d])u=n.pop(),s=n.pop(),n.push(s+l[d]+u);else{if(!c[d])return d<=7?console.error("WK1 invalid opcode "+d.toString(16)):d<=24?console.error("WK1 unsupported op "+d.toString(16)):d<=30?console.error("WK1 invalid opcode "+d.toString(16)):d<=115?console.error("WK1 unsupported function opcode "+d.toString(16)):console.error("WK1 unrecognized opcode "+d.toString(16));if(69==(r=c[d][1])&&(r=e[e.l++]),r>n.length)return void console.error("WK1 bad formula parse 0x"+d.toString(16)+":|"+n.join("|")+"|");var g=n.slice(-r);n.length-=r,n.push(c[d][0]+"("+g.join(",")+")")}}}1==n.length?t[1].f=""+n[0]:console.error("WK1 bad formula parse |"+n.join("|")+"|")}(e.slice(e.l,e.l+s),i),e.l+=s}return i}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:r},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:g},222:{n:"SHEETNAMELP",f:function(e,t){var n=e[e.l++];n>t-1&&(n=t-1);for(var r="";r.length<n;)r+=String.fromCharCode(e[e.l++]);return r}},65535:{n:""}},y={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(e,t){var n=u(e);return n[1].t="s",n[1].v=e.read_shift(t-4,"cstr"),n}},23:{n:"NUMBER17",f:h},24:{n:"NUMBER18",f:function(e,t){var n=u(e);n[1].v=e.read_shift(2);var r=n[1].v>>1;if(1&n[1].v)switch(7&r){case 0:r=5e3*(r>>3);break;case 1:r=500*(r>>3);break;case 2:r=(r>>3)/20;break;case 3:r=(r>>3)/200;break;case 4:r=(r>>3)/2e3;break;case 5:r=(r>>3)/2e4;break;case 6:r=(r>>3)/16;break;case 7:r=(r>>3)/64}return n[1].v=r,n}},25:{n:"FORMULA19",f:function(e,t){var n=h(e);return e.l+=t-14,n}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(e,t){for(var n={},r=e.l+t;e.l<r;){var a=e.read_shift(2);if(14e3==a){for(n[a]=[0,""],n[a][0]=e.read_shift(2);e[e.l];)n[a][1]+=String.fromCharCode(e[e.l]),e.l++;e.l++}}return n}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(e,t){var n=u(e),r=e.read_shift(4);return n[1].v=r>>6,n}},38:{n:"??"},39:{n:"NUMBER27",f:p},40:{n:"FORMULA28",f:function(e,t){var n=p(e);return e.l+=t-10,n}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:g},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(e,t,n){if(n.qpro&&!(t<21)){var r=e.read_shift(1);return e.l+=17,e.l+=1,e.l+=2,[r,e.read_shift(t-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function(e,t){var n=t||{};if(+n.codepage>=0&&eb(+n.codepage),"string"==n.type)throw new Error("Cannot write WK1 to JS string");var r=hT(),o=IT(e["!ref"]),c=Array.isArray(e),l=[];E_(r,0,function(e){var t=uT(2);return t.write_shift(2,e),t}(1030)),E_(r,6,function(e){var t=uT(8);return t.write_shift(2,e.s.c),t.write_shift(2,e.s.r),t.write_shift(2,e.e.c),t.write_shift(2,e.e.r),t}(o));for(var u=Math.min(o.e.r,8191),d=o.s.r;d<=u;++d)for(var h=yT(d),f=o.s.c;f<=o.e.c;++f){d===o.s.r&&(l[f]=wT(f));var p=l[f]+h,g=c?(e[d]||[])[f]:e[p];if(g&&"z"!=g.t)if("n"==g.t)(0|g.v)==g.v&&g.v>=-32768&&g.v<=32767?E_(r,13,i(d,f,g.v)):E_(r,14,s(d,f,g.v));else E_(r,15,a(d,f,_T(g).slice(0,239)))}return E_(r,1),r.end()},book_to_wk3:function(e,t){var n=t||{};if(+n.codepage>=0&&eb(+n.codepage),"string"==n.type)throw new Error("Cannot write WK3 to JS string");var r=hT();E_(r,0,function(e){var t=uT(26);t.write_shift(2,4096),t.write_shift(2,4),t.write_shift(4,0);for(var n=0,r=0,a=0,i=0;i<e.SheetNames.length;++i){var s=e.SheetNames[i],o=e.Sheets[s];if(o&&o["!ref"]){++a;var c=xT(o["!ref"]);n<c.e.r&&(n=c.e.r),r<c.e.c&&(r=c.e.c)}}n>8191&&(n=8191);return t.write_shift(2,n),t.write_shift(1,a),t.write_shift(1,r),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,1),t.write_shift(1,2),t.write_shift(4,0),t.write_shift(4,0),t}(e));for(var a=0,i=0;a<e.SheetNames.length;++a)(e.Sheets[e.SheetNames[a]]||{})["!ref"]&&E_(r,27,m(e.SheetNames[a],i++));var s=0;for(a=0;a<e.SheetNames.length;++a){var o=e.Sheets[e.SheetNames[a]];if(o&&o["!ref"]){for(var c=IT(o["!ref"]),l=Array.isArray(o),u=[],h=Math.min(c.e.r,8191),p=c.s.r;p<=h;++p)for(var g=yT(p),v=c.s.c;v<=c.e.c;++v){p===c.s.r&&(u[v]=wT(v));var y=u[v]+g,b=l?(o[p]||[])[v]:o[y];if(b&&"z"!=b.t)if("n"==b.t)E_(r,23,f(p,v,s,b.v));else E_(r,22,d(p,v,s,_T(b).slice(0,239)))}++s}}return E_(r,1),r.end()},to_workbook:function(e,n){switch(n.type){case"base64":return t(gb(ub(e)),n);case"binary":return t(gb(e),n);case"buffer":case"array":return t(e,n)}throw"Unsupported type "+n.type}}}();var vS=function(){var e=gE("t"),t=gE("rPr");function n(n){var r=n.match(e);if(!r)return{t:"s",v:""};var a={t:"s",v:rE(r[1])},i=n.match(t);return i&&(a.s=function(e){var t={},n=e.match(Xw),r=0,a=!1;if(n)for(;r!=n.length;++r){var i=Zw(n[r]);switch(i[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if("1"==i.val)break;t.cp=Jy[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting"}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if("0"==i.val)break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if("0"==i.val)break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":case"<scheme>":case"<scheme/>":case"</scheme>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(47!==i[0].charCodeAt(1)&&!a)throw new Error("Unrecognized rich format "+i[0])}}return t}(i[1])),a}var r=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(e){return e.replace(r,"").split(a).map(n).filter((function(e){return e.v}))}}(),yS=function(){var e=/(\r\n|\n)/g;function t(t){var n=[[],t.v,[]];return t.v?(t.s&&function(e,t,n){var r=[];e.u&&r.push("text-decoration: underline;"),e.uval&&r.push("text-underline-style:"+e.uval+";"),e.sz&&r.push("font-size:"+e.sz+"pt;"),e.outline&&r.push("text-effect: outline;"),e.shadow&&r.push("text-shadow: auto;"),t.push('<span style="'+r.join("")+'">'),e.b&&(t.push("<b>"),n.push("</b>")),e.i&&(t.push("<i>"),n.push("</i>")),e.strike&&(t.push("<s>"),n.push("</s>"));var a=e.valign||"";"superscript"==a||"super"==a?a="sup":"subscript"==a&&(a="sub"),""!=a&&(t.push("<"+a+">"),n.push("</"+a+">")),n.push("</span>")}(t.s,n[0],n[2]),n[0].join("")+n[1].replace(e,"<br/>")+n[2].join("")):""}return function(e){return e.map(t).join("")}}(),bS=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,wS=/<(?:\w+:)?r>/,ES=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function TS(e,t){var n=!t||t.cellHTML,r={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=rE(fE(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=fE(e),n&&(r.h=sE(r.t))):e.match(wS)&&(r.r=fE(e),r.t=rE(fE((e.replace(ES,"").match(bS)||[]).join("").replace(Xw,""))),n&&(r.h=yS(vS(r.r)))),r):{t:""}}var xS=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,SS=/<(?:\w+:)?(?:si|sstItem)>/g,IS=/<\/(?:\w+:)?(?:si|sstItem)>/;function kS(e){if("undefined"!==typeof ab)return ab.utils.encode(Xy,e);for(var t=[],n=e.split(""),r=0;r<n.length;++r)t[r]=n[r].charCodeAt(0);return t}function _S(e,t){var n={};return n.Major=e.read_shift(2),n.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),n}function CS(e){for(var t=e.read_shift(4),n=e.l+t-4,r={},a=e.read_shift(4),i=[];a-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(r.name=e.read_shift(0,"lpp4"),r.comps=i,e.l!=n)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+n);return r}function AS(e){var t=function(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=_S(e,4),t.U=_S(e,4),t.W=_S(e,4),t}(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),4!=e.read_shift(4))throw new Error("Bad !Primary record");return t}function NS(e,t){var n=e.l+t,r={};r.Flags=63&e.read_shift(4),e.l+=4,r.AlgID=e.read_shift(4);var a=!1;switch(r.AlgID){case 26126:case 26127:case 26128:a=36==r.Flags;break;case 26625:a=4==r.Flags;break;case 0:a=16==r.Flags||4==r.Flags||36==r.Flags;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=e.read_shift(4),r.KeySize=e.read_shift(4),r.ProviderType=e.read_shift(4),e.l+=8,r.CSPName=e.read_shift(n-e.l>>1,"utf16le"),e.l=n,r}function RS(e,t){var n={},r=e.l+t;return e.l+=4,n.Salt=e.slice(e.l,e.l+16),e.l+=16,n.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),n.VerifierHash=e.slice(e.l,r),e.l=r,n}function OS(e){if(36!=(63&e.read_shift(4)))throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4);return{t:"Std",h:NS(e,t),v:RS(e,e.length-e.l)}}function DS(){throw new Error("File is password-protected: ECMA-376 Extensible")}function PS(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var n=e.read_shift(e.length-e.l,"utf8"),r={};return n.replace(Xw,(function(e){var n=Zw(e);switch(eE(n[0])){case"<?xml":case"<encryption":case"</encryption>":case"</keyEncryptors>":case"</keyEncryptor>":break;case"<keyData":t.forEach((function(e){r[e]=n[e]}));break;case"<dataIntegrity":r.encryptedHmacKey=n.encryptedHmacKey,r.encryptedHmacValue=n.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"<keyEncryptor":r.uri=n.uri;break;case"<encryptedKey":r.encs.push(n);break;default:throw n[0]}})),r}function LS(e){var t,n,r=0,a=kS(e),i=a.length+1;for((t=fb(i))[0]=a.length,n=1;n!=i;++n)t[n]=a[n-1];for(n=i-1;n>=0;--n)r=((0===(16384&r)?0:1)|r<<1&32767)^t[n];return 52811^r}var MS=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],n=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(e,t){return 255&((n=e^t)/2|128*n);var n};return function(a){for(var i,s,o,c=kS(a),l=function(e){for(var r=t[e.length-1],a=104,i=e.length-1;i>=0;--i)for(var s=e[i],o=0;7!=o;++o)64&s&&(r^=n[a]),s*=2,--a;return r}(c),u=c.length,d=fb(16),h=0;16!=h;++h)d[h]=0;for(1===(1&u)&&(i=l>>8,d[u]=r(e[0],i),--u,i=255&l,s=c[c.length-1],d[u]=r(s,i));u>0;)i=l>>8,d[--u]=r(c[u],i),i=255&l,d[--u]=r(c[u],i);for(u=15,o=15-c.length;o>0;)i=l>>8,d[u]=r(e[o],i),--o,i=255&l,d[--u]=r(c[u],i),--u,--o;return d}}(),FS=function(e){var t=0,n=MS(e);return function(e){var r=function(e,t,n,r,a){var i,s;for(a||(a=t),r||(r=MS(e)),i=0;i!=t.length;++i)s=t[i],s=255&((s^=r[n])>>5|s<<3),a[i]=s,++n;return[a,n,r]}("",e,t,n);return t=r[1],r[0]}};function zS(e,t,n){var r=n||{};return r.Info=e.read_shift(2),e.l-=2,1===r.Info?r.Data=function(e){var t={},n=t.EncryptionVersionInfo=_S(e,4);if(1!=n.Major||1!=n.Minor)throw"unrecognized version code "+n.Major+" : "+n.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}(e):r.Data=function(e,t){var n={},r=n.EncryptionVersionInfo=_S(e,4);if(t-=4,2!=r.Minor)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);n.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,n.EncryptionHeader=NS(e,a),t-=a,n.EncryptionVerifier=RS(e,t),n}(e,t),r}var jS=function(){function e(e,n){switch(n.type){case"base64":return t(ub(e),n);case"binary":return t(e,n);case"buffer":return t(db&&Buffer.isBuffer(e)?e.toString("binary"):mb(e),n);case"array":return t(Aw(e),n)}throw new Error("Unrecognized type "+n.type)}function t(e,t){var n=(t||{}).dense?[]:{},r=e.match(/\\trowd.*?\\row\b/g);if(!r.length)throw new Error("RTF missing table");var a={s:{c:0,r:0},e:{c:0,r:r.length-1}};return r.forEach((function(e,t){Array.isArray(n)&&(n[t]=[]);for(var r,i=/\\\w+\b/g,s=0,o=-1;r=i.exec(e);){if("\\cell"===r[0]){var c=e.slice(s,i.lastIndex-r[0].length);if(" "==c[0]&&(c=c.slice(1)),++o,c.length){var l={v:c,t:"s"};Array.isArray(n)?n[t][o]=l:n[TT({r:t,c:o})]=l}}s=i.lastIndex}o>a.e.c&&(a.e.c=o)})),n["!ref"]=ST(a),n}return{to_workbook:function(t,n){return CT(e(t,n),n)},to_sheet:e,from_sheet:function(e){for(var t,n=["{\\rtf1\\ansi"],r=IT(e["!ref"]),a=Array.isArray(e),i=r.s.r;i<=r.e.r;++i){n.push("\\trowd\\trautofit1");for(var s=r.s.c;s<=r.e.c;++s)n.push("\\cellx"+(s+1));for(n.push("\\pard\\intbl"),s=r.s.c;s<=r.e.c;++s){var o=TT({r:i,c:s});(t=a?(e[i]||[])[s]:e[o])&&(null!=t.v||t.f&&!t.F)&&(n.push(" "+(t.w||(_T(t),t.w))),n.push("\\cell"))}n.push("\\pard\\intbl\\row")}return n.join("")+"}"}}}();function US(e){for(var t=0,n=1;3!=t;++t)n=256*n+(e[t]>255?255:e[t]<0?0:e[t]);return n.toString(16).toUpperCase().slice(1)}function BS(e,t){if(0===t)return e;var n=function(e){var t=e[0]/255,n=e[1]/255,r=e[2]/255,a=Math.max(t,n,r),i=Math.min(t,n,r),s=a-i;if(0===s)return[0,0,t];var o,c=0,l=a+i;switch(o=s/(l>1?2-l:l),a){case t:c=((n-r)/s+6)%6;break;case n:c=(r-t)/s+2;break;case r:c=(t-n)/s+4}return[c/6,o,l/2]}(function(e){var t=e.slice("#"===e[0]?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}(e));return n[2]=t<0?n[2]*(1+t):1-(1-n[2])*(1-t),US(function(e){var t,n=e[0],r=e[1],a=e[2],i=2*r*(a<.5?a:1-a),s=a-i/2,o=[s,s,s],c=6*n;if(0!==r)switch(0|c){case 0:case 6:t=i*c,o[0]+=i,o[1]+=t;break;case 1:t=i*(2-c),o[0]+=t,o[1]+=i;break;case 2:t=i*(c-2),o[1]+=i,o[2]+=t;break;case 3:t=i*(4-c),o[1]+=t,o[2]+=i;break;case 4:t=i*(c-4),o[2]+=i,o[0]+=t;break;case 5:t=i*(6-c),o[2]+=t,o[0]+=i}for(var l=0;3!=l;++l)o[l]=Math.round(255*o[l]);return o}(n))}var VS=6;function $S(e){return Math.floor((e+Math.round(128/VS)/256)*VS)}function HS(e){return Math.floor((e-5)/VS*100+.5)/100}function WS(e){return Math.round((e*VS+5)/VS*256)/256}function GS(e){return WS(HS($S(e)))}function KS(e){var t=Math.abs(e-GS(e)),n=VS;if(t>.005)for(VS=1;VS<15;++VS)Math.abs(e-GS(e))<=t&&(t=Math.abs(e-GS(e)),n=VS);VS=n}function qS(e){e.width?(e.wpx=$S(e.width),e.wch=HS(e.wpx),e.MDW=VS):e.wpx?(e.wch=HS(e.wpx),e.width=WS(e.wch),e.MDW=VS):"number"==typeof e.wch&&(e.width=WS(e.wch),e.wpx=$S(e.width),e.MDW=VS),e.customWidth&&delete e.customWidth}var YS=96;function XS(e){return 96*e/YS}function QS(e){return e*YS/96}var JS={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};var ZS=["numFmtId","fillId","fontId","borderId","xfId"],eI=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];var tI=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,r=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(i,s,o){var c,l={};return i?((c=(i=i.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(e))&&function(e,t,n){t.NumberFmt=[];for(var r=mw(Nb),a=0;a<r.length;++a)t.NumberFmt[r[a]]=Nb[r[a]];var i=e[0].match(Xw);if(i)for(a=0;a<i.length;++a){var s=Zw(i[a]);switch(eE(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":case"</numFmt>":break;case"<numFmt":var o=rE(fE(s.formatCode)),c=parseInt(s.numFmtId,10);if(t.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&null!=t.NumberFmt[c];--c);t.NumberFmt[c]=o}lw(o,c)}break;default:if(n.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}(c,l,o),(c=i.match(r))&&function(e,t,n,r){t.Fonts=[];var a={},i=!1;(e[0].match(Xw)||[]).forEach((function(e){var s=Zw(e);switch(eE(s[0])){case"<fonts":case"<fonts>":case"</fonts>":case"<font":case"<font>":case"<name/>":case"</name>":case"<sz/>":case"</sz>":case"<vertAlign/>":case"</vertAlign>":case"<family/>":case"</family>":case"<scheme/>":case"</scheme>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":s.val&&(a.name=fE(s.val));break;case"<b":a.bold=s.val?cE(s.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=s.val?cE(s.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(s.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=s.val?cE(s.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=s.val?cE(s.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=s.val?cE(s.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=s.val?cE(s.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=s.val?cE(s.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":s.val&&(a.sz=+s.val);break;case"<vertAlign":s.val&&(a.vertAlign=s.val);break;case"<family":s.val&&(a.family=parseInt(s.val,10));break;case"<scheme":s.val&&(a.scheme=s.val);break;case"<charset":if("1"==s.val)break;s.codepage=Jy[parseInt(s.val,10)];break;case"<color":if(a.color||(a.color={}),s.auto&&(a.color.auto=cE(s.auto)),s.rgb)a.color.rgb=s.rgb.slice(-6);else if(s.indexed){a.color.index=parseInt(s.indexed,10);var o=ZT[a.color.index];81==a.color.index&&(o=ZT[1]),o||(o=ZT[1]),a.color.rgb=o[0].toString(16)+o[1].toString(16)+o[2].toString(16)}else s.theme&&(a.color.theme=parseInt(s.theme,10),s.tint&&(a.color.tint=parseFloat(s.tint)),s.theme&&n.themeElements&&n.themeElements.clrScheme&&(a.color.rgb=BS(n.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<AlternateContent":case"<ext":i=!0;break;case"</AlternateContent>":case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+s[0]+" in fonts")}}))}(c,l,s,o),(c=i.match(n))&&function(e,t,n,r){t.Fills=[];var a={},i=!1;(e[0].match(Xw)||[]).forEach((function(e){var n=Zw(e);switch(eE(n[0])){case"<fills":case"<fills>":case"</fills>":case"</fill>":case"<gradientFill>":case"<patternFill/>":case"</patternFill>":case"<bgColor/>":case"</bgColor>":case"<fgColor/>":case"</fgColor>":case"<stop":case"<stop/>":case"</stop>":case"<color":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":n.patternType&&(a.patternType=n.patternType);break;case"<bgColor":a.bgColor||(a.bgColor={}),n.indexed&&(a.bgColor.indexed=parseInt(n.indexed,10)),n.theme&&(a.bgColor.theme=parseInt(n.theme,10)),n.tint&&(a.bgColor.tint=parseFloat(n.tint)),n.rgb&&(a.bgColor.rgb=n.rgb.slice(-6));break;case"<fgColor":a.fgColor||(a.fgColor={}),n.theme&&(a.fgColor.theme=parseInt(n.theme,10)),n.tint&&(a.fgColor.tint=parseFloat(n.tint)),null!=n.rgb&&(a.fgColor.rgb=n.rgb.slice(-6));break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+n[0]+" in fills")}}))}(c,l,0,o),(c=i.match(a))&&function(e,t,n,r){t.Borders=[];var a={},i=!1;(e[0].match(Xw)||[]).forEach((function(e){var n=Zw(e);switch(eE(n[0])){case"<borders":case"<borders>":case"</borders>":case"</border>":case"<left/>":case"<left":case"<left>":case"</left>":case"<right/>":case"<right":case"<right>":case"</right>":case"<top/>":case"<top":case"<top>":case"</top>":case"<bottom/>":case"<bottom":case"<bottom>":case"</bottom>":case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":case"<start":case"<start>":case"<start/>":case"</start>":case"<end":case"<end>":case"<end/>":case"</end>":case"<color":case"<color>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<border":case"<border>":case"<border/>":a={},n.diagonalUp&&(a.diagonalUp=cE(n.diagonalUp)),n.diagonalDown&&(a.diagonalDown=cE(n.diagonalDown)),t.Borders.push(a);break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+n[0]+" in borders")}}))}(c,l,0,o),(c=i.match(t))&&function(e,t,n){var r;t.CellXf=[];var a=!1;(e[0].match(Xw)||[]).forEach((function(e){var i=Zw(e),s=0;switch(eE(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":case"</xf>":case"</alignment>":case"<protection":case"</protection>":case"<protection/>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<xf":case"<xf/>":for(delete(r=i)[0],s=0;s<ZS.length;++s)r[ZS[s]]&&(r[ZS[s]]=parseInt(r[ZS[s]],10));for(s=0;s<eI.length;++s)r[eI[s]]&&(r[eI[s]]=cE(r[eI[s]]));if(t.NumberFmt&&r.numFmtId>392)for(s=392;s>60;--s)if(t.NumberFmt[r.numFmtId]==t.NumberFmt[s]){r.numFmtId=s;break}t.CellXf.push(r);break;case"<alignment":case"<alignment/>":var o={};i.vertical&&(o.vertical=i.vertical),i.horizontal&&(o.horizontal=i.horizontal),null!=i.textRotation&&(o.textRotation=i.textRotation),i.indent&&(o.indent=i.indent),i.wrapText&&(o.wrapText=cE(i.wrapText)),r.alignment=o;break;case"<AlternateContent":case"<ext":a=!0;break;case"</AlternateContent>":case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+i[0]+" in cellXfs")}}))}(c,l,o),l):l}}();var nI=lT;var rI=lT;var aI=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function iI(e,t,n){t.themeElements.clrScheme=[];var r={};(e[0].match(Xw)||[]).forEach((function(e){var a=Zw(e);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=a.val;break;case"<a:sysClr":r.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===a[0].charAt(1)?(t.themeElements.clrScheme[aI.indexOf(a[0])]=r,r={}):r.name=a[0].slice(3,a[0].length-1);break;default:if(n&&n.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}}))}function sI(){}function oI(){}var cI=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,lI=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,uI=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;var dI=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function hI(e,t){var n;e&&0!==e.length||(e=fI());var r={};if(!(n=e.match(dI)))throw new Error("themeElements not found in theme");return function(e,t,n){var r;t.themeElements={},[["clrScheme",cI,iI],["fontScheme",lI,sI],["fmtScheme",uI,oI]].forEach((function(a){if(!(r=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](r,t,n)}))}(n[0],r,t),r.raw=e,r}function fI(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;var n=[Kw];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',n[n.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',n[n.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',n[n.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',n[n.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',n[n.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',n[n.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function pI(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:case 4:e.l+=4;break;case 1:t.xclrValue=function(e,t){return lT(e,t)}(e,4);break;case 2:t.xclrValue=Fx(e);break;case 3:t.xclrValue=function(e){return e.read_shift(4)}(e)}return e.l+=8,t}function gI(e){var t=e.read_shift(2),n=e.read_shift(2)-4,r=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=pI(e);break;case 6:r[1]=function(e,t){return lT(e,t)}(e,n);break;case 14:case 15:r[1]=e.read_shift(1===n?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+n)}return r}function mI(e,t,n,r){var a,i=Array.isArray(e);t.forEach((function(t){var s=ET(t.ref);if(i?(e[s.r]||(e[s.r]=[]),a=e[s.r][s.c]):a=e[t.ref],!a){a={t:"z"},i?e[s.r][s.c]=a:e[t.ref]=a;var o=IT(e["!ref"]||"BDWGO1000001:A1");o.s.r>s.r&&(o.s.r=s.r),o.e.r<s.r&&(o.e.r=s.r),o.s.c>s.c&&(o.s.c=s.c),o.e.c<s.c&&(o.e.c=s.c);var c=ST(o);c!==e["!ref"]&&(e["!ref"]=c)}a.c||(a.c=[]);var l={a:t.author,t:t.t,r:t.r,T:n};t.h&&(l.h=t.h);for(var u=a.c.length-1;u>=0;--u){if(!n&&a.c[u].T)return;n&&!a.c[u].T&&a.c.splice(u,1)}if(n&&r)for(u=0;u<r.length;++u)if(l.a==r[u].id){l.a=r[u].name||l.a;break}a.c.push(l)}))}var vI=RT;var yI=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function n(e,n,r,a){var i=!1,s=!1;0==r.length?s=!0:"["==r.charAt(0)&&(s=!0,r=r.slice(1,-1)),0==a.length?i=!0:"["==a.charAt(0)&&(i=!0,a=a.slice(1,-1));var o=r.length>0?0|parseInt(r,10):0,c=a.length>0?0|parseInt(a,10):0;return i?c+=t.c:--c,s?o+=t.r:--o,n+(i?"":"$")+wT(c)+(s?"":"$")+yT(o)}return function(r,a){return t=a,r.replace(e,n)}}(),bI=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,wI=function(){return function(e,t){return e.replace(bI,(function(e,n,r,a,i,s){var o=bT(a)-(r?0:t.c),c=vT(s)-(i?0:t.r);return n+"R"+(0==c?"":i?c+1:"["+c+"]")+"C"+(0==o?"":r?o+1:"["+o+"]")}))}}();function EI(e,t){return e.replace(bI,(function(e,n,r,a,i,s){return n+("$"==r?r+a:wT(bT(a)+t.c))+("$"==i?i+s:yT(vT(s)+t.r))}))}function TI(e,t,n){var r=xT(t).s,a=ET(n);return EI(e,{r:a.r-r.r,c:a.c-r.c})}function xI(e){return e.replace(/_xlfn\./g,"")}function SI(e){e.l+=1}function II(e,t){var n=e.read_shift(1==t?1:2);return[16383&n,n>>14&1,n>>15&1]}function kI(e,t,n){var r=2;if(n){if(n.biff>=2&&n.biff<=5)return _I(e);12==n.biff&&(r=4)}var a=e.read_shift(r),i=e.read_shift(r),s=II(e,2),o=II(e,2);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function _I(e){var t=II(e,2),n=II(e,2),r=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:r,cRel:t[1],rRel:t[2]},e:{r:n[0],c:a,cRel:n[1],rRel:n[2]}}}function CI(e,t,n){if(n&&n.biff>=2&&n.biff<=5)return function(e){var t=II(e,2),n=e.read_shift(1);return{r:t[0],c:n,cRel:t[1],rRel:t[2]}}(e);var r=e.read_shift(n&&12==n.biff?4:2),a=II(e,2);return{r:r,c:a[0],cRel:a[1],rRel:a[2]}}function AI(e){var t=e.read_shift(2),n=e.read_shift(2);return{r:t,c:255&n,fQuoted:!!(16384&n),cRel:n>>15,rRel:n>>15}}function NI(e){var t=1&e[e.l+1];return e.l+=4,[t,1]}function RI(e){return[e.read_shift(1),e.read_shift(1)]}function OI(e,t){var n=[e.read_shift(1)];if(12==t)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2}switch(n[0]){case 4:n[1]=_x(e,1)?"TRUE":"FALSE",12!=t&&(e.l+=7);break;case 37:case 16:n[1]=ex[e[e.l]],e.l+=12==t?4:8;break;case 0:e.l+=8;break;case 1:n[1]=HT(e);break;case 2:n[1]=Px(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function DI(e,t,n){for(var r=e.read_shift(12==n.biff?4:2),a=[],i=0;i!=r;++i)a.push((12==n.biff?$T:Vx)(e,8));return a}function PI(e,t,n){var r=0,a=0;12==n.biff?(r=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),r=1+e.read_shift(2)),n.biff>=2&&n.biff<8&&(--r,0==--a&&(a=256));for(var i=0,s=[];i!=r&&(s[i]=[]);++i)for(var o=0;o!=a;++o)s[i][o]=OI(e,n.biff);return s}function LI(e,t,n){return e.l+=2,[AI(e)]}function MI(e){return e.l+=6,[]}function FI(e){return e.l+=2,[Cx(e),1&e.read_shift(2)]}var zI=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];var jI={1:{n:"PtgExp",f:function(e,t,n){return e.l++,n&&12==n.biff?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(n&&2==n.biff?1:2)]}},2:{n:"PtgTbl",f:lT},3:{n:"PtgAdd",f:SI},4:{n:"PtgSub",f:SI},5:{n:"PtgMul",f:SI},6:{n:"PtgDiv",f:SI},7:{n:"PtgPower",f:SI},8:{n:"PtgConcat",f:SI},9:{n:"PtgLt",f:SI},10:{n:"PtgLe",f:SI},11:{n:"PtgEq",f:SI},12:{n:"PtgGe",f:SI},13:{n:"PtgGt",f:SI},14:{n:"PtgNe",f:SI},15:{n:"PtgIsect",f:SI},16:{n:"PtgUnion",f:SI},17:{n:"PtgRange",f:SI},18:{n:"PtgUplus",f:SI},19:{n:"PtgUminus",f:SI},20:{n:"PtgPercent",f:SI},21:{n:"PtgParen",f:SI},22:{n:"PtgMissArg",f:SI},23:{n:"PtgStr",f:function(e,t,n){return e.l++,Nx(e,0,n)}},26:{n:"PtgSheet",f:function(e,t,n){return e.l+=5,e.l+=2,e.l+=2==n.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(e,t,n){return e.l+=2==n.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(e){return e.l++,ex[e.read_shift(1)]}},29:{n:"PtgBool",f:function(e){return e.l++,0!==e.read_shift(1)}},30:{n:"PtgInt",f:function(e){return e.l++,e.read_shift(2)}},31:{n:"PtgNum",f:function(e){return e.l++,HT(e)}},32:{n:"PtgArray",f:function(e,t,n){var r=(96&e[e.l++])>>5;return e.l+=2==n.biff?6:12==n.biff?14:7,[r]}},33:{n:"PtgFunc",f:function(e,t,n){var r=(96&e[e.l])>>5;e.l+=1;var a=e.read_shift(n&&n.biff<=3?1:2);return[sk[a],ik[a],r]}},34:{n:"PtgFuncVar",f:function(e,t,n){var r=e[e.l++],a=e.read_shift(1),i=n&&n.biff<=3?[88==r?-1:0,e.read_shift(1)]:function(e){return[e[e.l+1]>>7,32767&e.read_shift(2)]}(e);return[a,(0===i[0]?ik:ak)[i[1]]]}},35:{n:"PtgName",f:function(e,t,n){var r=e.read_shift(1)>>>5&3,a=!n||n.biff>=8?4:2,i=e.read_shift(a);switch(n.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[r,0,i]}},36:{n:"PtgRef",f:function(e,t,n){var r=(96&e[e.l])>>5;return e.l+=1,[r,CI(e,0,n)]}},37:{n:"PtgArea",f:function(e,t,n){return[(96&e[e.l++])>>5,kI(e,n.biff>=2&&n.biff,n)]}},38:{n:"PtgMemArea",f:function(e,t,n){var r=e.read_shift(1)>>>5&3;return e.l+=n&&2==n.biff?3:4,[r,e.read_shift(n&&2==n.biff?1:2)]}},39:{n:"PtgMemErr",f:lT},40:{n:"PtgMemNoMem",f:lT},41:{n:"PtgMemFunc",f:function(e,t,n){return[e.read_shift(1)>>>5&3,e.read_shift(n&&2==n.biff?1:2)]}},42:{n:"PtgRefErr",f:function(e,t,n){var r=e.read_shift(1)>>>5&3;return e.l+=4,n.biff<8&&e.l--,12==n.biff&&(e.l+=2),[r]}},43:{n:"PtgAreaErr",f:function(e,t,n){var r=(96&e[e.l++])>>5;return e.l+=n&&n.biff>8?12:n.biff<8?6:8,[r]}},44:{n:"PtgRefN",f:function(e,t,n){var r=(96&e[e.l])>>5;e.l+=1;var a=function(e,t,n){var r=n&&n.biff?n.biff:8;if(r>=2&&r<=5)return function(e){var t=e.read_shift(2),n=e.read_shift(1),r=(32768&t)>>15,a=(16384&t)>>14;return t&=16383,1==r&&t>=8192&&(t-=16384),1==a&&n>=128&&(n-=256),{r:t,c:n,cRel:a,rRel:r}}(e);var a=e.read_shift(r>=12?4:2),i=e.read_shift(2),s=(16384&i)>>14,o=(32768&i)>>15;if(i&=16383,1==o)for(;a>524287;)a-=1048576;if(1==s)for(;i>8191;)i-=16384;return{r:a,c:i,cRel:s,rRel:o}}(e,0,n);return[r,a]}},45:{n:"PtgAreaN",f:function(e,t,n){var r=(96&e[e.l++])>>5,a=function(e,t,n){if(n.biff<8)return _I(e);var r=e.read_shift(12==n.biff?4:2),a=e.read_shift(12==n.biff?4:2),i=II(e,2),s=II(e,2);return{s:{r:r,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}(e,0,n);return[r,a]}},46:{n:"PtgMemAreaN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},57:{n:"PtgNameX",f:function(e,t,n){return 5==n.biff?function(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[t,n,r]}(e):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}},58:{n:"PtgRef3d",f:function(e,t,n){var r=(96&e[e.l])>>5;e.l+=1;var a=e.read_shift(2);return n&&5==n.biff&&(e.l+=12),[r,a,CI(e,0,n)]}},59:{n:"PtgArea3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,a=e.read_shift(2,"i");if(n)switch(n.biff){case 5:e.l+=12;break;case 12:0}return[r,a,kI(e,0,n)]}},60:{n:"PtgRefErr3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,a=e.read_shift(2),i=4;if(n)switch(n.biff){case 5:i=15;break;case 12:i=6}return e.l+=i,[r,a]}},61:{n:"PtgAreaErr3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,a=e.read_shift(2),i=8;if(n)switch(n.biff){case 5:e.l+=12,i=6;break;case 12:i=12}return e.l+=i,[r,a]}},255:{}},UI={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},BI={1:{n:"PtgElfLel",f:FI},2:{n:"PtgElfRw",f:LI},3:{n:"PtgElfCol",f:LI},6:{n:"PtgElfRwV",f:LI},7:{n:"PtgElfColV",f:LI},10:{n:"PtgElfRadical",f:LI},11:{n:"PtgElfRadicalS",f:MI},13:{n:"PtgElfColS",f:MI},15:{n:"PtgElfColSV",f:MI},16:{n:"PtgElfRadicalLel",f:FI},25:{n:"PtgList",f:function(e){e.l+=2;var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2);return{ixti:t,coltype:3&n,rt:zI[n>>2&31],idx:r,c:a,C:i}}},29:{n:"PtgSxName",f:function(e){return e.l+=2,[e.read_shift(4)]}},255:{}},VI={0:{n:"PtgAttrNoop",f:function(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=n&&2==n.biff?3:4,[r]}},2:{n:"PtgAttrIf",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e.read_shift(n&&2==n.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(e,t,n){e.l+=2;for(var r=e.read_shift(n&&2==n.biff?1:2),a=[],i=0;i<=r;++i)a.push(e.read_shift(n&&2==n.biff?1:2));return a}},8:{n:"PtgAttrGoto",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e.read_shift(n&&2==n.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(e,t,n){e.l+=n&&2==n.biff?3:4}},32:{n:"PtgAttrBaxcel",f:NI},33:{n:"PtgAttrBaxcel",f:NI},64:{n:"PtgAttrSpace",f:function(e){return e.read_shift(2),RI(e)}},65:{n:"PtgAttrSpaceSemi",f:function(e){return e.read_shift(2),RI(e)}},128:{n:"PtgAttrIfError",f:function(e){var t=255&e[e.l+1]?1:0;return e.l+=2,[t,e.read_shift(2)]}},255:{}};function $I(e,t,n,r){if(r.biff<8)return lT(e,t);for(var a=e.l+t,i=[],s=0;s!==n.length;++s)switch(n[s][0]){case"PtgArray":n[s][1]=PI(e,0,r),i.push(n[s][1]);break;case"PtgMemArea":n[s][2]=DI(e,n[s][1],r),i.push(n[s][2]);break;case"PtgExp":r&&12==r.biff&&(n[s][1][1]=e.read_shift(4),i.push(n[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[s][0]}return 0!==(t=a-e.l)&&i.push(lT(e,t)),i}function HI(e,t,n){for(var r,a,i=e.l+t,s=[];i!=e.l;)t=i-e.l,a=e[e.l],r=jI[a]||jI[UI[a]],24!==a&&25!==a||(r=(24===a?BI:VI)[e[e.l+1]]),r&&r.f?s.push([r.n,r.f(e,t,n)]):lT(e,t);return s}function WI(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n],a=[],i=0;i<r.length;++i){var s=r[i];if(s)if(2===s[0])a.push('"'+s[1].replace(/"/g,'""')+'"');else a.push(s[1]);else a.push("")}t.push(a.join(","))}return t.join(";")}var GI={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function KI(e,t,n){if(!e)return"SH33TJSERR0";if(n.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[t];if(n.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),0==t?"":e.XTI[t-1];if(!r)return"SH33TJSERR1";var a="";if(n.biff>8)switch(e[r[0]][0]){case 357:return a=-1==r[1]?"#REF":e.SheetNames[r[1]],r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 358:return null!=n.SID?e.SheetNames[n.SID]:"SH33TJSSAME"+e[r[0]][0];default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return a=-1==r[1]?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map((function(e){return e.Name})).join(";;");default:return e[r[0]][0][3]?(a=-1==r[1]?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?a:a+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function qI(e,t,n){var r=KI(e,t,n);return"#REF"==r?r:function(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}(r,n)}function YI(e,t,n,r,a){var i,s,o,c,l=a&&a.biff||8,u={s:{c:0,r:0},e:{c:0,r:0}},d=[],h=0,f=0,p="";if(!e[0]||!e[0][0])return"";for(var g=-1,m="",v=0,y=e[0].length;v<y;++v){var b=e[0][v];switch(b[0]){case"PtgUminus":d.push("-"+d.pop());break;case"PtgUplus":d.push("+"+d.pop());break;case"PtgPercent":d.push(d.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(i=d.pop(),s=d.pop(),g>=0){switch(e[0][g][1][0]){case 0:m=Rw(" ",e[0][g][1][1]);break;case 1:m=Rw("\r",e[0][g][1][1]);break;default:if(m="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}s+=m,g=-1}d.push(s+GI[b[0]]+i);break;case"PtgIsect":i=d.pop(),s=d.pop(),d.push(s+" "+i);break;case"PtgUnion":i=d.pop(),s=d.pop(),d.push(s+","+i);break;case"PtgRange":i=d.pop(),s=d.pop(),d.push(s+":"+i);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":o=fT(b[1][1],u,a),d.push(gT(o,l));break;case"PtgRefN":o=n?fT(b[1][1],n,a):b[1][1],d.push(gT(o,l));break;case"PtgRef3d":h=b[1][1],o=fT(b[1][2],u,a);p=qI(r,h,a);d.push(p+"!"+gT(o,l));break;case"PtgFunc":case"PtgFuncVar":var w=b[1][0],E=b[1][1];w||(w=0);var T=0==(w&=127)?[]:d.slice(-w);d.length-=w,"User"===E&&(E=T.shift()),d.push(E+"("+T.join(",")+")");break;case"PtgBool":d.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":d.push(b[1]);break;case"PtgNum":d.push(String(b[1]));break;case"PtgStr":d.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":c=pT(b[1][1],n?{s:n}:u,a),d.push(mT(c,a));break;case"PtgArea":c=pT(b[1][1],u,a),d.push(mT(c,a));break;case"PtgArea3d":h=b[1][1],c=b[1][2],p=qI(r,h,a),d.push(p+"!"+mT(c,a));break;case"PtgAttrSum":d.push("SUM("+d.pop()+")");break;case"PtgName":f=b[1][2];var x=(r.names||[])[f-1]||(r[0]||[])[f],S=x?x.Name:"SH33TJSNAME"+String(f);S&&"_xlfn."==S.slice(0,6)&&!a.xlfn&&(S=S.slice(6)),d.push(S);break;case"PtgNameX":var I,k=b[1][1];if(f=b[1][2],!(a.biff<=5)){var _="";if(14849==((r[k]||[])[0]||[])[0]||(1025==((r[k]||[])[0]||[])[0]?r[k][f]&&r[k][f].itab>0&&(_=r.SheetNames[r[k][f].itab-1]+"!"):_=r.SheetNames[f-1]+"!"),r[k]&&r[k][f])_+=r[k][f].Name;else if(r[0]&&r[0][f])_+=r[0][f].Name;else{var C=(KI(r,k,a)||"").split(";;");C[f-1]?_=C[f-1]:_+="SH33TJSERRX"}d.push(_);break}k<0&&(k=-k),r[k]&&(I=r[k][f]),I||(I={Name:"SH33TJSERRY"}),d.push(I.Name);break;case"PtgParen":var A="(",N=")";if(g>=0){switch(m="",e[0][g][1][0]){case 2:A=Rw(" ",e[0][g][1][1])+A;break;case 3:A=Rw("\r",e[0][g][1][1])+A;break;case 4:N=Rw(" ",e[0][g][1][1])+N;break;case 5:N=Rw("\r",e[0][g][1][1])+N;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}d.push(A+d.pop()+N);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":d.push("#REF!");break;case"PtgExp":o={c:b[1][1],r:b[1][0]};var R={c:n.c,r:n.r};if(r.sharedf[TT(o)]){var O=r.sharedf[TT(o)];d.push(YI(O,u,R,r,a))}else{var D=!1;for(i=0;i!=r.arrayf.length;++i)if(s=r.arrayf[i],!(o.c<s[0].s.c||o.c>s[0].e.c)&&!(o.r<s[0].s.r||o.r>s[0].e.r)){d.push(YI(s[1],u,R,r,a)),D=!0;break}D||d.push(b[1])}break;case"PtgArray":d.push("{"+WI(b[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=v;break;case"PtgMissArg":d.push("");break;case"PtgList":d.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(b))}if(3!=a.biff&&g>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][v][0])){var P=!0;switch((b=e[0][g])[1][0]){case 4:P=!1;case 0:m=Rw(" ",b[1][1]);break;case 5:P=!1;case 1:m=Rw("\r",b[1][1]);break;default:if(m="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}d.push((P?m:"")+d.pop()+(P?"":m)),g=-1}}if(d.length>1&&a.WTF)throw new Error("bad formula stack");return d[0]}function XI(e,t,n){var r,a=e.l+t,i=2==n.biff?1:2,s=e.read_shift(i);if(65535==s)return[[],lT(e,t-2)];var o=HI(e,s,n);return t!==s+i&&(r=$I(e,t-s-i,o,n)),e.l=a,[o,r]}function QI(e,t,n){var r,a=e.l+t,i=e.read_shift(2),s=HI(e,i,n);return 65535==i?[[],lT(e,t-2)]:(t!==i+2&&(r=$I(e,a-i-2,s,n)),[s,r])}function JI(e,t,n){var r=e.l+t,a=jx(e);2==n.biff&&++e.l;var i=function(e){var t;if(65535!==QE(e,e.l+6))return[HT(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=1===e[e.l+2],e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}(e),s=e.read_shift(1);2!=n.biff&&(e.read_shift(1),n.biff>=5&&e.read_shift(4));var o=function(e,t,n){var r,a=e.l+t,i=2==n.biff?1:2,s=e.read_shift(i);if(65535==s)return[[],lT(e,t-2)];var o=HI(e,s,n);return t!==s+i&&(r=$I(e,t-s-i,o,n)),e.l=a,[o,r]}(e,r-e.l,n);return{cell:a,val:i[0],formula:o,shared:s>>3&1,tt:i[1]}}function ZI(e,t,n){var r=e.read_shift(4),a=HI(e,r,n),i=e.read_shift(4);return[a,i>0?$I(e,i,a,n):null]}var ek=ZI,tk=ZI,nk=ZI,rk=ZI,ak={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},ik={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},sk={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function ok(e){return"of:"==e.slice(0,3)&&(e=e.slice(3)),61==e.charCodeAt(0)&&61==(e=e.slice(1)).charCodeAt(0)&&(e=e.slice(1)),(e=(e=(e=e.replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,(function(e,t){return t.replace(/\./g,"")}))).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function ck(e){var t=e.split(":");return[t[0].split(".")[0],t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var lk={},uk={};function dk(e,t){if(e){var n=[.7,.7,.75,.75,.3,.3];"xlml"==t&&(n=[1,1,1,1,.5,.5]),null==e.left&&(e.left=n[0]),null==e.right&&(e.right=n[1]),null==e.top&&(e.top=n[2]),null==e.bottom&&(e.bottom=n[3]),null==e.header&&(e.header=n[4]),null==e.footer&&(e.footer=n[5])}}function hk(e,t,n,r,a,i){try{r.cellNF&&(e.z=Nb[t])}catch(o){if(r.WTF)throw o}if("z"!==e.t||r.cellStyles){if("d"===e.t&&"string"===typeof e.v&&(e.v=Cw(e.v)),(!r||!1!==r.cellText)&&"z"!==e.t)try{if(null==Nb[t]&&lw(dw[t]||"General",t),"e"===e.t)e.w=e.w||ex[e.v];else if(0===t)if("n"===e.t)(0|e.v)===e.v?e.w=e.v.toString(10):e.w=Ub(e.v);else if("d"===e.t){var s=bw(e.v);e.w=(0|s)===s?s.toString(10):Ub(s)}else{if(void 0===e.v)return"";e.w=Bb(e.v,uk)}else"d"===e.t?e.w=cw(t,bw(e.v),uk):e.w=cw(t,e.v,uk)}catch(o){if(r.WTF)throw o}if(r.cellStyles&&null!=n)try{e.s=i.Fills[n],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=BS(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),r.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=BS(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),r.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(r.WTF&&i.Fills)throw o}}}var fk=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,pk=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,gk=/<(?:\w:)?hyperlink [^>]*>/gm,mk=/"(\w*:\w*)"/,vk=/<(?:\w:)?col\b[^>]*[\/]?>/g,yk=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,bk=/<(?:\w:)?pageMargins[^>]*\/>/g,wk=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Ek=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Tk=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function xk(e,t,n,r,a,i,s){if(!e)return e;r||(r={"!id":{}});var o=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},l="",u="",d=e.match(pk);d?(l=e.slice(0,d.index),u=e.slice(d.index+d[0].length)):l=u=e;var h=l.match(wk);h?Sk(h[0],o,a,n):(h=l.match(Ek))&&function(e,t,n,r,a){Sk(e.slice(0,e.indexOf(">")),n,r,a)}(h[0],h[1],o,a,n);var f=(l.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(f>0){var p=l.slice(f,f+50).match(mk);p&&function(e,t){var n=IT(t);n.s.r<=n.e.r&&n.s.c<=n.e.c&&n.s.r>=0&&n.s.c>=0&&(e["!ref"]=ST(n))}(o,p[1])}var g=l.match(Tk);g&&g[1]&&function(e,t){t.Views||(t.Views=[{}]);(e.match(Ik)||[]).forEach((function(e,n){var r=Zw(e);t.Views[n]||(t.Views[n]={}),+r.zoomScale&&(t.Views[n].zoom=+r.zoomScale),cE(r.rightToLeft)&&(t.Views[n].RTL=!0)}))}(g[1],a);var m=[];if(t.cellStyles){var v=l.match(vk);v&&function(e,t){for(var n=!1,r=0;r!=t.length;++r){var a=Zw(t[r],!0);a.hidden&&(a.hidden=cE(a.hidden));var i=parseInt(a.min,10)-1,s=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!n&&a.width&&(n=!0,KS(a.width)),qS(a);i<=s;)e[i++]=Nw(a)}}(m,v)}d&&kk(d[1],o,t,c,i,s);var y=u.match(yk);y&&(o["!autofilter"]=function(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}(y[0]));var b=[],w=u.match(fk);if(w)for(f=0;f!=w.length;++f)b[f]=IT(w[f].slice(w[f].indexOf('"')+1));var E=u.match(gk);E&&function(e,t,n){for(var r=Array.isArray(e),a=0;a!=t.length;++a){var i=Zw(fE(t[a]),!0);if(!i.ref)return;var s=((n||{})["!id"]||[])[i.id];s?(i.Target=s.Target,i.location&&(i.Target+="#"+rE(i.location))):(i.Target="#"+rE(i.location),s={Target:i.Target,TargetMode:"Internal"}),i.Rel=s,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=IT(i.ref),c=o.s.r;c<=o.e.r;++c)for(var l=o.s.c;l<=o.e.c;++l){var u=TT({c:l,r:c});r?(e[c]||(e[c]=[]),e[c][l]||(e[c][l]={t:"z",v:void 0}),e[c][l].l=i):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=i)}}}(o,E,r);var T=u.match(bk);if(T&&(o["!margins"]=function(e){var t={};return["left","right","top","bottom","header","footer"].forEach((function(n){e[n]&&(t[n]=parseFloat(e[n]))})),t}(Zw(T[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=ST(c)),t.sheetRows>0&&o["!ref"]){var x=IT(o["!ref"]);t.sheetRows<=+x.e.r&&(x.e.r=t.sheetRows-1,x.e.r>c.e.r&&(x.e.r=c.e.r),x.e.r<x.s.r&&(x.s.r=x.e.r),x.e.c>c.e.c&&(x.e.c=c.e.c),x.e.c<x.s.c&&(x.s.c=x.e.c),o["!fullref"]=o["!ref"],o["!ref"]=ST(x))}return m.length>0&&(o["!cols"]=m),b.length>0&&(o["!merges"]=b),o}function Sk(e,t,n,r){var a=Zw(e);n.Sheets[r]||(n.Sheets[r]={}),a.codeName&&(n.Sheets[r].CodeName=rE(fE(a.codeName)))}var Ik=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;var kk=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,n=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=gE("v"),s=gE("f");return function(o,c,l,u,d,h){for(var f,p,g,m,v,y=0,b="",w=[],E=[],T=0,x=0,S=0,I="",k=0,_=0,C=0,A=0,N=Array.isArray(h.CellXf),R=[],O=[],D=Array.isArray(c),P=[],L={},M=!1,F=!!l.sheetStubs,z=o.split(t),j=0,U=z.length;j!=U;++j){var B=(b=z[j].trim()).length;if(0!==B){var V=0;e:for(y=0;y<B;++y)switch(b[y]){case">":if("/"!=b[y-1]){++y;break e}if(l&&l.cellStyles){if(k=null!=(p=Zw(b.slice(V,y),!0)).r?parseInt(p.r,10):k+1,_=-1,l.sheetRows&&l.sheetRows<k)continue;L={},M=!1,p.ht&&(M=!0,L.hpt=parseFloat(p.ht),L.hpx=QS(L.hpt)),"1"==p.hidden&&(M=!0,L.hidden=!0),null!=p.outlineLevel&&(M=!0,L.level=+p.outlineLevel),M&&(P[k-1]=L)}break;case"<":V=y}if(V>=y)break;if(k=null!=(p=Zw(b.slice(V,y),!0)).r?parseInt(p.r,10):k+1,_=-1,!(l.sheetRows&&l.sheetRows<k)){u.s.r>k-1&&(u.s.r=k-1),u.e.r<k-1&&(u.e.r=k-1),l&&l.cellStyles&&(L={},M=!1,p.ht&&(M=!0,L.hpt=parseFloat(p.ht),L.hpx=QS(L.hpt)),"1"==p.hidden&&(M=!0,L.hidden=!0),null!=p.outlineLevel&&(M=!0,L.level=+p.outlineLevel),M&&(P[k-1]=L)),w=b.slice(y).split(e);for(var $=0;$!=w.length&&"<"==w[$].trim().charAt(0);++$);for(w=w.slice($),y=0;y!=w.length;++y)if(0!==(b=w[y].trim()).length){if(E=b.match(n),T=y,x=0,S=0,b="<c "+("<"==b.slice(0,1)?">":"")+b,null!=E&&2===E.length){for(T=0,I=E[1],x=0;x!=I.length&&!((S=I.charCodeAt(x)-64)<1||S>26);++x)T=26*T+S;_=--T}else++_;for(x=0;x!=b.length&&62!==b.charCodeAt(x);++x);if(++x,(p=Zw(b.slice(0,x),!0)).r||(p.r=TT({r:k-1,c:_})),f={t:""},null!=(E=(I=b.slice(x)).match(i))&&""!==E[1]&&(f.v=rE(E[1])),l.cellFormula){if(null!=(E=I.match(s))&&""!==E[1]){if(f.f=rE(fE(E[1])).replace(/\r\n/g,"\n"),l.xlfn||(f.f=xI(f.f)),E[0].indexOf('t="array"')>-1)f.F=(I.match(a)||[])[1],f.F.indexOf(":")>-1&&R.push([IT(f.F),f.F]);else if(E[0].indexOf('t="shared"')>-1){m=Zw(E[0]);var H=rE(fE(E[1]));l.xlfn||(H=xI(H)),O[parseInt(m.si,10)]=[m,H,p.r]}}else(E=I.match(/<f[^>]*\/>/))&&O[(m=Zw(E[0])).si]&&(f.f=TI(O[m.si][1],O[m.si][2],p.r));var W=ET(p.r);for(x=0;x<R.length;++x)W.r>=R[x][0].s.r&&W.r<=R[x][0].e.r&&W.c>=R[x][0].s.c&&W.c<=R[x][0].e.c&&(f.F=R[x][1])}if(null==p.t&&void 0===f.v)if(f.f||f.F)f.v=0,f.t="n";else{if(!F)continue;f.t="z"}else f.t=p.t||"n";switch(u.s.c>_&&(u.s.c=_),u.e.c<_&&(u.e.c=_),f.t){case"n":if(""==f.v||null==f.v){if(!F)continue;f.t="z"}else f.v=parseFloat(f.v);break;case"s":if("undefined"==typeof f.v){if(!F)continue;f.t="z"}else g=lk[parseInt(f.v,10)],f.v=g.t,f.r=g.r,l.cellHTML&&(f.h=g.h);break;case"str":f.t="s",f.v=null!=f.v?fE(f.v):"",l.cellHTML&&(f.h=sE(f.v));break;case"inlineStr":E=I.match(r),f.t="s",null!=E&&(g=TS(E[1]))?(f.v=g.t,l.cellHTML&&(f.h=g.h)):f.v="";break;case"b":f.v=cE(f.v);break;case"d":l.cellDates?f.v=Cw(f.v,1):(f.v=bw(Cw(f.v,1)),f.t="n");break;case"e":l&&!1===l.cellText||(f.w=f.v),f.v=tx[f.v]}if(C=A=0,v=null,N&&void 0!==p.s&&null!=(v=h.CellXf[p.s])&&(null!=v.numFmtId&&(C=v.numFmtId),l.cellStyles&&null!=v.fillId&&(A=v.fillId)),hk(f,C,A,l,d,h),l.cellDates&&N&&"n"==f.t&&aw(Nb[C])&&(f.t="d",f.v=xw(f.v)),p.cm&&l.xlmeta){var G=(l.xlmeta.Cell||[])[+p.cm-1];G&&"XLDAPR"==G.type&&(f.D=!0)}if(D){var K=ET(p.r);c[K.r]||(c[K.r]=[]),c[K.r][K.c]=f}else c[p.r]=f}}}}P.length>0&&(c["!rows"]=P)}}();var _k=$T;function Ck(e){return[MT(e),HT(e),"n"]}var Ak=$T;var Nk=["left","right","top","bottom","header","footer"];function Rk(e,t,n,r,a,i){var s=i||{"!type":"chart"};if(!e)return i;var o=0,c=0,l="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach((function(e){var t=function(e){var t,n=[],r=e.match(/^<c:numCache>/);(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach((function(e){var t=e.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);t&&(n[+t[1]]=r?+t[2]:t[2])}));var a=rE((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach((function(e){t=e.replace(/<.*?>/g,"")})),[n,a,t]}(e);u.s.r=u.s.c=0,u.e.c=o,l=wT(o),t[0].forEach((function(e,n){s[l+yT(n)]={t:"n",v:e,z:t[1]},c=n})),u.e.r<c&&(u.e.r=c),++o})),o>0&&(s["!ref"]=ST(u)),s}var Ok=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Dk=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Pk=[],Lk=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Mk(e,t){for(var n=0;n!=e.length;++n)for(var r=e[n],a=0;a!=t.length;++a){var i=t[a];if(null==r[i[0]])r[i[0]]=i[1];else switch(i[2]){case"bool":"string"==typeof r[i[0]]&&(r[i[0]]=cE(r[i[0]]));break;case"int":"string"==typeof r[i[0]]&&(r[i[0]]=parseInt(r[i[0]],10))}}}function Fk(e,t){for(var n=0;n!=t.length;++n){var r=t[n];if(null==e[r[0]])e[r[0]]=r[1];else switch(r[2]){case"bool":"string"==typeof e[r[0]]&&(e[r[0]]=cE(e[r[0]]));break;case"int":"string"==typeof e[r[0]]&&(e[r[0]]=parseInt(e[r[0]],10))}}}function zk(e){Fk(e.WBProps,Ok),Fk(e.CalcPr,Lk),Mk(e.WBView,Dk),Mk(e.Sheets,Pk),uk.date1904=cE(e.WBProps.date1904)}var jk="][*?/\\".split("");function Uk(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var n=!0;return jk.forEach((function(r){if(-1!=e.indexOf(r)){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");n=!1}})),n}var Bk=/<\w+:workbook/;function Vk(e,t){var n={};return e.read_shift(4),n.ArchID=e.read_shift(4),e.l+=t-8,n}function $k(e,t,n){return".bin"===t.slice(-4)?function(e,t){var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],a=!1;t||(t={}),t.biff=12;var i=[],s=[[]];return s.SheetNames=[],s.XTI=[],b_[16]={n:"BrtFRTArchID$",f:Vk},dT(e,(function(e,o,c){switch(c){case 156:s.SheetNames.push(e.name),n.Sheets.push(e);break;case 153:n.WBProps=e;break;case 39:null!=e.Sheet&&(t.SID=e.Sheet),e.Ref=YI(e.Ptg,0,null,s,t),delete t.SID,delete e.Ptg,i.push(e);break;case 1036:case 361:case 2071:case 158:case 143:case 664:case 353:case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:case 16:break;case 357:case 358:case 355:case 667:s[0].length?s.push([c,e]):s[0]=[c,e],s[s.length-1].XTI=[];break;case 362:0===s.length&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(e),s.XTI=s.XTI.concat(e);break;case 35:case 37:r.push(c),a=!0;break;case 36:case 38:r.pop(),a=!1;break;default:if(o.T);else if(!a||t.WTF&&37!=r[r.length-1]&&35!=r[r.length-1])throw new Error("Unexpected record 0x"+c.toString(16))}}),t),zk(n),n.Names=i,n.supbooks=s,n}(e,n):function(e,t){if(!e)throw new Error("Could not find file");var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,a="xmlns",i={},s=0;if(e.replace(Xw,(function(o,c){var l=Zw(o);switch(eE(l[0])){case"<?xml":case"</workbook>":case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":case"<bookViews":case"<bookViews>":case"</bookViews>":case"</workbookView>":case"<sheets":case"<sheets>":case"</sheets>":case"</sheet>":case"<functionGroups":case"<functionGroups/>":case"<functionGroup":case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":case"<definedName/>":case"</calcPr>":case"<oleSize":case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":case"<customWorkbookView":case"</customWorkbookView>":case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":case"<smartTagPr":case"<smartTagPr/>":case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":case"<webPublishing":case"<webPublishing/>":case"<fileRecoveryPr":case"<fileRecoveryPr/>":case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":case"<ArchID":case"<revisionPtr":break;case"<workbook":o.match(Bk)&&(a="xmlns"+o.match(/<(\w+):/)[1]),n.xmlns=l[a];break;case"<fileVersion":delete l[0],n.AppVersion=l;break;case"<workbookPr":case"<workbookPr/>":Ok.forEach((function(e){if(null!=l[e[0]])switch(e[2]){case"bool":n.WBProps[e[0]]=cE(l[e[0]]);break;case"int":n.WBProps[e[0]]=parseInt(l[e[0]],10);break;default:n.WBProps[e[0]]=l[e[0]]}})),l.codeName&&(n.WBProps.CodeName=fE(l.codeName));break;case"<workbookView":case"<workbookView/>":delete l[0],n.WBView.push(l);break;case"<sheet":switch(l.state){case"hidden":l.Hidden=1;break;case"veryHidden":l.Hidden=2;break;default:l.Hidden=0}delete l.state,l.name=rE(fE(l.name)),delete l[0],n.Sheets.push(l);break;case"<definedNames>":case"<definedNames":case"<ext":case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</definedNames>":case"</ext>":case"</AlternateContent>":r=!1;break;case"<definedName":(i={}).Name=fE(l.name),l.comment&&(i.Comment=l.comment),l.localSheetId&&(i.Sheet=+l.localSheetId),cE(l.hidden||"0")&&(i.Hidden=!0),s=c+o.length;break;case"</definedName>":i.Ref=rE(fE(e.slice(s,c))),n.Names.push(i);break;case"<calcPr":case"<calcPr/>":delete l[0],n.CalcPr=l;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+l[0]+" in workbook")}return o})),-1===_E.indexOf(n.xmlns))throw new Error("Unknown Namespace: "+n.xmlns);return zk(n),n}(e,n)}function Hk(e,t,n,r,a,i,s,o){return".bin"===t.slice(-4)?function(e,t,n,r,a,i,s){if(!e)return e;var o=t||{};r||(r={"!id":{}});var c,l,u,d,h,f,p,g,m,v,y=o.dense?[]:{},b={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=[],E=!1,T=!1,x=[];o.biff=12,o["!row"]=0;var S=0,I=!1,k=[],_={},C=o.supbooks||a.supbooks||[[]];if(C.sharedf=_,C.arrayf=k,C.SheetNames=a.SheetNames||a.Sheets.map((function(e){return e.name})),!o.supbooks&&(o.supbooks=C,a.Names))for(var A=0;A<a.Names.length;++A)C[0][A+1]=a.Names[A];var N,R,O=[],D=[],P=!1;if(b_[16]={n:"BrtShortReal",f:Ck},dT(e,(function(e,t,A){if(!T)switch(A){case 148:c=e;break;case 0:l=e,o.sheetRows&&o.sheetRows<=l.r&&(T=!0),m=yT(h=l.r),o["!row"]=l.r,(e.hidden||e.hpt||null!=e.level)&&(e.hpt&&(e.hpx=QS(e.hpt)),D[e.r]=e);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(u={t:e[2]},e[2]){case"n":u.v=e[1];break;case"s":g=lk[e[1]],u.v=g.t,u.r=g.r;break;case"b":u.v=!!e[1];break;case"e":u.v=e[1],!1!==o.cellText&&(u.w=ex[u.v]);break;case"str":u.t="s",u.v=e[1];break;case"is":u.t="s",u.v=e[1].t}if((d=s.CellXf[e[0].iStyleRef])&&hk(u,d.numFmtId,null,o,i,s),f=-1==e[0].c?f+1:e[0].c,o.dense?(y[h]||(y[h]=[]),y[h][f]=u):y[wT(f)+m]=u,o.cellFormula){for(I=!1,S=0;S<k.length;++S){var L=k[S];l.r>=L[0].s.r&&l.r<=L[0].e.r&&f>=L[0].s.c&&f<=L[0].e.c&&(u.F=ST(L[0]),I=!0)}!I&&e.length>3&&(u.f=e[3])}if(b.s.r>l.r&&(b.s.r=l.r),b.s.c>f&&(b.s.c=f),b.e.r<l.r&&(b.e.r=l.r),b.e.c<f&&(b.e.c=f),o.cellDates&&d&&"n"==u.t&&aw(Nb[d.numFmtId])){var M=Pb(u.v);M&&(u.t="d",u.v=new Date(M.y,M.m-1,M.d,M.H,M.M,M.S,M.u))}N&&("XLDAPR"==N.type&&(u.D=!0),N=void 0),R&&(R=void 0);break;case 1:case 12:if(!o.sheetStubs||E)break;u={t:"z",v:void 0},f=-1==e[0].c?f+1:e[0].c,o.dense?(y[h]||(y[h]=[]),y[h][f]=u):y[wT(f)+m]=u,b.s.r>l.r&&(b.s.r=l.r),b.s.c>f&&(b.s.c=f),b.e.r<l.r&&(b.e.r=l.r),b.e.c<f&&(b.e.c=f),N&&("XLDAPR"==N.type&&(u.D=!0),N=void 0),R&&(R=void 0);break;case 176:x.push(e);break;case 49:N=((o.xlmeta||{}).Cell||[])[e-1];break;case 494:var F=r["!id"][e.relId];for(F?(e.Target=F.Target,e.loc&&(e.Target+="#"+e.loc),e.Rel=F):""==e.relId&&(e.Target="#"+e.loc),h=e.rfx.s.r;h<=e.rfx.e.r;++h)for(f=e.rfx.s.c;f<=e.rfx.e.c;++f)o.dense?(y[h]||(y[h]=[]),y[h][f]||(y[h][f]={t:"z",v:void 0}),y[h][f].l=e):(p=TT({c:f,r:h}),y[p]||(y[p]={t:"z",v:void 0}),y[p].l=e);break;case 426:if(!o.cellFormula)break;k.push(e),(v=o.dense?y[h][f]:y[wT(f)+m]).f=YI(e[1],0,{r:l.r,c:f},C,o),v.F=ST(e[0]);break;case 427:if(!o.cellFormula)break;_[TT(e[0].s)]=e[1],(v=o.dense?y[h][f]:y[wT(f)+m]).f=YI(e[1],0,{r:l.r,c:f},C,o);break;case 60:if(!o.cellStyles)break;for(;e.e>=e.s;)O[e.e--]={width:e.w/256,hidden:!!(1&e.flags),level:e.level},P||(P=!0,KS(e.w/256)),qS(O[e.e+1]);break;case 161:y["!autofilter"]={ref:ST(e)};break;case 476:y["!margins"]=e;break;case 147:a.Sheets[n]||(a.Sheets[n]={}),e.name&&(a.Sheets[n].CodeName=e.name),(e.above||e.left)&&(y["!outline"]={above:e.above,left:e.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),e.RTL&&(a.Views[0].RTL=!0);break;case 485:case 64:case 1053:case 151:case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:E=!0;break;case 36:E=!1;break;case 37:w.push(A),E=!0;break;case 38:w.pop(),E=!1;break;default:if(t.T);else if(!E||o.WTF)throw new Error("Unexpected record 0x"+A.toString(16))}}),o),delete o.supbooks,delete o["!row"],!y["!ref"]&&(b.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(y["!ref"]=ST(c||b)),o.sheetRows&&y["!ref"]){var L=IT(y["!ref"]);o.sheetRows<=+L.e.r&&(L.e.r=o.sheetRows-1,L.e.r>b.e.r&&(L.e.r=b.e.r),L.e.r<L.s.r&&(L.s.r=L.e.r),L.e.c>b.e.c&&(L.e.c=b.e.c),L.e.c<L.s.c&&(L.s.c=L.e.c),y["!fullref"]=y["!ref"],y["!ref"]=ST(L))}return x.length>0&&(y["!merges"]=x),O.length>0&&(y["!cols"]=O),D.length>0&&(y["!rows"]=D),y}(e,r,n,a,i,s,o):xk(e,r,n,a,i,s,o)}function Wk(e,t,n,r,a,i,s,o){return".bin"===t.slice(-4)?function(e,t,n,r,a){if(!e)return e;r||(r={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s=[],o=!1;return dT(e,(function(e,r,c){switch(c){case 550:i["!rel"]=e;break;case 651:a.Sheets[n]||(a.Sheets[n]={}),e.name&&(a.Sheets[n].CodeName=e.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(c);break;case 38:s.pop();break;default:if(r.T>0)s.push(c);else if(r.T<0)s.pop();else if(!o||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),t),r["!id"][i["!rel"]]&&(i["!drawel"]=r["!id"][i["!rel"]]),i}(e,r,n,a,i):function(e,t,n,r,a){if(!e)return e;r||(r={"!id":{}});var i,s={"!type":"chart","!drawel":null,"!rel":""},o=e.match(wk);return o&&Sk(o[0],0,a,n),(i=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=i[1]),r["!id"][s["!rel"]]&&(s["!drawel"]=r["!id"][s["!rel"]]),s}(e,0,n,a,i)}function Gk(e,t,n,r){return".bin"===t.slice(-4)?function(e,t,n){var r={NumberFmt:[]};for(var a in Nb)r.NumberFmt[a]=Nb[a];r.CellXf=[],r.Fonts=[];var i=[],s=!1;return dT(e,(function(e,a,o){switch(o){case 44:r.NumberFmt[e[0]]=e[1],lw(e[1],e[0]);break;case 43:r.Fonts.push(e),null!=e.color.theme&&t&&t.themeElements&&t.themeElements.clrScheme&&(e.color.rgb=BS(t.themeElements.clrScheme[e.color.theme].rgb,e.color.tint||0));break;case 1025:case 45:case 46:case 48:case 507:case 572:case 475:case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 47:617==i[i.length-1]&&r.CellXf.push(e);break;case 35:s=!0;break;case 36:s=!1;break;case 37:i.push(o),s=!0;break;case 38:i.pop(),s=!1;break;default:if(a.T>0)i.push(o);else if(a.T<0)i.pop();else if(!s||n.WTF&&37!=i[i.length-1])throw new Error("Unexpected record 0x"+o.toString(16))}})),r}(e,n,r):tI(e,n,r)}function Kk(e,t,n){return".bin"===t.slice(-4)?function(e,t){var n=[],r=!1;return dT(e,(function(e,a,i){switch(i){case 159:n.Count=e[0],n.Unique=e[1];break;case 19:n.push(e);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(a.T,!r||t.WTF)throw new Error("Unexpected record 0x"+i.toString(16))}})),n}(e,n):function(e,t){var n=[],r="";if(!e)return n;var a=e.match(xS);if(a){r=a[2].replace(SS,"").split(IS);for(var i=0;i!=r.length;++i){var s=TS(r[i].trim(),t);null!=s&&(n[n.length]=s)}a=Zw(a[1]),n.Count=a.count,n.Unique=a.uniqueCount}return n}(e,n)}function qk(e,t,n){return".bin"===t.slice(-4)?function(e,t){var n=[],r=[],a={},i=!1;return dT(e,(function(e,s,o){switch(o){case 632:r.push(e);break;case 635:a=e;break;case 637:a.t=e.t,a.h=e.h,a.r=e.r;break;case 636:if(a.author=r[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,n.push(a);break;case 3072:case 37:case 38:break;case 35:i=!0;break;case 36:i=!1;break;default:if(s.T);else if(!i||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}})),n}(e,n):function(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var n=[],r=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach((function(e){if(""!==e&&""!==e.trim()){var t=e.match(/<(?:\w+:)?author[^>]*>(.*)/);t&&n.push(t[1])}}));var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach((function(e){if(""!==e&&""!==e.trim()){var a=e.match(/<(?:\w+:)?comment[^>]*>/);if(a){var i=Zw(a[0]),s={author:i.authorId&&n[i.authorId]||"sheetjsghost",ref:i.ref,guid:i.guid},o=ET(i.ref);if(!(t.sheetRows&&t.sheetRows<=o.r)){var c=e.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),l=!!c&&!!c[1]&&TS(c[1])||{r:"",t:"",h:""};s.r=l.r,"<t></t>"==l.r&&(l.t=l.h=""),s.t=(l.t||"").replace(/\r\n/g,"\n").replace(/\r/g,"\n"),t.cellHTML&&(s.h=l.h),r.push(s)}}}})),r}(e,n)}function Yk(e,t,n){return".bin"===t.slice(-4)?function(e){var t=[];return dT(e,(function(e,n,r){if(63===r)t.push(e);else if(!n.T)throw new Error("Unexpected record 0x"+r.toString(16))})),t}(e):function(e){var t=[];if(!e)return t;var n=1;return(e.match(Xw)||[]).forEach((function(e){var r=Zw(e);switch(r[0]){case"<?xml":case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete r[0],r.i?n=r.i:r.i=n,t.push(r)}})),t}(e)}function Xk(e,t,n,r){if(".bin"===n.slice(-4))return function(e,t,n,r){if(!e)return e;var a=r||{},i=!1;dT(e,(function(e,t,n){switch(n){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(t.T);else if(!i||a.WTF)throw new Error("Unexpected record 0x"+n.toString(16))}}),a)}(e,0,0,r)}function Qk(e,t,n){return".bin"===t.slice(-4)?function(e,t,n){var r={Types:[],Cell:[],Value:[]},a=n||{},i=[],s=!1,o=2;return dT(e,(function(e,t,n){switch(n){case 335:r.Types.push({name:e.name});break;case 51:e.forEach((function(e){1==o?r.Cell.push({type:r.Types[e[0]-1].name,index:e[1]}):0==o&&r.Value.push({type:r.Types[e[0]-1].name,index:e[1]})}));break;case 337:o=e?1:0;break;case 338:o=2;break;case 35:i.push(n),s=!0;break;case 36:i.pop(),s=!1;break;default:if(t.T);else if(!s||a.WTF&&35!=i[i.length-1])throw new Error("Unexpected record 0x"+n.toString(16))}})),r}(e,0,n):function(e,t,n){var r={Types:[],Cell:[],Value:[]};if(!e)return r;var a,i=!1,s=2;return e.replace(Xw,(function(e){var t=Zw(e);switch(eE(t[0])){case"<?xml":case"<metadata":case"</metadata>":case"<metadataTypes":case"</metadataTypes>":case"</metadataType>":case"</futureMetadata>":case"<bk>":case"</bk>":case"</rc>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<metadataType":r.Types.push({name:t.name});break;case"<futureMetadata":for(var o=0;o<r.Types.length;++o)r.Types[o].name==t.name&&(a=r.Types[o]);break;case"<rc":1==s?r.Cell.push({type:r.Types[t.t-1].name,index:+t.v}):0==s&&r.Value.push({type:r.Types[t.t-1].name,index:+t.v});break;case"<cellMetadata":s=1;break;case"</cellMetadata>":case"</valueMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+t.i);break;default:if(!i&&n.WTF)throw new Error("unrecognized "+t[0]+" in metadata")}return e})),r}(e,0,n)}var Jk,Zk=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,e_=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function t_(e,t){var n=e.split(/\s+/),r=[];if(t||(r[0]=n[0]),1===n.length)return r;var a,i,s,o=e.match(Zk);if(o)for(s=0;s!=o.length;++s)-1===(i=(a=o[s].match(e_))[1].indexOf(":"))?r[a[1]]=a[2].slice(1,a[2].length-1):r["xmlns:"===a[1].slice(0,6)?"xmlns"+a[1].slice(6):a[1].slice(i+1)]=a[2].slice(1,a[2].length-1);return r}function n_(e){var t={};if(1===e.split(/\s+/).length)return t;var n,r,a,i=e.match(Zk);if(i)for(a=0;a!=i.length;++a)-1===(r=(n=i[a].match(e_))[1].indexOf(":"))?t[n[1]]=n[2].slice(1,n[2].length-1):t["xmlns:"===n[1].slice(0,6)?"xmlns"+n[1].slice(6):n[1].slice(r+1)]=n[2].slice(1,n[2].length-1);return t}function r_(e,t,n,r){var a=r;switch((n[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=cE(r);break;case"i2":case"int":a=parseInt(r,10);break;case"r4":case"float":a=parseFloat(r);break;case"date":case"dateTime.tz":a=Cw(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+n[0])}e[rE(t)]=a}function a_(e,t,n){if("z"!==e.t){if(!n||!1!==n.cellText)try{"e"===e.t?e.w=e.w||ex[e.v]:"General"===t?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=Ub(e.v):e.w=Bb(e.v):e.w=function(e,t){var n=Jk[e]||rE(e);return"General"===n?Bb(t):cw(n,t)}(t||"General",e.v)}catch(i){if(n.WTF)throw i}try{var r=Jk[t]||t||"General";if(n.cellNF&&(e.z=r),n.cellDates&&"n"==e.t&&aw(r)){var a=Pb(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(n.WTF)throw i}}}function i_(e,t,n){if(n.cellStyles&&t.Interior){var r=t.Interior;r.Pattern&&(r.patternType=JS[r.Pattern]||r.Pattern)}e[t.ID]=t}function s_(e,t,n,r,a,i,s,o,c,l){var u="General",d=r.StyleID,h={};l=l||{};var f=[],p=0;for(void 0===d&&o&&(d=o.StyleID),void 0===d&&s&&(d=s.StyleID);void 0!==i[d]&&(i[d].nf&&(u=i[d].nf),i[d].Interior&&f.push(i[d].Interior),i[d].Parent);)d=i[d].Parent;switch(n.Type){case"Boolean":r.t="b",r.v=cE(e);break;case"String":r.t="s",r.r=oE(rE(e)),r.v=e.indexOf("<")>-1?rE(t||e).replace(/<.*?>/g,""):r.r;break;case"DateTime":"Z"!=e.slice(-1)&&(e+="Z"),r.v=(Cw(e)-new Date(Date.UTC(1899,11,30)))/864e5,r.v!==r.v?r.v=rE(e):r.v<60&&(r.v=r.v-1),u&&"General"!=u||(u="yyyy-mm-dd");case"Number":void 0===r.v&&(r.v=+e),r.t||(r.t="n");break;case"Error":r.t="e",r.v=tx[e],!1!==l.cellText&&(r.w=e);break;default:""==e&&""==t?r.t="z":(r.t="s",r.v=oE(t||e))}if(a_(r,u,l),!1!==l.cellFormula)if(r.Formula){var g=rE(r.Formula);61==g.charCodeAt(0)&&(g=g.slice(1)),r.f=yI(g,a),delete r.Formula,"RC"==r.ArrayRange?r.F=yI("RC:RC",a):r.ArrayRange&&(r.F=yI(r.ArrayRange,a),c.push([IT(r.F),r.F]))}else for(p=0;p<c.length;++p)a.r>=c[p][0].s.r&&a.r<=c[p][0].e.r&&a.c>=c[p][0].s.c&&a.c<=c[p][0].e.c&&(r.F=c[p][1]);l.cellStyles&&(f.forEach((function(e){!h.patternType&&e.patternType&&(h.patternType=e.patternType)})),r.s=h),void 0!==r.StyleID&&(r.ixfe=r.StyleID)}function o_(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),e.v=e.w=e.ixfe=void 0}function c_(e,t){var n=t||{};uw();var r=ib(SE(e));"binary"!=n.type&&"array"!=n.type&&"base64"!=n.type||(r="undefined"!==typeof ab?ab.utils.decode(65001,nb(r)):fE(r));var a,i=r.slice(0,1024).toLowerCase(),s=!1;if((1023&(i=i.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&i.indexOf(","),1023&i.indexOf(";"))){var o=Nw(n);return o.type="string",gS.to_workbook(r,o)}if(-1==i.indexOf("<?xml")&&["html","table","head","meta","script","style","div"].forEach((function(e){i.indexOf("<"+e)>=0&&(s=!0)})),s)return function(e,t){var n=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!n||0==n.length)throw new Error("Invalid HTML: could not find <table>");if(1==n.length)return CT(T_(n[0],t),t);var r={SheetNames:[],Sheets:{}};return n.forEach((function(e,n){wC(r,T_(e,t),"Sheet"+(n+1))})),r}(r,n);Jk={"General Number":"General","General Date":Nb[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Nb[15],"Short Date":Nb[14],"Long Time":Nb[19],"Medium Time":Nb[18],"Short Time":Nb[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Nb[2],Standard:Nb[4],Percent:Nb[10],Scientific:Nb[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,l=[];var u,d={},h=[],f=n.dense?[]:{},p="",g={},m={},v=t_('<Data ss:Type="String">'),y=0,b=0,w=0,E={s:{r:2e6,c:2e6},e:{r:0,c:0}},T={},x={},S="",I=0,k=[],_={},C={},A=0,N=[],R=[],O={},D=[],P=!1,L=[],M=[],F={},z=0,j=0,U={Sheets:[],WBProps:{date1904:!1}},B={};IE.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/gm,"");for(var V="";a=IE.exec(r);)switch(a[3]=(V=a[3]).toLowerCase()){case"data":if("data"==V){if("/"===a[1]){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else"/"!==a[0].charAt(a[0].length-2)&&l.push([a[3],!0]);break}if(l[l.length-1][1])break;"/"===a[1]?s_(r.slice(y,a.index),S,v,"comment"==l[l.length-1][0]?O:g,{c:b,r:w},T,D[b],m,L,n):(S="",v=t_(a[0]),y=a.index+a[0].length);break;case"cell":if("/"===a[1])if(R.length>0&&(g.c=R),(!n.sheetRows||n.sheetRows>w)&&void 0!==g.v&&(n.dense?(f[w]||(f[w]=[]),f[w][b]=g):f[wT(b)+yT(w)]=g),g.HRef&&(g.l={Target:rE(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(z=b+(0|parseInt(g.MergeAcross,10)),j=w+(0|parseInt(g.MergeDown,10)),k.push({s:{c:b,r:w},e:{c:z,r:j}})),n.sheetStubs)if(g.MergeAcross||g.MergeDown){for(var $=b;$<=z;++$)for(var H=w;H<=j;++H)($>b||H>w)&&(n.dense?(f[H]||(f[H]=[]),f[H][$]={t:"z"}):f[wT($)+yT(H)]={t:"z"});b=z+1}else++b;else g.MergeAcross?b=z+1:++b;else(g=n_(a[0])).Index&&(b=+g.Index-1),b<E.s.c&&(E.s.c=b),b>E.e.c&&(E.e.c=b),"/>"===a[0].slice(-2)&&++b,R=[];break;case"row":"/"===a[1]||"/>"===a[0].slice(-2)?(w<E.s.r&&(E.s.r=w),w>E.e.r&&(E.e.r=w),"/>"===a[0].slice(-2)&&(m=t_(a[0])).Index&&(w=+m.Index-1),b=0,++w):((m=t_(a[0])).Index&&(w=+m.Index-1),F={},("0"==m.AutoFitHeight||m.Height)&&(F.hpx=parseInt(m.Height,10),F.hpt=XS(F.hpx),M[w]=F),"1"==m.Hidden&&(F.hidden=!0,M[w]=F));break;case"worksheet":if("/"===a[1]){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"));h.push(p),E.s.r<=E.e.r&&E.s.c<=E.e.c&&(f["!ref"]=ST(E),n.sheetRows&&n.sheetRows<=E.e.r&&(f["!fullref"]=f["!ref"],E.e.r=n.sheetRows-1,f["!ref"]=ST(E))),k.length&&(f["!merges"]=k),D.length>0&&(f["!cols"]=D),M.length>0&&(f["!rows"]=M),d[p]=f}else E={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=b=0,l.push([a[3],!1]),c=t_(a[0]),p=rE(c.Name),f=n.dense?[]:{},k=[],L=[],M=[],B={name:p,Hidden:0},U.Sheets.push(B);break;case"table":if("/"===a[1]){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else{if("/>"==a[0].slice(-2))break;l.push([a[3],!1]),D=[],P=!1}break;case"style":"/"===a[1]?i_(T,x,n):x=t_(a[0]);break;case"numberformat":x.nf=rE(t_(a[0]).Format||"General"),Jk[x.nf]&&(x.nf=Jk[x.nf]);for(var W=0;392!=W&&Nb[W]!=x.nf;++W);if(392==W)for(W=57;392!=W;++W)if(null==Nb[W]){lw(x.nf,W);break}break;case"column":if("table"!==l[l.length-1][0])break;if((u=t_(a[0])).Hidden&&(u.hidden=!0,delete u.Hidden),u.Width&&(u.wpx=parseInt(u.Width,10)),!P&&u.wpx>10){P=!0,VS=6;for(var G=0;G<D.length;++G)D[G]&&qS(D[G])}P&&qS(u),D[u.Index-1||D.length]=u;for(var K=0;K<+u.Span;++K)D[D.length]=Nw(u);break;case"namedrange":if("/"===a[1])break;U.Names||(U.Names=[]);var q=Zw(a[0]),Y={Name:q.Name,Ref:yI(q.RefersTo.slice(1),{r:0,c:0})};U.Sheets.length>0&&(Y.Sheet=U.Sheets.length-1),U.Names.push(Y);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":case"protection":case"paragraphs":case"name":case"pixelsperinch":case"null":break;case"font":if("/>"===a[0].slice(-2))break;"/"===a[1]?S+=r.slice(I,a.index):I=a.index+a[0].length;break;case"interior":if(!n.cellStyles)break;x.Interior=t_(a[0]);break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if("/>"===a[0].slice(-2))break;"/"===a[1]?px(_,V,r.slice(A,a.index)):A=a.index+a[0].length;break;case"styles":case"workbook":if("/"===a[1]){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else l.push([a[3],!1]);break;case"comment":if("/"===a[1]){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"));o_(O),R.push(O)}else l.push([a[3],!1]),O={a:(c=t_(a[0])).Author};break;case"autofilter":if("/"===a[1]){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else if("/"!==a[0].charAt(a[0].length-2)){var X=t_(a[0]);f["!autofilter"]={ref:yI(X.Range).replace(/\$/g,"")},l.push([a[3],!0])}break;case"datavalidation":if("/"===a[1]){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else"/"!==a[0].charAt(a[0].length-2)&&l.push([a[3],!0]);break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if("/"===a[1]){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else"/"!==a[0].charAt(a[0].length-2)&&l.push([a[3],!0]);break;default:if(0==l.length&&"document"==a[3])return L_(r,n);if(0==l.length&&"uof"==a[3])return L_(r,n);var Q=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(a[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:Q=!1}break;case"componentoptions":switch(a[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:Q=!1}break;case"excelworkbook":switch(a[3]){case"date1904":U.WBProps.date1904=!0;break;case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:Q=!1}break;case"workbookoptions":switch(a[3]){case"owcversion":case"height":case"width":break;default:Q=!1}break;case"worksheetoptions":switch(a[3]){case"visible":if("/>"===a[0].slice(-2));else if("/"===a[1])switch(r.slice(A,a.index)){case"SheetHidden":B.Hidden=1;break;case"SheetVeryHidden":B.Hidden=2}else A=a.index+a[0].length;break;case"header":f["!margins"]||dk(f["!margins"]={},"xlml"),isNaN(+Zw(a[0]).Margin)||(f["!margins"].header=+Zw(a[0]).Margin);break;case"footer":f["!margins"]||dk(f["!margins"]={},"xlml"),isNaN(+Zw(a[0]).Margin)||(f["!margins"].footer=+Zw(a[0]).Margin);break;case"pagemargins":var J=Zw(a[0]);f["!margins"]||dk(f["!margins"]={},"xlml"),isNaN(+J.Top)||(f["!margins"].top=+J.Top),isNaN(+J.Left)||(f["!margins"].left=+J.Left),isNaN(+J.Right)||(f["!margins"].right=+J.Right),isNaN(+J.Bottom)||(f["!margins"].bottom=+J.Bottom);break;case"displayrighttoleft":U.Views||(U.Views=[]),U.Views[0]||(U.Views[0]={}),U.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;default:Q=!1}break;case"pivottable":case"pivotcache":switch(a[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:Q=!1}break;case"pagebreaks":switch(a[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:Q=!1}break;case"autofilter":switch(a[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:Q=!1}break;case"querytable":switch(a[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:Q=!1}break;case"datavalidation":switch(a[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:Q=!1}break;case"sorting":case"conditionalformatting":switch(a[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:Q=!1}break;case"mapinfo":case"schema":case"data":switch(a[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:Q=!1}break;case"smarttags":break;default:Q=!1}if(Q)break;if(a[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+a[3]+"|"+l.join("|");if("customdocumentproperties"===l[l.length-1][0]){if("/>"===a[0].slice(-2))break;"/"===a[1]?r_(C,V,N,r.slice(A,a.index)):(N=a,A=a.index+a[0].length);break}if(n.WTF)throw"Unrecognized tag: "+a[3]+"|"+l.join("|")}var Z={};return n.bookSheets||n.bookProps||(Z.Sheets=d),Z.SheetNames=h,Z.Workbook=U,Z.SSF=Nw(Nb),Z.Props=_,Z.Custprops=C,Z}function l_(e,t){switch(nC(t=t||{}),t.type||"base64"){case"base64":return c_(ub(e),t);case"binary":case"buffer":case"file":return c_(e,t);case"array":return c_(mb(e),t)}}function u_(e){var t={},n=e.content;if(n.l=28,t.AnsiUserType=n.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=function(e){return WT(e,1)}(n),n.length-n.l<=4)return t;var r=n.read_shift(4);return 0==r||r>40?t:(n.l-=4,t.Reserved1=n.read_shift(0,"lpstr-ansi"),n.length-n.l<=4||1907505652!==(r=n.read_shift(4))?t:(t.UnicodeClipboardFormat=function(e){return WT(e,2)}(n),0==(r=n.read_shift(4))||r>40?t:(n.l-=4,void(t.Reserved2=n.read_shift(0,"lpwstr")))))}var d_=[60,1084,2066,2165,2175];function h_(e,t,n,r,a){var i=r,s=[],o=n.slice(n.l,n.l+i);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:a.enc.insitu(o)}s.push(o),n.l+=i;for(var c=QE(n,n.l),l=w_[c],u=0;null!=l&&d_.indexOf(c)>-1;)i=QE(n,n.l+2),u=n.l+4,2066==c?u+=4:2165!=c&&2175!=c||(u+=12),o=n.slice(u,n.l+4+i),s.push(o),n.l+=4+i,l=w_[c=QE(n,n.l)];var d=yb(s);cT(d,0);var h=0;d.lens=[];for(var f=0;f<s.length;++f)d.lens.push(h),h+=s[f].length;if(d.length<r)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+d.length+" < "+r;return t.f(d,d.length,a)}function f_(e,t,n){if("z"!==e.t&&e.XF){var r=0;try{r=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Nb[r])}catch(i){if(t.WTF)throw i}if(!t||!1!==t.cellText)try{"e"===e.t?e.w=e.w||ex[e.v]:0===r||"General"==r?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=Ub(e.v):e.w=Bb(e.v):e.w=cw(r,e.v,{date1904:!!n,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&r&&"n"==e.t&&aw(Nb[r]||String(r))){var a=Pb(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function p_(e,t,n){return{v:e,ixfe:t,t:n}}function g_(e,t){var n={opts:{}},r={};var a,i,s,o,c,l,u,d,h=t.dense?[]:{},f={},p={},g=null,m=[],v="",y={},b="",w={},E=[],T=[],x=[],S={Sheets:[],WBProps:{date1904:!1},Views:[{}]},I={},k=function(e){return e<8?ZT[e]:e<64&&x[e-8]||ZT[e]},_=function(e,t,n){if(!(F>1)&&!(n.sheetRows&&e.r>=n.sheetRows)){if(n.cellStyles&&t.XF&&t.XF.data&&function(e,t,n){var r,a=t.XF.data;a&&a.patternType&&n&&n.cellStyles&&(t.s={},t.s.patternType=a.patternType,(r=US(k(a.icvFore)))&&(t.s.fgColor={rgb:r}),(r=US(k(a.icvBack)))&&(t.s.bgColor={rgb:r}))}(0,t,n),delete t.ixfe,delete t.XF,a=e,b=TT(e),p&&p.s&&p.e||(p={s:{r:0,c:0},e:{r:0,c:0}}),e.r<p.s.r&&(p.s.r=e.r),e.c<p.s.c&&(p.s.c=e.c),e.r+1>p.e.r&&(p.e.r=e.r+1),e.c+1>p.e.c&&(p.e.c=e.c+1),n.cellFormula&&t.f)for(var r=0;r<E.length;++r)if(!(E[r][0].s.c>e.c||E[r][0].s.r>e.r)&&!(E[r][0].e.c<e.c||E[r][0].e.r<e.r)){t.F=ST(E[r][0]),E[r][0].s.c==e.c&&E[r][0].s.r==e.r||delete t.f,t.f&&(t.f=""+YI(E[r][1],0,e,P,C));break}n.dense?(h[e.r]||(h[e.r]=[]),h[e.r][e.c]=t):h[b]=t}},C={enc:!1,sbcch:0,snames:[],sharedf:w,arrayf:E,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(C.password=t.password);var A=[],N=[],R=[],O=[],D=!1,P=[];P.SheetNames=C.snames,P.sharedf=C.sharedf,P.arrayf=C.arrayf,P.names=[],P.XTI=[];var L,M=0,F=0,z=0,j=[],U=[];C.codepage=1200,eb(1200);for(var B=!1;e.l<e.length-1;){var V=e.l,$=e.read_shift(2);if(0===$&&10===M)break;var H=e.l===e.length?0:e.read_shift(2),W=w_[$];if(W&&W.f){if(t.bookSheets&&133===M&&133!==$)break;if(M=$,2===W.r||12==W.r){var G=e.read_shift(2);if(H-=2,!C.enc&&G!==$&&((255&G)<<8|G>>8)!==$)throw new Error("rt mismatch: "+G+"!="+$);12==W.r&&(e.l+=10,H-=10)}var K={};if(K=10===$?W.f(e,H,C):h_($,W,e,H,C),0==F&&-1===[9,521,1033,2057].indexOf(M))continue;switch($){case 34:n.opts.Date1904=S.WBProps.date1904=K;break;case 134:n.opts.WriteProtect=!0;break;case 47:if(C.enc||(e.l=0),C.enc=K,!t.password)throw new Error("File is password-protected");if(null==K.valid)throw new Error("Encryption scheme unsupported");if(!K.valid)throw new Error("Password is incorrect");break;case 92:C.lastuser=K;break;case 66:var q=Number(K);switch(q){case 21010:q=1200;break;case 32768:q=1e4;break;case 32769:q=1252}eb(C.codepage=q),B=!0;break;case 317:C.rrtabid=K;break;case 25:C.winlocked=K;break;case 439:n.opts.RefreshAll=K;break;case 12:n.opts.CalcCount=K;break;case 16:n.opts.CalcDelta=K;break;case 17:n.opts.CalcIter=K;break;case 13:n.opts.CalcMode=K;break;case 14:n.opts.CalcPrecision=K;break;case 95:n.opts.CalcSaveRecalc=K;break;case 15:C.CalcRefMode=K;break;case 2211:n.opts.FullCalc=K;break;case 129:K.fDialog&&(h["!type"]="dialog"),K.fBelow||((h["!outline"]||(h["!outline"]={})).above=!0),K.fRight||((h["!outline"]||(h["!outline"]={})).left=!0);break;case 224:T.push(K);break;case 430:P.push([K]),P[P.length-1].XTI=[];break;case 35:case 547:P[P.length-1].push(K);break;case 24:case 536:L={Name:K.Name,Ref:YI(K.rgce,0,null,P,C)},K.itab>0&&(L.Sheet=K.itab-1),P.names.push(L),P[0]||(P[0]=[],P[0].XTI=[]),P[P.length-1].push(K),"_xlnm._FilterDatabase"==K.Name&&K.itab>0&&K.rgce&&K.rgce[0]&&K.rgce[0][0]&&"PtgArea3d"==K.rgce[0][0][0]&&(U[K.itab-1]={ref:ST(K.rgce[0][0][1][2])});break;case 22:C.ExternCount=K;break;case 23:0==P.length&&(P[0]=[],P[0].XTI=[]),P[P.length-1].XTI=P[P.length-1].XTI.concat(K),P.XTI=P.XTI.concat(K);break;case 2196:if(C.biff<8)break;null!=L&&(L.Comment=K[1]);break;case 18:h["!protect"]=K;break;case 19:0!==K&&C.WTF&&console.error("Password verifier: "+K);break;case 133:f[K.pos]=K,C.snames.push(K.name);break;case 10:if(--F)break;if(p.e){if(p.e.r>0&&p.e.c>0){if(p.e.r--,p.e.c--,h["!ref"]=ST(p),t.sheetRows&&t.sheetRows<=p.e.r){var Y=p.e.r;p.e.r=t.sheetRows-1,h["!fullref"]=h["!ref"],h["!ref"]=ST(p),p.e.r=Y}p.e.r++,p.e.c++}A.length>0&&(h["!merges"]=A),N.length>0&&(h["!objects"]=N),R.length>0&&(h["!cols"]=R),O.length>0&&(h["!rows"]=O),S.Sheets.push(I)}""===v?y=h:r[v]=h,h=t.dense?[]:{};break;case 9:case 521:case 1033:case 2057:if(8===C.biff&&(C.biff={9:2,521:3,1033:4}[$]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[K.BIFFVer]||8),C.biffguess=0==K.BIFFVer,0==K.BIFFVer&&4096==K.dt&&(C.biff=5,B=!0,eb(C.codepage=28591)),8==C.biff&&0==K.BIFFVer&&16==K.dt&&(C.biff=2),F++)break;if(h=t.dense?[]:{},C.biff<8&&!B&&(B=!0,eb(C.codepage=t.codepage||1252)),C.biff<5||0==K.BIFFVer&&4096==K.dt){""===v&&(v="Sheet1"),p={s:{r:0,c:0},e:{r:0,c:0}};var X={pos:e.l-H,name:v};f[X.pos]=X,C.snames.push(v)}else v=(f[V]||{name:""}).name;32==K.dt&&(h["!type"]="chart"),64==K.dt&&(h["!type"]="macro"),A=[],N=[],C.arrayf=E=[],R=[],O=[],D=!1,I={Hidden:(f[V]||{hs:0}).hs,name:v};break;case 515:case 3:case 2:"chart"==h["!type"]&&(t.dense?(h[K.r]||[])[K.c]:h[TT({c:K.c,r:K.r})])&&++K.c,l={ixfe:K.ixfe,XF:T[K.ixfe]||{},v:K.val,t:"n"},z>0&&(l.z=j[l.ixfe>>8&63]),f_(l,t,n.opts.Date1904),_({c:K.c,r:K.r},l,t);break;case 5:case 517:l={ixfe:K.ixfe,XF:T[K.ixfe],v:K.val,t:K.t},z>0&&(l.z=j[l.ixfe>>8&63]),f_(l,t,n.opts.Date1904),_({c:K.c,r:K.r},l,t);break;case 638:l={ixfe:K.ixfe,XF:T[K.ixfe],v:K.rknum,t:"n"},z>0&&(l.z=j[l.ixfe>>8&63]),f_(l,t,n.opts.Date1904),_({c:K.c,r:K.r},l,t);break;case 189:for(var Q=K.c;Q<=K.C;++Q){var J=K.rkrec[Q-K.c][0];l={ixfe:J,XF:T[J],v:K.rkrec[Q-K.c][1],t:"n"},z>0&&(l.z=j[l.ixfe>>8&63]),f_(l,t,n.opts.Date1904),_({c:Q,r:K.r},l,t)}break;case 6:case 518:case 1030:if("String"==K.val){g=K;break}if((l=p_(K.val,K.cell.ixfe,K.tt)).XF=T[l.ixfe],t.cellFormula){var Z=K.formula;if(Z&&Z[0]&&Z[0][0]&&"PtgExp"==Z[0][0][0]){var ee=Z[0][0][1][0],te=Z[0][0][1][1],ne=TT({r:ee,c:te});w[ne]?l.f=""+YI(K.formula,0,K.cell,P,C):l.F=((t.dense?(h[ee]||[])[te]:h[ne])||{}).F}else l.f=""+YI(K.formula,0,K.cell,P,C)}z>0&&(l.z=j[l.ixfe>>8&63]),f_(l,t,n.opts.Date1904),_(K.cell,l,t),g=K;break;case 7:case 519:if(!g)throw new Error("String record expects Formula");g.val=K,(l=p_(K,g.cell.ixfe,"s")).XF=T[l.ixfe],t.cellFormula&&(l.f=""+YI(g.formula,0,g.cell,P,C)),z>0&&(l.z=j[l.ixfe>>8&63]),f_(l,t,n.opts.Date1904),_(g.cell,l,t),g=null;break;case 33:case 545:E.push(K);var re=TT(K[0].s);if(i=t.dense?(h[K[0].s.r]||[])[K[0].s.c]:h[re],t.cellFormula&&i){if(!g)break;if(!re||!i)break;i.f=""+YI(K[1],0,K[0],P,C),i.F=ST(K[0])}break;case 1212:if(!t.cellFormula)break;if(b){if(!g)break;w[TT(g.cell)]=K[0],((i=t.dense?(h[g.cell.r]||[])[g.cell.c]:h[TT(g.cell)])||{}).f=""+YI(K[0],0,a,P,C)}break;case 253:l=p_(m[K.isst].t,K.ixfe,"s"),m[K.isst].h&&(l.h=m[K.isst].h),l.XF=T[l.ixfe],z>0&&(l.z=j[l.ixfe>>8&63]),f_(l,t,n.opts.Date1904),_({c:K.c,r:K.r},l,t);break;case 513:t.sheetStubs&&(l={ixfe:K.ixfe,XF:T[K.ixfe],t:"z"},z>0&&(l.z=j[l.ixfe>>8&63]),f_(l,t,n.opts.Date1904),_({c:K.c,r:K.r},l,t));break;case 190:if(t.sheetStubs)for(var ae=K.c;ae<=K.C;++ae){var ie=K.ixfe[ae-K.c];l={ixfe:ie,XF:T[ie],t:"z"},z>0&&(l.z=j[l.ixfe>>8&63]),f_(l,t,n.opts.Date1904),_({c:ae,r:K.r},l,t)}break;case 214:case 516:case 4:(l=p_(K.val,K.ixfe,"s")).XF=T[l.ixfe],z>0&&(l.z=j[l.ixfe>>8&63]),f_(l,t,n.opts.Date1904),_({c:K.c,r:K.r},l,t);break;case 0:case 512:1===F&&(p=K);break;case 252:m=K;break;case 1054:if(4==C.biff){j[z++]=K[1];for(var se=0;se<z+163&&Nb[se]!=K[1];++se);se>=163&&lw(K[1],z+163)}else lw(K[1],K[0]);break;case 30:j[z++]=K;for(var oe=0;oe<z+163&&Nb[oe]!=K;++oe);oe>=163&&lw(K,z+163);break;case 229:A=A.concat(K);break;case 93:N[K.cmo[0]]=C.lastobj=K;break;case 438:C.lastobj.TxO=K;break;case 127:C.lastobj.ImData=K;break;case 440:for(c=K[0].s.r;c<=K[0].e.r;++c)for(o=K[0].s.c;o<=K[0].e.c;++o)(i=t.dense?(h[c]||[])[o]:h[TT({c:o,r:c})])&&(i.l=K[1]);break;case 2048:for(c=K[0].s.r;c<=K[0].e.r;++c)for(o=K[0].s.c;o<=K[0].e.c;++o)(i=t.dense?(h[c]||[])[o]:h[TT({c:o,r:c})])&&i.l&&(i.l.Tooltip=K[1]);break;case 28:if(C.biff<=5&&C.biff>=2)break;i=t.dense?(h[K[0].r]||[])[K[0].c]:h[TT(K[0])];var ce=N[K[2]];i||(t.dense?(h[K[0].r]||(h[K[0].r]=[]),i=h[K[0].r][K[0].c]={t:"z"}):i=h[TT(K[0])]={t:"z"},p.e.r=Math.max(p.e.r,K[0].r),p.s.r=Math.min(p.s.r,K[0].r),p.e.c=Math.max(p.e.c,K[0].c),p.s.c=Math.min(p.s.c,K[0].c)),i.c||(i.c=[]),s={a:K[1],t:ce.TxO.t},i.c.push(s);break;case 2173:T[K.ixfe],K.ext.forEach((function(e){e[0]}));break;case 125:if(!C.cellStyles)break;for(;K.e>=K.s;)R[K.e--]={width:K.w/256,level:K.level||0,hidden:!!(1&K.flags)},D||(D=!0,KS(K.w/256)),qS(R[K.e+1]);break;case 520:var le={};null!=K.level&&(O[K.r]=le,le.level=K.level),K.hidden&&(O[K.r]=le,le.hidden=!0),K.hpt&&(O[K.r]=le,le.hpt=K.hpt,le.hpx=QS(K.hpt));break;case 38:case 39:case 40:case 41:h["!margins"]||dk(h["!margins"]={}),h["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[$]]=K;break;case 161:h["!margins"]||dk(h["!margins"]={}),h["!margins"].header=K.header,h["!margins"].footer=K.footer;break;case 574:K.RTL&&(S.Views[0].RTL=!0);break;case 146:x=K;break;case 2198:d=K;break;case 140:u=K;break;case 442:v?I.CodeName=K||I.name:S.WBProps.CodeName=K||"ThisWorkbook"}}else W||console.error("Missing Info for XLS Record 0x"+$.toString(16)),e.l+=H}return n.SheetNames=mw(f).sort((function(e,t){return Number(e)-Number(t)})).map((function(e){return f[e].name})),t.bookSheets||(n.Sheets=r),!n.SheetNames.length&&y["!ref"]?(n.SheetNames.push("Sheet1"),n.Sheets&&(n.Sheets.Sheet1=y)):n.Preamble=y,n.Sheets&&U.forEach((function(e,t){n.Sheets[n.SheetNames[t]]["!autofilter"]=e})),n.Strings=m,n.SSF=Nw(Nb),C.enc&&(n.Encryption=C.enc),d&&(n.Themes=d),n.Metadata={},void 0!==u&&(n.Metadata.Country=u),P.names.length>0&&(S.Names=P.names),n.Workbook=S,n}var m_="e0859ff2f94f6810ab9108002b27b3d9",v_="02d5cdd59c2e1b10939708002b2cf9ae";function y_(e,t){var n,r,a,i;if(t||(t={}),nC(t),tb(),t.codepage&&Zy(t.codepage),e.FullPaths){if(pw.find(e,"/encryption"))throw new Error("File is password-protected");n=pw.find(e,"!CompObj"),r=pw.find(e,"/Workbook")||pw.find(e,"/Book")}else{switch(t.type){case"base64":e=gb(ub(e));break;case"binary":e=gb(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e))}cT(e,0),r={content:e}}if(n&&u_(n),t.bookProps&&!t.bookSheets)a={};else{var s=db?"buffer":"array";if(r&&r.content)a=g_(r.content,t);else if((i=pw.find(e,"PerfectOffice_MAIN"))&&i.content)a=mS.to_workbook(i.content,(t.type=s,t));else{if(!(i=pw.find(e,"NativeContent_MAIN"))||!i.content)throw(i=pw.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");a=mS.to_workbook(i.content,(t.type=s,t))}t.bookVBA&&e.FullPaths&&pw.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=function(e){var t=pw.utils.cfb_new({root:"R"});return e.FullPaths.forEach((function(n,r){if("/"!==n.slice(-1)&&n.match(/_VBA_PROJECT_CUR/)){var a=n.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");pw.utils.cfb_add(t,a,e.FileIndex[r].content)}})),pw.write(t)}(e))}var o={};return e.FullPaths&&function(e,t,n){var r=pw.find(e,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var a=Ix(r,qT,v_);for(var i in a)t[i]=a[i]}catch(l){if(n.WTF)throw l}var s=pw.find(e,"/!SummaryInformation");if(s&&s.size>0)try{var o=Ix(s,YT,m_);for(var c in o)null==t[c]&&(t[c]=o[c])}catch(l){if(n.WTF)throw l}t.HeadingPairs&&t.TitlesOfParts&&(ux(t.HeadingPairs,t.TitlesOfParts,t,n),delete t.HeadingPairs,delete t.TitlesOfParts)}(e,o,t),a.Props=a.Custprops=o,t.bookFiles&&(a.cfb=e),a}var b_={0:{f:function(e,t){var n={},r=e.l+t;n.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=r,7&i&&(n.level=7&i),16&i&&(n.hidden=!0),32&i&&(n.hpt=a/20),n}},1:{f:function(e){return[LT(e)]}},2:{f:function(e){return[LT(e),BT(e),"n"]}},3:{f:function(e){return[LT(e),e.read_shift(1),"e"]}},4:{f:function(e){return[LT(e),e.read_shift(1),"b"]}},5:{f:function(e){return[LT(e),HT(e),"n"]}},6:{f:function(e){return[LT(e),RT(e),"str"]}},7:{f:function(e){return[LT(e),e.read_shift(4),"s"]}},8:{f:function(e,t,n){var r=e.l+t,a=LT(e);a.r=n["!row"];var i=[a,RT(e),"str"];if(n.cellFormula){e.l+=2;var s=tk(e,r-e.l,n);i[3]=YI(s,0,a,n.supbooks,n)}else e.l=r;return i}},9:{f:function(e,t,n){var r=e.l+t,a=LT(e);a.r=n["!row"];var i=[a,HT(e),"n"];if(n.cellFormula){e.l+=2;var s=tk(e,r-e.l,n);i[3]=YI(s,0,a,n.supbooks,n)}else e.l=r;return i}},10:{f:function(e,t,n){var r=e.l+t,a=LT(e);a.r=n["!row"];var i=[a,e.read_shift(1),"b"];if(n.cellFormula){e.l+=2;var s=tk(e,r-e.l,n);i[3]=YI(s,0,a,n.supbooks,n)}else e.l=r;return i}},11:{f:function(e,t,n){var r=e.l+t,a=LT(e);a.r=n["!row"];var i=[a,e.read_shift(1),"e"];if(n.cellFormula){e.l+=2;var s=tk(e,r-e.l,n);i[3]=YI(s,0,a,n.supbooks,n)}else e.l=r;return i}},12:{f:function(e){return[MT(e)]}},13:{f:function(e){return[MT(e),BT(e),"n"]}},14:{f:function(e){return[MT(e),e.read_shift(1),"e"]}},15:{f:function(e){return[MT(e),e.read_shift(1),"b"]}},16:{f:Ck},17:{f:function(e){return[MT(e),RT(e),"str"]}},18:{f:function(e){return[MT(e),e.read_shift(4),"s"]}},19:{f:DT},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(e,t,n){var r=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=jT(e),s=nk(e,0,n),o=zT(e);e.l=r;var c={Name:i,Ptg:s};return a<268435455&&(c.Sheet=a),o&&(c.Comment=o),c}},40:{},42:{},43:{f:function(e,t,n){var r={};r.sz=e.read_shift(2)/20;var a=function(e){var t=e.read_shift(1);return e.l++,{fBold:1&t,fItalic:2&t,fUnderline:4&t,fStrikeout:8&t,fOutline:16&t,fShadow:32&t,fCondense:64&t,fExtend:128&t}}(e);switch(a.fItalic&&(r.italic=1),a.fCondense&&(r.condense=1),a.fExtend&&(r.extend=1),a.fShadow&&(r.shadow=1),a.fOutline&&(r.outline=1),a.fStrikeout&&(r.strike=1),700===e.read_shift(2)&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript"}var i=e.read_shift(1);0!=i&&(r.underline=i);var s=e.read_shift(1);s>0&&(r.family=s);var o=e.read_shift(1);switch(o>0&&(r.charset=o),e.l++,r.color=function(e){var t={},n=e.read_shift(1)>>>1,r=e.read_shift(1),a=e.read_shift(2,"i"),i=e.read_shift(1),s=e.read_shift(1),o=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=r;var c=ZT[r];c&&(t.rgb=US(c));break;case 2:t.rgb=US([i,s,o]);break;case 3:t.theme=r}return 0!=a&&(t.tint=a>0?a/32767:a/32768),t}(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor"}return r.name=RT(e),r}},44:{f:function(e,t){return[e.read_shift(2),RT(e)]}},45:{f:nI},46:{f:rI},47:{f:function(e,t){var n=e.l+t,r=e.read_shift(2),a=e.read_shift(2);return e.l=n,{ixfe:r,numFmtId:a}}},48:{},49:{f:function(e){return e.read_shift(4,"i")}},50:{},51:{f:function(e){for(var t=[],n=e.read_shift(4);n-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:sS},62:{f:function(e){return[LT(e),DT(e),"is"]}},63:{f:function(e){var t={};t.i=e.read_shift(4);var n={};n.r=e.read_shift(4),n.c=e.read_shift(4),t.r=TT(n);var r=e.read_shift(1);return 2&r&&(t.l="1"),8&r&&(t.a="1"),t}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:lT,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(e){var t=e.read_shift(2);return e.l+=28,{RTL:32&t}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(e,t){var n={},r=e[e.l];return++e.l,n.above=!(64&r),n.left=!(128&r),e.l+=18,n.name=FT(e,t-19),n}},148:{f:_k,p:16},151:{f:function(){}},152:{},153:{f:function(e,t){var n={},r=e.read_shift(4);n.defaultThemeVersion=e.read_shift(4);var a=t>8?RT(e):"";return a.length>0&&(n.CodeName=a),n.autoCompressPictures=!!(65536&r),n.backupFile=!!(64&r),n.checkCompatibility=!!(4096&r),n.date1904=!!(1&r),n.filterPrivacy=!!(8&r),n.hidePivotFieldList=!!(1024&r),n.promptedSolutions=!!(16&r),n.publishItems=!!(2048&r),n.refreshAllConnections=!!(262144&r),n.saveExternalLinkValues=!!(128&r),n.showBorderUnselectedTables=!!(4&r),n.showInkAnnotation=!!(32&r),n.showObjects=["all","placeholders","none"][r>>13&3],n.showPivotChartFilter=!!(32768&r),n.updateLinks=["userSet","never","always"][r>>8&3],n}},154:{},155:{},156:{f:function(e,t){var n={};return n.Hidden=e.read_shift(4),n.iTabID=e.read_shift(4),n.strRelID=UT(e,t-8),n.name=RT(e),n}},157:{},158:{},159:{T:1,f:function(e){return[e.read_shift(4),e.read_shift(4)]}},160:{T:-1},161:{T:1,f:$T},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Ak},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:RT(e)}}},336:{T:-1},337:{f:function(e){return e.l+=4,0!=e.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:UT},357:{},358:{},359:{},360:{T:1},361:{},362:{f:rS},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(e,t,n){var r=e.l+t,a=VT(e),i=e.read_shift(1),s=[a];if(s[2]=i,n.cellFormula){var o=ek(e,r-e.l,n);s[1]=o}else e.l=r;return s}},427:{f:function(e,t,n){var r=e.l+t,a=[$T(e,16)];if(n.cellFormula){var i=rk(e,r-e.l,n);a[1]=i,e.l=r}else e.l=r;return a}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(e){var t={};return Nk.forEach((function(n){t[n]=HT(e)})),t}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(e,t){var n=e.l+t,r=$T(e,16),a=zT(e),i=RT(e),s=RT(e),o=RT(e);e.l=n;var c={rfx:r,relId:a,loc:i,display:o};return s&&(c.Tooltip=s),c}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:UT},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:vI},633:{T:1},634:{T:-1},635:{T:1,f:function(e){var t={};t.iauthor=e.read_shift(4);var n=$T(e,16);return t.rfx=n.s,t.ref=TT(n.s),e.l+=16,t}},636:{T:-1},637:{f:PT},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(e,t){return e.l+=10,{name:RT(e)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},w_={6:{f:JI},10:{f:kx},12:{f:Cx},13:{f:Cx},14:{f:_x},15:{f:_x},16:{f:HT},17:{f:_x},18:{f:_x},19:{f:Cx},20:{f:Zx},21:{f:Zx},23:{f:rS},24:{f:nS},25:{f:_x},26:{},27:{},28:{f:function(e,t,n){return function(e,t,n){if(!(n.biff<8)){var r=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=Px(e,0,n);return n.biff<8&&e.read_shift(1),[{r:r,c:a},o,s,i]}}(e,0,n)}},29:{},34:{f:_x},35:{f:eS},38:{f:HT},39:{f:HT},40:{f:HT},41:{f:HT},42:{f:_x},43:{f:_x},47:{f:function(e,t,n){var r={Type:n.biff>=8?e.read_shift(2):0};return r.Type?zS(e,t-2,r):function(e,t,n,r){var a={key:Cx(e),verificationBytes:Cx(e)};n.password&&(a.verifier=LS(n.password)),r.valid=a.verificationBytes===a.verifier,r.valid&&(r.insitu=FS(n.password))}(e,n.biff,n,r),r}},49:{f:function(e,t,n){var r={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(n&&n.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10}return r.name=Nx(e,0,n),r}},51:{f:Cx},60:{},61:{f:function(e){return{Pos:[e.read_shift(2),e.read_shift(2)],Dim:[e.read_shift(2),e.read_shift(2)],Flags:e.read_shift(2),CurTab:e.read_shift(2),FirstTab:e.read_shift(2),Selected:e.read_shift(2),TabRatio:e.read_shift(2)}}},64:{f:_x},65:{f:function(){}},66:{f:Cx},77:{},80:{},81:{},82:{},85:{f:Cx},89:{},90:{},91:{},92:{f:function(e,t,n){if(n.enc)return e.l+=t,"";var r=e.l,a=Px(e,0,n);return e.read_shift(t+r-e.l),a}},93:{f:function(e,t,n){if(n&&n.biff<8)return function(e,t,n){e.l+=4;var r=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var s=[];return s.push((iS[r]||lT)(e,t,n)),{cmo:[a,r,i],ft:s}}(e,t,n);var r=Wx(e),a=function(e,t){for(var n=e.l+t,r=[];e.l<n;){var a=e.read_shift(2);e.l-=2;try{r.push(Kx[a](e,n-e.l))}catch(i){return e.l=n,r}}return e.l!=n&&(e.l=n),r}(e,t-22,r[1]);return{cmo:r,ft:a}}},94:{},95:{f:_x},96:{},97:{},99:{f:_x},125:{f:sS},128:{f:function(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(0!==t[0]&&t[0]--,0!==t[1]&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}},129:{f:function(e,t,n){var r=n&&8==n.biff||2==t?e.read_shift(2):(e.l+=t,0);return{fDialog:16&r,fBelow:64&r,fRight:128&r}}},130:{f:Cx},131:{f:_x},132:{f:_x},133:{f:function(e,t,n){var r=e.read_shift(4),a=3&e.read_shift(1),i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule"}var s=Nx(e,0,n);return 0===s.length&&(s="Sheet1"),{pos:r,hs:a,dt:i,name:s}}},134:{},140:{f:function(e){var t,n=[0,0];return t=e.read_shift(2),n[0]=XT[t]||t,t=e.read_shift(2),n[1]=XT[t]||t,n}},141:{f:Cx},144:{},146:{f:function(e){for(var t=e.read_shift(2),n=[];t-- >0;)n.push(zx(e));return n}},151:{},152:{},153:{},154:{},155:{},156:{f:Cx},157:{},158:{},160:{f:cS},161:{f:function(e,t){var n={};return t<32||(e.l+=16,n.header=HT(e),n.footer=HT(e),e.l+=2),n}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function(e,t){for(var n=e.l+t-2,r=e.read_shift(2),a=e.read_shift(2),i=[];e.l<n;)i.push(Bx(e));if(e.l!==n)throw new Error("MulRK read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulRK length mismatch");return{r:r,c:a,C:s,rkrec:i}}},190:{f:function(e,t){for(var n=e.l+t-2,r=e.read_shift(2),a=e.read_shift(2),i=[];e.l<n;)i.push(e.read_shift(2));if(e.l!==n)throw new Error("MulBlank read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulBlank length mismatch");return{r:r,c:a,C:s,ixfe:i}}},193:{f:kx},197:{},198:{},199:{},200:{},201:{},202:{f:_x},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Cx},220:{},221:{f:_x},222:{},224:{f:function(e,t,n){var r={};return r.ifnt=e.read_shift(2),r.numFmtId=e.read_shift(2),r.flags=e.read_shift(2),r.fStyle=r.flags>>2&1,r.data=function(e,t,n,r){var a={},i=e.read_shift(4),s=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return a.patternType=QT[o>>26],r.cellStyles?(a.alc=7&i,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=15&s,a.dgRight=s>>4&15,a.dgTop=s>>8&15,a.dgBottom=s>>12&15,a.icvLeft=s>>16&127,a.icvRight=s>>23&127,a.grbitDiag=s>>30&3,a.icvTop=127&o,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=127&c,a.icvBack=c>>7&127,a.fsxButton=c>>14&1,a):a}(e,0,r.fStyle,n),r}},225:{f:function(e,t){return 0===t||e.read_shift(2),1200}},226:{f:kx},227:{},229:{f:function(e,t){for(var n=[],r=e.read_shift(2);r--;)n.push(Vx(e));return n}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function(e,t){for(var n=e.l+t,r=e.read_shift(4),a=e.read_shift(4),i=[],s=0;s!=a&&e.l<n;++s)i.push(Rx(e));return i.Count=r,i.Unique=a,i}},253:{f:function(e){var t=jx(e);return t.isst=e.read_shift(4),t}},255:{f:function(e,t){var n={};return n.dsst=e.read_shift(2),e.l+=t-2,n}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Ax},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:_x},353:{f:kx},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function(e,t,n){var r=e.l+t,a=e.read_shift(2),i=e.read_shift(2);if(n.sbcch=i,1025==i||14849==i)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var s=Ox(e,i),o=[];r>e.l;)o.push(Dx(e));return[i,a,s,o]}},431:{f:_x},432:{},433:{},434:{},437:{},438:{f:function(e,t,n){var r=e.l,a="";try{e.l+=4;var i=(n.lastobj||{cmo:[0,0]}).cmo[1];-1==[0,5,7,11,12,14].indexOf(i)?e.l+=6:function(e){var t=e.read_shift(1);e.l++;var n=e.read_shift(2);return e.l+=2,[t,n]}(e);var s=e.read_shift(2);e.read_shift(2),Cx(e);var o=e.read_shift(2);e.l+=o;for(var c=1;c<e.lens.length-1;++c){if(e.l-r!=e.lens[c])throw new Error("TxO: bad continue record");var l=e[e.l];if((a+=Ox(e,e.lens[c+1]-e.lens[c]-1)).length>=(l?s:2*s))break}if(a.length!==s&&a.length!==2*s)throw new Error("cchText: "+s+" != "+a.length);return e.l=r+t,{t:a}}catch(u){return e.l=r+t,{t:a}}}},439:{f:_x},440:{f:function(e,t){var n=Vx(e);e.l+=16;var r=function(e,t){var n=e.l+t,r=e.read_shift(4);if(2!==r)throw new Error("Unrecognized streamVersion: "+r);var a=e.read_shift(2);e.l+=2;var i,s,o,c,l,u,d="";16&a&&(i=Mx(e,e.l)),128&a&&(s=Mx(e,e.l)),257===(257&a)&&(o=Mx(e,e.l)),1===(257&a)&&(c=Lx(e,e.l)),8&a&&(d=Mx(e,e.l)),32&a&&(l=e.read_shift(16)),64&a&&(u=gx(e)),e.l=n;var h=s||o||c||"";h&&d&&(h+="#"+d),h||(h="#"+d),2&a&&"/"==h.charAt(0)&&"/"!=h.charAt(1)&&(h="file://"+h);var f={Target:h};return l&&(f.guid=l),u&&(f.time=u),i&&(f.Tooltip=i),f}(e,t-24);return[n,r]}},441:{},442:{f:Dx},443:{},444:{f:Cx},445:{},446:{},448:{f:kx},449:{f:function(e){return e.read_shift(2),e.read_shift(4)},r:2},450:{f:kx},512:{f:Qx},513:{f:oS},515:{f:function(e,t,n){n.biffguess&&2==n.biff&&(n.biff=5);var r=jx(e),a=HT(e);return r.val=a,r}},516:{f:function(e,t,n){n.biffguess&&2==n.biff&&(n.biff=5),e.l;var r=jx(e);2==n.biff&&e.l++;var a=Dx(e,e.l,n);return r.val=a,r}},517:{f:Jx},519:{f:lS},520:{f:function(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var n=e.read_shift(2);e.l+=4;var r=e.read_shift(1);return e.l+=3,7&r&&(t.level=7&r),32&r&&(t.hidden=!0),64&r&&(t.hpt=n/20),t}},523:{},545:{f:aS},549:{f:Yx},566:{},574:{f:function(e,t,n){return n&&n.biff>=2&&n.biff<5?{}:{RTL:64&e.read_shift(2)}}},638:{f:function(e){var t=e.read_shift(2),n=e.read_shift(2),r=Bx(e);return{r:t,c:n,ixfe:r[0],rknum:r[1]}}},659:{},1048:{},1054:{f:function(e,t,n){return[e.read_shift(2),Px(e,0,n)]}},1084:{},1212:{f:function(e,t,n){var r=$x(e);e.l++;var a=e.read_shift(1);return[QI(e,t-=8,n),a,r]}},2048:{f:function(e,t){e.read_shift(2);var n=Vx(e),r=e.read_shift((t-10)/2,"dbcs-cont");return[n,r=r.replace(bb,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:qx},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:kx},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t},r:12},2173:{f:function(e,t){e.l,e.l+=2;var n=e.read_shift(2);e.l+=2;for(var r=e.read_shift(2),a=[];r-- >0;)a.push(gI(e,e.l));return{ixfe:n,ext:a}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:_x,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function(e,t,n){if(!(n.biff<8)){var r=e.read_shift(2),a=e.read_shift(2);return[Ox(e,r,n),Ox(e,a,n)]}e.l+=t},r:12},2197:{},2198:{f:function(e,t,n){var r=e.l+t;if(124226!==e.read_shift(4))if(n.cellStyles){var a,i=e.slice(e.l);e.l=r;try{a=Ww(i,{type:"array"})}catch(o){return}var s=Bw(a,"theme/theme/theme1.xml",!0);if(s)return hI(s,n)}else e.l=r},r:12},2199:{},2200:{},2201:{},2202:{f:function(e){return[0!==e.read_shift(4),0!==e.read_shift(4),e.read_shift(4)]},r:12},2203:{f:kx},2204:{},2205:{},2206:{},2207:{},2211:{f:function(e){var t=function(e){var t=e.read_shift(2),n=e.read_shift(2);return e.l+=8,{type:t,flags:n}}(e);if(2211!=t.type)throw new Error("Invalid Future Record "+t.type);return 0!==e.read_shift(4)}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Cx},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function(e,t,n){var r={area:!1};if(5!=n.biff)return e.l+=t,r;var a=e.read_shift(1);return e.l+=3,16&a&&(r.area=!0),r}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function(e){for(var t=e.read_shift(2),n=[];t-- >0;)n.push(zx(e));return n}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Qx},1:{},2:{f:function(e){var t=jx(e);++e.l;var n=e.read_shift(2);return t.t="n",t.val=n,t}},3:{f:function(e){var t=jx(e);++e.l;var n=HT(e);return t.t="n",t.val=n,t}},4:{f:function(e,t,n){n.biffguess&&5==n.biff&&(n.biff=2);var r=jx(e);++e.l;var a=Px(e,0,n);return r.t="str",r.val=a,r}},5:{f:Jx},7:{f:function(e){var t=e.read_shift(1);return 0===t?(e.l++,""):e.read_shift(t,"sbcs-cont")}},8:{},9:{f:qx},11:{},22:{f:Cx},30:{f:Xx},31:{},32:{},33:{f:aS},36:{},37:{f:Yx},50:{f:function(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}},62:{},52:{},67:{},68:{f:Cx},69:{},86:{},126:{},127:{f:function(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(4),a={fmt:t,env:n,len:r,data:e.slice(e.l,e.l+r)};return e.l+=r,a}},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function(e,t,n){var r=e.l+t,a=jx(e),i=e.read_shift(2),s=Ox(e,i,n);return e.l=r,a.t="str",a.val=s,a}},223:{},234:{},354:{},421:{},518:{f:JI},521:{f:qx},536:{f:nS},547:{f:eS},561:{},579:{},1030:{f:JI},1033:{f:qx},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function E_(e,t,n,r){var a=t;if(!isNaN(a)){var i=r||(n||[]).length||0,s=e.next(4);s.write_shift(2,a),s.write_shift(2,i),i>0&&qE(n)&&e.push(n)}}function T_(e,t){var n=t||{};var r=n.dense?[]:{},a=(e=e.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),s=a.index,o=i&&i.index||e.length,c=Lw(e.slice(s,o),/(:?<tr[^>]*>)/i,"<tr>"),l=-1,u=0,d=0,h=0,f={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(s=0;s<c.length;++s){var g=c[s].trim(),m=g.slice(0,3).toLowerCase();if("<tr"!=m){if("<td"==m||"<th"==m){var v=g.split(/<\/t[dh]>/i);for(o=0;o<v.length;++o){var y=v[o].trim();if(y.match(/<t[dh]/i)){for(var b=y,w=0;"<"==b.charAt(0)&&(w=b.indexOf(">"))>-1;)b=b.slice(w+1);for(var E=0;E<p.length;++E){var T=p[E];T.s.c==u&&T.s.r<l&&l<=T.e.r&&(u=T.e.c+1,E=-1)}var x=Zw(y.slice(0,y.indexOf(">")));h=x.colspan?+x.colspan:1,((d=+x.rowspan)>1||h>1)&&p.push({s:{r:l,c:u},e:{r:l+(d||1)-1,c:u+h-1}});var S=x.t||x["data-t"]||"";if(b.length)if(b=mE(b),f.s.r>l&&(f.s.r=l),f.e.r<l&&(f.e.r=l),f.s.c>u&&(f.s.c=u),f.e.c<u&&(f.e.c=u),b.length){var I={t:"s",v:b};n.raw||!b.trim().length||"s"==S||("TRUE"===b?I={t:"b",v:!0}:"FALSE"===b?I={t:"b",v:!1}:isNaN(Ow(b))?isNaN(Pw(b).getDate())||(I={t:"d",v:Cw(b)},n.cellDates||(I={t:"n",v:bw(I.v)}),I.z=n.dateNF||Nb[14]):I={t:"n",v:Ow(b)}),n.dense?(r[l]||(r[l]=[]),r[l][u]=I):r[TT({r:l,c:u})]=I,u+=h}else u+=h;else u+=h}}}}else{if(++l,n.sheetRows&&n.sheetRows<=l){--l;break}u=0}}return r["!ref"]=ST(f),p.length&&(r["!merges"]=p),r}function x_(e,t,n,r){for(var a=e["!merges"]||[],i=[],s=t.s.c;s<=t.e.c;++s){for(var o=0,c=0,l=0;l<a.length;++l)if(!(a[l].s.r>n||a[l].s.c>s)&&!(a[l].e.r<n||a[l].e.c<s)){if(a[l].s.r<n||a[l].s.c<s){o=-1;break}o=a[l].e.r-a[l].s.r+1,c=a[l].e.c-a[l].s.c+1;break}if(!(o<0)){var u=TT({r:n,c:s}),d=r.dense?(e[n]||[])[s]:e[u],h=d&&null!=d.v&&(d.h||sE(d.w||(_T(d),d.w)||""))||"",f={};o>1&&(f.rowspan=o),c>1&&(f.colspan=c),r.editable?h='<span contenteditable="true">'+h+"</span>":d&&(f["data-t"]=d&&d.t||"z",null!=d.v&&(f["data-v"]=d.v),null!=d.z&&(f["data-z"]=d.z),d.l&&"#"!=(d.l.Target||"#").charAt(0)&&(h='<a href="'+d.l.Target+'">'+h+"</a>")),f.id=(r.id||"sjs")+"-"+u,i.push(xE("td",h,f))}}return"<tr>"+i.join("")+"</tr>"}var S_='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',I_="</body></html>";function k_(e,t,n){return[].join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function __(e,t){var n=t||{},r=null!=n.header?n.header:S_,a=null!=n.footer?n.footer:I_,i=[r],s=xT(e["!ref"]);n.dense=Array.isArray(e),i.push(k_(0,0,n));for(var o=s.s.r;o<=s.e.r;++o)i.push(x_(e,s,o,n));return i.push("</table>"+a),i.join("")}function C_(e,t,n){var r=n||{};var a=0,i=0;if(null!=r.origin)if("number"==typeof r.origin)a=r.origin;else{var s="string"==typeof r.origin?ET(r.origin):r.origin;a=s.r,i=s.c}var o=t.getElementsByTagName("tr"),c=Math.min(r.sheetRows||1e7,o.length),l={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var u=xT(e["!ref"]);l.s.r=Math.min(l.s.r,u.s.r),l.s.c=Math.min(l.s.c,u.s.c),l.e.r=Math.max(l.e.r,u.e.r),l.e.c=Math.max(l.e.c,u.e.c),-1==a&&(l.e.r=a=u.e.r+1)}var d=[],h=0,f=e["!rows"]||(e["!rows"]=[]),p=0,g=0,m=0,v=0,y=0,b=0;for(e["!cols"]||(e["!cols"]=[]);p<o.length&&g<c;++p){var w=o[p];if(N_(w)){if(r.display)continue;f[g]={hidden:!0}}var E=w.children;for(m=v=0;m<E.length;++m){var T=E[m];if(!r.display||!N_(T)){var x=T.hasAttribute("data-v")?T.getAttribute("data-v"):T.hasAttribute("v")?T.getAttribute("v"):mE(T.innerHTML),S=T.getAttribute("data-z")||T.getAttribute("z");for(h=0;h<d.length;++h){var I=d[h];I.s.c==v+i&&I.s.r<g+a&&g+a<=I.e.r&&(v=I.e.c+1-i,h=-1)}b=+T.getAttribute("colspan")||1,((y=+T.getAttribute("rowspan")||1)>1||b>1)&&d.push({s:{r:g+a,c:v+i},e:{r:g+a+(y||1)-1,c:v+i+(b||1)-1}});var k={t:"s",v:x},_=T.getAttribute("data-t")||T.getAttribute("t")||"";null!=x&&(0==x.length?k.t=_||"z":r.raw||0==x.trim().length||"s"==_||("TRUE"===x?k={t:"b",v:!0}:"FALSE"===x?k={t:"b",v:!1}:isNaN(Ow(x))?isNaN(Pw(x).getDate())||(k={t:"d",v:Cw(x)},r.cellDates||(k={t:"n",v:bw(k.v)}),k.z=r.dateNF||Nb[14]):k={t:"n",v:Ow(x)})),void 0===k.z&&null!=S&&(k.z=S);var C="",A=T.getElementsByTagName("A");if(A&&A.length)for(var N=0;N<A.length&&(!A[N].hasAttribute("href")||"#"==(C=A[N].getAttribute("href")).charAt(0));++N);C&&"#"!=C.charAt(0)&&(k.l={Target:C}),r.dense?(e[g+a]||(e[g+a]=[]),e[g+a][v+i]=k):e[TT({c:v+i,r:g+a})]=k,l.e.c<v+i&&(l.e.c=v+i),v+=b}}++g}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),l.e.r=Math.max(l.e.r,g-1+a),e["!ref"]=ST(l),g>=c&&(e["!fullref"]=ST((l.e.r=o.length-p+g-1+a,l))),e}function A_(e,t){return C_((t||{}).dense?[]:{},e,t)}function N_(e){var t="",n=function(e){return e.ownerDocument.defaultView&&"function"===typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"===typeof getComputedStyle?getComputedStyle:null}(e);return n&&(t=n(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),"none"===t}function R_(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,(function(e,t){return Array(parseInt(t,10)+1).join(" ")})).replace(/<text:tab[^>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n");return[rE(t.replace(/<[^>]*>/g,""))]}var O_={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function D_(e,t){var n=t||{};var r,a,i,s,o,c,l=SE(e),u=[],d={name:""},h="",f=0,p={},g=[],m=n.dense?[]:{},v={value:""},y="",b=0,w=[],E=-1,T=-1,x={s:{r:1e6,c:1e7},e:{r:0,c:0}},S=0,I={},k=[],_={},C=[],A=1,N=1,R=[],O={Names:[]},D={},P=["",""],L=[],M={},F="",z=0,j=!1,U=!1,B=0;for(IE.lastIndex=0,l=l.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");o=IE.exec(l);)switch(o[3]=o[3].replace(/_.*$/,"")){case"table":case"\u5de5\u4f5c\u8868":"/"===o[1]?(x.e.c>=x.s.c&&x.e.r>=x.s.r?m["!ref"]=ST(x):m["!ref"]="A1:A1",n.sheetRows>0&&n.sheetRows<=x.e.r&&(m["!fullref"]=m["!ref"],x.e.r=n.sheetRows-1,m["!ref"]=ST(x)),k.length&&(m["!merges"]=k),C.length&&(m["!rows"]=C),i.name=i["\u540d\u79f0"]||i.name,"undefined"!==typeof JSON&&JSON.stringify(i),g.push(i.name),p[i.name]=m,U=!1):"/"!==o[0].charAt(o[0].length-2)&&(i=Zw(o[0],!1),E=T=-1,x.s.r=x.s.c=1e7,x.e.r=x.e.c=0,m=n.dense?[]:{},k=[],C=[],U=!0);break;case"table-row-group":"/"===o[1]?--S:++S;break;case"table-row":case"\u884c":if("/"===o[1]){E+=A,A=1;break}if((s=Zw(o[0],!1))["\u884c\u53f7"]?E=s["\u884c\u53f7"]-1:-1==E&&(E=0),(A=+s["number-rows-repeated"]||1)<10)for(B=0;B<A;++B)S>0&&(C[E+B]={level:S});T=-1;break;case"covered-table-cell":"/"!==o[1]&&++T,n.sheetStubs&&(n.dense?(m[E]||(m[E]=[]),m[E][T]={t:"z"}):m[TT({r:E,c:T})]={t:"z"}),y="",w=[];break;case"table-cell":case"\u6570\u636e":if("/"===o[0].charAt(o[0].length-2))++T,v=Zw(o[0],!1),N=parseInt(v["number-columns-repeated"]||"1",10),c={t:"z",v:null},v.formula&&0!=n.cellFormula&&(c.f=ok(rE(v.formula))),"string"==(v["\u6570\u636e\u7c7b\u578b"]||v["value-type"])&&(c.t="s",c.v=rE(v["string-value"]||""),n.dense?(m[E]||(m[E]=[]),m[E][T]=c):m[TT({r:E,c:T})]=c),T+=N-1;else if("/"!==o[1]){y="",b=0,w=[],N=1;var V=A?E+A-1:E;if(++T>x.e.c&&(x.e.c=T),T<x.s.c&&(x.s.c=T),E<x.s.r&&(x.s.r=E),V>x.e.r&&(x.e.r=V),L=[],M={},c={t:(v=Zw(o[0],!1))["\u6570\u636e\u7c7b\u578b"]||v["value-type"],v:null},n.cellFormula)if(v.formula&&(v.formula=rE(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(_={s:{r:E,c:T},e:{r:E+(parseInt(v["number-matrix-rows-spanned"],10)||0)-1,c:T+(parseInt(v["number-matrix-columns-spanned"],10)||0)-1}},c.F=ST(_),R.push([_,c.F])),v.formula)c.f=ok(v.formula);else for(B=0;B<R.length;++B)E>=R[B][0].s.r&&E<=R[B][0].e.r&&T>=R[B][0].s.c&&T<=R[B][0].e.c&&(c.F=R[B][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(_={s:{r:E,c:T},e:{r:E+(parseInt(v["number-rows-spanned"],10)||0)-1,c:T+(parseInt(v["number-columns-spanned"],10)||0)-1}},k.push(_)),v["number-columns-repeated"]&&(N=parseInt(v["number-columns-repeated"],10)),c.t){case"boolean":c.t="b",c.v=cE(v["boolean-value"]);break;case"float":case"percentage":case"currency":c.t="n",c.v=parseFloat(v.value);break;case"date":c.t="d",c.v=Cw(v["date-value"]),n.cellDates||(c.t="n",c.v=bw(c.v)),c.z="m/d/yy";break;case"time":c.t="n",c.v=Sw(v["time-value"])/86400,n.cellDates&&(c.t="d",c.v=xw(c.v)),c.z="HH:MM:SS";break;case"number":c.t="n",c.v=parseFloat(v["\u6570\u636e\u6570\u503c"]);break;default:if("string"!==c.t&&"text"!==c.t&&c.t)throw new Error("Unsupported value type "+c.t);c.t="s",null!=v["string-value"]&&(y=rE(v["string-value"]),w=[])}}else{if(j=!1,"s"===c.t&&(c.v=y||"",w.length&&(c.R=w),j=0==b),D.Target&&(c.l=D),L.length>0&&(c.c=L,L=[]),y&&!1!==n.cellText&&(c.w=y),j&&(c.t="z",delete c.v),(!j||n.sheetStubs)&&!(n.sheetRows&&n.sheetRows<=E))for(var $=0;$<A;++$){if(N=parseInt(v["number-columns-repeated"]||"1",10),n.dense)for(m[E+$]||(m[E+$]=[]),m[E+$][T]=0==$?c:Nw(c);--N>0;)m[E+$][T+N]=Nw(c);else for(m[TT({r:E+$,c:T})]=c;--N>0;)m[TT({r:E+$,c:T+N})]=Nw(c);x.e.c<=T&&(x.e.c=T)}T+=(N=parseInt(v["number-columns-repeated"]||"1",10))-1,N=0,c={},y="",w=[]}D={};break;case"document":case"document-content":case"\u7535\u5b50\u8868\u683c\u6587\u6863":case"spreadsheet":case"\u4e3b\u4f53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if("/"===o[1]){if((r=u.pop())[0]!==o[3])throw"Bad state: "+r}else"/"!==o[0].charAt(o[0].length-2)&&u.push([o[3],!0]);break;case"annotation":if("/"===o[1]){if((r=u.pop())[0]!==o[3])throw"Bad state: "+r;M.t=y,w.length&&(M.R=w),M.a=F,L.push(M)}else"/"!==o[0].charAt(o[0].length-2)&&u.push([o[3],!1]);F="",z=0,y="",b=0,w=[];break;case"creator":"/"===o[1]?F=l.slice(z,o.index):z=o.index+o[0].length;break;case"meta":case"\u5143\u6570\u636e":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===o[1]){if((r=u.pop())[0]!==o[3])throw"Bad state: "+r}else"/"!==o[0].charAt(o[0].length-2)&&u.push([o[3],!1]);y="",b=0,w=[];break;case"scientific-number":case"currency-symbol":case"currency-style":case"script":case"libraries":case"automatic-styles":case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":case"fraction":case"boolean-style":case"boolean":case"text-style":case"text-content":case"text-properties":case"embedded-text":case"body":case"\u7535\u5b50\u8868\u683c":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":case"s":case"date":case"object":case"title":case"\u6807\u9898":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if("/"===o[1]){if(I[d.name]=h,(r=u.pop())[0]!==o[3])throw"Bad state: "+r}else"/"!==o[0].charAt(o[0].length-2)&&(h="",d=Zw(o[0],!1),u.push([o[3],!0]));break;case"number":case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(u[u.length-1][0]){case"time-style":case"date-style":a=Zw(o[0],!1),h+=O_[o[3]]["long"===a.style?1:0]}break;case"text":if("/>"===o[0].slice(-2))break;if("/"===o[1])switch(u[u.length-1][0]){case"number-style":case"date-style":case"time-style":h+=l.slice(f,o.index)}else f=o.index+o[0].length;break;case"named-range":P=ck((a=Zw(o[0],!1))["cell-range-address"]);var H={Name:a.name,Ref:P[0]+"!"+P[1]};U&&(H.Sheet=g.length),O.Names.push(H);break;case"p":case"\u6587\u672c\u4e32":if(["master-styles"].indexOf(u[u.length-1][0])>-1)break;if("/"!==o[1]||v&&v["string-value"])Zw(o[0],!1),b=o.index+o[0].length;else{var W=R_(l.slice(b,o.index));y=(y.length>0?y+"\n":"")+W[0]}break;case"database-range":if("/"===o[1])break;try{p[(P=ck(Zw(o[0])["target-range-address"]))[0]]["!autofilter"]={ref:P[1]}}catch(K){}break;case"a":if("/"!==o[1]){if(!(D=Zw(o[0],!1)).href)break;D.Target=rE(D.href),delete D.href,"#"==D.Target.charAt(0)&&D.Target.indexOf(".")>-1?(P=ck(D.Target.slice(1)),D.Target="#"+P[0]+"!"+P[1]):D.Target.match(/^\.\.[\\\/]/)&&(D.Target=D.Target.slice(3))}break;default:switch(o[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5b57:":break;default:if(n.WTF)throw new Error(o)}}var G={Sheets:p,SheetNames:g,Workbook:O};return n.bookSheets&&delete G.Sheets,G}function P_(e,t){t=t||{},zw(e,"META-INF/manifest.xml")&&function(e,t){for(var n,r,a=SE(e);n=IE.exec(a);)switch(n[3]){case"manifest":break;case"file-entry":if("/"==(r=Zw(n[0],!1)).path&&"application/vnd.oasis.opendocument.spreadsheet"!==r.type)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}(Uw(e,"META-INF/manifest.xml"),t);var n=Bw(e,"content.xml");if(!n)throw new Error("Missing content.xml in ODS / UOF file");var r=D_(fE(n),t);return zw(e,"meta.xml")&&(r.Props=cx(Uw(e,"meta.xml"))),r}function L_(e,t){return D_(e,t)}function M_(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function F_(e){return"undefined"!=typeof TextDecoder?(new TextDecoder).decode(e):fE(mb(e))}function z_(e){var t=e.reduce((function(e,t){return e+t.length}),0),n=new Uint8Array(t),r=0;return e.forEach((function(e){n.set(e,r),r+=e.length})),n}function j_(e){return 16843009*((e=(858993459&(e-=e>>1&1431655765))+(e>>2&858993459))+(e>>4)&252645135)>>>24}function U_(e,t){var n=t?t[0]:0,r=127&e[n];e:if(e[n++]>=128){if(r|=(127&e[n])<<7,e[n++]<128)break e;if(r|=(127&e[n])<<14,e[n++]<128)break e;if(r|=(127&e[n])<<21,e[n++]<128)break e;if(r+=(127&e[n])*Math.pow(2,28),++n,e[n++]<128)break e;if(r+=(127&e[n])*Math.pow(2,35),++n,e[n++]<128)break e;if(r+=(127&e[n])*Math.pow(2,42),++n,e[n++]<128)break e}return t&&(t[0]=n),r}function B_(e){var t=0,n=127&e[t];e:if(e[t++]>=128){if(n|=(127&e[t])<<7,e[t++]<128)break e;if(n|=(127&e[t])<<14,e[t++]<128)break e;if(n|=(127&e[t])<<21,e[t++]<128)break e;n|=(127&e[t])<<28}return n}function V_(e){for(var t=[],n=[0];n[0]<e.length;){var r,a=n[0],i=U_(e,n),s=7&i,o=0;if(0==(i=Math.floor(i/8)))break;switch(s){case 0:for(var c=n[0];e[n[0]++]>=128;);r=e.slice(c,n[0]);break;case 5:o=4,r=e.slice(n[0],n[0]+o),n[0]+=o;break;case 1:o=8,r=e.slice(n[0],n[0]+o),n[0]+=o;break;case 2:o=U_(e,n),r=e.slice(n[0],n[0]+o),n[0]+=o;break;default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(a))}var l={data:r,type:s};null==t[i]?t[i]=[l]:t[i].push(l)}return t}function $_(e,t){return(null==e?void 0:e.map((function(e){return t(e.data)})))||[]}function H_(e){for(var t,n=[],r=[0];r[0]<e.length;){var a=U_(e,r),i=V_(e.slice(r[0],r[0]+a));r[0]+=a;var s={id:B_(i[1][0].data),messages:[]};i[2].forEach((function(t){var n=V_(t.data),a=B_(n[3][0].data);s.messages.push({meta:n,data:e.slice(r[0],r[0]+a)}),r[0]+=a})),(null==(t=i[3])?void 0:t[0])&&(s.merge=B_(i[3][0].data)>>>0>0),n.push(s)}return n}function W_(e,t){if(0!=e)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var n=[0],r=U_(t,n),a=[];n[0]<t.length;){var i=3&t[n[0]];if(0!=i){var s=0,o=0;if(1==i?(o=4+(t[n[0]]>>2&7),s=(224&t[n[0]++])<<3,s|=t[n[0]++]):(o=1+(t[n[0]++]>>2),2==i?(s=t[n[0]]|t[n[0]+1]<<8,n[0]+=2):(s=(t[n[0]]|t[n[0]+1]<<8|t[n[0]+2]<<16|t[n[0]+3]<<24)>>>0,n[0]+=4)),a=[z_(a)],0==s)throw new Error("Invalid offset 0");if(s>a[0].length)throw new Error("Invalid offset beyond length");if(o>=s)for(a.push(a[0].slice(-s)),o-=s;o>=a[a.length-1].length;)a.push(a[a.length-1]),o-=a[a.length-1].length;a.push(a[0].slice(-s,-s+o))}else{var c=t[n[0]++]>>2;if(c<60)++c;else{var l=c-59;c=t[n[0]],l>1&&(c|=t[n[0]+1]<<8),l>2&&(c|=t[n[0]+2]<<16),l>3&&(c|=t[n[0]+3]<<24),c>>>=0,c++,n[0]+=l}a.push(t.slice(n[0],n[0]+c)),n[0]+=c}}var u=z_(a);if(u.length!=r)throw new Error("Unexpected length: ".concat(u.length," != ").concat(r));return u}function G_(e){for(var t=[],n=0;n<e.length;){var r=e[n++],a=e[n]|e[n+1]<<8|e[n+2]<<16;n+=3,t.push(W_(r,e.slice(n,n+a))),n+=a}if(n!==e.length)throw new Error("data is not a valid framed stream!");return z_(t)}function K_(e,t,n){var r,a=M_(e),i=a.getUint32(8,!0),s=12,o=-1,c=-1,l=NaN,u=NaN,d=new Date(2001,0,1);switch(1&i&&(l=function(e,t){for(var n=(127&e[t+15])<<7|e[t+14]>>1,r=1&e[t+14],a=t+13;a>=t;--a)r=256*r+e[a];return(128&e[t+15]?-r:r)*Math.pow(10,n-6176)}(e,s),s+=16),2&i&&(u=a.getFloat64(s,!0),s+=8),4&i&&(d.setTime(d.getTime()+1e3*a.getFloat64(s,!0)),s+=8),8&i&&(c=a.getUint32(s,!0),s+=4),16&i&&(o=a.getUint32(s,!0),s+=4),e[1]){case 0:break;case 2:case 10:r={t:"n",v:l};break;case 3:r={t:"s",v:t[c]};break;case 5:r={t:"d",v:d};break;case 6:r={t:"b",v:u>0};break;case 7:r={t:"n",v:u/86400};break;case 8:r={t:"e",v:0};break;case 9:if(!(o>-1))throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&i," : ").concat(e.slice(0,4)));r={t:"s",v:n[o]};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&i," : ").concat(e.slice(0,4)))}return r}function q_(e,t,n){switch(e[0]){case 0:case 1:case 2:case 3:return function(e,t,n,r){var a,i=M_(e),s=i.getUint32(4,!0),o=(r>1?12:8)+4*j_(s&(r>1?3470:398)),c=-1,l=-1,u=NaN,d=new Date(2001,0,1);switch(512&s&&(c=i.getUint32(o,!0),o+=4),o+=4*j_(s&(r>1?12288:4096)),16&s&&(l=i.getUint32(o,!0),o+=4),32&s&&(u=i.getFloat64(o,!0),o+=8),64&s&&(d.setTime(d.getTime()+1e3*i.getFloat64(o,!0)),o+=8),e[2]){case 0:break;case 2:a={t:"n",v:u};break;case 3:a={t:"s",v:t[l]};break;case 5:a={t:"d",v:d};break;case 6:a={t:"b",v:u>0};break;case 7:a={t:"n",v:u/86400};break;case 8:a={t:"e",v:0};break;case 9:if(c>-1)a={t:"s",v:n[c]};else if(l>-1)a={t:"s",v:t[l]};else{if(isNaN(u))throw new Error("Unsupported cell type ".concat(e.slice(0,4)));a={t:"n",v:u}}break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return a}(e,t,n,e[0]);case 5:return K_(e,t,n);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Y_(e){return U_(V_(e)[1][0].data)}function X_(e,t){var n=V_(t.data),r=B_(n[1][0].data),a=n[3],i=[];return(a||[]).forEach((function(t){var n=V_(t.data),a=B_(n[1][0].data)>>>0;switch(r){case 1:i[a]=F_(n[3][0].data);break;case 8:var s=V_(e[Y_(n[9][0].data)][0].data),o=e[Y_(s[1][0].data)][0],c=B_(o.meta[1][0].data);if(2001!=c)throw new Error("2000 unexpected reference to ".concat(c));var l=V_(o.data);i[a]=l[3].map((function(e){return F_(e.data)})).join("")}})),i}function Q_(e,t){var n,r=V_(t.data),a=(null==(n=null==r?void 0:r[7])?void 0:n[0])?B_(r[7][0].data)>>>0>0?1:0:-1,i=$_(r[5],(function(e){return function(e,t){var n,r,a,i,s,o,c,l,u,d,h,f,p,g,m,v,y=V_(e),b=B_(y[1][0].data)>>>0,w=B_(y[2][0].data)>>>0,E=(null==(r=null==(n=y[8])?void 0:n[0])?void 0:r.data)&&B_(y[8][0].data)>0||!1;if((null==(i=null==(a=y[7])?void 0:a[0])?void 0:i.data)&&0!=t)m=null==(o=null==(s=y[7])?void 0:s[0])?void 0:o.data,v=null==(l=null==(c=y[6])?void 0:c[0])?void 0:l.data;else{if(!(null==(d=null==(u=y[4])?void 0:u[0])?void 0:d.data)||1==t)throw"NUMBERS Tile missing ".concat(t," cell storage");m=null==(f=null==(h=y[4])?void 0:h[0])?void 0:f.data,v=null==(g=null==(p=y[3])?void 0:p[0])?void 0:g.data}for(var T=E?4:1,x=M_(m),S=[],I=0;I<m.length/2;++I){var k=x.getUint16(2*I,!0);k<65535&&S.push([I,k])}if(S.length!=w)throw"Expected ".concat(w," cells, found ").concat(S.length);var _=[];for(I=0;I<S.length-1;++I)_[S[I][0]]=v.subarray(S[I][1]*T,S[I+1][1]*T);return S.length>=1&&(_[S[S.length-1][0]]=v.subarray(S[S.length-1][1]*T)),{R:b,cells:_}}(e,a)}));return{nrows:B_(r[4][0].data)>>>0,data:i.reduce((function(e,t){return e[t.R]||(e[t.R]=[]),t.cells.forEach((function(n,r){if(e[t.R][r])throw new Error("Duplicate cell r=".concat(t.R," c=").concat(r));e[t.R][r]=n})),e}),[])}}function J_(e,t){var n={"!ref":"A1"},r=e[Y_(V_(t.data)[2][0].data)],a=B_(r[0].meta[1][0].data);if(6001!=a)throw new Error("6000 unexpected reference to ".concat(a));return function(e,t,n){var r,a=V_(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(B_(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(B_(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));n["!ref"]=ST(i);var s=V_(a[4][0].data),o=X_(e,e[Y_(s[4][0].data)][0]),c=(null==(r=s[17])?void 0:r[0])?X_(e,e[Y_(s[17][0].data)][0]):[],l=V_(s[3][0].data),u=0;l[1].forEach((function(t){var r=V_(t.data),a=e[Y_(r[2][0].data)][0],i=B_(a.meta[1][0].data);if(6002!=i)throw new Error("6001 unexpected reference to ".concat(i));var s=Q_(0,a);s.data.forEach((function(e,t){e.forEach((function(e,r){var a=TT({r:u+t,c:r}),i=q_(e,o,c);i&&(n[a]=i)}))})),u+=s.nrows}))}(e,r[0],n),n}function Z_(e,t){var n={SheetNames:[],Sheets:{}};if($_(V_(t.data)[1],Y_).forEach((function(t){e[t].forEach((function(t){if(2==B_(t.meta[1][0].data)){var r=function(e,t){var n,r=V_(t.data),a={name:(null==(n=r[1])?void 0:n[0])?F_(r[1][0].data):"",sheets:[]};return $_(r[2],Y_).forEach((function(t){e[t].forEach((function(t){6e3==B_(t.meta[1][0].data)&&a.sheets.push(J_(e,t))}))})),a}(e,t);r.sheets.forEach((function(e,t){wC(n,e,0==t?r.name:r.name+"_"+t,!0)}))}}))})),0==n.SheetNames.length)throw new Error("Empty NUMBERS file");return n}function eC(e){var t,n,r,a,i={},s=[];if(e.FullPaths.forEach((function(e){if(e.match(/\.iwpv2/))throw new Error("Unsupported password protection")})),e.FileIndex.forEach((function(e){if(e.name.match(/\.iwa$/)){var t,n;try{t=G_(e.content)}catch(r){return console.log("?? "+e.content.length+" "+(r.message||r))}try{n=H_(t)}catch(r){return console.log("## "+(r.message||r))}n.forEach((function(e){i[e.id]=e.messages,s.push(e.id)}))}})),!s.length)throw new Error("File has no messages");var o=(null==(a=null==(r=null==(n=null==(t=null==i?void 0:i[1])?void 0:t[0])?void 0:n.meta)?void 0:r[1])?void 0:a[0].data)&&1==B_(i[1][0].meta[1][0].data)&&i[1][0];if(o||s.forEach((function(e){i[e].forEach((function(e){if(1==B_(e.meta[1][0].data)>>>0){if(o)throw new Error("Document has multiple roots");o=e}}))})),!o)throw new Error("Cannot find Document root");return Z_(i,o)}function tC(e){return function(t){for(var n=0;n!=e.length;++n){var r=e[n];void 0===t[r[0]]&&(t[r[0]]=r[1]),"n"===r[2]&&(t[r[0]]=Number(t[r[0]]))}}}function nC(e){tC([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function rC(e,t,n,r,a,i,s,o,c,l,u,d){try{i[r]=ix(Bw(e,n,!0),t);var h,f=Uw(e,t);switch(o){case"sheet":h=Hk(f,t,a,c,i[r],l,u,d);break;case"chart":if(!(h=Wk(f,t,a,c,i[r],l))||!h["!drawel"])break;var p=Gw(h["!drawel"].Target,t),g=ax(p),m=function(e,t){if(!e)return"??";var n=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][n].Target}(Bw(e,p,!0),ix(Bw(e,g,!0),p)),v=Gw(m,p),y=ax(v);h=Rk(Bw(e,v,!0),0,0,ix(Bw(e,y,!0),v),0,h);break;case"macro":w=t,i[r],w.slice(-4),h={"!type":"macro"};break;case"dialog":h=function(e,t){return t.slice(-4),{"!type":"dialog"}}(0,t,0,0,i[r]);break;default:throw new Error("Unrecognized sheet type "+o)}s[r]=h;var b=[];i&&i[r]&&mw(i[r]).forEach((function(n){var a="";if(i[r][n].Type==rx.CMNT){a=Gw(i[r][n].Target,t);var s=qk(Uw(e,a,!0),a,c);if(!s||!s.length)return;mI(h,s,!1)}i[r][n].Type==rx.TCMNT&&(a=Gw(i[r][n].Target,t),b=b.concat(function(e,t){var n=[],r=!1,a={},i=0;return e.replace(Xw,(function(s,o){var c=Zw(s);switch(eE(c[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<threadedComment":a={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":null!=a.t&&n.push(a);break;case"<text>":case"<text":i=o+s.length;break;case"</text>":a.t=e.slice(i,o).replace(/\r\n/g,"\n").replace(/\r/g,"\n");break;case"<mentions":case"<mentions>":case"<ext":r=!0;break;case"</mentions>":case"</ext>":r=!1;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return s})),n}(Uw(e,a,!0),c)))})),b&&b.length&&mI(h,b,!0,c.people||[])}catch(E){if(c.WTF)throw E}var w}function aC(e){return"/"==e.charAt(0)?e.slice(1):e}function iC(e,t){if(uw(),nC(t=t||{}),zw(e,"META-INF/manifest.xml"))return P_(e,t);if(zw(e,"objectdata.xml"))return P_(e,t);if(zw(e,"Index/Document.iwa")){if("undefined"==typeof Uint8Array)throw new Error("NUMBERS file parsing requires Uint8Array support");if(e.FileIndex)return eC(e);var n=pw.utils.cfb_new();return $w(e).forEach((function(t){Hw(n,t,Vw(e,t))})),eC(n)}if(!zw(e,"[Content_Types].xml")){if(zw(e,"index.xml.gz"))throw new Error("Unsupported NUMBERS 08 file");if(zw(e,"index.xml"))throw new Error("Unsupported NUMBERS 09 file");throw new Error("Unsupported ZIP file")}var r,a,i=$w(e),s=function(e){var t={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};if(!e||!e.match)return t;var n={};if((e.match(Xw)||[]).forEach((function(e){var r=Zw(e);switch(r[0].replace(Qw,"<")){case"<?xml":break;case"<Types":t.xmlns=r["xmlns"+(r[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":n[r.Extension]=r.ContentType;break;case"<Override":void 0!==t[nx[r.ContentType]]&&t[nx[r.ContentType]].push(r.PartName)}})),t.xmlns!==kE)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=n,delete t.calcchains,t}(Bw(e,"[Content_Types].xml")),o=!1;if(0===s.workbooks.length&&Uw(e,a="xl/workbook.xml",!0)&&s.workbooks.push(a),0===s.workbooks.length){if(!Uw(e,a="xl/workbook.bin",!0))throw new Error("Could not find workbook");s.workbooks.push(a),o=!0}"bin"==s.workbooks[0].slice(-3)&&(o=!0);var c={},l={};if(!t.bookSheets&&!t.bookProps){if(lk=[],s.sst)try{lk=Kk(Uw(e,aC(s.sst)),s.sst,t)}catch(N){if(t.WTF)throw N}t.cellStyles&&s.themes.length&&(c=function(e,t,n){return hI(e,n)}(Bw(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(l=Gk(Uw(e,aC(s.style)),s.style,c,t))}s.links.map((function(n){try{ix(Bw(e,ax(aC(n))),n);return Xk(Uw(e,aC(n)),0,n,t)}catch(N){}}));var u=$k(Uw(e,aC(s.workbooks[0])),s.workbooks[0],t),d={},h="";s.coreprops.length&&((h=Uw(e,aC(s.coreprops[0]),!0))&&(d=cx(h)),0!==s.extprops.length&&(h=Uw(e,aC(s.extprops[0]),!0))&&function(e,t,n){var r={};t||(t={}),e=fE(e),lx.forEach((function(n){var a=(e.match(gE(n[0]))||[])[1];switch(n[2]){case"string":a&&(t[n[1]]=rE(a));break;case"bool":t[n[1]]="true"===a;break;case"raw":var i=e.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));i&&i.length>0&&(r[n[1]]=i[1])}})),r.HeadingPairs&&r.TitlesOfParts&&ux(r.HeadingPairs,r.TitlesOfParts,t,n)}(h,d,t));var f={};t.bookSheets&&!t.bookProps||0!==s.custprops.length&&(h=Bw(e,aC(s.custprops[0]),!0))&&(f=function(e,t){var n={},r="",a=e.match(dx);if(a)for(var i=0;i!=a.length;++i){var s=a[i],o=Zw(s);switch(o[0]){case"<?xml":case"<Properties":break;case"<property":r=rE(o.name);break;case"</property>":r=null;break;default:if(0===s.indexOf("<vt:")){var c=s.split(">"),l=c[0].slice(4),u=c[1];switch(l){case"lpstr":case"bstr":case"lpwstr":case"cy":case"error":n[r]=rE(u);break;case"bool":n[r]=cE(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":n[r]=parseInt(u,10);break;case"r4":case"r8":case"decimal":n[r]=parseFloat(u);break;case"filetime":case"date":n[r]=Cw(u);break;default:if("/"==l.slice(-1))break;t.WTF&&"undefined"!==typeof console&&console.warn("Unexpected",s,l,c)}}else if("</"===s.slice(0,2));else if(t.WTF)throw new Error(s)}}return n}(h,t));var p={};if((t.bookSheets||t.bookProps)&&(u.Sheets?r=u.Sheets.map((function(e){return e.name})):d.Worksheets&&d.SheetNames.length>0&&(r=d.SheetNames),t.bookProps&&(p.Props=d,p.Custprops=f),t.bookSheets&&"undefined"!==typeof r&&(p.SheetNames=r),t.bookSheets?p.SheetNames:t.bookProps))return p;r={};var g={};t.bookDeps&&s.calcchain&&(g=Yk(Uw(e,aC(s.calcchain)),s.calcchain));var m,v,y=0,b={},w=u.Sheets;d.Worksheets=w.length,d.SheetNames=[];for(var E=0;E!=w.length;++E)d.SheetNames[E]=w[E].name;var T=o?"bin":"xml",x=s.workbooks[0].lastIndexOf("/"),S=(s.workbooks[0].slice(0,x+1)+"_rels/"+s.workbooks[0].slice(x+1)+".rels").replace(/^\//,"");zw(e,S)||(S="xl/_rels/workbook."+T+".rels");var I=ix(Bw(e,S,!0),S.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=Qk(Uw(e,aC(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=function(e,t){var n=[],r=!1;return e.replace(Xw,(function(e){var a=Zw(e);switch(eE(a[0])){case"<?xml":case"<personList":case"</personList>":case"</person>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<person":n.push({name:a.displayname,id:a.id});break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return e})),n}(Uw(e,aC(s.people[0])),t)),I&&(I=function(e,t){if(!e)return 0;try{e=t.map((function(t){return t.id||(t.id=t.strRelID),[t.name,e["!id"][t.id].Target,(n=e["!id"][t.id].Type,rx.WS.indexOf(n)>-1?"sheet":rx.CS&&n==rx.CS?"chart":rx.DS&&n==rx.DS?"dialog":rx.MS&&n==rx.MS?"macro":n&&n.length?n:"sheet")];var n}))}catch(N){return null}return e&&0!==e.length?e:null}(I,u.Sheets));var k=Uw(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=d.Worksheets;++y){var _="sheet";if(I&&I[y]?(m="xl/"+I[y][1].replace(/[\/]?xl\//,""),zw(e,m)||(m=I[y][1]),zw(e,m)||(m=S.replace(/_rels\/.*$/,"")+I[y][1]),_=I[y][2]):m=(m="xl/worksheets/sheet"+(y+1-k)+"."+T).replace(/sheet0\./,"sheet."),v=m.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&null!=t.sheets)switch(typeof t.sheets){case"number":if(y!=t.sheets)continue e;break;case"string":if(d.SheetNames[y].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var C=!1,A=0;A!=t.sheets.length;++A)"number"==typeof t.sheets[A]&&t.sheets[A]==y&&(C=1),"string"==typeof t.sheets[A]&&t.sheets[A].toLowerCase()==d.SheetNames[y].toLowerCase()&&(C=1);if(!C)continue e}}rC(e,m,v,d.SheetNames[y],y,b,r,_,t,u,c,l)}return p={Directory:s,Workbook:u,Props:d,Custprops:f,Deps:g,Sheets:r,SheetNames:d.SheetNames,Strings:lk,Styles:l,Themes:c,SSF:Nw(Nb)},t&&t.bookFiles&&(e.files?(p.keys=i,p.files=e.files):(p.keys=[],p.files={},e.FullPaths.forEach((function(t,n){t=t.replace(/^Root Entry[\/]/,""),p.keys.push(t),p.files[t]=e.FileIndex[n]})))),t&&t.bookVBA&&(s.vba.length>0?p.vbaraw=Uw(e,aC(s.vba[0]),!0):s.defaults&&"application/vnd.ms-office.vbaProject"===s.defaults.bin&&(p.vbaraw=Uw(e,"xl/vbaProject.bin",!0))),p}function sC(e,t){var n=t||{},r="Workbook",a=pw.find(e,r);try{if(r="/!DataSpaces/Version",!(a=pw.find(e,r))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(function(e){var t={};t.id=e.read_shift(0,"lpp4"),t.R=_S(e,4),t.U=_S(e,4),t.W=_S(e,4)}(a.content),r="/!DataSpaces/DataSpaceMap",!(a=pw.find(e,r))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var i=function(e){var t=[];e.l+=4;for(var n=e.read_shift(4);n-- >0;)t.push(CS(e));return t}(a.content);if(1!==i.length||1!==i[0].comps.length||0!==i[0].comps[0].t||"StrongEncryptionDataSpace"!==i[0].name||"EncryptedPackage"!==i[0].comps[0].v)throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(a=pw.find(e,r))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var s=function(e){var t=[];e.l+=4;for(var n=e.read_shift(4);n-- >0;)t.push(e.read_shift(0,"lpp4"));return t}(a.content);if(1!=s.length||"StrongEncryptionTransform"!=s[0])throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(a=pw.find(e,r))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);AS(a.content)}catch(c){}if(r="/EncryptionInfo",!(a=pw.find(e,r))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var o=function(e){var t=_S(e);switch(t.Minor){case 2:return[t.Minor,OS(e)];case 3:return[t.Minor,DS()];case 4:return[t.Minor,PS(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}(a.content);if(r="/EncryptedPackage",!(a=pw.find(e,r))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(4==o[0]&&"undefined"!==typeof decrypt_agile)return decrypt_agile(o[1],a.content,n.password||"",n);if(2==o[0]&&"undefined"!==typeof decrypt_std76)return decrypt_std76(o[1],a.content,n.password||"",n);throw new Error("File is password-protected")}function oC(e,t){var n="";switch((t||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":n=ub(e.slice(0,12));break;case"binary":n=e;break;default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function cC(e,t){var n=0;e:for(;n<e.length;)switch(e.charCodeAt(n)){case 10:case 13:case 32:++n;break;case 60:return l_(e.slice(n),t);default:break e}return gS.to_workbook(e,t)}function lC(e,t,n,r){return r?(n.type="string",gS.to_workbook(e,n)):gS.to_workbook(t,n)}function uC(e,t){tb();var n=t||{};if("undefined"!==typeof ArrayBuffer&&e instanceof ArrayBuffer)return uC(new Uint8Array(e),((n=Nw(n)).type="array",n));"undefined"!==typeof Uint8Array&&e instanceof Uint8Array&&!n.type&&(n.type="undefined"!==typeof Deno?"buffer":"array");var r,a=e,i=!1;if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),uk={},n.dateNF&&(uk.dateNF=n.dateNF),n.type||(n.type=db&&Buffer.isBuffer(e)?"buffer":"base64"),"file"==n.type&&(n.type=db?"buffer":"binary",a=function(e){if("undefined"!==typeof gw)return gw.readFileSync(e);if("undefined"!==typeof Deno)return Deno.readFileSync(e);if("undefined"!==typeof $&&"undefined"!==typeof File&&"undefined"!==typeof Folder)try{var t=File(e);t.open("r"),t.encoding="binary";var n=t.read();return t.close(),n}catch(r){if(!r.message||!r.message.match(/onstruct/))throw r}throw new Error("Cannot access file "+e)}(e),"undefined"===typeof Uint8Array||db||(n.type="array")),"string"==n.type&&(i=!0,n.type="binary",n.codepage=65001,a=function(e){return e.match(/[^\x00-\x7F]/)?pE(e):e}(e)),"array"==n.type&&"undefined"!==typeof Uint8Array&&e instanceof Uint8Array&&"undefined"!==typeof ArrayBuffer){var s=new ArrayBuffer(3),o=new Uint8Array(s);if(o.foo="bar",!o.foo)return(n=Nw(n)).type="array",uC(vb(a),n)}switch((r=oC(a,n))[0]){case 208:if(207===r[1]&&17===r[2]&&224===r[3]&&161===r[4]&&177===r[5]&&26===r[6]&&225===r[7])return function(e,t){return pw.find(e,"EncryptedPackage")?sC(e,t):y_(e,t)}(pw.read(a,n),n);break;case 9:if(r[1]<=8)return y_(a,n);break;case 60:return l_(a,n);case 73:if(73===r[1]&&42===r[2]&&0===r[3])throw new Error("TIFF Image File is not a spreadsheet");if(68===r[1])return function(e,t){var n=t||{},r=!!n.WTF;n.WTF=!0;try{var a=hS.to_workbook(e,n);return n.WTF=r,a}catch(i){if(n.WTF=r,!i.message.match(/SYLK bad record ID/)&&r)throw i;return gS.to_workbook(e,t)}}(a,n);break;case 84:if(65===r[1]&&66===r[2]&&76===r[3])return fS.to_workbook(a,n);break;case 80:return 75===r[1]&&r[2]<9&&r[3]<9?function(e,t){var n=e,r=t||{};return r.type||(r.type=db&&Buffer.isBuffer(e)?"buffer":"base64"),iC(Ww(n,r),r)}(a,n):lC(e,a,n,i);case 239:return 60===r[3]?l_(a,n):lC(e,a,n,i);case 255:if(254===r[1])return function(e,t){var n=e;return"base64"==t.type&&(n=ub(n)),n=ab.utils.decode(1200,n.slice(2),"str"),t.type="binary",cC(n,t)}(a,n);if(0===r[1]&&2===r[2]&&0===r[3])return mS.to_workbook(a,n);break;case 0:if(0===r[1]){if(r[2]>=2&&0===r[3])return mS.to_workbook(a,n);if(0===r[2]&&(8===r[3]||9===r[3]))return mS.to_workbook(a,n)}break;case 3:case 131:case 139:case 140:return dS.to_workbook(a,n);case 123:if(92===r[1]&&114===r[2]&&116===r[3])return jS.to_workbook(a,n);break;case 10:case 13:case 32:return function(e,t){var n="",r=oC(e,t);switch(t.type){case"base64":n=ub(e);break;case"binary":n=e;break;case"buffer":n=e.toString("binary");break;case"array":n=Aw(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==r[0]&&187==r[1]&&191==r[2]&&(n=fE(n)),t.type="binary",cC(n,t)}(a,n);case 137:if(80===r[1]&&78===r[2]&&71===r[3])throw new Error("PNG Image File is not a spreadsheet")}return uS.indexOf(r[0])>-1&&r[2]<=12&&r[3]<=31?dS.to_workbook(a,n):lC(e,a,n,i)}function dC(e,t,n,r,a,i,s,o){var c=yT(n),l=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,h=1===a?[]:{};if(1!==a)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:n,enumerable:!1})}catch(m){h.__rowNum__=n}else h.__rowNum__=n;if(!s||e[n])for(var f=t.s.c;f<=t.e.c;++f){var p=s?e[n][f]:e[r[f]+c];if(void 0!==p&&void 0!==p.t){var g=p.v;switch(p.t){case"z":if(null==g)break;continue;case"e":g=0==g?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(null!=i[f]){if(null==g)if("e"==p.t&&null===g)h[i[f]]=null;else if(void 0!==l)h[i[f]]=l;else{if(!u||null!==g)continue;h[i[f]]=null}else h[i[f]]=u&&("n"!==p.t||"n"===p.t&&!1!==o.rawNumbers)?g:_T(p,g,o);null!=g&&(d=!1)}}else{if(void 0===l)continue;null!=i[f]&&(h[i[f]]=l)}}return{row:h,isempty:d}}function hC(e,t){if(null==e||null==e["!ref"])return[];var n={t:"n",v:0},r=0,a=1,i=[],s=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},l=t||{},u=null!=l.range?l.range:e["!ref"];switch(1===l.header?r=1:"A"===l.header?r=2:Array.isArray(l.header)?r=3:null==l.header&&(r=0),typeof u){case"string":c=IT(u);break;case"number":(c=IT(e["!ref"])).s.r=u;break;default:c=u}r>0&&(a=0);var d=yT(c.s.r),h=[],f=[],p=0,g=0,m=Array.isArray(e),v=c.s.r,y=0,b={};m&&!e[v]&&(e[v]=[]);var w=l.skipHidden&&e["!cols"]||[],E=l.skipHidden&&e["!rows"]||[];for(y=c.s.c;y<=c.e.c;++y)if(!(w[y]||{}).hidden)switch(h[y]=wT(y),n=m?e[v][y]:e[h[y]+d],r){case 1:i[y]=y-c.s.c;break;case 2:i[y]=h[y];break;case 3:i[y]=l.header[y-c.s.c];break;default:if(null==n&&(n={w:"__EMPTY",t:"s"}),o=s=_T(n,null,l),g=b[s]||0){do{o=s+"_"+g++}while(b[o]);b[s]=g,b[o]=1}else b[s]=1;i[y]=o}for(v=c.s.r+a;v<=c.e.r;++v)if(!(E[v]||{}).hidden){var T=dC(e,c,v,h,r,i,m,l);(!1===T.isempty||(1===r?!1!==l.blankrows:l.blankrows))&&(f[p++]=T.row)}return f.length=p,f}var fC=/"/g;function pC(e,t,n,r,a,i,s,o){for(var c=!0,l=[],u="",d=yT(n),h=t.s.c;h<=t.e.c;++h)if(r[h]){var f=o.dense?(e[n]||[])[h]:e[r[h]+d];if(null==f)u="";else if(null!=f.v){c=!1,u=""+(o.rawNumbers&&"n"==f.t?f.v:_T(f,null,o));for(var p=0,g=0;p!==u.length;++p)if((g=u.charCodeAt(p))===a||g===i||34===g||o.forceQuotes){u='"'+u.replace(fC,'""')+'"';break}"ID"==u&&(u='"ID"')}else null==f.f||f.F?u="":(c=!1,(u="="+f.f).indexOf(",")>=0&&(u='"'+u.replace(fC,'""')+'"'));l.push(u)}return!1===o.blankrows&&c?null:l.join(s)}function gC(e,t){var n=[],r=null==t?{}:t;if(null==e||null==e["!ref"])return"";var a=IT(e["!ref"]),i=void 0!==r.FS?r.FS:",",s=i.charCodeAt(0),o=void 0!==r.RS?r.RS:"\n",c=o.charCodeAt(0),l=new RegExp(("|"==i?"\\|":i)+"+$"),u="",d=[];r.dense=Array.isArray(e);for(var h=r.skipHidden&&e["!cols"]||[],f=r.skipHidden&&e["!rows"]||[],p=a.s.c;p<=a.e.c;++p)(h[p]||{}).hidden||(d[p]=wT(p));for(var g=0,m=a.s.r;m<=a.e.r;++m)(f[m]||{}).hidden||null!=(u=pC(e,a,m,d,s,c,i,r))&&(r.strip&&(u=u.replace(l,"")),(u||!1!==r.blankrows)&&n.push((g++?o:"")+u));return delete r.dense,n.join("")}function mC(e,t){t||(t={}),t.FS="\t",t.RS="\n";var n=gC(e,t);if("undefined"==typeof ab||"string"==t.type)return n;var r=ab.utils.encode(1200,n,"str");return String.fromCharCode(255)+String.fromCharCode(254)+r}function vC(e,t,n){var r,a=n||{},i=+!a.skipHeader,s=e||{},o=0,c=0;if(s&&null!=a.origin)if("number"==typeof a.origin)o=a.origin;else{var l="string"==typeof a.origin?ET(a.origin):a.origin;o=l.r,c=l.c}var u={s:{c:0,r:0},e:{c:c,r:o+t.length-1+i}};if(s["!ref"]){var d=IT(s["!ref"]);u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),-1==o&&(o=d.e.r+1,u.e.r=o+t.length-1+i)}else-1==o&&(o=0,u.e.r=t.length-1+i);var h=a.header||[],f=0;t.forEach((function(e,t){mw(e).forEach((function(n){-1==(f=h.indexOf(n))&&(h[f=h.length]=n);var l=e[n],u="z",d="",p=TT({c:c+f,r:o+t+i});r=yC(s,p),!l||"object"!==typeof l||l instanceof Date?("number"==typeof l?u="n":"boolean"==typeof l?u="b":"string"==typeof l?u="s":l instanceof Date?(u="d",a.cellDates||(u="n",l=bw(l)),d=a.dateNF||Nb[14]):null===l&&a.nullError&&(u="e",l=0),r?(r.t=u,r.v=l,delete r.w,delete r.R,d&&(r.z=d)):s[p]=r={t:u,v:l},d&&(r.z=d)):s[p]=l}))})),u.e.c=Math.max(u.e.c,c+h.length-1);var p=yT(o);if(i)for(f=0;f<h.length;++f)s[wT(f+c)+p]={t:"s",v:h[f]};return s["!ref"]=ST(u),s}function yC(e,t,n){if("string"==typeof t){if(Array.isArray(e)){var r=ET(t);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return yC(e,TT("number"!=typeof t?t:{r:t,c:n||0}))}function bC(){return{SheetNames:[],Sheets:{}}}function wC(e,t,n,r){var a=1;if(!n)for(;a<=65535&&-1!=e.SheetNames.indexOf(n="Sheet"+a);++a,n=void 0);if(!n||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(n)>=0){var i=n.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var s=i&&i[1]||n;for(++a;a<=65535&&-1!=e.SheetNames.indexOf(n=s+a);++a);}if(Uk(n),e.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return e.SheetNames.push(n),e.Sheets[n]=t,n}function EC(e,t,n){return t?(e.l={Target:t},n&&(e.l.Tooltip=n)):delete e.l,e}var TC={encode_col:wT,encode_row:yT,encode_cell:TT,encode_range:ST,decode_col:bT,decode_row:vT,split_cell:function(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:ET,decode_range:xT,format_cell:_T,sheet_add_aoa:AT,sheet_add_json:vC,sheet_add_dom:C_,aoa_to_sheet:NT,json_to_sheet:function(e,t){return vC(null,e,t)},table_to_sheet:A_,table_to_book:function(e,t){return CT(A_(e,t),t)},sheet_to_csv:gC,sheet_to_txt:mC,sheet_to_json:hC,sheet_to_html:__,sheet_to_formulae:function(e){var t,n="",r="";if(null==e||null==e["!ref"])return[];var a,i=IT(e["!ref"]),s="",o=[],c=[],l=Array.isArray(e);for(a=i.s.c;a<=i.e.c;++a)o[a]=wT(a);for(var u=i.s.r;u<=i.e.r;++u)for(s=yT(u),a=i.s.c;a<=i.e.c;++a)if(n=o[a]+s,r="",void 0!==(t=l?(e[u]||[])[a]:e[n])){if(null!=t.F){if(n=t.F,!t.f)continue;r=t.f,-1==n.indexOf(":")&&(n=n+":"+n)}if(null!=t.f)r=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)r=""+t.v;else if("b"==t.t)r=t.v?"TRUE":"FALSE";else if(void 0!==t.w)r="'"+t.w;else{if(void 0===t.v)continue;r="s"==t.t?"'"+t.v:""+t.v}}c[c.length]=n+"="+r}return c},sheet_to_row_object_array:hC,sheet_get_cell:yC,book_new:bC,book_append_sheet:wC,book_set_sheet_visibility:function(e,t,n){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=function(e,t){if("number"==typeof t){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"==typeof t){var n=e.SheetNames.indexOf(t);if(n>-1)return n;throw new Error("Cannot find sheet name |"+t+"|")}throw new Error("Cannot find sheet |"+t+"|")}(e,t);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}e.Workbook.Sheets[r].Hidden=n},cell_set_number_format:function(e,t){return e.z=t,e},cell_set_hyperlink:EC,cell_set_internal_link:function(e,t,n){return EC(e,"#"+t,n)},cell_add_comment:function(e,t,n){e.c||(e.c=[]),e.c.push({t:t,a:n||"SheetJS"})},sheet_set_array_formula:function(e,t,n,r){for(var a="string"!=typeof t?t:IT(t),i="string"==typeof t?t:ST(t),s=a.s.r;s<=a.e.r;++s)for(var o=a.s.c;o<=a.e.c;++o){var c=yC(e,s,o);c.t="n",c.F=i,delete c.v,s==a.s.r&&o==a.s.c&&(c.f=n,r&&(c.D=!0))}return e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};qy.version;const xC=e=>{let{assignments:t=[],availablePlazas:n=[],solicitudes:a=[],procesarTodasLasSolicitudes:i,procesarSolicitudesPorMinuto:s,cargarDatosDesdeFirebase:o,eliminarSolicitudesDuplicadas:c,limpiarDuplicadosHistorial:l,db:u,loadingProcess:d,processingMessage:h,showNotification:f,lastProcessed:p,procesarSolicitudes:g}=e;const[m,v]=(0,r.useState)(!1),[y,b]=(0,r.useState)(!1),[w,E]=(0,r.useState)(""),[T,x]=(0,r.useState)(""),[S,I]=(0,r.useState)(""),[k,_]=(0,r.useState)(""),[C,A]=(0,r.useState)(""),[N,R]=(0,r.useState)([]),[O,D]=(0,r.useState)(!1),[P,L]=(0,r.useState)({}),[M,F]=(0,r.useState)(null),[z,j]=(0,r.useState)(""),[U,B]=(0,r.useState)(!1),[V,$]=(0,r.useState)(null),[H,W]=(0,r.useState)(!1),[G,K]=(0,r.useState)("");if(!m)return(0,$y.jsxs)("div",{style:{maxWidth:"1280px",margin:"0 auto",padding:"20px",fontFamily:"Arial, sans-serif",display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",flexDirection:"column"},children:[(0,$y.jsx)("h1",{style:{marginBottom:"30px",color:"#2c3e50"},children:"Panel de Administraci\xf3n"}),(0,$y.jsxs)("div",{style:{backgroundColor:"white",padding:"30px",borderRadius:"10px",boxShadow:"0 4px 15px rgba(0,0,0,0.1)",width:"100%",maxWidth:"400px"},children:[(0,$y.jsx)("h2",{style:{textAlign:"center",marginBottom:"25px"},children:"Autenticaci\xf3n Requerida"}),y&&(0,$y.jsx)("div",{style:{backgroundColor:"#f8d7da",color:"#721c24",padding:"10px",borderRadius:"5px",marginBottom:"15px",textAlign:"center"},children:"Contrase\xf1a incorrecta. Int\xe9ntalo de nuevo."}),(0,$y.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,$y.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"bold"},children:"Contrase\xf1a de Administrador:"}),(0,$y.jsx)("input",{type:"password",value:w,onChange:e=>E(e.target.value),style:{width:"100%",padding:"12px",border:"1px solid #ddd",borderRadius:"5px",fontSize:"16px"},placeholder:"Ingrese la contrase\xf1a",onKeyDown:e=>{"Enter"===e.key&&("SoyAdmin"===w?v(!0):b(!0))}})]}),(0,$y.jsx)("button",{onClick:()=>{"SoyAdmin"===w?v(!0):b(!0)},style:{width:"100%",padding:"12px",backgroundColor:"#3498db",color:"white",border:"none",borderRadius:"5px",fontSize:"16px",fontWeight:"bold",cursor:"pointer"},children:"Acceder"}),(0,$y.jsx)("div",{style:{marginTop:"20px",textAlign:"center"},children:(0,$y.jsx)("a",{href:"/",style:{color:"#3498db",textDecoration:"none"},children:"Volver a la p\xe1gina principal"})})]})]});const q=async()=>{try{A("A\xf1adiendo centros seleccionados...");const e=N.filter(((e,t)=>P[t]));if(0===e.length)return f("No hay centros seleccionados para a\xf1adir","warning"),void A("");let t=(await Vf(Mh(u,"centros"))).size+1;const n=100;let r=0;for(let a=0;a<e.length;a+=n){const i=Jf(u),s=e.slice(a,Math.min(a+n,e.length));for(const e of s){const n=Fh(Mh(u,"centros"));i.set(n,{id:(t++).toString(),codigo:e.codigo,centro:e.centro,nombre:e.centro,localidad:e.municipio,municipio:e.municipio,plazas:e.plazas,plazasTotal:e.plazas,asignadas:0,plazasOcupadas:0,plazasDisponibles:e.plazas,docId:n.id,timestamp:Qf()}),r++}await i.commit(),A(`A\xf1adiendo centros: ${r}/${e.length}`)}await o(),f(`Se han a\xf1adido ${r} centros correctamente`,"success"),D(!1),R([]),L({}),A("")}catch(kC){console.error("Error al a\xf1adir centros:",kC),f(`Error al a\xf1adir centros: ${kC.message}`,"error"),A("")}},Y=async()=>{if(M&&z)try{A("Realizando asignaci\xf3n manual...");const e=M.orden||M.numeroOrden;if(!e)return f("Error: La solicitud no tiene un n\xfamero de orden v\xe1lido","error"),void A("");const r=n.find((e=>e.id===z));if(!r)return f("Centro no encontrado","error"),void A("");const a=t.find((t=>t.order===e||t.numeroOrden===e)),i=Jf(u);a&&a.docId&&i.delete(Fh(u,"asignaciones",a.docId));const s={order:e,numeroOrden:e,centerId:r.id,centerName:r.nombre||r.centro,localidad:r.localidad||"",municipio:r.municipio||"",centro:r.nombre||r.centro,timestamp:Date.now(),asignacionManual:!0};Object.keys(s).forEach((e=>{void 0===s[e]&&(console.warn(`Campo ${e} es undefined en la asignaci\xf3n. Se establecer\xe1 valor predeterminado.`),e.includes("Id")||"order"===e||"numeroOrden"===e?s[e]="0":"timestamp"===e?s[e]=Date.now():"boolean"===typeof s[e]?s[e]=!1:s[e]="")}));const c=Fh(Mh(u,"asignaciones"));i.set(c,s);const l={orden:e,numeroOrden:e,centroId:r.id,estado:"ASIGNADA_MANUAL",mensaje:`Asignaci\xf3n manual desde panel de administraci\xf3n a ${r.nombre||r.centro}`,fechaHistorico:(new Date).toISOString(),timestamp:Date.now(),centrosSeleccionados:M.centrosIds||M.centrosSeleccionados||[]},d=Fh(Mh(u,"historialSolicitudes"));i.set(d,l),M.docId&&i.delete(Fh(u,"solicitudesPendientes",M.docId)),await i.commit(),await o(),f(`Orden ${e} asignada manualmente a ${r.nombre||r.centro}`,"success"),B(!1),F(null)}catch(kC){console.error("Error al realizar asignaci\xf3n manual:",kC),f(`Error: ${kC.message}`,"error")}finally{A("")}else f("Por favor, seleccione un centro para asignar","error")},X=async()=>{if(V&&G)try{A("Realizando reasignaci\xf3n...");const e=V.order||V.numeroOrden,t=V.docId||V.id;if(!e)return f("Error: No se pudo obtener el n\xfamero de orden","error"),void A("");if(!t)return f("Error: No se pudo obtener el ID de la asignaci\xf3n","error"),void A("");const r=n.find((e=>e.id===G));if(!r)return f("Error: Informaci\xf3n del nuevo centro no encontrada","error"),void A("");const a=V.centro||V.centerName||V.nombreCentro||"Centro desconocido",i=Jf(u),s=Fh(u,"asignaciones",t);i.delete(s);const c={order:e,numeroOrden:e,centerId:r.id,centerName:r.nombre||r.centro,centro:r.nombre||r.centro,nombreCentro:r.nombre||r.centro,localidad:r.localidad||"",municipio:r.municipio||"",timestamp:Date.now(),asignacionManual:!0,reasignado:!0,centroOriginal:a,centroPrevio:a};Object.keys(c).forEach((e=>{void 0===c[e]&&(console.warn(`Campo ${e} es undefined en la asignaci\xf3n. Se establecer\xe1 valor predeterminado.`),e.includes("Id")||"order"===e||"numeroOrden"===e?c[e]="0":"timestamp"===e?c[e]=Date.now():"boolean"===typeof c[e]?c[e]=!1:c[e]="")}));const l=Fh(Mh(u,"asignaciones"));i.set(l,c);const d=new Date,h={orden:e,numeroOrden:e,centroId:r.id,estado:"REASIGNADO",mensaje:`Reasignaci\xf3n manual desde panel de administraci\xf3n de ${a} a ${r.nombre||r.centro}`,fechaHistorico:d.toISOString(),timestamp:d.getTime(),centroOriginal:a,centroAsignado:r.nombre||r.centro};V.centerId&&(h.centroIdAnterior=V.centerId);const p=Fh(Mh(u,"historialSolicitudes"));i.set(p,h),await i.commit(),await o(),f(`Asignaci\xf3n #${e} reasignada de ${a} a ${r.nombre||r.centro}`,"success"),W(!1),$(null),K("")}catch(kC){console.error("Error al realizar reasignaci\xf3n:",kC),f(`Error al reasignar: ${kC.message}`,"error")}finally{A("")}else f("Por favor, seleccione un centro para reasignar","error")},Q=async()=>{if(M)try{A("Procesando solicitud no asignable...");const e=M.orden||M.numeroOrden,t=M.docId;if(!e)return f("Error: La solicitud no tiene n\xfamero de orden","error"),void A("");if(!t)return f("Error: La solicitud no tiene identificador","error"),void A("");const n=Jf(u),r={order:e,numeroOrden:e,noAsignable:!0,estado:"NO_ASIGNABLE",centro:"No hay plaza disponible",centerName:"No hay plaza disponible",nombreCentro:"No hay plaza disponible",mensaje:"No hay plazas disponibles en ninguno de los centros seleccionados",timestamp:Date.now(),asignacionManual:!0},a=Fh(Mh(u,"asignaciones"));n.set(a,r);const i=new Date,s={orden:e,numeroOrden:e,estado:"NO_ASIGNABLE",mensaje:"No hay plazas disponibles en ninguno de los centros seleccionados",fechaHistorico:i.toISOString(),timestamp:i.getTime(),centrosSeleccionados:M.centrosIds||M.centrosSeleccionados||[]},c=Fh(Mh(u,"historialSolicitudes"));n.set(c,s),n.delete(Fh(u,"solicitudesPendientes",t)),await n.commit(),await o(),f(`Solicitud ${e} marcada como no asignable por falta de opciones`,"info"),B(!1),F(null)}catch(kC){console.error("Error al marcar como no asignable:",kC),f(`Error: ${kC.message}`,"error")}finally{A("")}else f("Error: No hay solicitud seleccionada","error")},J=async()=>{if(V)try{A("Procesando reasignaci\xf3n no viable...");const e=V.order||V.numeroOrden,t=V.docId||V.id,n=V.centro||V.centerName||"Centro desconocido";if(!e)return f("Error: La asignaci\xf3n no tiene n\xfamero de orden","error"),void A("");if(!t)return f("Error: La asignaci\xf3n no tiene identificador","error"),void A("");const r=Jf(u),a={intentoReasignacion:!0,fechaIntentoReasignacion:(new Date).toISOString(),mensajeReasignacion:"Reasignaci\xf3n no viable por falta de plazas disponibles",estado:"REASIGNACION_NO_VIABLE"},i=Fh(u,"asignaciones",t);r.update(i,a);const s=new Date,c={orden:e,numeroOrden:e,estado:"REASIGNACION_NO_VIABLE",centroId:V.centerId,mensaje:`No es posible reasignar. Se mantiene en ${n} por falta de opciones disponibles`,fechaHistorico:s.toISOString(),timestamp:s.getTime(),centrosSeleccionados:V.centrosIdsOriginales||[]},l=Fh(Mh(u,"historialSolicitudes"));r.set(l,c),await r.commit(),await o(),f(`Se mantiene la asignaci\xf3n de ${e} en ${n} por falta de alternativas`,"info"),W(!1),$(null),K("")}catch(kC){console.error("Error al mantener asignaci\xf3n:",kC),f(`Error: ${kC.message}`,"error")}finally{A("")}else f("Error: No hay asignaci\xf3n seleccionada","error")};return(0,$y.jsxs)("div",{style:{maxWidth:"1280px",margin:"0 auto",padding:"20px",fontFamily:"Arial, sans-serif"},children:[(0,$y.jsx)("h1",{style:{marginBottom:"30px",color:"#2c3e50"},children:"Panel de Administraci\xf3n"}),C&&(0,$y.jsx)("div",{style:{position:"fixed",top:"20px",right:"20px",backgroundColor:"#3498db",color:"white",padding:"15px 20px",borderRadius:"5px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",zIndex:1e3},children:(0,$y.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,$y.jsx)("div",{style:{width:"20px",height:"20px",borderRadius:"50%",border:"2px solid rgba(255,255,255,0.5)",borderTopColor:"white",animation:"spin 1s linear infinite",marginRight:"10px"}}),C]})}),(0,$y.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"10px",padding:"20px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",marginBottom:"20px"},children:[(0,$y.jsx)("h3",{style:{margin:0,marginBottom:"15px",color:"#2c3e50"},children:"Acciones R\xe1pidas"}),(0,$y.jsxs)("div",{style:{display:"flex",gap:"10px",flexWrap:"wrap"},children:[(0,$y.jsx)("button",{onClick:async()=>{window.confirm("\xbfEst\xe1 seguro de que desea procesar todas las solicitudes pendientes manualmente? Esta acci\xf3n asignar\xe1 plazas autom\xe1ticamente en base a las preferencias de los usuarios.")&&(await i({respetarAsignacionesExistentes:!1}),await o())},style:{padding:"8px 12px",backgroundColor:"#3498db",color:"white",border:"none",borderRadius:"5px",cursor:"pointer"},disabled:d,children:d?"Procesando...":"Procesar Todas las Solicitudes (Manual)"}),(0,$y.jsx)("button",{onClick:async()=>{A("Recargando datos...");try{await o(),f("Datos recargados correctamente","success")}catch(kC){f("Error al recargar datos: "+kC.message,"error")}finally{A("")}},style:{padding:"8px 12px",backgroundColor:"#2ecc71",color:"white",border:"none",borderRadius:"5px",cursor:"pointer"},children:"Recargar Datos"})]})]}),(0,$y.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"10px",padding:"20px",boxShadow:"0 2px 10px rgba(0,0,0,0.05)",marginBottom:"20px"},children:[(0,$y.jsx)("h3",{style:{marginTop:0,color:"#2c3e50",marginBottom:"15px"},children:"Importaci\xf3n y Comparaci\xf3n de Centros"}),O?(0,$y.jsxs)("div",{children:[(0,$y.jsxs)("div",{style:{marginBottom:"15px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,$y.jsxs)("h4",{style:{margin:0},children:["Centros Nuevos Encontrados: ",N.length]}),(0,$y.jsxs)("div",{children:[(0,$y.jsx)("button",{onClick:()=>{const e={};N.forEach(((t,n)=>{e[n]=!0})),L(e)},style:{padding:"5px 10px",backgroundColor:"#2ecc71",color:"white",border:"none",borderRadius:"3px",cursor:"pointer",marginRight:"10px",fontSize:"12px"},children:"Seleccionar Todos"}),(0,$y.jsx)("button",{onClick:()=>{const e={};N.forEach(((t,n)=>{e[n]=!1})),L(e)},style:{padding:"5px 10px",backgroundColor:"#e74c3c",color:"white",border:"none",borderRadius:"3px",cursor:"pointer",fontSize:"12px"},children:"Deseleccionar Todos"})]})]}),(0,$y.jsx)("div",{style:{maxHeight:"400px",overflowY:"auto",border:"1px solid #eee",borderRadius:"5px",marginBottom:"15px"},children:(0,$y.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,$y.jsx)("thead",{children:(0,$y.jsxs)("tr",{style:{backgroundColor:"#f8f9fa",position:"sticky",top:0},children:[(0,$y.jsx)("th",{style:{padding:"10px",textAlign:"left",borderBottom:"1px solid #eee"},children:"Selec."}),(0,$y.jsx)("th",{style:{padding:"10px",textAlign:"left",borderBottom:"1px solid #eee"},children:"C\xf3digo"}),(0,$y.jsx)("th",{style:{padding:"10px",textAlign:"left",borderBottom:"1px solid #eee"},children:"Centro"}),(0,$y.jsx)("th",{style:{padding:"10px",textAlign:"left",borderBottom:"1px solid #eee"},children:"Municipio"}),(0,$y.jsx)("th",{style:{padding:"10px",textAlign:"left",borderBottom:"1px solid #eee"},children:"Plazas"})]})}),(0,$y.jsx)("tbody",{children:N.map(((e,t)=>(0,$y.jsxs)("tr",{style:{borderBottom:"1px solid #eee"},children:[(0,$y.jsx)("td",{style:{padding:"8px"},children:(0,$y.jsx)("input",{type:"checkbox",checked:P[t]||!1,onChange:()=>{L((e=>({...e,[t]:!e[t]})))}})}),(0,$y.jsx)("td",{style:{padding:"8px"},children:e.codigo}),(0,$y.jsx)("td",{style:{padding:"8px"},children:e.centro}),(0,$y.jsx)("td",{style:{padding:"8px"},children:e.municipio}),(0,$y.jsx)("td",{style:{padding:"8px"},children:e.plazas})]},t)))})]})}),(0,$y.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,$y.jsx)("button",{onClick:()=>{D(!1),R([]),L({})},style:{padding:"10px 20px",backgroundColor:"#f1f1f1",color:"#333",border:"none",borderRadius:"5px",cursor:"pointer"},children:"Cancelar"}),(0,$y.jsx)("button",{onClick:q,style:{padding:"10px 20px",backgroundColor:"#2ecc71",color:"white",border:"none",borderRadius:"5px",cursor:"pointer"},disabled:""!==C,children:C?(0,$y.jsxs)("span",{className:"processing-btn",children:[(0,$y.jsx)("span",{className:"processing-indicator"}),"Procesando..."]}):`A\xf1adir ${Object.values(P).filter(Boolean).length} centros seleccionados`})]})]}):(0,$y.jsxs)("div",{children:[(0,$y.jsx)("p",{style:{marginBottom:"20px"},children:"Selecciona un archivo Excel o CSV para comparar con los centros existentes y a\xf1adir los nuevos."}),(0,$y.jsxs)("div",{style:{display:"flex",justifyContent:"center",marginBottom:"10px"},children:[(0,$y.jsx)("input",{type:"file",id:"fileInput",accept:".csv,.xlsx",style:{display:"none"},onChange:async e=>{if(e.target.files&&e.target.files.length>0){const t=e.target.files[0];await(async e=>{try{A("Analizando archivo...");const o=await Vf(Mh(u,"centros")),c={},l={};o.forEach((e=>{const t=e.data();if(t.codigo&&(c[t.codigo.toLowerCase()]={...t,docId:e.id}),t.centro){const n=t.centro.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");l[n]={...t,docId:e.id}}}));let d=[];if(e.name.toLowerCase().endsWith(".xlsx")){const a=uC(await e.arrayBuffer(),{type:"array"}),i=a.Sheets[a.SheetNames[0]],s=TC.sheet_to_json(i,{header:1});let o=-1;for(let e=0;e<Math.min(20,s.length);e++){const t=s[e];if(Array.isArray(t)&&t.some((e=>"string"===typeof e&&(e.toLowerCase().includes("codigo")||e.toLowerCase().includes("centro")||e.toLowerCase().includes("municipio")||e.toLowerCase().includes("cod")||e.toLowerCase().includes("cent"))))){o=e;break}}if(-1===o)throw new Error("No se encontr\xf3 una fila de encabezado v\xe1lida en el Excel. Prueba con otro archivo o formato.");const c=s[o];console.log("Encabezados encontrados:",c);const l=e=>{let t=c.findIndex((t=>"string"===typeof t&&e.some((e=>t.toUpperCase()===e.toUpperCase()))));return-1===t&&(t=c.findIndex((t=>"string"===typeof t&&e.some((e=>t.toUpperCase().includes(e.toUpperCase())))))),t},u=l(["CODIGO","C\xd3DIGO","COD","CODCENTRO","CODIGO_CENTRO"]),h=l(["CENTRO","CENT","NOMBRE","NOMBRE_CENTRO","NOMBRECENTRO","NOM_CENTRO"]),f=l(["MUNICIPIO","MUN","LOCALIDAD","LOCAL","CIUDAD"]),p=l(["PLAZAS","PLAZA","PLAZ","NUM_PLAZAS","PLAZAS_DISPONIBLES"]);if(console.log("\xcdndices de columnas:",{codigo:u,centro:h,municipio:f,plazas:p}),-1===u&&-1===h)throw new Error("No se encontraron las columnas necesarias (c\xf3digo o centro). Se necesita al menos una de estas columnas.");for(let e=o+1;e<s.length;e++){var t,n,r;const a=s[e];if(!Array.isArray(a))continue;const i=-1!==u&&u<a.length&&(null===(t=a[u])||void 0===t?void 0:t.toString().trim())||"",o=-1!==h&&h<a.length&&(null===(n=a[h])||void 0===n?void 0:n.toString().trim())||"",c=-1!==f&&f<a.length&&(null===(r=a[f])||void 0===r?void 0:r.toString().trim())||"";let l=1;if(-1!==p&&p<a.length&&void 0!==a[p]){const e=parseFloat(a[p]);!isNaN(e)&&e>0&&(l=e)}(i&&i.length>0||o&&o.length>0)&&d.push({codigo:i,centro:o||i,municipio:c,plazas:l})}}else{const t=(await e.text()).split("\n").map((e=>e.replace(/"/g,"").trim())).filter(Boolean);let n=";";const r=t[0];r&&(r.includes("\t")?(n="\t",console.log("Formato detectado: CSV con separador de tabulaciones")):r.includes(",")&&!r.includes(";")?(n=",",console.log("Formato detectado: CSV con separador de comas")):console.log("Formato detectado: CSV con separador de punto y coma"));let o=-1;for(let e=0;e<Math.min(20,t.length);e++){const n=t[e].toLowerCase();if(n.includes("codigo")||n.includes("centro")||n.includes("municipio")||n.includes("cod")||n.includes("cent")){o=e;break}}if(-1===o)throw new Error("No se encontr\xf3 una l\xednea de encabezado v\xe1lida en el CSV. Prueba con otro archivo o formato.");const c=t[o].split(n);console.log("Encabezados CSV encontrados:",c);const l=e=>{let t=c.findIndex((t=>"string"===typeof t&&e.some((e=>t.toUpperCase()===e.toUpperCase()))));return-1===t&&(t=c.findIndex((t=>"string"===typeof t&&e.some((e=>t.toUpperCase().includes(e.toUpperCase())))))),t},u=l(["CODIGO","C\xd3DIGO","COD","CODCENTRO","CODIGO_CENTRO"]),h=l(["CENTRO","CENT","NOMBRE","NOMBRE_CENTRO","NOMBRECENTRO","NOM_CENTRO"]),f=l(["MUNICIPIO","MUN","LOCALIDAD","LOCAL","CIUDAD"]),p=l(["PLAZAS","PLAZA","PLAZ","NUM_PLAZAS","PLAZAS_DISPONIBLES"]);if(console.log("\xcdndices de columnas CSV:",{codigo:u,centro:h,municipio:f,plazas:p}),-1===u&&-1===h)throw new Error("No se encontraron las columnas necesarias (c\xf3digo o centro). Se necesita al menos una de estas columnas.");for(let e=o+1;e<t.length;e++){var a,i,s;const r=t[e].split(n),o=-1!==u&&u<r.length&&(null===(a=r[u])||void 0===a?void 0:a.trim())||"",c=-1!==h&&h<r.length&&(null===(i=r[h])||void 0===i?void 0:i.trim())||"",l=-1!==f&&f<r.length&&(null===(s=r[f])||void 0===s?void 0:s.trim())||"";let g=1;if(-1!==p&&p<r.length&&void 0!==r[p]){const e=parseFloat(r[p]);!isNaN(e)&&e>0&&(g=e)}(o&&o.length>0||c&&c.length>0)&&d.push({codigo:o,centro:c||o,municipio:l,plazas:g})}}console.log(`Se encontraron ${d.length} centros en el archivo`);const h=d.filter((e=>{const t=e.codigo.toLowerCase(),n=e.centro.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return!c[t]&&!l[n]}));R(h);const f={};return h.forEach(((e,t)=>{f[t]=!0})),L(f),D(!0),A(""),{total:d.length,nuevos:h.length}}catch(kC){return console.error("Error al comparar centros:",kC),f(`Error al analizar archivo: ${kC.message}`,"error"),A(""),null}})(t)}}}),(0,$y.jsx)("button",{onClick:()=>document.getElementById("fileInput").click(),style:{padding:"10px 20px",backgroundColor:"#3498db",color:"white",border:"none",borderRadius:"5px",cursor:"pointer",fontSize:"14px"},children:"Seleccionar Archivo"})]})]})]}),(()=>{const e=[...a].sort(((e,t)=>(e.orden||e.numeroOrden||0)-(t.orden||t.numeroOrden||0))),r=e.filter((e=>!S||e.orden&&e.orden.toString().includes(S)||e.numeroOrden&&e.numeroOrden.toString().includes(S)));return(0,$y.jsxs)("div",{style:{marginTop:"30px"},children:[(0,$y.jsx)("h3",{children:"Solicitudes Pendientes"}),(0,$y.jsx)("div",{style:{marginBottom:"15px"},children:(0,$y.jsx)("input",{type:"text",placeholder:"Buscar por n\xfamero de orden...",value:S,onChange:e=>I(e.target.value),style:{width:"100%",padding:"10px",borderRadius:"4px",border:"1px solid #ddd"}})}),0===r.length?(0,$y.jsx)("div",{style:{padding:"20px",textAlign:"center",color:"#666",backgroundColor:"#f9f9f9",borderRadius:"4px"},children:"No hay solicitudes pendientes"}):(0,$y.jsx)("div",{style:{overflowX:"auto"},children:(0,$y.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,$y.jsx)("thead",{children:(0,$y.jsxs)("tr",{style:{backgroundColor:"#f5f5f5"},children:[(0,$y.jsx)("th",{style:{padding:"10px",textAlign:"left",borderBottom:"1px solid #ddd"},children:"Prioridad"}),(0,$y.jsx)("th",{style:{padding:"10px",textAlign:"left",borderBottom:"1px solid #ddd"},children:"N\xba Orden"}),(0,$y.jsx)("th",{style:{padding:"10px",textAlign:"left",borderBottom:"1px solid #ddd"},children:"Fecha"}),(0,$y.jsx)("th",{style:{padding:"10px",textAlign:"left",borderBottom:"1px solid #ddd"},children:"Centros Disponibles"}),(0,$y.jsx)("th",{style:{padding:"10px",textAlign:"center",borderBottom:"1px solid #ddd"},children:"Acciones"})]})}),(0,$y.jsx)("tbody",{children:r.map(((e,r)=>{const a=e.centrosIds||e.centrosSeleccionados||[];let i="Fecha no disponible";try{if("number"===typeof e.timestamp){const t=new Date(e.timestamp);isNaN(t.getTime())||(i=t.toLocaleDateString()+" "+t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))}else if("string"===typeof e.timestamp){const t=new Date(e.timestamp);isNaN(t.getTime())||(i=t.toLocaleDateString()+" "+t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))}else if(e.fechaSolicitud){const t=new Date(e.fechaSolicitud);isNaN(t.getTime())||(i=t.toLocaleDateString()+" "+t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))}}catch(kC){console.warn("Error al formatear fecha:",kC)}const s=a.map((e=>{const r=n.find((t=>t.id===e));if(!r)return null;const a=r.plazasTotal||r.plazas||0,i=t.filter((t=>t.centerId===e&&!t.noAsignable&&"NO_ASIGNABLE"!==t.estado&&"REASIGNACION_NO_VIABLE"!==t.estado)).length,s=r.plazasOcupadas||r.asignadas||i||0,o=Math.max(0,a-s);return{...r,plazasDisponiblesActualizadas:o,plazasOcupadasActualizadas:s}})).filter(Boolean),o=s.filter((e=>e.plazasDisponiblesActualizadas>0)),c=o.length>0,l=e.orden||e.numeroOrden||0,u=0===r;let d={color:"#666",backgroundColor:"#f5f5f5",label:"Normal"};return u?d={color:"white",backgroundColor:"#4caf50",label:"Alta"}:l<=50&&(d={color:"white",backgroundColor:"#ff9800",label:"Media"}),(0,$y.jsxs)("tr",{style:{borderBottom:"1px solid #eee",backgroundColor:u?"#f1f8e9":""},children:[(0,$y.jsx)("td",{style:{padding:"10px"},children:(0,$y.jsx)("span",{style:{display:"inline-block",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"bold",backgroundColor:d.backgroundColor,color:d.color},children:d.label})}),(0,$y.jsx)("td",{style:{padding:"10px",fontWeight:u?"bold":"normal"},children:l}),(0,$y.jsx)("td",{style:{padding:"10px"},children:i}),(0,$y.jsx)("td",{style:{padding:"10px"},children:s.length>0?(0,$y.jsxs)("div",{children:[(0,$y.jsxs)("div",{style:{marginBottom:"5px"},children:[(0,$y.jsx)("strong",{children:o.length})," centros con plazas de ",(0,$y.jsx)("strong",{children:s.length})," seleccionados"]}),(0,$y.jsxs)("ul",{style:{margin:"0",paddingLeft:"20px"},children:[s.slice(0,3).map(((e,t)=>{const n=e.plazasDisponiblesActualizadas>0;return(0,$y.jsx)("li",{style:{color:n?"inherit":"#d32f2f",marginBottom:"4px"},children:(0,$y.jsxs)("div",{children:[(0,$y.jsx)("strong",{children:e.nombre||e.centro}),n?(0,$y.jsxs)("span",{style:{color:"#388e3c",fontSize:"12px",fontWeight:"bold",marginLeft:"5px"},children:["(",e.plazasDisponiblesActualizadas," plazas)"]}):(0,$y.jsx)("span",{style:{color:"#d32f2f",fontSize:"12px",fontWeight:"bold",marginLeft:"5px"},children:"(Sin plazas)"})]})},t)})),s.length>3&&(0,$y.jsxs)("li",{children:["Y ",s.length-3," m\xe1s..."]})]})]}):(0,$y.jsx)("span",{style:{color:"#999"},children:"Sin centros seleccionados"})}),(0,$y.jsxs)("td",{style:{padding:"10px",textAlign:"center"},children:[(0,$y.jsx)("button",{onClick:()=>(e=>{F(e),j(""),B(!0)})(e),style:{padding:"6px 12px",backgroundColor:c?"#4caf50":"#cccccc",color:"white",border:"none",borderRadius:"4px",cursor:c?"pointer":"not-allowed",marginRight:"5px"},title:c?"Asignar manualmente":"No hay centros con plazas disponibles",disabled:!c,children:"Asignar Manual"}),!c&&(0,$y.jsx)("div",{style:{fontSize:"11px",color:"#d32f2f",marginTop:"5px",fontWeight:"bold"},children:"Sin centros disponibles"})]})]},e.docId||r)}))})]})})]})})(),(()=>{const e=t.filter((e=>!k||e.order&&e.order.toString().includes(k)||e.numeroOrden&&e.numeroOrden.toString().includes(k)||e.centro&&e.centro.toLowerCase().includes(k.toLowerCase())||e.nombreCentro&&e.nombreCentro.toLowerCase().includes(k.toLowerCase())));return(0,$y.jsxs)("div",{style:{marginTop:"30px"},children:[(0,$y.jsx)("h3",{children:"Asignaciones Realizadas"}),(0,$y.jsx)("div",{style:{marginBottom:"15px"},children:(0,$y.jsx)("input",{type:"text",placeholder:"Buscar por n\xfamero de orden o centro...",value:k,onChange:e=>_(e.target.value),style:{width:"100%",padding:"10px",borderRadius:"4px",border:"1px solid #ddd"}})}),0===e.length?(0,$y.jsx)("div",{style:{padding:"20px",textAlign:"center",color:"#666",backgroundColor:"#f9f9f9",borderRadius:"4px"},children:"No hay asignaciones que coincidan con la b\xfasqueda"}):(0,$y.jsx)("div",{style:{overflowX:"auto"},children:(0,$y.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,$y.jsx)("thead",{children:(0,$y.jsxs)("tr",{style:{backgroundColor:"#f5f5f5"},children:[(0,$y.jsx)("th",{style:{padding:"10px",textAlign:"left",borderBottom:"1px solid #ddd"},children:"N\xba Orden"}),(0,$y.jsx)("th",{style:{padding:"10px",textAlign:"left",borderBottom:"1px solid #ddd"},children:"Centro Asignado"}),(0,$y.jsx)("th",{style:{padding:"10px",textAlign:"left",borderBottom:"1px solid #ddd"},children:"Plazas"}),(0,$y.jsx)("th",{style:{padding:"10px",textAlign:"left",borderBottom:"1px solid #ddd"},children:"Fecha Asignaci\xf3n"}),(0,$y.jsx)("th",{style:{padding:"10px",textAlign:"center",borderBottom:"1px solid #ddd"},children:"Acciones"})]})}),(0,$y.jsx)("tbody",{children:e.map(((e,r)=>{const a=e.order||e.numeroOrden,i=!0===e.noAsignable||"NO_ASIGNABLE"===e.estado,s="REASIGNACION_NO_VIABLE"===e.estado,o=i?"No hay plaza disponible":e.nombreCentro||e.centro||e.centerName||"Centro sin nombre",c=i?null:n.find((t=>t.id===e.centerId)),l=c&&(c.plazasTotal||c.plazas)||0,d=c?t.filter((t=>t.centerId===e.centerId&&!t.noAsignable&&"NO_ASIGNABLE"!==t.estado&&"REASIGNACION_NO_VIABLE"!==t.estado)).length:0,h=c?c.plazasOcupadas||c.asignadas||d||0:d,p=Math.max(0,l-h),g=new Date(e.timestamp),m=g&&!isNaN(g.getTime())?g.toLocaleDateString()+" "+g.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"Fecha no disponible";return(0,$y.jsxs)("tr",{style:{borderBottom:"1px solid #eee",backgroundColor:i?"#ffebee":s?"#fff8e1":""},children:[(0,$y.jsx)("td",{style:{padding:"10px"},children:a}),(0,$y.jsxs)("td",{style:{padding:"10px"},children:[(0,$y.jsxs)("div",{style:{fontWeight:"bold",display:"flex",alignItems:"center"},children:[o,i&&(0,$y.jsx)("span",{style:{backgroundColor:"#f44336",color:"white",padding:"2px 6px",borderRadius:"3px",fontSize:"11px",marginLeft:"8px"},children:"No asignable"}),s&&(0,$y.jsx)("span",{style:{backgroundColor:"#ff9800",color:"white",padding:"2px 6px",borderRadius:"3px",fontSize:"11px",marginLeft:"8px"},children:"Reasignaci\xf3n no viable"})]}),!i&&(0,$y.jsxs)("div",{style:{fontSize:"12px",color:"#666"},children:[e.localidad&&`${e.localidad}`,e.municipio&&e.municipio!==e.localidad&&` - ${e.municipio}`]}),i&&(0,$y.jsx)("div",{style:{fontSize:"12px",color:"#d32f2f"},children:"No hay plazas disponibles en ning\xfan centro seleccionado"}),s&&(0,$y.jsx)("div",{style:{fontSize:"12px",color:"#e65100"},children:e.mensajeReasignacion||"No fue posible reasignar por falta de plazas"})]}),(0,$y.jsx)("td",{style:{padding:"10px"},children:i?(0,$y.jsx)("div",{style:{color:"#d32f2f",fontWeight:"bold",fontSize:"13px"},children:"Sin plazas"}):(0,$y.jsxs)("div",{children:[(0,$y.jsxs)("div",{style:{color:0===p?"#d32f2f":p<3?"#ff9800":"#388e3c",fontWeight:"bold",fontSize:"13px"},children:[p," disponibles / ",l," totales"]}),(0,$y.jsxs)("div",{style:{fontSize:"12px",color:"#666"},children:[h," plazas ocupadas"]})]})}),(0,$y.jsx)("td",{style:{padding:"10px"},children:m}),(0,$y.jsx)("td",{style:{padding:"10px",textAlign:"center"},children:i?(0,$y.jsx)("span",{style:{color:"#999",fontSize:"12px"},children:"No disponible"}):(0,$y.jsx)("button",{onClick:()=>(async e=>{try{if(!e)return void f("Error: Asignaci\xf3n no v\xe1lida","error");const t=e.numeroOrden||e.order,n=await Vf(If(Mh(u,"historialSolicitudes"),_f("orden","==",t)));let r=[];n.forEach((e=>{r.push(e.data())})),0===r.length&&(await Vf(If(Mh(u,"historialSolicitudes"),_f("numeroOrden","==",t)))).forEach((e=>{r.push(e.data())}));let a=[];r.forEach((e=>{e.centrosSeleccionados&&Array.isArray(e.centrosSeleccionados)&&(a=e.centrosSeleccionados)})),0===a.length&&e.centerId&&(a=[e.centerId]),$({...e,centrosIdsOriginales:a}),K(""),W(!0)}catch(kC){console.error("Error al preparar reasignaci\xf3n:",kC),f(`Error al preparar reasignaci\xf3n: ${kC.message}`,"error")}})(e),style:{padding:"6px 12px",backgroundColor:"#ff9800",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},title:"Reasignar esta asignaci\xf3n",children:"Reasignar"})})]},e.docId||r)}))})]})})]})})(),(0,$y.jsx)("div",{style:{marginTop:"40px"},children:(0,$y.jsx)("footer",{style:{padding:"20px 15px",borderTop:"1px solid #ddd",backgroundColor:"#f8f9fa",textAlign:"center",color:"#333",fontSize:"14px",width:"100%",position:"relative",display:"block"},children:(0,$y.jsxs)("div",{style:{maxWidth:"1280px",margin:"0 auto"},children:[(0,$y.jsxs)("p",{style:{margin:"10px 0"},children:["Realizado por ",(0,$y.jsx)("a",{href:"https://ag-marketing.es",target:"_blank",rel:"noopener noreferrer",style:{color:"#18539E",textDecoration:"none",fontWeight:"bold"},children:"AG-Marketing"})]}),(0,$y.jsxs)("p",{style:{margin:"10px 0"},children:["\xa9 ",(new Date).getFullYear()," - Todos los derechos reservados"]})]})})}),U&&M&&(()=>{if(!M)return null;const e=M.centrosIds||M.centrosSeleccionados||[],r=n.filter((t=>e.includes(t.id))),i=M.orden||M.numeroOrden||0,s=a.filter((e=>(e.orden||e.numeroOrden||0)<i)).length>0,o=1===r.length,c=r.map((e=>{const n=t.filter((t=>t.centerId===e.id&&!t.noAsignable&&"NO_ASIGNABLE"!==t.estado&&"REASIGNACION_NO_VIABLE"!==t.estado)).length,r=e.plazasTotal||e.plazas||0,a=e.plazasOcupadas||e.asignadas||n||0,i=Math.max(0,r-a);return{...e,plazasDisponiblesActualizadas:i,plazasOcupadasActualizadas:a}})),l=c.every((e=>e.plazasDisponiblesActualizadas<=0));return(0,$y.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0.5)",zIndex:1e3,display:"flex",justifyContent:"center",alignItems:"center"},children:(0,$y.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"8px",padding:"20px",width:"90%",maxWidth:"600px",maxHeight:"90vh",overflow:"auto",boxShadow:"0 4px 20px rgba(0,0,0,0.2)"},children:[(0,$y.jsxs)("h3",{style:{borderBottom:"1px solid #eee",paddingBottom:"10px"},children:["Asignaci\xf3n Manual - Orden #",i]}),s&&o&&(0,$y.jsxs)("div",{style:{backgroundColor:"#fff3cd",border:"1px solid #ffeeba",borderRadius:"4px",padding:"12px",marginBottom:"15px",color:"#856404"},children:[(0,$y.jsx)("strong",{children:"\xa1Atenci\xf3n!"})," Esta solicitud tiene menor prioridad que otras pendientes y solo tiene una opci\xf3n disponible. Considere procesar primero las solicitudes con n\xfamero de orden menores."]}),s&&!o&&(0,$y.jsxs)("div",{style:{backgroundColor:"#fff3cd",border:"1px solid #ffeeba",borderRadius:"4px",padding:"12px",marginBottom:"15px",color:"#856404"},children:[(0,$y.jsx)("strong",{children:"Aviso:"})," Existen solicitudes con n\xfamero de orden menor pendientes."]}),(0,$y.jsx)("p",{style:{marginBottom:"20px"},children:"Seleccione uno de los centros preferidos por el usuario para realizar la asignaci\xf3n manual:"}),(0,$y.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,$y.jsx)("h4",{children:"Centros seleccionados por el usuario:"}),c.length>0?(0,$y.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"10px",maxHeight:"300px",overflow:"auto",padding:"10px",border:"1px solid #eee",borderRadius:"5px"},children:c.map(((e,t)=>{const n=e.plazasDisponiblesActualizadas<=0;return(0,$y.jsxs)("div",{style:{padding:"10px",borderRadius:"5px",border:"1px solid #ddd",backgroundColor:z===e.id?"#e3f2fd":n?"#ffebee":"white",cursor:n?"not-allowed":"pointer",opacity:n?.7:1},onClick:()=>{n||j(e.id)},children:[(0,$y.jsxs)("div",{style:{fontWeight:"bold"},children:[t+1,". ",e.nombre||e.centro]}),(0,$y.jsxs)("div",{style:{fontSize:"14px",color:"#666"},children:[e.localidad&&`${e.localidad}`,e.municipio&&e.municipio!==e.localidad&&` - ${e.municipio}`]}),(0,$y.jsxs)("div",{style:{fontSize:"14px",marginTop:"5px",color:n?"#d32f2f":"#388e3c",fontWeight:"bold"},children:["Plazas: ",(0,$y.jsx)("strong",{children:e.plazasDisponiblesActualizadas})," disponibles de ",e.plazasTotal||e.plazas||0,n&&" - SIN PLAZAS DISPONIBLES"]})]},e.id)}))}):(0,$y.jsx)("div",{style:{color:"#d32f2f",padding:"10px",textAlign:"center"},children:"No hay centros disponibles para esta solicitud."})]}),(0,$y.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",borderTop:"1px solid #eee",paddingTop:"15px"},children:[l&&(0,$y.jsx)("div",{style:{marginRight:"auto",color:"#d32f2f",fontWeight:"bold",fontSize:"14px",display:"flex",alignItems:"center"},children:"\u26a0\ufe0f No hay plazas disponibles en ning\xfan centro seleccionado"}),(0,$y.jsx)("button",{onClick:()=>B(!1),style:{padding:"8px 15px",borderRadius:"4px",border:"1px solid #ddd",backgroundColor:"white",cursor:"pointer"},children:"Cancelar"}),l&&(0,$y.jsx)("button",{onClick:Q,style:{padding:"8px 15px",borderRadius:"4px",border:"none",backgroundColor:"#f44336",color:"white",cursor:"pointer"},children:"No se puede asignar"}),(0,$y.jsx)("button",{onClick:Y,disabled:!z,style:{padding:"8px 15px",borderRadius:"4px",border:"none",backgroundColor:z?"#2196f3":"#cccccc",color:"white",cursor:z?"pointer":"not-allowed"},children:"Asignar"})]})]})})})(),H&&V&&(()=>{if(!V)return null;const e=V.centrosIdsOriginales||[],r=n.filter((t=>e.includes(t.id))).map((e=>{const n=t.filter((t=>t.centerId===e.id&&!t.noAsignable&&"NO_ASIGNABLE"!==t.estado&&"REASIGNACION_NO_VIABLE"!==t.estado)).length,r=e.plazasTotal||e.plazas||0,a=e.plazasOcupadas||e.asignadas||n||0,i=Math.max(0,r-a);return{...e,plazasDisponiblesActualizadas:i,plazasOcupadasActualizadas:a}})),a=V.centerId,i=0===r.filter((e=>e.id!==a&&e.plazasDisponiblesActualizadas>0)).length,s=V.order||V.numeroOrden||0,o=V.centro||V.centerName||"Centro desconocido";return(0,$y.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0.5)",zIndex:1e3,display:"flex",justifyContent:"center",alignItems:"center"},children:(0,$y.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"8px",padding:"20px",width:"90%",maxWidth:"600px",maxHeight:"90vh",overflow:"auto",boxShadow:"0 4px 20px rgba(0,0,0,0.2)"},children:[(0,$y.jsxs)("h3",{style:{borderBottom:"1px solid #eee",paddingBottom:"10px"},children:["Reasignaci\xf3n - Orden #",s]}),(0,$y.jsxs)("div",{style:{backgroundColor:"#e8f4fd",border:"1px solid #bedcf3",borderRadius:"4px",padding:"12px",marginBottom:"15px",color:"#0d4c8c"},children:[(0,$y.jsx)("strong",{children:"Centro actual:"})," ",o]}),(0,$y.jsx)("p",{style:{marginBottom:"20px"},children:"Seleccione un nuevo centro para reasignar directamente esta solicitud:"}),(0,$y.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,$y.jsx)("h4",{children:"Centros disponibles:"}),r.length>0?(0,$y.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"10px",maxHeight:"300px",overflow:"auto",padding:"10px",border:"1px solid #eee",borderRadius:"5px"},children:r.map(((e,t)=>{const n=e.plazasDisponiblesActualizadas<=0,r=e.id===V.centerId;return(0,$y.jsxs)("div",{style:{padding:"10px",borderRadius:"5px",border:r?"2px solid #ffb74d":"1px solid #ddd",backgroundColor:G===e.id?"#e3f2fd":r?"#fff8e1":n?"#ffebee":"white",cursor:n?"not-allowed":"pointer",opacity:n?.7:1},onClick:()=>{n||K(e.id)},children:[(0,$y.jsxs)("div",{style:{fontWeight:"bold",display:"flex",justifyContent:"space-between"},children:[(0,$y.jsxs)("span",{children:[t+1,". ",e.nombre||e.centro]}),r&&(0,$y.jsx)("span",{style:{backgroundColor:"#ff9800",color:"white",padding:"2px 6px",borderRadius:"3px",fontSize:"11px"},children:"Actual"})]}),(0,$y.jsxs)("div",{style:{fontSize:"14px",color:"#666"},children:[e.localidad&&`${e.localidad}`,e.municipio&&e.municipio!==e.localidad&&` - ${e.municipio}`]}),(0,$y.jsxs)("div",{style:{fontSize:"14px",marginTop:"5px",color:n?"#d32f2f":"#388e3c",fontWeight:"bold"},children:["Plazas: ",(0,$y.jsx)("strong",{children:e.plazasDisponiblesActualizadas})," disponibles de ",e.plazasTotal||e.plazas||0,n&&" - SIN PLAZAS DISPONIBLES"]})]},e.id)}))}):(0,$y.jsx)("div",{style:{color:"#d32f2f",padding:"10px",textAlign:"center"},children:"No hay centros disponibles para reasignar."})]}),(0,$y.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",borderTop:"1px solid #eee",paddingTop:"15px"},children:[i&&(0,$y.jsx)("div",{style:{marginRight:"auto",color:"#d32f2f",fontWeight:"bold",fontSize:"14px",display:"flex",alignItems:"center"},children:"\u26a0\ufe0f No hay centros alternativos con plazas disponibles"}),(0,$y.jsx)("button",{onClick:()=>W(!1),style:{padding:"8px 15px",borderRadius:"4px",border:"1px solid #ddd",backgroundColor:"white",cursor:"pointer"},children:"Cancelar"}),i&&(0,$y.jsx)("button",{onClick:J,style:{padding:"8px 15px",borderRadius:"4px",border:"none",backgroundColor:"#f44336",color:"white",cursor:"pointer"},children:"No se puede reasignar"}),(0,$y.jsx)("button",{onClick:X,disabled:!G,style:{padding:"8px 15px",borderRadius:"4px",border:"none",backgroundColor:G?"#ff9800":"#cccccc",color:"white",cursor:G?"pointer":"not-allowed"},children:"Reasignar"})]})]})})})()]})};const SC=function(){const[e,t]=(0,r.useState)([]),[n,a]=(0,r.useState)([]),[i,s]=(0,r.useState)([]),[o,c]=(0,r.useState)([]),[l,u]=(0,r.useState)(!1),[d,h]=(0,r.useState)(""),[f,p]=(0,r.useState)(!1),[g,m]=(0,r.useState)(new Date),[v,y]=(0,r.useState)(45),[b,w]=(0,r.useState)(!1),[E,T]=(0,r.useState)(!1),[x,S]=(0,r.useState)(!1),[I,k]=(0,r.useState)("Iniciando sistema y verificando datos..."),[_,C]=(0,r.useState)(10),[A,N]=(0,r.useState)(!1),[R,O]=(0,r.useState)(!1),[D,P]=(0,r.useState)(!1),[L,M]=(0,r.useState)(""),[F,z]=(0,r.useState)([]),[j,U]=(0,r.useState)(!1),[B,V]=(0,r.useState)(null),[$,H]=(0,r.useState)(""),[W,G]=(0,r.useState)(""),[K,q]=(0,r.useState)(!1),[Y,X]=(0,r.useState)(""),[Q,J]=(0,r.useState)("success"),[Z,ee]=(0,r.useState)("asignaciones"),te=(0,r.useRef)(!1),ne=(0,r.useRef)(!1),re=(0,r.useRef)(!1),ae=(0,r.useRef)(null),ie=((0,r.useRef)(0),(0,r.useRef)(null)),se=(0,r.useRef)(0),oe=(0,r.useRef)(!1),[ce,le]=(0,r.useState)(!1),[ue,de]=(0,r.useState)({show:!1,message:"",type:""}),[he,fe]=(0,r.useState)(""),[pe,ge]=(0,r.useState)(!1),[me,ve]=(0,r.useState)(""),[ye,be]=(0,r.useState)(!1),[we,Ee]=(0,r.useState)(""),[Te,xe]=(0,r.useState)("all"),[Se,Ie]=(0,r.useState)({}),[ke,_e]=(0,r.useState)({}),[Ce,Ae]=(0,r.useState)({}),[Ne,Re]=(0,r.useState)({}),[Oe,De]=(0,r.useState)({asignaciones:0,pendientes:0,centros:0,historial:0}),Pe=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";X(e),J(t),q(!0),"error"!==t&&setTimeout((()=>{q(!1)}),5e3)},Le=async()=>{if(!b){w(!0),h("Reseteando y recalculando contadores de asignaciones...");try{await ze();const t=await(async(e,t,n)=>{try{for(const t of e)if(t.docId)try{await Hf(Fh(n,"centros",t.docId),{asignadas:0})}catch(kC){console.error(`Error al resetear contador para ${t.centro}:`,kC)}const r={};for(const e of t){const t=e.centroId||e.id;t&&(r[t]=(r[t]||0)+1)}let a=0,i=0;for(const t of e){const e=t.id;if(e&&r[e]&&t.docId)try{await Hf(Fh(n,"centros",t.docId),{asignadas:r[e]}),a++}catch(kC){console.error(`Error al actualizar contador para ${t.centro}:`,kC),i++}}return{success:!0,actualizados:a,errores:i,message:`Contadores reiniciados. ${a} centros actualizados.`}}catch(kC){return console.error("Error al resetear contadores:",kC),{success:!1,error:kC.message,message:"Error al resetear contadores: "+kC.message}}})(e,n,By);se.current=Date.now(),await ze(),t.success?Pe(`Contadores recalculados correctamente: ${t.actualizados} centros actualizados.`,"success"):Pe(`Error al recalcular contadores: ${t.message}`,"error")}catch(kC){console.error("Error al resetear contadores:",kC),Pe(`Error al resetear contadores: ${kC.message}`,"error")}finally{w(!1),h("")}}},Me=async e=>{try{let o=null;if(e&&e.target&&e.target.files&&e.target.files.length>0)o=e.target.files[0];else try{const e="/asignacion-plazas/plazas.csv",t=await fetch(e);if(t.ok){const e=await t.text();o=new Blob([e],{type:"text/csv"})}else{console.log("CSV no encontrado en la ubicaci\xf3n predeterminada, abriendo di\xe1logo de selecci\xf3n...");const e=document.createElement("input");e.type="file",e.accept=".csv,.xlsx";const t=new Promise((t=>{e.onchange=e=>t(e.target.files[0])}));e.click(),o=await t}}catch(kC){console.error("Error al intentar cargar CSV autom\xe1ticamente:",kC);const t=document.createElement("input");t.type="file",t.accept=".csv,.xlsx";const n=new Promise((e=>{t.onchange=t=>e(t.target.files[0])}));t.click(),o=await n}p(!0),h("Cargando y procesando archivo CSV...");try{h("Obteniendo centros existentes...");const e=await Vf(Mh(By,"centros")),c={},l={};let u;e.forEach((e=>{const t=e.data();if(t.codigo&&(c[t.codigo]={...t,docId:e.id}),t.centro){const n=t.centro.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");l[n]={...t,docId:e.id}}})),console.log(`Se encontraron ${e.size} centros existentes`);if((o.name?o.name.toLowerCase():"").endsWith(".xlsx"))throw h("Procesando archivo Excel..."),new Error("El procesamiento de archivos Excel no est\xe1 implementado a\xfan");if(h("Procesando archivo CSV..."),u=await o.text(),u.length<100)throw new Error("El archivo CSV parece estar vac\xedo o es demasiado peque\xf1o");const d=u.split("\n").map((e=>e.replace(/"/g,"").trim())).filter(Boolean);if(d.length<5)throw new Error("El archivo CSV no contiene suficientes l\xedneas de datos");let f=d.findIndex((e=>e.includes("A.S.I.;")));if(-1===f){const e=d.findIndex((e=>e.includes("ASI;")||e.includes("DEPARTAMENTO;")||e.includes("CODIGO;")));if(-1===e)throw new Error("No se encontr\xf3 una l\xednea de encabezado v\xe1lida en el CSV");f=e}if(d[f].split(";").length<5)throw new Error("El formato del encabezado no es v\xe1lido, faltan columnas necesarias");const g=new Set,m=new Set,v=[],y=[];let b=Object.keys(c).length+1,w=0,E=0,T=0;h("Analizando datos del CSV...");for(let o=f+1;o<d.length;o++){var t,n,r,a,i,s;const e=d[o].trim();if(!e)continue;if(e.includes("de 11")||e.includes("TOTAL ="))continue;const u=e.split(";");if(u.length<5){E++;continue}const f=(null===(t=u[0])||void 0===t?void 0:t.trim())||"",p=(null===(n=u[1])||void 0===n?void 0:n.trim())||"",x=(null===(r=u[2])||void 0===r?void 0:r.trim())||"",S=(null===(a=u[3])||void 0===a?void 0:a.trim())||"",I=(null===(i=u[4])||void 0===i?void 0:i.trim())||"";if(!x||x.length<2){console.warn(`L\xednea ${o+1}: C\xf3digo inv\xe1lido o ausente: "${x}"`),E++;continue}if(!S||S.length<2){console.warn(`L\xednea ${o+1}: Nombre de centro inv\xe1lido o ausente: "${S}"`),E++;continue}if(!I){console.warn(`L\xednea ${o+1}: Municipio ausente para centro: "${S}"`),E++;continue}const k=`${x}-${S}-${I}`.toLowerCase();if(g.has(k)){T++;continue}m.has(x)&&console.warn(`Posible duplicado con c\xf3digo ${x}: "${S}" en ${I}`),g.add(k),m.add(x);let _=1;if(u.length>5&&null!==(s=u[5])&&void 0!==s&&s.trim()){const e=u[5].trim(),t=parseInt(e);!isNaN(t)&&t>0?_=t:console.warn(`L\xednea ${o+1}: Valor de plazas inv\xe1lido: "${e}", usando 1 por defecto`)}else console.warn(`L\xednea ${o+1}: No se especific\xf3 n\xfamero de plazas para "${S}", usando 1 por defecto`);w+=_;const C=c[x],A=S.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),N=l[A];C?y.push({...C,asi:f||C.asi,departamento:p||C.departamento,centro:S||C.centro,localidad:I||C.localidad,municipio:I||C.municipio,plazas:_,asignadas:C.asignadas||0}):N?y.push({...N,asi:f||N.asi,departamento:p||N.departamento,codigo:x||N.codigo,localidad:I||N.localidad,municipio:I||N.municipio,plazas:_,asignadas:N.asignadas||0}):v.push({id:String(b++),asi:f,departamento:p,codigo:x,centro:S,localidad:I,municipio:I,plazas:_,asignadas:0}),(v.length+y.length)%100===0&&h(`Procesando CSV: ${v.length} nuevos, ${y.length} actualizados...`)}if(0===v.length+y.length)throw new Error("No se pudieron extraer centros v\xe1lidos del CSV");h(`Actualizando ${y.length} centros existentes...`);for(const t of y)t.docId&&await Hf(Fh(By,"centros",t.docId),{...t});h(`A\xf1adiendo ${v.length} nuevos centros a Firebase...`);const x=100;for(let t=0;t<v.length;t+=x){const e=v.slice(t,t+x);h(`A\xf1adiendo nuevos centros: ${t}/${v.length}`);for(const t of e){const e=Fh(Mh(By,"centros"));await $f(e,{...t,docId:e.id})}}return h("Datos cargados correctamente"),await ze(),p(!1),Pe(`Se han actualizado ${y.length} centros y a\xf1adido ${v.length} nuevos centros correctamente`,"success"),!0}catch(kC){return console.error("Error al cargar o procesar el CSV:",kC),Pe(`Error en la importaci\xf3n: ${kC.message}`,"error"),p(!1),!1}}catch(kC){return console.error("Error al cargar datos desde CSV:",kC),Pe(`Error al cargar datos desde CSV: ${kC.message}`,"error"),p(!1),!1}},Fe=async e=>{try{h(`Limpiando colecci\xf3n ${e}...`);const t=await Vf(Mh(By,e));if(t.size>0)for(const n of t.docs)await Wf(Fh(By,e,n.id));return!0}catch(kC){throw console.error(`Error al limpiar colecci\xf3n ${e}:`,kC),kC}},ze=async()=>{console.log("Iniciando carga de datos desde Firebase...");try{console.log("Verificando colecciones disponibles en Firebase..."),console.log("Intentando cargar centros...");let e=await Vf(Mh(By,"centros"));if(e.empty){console.warn("\u26a0\ufe0f No se encontraron centros en la colecci\xf3n 'centros'");const t=Mh(By,"centrosTrabajo");e=await Vf(t),e.empty?console.error("\u274c No se encontraron centros en ninguna colecci\xf3n"):console.log("\u2705 Se encontraron centros en la colecci\xf3n 'centrosTrabajo':",e.size)}else console.log("\u2705 Se encontraron centros en la colecci\xf3n 'centros':",e.size);console.log("Intentando cargar asignaciones para contar plazas ocupadas...");let n=await Vf(Mh(By,"asignaciones"));if(n.empty){console.warn("\u26a0\ufe0f No se encontraron asignaciones en la colecci\xf3n 'asignaciones'");const e=Mh(By,"asignacionesActuales");n=await Vf(e),n.empty?console.error("\u274c No se encontraron asignaciones en ninguna colecci\xf3n"):console.log("\u2705 Se encontraron asignaciones en la colecci\xf3n 'asignacionesActuales':",n.size)}else console.log("\u2705 Se encontraron asignaciones en la colecci\xf3n 'asignaciones':",n.size);const r={};n.forEach((e=>{const t=e.data();if(t&&t.centerId){const e=t.centerId;r[e]=(r[e]||0)+1}})),console.log("Conteo de asignaciones por centro:",r);const i=new Set,o=new Set,l=new Map,u=[];e.forEach((e=>{const t=e.data(),n=t.nombre||t.centro||"Centro sin nombre",a=n.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g," ").trim(),i=t.codigoCentro||t.codigo||"",s=parseInt(t.plazas||t.plazasTotal||0,10),o=r[e.id]||0,c=Math.max(0,s-o);u.push({id:e.id,docId:e.id,nombre:n,nombreNormalizado:a,codigo:i,plazas:s,asignadas:o,plazasDisponibles:c,plazasOcupadas:o,plazasTotal:s,direccion:t.direccion||"",codigoCentro:i,estadoCentro:t.estadoCentro||"Activo",municipio:t.municipio||"",localidad:t.localidad||"",esDuplicado:!1,duplicadoDe:null})})),console.log(`Se encontraron ${u.length} centros en total antes de filtrar`);for(let t=0;t<u.length;t++){const e=u[t];if(!e.esDuplicado)if(i.has(e.id))e.esDuplicado=!0;else if(e.codigo&&o.has(e.codigo)&&console.warn(`Posible duplicado por c\xf3digo: ${e.codigo} - ${e.nombre}`),l.has(e.nombreNormalizado)){const t=l.get(e.nombreNormalizado);console.warn(`Duplicado por nombre: "${e.nombre}" duplica a ID=${t}`),e.esDuplicado=!0,e.duplicadoDe=t}else i.add(e.id),e.codigo&&o.add(e.codigo),l.set(e.nombreNormalizado,e.id)}const d=u.filter((e=>!e.esDuplicado));console.log(`Despu\xe9s de eliminar duplicados, quedan ${d.length} centros`);let h=d;h.length>366&&(console.warn(`A\xfan hay m\xe1s centros (${h.length}) de los esperados (366). Limitando...`),h=[...h].sort(((e,t)=>t.plazasTotal-e.plazasTotal)).slice(0,366));let f={};h.forEach((e=>{f[e.id]=e})),console.log(`Finalmente se cargar\xe1n ${Object.keys(f).length} centros`),0===Object.keys(f).length&&(console.warn("\u26a0\ufe0f Creando centros de prueba para diagn\xf3stico"),f.centro1={id:"centro1",nombre:"Centro de Prueba 1",plazas:10,asignadas:0,plazasDisponibles:10,plazasOcupadas:0,plazasTotal:10,direccion:"Direcci\xf3n de prueba",codigoCentro:"CP001",estadoCentro:"Activo"},f.centro2={id:"centro2",nombre:"Centro de Prueba 2",plazas:7,asignadas:2,plazasDisponibles:5,plazasOcupadas:2,plazasTotal:7,direccion:"Otra direcci\xf3n",codigoCentro:"CP002",estadoCentro:"Activo"}),console.log("Centros procesados:",Object.keys(f).length),console.log("Procesando asignaciones para mostrar...");const p={},g={};Object.values(f).forEach((e=>{if(p[e.id]=e,e.nombre){const t=e.nombre.toUpperCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");g[t]=e}if(e.centro&&e.centro!==e.nombre){const t=e.centro.toUpperCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");g[t]=e}})),console.log("Centros indexados:",{porId:Object.keys(p).length,porNombre:Object.keys(g).length});let m={};n.forEach((e=>{const t=e.data();if(console.log("Asignaci\xf3n encontrada:",e.id,t),t){let n=p[t.centerId];if(!n&&t.centro){const e=t.centro.toUpperCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");n=g[e],n&&console.log(`Centro encontrado por campo 'centro': "${t.centro}" corresponde a ID=${n.id}`)}if(!n&&t.centerId&&"string"===typeof t.centerId){const e=t.centerId.toUpperCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");n=g[e],n&&console.log(`Centro encontrado por centerId como nombre: "${t.centerId}" corresponde a ID=${n.id}`)}if(!n&&t.centerName){const e=t.centerName.toUpperCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");n=g[e],n&&console.log(`Centro encontrado por centerName: "${t.centerName}" corresponde a ID=${n.id}`)}let r="Centro no encontrado";n?r=n.nombre:t.centro?r=t.centro:t.centerName?r=t.centerName:t.centerId&&"string"===typeof t.centerId&&t.centerId.length>5&&(r=t.centerId),m[e.id]={id:e.id,numeroOrden:t.order||t.numeroOrden||0,centerId:t.centerId||t.centro||"",centroPrevio:t.centroPrevio||t.centroAnterior||"",nombreCentro:r,timestamp:t.timestamp||Date.now(),fechaAsignacion:t.fechaAsignacion||(new Date).toISOString(),centroAsociado:n}}})),console.log("Asignaciones procesadas:",Object.keys(m).length),console.log("Intentando cargar solicitudes pendientes...");const v=Mh(By,"solicitudesPendientes"),y=await Vf(v);y.empty?console.warn("\u26a0\ufe0f No se encontraron solicitudes pendientes"):console.log("\u2705 Se encontraron solicitudes pendientes:",y.size);let b={};y.forEach((e=>{const t=e.data();console.log("Solicitud encontrada:",e.id,t),b[e.id]={id:e.id,numeroOrden:t.orden||t.numeroOrden||0,centrosIds:t.centrosIds||t.centrosSeleccionados||[],timestamp:t.timestamp||Date.now(),fechaSolicitud:t.fechaSolicitud||(new Date).toISOString(),estado:t.estado||"Pendiente"}})),console.log("Solicitudes procesadas:",Object.keys(b).length),console.log("Intentando cargar historial...");const w=Mh(By,"historialSolicitudes"),E=await Vf(w);E.empty?console.warn("\u26a0\ufe0f No se encontr\xf3 historial de solicitudes"):console.log("\u2705 Se encontr\xf3 historial de solicitudes:",E.size);let T=[];E.forEach((e=>{var t,n;const r=e.data();T.push({id:e.id,numeroOrden:r.orden||r.numeroOrden||0,centerId:r.centerId||r.centro||"",centroPrevio:r.centroPrevio||"",centroAnterior:r.centroAnterior||"",nombreCentro:(null===(t=f[r.centerId])||void 0===t?void 0:t.nombre)||"Centro no encontrado",nombreCentroAnterior:r.centroAnterior?(null===(n=f[r.centroAnterior])||void 0===n?void 0:n.nombre)||"Centro no encontrado":"",timestamp:r.timestamp||Date.now(),fechaHistorico:r.fechaHistorico||(new Date).toISOString(),estado:r.estado||"Procesado",accion:r.accion||"Asignaci\xf3n",mensaje:r.mensaje||""})})),T.sort(((e,t)=>(t.timestamp||0)-(e.timestamp||0))),console.log("Historial procesado:",T.length,"registros"),t(Object.values(f)),a(Object.values(m)),s(Object.values(b)),c(T),Ie(f),_e(m),Ae(b);const x=Object.keys(m).length,S=Object.keys(b).length,I=Object.keys(f).length;De({asignaciones:x,pendientes:S,centros:I,historial:T.length});let k={};Object.values(f).forEach((e=>{k[e.id]={id:e.id,nombre:e.nombre,plazas:e.plazas,asignadas:e.asignadas,plazasDisponibles:e.plazasDisponibles,plazasTotal:e.plazasTotal,codigoCentro:e.codigoCentro,estadoCentro:e.estadoCentro}})),Re(k);const _=Object.values(f).reduce(((e,t)=>e+(t.plazasTotal||t.plazas||0)),0),C=Object.values(f).reduce(((e,t)=>e+(t.asignadas||t.plazasOcupadas||0)),0),A=Object.values(f).reduce(((e,t)=>{const n=t.plazasTotal||t.plazas||0,r=t.asignadas||t.plazasOcupadas||0;return e+Math.max(0,n-r)}),0);return console.log("Datos de plazas actualizados. Totales:",{totalCentros:Object.keys(f).length,totalPlazas:_,plazasAsignadas:C,plazasDisponibles:A}),console.log("Datos cargados correctamente:",{centros:I,asignaciones:x,pendientes:S,historial:T.length}),!0}catch(kC){return console.error("Error al cargar datos desde Firebase:",kC),console.error("Detalles del error:",kC.code,kC.message,kC.stack),!1}},je=()=>{const e=Gf(Mh(By,"centros"),(e=>{const n=new Set,r=new Map,a=[];e.forEach((e=>{const t=e.data(),n=t.nombre||t.centro||"Centro sin nombre",r=n.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g," ").trim();a.push({...t,docId:e.id,id:e.id,nombre:n,nombreNormalizado:r,esDuplicado:!1,duplicadoDe:null})}));for(let t=0;t<a.length;t++){const e=a[t];e.esDuplicado||(n.has(e.id)?e.esDuplicado=!0:r.has(e.nombreNormalizado)?(e.esDuplicado=!0,e.duplicadoDe=r.get(e.nombreNormalizado)):(n.add(e.id),r.set(e.nombreNormalizado,e.id)))}let i=a.filter((e=>!e.esDuplicado));i.length>366&&(i=[...i].sort(((e,t)=>(t.plazas||t.plazasTotal||0)-(e.plazas||e.plazasTotal||0))).slice(0,366)),i.length>0&&(t(i),console.log(`Listener: Actualizados ${i.length} centros filtrados`))})),n=Gf(Mh(By,"asignaciones"),(e=>{const t=[];e.forEach((e=>{const n=e.data(),r={...n,docId:e.id,order:"number"===typeof n.order?n.order:Number(n.order)||0,centro:n.centro||"No disponible",localidad:n.localidad||"No disponible",municipio:n.municipio||"No disponible",timestamp:n.timestamp||Date.now(),estado:n.estado||"ASIGNADA"};t.push(r)})),t.sort(((e,t)=>(Number(e.order)||0)-(Number(t.order)||0))),a(t)})),r=Gf(Mh(By,"solicitudesPendientes"),(e=>{const t=[];e.forEach((e=>{const n=e.data(),r={...n,docId:e.id,orden:"number"===typeof n.orden?n.orden:Number(n.orden)||0,centrosIds:n.centrosIds||n.centrosSeleccionados||[]};t.push(r)})),s(t)})),i=Gf(Mh(By,"historialSolicitudes"),(e=>{const t=[];e.forEach((e=>{t.push({...e.data(),docId:e.id})})),c(t)}));return()=>{e(),n(),r(),i()}},Ue=async()=>{try{p(!0),h("Cargando CSV autom\xe1ticamente...");try{const s="/asignacion-plazas/plazas.csv",o=await fetch(s);if(!o.ok)throw new Error(`Error al cargar el CSV: ${o.status} - ${o.statusText}`);const c=await o.text();if(!c||c.length<100)throw new Error("El archivo CSV est\xe1 vac\xedo o es demasiado peque\xf1o");const l=c.split("\n").map((e=>e.replace(/"/g,"").trim())).filter(Boolean);if(l.length<5)throw new Error("El archivo CSV no contiene suficientes l\xedneas de datos");let u=l.findIndex((e=>e.includes("A.S.I.;")));if(-1===u){const e=l.findIndex((e=>e.includes("ASI;")||e.includes("DEPARTAMENTO;")||e.includes("CODIGO;")));if(-1===e)throw new Error("No se encontr\xf3 una l\xednea de encabezado v\xe1lida en el CSV");u=e}if(l[u].split(";").length<5)throw new Error("El formato del encabezado no es v\xe1lido, faltan columnas necesarias");const d=new Set,f=new Set,g=[];let m=1,v=0,y=0,b=0;h("Analizando datos del CSV...");for(let p=u+1;p<l.length;p++){var e,t,n,r,a,i;const s=l[p].trim();if(!s)continue;if(s.includes("de 11")||s.includes("TOTAL ="))continue;const o=s.split(";");if(o.length<5){y++;continue}const c=(null===(e=o[0])||void 0===e?void 0:e.trim())||"",u=(null===(t=o[1])||void 0===t?void 0:t.trim())||"",w=(null===(n=o[2])||void 0===n?void 0:n.trim())||"",E=(null===(r=o[3])||void 0===r?void 0:r.trim())||"",T=(null===(a=o[4])||void 0===a?void 0:a.trim())||"";if(!w||w.length<2){console.warn(`L\xednea ${p+1}: C\xf3digo inv\xe1lido o ausente: "${w}"`),y++;continue}if(!E||E.length<2){console.warn(`L\xednea ${p+1}: Nombre de centro inv\xe1lido o ausente: "${E}"`),y++;continue}if(!T){console.warn(`L\xednea ${p+1}: Municipio ausente para centro: "${E}"`),y++;continue}const x=`${w}-${E}-${T}`.toLowerCase();if(d.has(x)){b++;continue}f.has(w)&&console.warn(`Posible duplicado con c\xf3digo ${w}: "${E}" en ${T}`),d.add(x),f.add(w);let S=1;if(o.length>5&&null!==(i=o[5])&&void 0!==i&&i.trim()){const e=o[5].trim(),t=parseInt(e);!isNaN(t)&&t>0?S=t:console.warn(`L\xednea ${p+1}: Valor de plazas inv\xe1lido: "${e}", usando 1 por defecto`)}else console.warn(`L\xednea ${p+1}: No se especific\xf3 n\xfamero de plazas para "${E}", usando 1 por defecto`);v+=S,g.push({id:String(m++),asi:c,departamento:u,codigo:w,centro:E,localidad:T,municipio:T,plazas:S,asignadas:0}),g.length%100===0&&h(`Procesando CSV: ${g.length} centros encontrados...`)}if(0===g.length)throw new Error("No se pudieron extraer centros v\xe1lidos del CSV");const w=7066;if(v!==w){const e=[...g].sort(((e,t)=>t.plazas-e.plazas)),t=v-w;if(Math.abs(t)>100&&console.warn(`Diferencia muy grande (${t} plazas) entre el total calculado y el objetivo`),t>0){let n=t,r=0;for(;n>0&&r<Math.min(5,e.length);){const a=e[r],i=Math.min(Math.ceil(t/5),a.plazas-1,n);i>0&&(a.plazas-=i,n-=i),r++}n>0&&(e[0].plazas-=n)}else if(t<0){let n=Math.abs(t),r=0;for(;n>0&&r<Math.min(5,e.length);){const a=e[r],i=Math.min(Math.ceil(Math.abs(t)/5),n);a.plazas+=i,n-=i,r++}n>0&&(e[0].plazas+=n)}const n=g.reduce(((e,t)=>e+t.plazas),0);if(n!==w)throw console.error(`Error en el ajuste: ${n} \u2260 ${w}`),new Error(`No se pudo ajustar el n\xfamero de plazas correctamente: ${n} \u2260 ${w}`)}h(`A\xf1adiendo ${g.length} centros a Firebase...`);let E=0;if((await Vf(Mh(By,"centros"))).size>0)return Pe("Se encontraron datos existentes. Usando datos actuales para evitar duplicaci\xf3n.","warning"),p(!1),await ze();const T=100;for(let e=0;e<g.length;e+=T){const t=g.slice(e,e+T);h(`A\xf1adiendo centros: ${e}/${g.length}`);for(const e of t){const t=Fh(Mh(By,"centros"));await $f(t,{...e,docId:t.id}),E++}}return h("Datos cargados correctamente"),await ze(),p(!1),Pe(`Se han cargado ${E} centros y exactamente ${w} plazas autom\xe1ticamente`,"success"),!0}catch(kC){return console.error("Error al cargar CSV autom\xe1ticamente:",kC),p(!1),!1}}catch(kC){return console.error("Error al cargar CSV autom\xe1ticamente:",kC),p(!1),!1}};(0,r.useEffect)((()=>{let e;return(async()=>{console.log("Inicializando aplicaci\xf3n...");try{console.log("Verificando si ya hay datos en Firebase...");const r=await Vf(Mh(By,"centros"));if(r.empty){console.log("No se encontraron centros. Intentando cargar desde CSV...");(await fetch("/asignacion-plazas/plazas.csv")).ok?(console.log("CSV encontrado, cargando datos autom\xe1ticamente..."),await Me(),console.log("Datos cargados desde CSV inicial.")):console.warn("CSV no encontrado en ubicaci\xf3n predeterminada")}else console.log("Datos existentes encontrados:",r.size,"centros");const a=window.location.pathname.split("/"),i="admin"===a[a.length-1];if(N(i),te.current||ne.current)return;te.current=!0;try{if(i){S(!0),k("Cargando datos para el panel de administraci\xf3n..."),C(5);const e=await We();if(!e.success)return S(!0),void k(`Error de conexi\xf3n: ${e.message}. Intenta recargar la p\xe1gina.`);k("Cargando centros y solicitudes..."),C(30);try{await ze(),console.log("Datos cargados correctamente para el panel de admin"),C(100),k("\xa1Datos cargados correctamente!"),setTimeout((()=>{S(!1)}),1e3)}catch(kC){console.error("Error al cargar datos para el panel de admin:",kC),k(`Error al cargar datos: ${kC.message}`),setTimeout((()=>{S(!1)}),2e3)}return ne.current=!0,void(te.current=!1)}const r=!(await Vf(Mh(By,"solicitudesPendientes"))).empty;(r||i)&&(S(!0),k("Iniciando sistema y verificando conexi\xf3n..."),C(5));const a=await We();if(!a.success)return S(!0),void k(`Error de conexi\xf3n: ${a.message}. Intenta recargar la p\xe1gina.`);(r||i)&&(k("Verificando datos..."),C(10));const s=await Vf(Mh(By,"centros"));if(0===s.size){k("Cargando datos iniciales..."),C(20),await Fe("centros");await Ue()||await Me()}else k("Cargando datos existentes..."),C(30),await ze();e=je(),k("Limpiando duplicados iniciales..."),C(50),console.log("Ejecutando limpieza inicial de duplicados");const o=await $e();if(o.error)console.error("Error durante la limpieza inicial:",o.error);else{const e=o.eliminadosSolicitudes+o.eliminadosAsignaciones+o.eliminadosHistorial;console.log(`Limpieza inicial completada: ${e} elementos duplicados eliminados`)}k("Moviendo solicitudes hist\xf3ricas a pendientes..."),C(60);try{const e=await He();e.error?console.error("Error en el volcado de historial:",e.error):e.volcados>0?(console.log(`Volcado inicial: ${e.volcados} solicitudes recuperadas del historial`),k(`Recuperadas ${e.volcados} solicitudes del historial`)):console.log("No hubo solicitudes para recuperar del historial")}catch(t){console.error("Error durante el volcado de historial:",t)}k("Procesando solicitudes pendientes..."),C(70);try{console.log("AVISO: El procesamiento autom\xe1tico de solicitudes est\xe1 deshabilitado."),console.log("Las asignaciones ahora son siempre manuales y deben realizarse desde el panel de administraci\xf3n.");const e=(await Vf(Mh(By,"solicitudesPendientes"))).docs.length;C(100),e>0?(k(`Hay ${e} solicitudes pendientes por procesar manualmente desde el panel de administraci\xf3n.`),console.log(`Hay ${e} solicitudes pendientes que deben procesarse manualmente desde el panel de administraci\xf3n.`)):(k("\xa1Sistema iniciado correctamente!"),setTimeout((()=>{S(!1),Pe("Sistema iniciado correctamente.","success")}),2e3))}catch(n){console.error("Error al procesar solicitudes iniciales:",n),k(`Error al procesar solicitudes: ${n.message}`),C(100),setTimeout((()=>{S(!1),Pe("Se produjo un error durante el procesamiento inicial: "+n.message,"error")}),2e3)}ne.current=!0}catch(kC){console.error("Error durante la inicializaci\xf3n:",kC),k(`Error: ${kC.message}`),setTimeout((()=>{S(!1),Pe("Error durante la inicializaci\xf3n: "+kC.message,"error")}),2e3)}finally{te.current=!1}}catch(kC){console.error("Error durante la inicializaci\xf3n:",kC),k(`Error: ${kC.message}`),setTimeout((()=>{S(!1),Pe("Error durante la inicializaci\xf3n: "+kC.message,"error")}),2e3)}})(),()=>{e&&e()}}),[]),(0,r.useEffect)((()=>{if(e.length>0){return(async()=>{i.length>0&&!l&&(await Be(!0),y(45))})(),()=>{ae.current&&clearInterval(ae.current)}}}),[e.length]),(0,r.useEffect)((()=>(E||(ie.current=setInterval((()=>{y((e=>e<=1?(!l&&i.length>0&&!E&&Be(!0),45):e-1))}),1e3)),()=>{ie.current&&clearInterval(ie.current)})),[l,i.length,E]);const Be=async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{respetarAsignacionesExistentes:r=!0}=t;if(re.current)return console.log("Ya hay un procesamiento en curso. Espera a que termine."),!1;re.current=!0,h("Iniciando procesamiento de solicitudes...");try{const t=await Vf(Mh(By,"solicitudesPendientes"));if(t.empty)return console.log("No hay solicitudes pendientes para procesar."),h("No hay solicitudes pendientes para procesar."),setTimeout((()=>{h(""),re.current=!1}),3e3),!0;const o=t.docs.map((e=>({...e.data(),docId:e.id,centrosIds:e.data().centrosIds||e.data().centrosSeleccionados||[]}))).sort(((e,t)=>Number(e.orden)-Number(t.orden)));console.log(`Procesando ${o.length} solicitudes pendientes ordenadas por prioridad...`),h(`Procesando ${o.length} solicitudes pendientes...`);let c=n;r?(console.log("Modo ejecuci\xf3n autom\xe1tica: Se respetar\xe1n las asignaciones existentes"),c=[]):console.log("Modo ejecuci\xf3n manual: Se procesar\xe1n todas las asignaciones seg\xfan prioridad");const l=await Vy(o,c,e,h);if(l.error)console.error("Error al procesar solicitudes:",l.error),h(`Error: ${l.error}`);else{if(console.log("Procesamiento completado:",l.message),h(l.message),!r)try{const e=await Ge();e&&e.corregidos>0&&(console.log(`Corregidas ${e.corregidos} asignaciones con exceso`),h((t=>`${t} Corregidas ${e.corregidos} asignaciones con exceso.`)))}catch(a){console.error("Error en verificaci\xf3n de asignaciones:",a)}fe((new Date).toLocaleString());try{await ze()}catch(i){console.error("Error al recargar datos:",i)}}try{const e=(await Vf(Mh(By,"solicitudesPendientes"))).docs.length;e>0?(console.log(`A\xfan quedan ${e} solicitudes pendientes por procesar`),h((t=>`${t} A\xfan quedan ${e} solicitudes pendientes.`)),e<5&&(console.log("Realizando un segundo intento autom\xe1tico para procesar solicitudes restantes..."),setTimeout((()=>{Be({respetarAsignacionesExistentes:r})}),3e3))):x&&setTimeout((()=>{S(!1),Pe("Sistema iniciado correctamente","success")}),2e3)}catch(s){console.error("Error al verificar solicitudes pendientes:",s)}return!0}catch(kC){return console.error("Error general al procesar solicitudes:",kC),h(`Error al procesar solicitudes: ${kC.message}`),!1}finally{setTimeout((()=>{re.current=!1}),3e3)}},Ve={container:{maxWidth:"1280px",margin:"0 auto",padding:"20px",backgroundColor:"#f8f9fa",minHeight:"calc(100vh - 120px)",fontFamily:"Arial, sans-serif",position:"relative"},header:{textAlign:"center",marginBottom:"30px",borderBottom:"1px solid #e7e7e7",paddingBottom:"15px"},title:{color:"#2c3e50",fontSize:"28px",margin:"0 0 10px 0"},subtitle:{color:"#7f8c8d",fontSize:"16px",fontWeight:"normal",margin:0},tabs:{display:"flex",gap:"2px",marginBottom:"20px",backgroundColor:"#e9ecef",borderRadius:"10px",padding:"3px",overflow:"hidden"},tab:{padding:"12px 20px",cursor:"pointer",flex:1,textAlign:"center",borderRadius:"8px",transition:"all 0.3s ease",fontSize:"15px",fontWeight:"500"},activeTab:{backgroundColor:"#fff",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",color:"#3498db"},inactiveTab:{backgroundColor:"transparent",color:"#7f8c8d"},sectionTitle:{fontSize:"20px",color:"#2c3e50",marginBottom:"15px",paddingBottom:"8px",borderBottom:"2px solid #e7e7e7"},cardContainer:{backgroundColor:"white",borderRadius:"10px",padding:"20px",boxShadow:"0 2px 10px rgba(0,0,0,0.05)",marginBottom:"20px"},popup:{position:"fixed",top:"20px",right:"20px",padding:"15px 20px",borderRadius:"10px",boxShadow:"0 3px 15px rgba(0,0,0,0.2)",zIndex:1e3,maxWidth:"350px",animation:"slideIn 0.3s ease"},processingButton:{padding:"12px 20px",backgroundImage:l?"linear-gradient(to right, #cccccc, #dddddd)":"linear-gradient(to right, #3498db, #2980b9)",color:"white",border:"none",borderRadius:"6px",cursor:l||0===i.length?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"15px",fontWeight:"500",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",margin:"10px auto"},reloadButton:{padding:"12px 20px",backgroundImage:f?"linear-gradient(to right, #cccccc, #dddddd)":"linear-gradient(to right, #e74c3c, #c0392b)",color:"white",border:"none",borderRadius:"6px",cursor:f?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"15px",fontWeight:"500",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",margin:"10px auto"},adminPanel:{display:"flex",justifyContent:"center",alignItems:"center",marginBottom:"20px"},adminButton:{padding:"12px 20px",backgroundImage:"linear-gradient(to right, #3498db, #2980b9)",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"15px",fontWeight:"500",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",margin:"10px auto"}};(0,r.useEffect)((()=>{const e=()=>{const e=Date.now(),t=se.current;(0===t||e-t>36e5)&&Le()};n.length>10&&e();const t=setInterval((()=>{e()}),9e5);return()=>clearInterval(t)}),[n.length]);const $e=async()=>{try{console.log("Ejecutando eliminaci\xf3n de solicitudes y asignaciones duplicadas...");const e=await Vf(Mh(By,"solicitudesPendientes")),t={},n=e.docs.length;e.docs.forEach((e=>{const n={...e.data(),docId:e.id},r=n.orden;r&&(t[r]?t[r].push(n):t[r]=[n])}));let r=0;Object.keys(t).forEach((e=>{const n=t[e];n.length>1&&(r+=n.length-1)}));const a=await Vf(Mh(By,"asignaciones")),i={},s=a.docs.length;a.docs.forEach((e=>{const t={...e.data(),docId:e.id},n=t.order;n&&(i[n]?i[n].push(t):i[n]=[t])}));let o=0;Object.keys(i).forEach((e=>{const t=i[e];t.length>1&&(o+=t.length-1)}));const c=await Vf(Mh(By,"historialSolicitudes")),l={};c.docs.forEach((e=>{const t={...e.data(),docId:e.id},n=t.orden,r=t.estado||"DESCONOCIDO";if(!n)return;const a=`${n}-${r}`;l[a]?l[a].push(t):l[a]=[t]}));let u=0;if(Object.keys(l).forEach((e=>{const t=l[e];t.length>1&&(u+=t.length-1)})),0===r&&0===o&&0===u)return console.log("No se encontraron elementos duplicados"),{eliminadosSolicitudes:0,eliminadosAsignaciones:0,eliminadosHistorial:0,totalSolicitudes:n,totalAsignaciones:s};console.log(`Se encontraron ${r} solicitudes duplicadas, ${o} asignaciones duplicadas y ${u} entradas duplicadas en historial`);const d=Jf(By);let h=0,f=0,p=0;for(const g in t){const e=t[g];if(e.length>1){e.sort(((e,t)=>{const n=e.timestamp||0;return(t.timestamp||0)-n}));const t=e.slice(1);for(const e of t)d.delete(Fh(By,"solicitudesPendientes",e.docId)),h++}}for(const g in i){const e=i[g];if(e.length>1){e.sort(((e,t)=>{const n=e.timestamp||0;return(t.timestamp||0)-n}));const t=e.slice(1);for(const e of t)d.delete(Fh(By,"asignaciones",e.docId)),f++}}for(const g in l){const e=l[g];if(e.length>1){e.sort(((e,t)=>{const n=e.timestamp||0;return(t.timestamp||0)-n}));const t=e.slice(1);for(const e of t)d.delete(Fh(By,"historialSolicitudes",e.docId)),p++}}return(h>0||f>0||p>0)&&await d.commit(),console.log(`Se eliminaron ${h} solicitudes duplicadas, ${f} asignaciones duplicadas y ${p} entradas duplicadas en historial`),{eliminadosSolicitudes:h,eliminadosAsignaciones:f,eliminadosHistorial:p,totalSolicitudes:n,totalAsignaciones:s}}catch(kC){return console.error("Error al eliminar duplicados:",kC),{error:kC.message,eliminadosSolicitudes:0,eliminadosAsignaciones:0,eliminadosHistorial:0}}};(0,r.useEffect)((()=>{if(oe.current)return void console.log("Verificaci\xf3n ya programada, ignorando programaci\xf3n duplicada");oe.current=!0;const e=()=>{const t=new Date,n=new Date;n.setHours(2,0,0,0),t.getHours()>=2&&n.setDate(n.getDate()+1);const r=n.getTime()-t.getTime();console.log(`Verificaci\xf3n diaria programada para ejecutarse en ${Math.floor(r/36e5)} horas y ${Math.floor(r%36e5/6e4)} minutos (2:00 AM)`);const a=setTimeout((()=>{console.log("Comprobando si se debe ejecutar la verificaci\xf3n diaria (2:00 AM)"),(()=>{const e=localStorage.getItem("ultimaVerificacionDiaria");if(e){const t=new Date(Number(e)),n=new Date;if(t.getDate()===n.getDate()&&t.getMonth()===n.getMonth()&&t.getFullYear()===n.getFullYear())return console.log(`La verificaci\xf3n diaria ya se ejecut\xf3 hoy a las ${t.toLocaleTimeString()}`),!0}return!1})()?(console.log("Saltando verificaci\xf3n, ya se ejecut\xf3 hoy"),e()):(console.log("Iniciando verificaci\xf3n diaria programada (2:00 AM)"),Be({respetarAsignacionesExistentes:!0}).then((()=>{localStorage.setItem("ultimaVerificacionDiaria",Date.now().toString()),console.log("Verificaci\xf3n diaria completada y marcada como ejecutada hoy"),e()})))}),r);return a},t=e();return()=>{clearTimeout(t),oe.current=!1}}),[]),(0,r.useEffect)((()=>{(async()=>{console.log("Iniciando limpieza inicial de duplicados...");if(!j&&!l){await $e();"true"!==localStorage.getItem("historialLimpiado")&&(console.log("Ejecutando limpieza de duplicados en historial..."),await Ke())}})()}),[j,l]);const He=async()=>{try{console.log("Volcando datos de historial a solicitudes pendientes...");const e=await Vf(Mh(By,"historialSolicitudes"));if(e.empty)return console.log("No hay entradas en el historial para procesar"),{volcados:0};const t=e.docs.map((e=>({...e.data(),docId:e.id})));console.log(`Se encontraron ${t.length} entradas en el historial`);const n=t.slice(0,5);console.log("Ejemplos de entradas en historial:",n);const r={};t.forEach((e=>{const t=e.estado||"SIN_ESTADO";r[t]=(r[t]||0)+1})),console.log("Conteo de estados en historial:",r);const a=t.filter((e=>e.centrosIds&&e.centrosIds.length>0)).length;console.log(`Entradas con centrosIds v\xe1lidos: ${a} de ${t.length}`);const i=await Vf(Mh(By,"solicitudesPendientes")),s=new Set;i.docs.forEach((e=>{const t=e.data();t.orden&&s.add(t.orden)}));(await Vf(Mh(By,"asignaciones"))).docs.forEach((e=>{const t=e.data();t.order&&s.add(t.order)})),console.log(`Se encontraron ${s.size} \xf3rdenes ya existentes`);const o=t.filter((e=>!!e.orden&&(!s.has(e.orden)&&(e.centrosIds&&e.centrosIds.length||!e.centroId?e.centrosIds&&e.centrosIds.length>0:(e.centrosIds=[e.centroId],!0)))));if(console.log(`Se volcar\xe1n ${o.length} entradas del historial`),0===o.length)return{volcados:0};console.log("Ejemplos de entradas a volcar:",o.slice(0,3));const c=100;let l=0;for(let u=0;u<o.length;u+=c){const e=Jf(By),t=o.slice(u,u+c);for(const n of t){const t={orden:n.orden,centrosIds:n.centrosIds||[n.centroId],timestamp:Date.now(),intentosFallidos:0},r={};if(Object.entries(t).forEach((e=>{let[t,a]=e;void 0!==a?r[t]=a:"centrosIds"===t&&(n.centroId?r.centrosIds=[n.centroId]:console.warn(`No se pudo recuperar centrosIds para orden ${n.orden}`))})),r.orden&&r.centrosIds){const t=Fh(Mh(By,"solicitudesPendientes"));e.set(t,r),l++}}await e.commit(),console.log(`Procesado lote ${u/c+1} (${t.length} entradas)`)}return console.log(`Se volcaron ${l} entradas del historial a solicitudes pendientes`),{volcados:l}}catch(kC){return console.error("Error al volcar datos del historial:",kC),{error:kC.message,volcados:0}}},We=async()=>{try{await Vf(If(Mh(By,"centros"),Nf(1)));return console.log("Conexi\xf3n con Firebase verificada correctamente."),{success:!0,message:"Conexi\xf3n establecida correctamente."}}catch(kC){return console.error("Error de conexi\xf3n con Firebase:",kC),Pe("Error de conexi\xf3n con la base de datos. Por favor, verifica tu conexi\xf3n a internet.","error"),{success:!1,error:kC,message:kC.message}}};(0,r.useEffect)((()=>{let e;return(async()=>{if(!te.current&&!ne.current){te.current=!0;try{S(!0),k("Iniciando sistema y verificando conexi\xf3n..."),C(5);const r=await We();if(!r.success)return void k(`Error de conexi\xf3n: ${r.message}. Intenta recargar la p\xe1gina.`);k("Verificando datos..."),C(10);const a=await Vf(Mh(By,"centros"));if(0===a.size){k("Cargando datos iniciales..."),C(20),await Fe("centros");await Ue()||await Me()}else k("Cargando datos existentes..."),C(30),await ze();e=je(),k("Limpiando duplicados iniciales..."),C(50),console.log("Ejecutando limpieza inicial de duplicados");const i=await $e();if(i.error)console.error("Error durante la limpieza inicial:",i.error);else{const e=i.eliminadosSolicitudes+i.eliminadosAsignaciones+i.eliminadosHistorial;console.log(`Limpieza inicial completada: ${e} elementos duplicados eliminados`)}k("Moviendo solicitudes hist\xf3ricas a pendientes..."),C(60);try{const e=await He();e.error?console.error("Error en el volcado de historial:",e.error):e.volcados>0?(console.log(`Volcado inicial: ${e.volcados} solicitudes recuperadas del historial`),k(`Recuperadas ${e.volcados} solicitudes del historial`)):console.log("No hubo solicitudes para recuperar del historial")}catch(t){console.error("Error durante el volcado de historial:",t)}k("Procesando solicitudes pendientes..."),C(70);try{console.log("AVISO: El procesamiento autom\xe1tico de solicitudes est\xe1 deshabilitado."),console.log("Las asignaciones ahora son siempre manuales y deben realizarse desde el panel de administraci\xf3n.");const e=(await Vf(Mh(By,"solicitudesPendientes"))).docs.length;C(100),e>0?(k(`Hay ${e} solicitudes pendientes por procesar manualmente desde el panel de administraci\xf3n.`),console.log(`Hay ${e} solicitudes pendientes que deben procesarse manualmente desde el panel de administraci\xf3n.`)):(k("\xa1Sistema iniciado correctamente!"),setTimeout((()=>{S(!1),Pe("Sistema iniciado correctamente.","success")}),2e3))}catch(n){console.error("Error al procesar solicitudes iniciales:",n),k(`Error al procesar solicitudes: ${n.message}`),C(100),setTimeout((()=>{S(!1),Pe("Se produjo un error durante el procesamiento inicial: "+n.message,"error")}),2e3)}ne.current=!0}catch(kC){console.error("Error durante la inicializaci\xf3n:",kC),k(`Error: ${kC.message}`),setTimeout((()=>{S(!1),Pe("Error durante la inicializaci\xf3n: "+kC.message,"error")}),2e3)}finally{te.current=!1}}})(),()=>{e&&e()}}),[]);const Ge=async()=>{try{if((()=>{try{const e=localStorage.getItem("ultimaVerificacionAsignaciones");if(e){const t=new Date(e),n=new Date;if(t.toDateString()===n.toDateString())return!0}return!1}catch(kC){return console.error("Error al verificar ejecuci\xf3n previa:",kC),!1}})())return void console.log("La verificaci\xf3n de asignaciones ya se ejecut\xf3 hoy.");k("Verificando y corrigiendo asignaciones existentes..."),C(10),S(!0),await new Promise((e=>setTimeout(e,1e3)));try{if(k("Cargando datos actuales..."),C(20),await ze(),0===e.length){k("No hay centros disponibles. Cargando desde CSV..."),C(30);if(!(await fetch("/asignacion-plazas/plazas.csv")).ok)throw new Error("No se encontr\xf3 el archivo CSV de centros");await Me()}if(!e||!Array.isArray(e))return console.error("Error: availablePlazas debe ser un array",e),k("Error: No hay datos de centros disponibles"),await new Promise((e=>setTimeout(e,2e3))),S(!1),void Pe("Error: No hay datos de centros disponibles","error");C(40),k("Comprobando excesos de asignaciones en centros..."),await new Promise((e=>setTimeout(e,500)));const t=n.filter((e=>e&&!e.noAsignable&&"NO_ASIGNABLE"!==e.estado&&"REASIGNACION_NO_VIABLE"!==e.estado)),r={};t.forEach((e=>{const t=e.centerId||e.id;t&&(r[t]=(r[t]||0)+1)}));const a=e.filter((e=>(r[e.id]||0)>e.plazas));if(0===a.length)return C(100),k("No se encontraron centros con exceso de asignaciones. Todo est\xe1 correcto."),await new Promise((e=>setTimeout(e,2e3))),S(!1),Pe("Verificaci\xf3n completada: No hay centros con exceso de asignaciones","success"),localStorage.setItem("ultimaVerificacionDiaria",Date.now().toString()),{success:!0,message:"No hay centros con exceso",corregidos:0};C(60),k(`Encontrados ${a.length} centros con exceso de asignaciones. Comenzando reasignaci\xf3n...`),await new Promise((e=>setTimeout(e,1e3)));const i=await(async(e,t,n)=>{try{if(!Array.isArray(e))return console.error("Error: centros debe ser un array",e),{success:!1,message:"Lista de centros inv\xe1lida",error:"centros debe ser un array"};if(!Array.isArray(t))return console.error("Error: asignaciones debe ser un array",t),{success:!1,message:"Lista de asignaciones inv\xe1lida",error:"asignaciones debe ser un array"};if(!n)return console.error("Error: no se proporcion\xf3 la referencia a la base de datos"),{success:!1,message:"Referencia a la base de datos no proporcionada",error:"db es requerido"};console.log("Verificando centros con exceso de asignaciones...");const r=e.filter((e=>e&&"object"===typeof e&&!isNaN(e.asignadas)&&!isNaN(e.plazas)));if(0===r.length)return console.log("No hay centros v\xe1lidos para verificar"),{success:!0,message:"No hay centros v\xe1lidos para verificar",corregidos:0};const a=t.filter((e=>e&&!e.noAsignable&&"NO_ASIGNABLE"!==e.estado&&"REASIGNACION_NO_VIABLE"!==e.estado)),i={};r.forEach((e=>{i[e.id]=0})),a.forEach((e=>{const t=e.centerId||e.id;t&&void 0!==i[t]&&i[t]++})),r.forEach((e=>{e.asignacionesReales=i[e.id]||0}));const s=r.filter((e=>e.asignacionesReales>e.plazas));if(0===s.length)return console.log("No se encontraron centros con exceso de asignaciones"),{success:!0,message:"No hay centros con exceso",corregidos:0};console.log(`Centros con exceso: ${s.length}`);const o=r.filter((e=>e.asignacionesReales<e.plazas));let c=0,l=0,u=0;for(const e of s){if(!e.centro||!e.id){console.warn("Centro inv\xe1lido:",e);continue}console.log(`Centro ${e.centro}: ${e.asignacionesReales} asignaciones reales, ${e.plazas} plazas`);const t=a.filter((t=>t&&(t.centerId===e.id||t.id===e.id)));if(!t.length){console.warn(`No se encontraron asignaciones v\xe1lidas para ${e.centro}`);continue}if(t.sort(((e,t)=>(Number(e.order)||0)-(Number(t.order)||0))),e.asignacionesReales-e.plazas<=0)continue;const r=t.slice(e.plazas);console.log(`Procesando ${r.length} asignaciones excedentes en ${e.centro}`);for(const a of r)try{let t=!1;const r=o.filter((t=>t.id!==e.id));if(r.length>0){const i=[...r].sort(((e,t)=>e.asignadas/e.plazas-t.asignadas/t.plazas)),s=i[0];if(s&&s.asignadas<s.plazas){const r=Fh(Mh(n,"asignaciones")),i={order:a.order,id:s.id,localidad:s.localidad,centro:s.centro,municipio:s.municipio,timestamp:Date.now(),reasignado:!0,centroOriginal:e.centro};await $f(r,i),await Hf(Fh(n,"centros",s.docId),{asignadas:s.asignadas+1});const o=Fh(Mh(n,"historialSolicitudes")),c={orden:a.order,centroIdOriginal:a.id,centroIdNuevo:s.id,estado:"REASIGNADO",mensaje:`Reasignaci\xf3n de ${e.centro} a ${s.centro} por exceso de plazas`,centroOriginal:a.centro||e.centro,centroAsignado:s.centro,localidad:s.localidad,municipio:s.municipio,fechaHistorico:(new Date).toISOString(),timestamp:Date.now()};await $f(o,c),s.asignadas++,t=!0,l++,console.log(`Asignaci\xf3n ${a.order} reasignada de ${e.centro} a ${s.centro}`)}}if(!t)try{const t=Fh(Mh(n,"historialSolicitudes")),r={orden:a.order,centroId:a.id,estado:"EXCESO_NO_REASIGNABLE",mensaje:`Centro ${e.centro} con exceso de plazas. Se mantiene la asignaci\xf3n actual.`,centroAsignado:a.centro||e.centro,localidad:a.localidad||e.localidad,municipio:a.municipio||e.municipio,fechaHistorico:(new Date).toISOString(),timestamp:Date.now()};await $f(t,r),console.log(`Asignaci\xf3n ${a.order} en exceso en ${e.centro}, pero se mantiene sin convertir a solicitud pendiente`),c++}catch(kC){console.error(`Error al registrar en historial para orden ${a.order}:`,kC)}a.docId?(await Wf(Fh(n,"asignaciones",a.docId)),c++,console.log(`Asignaci\xf3n ${a.docId} eliminada`)):console.warn(`Asignaci\xf3n sin docId para orden ${a.order}`)}catch(kC){console.error(`Error al corregir asignaci\xf3n para orden ${a.order}:`,kC)}if(e.docId)try{await Hf(Fh(n,"centros",e.docId),{asignadas:e.plazas}),console.log(`Contador actualizado para ${e.centro}: ${e.plazas}`)}catch(kC){console.error(`Error al actualizar contador para ${e.centro}:`,kC)}else console.warn(`Centro ${e.centro} sin docId, no se actualiz\xf3 contador`)}return{success:!0,message:`Se corrigieron ${c} asignaciones excedentes (${l} reasignadas, ${u} recuperadas)`,corregidos:c,reasignados:l,recuperados:u}}catch(kC){return console.error("Error en verificaci\xf3n y correcci\xf3n:",kC),{success:!1,error:kC.message,message:"Error en verificaci\xf3n: "+kC.message}}})(e,n,By);return C(90),k(i.success?`${i.message}. Actualizando interfaz...`:`Error durante la verificaci\xf3n: ${i.message}`),await ze(),C(100),k(i.success?`Verificaci\xf3n completada exitosamente. Se corrigieron ${i.corregidos} asignaciones (${i.reasignados} reasignadas).`:`Error durante la verificaci\xf3n: ${i.message}`),await new Promise((e=>setTimeout(e,2e3))),S(!1),i.success?(Pe(i.message,"success"),localStorage.setItem("ultimaVerificacionDiaria",Date.now().toString())):Pe(i.message||"Error al verificar asignaciones","error"),i}catch(kC){console.error("Error al verificar asignaciones:",kC),k(`Error al verificar asignaciones: ${kC.message}`),await new Promise((e=>setTimeout(e,2e3))),S(!1),Pe("Error al verificar asignaciones: "+kC.message,"error")}}catch(kC){console.error("Error al verificar asignaciones:",kC),k(`Error al verificar asignaciones: ${kC.message}`),await new Promise((e=>setTimeout(e,2e3))),S(!1),Pe("Error al verificar asignaciones: "+kC.message,"error")}},Ke=async()=>{try{if("true"===localStorage.getItem("historialLimpiado"))return console.log("La limpieza del historial ya se ha realizado con \xe9xito anteriormente"),{success:!0,eliminados:0,yaRealizado:!0};h&&h("Limpiando duplicados en historial de solicitudes...");const e=[];if((await Vf(If(Mh(By,"historialSolicitudes"),Nf(1e4)))).forEach((t=>{e.push({...t.data(),docId:t.id})})),0===e.length)return Pe("No hay entradas en el historial de solicitudes","info"),{success:!0,eliminados:0};console.log(`Procesando ${e.length} documentos del historial`);const t={};e.forEach((e=>{const n=e.orden;if(!n)return;let r="desconocida";if(e.timestamp){const t=new Date(e.timestamp);r=`${t.getFullYear()}-${t.getMonth()+1}-${t.getDate()}`}else e.fechaHistorico&&(r=e.fechaHistorico.split("T")[0]);const a=`${n}-${e.estado||"DESCONOCIDO"}-${e.centroId||e.centroAsignado||"sin-centro"}-${r}`;t[a]?t[a].push(e):t[a]=[e]}));let n=0;if(Object.values(t).forEach((e=>{e.length>1&&(n+=e.length-1)})),0===n)return Pe("No se encontraron entradas duplicadas en el historial","success"),localStorage.setItem("historialLimpiado","true"),{success:!0,eliminados:0};console.log(`Se encontraron ${n} entradas duplicadas para eliminar`);const r=450;let a=0,i=0,s=[];for(const o in t){const e=t[o];e.length>1&&(e.sort(((e,t)=>{const n=e.timestamp||0;return(t.timestamp||0)-n})),s.push(...e.slice(1)))}for(let o=0;o<s.length;o+=r){const e=Jf(By),t=s.slice(o,o+r);for(const n of t)n.docId&&(e.delete(Fh(By,"historialSolicitudes",n.docId)),a++);await e.commit(),i+=t.length,console.log(`Procesado lote ${Math.floor(o/r)+1}: ${t.length} elementos (total ${i}/${s.length})`),await new Promise((e=>setTimeout(e,1e3))),h&&h(`Limpiando duplicados: ${i}/${s.length} (${Math.round(i/s.length*100)}%)`)}return a>0&&(console.log(`Se eliminaron ${a} entradas duplicadas del historial`),Pe(`Se han eliminado ${a} entradas duplicadas del historial`,"success"),localStorage.setItem("historialLimpiado","true")),await ze(),{success:!0,eliminados:a}}catch(kC){return console.error("Error al limpiar duplicados del historial:",kC),Pe(`Error al limpiar duplicados: ${kC.message}`,"error"),{success:!1,error:kC.message}}finally{h&&h("")}};(0,r.useEffect)((()=>{const e=()=>{const e=Date.now(),t=se.current;(0===t||e-t>36e5)&&Le()};n.length>10&&e();const t=setInterval((()=>{e()}),9e5);return()=>clearInterval(t)}),[n.length]);const qe=async()=>{if(re.current)return console.log("Ya hay un procesamiento en curso. Se omite la verificaci\xf3n por minuto."),!1;try{const t=await Vf(Mh(By,"solicitudesPendientes"));if(t.empty)return console.log("No hay solicitudes pendientes para procesar en la verificaci\xf3n por minuto."),!0;const n=t.docs.map((e=>({...e.data(),docId:e.id,centrosIds:e.data().centrosIds||e.data().centrosSeleccionados||[]})));console.log(`Verificaci\xf3n por minuto: Procesando ${n.length} solicitudes pendientes...`);const r=n.sort(((e,t)=>Number(e.orden)-Number(t.orden))),a=(await Vf(Mh(By,"asignaciones"))).docs.map((e=>({...e.data(),docId:e.id}))),i={};a.forEach((e=>{e.centerId&&(i[e.centerId]||(i[e.centerId]=[]),i[e.centerId].push(e))}));const s=new Map;a.forEach((e=>{e.order&&s.set(e.order,e)}));let o=0,c=0;const l=Jf(By);for(const u of r){const t=Number(u.orden);if(s.has(t)){console.log(`La orden ${t} ya tiene una asignaci\xf3n.`),l.delete(Fh(By,"solicitudesPendientes",u.docId));continue}let n=null,r=null;for(const s of u.centrosIds){const a=e.find((e=>e.id===s));if(a){if(a.asignadas<a.plazas){n=s;break}{const e=(i[s]||[]).reduce(((e,t)=>{const n=Number(e.order||0);return Number(t.order||0)>n?t:e}),{order:0});if(e.order&&Number(e.order)>t){n=s,r=e;break}}}}if(!n){console.log(`No se encontr\xf3 plaza disponible para la orden ${t}.`);continue}const a=e.find((e=>e.id===n));if(r){console.log(`Desplazando asignaci\xf3n de orden ${r.order} para asignar orden ${t} en centro ${n}`),l.delete(Fh(By,"asignaciones",r.docId));const e={orden:r.order,centrosIds:[r.centerId],timestamp:Qf(),desplazada:!0,desplazadaPor:t},a=Fh(Mh(By,"solicitudesPendientes"));l.set(a,e);const i=Fh(Mh(By,"historialSolicitudes"));l.set(i,{orden:r.order,centroAnterior:r.centerId,centroId:null,estado:"DESPLAZADA",mensaje:`Desplazada por orden ${t} de mayor prioridad`,fechaHistorico:(new Date).toISOString(),timestamp:Date.now()}),c++}const d={order:t,centerId:n,centerName:a?a.nombre:"Centro Desconocido",timestamp:Qf()},h=Fh(Mh(By,"asignaciones"));l.set(h,d),l.delete(Fh(By,"solicitudesPendientes",u.docId));const f=Fh(Mh(By,"historialSolicitudes"));l.set(f,{orden:t,centroId:n,estado:r?"PRIORIZADA":"ASIGNADA",mensaje:r?`Asignada con prioridad, desplazando orden ${r.order}`:"Asignada durante procesamiento regular",fechaHistorico:(new Date).toISOString(),timestamp:Date.now()}),o++}return 0===o&&0===c?(console.log("Verificaci\xf3n por minuto: No se realizaron cambios en las asignaciones."),!0):(await l.commit(),console.log(`Verificaci\xf3n por minuto completada: ${o} nuevas asignaciones, ${c} reasignaciones por prioridad.`),(o>0||c>0)&&(await ze(),fe((new Date).toLocaleString()),o+c>0&&Pe(`Procesamiento autom\xe1tico: ${o} nuevas asignaciones, ${c} reasignaciones por prioridad.`,"success")),!0)}catch(kC){return console.error("Error en procesamiento por minuto:",kC),!1}};return(0,r.useEffect)((()=>(console.log("Las asignaciones autom\xe1ticas est\xe1n deshabilitadas. Solo se pueden hacer manualmente desde el panel de admin."),Pe("Las asignaciones ahora son manuales y solo se pueden realizar desde el panel de administraci\xf3n","info"),()=>{})),[]),A?(0,$y.jsx)(xC,{assignments:n,availablePlazas:e,solicitudes:i,procesarTodasLasSolicitudes:Be,procesarSolicitudesPorMinuto:qe,cargarDatosDesdeFirebase:ze,eliminarSolicitudesDuplicadas:$e,limpiarDuplicadosHistorial:Ke,db:By,loadingProcess:l,processingMessage:d,showNotification:Pe,lastProcessed:g,procesarSolicitudes:Vy}):(0,$y.jsxs)("div",{className:"App",style:Ve.container,children:[pe&&(0,$y.jsx)("div",{className:"modal-backdrop",children:(0,$y.jsxs)("div",{className:"modal-content password-modal",children:[(0,$y.jsx)("h3",{children:"Verificaci\xf3n de Administrador"}),(0,$y.jsx)("p",{children:"Ingrese la contrase\xf1a para ejecutar la verificaci\xf3n"}),(0,$y.jsxs)("form",{onSubmit:e=>{e.preventDefault(),"SoyAdmin"===me?(ge(!1),ve(""),be(!1),Pe("Acceso de administrador verificado. Las asignaciones ahora son manuales desde el panel de administraci\xf3n.","info"),window.location.href="/admin"):(be(!0),setTimeout((()=>be(!1)),3e3))},children:[(0,$y.jsx)("input",{type:"password",value:me,onChange:e=>ve(e.target.value),placeholder:"Contrase\xf1a"}),ye&&(0,$y.jsx)("p",{className:"error-message",children:ye}),(0,$y.jsxs)("div",{className:"modal-actions",children:[(0,$y.jsx)("button",{type:"button",className:"modal-button cancel",onClick:()=>{ge(!1),ve(""),be("")},children:"Cancelar"}),(0,$y.jsx)("button",{type:"submit",className:"modal-button",children:"Verificar"})]})]})]})}),x&&(0,$y.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"#0a192f",zIndex:9999,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",color:"white",padding:"20px"},children:(0,$y.jsxs)("div",{style:{backgroundColor:"rgba(255, 255, 255, 0.1)",borderRadius:"16px",padding:"40px",maxWidth:"500px",width:"90%",textAlign:"center",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.2)",backdropFilter:"blur(8px)"},children:[(0,$y.jsx)("div",{style:{fontSize:"28px",fontWeight:"bold",marginBottom:"20px",color:"#64ffda"},children:"SISTEMA EN MANTENIMIENTO"}),(0,$y.jsx)("div",{style:{fontSize:"18px",lineHeight:"1.6",marginBottom:"10px"},children:I||"Estamos verificando y actualizando las asignaciones..."}),(0,$y.jsxs)("div",{style:{fontSize:"16px",marginBottom:"20px"},children:["Solicitudes pendientes: ",i.length]}),(0,$y.jsx)("div",{style:{width:"100%",height:"8px",backgroundColor:"rgba(255, 255, 255, 0.1)",borderRadius:"4px",marginBottom:"10px",overflow:"hidden"},children:(0,$y.jsx)("div",{style:{height:"100%",width:`${_}%`,backgroundColor:"#64ffda",borderRadius:"4px",transition:"width 0.5s ease"}})}),(0,$y.jsxs)("div",{style:{fontSize:"14px",color:"#8892b0"},children:[_,"% completado"]}),(0,$y.jsx)("div",{style:{marginTop:"30px",fontSize:"14px",color:"#8892b0",fontStyle:"italic"},children:"Por favor espere. El sistema volver\xe1 a estar disponible autom\xe1ticamente."})]})}),(0,$y.jsxs)("div",{style:Ve.header,children:[(0,$y.jsx)("h1",{style:Ve.title,children:"Sistema de Asignaci\xf3n de Plazas"}),(()=>{const e=localStorage.getItem("ultimaVerificacionDiaria");if(!e)return!0;const t=new Date(Number(e)),n=new Date;return!(t.getDate()===n.getDate()&&t.getMonth()===n.getMonth()&&t.getFullYear()===n.getFullYear())})()&&(0,$y.jsx)("div",{style:{position:"absolute",top:"20px",right:"20px",zIndex:50},children:(0,$y.jsx)("button",{onClick:()=>ge(!0),style:{padding:"12px 20px",backgroundColor:"#3498db",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"15px",fontWeight:"500",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:"\ud83d\udd04 Verificar Asignaciones Hoy"})}),(0,$y.jsxs)("div",{style:Ve.tabs,children:[(0,$y.jsx)("div",{style:{...Ve.tab,..."asignaciones"===Z?Ve.activeTab:Ve.inactiveTab},onClick:()=>ee("asignaciones"),children:"\ud83d\udccb Historial de Asignaciones"}),(0,$y.jsx)("div",{style:{...Ve.tab,..."solicitudes"===Z?Ve.activeTab:Ve.inactiveTab},onClick:()=>ee("solicitudes"),children:"\ud83d\udd0d Solicitudes Pendientes"}),(0,$y.jsx)("div",{style:{...Ve.tab,..."plazas"===Z?Ve.activeTab:Ve.inactiveTab},onClick:()=>ee("plazas"),children:"\ud83c\udfe2 Plazas Disponibles"})]})]}),(0,$y.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px",fontSize:"14px",color:"#666",padding:"8px 12px",backgroundColor:"#f0f8ff",borderRadius:"6px"},children:[(0,$y.jsxs)("div",{children:[(0,$y.jsx)("span",{style:{fontWeight:"bold",marginRight:"5px"},children:"Plazas disponibles:"}),7066-n.length," de 7066"," "]}),(0,$y.jsxs)("div",{style:{display:"flex",alignItems:"center",flexWrap:"wrap"},children:[i.length>0&&(0,$y.jsx)("span",{style:{marginRight:"10px",color:l?"#e74c3c":"#2ecc71"},children:l?(0,$y.jsxs)($y.Fragment,{children:[(0,$y.jsx)("span",{style:{display:"inline-block",width:"12px",height:"12px",border:"2px solid rgba(231,76,60,0.3)",borderRadius:"50%",borderTopColor:"#e74c3c",animation:"spin 1s linear infinite",marginRight:"5px",verticalAlign:"middle"}}),"Procesando ",i.length," solicitudes..."]}):(0,$y.jsxs)($y.Fragment,{children:[(0,$y.jsx)("span",{style:{color:"#2ecc71",marginRight:"5px"},children:"\u25cf"}),i.length," solicitudes pendientes"]})}),(0,$y.jsx)("span",{style:{fontWeight:"bold",marginRight:"5px"},children:"\xdaltima actualizaci\xf3n:"}),g&&"function"===typeof g.getTime?(()=>{const e=g.getHours(),t=g.getMinutes();return 2===e&&0===t?"Actualizado":new Intl.DateTimeFormat("es-ES",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).format(g)})():"No disponible"]})]}),"asignaciones"===Z&&(0,$y.jsxs)("div",{style:Ve.cardContainer,children:[(0,$y.jsx)("h3",{style:Ve.sectionTitle,children:"Historial de Asignaciones"}),(0,$y.jsx)(Hy,{assignments:n,availablePlazas:e})]}),"solicitudes"===Z&&(0,$y.jsxs)("div",{style:Ve.cardContainer,children:[(0,$y.jsx)("h3",{style:Ve.sectionTitle,children:"Solicitudes Pendientes"}),(0,$y.jsx)(Gy,{solicitudes:i||[],assignments:n||[],availablePlazas:e||[]})]}),"plazas"===Z&&(0,$y.jsxs)("div",{style:Ve.cardContainer,children:[(0,$y.jsx)("h3",{style:Ve.sectionTitle,children:"Plazas Disponibles"}),e.length>0?(0,$y.jsx)(Wy,{availablePlazas:e,assignments:n,searchTerm:$,setSearchTerm:H,orderNumber:L,setOrderNumber:M,centrosSeleccionados:F,setCentrosSeleccionados:z,handleOrderSubmit:async(e,t)=>{if(console.log(`Iniciando env\xedo de solicitud para orden ${e}`),void 0===e||null===e||""===e)return console.error("Error en enviarSolicitud: orderNumber es null, undefined o vac\xedo"),Pe("Error: N\xfamero de orden inv\xe1lido","error"),!1;if(!t||!Array.isArray(t)||0===t.length)return console.error("Error en enviarSolicitud: No hay centros seleccionados",t),Pe("Error: Debe seleccionar al menos un centro","error"),!1;const n=Number(e);if(isNaN(n))return console.error("Error en enviarSolicitud: orderNumber no es un n\xfamero v\xe1lido",e),Pe("Error: N\xfamero de orden inv\xe1lido","error"),!1;console.log(`Procesando solicitud para orden ${n} con centros:`,t);try{const e=await We();if(!e||!e.success)return console.error("Error de conexi\xf3n con Firebase:",(null===e||void 0===e?void 0:e.error)||"Sin detalles adicionales"),Pe("Error de conexi\xf3n con la base de datos. Por favor, verifica tu conexi\xf3n a internet.","error"),!1;try{if(!(await Vf(If(Mh(By,"asignaciones"),_f("order","==",n)))).empty)return console.log(`Ya existe una asignaci\xf3n para la orden ${n}`),Pe(`La orden ${n} ya tiene una asignaci\xf3n en el sistema.`,"error"),!1}catch(kC){return console.error("Error al verificar asignaciones existentes:",kC),Pe("Error al verificar asignaciones existentes. Intente nuevamente.","error"),!1}let r=null;try{const e=await Vf(If(Mh(By,"solicitudesPendientes"),_f("orden","==",n)));e.empty||(r=e.docs[0].id,console.log(`Encontrada solicitud existente con ID ${r} para orden ${n}`))}catch(kC){return console.error("Error al verificar solicitudes pendientes existentes:",kC),Pe("Error al verificar solicitudes pendientes. Intente nuevamente.","error"),!1}try{if(r)await Hf(Fh(By,"solicitudesPendientes",r),{centrosSeleccionados:t,timestamp:Qf()}),console.log(`Actualizada solicitud existente ${r} para orden ${n}`);else{const e={orden:n,centrosIds:t,timestamp:Qf()};await $f(Fh(Mh(By,"solicitudesPendientes")),e),console.log(`Creada nueva solicitud para orden ${n}`)}console.log(`Solicitud para orden ${n} enviada correctamente`),Pe(`Solicitud para orden ${n} enviada correctamente. Ser\xe1 procesada autom\xe1ticamente.`,"success"),await ze();const e=new Date,a=Fh(Mh(By,"historialSolicitudes"));return await $f(a,{orden:n,centrosIds:t,estado:"PENDIENTE",mensaje:"Solicitud a\xf1adida a la cola de procesamiento",fechaHistorico:e.toISOString(),timestamp:e.getTime()}),M(""),z([]),ee("solicitudes"),!0}catch(kC){return console.error("Error al guardar solicitud:",kC),Pe(`Error al procesar la solicitud: ${kC.message}`,"error"),!1}}catch(kC){return console.error(`Error al enviar solicitud para orden ${n}:`,kC),Pe(`Error al enviar solicitud: ${kC.message}`,"error"),!1}},isProcessing:j}):(0,$y.jsxs)("div",{style:{textAlign:"center",padding:"40px 20px",backgroundColor:"#f5f7fa",borderRadius:"8px",color:"#5c6c7c"},children:[(0,$y.jsx)("div",{style:{fontSize:"36px",marginBottom:"15px"},children:"\ud83c\udfe2"}),(0,$y.jsx)("div",{style:{fontSize:"18px",fontWeight:"bold",marginBottom:"10px"},children:"Cargando plazas..."}),(0,$y.jsx)("div",{style:{fontSize:"14px",marginBottom:"20px"},children:"Por favor espera mientras se cargan los datos de los centros."}),(0,$y.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"10px"},children:[(0,$y.jsx)("div",{style:{width:"20px",height:"20px",border:"3px solid rgba(0,0,0,0.1)",borderRadius:"50%",borderTopColor:"#3498db",animation:"spin 1s linear infinite"}}),(0,$y.jsx)("div",{children:"Cargando datos..."})]})]})]}),(0,$y.jsx)(Ky,{}),K&&(0,$y.jsx)("div",{style:{...Ve.popup,backgroundColor:"success"===Q?"#d4edda":"warning"===Q?"#fff3cd":"#f8d7da",color:"success"===Q?"#155724":"warning"===Q?"#856404":"#721c24"},children:(0,$y.jsxs)("div",{style:{display:"flex",alignItems:"flex-start"},children:[(0,$y.jsx)("div",{style:{flex:1},children:Y}),(0,$y.jsx)("button",{onClick:()=>q(!1),style:{background:"none",border:"none",cursor:"pointer",fontSize:"18px",marginLeft:"10px",color:"inherit"},children:"\xd7"})]})}),(l||f)&&(0,$y.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:999},children:(0,$y.jsxs)("div",{style:{backgroundColor:"white",padding:"20px",borderRadius:"10px",boxShadow:"0 0 20px rgba(0,0,0,0.2)",maxWidth:"500px",width:"90%",textAlign:"center"},children:[(0,$y.jsx)("div",{style:{marginBottom:"15px",fontSize:"18px"},children:f?"Cargando datos...":"Procesando solicitudes..."}),(0,$y.jsx)("div",{children:d}),(0,$y.jsx)("div",{style:{width:"100%",height:"4px",backgroundColor:"#f1f1f1",borderRadius:"2px",marginTop:"15px",overflow:"hidden",position:"relative"},children:(0,$y.jsx)("div",{style:{position:"absolute",top:0,left:0,height:"100%",width:"30%",backgroundColor:"#3498db",borderRadius:"2px",animation:"loading 1.5s infinite ease-in-out"}})})]})}),(0,$y.jsx)("style",{children:"\n        @keyframes slideIn {\n          0% { transform: translateX(100%); opacity: 0; }\n          100% { transform: translateX(0); opacity: 1; }\n        }\n        @keyframes loading {\n          0% { left: -30%; }\n          100% { left: 100%; }\n        }\n        @keyframes spin {\n          0% { transform: rotate(0deg); }\n          100% { transform: rotate(360deg); }\n        }\n      "})]})},IC=e=>{e&&e instanceof Function&&n.e(453).then(n.bind(n,453)).then((t=>{let{getCLS:n,getFID:r,getFCP:a,getLCP:i,getTTFB:s}=t;n(e),r(e),a(e),i(e),s(e)}))};a.createRoot(document.getElementById("root")).render((0,$y.jsx)(r.StrictMode,{children:(0,$y.jsx)(SC,{})})),IC()})();
//# sourceMappingURL=main.46f7261f.js.map